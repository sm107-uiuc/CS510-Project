{"url": "https://towardsdatascience.com/fitting-glms-by-hand-189c02af33a8", "time": 1683004786.0436668, "path": "towardsdatascience.com/fitting-glms-by-hand-189c02af33a8/", "webpage": {"metadata": {"title": "Generalized Linear Models Decomposed | by Daniel Friedman | Towards Data Science", "h1": "Generalized Linear Models Decomposed", "description": "In ordinary linear regression, we treat our outcome variable as a linear combination of several input variables plus some random noise, typically assumed to be Normally distributed. While this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/generalized-linear-models-9cbf848bb8ab", "anchor_text": "this article", "paragraph_index": 2}, {"url": "https://www.amazon.com/Generalized-Linear-Examples-Springer-Statistics/dp/1441901175", "anchor_text": "this book", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Ladislaus_Bortkiewicz", "anchor_text": "deaths-by-horse-kick", "paragraph_index": 27}], "all_paragraphs": ["In ordinary linear regression, we treat our outcome variable as a linear combination of several input variables plus some random noise, typically assumed to be Normally distributed. While this modeling approach is easily interpreted, efficiently implemented, and capable of accurately capturing many linear relationships, it does come with several significant limitations. A simple extension of linear models, a Generalized Linear Model (GLM) is able to relax some of linear regression\u2019s most strict assumptions. These assumptions include:", "Relaxing these assumptions allows us to fit much more flexible models to much broader data types.", "GLMs can be easily fit with a few lines of code in languages like R or Python, but to understand how a model works, it\u2019s always helpful to get under the hood and code it up yourself. This article shows how to implement GLMs from scratch using only Python\u2019s Numpy package. For more on the basics and intuition on GLMs, check out this article or this book.", "Fitting a GLM first requires specifying two components: a random distribution for our outcome variable and a link function between the distribution\u2019s mean parameter and its \u201clinear predictor\u201d.", "The first step to building our GLM is identifying the distribution of the outcome variable. If the data has a binary response, we might want to use the Bernoulli or Binomial distributions. If we are working with count data, a Poisson model might be more useful. This distribution is typically assumed to come from the Exponential Family of distributions, which includes the Binomial, Poisson, Negative Binomial, Gamma, and Normal.", "Each of these models can be expressed in terms of its mean parameter, \ud835\udf07 = E(Y). For instance, we specify a binomial model as Y ~ Bin(n, p), which can also be written as Y ~ Bin(n, \ud835\udf07/n). Once we estimate \ud835\udf07, we model Y as coming from a distribution indexed by \ud835\udf07\u0302 and our predicted value of Y is simply \ud835\udf07\u0302.", "In a GLM, we estimate \ud835\udf07 as a non-linear function of a \u201clinear predictor\u201d \ud835\udf02, which itself is a linear function of the data. The non-linear function connecting \ud835\udf07 to \ud835\udf02 is called the link function, and we determine it before model-fitting. The link function is written as a function of \ud835\udf07, e.g. \ud835\udf02 = g(\ud835\udf07).", "Suppose we have the following training data where each x is a D-dimensional vector:", "We first write \ud835\udf02 as a linear function of x for each observation n = 1, \u2026 , N:", "Then we connect \ud835\udf02 to \ud835\udf07 with the link function:", "To fit the GLM, we are actually just finding estimates for the \u03b2s: from these, we obtain estimates of \ud835\udf02, which leads immediately to an estimate for \ud835\udf07, which then gives us an estimated distribution for Y! To estimate the \u03b2s, follow these steps:", "To reinforce our understanding of this structure, let\u2019s first write out a typical linear regression model in GLM format. As step 1, let\u2019s specify the distribution of Y. Recall that a typical linear model assumes", "where \u03b2 is a length-D vector of coefficients (this assumes we\u2019ve added a 1 to each x so the first element in \u03b2 is the intercept term). Note that the mean of this distribution is a linear combination of the data, meaning we could write this model in terms of our linear predictor by letting", "Then for step 2, we need to find the function linking \ud835\udf07 and \ud835\udf02. In the case of linear regression, it\u2019s simple. Since E(Y) = \ud835\udf07 and the mean of our modeled Y is \ud835\udf02, we have \ud835\udf02 = g(\ud835\udf07) = \ud835\udf07!", "Step 3: let\u2019s find the negative log-likelihood.", "Note that our loss function is proportional to the sum of the squared errors.", "Finally for step 4, let\u2019s see if we can minimize this loss function analytically. Start by taking the derivative with respect to \u03b2 and setting it equal to 0.", "This gives the closed-form solution we know and love from ordinary linear regression.", "Now for the simple coding. Let\u2019s randomly generate some normally-distributed Y values and fit the model. The scatterplot below shows that our fitted values for \u03b2 are quite close to the true values.", "In logistic regression, we model our outputs as independent Bernoulli trials. I.e. we assume", "That completes step 1. For step 2, we must find a way to relate our linear predictor \ud835\udf02 to our parameter p. Since p is between 0 and 1 and \ud835\udf02 can be any real number, a natural choice is the log-odds. I.e.,", "Inversely, we use the sigmoid function to get from \ud835\udf02 to p (which I will call S):", "This wraps up step 2. For step 3, find the negative log likelihood.", "This gives us our loss function and finishes step 3. For step 4, we find the values of \u03b2 to minimize this loss. Unfortunately, in the logistic regression case, there is no closed-form solution, so we must use gradient descent. So, let\u2019s find the derivative of the loss function with respect to \u03b2. First, note that S\u2019(x) = S(x)(1-S(x)):", "Then we can derive the entire gradient:", "To speed up calculations in Python, we can also write this as", "Now let\u2019s fit the model using gradient descent. Again, the scatterplot below shows that our fitted values for \u03b2 are quite close to the true values.", "The Poisson is a great way to model data that occurs in counts, such as accidents on a highway or deaths-by-horse-kick.", "Step 2, we specify the link function. The link function must convert a non-negative rate parameter \u03bb to the linear predictor \u03b7 \u2208 \u211d. A common function is", "Now for step 3, find the negative log-likelihood.", "And step 4, optimize for \u03b2.", "Sadly, there is no closed-form solution, so again we turn to gradient descent, as implemented below. Once again, the estimated parameters are plotted against the true parameters and once again the model does pretty well.", "When building GLMs in practice, R\u2019s glm command and statsmodels\u2019 GLM function in Python are easily implemented and efficiently programmed. But becoming familiar with the structure of a GLM is essential for parameter tuning and model selection. When it comes to modeling, often the best way to understand what\u2019s underneath the hood is to build the car yourself.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Stats Major at Harvard and Data Scientist in Training"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F189c02af33a8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----189c02af33a8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----189c02af33a8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dafrdman?source=post_page-----189c02af33a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dafrdman?source=post_page-----189c02af33a8--------------------------------", "anchor_text": "Daniel Friedman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc908b9a1316f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&user=Daniel+Friedman&userId=c908b9a1316f&source=post_page-c908b9a1316f----189c02af33a8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F189c02af33a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F189c02af33a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/generalized-linear-models-9cbf848bb8ab", "anchor_text": "this article"}, {"url": "https://www.amazon.com/Generalized-Linear-Examples-Springer-Statistics/dp/1441901175", "anchor_text": "this book"}, {"url": "https://en.wikipedia.org/wiki/Ladislaus_Bortkiewicz", "anchor_text": "deaths-by-horse-kick"}, {"url": "https://medium.com/tag/python?source=post_page-----189c02af33a8---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/glm?source=post_page-----189c02af33a8---------------glm-----------------", "anchor_text": "Glm"}, {"url": "https://medium.com/tag/model-fitting?source=post_page-----189c02af33a8---------------model_fitting-----------------", "anchor_text": "Model Fitting"}, {"url": "https://medium.com/tag/gradient-descent?source=post_page-----189c02af33a8---------------gradient_descent-----------------", "anchor_text": "Gradient Descent"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F189c02af33a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&user=Daniel+Friedman&userId=c908b9a1316f&source=-----189c02af33a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F189c02af33a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&user=Daniel+Friedman&userId=c908b9a1316f&source=-----189c02af33a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F189c02af33a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----189c02af33a8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F189c02af33a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----189c02af33a8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----189c02af33a8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----189c02af33a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----189c02af33a8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----189c02af33a8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----189c02af33a8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----189c02af33a8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----189c02af33a8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----189c02af33a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dafrdman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dafrdman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Daniel Friedman"}, {"url": "https://medium.com/@dafrdman/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc908b9a1316f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&user=Daniel+Friedman&userId=c908b9a1316f&source=post_page-c908b9a1316f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc908b9a1316f%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffitting-glms-by-hand-189c02af33a8&user=Daniel+Friedman&userId=c908b9a1316f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}