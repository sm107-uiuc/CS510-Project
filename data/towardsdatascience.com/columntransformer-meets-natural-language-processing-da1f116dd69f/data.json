{"url": "https://towardsdatascience.com/columntransformer-meets-natural-language-processing-da1f116dd69f", "time": 1682995942.452363, "path": "towardsdatascience.com/columntransformer-meets-natural-language-processing-da1f116dd69f/", "webpage": {"metadata": {"title": "ColumnTransformer Meets Natural Language Processing | by Susan Li | Towards Data Science", "h1": "ColumnTransformer Meets Natural Language Processing", "description": "Since published several articles on text classification, I have received inquiries on how to deal with mixed input feature types, for example, how to combine numeric, categorical and text features in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.hstack.html", "anchor_text": "scipy.sparse.hstack", "paragraph_index": 2}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "ColumnTransformer", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn", "paragraph_index": 3}, {"url": "https://www.kaggle.com/saitosean/mercari", "anchor_text": "Mercari Price Suggestion Challenge", "paragraph_index": 4}, {"url": "https://www.kaggle.com/saitosean/mercari", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "ColumnTransformer", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/modules/compose.html#column-transformer", "anchor_text": "ColumnTransformer", "paragraph_index": 11}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/ColumnTransformer%20Meets%20NLP.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 12}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/ColumnTransformer%20Meets%20NLP.ipynb", "anchor_text": "Github", "paragraph_index": 12}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/", "paragraph_index": 14}], "all_paragraphs": ["Since published several articles on text classification, I have received inquiries on how to deal with mixed input feature types, for example, how to combine numeric, categorical and text features in a classification or regression model.", "Therefore, I decided to write a post using an example to answer this question.", "There are several different methods to append or combine different feature types. One method is using scipy.sparse.hstack that stack sparse matrices horizontally.", "However, I will introduce one method, the new hot baby on the block: ColumnTransformer function from sklearn. If you would like to try it out, you will need to upgrade your sklearn to 0.20.", "An excellent data set for this demonstration is Mercari Price Suggestion Challenge that builds a machine learning model to automatically suggest the right product prices. The data can be found here.", "Our data contains heterogeneous data types, they are numeric, categorical and text data. We want to use different pre-processing steps and transformations for those different types of columns.", "For example: we may want to one-hot encode the categorical features and tfidfvectorize the text features.", "\u201cPrice\u201d is the target feature that we will predict.", "The target feature price is right skewed. As linear models like normally distributed data , we will transform price and make it more normally distributed.", "Split the data in training and test sets:", "The following is how to apply ColumnTransformer. Surprisingly, it is very simple.", "We will combine this preprocessing step based on the ColumnTransformer with a regression in a Pipeline to predict the price.", "Jupyter notebook can be found on Github. Enjoy the rest of the week!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Changing the world, one post at a time. Sr Data Scientist, Toronto Canada. https://www.linkedin.com/in/susanli/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fda1f116dd69f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://actsusanli.medium.com/?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": "Susan Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a----da1f116dd69f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda1f116dd69f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda1f116dd69f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.hstack.html", "anchor_text": "scipy.sparse.hstack"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "ColumnTransformer"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn"}, {"url": "https://www.kaggle.com/saitosean/mercari", "anchor_text": "Mercari Price Suggestion Challenge"}, {"url": "https://www.kaggle.com/saitosean/mercari", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html", "anchor_text": "ColumnTransformer"}, {"url": "https://scikit-learn.org/stable/modules/compose.html#column-transformer", "anchor_text": "ColumnTransformer"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/ColumnTransformer%20Meets%20NLP.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/ColumnTransformer%20Meets%20NLP.ipynb", "anchor_text": "Github"}, {"url": "https://scikit-learn.org/stable/modules/compose.html#column-transformer", "anchor_text": "4.1. Pipelines and composite estimators - scikit-learn 0.20.3 documentationTransformers are usually combined with classifiers, regressors or other estimators to build a composite estimator. The\u2026scikit-learn.org"}, {"url": "https://jorisvandenbossche.github.io/blog/2018/05/28/scikit-learn-columntransformer/", "anchor_text": "Introducing the ColumnTransformer: applying different transformations to different features in a\u2026Real-world data often contains heterogeneous data types. When processing the data before applying the final prediction\u2026jorisvandenbossche.github.io"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----da1f116dd69f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----da1f116dd69f---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----da1f116dd69f---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----da1f116dd69f---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/python?source=post_page-----da1f116dd69f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda1f116dd69f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&user=Susan+Li&userId=731d8566944a&source=-----da1f116dd69f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fda1f116dd69f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&user=Susan+Li&userId=731d8566944a&source=-----da1f116dd69f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fda1f116dd69f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fda1f116dd69f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----da1f116dd69f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----da1f116dd69f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----da1f116dd69f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----da1f116dd69f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----da1f116dd69f--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Susan Li"}, {"url": "https://actsusanli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27K Followers"}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f2b19329694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcolumntransformer-meets-natural-language-processing-da1f116dd69f&newsletterV3=731d8566944a&newsletterV3Id=1f2b19329694&user=Susan+Li&userId=731d8566944a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}