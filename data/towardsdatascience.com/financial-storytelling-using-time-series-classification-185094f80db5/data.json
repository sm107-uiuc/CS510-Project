{"url": "https://towardsdatascience.com/financial-storytelling-using-time-series-classification-185094f80db5", "time": 1682996172.668106, "path": "towardsdatascience.com/financial-storytelling-using-time-series-classification-185094f80db5/", "webpage": {"metadata": {"title": "Financial storytelling using time-series classification | by Vered Zimmerman | Towards Data Science", "h1": "Financial storytelling using time-series classification", "description": "When it comes to narratives, financial markets are particularly appealing because they only ever move on one axis over time. A person can be hungry yet happy, but in finance things go up or down; get\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/The_Seven_Basic_Plots", "anchor_text": "seven", "paragraph_index": 7}, {"url": "https://www.theatlantic.com/technology/archive/2016/07/the-six-main-arcs-in-storytelling-identified-by-a-computer/490733/", "anchor_text": "six", "paragraph_index": 7}, {"url": "https://www.schroders.com/en/insights/economics/quarterly-markets-review---q1-2019/", "anchor_text": "asset manager Schroders", "paragraph_index": 10}, {"url": "https://www.investopedia.com/terms/b/bell-curve.asp", "anchor_text": "bell-curve", "paragraph_index": 31}, {"url": "https://course.fast.ai/videos/?lesson=7", "anchor_text": "FastAi explaining it", "paragraph_index": 48}, {"url": "https://pytorch.org/docs/0.4.0/_modules/torchvision/models/resnet.html", "anchor_text": "PyTorch source code", "paragraph_index": 48}, {"url": "https://www.investing.com/markets/", "anchor_text": "Investing.com", "paragraph_index": 56}, {"url": "https://link.springer.com/article/10.1007/s10618-016-0483-9", "anchor_text": "The great time series classification bake off: a review and experimental evaluation of recent algorithmic advances", "paragraph_index": 65}, {"url": "https://arxiv.org/pdf/1809.04356v3.pdf", "anchor_text": "Deep learning for time series classification: a review", "paragraph_index": 66}], "all_paragraphs": ["When it comes to narratives, financial markets are particularly appealing because they only ever move on one axis over time. A person can be hungry yet happy, but in finance things go up or down; get stronger or weaker; expand or contract.", "As humans, when we look at a chart of market movements, we can easily arrive at an essential story of what markets did over a period:", "But markets make up for this simplicity with noise. For our above example, three of the images below would describe a similar scenario, with the fourth describing a different one:", "To us, all this is clear. But could you teach a computer to turn these inputs into appropriate narratives?", "One way to do it is to decide, for a given time series of financial performance, which of a given set of narratives best describes it.", "Notice that, though this is a natural language generation (NLG) problem, the actual text the machine spits out is not entirely generated by a machine; much of it is pre-written by a human.", "Some NLG practitioners now consider this approach rather unfashionable. This is partly because nailing down selected narratives feels like either there\u2019s not going to be enough richness to the text, or there\u2019ll be too many narratives to be worth the effort. (If you had to write 1000 different narratives, did it actually save any bother?)", "We flatter ourselves. We may believe humans crave infinite narrative diversity, but even in fiction, we actually gravitate towards very few types of plots (seven, according to Booker; six, according to Vonnegut).", "In finance, the simplest narrative forms take account of only of the starting point and the end point, discarding everything in between. For example: \u201cGold prices rose over the month\u201d. Let\u2019s call this a 2-point narrative.", "This form of narration is okay, but when discussing markets much depends on the time frame and context. For stocks, say, you might want to go into finer detail over the ups and downs over a year; over an afternoon, not so much. Below are examples of slightly richer narratives:", "So now, have a look at these well-written summary bullet points, published by asset manager Schroders:", "Notice that the first and third bullets are 3-point narratives, and the second and fourth are 2-point narratives.", "We don\u2019t mind the narrative simplicity because the latter parts of the sentence enrich the text. The first part is the narrative of WHAT happened, and the second part \u2014 very loosely \u2014 talks about WHY.", "Getting back to our own problem, we\u2019ll limit ourselves to less than 20 narrative types, covering 2- and 3-point narratives. Writing the text components won\u2019t take long, and we can easily offer alternative phrasings to the same scenario to mix things up.", "Clearly, this is a classification problem, since we ask: given a new series, which of our selected narrative types does it most resemble? Therefore, we\u2019ll be building some form of classifier.", "But what shall we train it with?", "We haven\u2019t got any real-world labelled data (meaning, a ton of past performance curves, each labelled with the most suitable narrative type). Obtaining such data would be time-consuming and laborious. So instead, we\u2019ll manufacture labelled examples that\u2019ll look pretty close to the real thing.", "1. We\u2019ll generate the basis for our data: lots of samples per narrative.", "2. We\u2019ll add noise to each data sample, so it looks the way financial markets behave.", "3. We\u2019ll use the now-noisy data to train a classifier.", "4. We\u2019ll test it on both manufactured and real data and see what we get.", "Say that over a month, an index starts at 100, goes down, and then goes up again to end higher than where it started. By now we know that this is a 3-point narrative.", "But there are all sorts of things that can vary, while still keeping with the story: WHEN did the index reach its low point? HOW LOW was this low-point? And what does it mean to PROPERLY RISE?", "Our first point is always fixed: at time 0, we normalize the value to 100. But the rest can jiggle around, and the above questions illustrate parameters that take us from the general description of a narrative to a specific instance.", "Therefore, every narrative type has several parameters that can vary over a range. To generate lots and lots of samples, we randomly pick values out of these ranges. For the down-ending-up narrative, say, we may end up with a bunch of samples that look like this:", "But these look nothing like how financial markets move in real life. In real life markets are volatile, so they bounce around. What we need to do is take our neat narrative samples, and add some noise.", "My problem was that I needed to add just enough noise.", "If I added too little noise, the lines would look unnaturally straight, not at all the way real markets behave. But if I added too much, or wouldn\u2019t control the randomness, then my gorgeous narrative points might drown in the noise.", "Personally, I didn\u2019t know the answer to this one.", "So I turned to my Swiss-Army-knife of a husband, who suggested I use something called a Brownian Bridge.", "This will be a pain-free explanation of what it is and why it works. For this purpose, let\u2019s say you are seriously drunk.", "The pub just closed, your home is a mile away, and you need to get there by sunrise. However hard you try to walk straight, you wobble. When you try to move, sometimes you take a step forward, sometimes a step back. Being this drunk, you have zero memory of the steps you\u2019ve previously taken.  After an hour, have you made any progress? Well, you\u2019ve traced a random path, so we can\u2019t say for sure. But because of the way you\u2019ve traced that random path, we know that your distance from your starting point is distributed like a bell-curve, with a variance that depends on the size of your step and the number of steps you\u2019ve taken.", "Another hour passes. And since you\u2019ve gotten no soberer, your distance from your starting point is again distributed like a bell curve, but the variance is now twice as big. And so it goes on.", "My friend, you are experiencing a Brownian motion.", "A Brownian Bridge is a Brownian motion that forces an end point: It looks only at the paths traced by a Brownian motion that end at a specific point (say, your home) at a specific time (sunrise). So again, it\u2019s a statistical process \u2014 we can\u2019t know for sure where you are at any given point in time between the start and the finish. But it\u2019s a process that is conditional on being of a certain value at a certain time.", "In between the start and finish, you\u2019re still walking like a total drunk. But because your future has been foretold (you will end up at home at sunrise), you\u2019re not quite as free to roam as you were before. You\u2019re freest at around-mid-distance, and your freedom shrinks the closer you are to your end-point.", "OK, enough with the drunk metaphor, back to our case.", "We want zero noise in our fixed narrative points so that they don\u2019t move. In between, we want it to get noisy, so that our stock market movements jump around. A Brownian bridge does exactly that:", "Because our data is a time-series, we squarely reside in the world of time-series classification.", "But a big world it is. In order to choose a classification method, we\u2019ll use a machete to carve off its irrelevant parts.", "First off, we chop out methods for predictive purposes (for example, guessing whether stocks will go up or down in future based on past data). That\u2019s not our task.", "Then, there\u2019s a whole class of algorithms that tries to learn explicit features for the curves; a 2016 review of this school of thought is available in [1].", "Explicit features are useful to people who don\u2019t assume much about their data, and want to identify key attributes so they could, for example, generate similar samples, or describe which qualities \u201cmake\u201d something representative of its kind. Again, also not us:", "First, we already assume quite a lot about our data. Plus, in both samples and real data, we consider most of the curve to be just random noise.", "Moving on to neural-network approaches. Here, we classify, but can\u2019t describe fully what differentiates one class from another. Most conveniently, an article published this March reviews the different approaches to deep learning for time series classification [2].", "It has a handy chart that helps us chop further: as before, we\u2019re not interested in a solution that learns how to create new samples, and we\u2019re not interested in feature engineering:", "That leaves us with End-to-End methods. Also, the name carries the promise of making life easy, which I find highly appealing.", "The results of the above paper suggest that, for the purposes of our one-dimensional problem (= everything moves on a single axis, which is time), the end-to-end approach that tends to performs best on most datasets is ResNet.", "Being a state-of-the-art image classifier, this hardly comes as a shock. (Here\u2019s FastAi explaining it, and here\u2019s the PyTorch source code. I ended up getting sufficiently good results with ResNet-34).", "I\u2019m going to almost make it sound as if everything instantly worked. Because in the real world, all anyone will ever care about is: DOES IT WORK? And at first, of course it didn\u2019t. But for very interesting reasons.", "When I looked at the initial outcomes, the success rate was not great. But it soon became clear that, for many curves, though the classification differed to what was intended, its interpretation was just as valid:", "Once I had removed the noise and re-trained a model, sure, the success rate surged; but this data no longer looked the way markets actually move. This meant that, once real noise was added, the distinction between certain narrative types tended to blur.", "I found this rather beautiful: all too often the classifier wasn\u2019t wrong per se; it was picking up the salient meaning I had hoped for, just not in a way I could regard as trustworthy. But this did raise the question: what exactly should I aim to improve?", "One thing that stood out almost immediately was that, with just the time series as input, the model struggled to infer relationships between the beginning of the series and the end of it. But that meant losing important information, in case the end of a narrative was defined in relation to the starting point.", "This was both not surprising, given how ResNet works, and easily addressed, by changing the input to a doubled-up series:", "Further testing revealed that one of the toughest things for it to learn was when to ignore noise and see when something stayed \u201cabout the same\u201d. Thus, the way to address performance was not to fiddle with the network, but look more carefully at the parameters used to define narratives.   I was never going to be completely rid of the ambiguity arising from being able to tell more than one story about a curve. Thus, I was aiming to get it to do a pretty good job on fabricated data, but not shoot for near 100% classification. Ultimately, it\u2019d reached well over 85% classification in noisy test data, and the mistakes were likely to be in closely-related narratives.", "With real data, some normalization was in order, to account for how stocks in Japan, say, may behave differently to oil prices. For example, some markets have inherently more variance than others. These adjustments were done using historical data, which I got from Investing.com.", "But even when attempting to be rigorous, such tweaking is not without problems. For example, stocks in developed markets have been supported by a never-ending, \u00fcber-lax monetary policy, which led to record-low volatility for long stretches. Meaning that, even when the classifier\u2019s noise parameters were adjusted based on \u201creal market data\u201d, they are still skewed towards a particular economic environment.", "All the same, the result works well.", "Naturally, I would\u2019ve liked to pin a number to this statement, but this gets us right back to where we started: the oh-so-common problem of acquiring labelled data.", "So instead, I\u2019ll end with a little sample of outputs for real market data from recent months:", "Earlier, I mentioned why people dislike an approach that limits interpretation to a number of fixed narratives. But I never said what makes it so great.", "Well, we don\u2019t have line charts just in financial markets; we have them everywhere.", "Since the narrative structures don\u2019t change, the cost of adapting an existing system to another domain would be writing a tiny number of natural language components, and possibly fine-tuning parameters (particularly noise patterns). That doesn\u2019t seem a huge price to pay.", "Anyhow \u2014 forgive the lame pun\u2014 it\u2019s been a great learning curve. Hope you\u2019ve enjoyed it too!", "[1] A. Bagnall, J. Lines, A. Bostrom, J. Large, E. Keogh, The great time series classification bake off: a review and experimental evaluation of recent algorithmic advances (2016), Data Mining and Knowledge Discovery.", "[2] H. Ismail Fawaz, G. Forestier, J. Weber, L. Idoumghar, and P.-A. Muller, Deep learning for time series classification: a review (2019), Arxiv.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F185094f80db5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----185094f80db5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----185094f80db5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vered.t.zimmerman?source=post_page-----185094f80db5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vered.t.zimmerman?source=post_page-----185094f80db5--------------------------------", "anchor_text": "Vered Zimmerman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F35c722c596d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&user=Vered+Zimmerman&userId=35c722c596d3&source=post_page-35c722c596d3----185094f80db5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F185094f80db5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F185094f80db5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/The_Seven_Basic_Plots", "anchor_text": "seven"}, {"url": "https://www.theatlantic.com/technology/archive/2016/07/the-six-main-arcs-in-storytelling-identified-by-a-computer/490733/", "anchor_text": "six"}, {"url": "https://www.schroders.com/en/insights/economics/quarterly-markets-review---q1-2019/", "anchor_text": "asset manager Schroders"}, {"url": "https://www.investopedia.com/terms/b/bell-curve.asp", "anchor_text": "bell-curve"}, {"url": "https://course.fast.ai/videos/?lesson=7", "anchor_text": "FastAi explaining it"}, {"url": "https://pytorch.org/docs/0.4.0/_modules/torchvision/models/resnet.html", "anchor_text": "PyTorch source code"}, {"url": "https://www.investing.com/markets/", "anchor_text": "Investing.com"}, {"url": "https://link.springer.com/article/10.1007/s10618-016-0483-9", "anchor_text": "The great time series classification bake off: a review and experimental evaluation of recent algorithmic advances"}, {"url": "https://arxiv.org/pdf/1809.04356v3.pdf", "anchor_text": "Deep learning for time series classification: a review"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----185094f80db5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/naturallanguagegeneration?source=post_page-----185094f80db5---------------naturallanguagegeneration-----------------", "anchor_text": "Naturallanguagegeneration"}, {"url": "https://medium.com/tag/financial-markets?source=post_page-----185094f80db5---------------financial_markets-----------------", "anchor_text": "Financial Markets"}, {"url": "https://medium.com/tag/classification?source=post_page-----185094f80db5---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----185094f80db5---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F185094f80db5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&user=Vered+Zimmerman&userId=35c722c596d3&source=-----185094f80db5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F185094f80db5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&user=Vered+Zimmerman&userId=35c722c596d3&source=-----185094f80db5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F185094f80db5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----185094f80db5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F185094f80db5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----185094f80db5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----185094f80db5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----185094f80db5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----185094f80db5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----185094f80db5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----185094f80db5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----185094f80db5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----185094f80db5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----185094f80db5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vered.t.zimmerman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vered.t.zimmerman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vered Zimmerman"}, {"url": "https://medium.com/@vered.t.zimmerman/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "243 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F35c722c596d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&user=Vered+Zimmerman&userId=35c722c596d3&source=post_page-35c722c596d3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3a38ce4b1cd9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinancial-storytelling-using-time-series-classification-185094f80db5&newsletterV3=35c722c596d3&newsletterV3Id=3a38ce4b1cd9&user=Vered+Zimmerman&userId=35c722c596d3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}