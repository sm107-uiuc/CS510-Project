{"url": "https://towardsdatascience.com/top-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb", "time": 1683013140.3041852, "path": "towardsdatascience.com/top-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb/", "webpage": {"metadata": {"title": "Top 5 SQL Analytic Functions Every Data Analyst Needs to Know | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Top 5 SQL Analytic Functions Every Data Analyst Needs to Know", "description": "Analytical functions are one of the most popular tools among BI/Data analysts for performing complex data analysis. These functions perform computations over multiple rows and return the multiple\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.w3resource.com/sql/sql-table.php", "anchor_text": "Orders table", "paragraph_index": 3}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 26}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights.", "paragraph_index": 27}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 29}], "all_paragraphs": ["Analytical functions are one of the most popular tools among BI/Data analysts for performing complex data analysis. These functions perform computations over multiple rows and return the multiple rows as well. Today we\u2019ll cover 5 functions I find most useful, with a lot of practical examples.", "For the uninitiated, the relative size of a query with an analytical function might seem a bit intimidating. Don\u2019t worry, we have you covered. Most of these functions follow a basic syntax:", "There are three parts to this syntax, namely function, partition by and order by. Let\u2019s briefly cover what each one does:", "Okay, we\u2019ve covered the basics thus far. For the practical part we\u2019re gonna use the Orders table stored inside the PostgreSQL database:", "Let\u2019s begin with the practical part now, shall we?", "We\u2019ve all been using aggregate functions such as SUM, AVG, MIN, MAX, and COUNT in our GROUP BY clauses. But when these functions are used over an ORDER BY clause they can give us running sum, mean, total, etc.", "The following example will make it a lot more clear \u2014 we want to calculate the running average revenue and total revenue for each agent in the third quarter:", "Awesome! These functions are simple and require no additional explanations. Let\u2019s proceed.", "FIRST_VALUE() is an analytical function that returns the value of the specified column from the first row of the window frame. If you\u2018ve understood the previous sentence, LAST_VALUE() is self-explanatory. It fetches the value from the last row.", "PostgreSQL provides us with one more additional function called NTH_VALUE(column_name, n) that fetches the value from the n-th row. Isn\u2019t it great? No more complex self joins.", "Let\u2019s answer the following question \u2014 How many days after the first purchase of a customer was the next purchase made?", "There are just so many occasions where this function might be useful. Also, it\u2019s nice to know the results can be obtained from the database directly, so we don\u2019t have to do this calculation manually with Python/R.", "Let\u2019s proceed with the next one.", "LEAD() function, as the name suggests, fetches the value of a specific column from the next row and returns the fetched value in the current row. In PostgreSQL, LEAD() takes two arguments:", "LAG() is just the opposite of. It fetches values from the previous rows.", "Let\u2019s answer the following question to make this concept a bit more clear \u2014 what is the last highest amount for which an order was sold by an agent?", "Above you can see how last_highest_amount clearly shows data per agent \u2014 that\u2019s why there\u2019s no result for agent A001, and first values for other agents are NULL.", "RANK() and DENSE_RANK() are numbering functions. They assign an integer value to a row depending upon the partition and the ordering. I cannot stress enough on the importance of these functions when it comes to finding the nth highest/lowest record from the table.", "DENSE_RANK() and RANK() differ on the point that in the former we get consecutive ranks while in the later the rank after a tie is skipped. For example, ranking using DENSE_RANK() would be something like (1,2,2,3) whereas ranking using RANK() would be (1,2,2,4). Hope you get the difference.", "Anyhow, let\u2019s answer the following question with the help of these functions \u2014 what are the second highest order values for each month?", "Cool! Let\u2019s proceed with the next one.", "CUME_DIST() function is used to calculate the cumulative distribution of values within a given partition. It computes the fraction of rows in the partition that is less than or equal to the current row. It\u2019s very helpful when we have to fetch only the top n% of the results.", "Let\u2019s use it to calculate the revenue percentile for each order in August and September:", "It\u2019s not the function I use on a daily basis, but it\u2019s nice to know it exists.", "And there you have it \u2014 5 most common analytical functions I use when performing analysis in the database. It\u2019s not as common for me as doing analysis with Python and Pandas, but I still find this useful from time to time \u2014 especially for analysts limited only to SQL.", "I hope this 5 will suit you well, and feel free to research and study more on your own. Thanks for reading.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Join my private email list for more helpful insights.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3f32788e4ebb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----3f32788e4ebb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3f32788e4ebb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3f32788e4ebb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@patrickedwardcarr?utm_source=medium&utm_medium=referral", "anchor_text": "Patrick Carr"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.w3resource.com/sql/sql-table.php", "anchor_text": "Orders table"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----3f32788e4ebb---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3f32788e4ebb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/sql?source=post_page-----3f32788e4ebb---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/programming?source=post_page-----3f32788e4ebb---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3f32788e4ebb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3f32788e4ebb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----3f32788e4ebb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3f32788e4ebb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----3f32788e4ebb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3f32788e4ebb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3f32788e4ebb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3f32788e4ebb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3f32788e4ebb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftop-5-sql-analytic-functions-every-data-analyst-needs-to-know-3f32788e4ebb&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}