{"url": "https://towardsdatascience.com/combining-dataframes-using-pandas-b9e2e83b9869", "time": 1683003987.704174, "path": "towardsdatascience.com/combining-dataframes-using-pandas-b9e2e83b9869/", "webpage": {"metadata": {"title": "Combining DataFrames using Pandas | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Combining DataFrames using Pandas", "description": "Pandas is a highly-efficient and widely used data analysis tool. The core data structure of Pandas is DataFrame which represents data in tabular form with labeled rows and columns. There are many\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html", "anchor_text": "ataFrame", "paragraph_index": 0}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 26}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 26}], "all_paragraphs": ["Pandas is a highly-efficient and widely used data analysis tool. The core data structure of Pandas is DataFrame which represents data in tabular form with labeled rows and columns. There are many powerful and flexible functions and methods of DataFrame that ease and expedite the data cleaning and analysis process.", "Note: It may not be proper English to type \u201cDataFrame\u201d but it exists as DataFrame in Pandas syntax. Therefore, throughout this post, I will type it as DataFrame so that you will get used to it. If you type it as \u201cdataframe\u201d or \u201cDataframe\u201d, you will get an error.", "Data science projects usually require us to gather data from different sources. Hence, as part of data preparation, we may need to combine DataFrames. In this post, I will explain the different ways to combine DataFrames.", "One way to combine or concatenate DataFrames is concat() function. It can be used to concatenate DataFrames along rows or columns by changing the axis parameter. The default value of the axis parameter is 0, which indicates combining along rows.", "As you can see in the first figure above, indices of individual DataFrames are kept. In order to change it and re-index the combined DataFrame, ignore_index parameter is set as True.", "join parameter of concat() function determines how to combine DataFrames. The default value is \u2018outer\u2019 returns all indices in both DataFrames. If \u2018inner\u2019 option is selected, only the rows with shared indices are returned. I will change the index of df2 so that you can see the difference between \u2018inner\u2019 and \u2018outer\u2019.", "Pandas also provides ways to label DataFrames so that we know which part comes from which DataFrame. We just pass the list of combined DataFrames in order using keys parameter.", "It also makes it easier to access different parts of DataFrames conveniently:", "One important note about concat() function is that it makes a copy of the data. To prevent making unnecessary copies, the copy parameter needs to set as False. The default value is True.", "append() function is also used to combine DataFrames. It can be seen as a particular case of concat() function (axis=0 and join=\u2019outer\u2019) so I will not cover it in detail but will just give an example to show the syntax.", "Another widely used function to combine DataFrames is merge(). Concat() function simply adds DataFrames on top of each other or adds them side-by-side. It is more like appending DataFrames. Merge() combines DataFrames based on values in shared columns. Merge() function offers more flexibility compared to concat() function. It will be clearer when you see the examples.", "Let\u2019s first take a look at the initial DataFrames:", "The on parameter selects which column or index level is used to merge.", "The column names do not have to be the same. Our focus is the values in columns. Assume two DataFrames have common values in a column that you want to use to merge these DataFrames but the column names are different. In this case, instead of on parameter, you can use left_on and right_on parameters. To show the difference, I will change the column name in df2 and then use merge:", "Although the returned values are the same in column_a and new_column_a, merged DataFrame includes both columns due to having different names.", "You can also pass multiple values to on parameter. The returned DataFrame only includes rows that have the same values in all the columns passed to on parameter.", "df1 and df2 are merged based on the common values in column_a. It\u2019s time to introduce how parameter of merge(). As the name suggests, it indicates how you want to combine. The possible values for how are \u2018inner\u2019, \u2018outer\u2019, \u2018left\u2019, \u2018right\u2019.", "The concept of how is more clear in the figure below. If you are familiar with SQL, the logic is same as SQL joins.", "The figures below represents the concept of how parameters more clearly.", "\u2018outer\u2019, \u2018left\u2019, and \u2018right\u2019 options include data that is not present in one of the DataFrames. The missing parts are automatically filled with NaN values. NaN is the standard representation of missing values in Pandas.", "The default value of how is \u2018inner\u2019 so you don\u2019t have to explicitly write in the function. \u2018Inner\u2019 only returns the rows with common values in column_a.", "When \u2018outer\u2019 is chosen for how parameter, merged DataFrame includes all values of column_a in both DataFrames. However, common values (column_a = 1 and column_a = 2) are not duplicated.", "When \u2018left\u2019 is chosen for how parameter, merged DataFrame includes all rows from left DataFrame. The columns that come from right DataFrame are filled with NaN values if the value in column_a (the column that is passed to on parameter) is not present in right DataFrame. \u2018right\u2019 option is rarely used because you can just change the order of DataFrames in merge function (instead of (df1,df2) use (df2,df1)).", "You may have noticed that a suffix is added to column names that are same in both DataFrames. It is useful to distinguish which column comes from which DataFrame. You can specify the suffix to be added using suffixes parameter.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb9e2e83b9869&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----b9e2e83b9869---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9e2e83b9869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9e2e83b9869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pinewatt?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "pine watt"}, {"url": "https://unsplash.com/s/photos/merge?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html", "anchor_text": "ataFrame"}, {"url": "https://towardsdatascience.com/naive-bayes-classifier-explained-50f9723571ed", "anchor_text": "Naive Bayes Classifier \u2014 Explained"}, {"url": "https://towardsdatascience.com/support-vector-machine-explained-8d75fe8738fd", "anchor_text": "Support Vector Machine \u2014 Explained"}, {"url": "https://towardsdatascience.com/decision-tree-and-random-forest-explained-8d20ddabc9dd", "anchor_text": "Decision Trees and Random Forests \u2014 Explained"}, {"url": "https://towardsdatascience.com/gradient-boosted-decision-trees-explained-9259bd8205af", "anchor_text": "Gradient Boosted Decision Trees \u2014 Explained"}, {"url": "https://towardsdatascience.com/handling-missing-values-with-pandas-b876bf6f008f", "anchor_text": "Handling Missing Values with Pandas"}, {"url": "https://towardsdatascience.com/predicting-used-car-prices-with-machine-learning-fea53811b1ab", "anchor_text": "Predicting Used Car Prices with Machine Learning"}, {"url": "https://towardsdatascience.com/data-cleaning-and-analysis-with-a-bonus-story-36b3ae39564c", "anchor_text": "Data Cleaning and Analysis with a Bonus Story"}, {"url": "https://medium.com/tag/pandas?source=post_page-----b9e2e83b9869---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----b9e2e83b9869---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b9e2e83b9869---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb9e2e83b9869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----b9e2e83b9869---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb9e2e83b9869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----b9e2e83b9869---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9e2e83b9869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb9e2e83b9869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b9e2e83b9869---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b9e2e83b9869--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcombining-dataframes-using-pandas-b9e2e83b9869&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}