{"url": "https://towardsdatascience.com/dynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e", "time": 1683008764.655334, "path": "towardsdatascience.com/dynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e/", "webpage": {"metadata": {"title": "Dynamic Cryptocurrency Trading Backtesting Platform \u2014 Python | by Lee Schmalz | Towards Data Science", "h1": "Dynamic Cryptocurrency Trading Backtesting Platform \u2014 Python", "description": "I\u2019ve recently been very interested in cryptocurrency day trading. While a quick internet search returns a slew of various indicator ideas and trading strategies, such as EMA/SMA crossings, RSI\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 20}], "all_paragraphs": ["I\u2019ve recently been very interested in cryptocurrency day trading. While a quick internet search returns a slew of various indicator ideas and trading strategies, such as EMA/SMA crossings, RSI strategies, On Balance Volume, etc., I\u2019ve found myself never able to find a resource that allows me to answer the question: \u201cWell, does this actually work?\u201d. Frankly, it is impossible to know the answer to this question by looking at charts without testing the strategy over hundreds or even thousands of iterations; a tedious task for a human to pour over. I\u2019ve seen videos and articles of others trying to backtest by hand, clicking, entering, and calculating the buys and sells dictated by their predetermined strategy. In some cases only to find the answer to their question after hours and hours of backtesting: \u201cNo, this strategy doesn\u2019t work. On to the next one.\u201d Other, more programmatic ways of backtesting can speed up the process, such as the TradingView pine editor, or a basic python script; but what if you want to dynamically alter things like stop loss/take profit levels, the cryptocurrencies you\u2019re choosing to trade, or specifics of the strategy itself? Answers to these questions would entail time-consuming alterations to a simple backtesting script. Since this initial interest in cryptocurrency trading, I decided I needed a better platform that was not available anywhere on the web (that I could find free of cost) that would allow me to dynamically iterate over any alterations in any strategy that pique my curiosity. I decided to learn more about dynamic python programming and the Binance API, to ultimately create a tool that would help my former self as a beginner python programmer and trader to answer these questions at the forefront of every \u201cCryptocurrency Trading Strategy\u201d post on the internet.", "The following is a trading environment in which all possible trading strategies can be tested in a very dynamic way that allows even a beginner python programmer to create and backtest their own trading ideas and ultimately, give them an answer to their questions. The only prerequisite knowledge to make use of the environment and implement your own ideas are: a basic understanding of python structures such as for loops and if statements, enough knowledge of pandas to grab the proper price datum from the correct column/index location of the dataframe, and potentially a low-level understanding of object oriented programming, depending on the complexity of your strategy.", "First, reading in the data. In this script, we make use of the binance API that allows data gathering from a host of cryptocurrencies as listed on their exchange. The example given is a single script that reads minute-by-minute price changes for 12 different cryptocurrencies from March 28, 2019 through June 1, 2020 for a total of 618,290 instances of prices for each of 12 cryptocurrencies, resulting in a 211 MB dataframe (this can be expanded, but requires a bit of patience). On my machine, this read from the binance API took approx. 5 hours to complete, but with a simple write to csv can be near instantly retrieved at any future use of the script.", "A few notable things about the data read:", "Great, now we have a large dataset of cryptocurrency prices. Before we get into the trading environment, let\u2019s create a simple memory class that will allow us to store information about each backtest episode.", "This class is pretty self-explanatory; a simple memory object that allows us to append buy/sell actions and also to clear the memory after each episode.", "Now that we have our data and our memory object, let\u2019s get into the trading environment.", "Our environment takes in two parameters: the dataframe that we just created as well as the ratios of the currencies you wish to include in the backtesting process (ex. \u2018BTC\u2019, \u2018LTC\u2019, etc.).", "Our environment also has two methods: reset() and step().", "This is another item that needs little explanation: it simply resets the trading environment to its default state. The purpose of this is when running multiple episodes of backtesting, we will call env.reset() following each episode to reset all of the local variables such as coin balances, the index location of the episode dataframe, any variables that might be necessary to track for your specific strategy, and any other information that might be useful for logging. The default state of the environment is a USD balance of 1.0 and balances for each cryptocurrency of 0.0. Some important notes regarding the reset() method:", "The step method is where the magic happens. I\u2019ll divide this method into two sections: implementing the trading strategy and calculating performance metrics.", "In this example, rather than using a more complex trading strategy you might encounter in deep technical analysis discussions, I\u2019m going to instead be debunking the proclaimed efficacy of a common strategy we\u2019ve all seen elsewhere online: the Moving Average Crossing Strategy. If you are unfamiliar, the gist of this idea is that when a short window moving average crosses above a longer window moving average \u2192 Buy; and when the short window moving average crosses back below the longer window moving average \u2192 Sell.", "Now, I\u2019m not sure if anyone believes this strategy actually works (it may in some cases), but let\u2019s consider it for sake of demonstration of the backtesting environment (and because implementing more complex strategies would remove some of the fun from tinkering with your own ideas). As apparent in the code below, we have two key if statements that examine the moving average changes and decide whether to record a buy or sell (or neither). A couple local variables to be familiar with: money_in and to_buy. These are string variables that keep track of where your money is currently held, and where it\u2019s about to go when a buy is initiated. Once the buy and sell if statements are entered, these variables are updated accordingly; and, as a result, your dictionary of balances are updated according to the current price of your holding. Notice on every buy/sell, the respective balance is multiplied by the TRADING_FEE_MULTIPLIER, in this case, 0.99925. This value is based on the binance trading fee of .075% when paying fees using BNB token (the cheapest option available on the binance exchange), but can be altered based on the trading fees of your specific exchange.", "The two metrics we will use to evaluate performance of the strategy over the backtesting interval are: the net worth of your balances following the backtesting interval and the average market change of the backtesting interval. The net worth of your balances are simply calculated by converting your holdings to USD based on the current price of the currency you hold and the amount of that currency you are holding. The average market change of the interval is calculated by taking the average of the prices of all of the selected currencies at both the beginning and the end of episode, and dividing these values accordingly. The ultimate goal, based on these metrics, is to complete the episode with a higher net worth than what would have happened had you held an average stake in the market (and to have a higher net worth than when you started, obviously).", "Here we step through the environment one minute at a time, buying and selling as dictated by the strategy, and keep track of performance metrics along the way to be outputted to the log.", "Well, as previously foreshadowed due to the simplicity of the strategy, not very well. As shown, we would expect the implementation of this strategy to cause a net worth decline of 4% per day, on average (ouch), in a market that grew by 0.2% per day, on average. But, besides the point, it is shown in the log we now have a quick, dynamic, and easy to read the output of one strategy backtested over 100 randomly selected 1-day intervals between March 2019 and June 2020 along with buy/sell information for each trade. Now, there are some answers to your questions!", "Shown is the output of just two of the 100 episodes. For the sake of brevity, I chose one profitable episode (96) and one unprofitable episode (99) to display, while the actual output displays all 100 episode results. What we really care about, though, is not the results of individual episodes, but the question: \u201cHow does my strategy perform on average?\u201d. This is shown in the final average episode log.", "The python logging package might be useful here for someone running many different strategies and logging in a separate file to compare results.", "Ultimately, day trading is a dangerous space. I hope someone reading this will find this tool useful in exploring their trading ideas, allowing them to be informed in their decisions before bringing their strategies to market. There seems to be a lack of resources out there for someone with a limited knowledge of programming and algorithmic trading to make informed trading decisions; I hope this can partially fill that void.", "In my opinion, using the environment as we have in this example was a nice way to introduce dynamic algorithmic trading to someone who has limited knowledge of object-oriented programming. Personally, I\u2019ve used this tool for backtesting many different strategies that incorporate far more features of the price data, and also allow for some additional functionality; namely, the ability to trade cryptocurrency to cryptocurrency (ex. BTC/LTC pair, etc.), rather than only cryptocurrency to USD and vice-versa. This greater functionality is not an extremely difficult addition; though if there is interest, an outline of a more complex example could be an idea for a future article.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F219dfcd7421e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@leeschmalz?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@leeschmalz?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": "Lee Schmalz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc586527ff3b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&user=Lee+Schmalz&userId=c586527ff3b6&source=post_page-c586527ff3b6----219dfcd7421e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F219dfcd7421e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F219dfcd7421e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.youtube.com/playlist?list=PLkYhK7LiOk0MPp44WMJMnQ4pBknK0Khli", "anchor_text": "https://www.youtube.com/watch?v=PZDFXGIAm2g&t=953s"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----219dfcd7421e---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/tag/trading?source=post_page-----219dfcd7421e---------------trading-----------------", "anchor_text": "Trading"}, {"url": "https://medium.com/tag/backtesting?source=post_page-----219dfcd7421e---------------backtesting-----------------", "anchor_text": "Backtesting"}, {"url": "https://medium.com/tag/python?source=post_page-----219dfcd7421e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/bitcoin?source=post_page-----219dfcd7421e---------------bitcoin-----------------", "anchor_text": "Bitcoin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F219dfcd7421e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&user=Lee+Schmalz&userId=c586527ff3b6&source=-----219dfcd7421e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F219dfcd7421e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&user=Lee+Schmalz&userId=c586527ff3b6&source=-----219dfcd7421e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F219dfcd7421e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F219dfcd7421e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----219dfcd7421e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----219dfcd7421e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----219dfcd7421e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----219dfcd7421e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----219dfcd7421e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@leeschmalz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@leeschmalz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lee Schmalz"}, {"url": "https://medium.com/@leeschmalz/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "209 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc586527ff3b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&user=Lee+Schmalz&userId=c586527ff3b6&source=post_page-c586527ff3b6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8fef7abd8313&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdynamic-cryptocurrency-trading-backtesting-platform-python-219dfcd7421e&newsletterV3=c586527ff3b6&newsletterV3Id=8fef7abd8313&user=Lee+Schmalz&userId=c586527ff3b6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}