{"url": "https://towardsdatascience.com/develop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0", "time": 1683006422.520106, "path": "towardsdatascience.com/develop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0/", "webpage": {"metadata": {"title": "Deep Learning Drawing Recognition App using Flask | Towards Data Science", "h1": "Develop an Interactive Drawing Recognition App based on CNN \u2014 Deploy it with Flask", "description": "Make your Data Science projects accessible to everyone. Learn how to deploy your Machine Learning models online by developing a Deep Learning based Web App with Flask."}, "outgoing_paragraph_urls": [{"url": "https://github.com/hugom1997/Flask-Cnn-Recognition-App", "anchor_text": "github", "paragraph_index": 4}, {"url": "https://console.cloud.google.com/storage/browser/quickdraw_dataset/full/numpy_bitmap/?pli=1", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://github.com/hugom1997/Flask-Cnn-Recognition-App", "anchor_text": "github", "paragraph_index": 20}, {"url": "https://github.com/hugom1997/Flask-Cnn-Recognition-App", "anchor_text": "github", "paragraph_index": 40}], "all_paragraphs": ["Building Machine Learning models is a common task in which you probably feel comfortable with. However, once the model you\u2019ve trained and tested offline satisfies you, what should you do with it ? How would you present it to your non-technical boss or client ? How would you deploy it online so other people can use it ?", "In this article, I will try to tackle those questions that are usually not detailed at school although being an important \u2014 the most important \u2014 part of your Data Science projects.", "To do so, I have decided to take as example a Drawing application that uses a Convolutional Neural Network Model to classify drawings made by the user.", "I\u2019ll first introduce the model and then describe the app developpement. After reading through, I hope that this article will be of any help for your future Data Science projects\u2019 deployment !", "All the following code can be find on my github.", "The first part of this project is to prepare the data and build our model !", "I have decided to use data from the \u2018Quick, draw!\u2019 game where users need to draw as quickly as possible an arbitrary object. The dataset is available here.", "I focus my use case on 6 animals : Cat, Giraffe, Sheep, Bat, Octopus and Camel, making the task a Multiclass Classification. Here is a sample of the data :", "Lucky for us, images from this dataset were already preprocessed to a uniform 28*28 pixel image size. Here are the next steps :", "Once everything is ready, let\u2019s build our model using Keras ! This model will have the following structure :", "Here is the corresponding code :", "Now that our model is ready, we just need to train it and evaluate its performances.", "Our classifier reaches 92.7% accuracy after 15 epochs, which is enough for our recognition app ! Let\u2019s check the confusion matrix.", "As we can see, most of the drawings were well classified. However, some classes seem to be harder to differentiate than others : Cat with Bat or Camel with Sheep for example. This can be explained by similarities in their shapes !", "Here are some images that were misclassified by our model. Most of those images could have been easily mistaken, even by a human eye ! Don\u2019t forget that our dataset gathers handmade human drawings playing the \u2018Quick, Draw!\u2019 game. Thus, many images can be irrelevant for a class.", "Now that our model is ready, we would like to embbed it into a Flask Web-App. To do so, it is more convenient to save (serialize) our model using pickle.", "Note : You could directly train your model into flask, but it would be really time consuming and not user friendly.", "Flask is a web micro-framework written in Python. It allows you to design a solid and professional web application.", "Although it doesn\u2019t require a specific architecture, there are some good practice to follow :", "Let\u2019s now build our app !", "The second part of this project is to get the user input : a drawing that will be classified by our trained model. To do so, we will first design the drawing area using javascript and HTML5. I will not introduce the styles_draw.css in this article but you can find it on my github.", "We now have to use javascript to make it a bit more dynamic ! Otherwise, your canvas won\u2019t do anything \u2026", "This Javascript code allows us to design and interact with our drawing area.", "After my drawing, the canvas looks as follows (this is a giraffe by the way) :", "Now that our canvas is ready to get the user\u2019s drawing, we need to ensure that the image will be able to reach our app in app.py.", "Usually, we can directly use the POST function and submit data through a form. However, submitting raw images cannot currently be done with this method. Moreover, I didn\u2019t want the user to have to save and then upload his drawing as it would have impacted the fluidity of his experience.", "A small trick that I used to overcome this issue was to encode the image in base64 before sending it through the form using the hidden input field set earlier in results.html. This encoding process will then be reversed in app.py.", "Now that we are able to get the user input, it\u2019s time to use it to make prediction ! To do so, we only need one file :", "As stated earlier, app.py is our project\u2019s main file in which the Flask application is instanciated.", "Main points of this code :", "1) Initializing the app and specifying the template folder. We can do that using this line of code :", "2) Define the routes (only two for our app) :", "3) The predict function will be triggered by a POST action from the form (remember when we set this path in result.html thanks to Jinja syntax ! ). It will then proceed as follows :", "\u2014 Our base64 encoded image will look something like that : data:image/png;base64,iVBOR\u2026. Thus, we just need to remove the first 21 characters to get the clean url. To do so, we use the draw[init_base64:]line of code. \u2014", "That\u2019s all ! Almost everything is done. The next step is to display our results.", "Finally, we use results.html to display the prediction computed in app.py. We will again need to use the Jinja syntax to display the prediction.", "Here is the rendering when our prediction is \u201cGiraffe\u201d:", "The last step is to launch our app ! You can go into your Drawing App folder (where you can find app.py at the root) and use flask run.", "That\u2019s it ! In this article, we have seen how to develop a Flask Drawing app that uses a previously built CNN model to classify drawings made by the user.", "This is one over many possible uses of Flask to deploy machine learning models. In fact, an infinity of use cases can be found, and I hope this specific project will help you build other ML web-apps to make your code more accessible to others !", "All the code is available on my github !", "Of course, I didn\u2019t do that all alone. Here is where I found some inspiration :", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analyst @ Airbnb | Data Science & New techs enthusiast \u2014 Constantly looking for new challenges !"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F95a805de10c0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----95a805de10c0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95a805de10c0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@hugom1997?source=post_page-----95a805de10c0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hugom1997?source=post_page-----95a805de10c0--------------------------------", "anchor_text": "Hugo Mallet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f5cbd1c2036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&user=Hugo+Mallet&userId=1f5cbd1c2036&source=post_page-1f5cbd1c2036----95a805de10c0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95a805de10c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95a805de10c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@drieaugu?utm_source=medium&utm_medium=referral", "anchor_text": "Dries Augustyns"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/hugom1997/Flask-Cnn-Recognition-App", "anchor_text": "github"}, {"url": "https://console.cloud.google.com/storage/browser/quickdraw_dataset/full/numpy_bitmap/?pli=1", "anchor_text": "here"}, {"url": "https://github.com/hugom1997/Flask-Cnn-Recognition-App", "anchor_text": "github"}, {"url": "https://jinja.palletsprojects.com/en/2.11.x/templates/", "anchor_text": "Jinja"}, {"url": "http://localhost:5000/", "anchor_text": "127.0.0.1:5000"}, {"url": "https://github.com/hugom1997/Flask-Cnn-Recognition-App", "anchor_text": "github"}, {"url": "https://www.datacareer.de/blog/quick-draw-classifying-drawings-with-python/", "anchor_text": "'Quick, Draw!' - Classifying Drawings with PythonImage recognition has been a major challenge in machine learning, and working with large labelled datasets to train\u2026www.datacareer.de"}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "Welcome to Flask - Flask Documentation (1.1.x)Welcome to Flask's documentation. Get started with Installation and then get an overview with the Quickstart . There is\u2026flask.palletsprojects.com"}, {"url": "http://www.williammalone.com/articles/create-html5-canvas-javascript-drawing-app/", "anchor_text": "Create a Drawing App with HTML5 Canvas and JavaScriptWilliam Malone: This tutorial will take you step by step through the development of a simple web drawing application\u2026www.williammalone.com"}, {"url": "https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/", "anchor_text": "Handwritten Digit Recognition using Convolutional Neural Networks in Python with Keras - Machine\u2026Last Updated on A popular demonstration of the capability of deep learning techniques is object recognition in image\u2026machinelearningmastery.com"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----95a805de10c0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----95a805de10c0---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/flask-framework?source=post_page-----95a805de10c0---------------flask_framework-----------------", "anchor_text": "Flask Framework"}, {"url": "https://medium.com/tag/web-app-development?source=post_page-----95a805de10c0---------------web_app_development-----------------", "anchor_text": "Web App Development"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----95a805de10c0---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95a805de10c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&user=Hugo+Mallet&userId=1f5cbd1c2036&source=-----95a805de10c0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95a805de10c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&user=Hugo+Mallet&userId=1f5cbd1c2036&source=-----95a805de10c0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95a805de10c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95a805de10c0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F95a805de10c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----95a805de10c0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----95a805de10c0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----95a805de10c0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----95a805de10c0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----95a805de10c0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----95a805de10c0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----95a805de10c0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----95a805de10c0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----95a805de10c0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hugom1997?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@hugom1997?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hugo Mallet"}, {"url": "https://medium.com/@hugom1997/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "55 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f5cbd1c2036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&user=Hugo+Mallet&userId=1f5cbd1c2036&source=post_page-1f5cbd1c2036--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F210640d76584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-an-interactive-drawing-recognition-app-based-on-cnn-deploy-it-with-flask-95a805de10c0&newsletterV3=1f5cbd1c2036&newsletterV3Id=210640d76584&user=Hugo+Mallet&userId=1f5cbd1c2036&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}