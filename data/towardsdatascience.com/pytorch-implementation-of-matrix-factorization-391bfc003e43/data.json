{"url": "https://towardsdatascience.com/pytorch-implementation-of-matrix-factorization-391bfc003e43", "time": 1683009630.075201, "path": "towardsdatascience.com/pytorch-implementation-of-matrix-factorization-391bfc003e43/", "webpage": {"metadata": {"title": "PyTorch Implementation of Matrix Factorization | by Andrewngai | Towards Data Science", "h1": "PyTorch Implementation of Matrix Factorization", "description": "Matrix Factorization (MF) (e.g., Probabilistic Matrix Factorization and NonNegative Matrix Factorization) techniques have become the crux of many real-world scenarios, including graph representation\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/andrewngai9255/", "anchor_text": "Linkedin", "paragraph_index": 8}], "all_paragraphs": ["Matrix Factorization (MF) (e.g., Probabilistic Matrix Factorization and NonNegative Matrix Factorization) techniques have become the crux of many real-world scenarios, including graph representation and recommendation system (RecSys) because they are powerful models to \ufb01nd the hidden properties behind the data. More speci\ufb01cally, Non-Negative Matrix Factorization (NNMF) is a group of models in multivariate analysis and linear algebra where a matrix A(dimension B*C) is decomposed into B (dimension B*d) and C (dimension C*d)", "where F denotes the Frobenius norm.", "The idea behind matrix factorization is to represent users and items in a lower-dimensional latent space. And is widely used in the recommendation system and dimensionality reduction. Although, there are many Python libraries that could perform matrix factorization, building the algorithm from scratch could be helpful to understand the basics. Also, there are many complex cases when the matrix factorization library could not handle. In this article, I will demonstrate how to implement matrix factorization in PyTorch with different use-cases that normal MF libraries do not perform well.", "Given a graph G = (E, V), V is the set of nodes and E is the set of edges. the adjacency matrix of G is represented by V * V matrix A. where Xij = 1 if there is an edge E between the node Vi with the node Vj, otherwise Xij =0. Following by the previous formula, we can represent nodes V into a V * d matrix by minimizing the loss", "In this case, we are doing matrix factorization into a single matrix which is usually not supported by most libraries. To solve this problem we use PyTorch to construct an NN model with only one layer and apply SGD optimizer to backpropagate gradient. The loss function can be present by nn.MSELoss (reduction=\u2019sum\u2019) which is the Frobenius norm sum. It is important to make sure the factorization matrix and the product of the matrix does not have non-positive value as Non-Negative Matrix Factorization (NNMF). You can either apply a torch Threshold(0,0) function to mark all negative values to 0 in each epoch or add a Relu output layer.", "In real-world applications, it is important to handle the cold-start issue in RecSys since there are new movies coming out every day. The user-movie RecSys cannot well handle this issue since no user has seen a new movie before. This is a variant of MF techniques to alleviate the cold-start issue by incorporating the information of movie tags.", "Given a collection of users U, movies V and movie tags T. let X be a U*V matrix denotes the user history of rating items, where Xij = 0 if ith user Ui has not rated the jth movie Vj, otherwise Xij =(0,5] represents the ratings of Ui to the movie Vj range from 1 to 5. let Y be a T*V matrix denote movie tag information, where Yij = 1 if movie Vj is tagged with Ti, otherwise Yij = 0. Therefore, you can represent users U, movies V, and tags T. Therefore, you can represent users U, movies V, and tags, T into U, V, and T where", "In this case, we are doing multiply matrix factorization and minimizing the total loss of the sum. This is also hard to implement with normal MF libraries. However, with PyTorch we just need to redefine the loss function.", "Thanks for reading and I am looking forward to hearing your questions and thoughts. If you want to learn more about Data Science and Cloud Computing, you can find me on Linkedin.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Big Data Specialist, AWS Certified Solution Architect , Experienced Project Manager specializing in AWS/Azure Cloud infrastructure and Big Data Project"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F391bfc003e43&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----391bfc003e43--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----391bfc003e43--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andrewngai9255.medium.com/?source=post_page-----391bfc003e43--------------------------------", "anchor_text": ""}, {"url": "https://andrewngai9255.medium.com/?source=post_page-----391bfc003e43--------------------------------", "anchor_text": "Andrewngai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa9b59d3719b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&user=Andrewngai&userId=a9b59d3719b5&source=post_page-a9b59d3719b5----391bfc003e43---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F391bfc003e43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F391bfc003e43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nhillier?utm_source=medium&utm_medium=referral", "anchor_text": "Nick Hillier"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.linkedin.com/in/andrewngai9255/", "anchor_text": "Linkedin"}, {"url": "https://unsplash.com/@alfonsmc10?utm_source=medium&utm_medium=referral", "anchor_text": "Alfons Morales"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----391bfc003e43---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/matrix-factorization?source=post_page-----391bfc003e43---------------matrix_factorization-----------------", "anchor_text": "Matrix Factorization"}, {"url": "https://medium.com/tag/data-mining?source=post_page-----391bfc003e43---------------data_mining-----------------", "anchor_text": "Data Mining"}, {"url": "https://medium.com/tag/nmf?source=post_page-----391bfc003e43---------------nmf-----------------", "anchor_text": "Nmf"}, {"url": "https://medium.com/tag/python?source=post_page-----391bfc003e43---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F391bfc003e43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&user=Andrewngai&userId=a9b59d3719b5&source=-----391bfc003e43---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F391bfc003e43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&user=Andrewngai&userId=a9b59d3719b5&source=-----391bfc003e43---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F391bfc003e43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----391bfc003e43--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F391bfc003e43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----391bfc003e43---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----391bfc003e43--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----391bfc003e43--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----391bfc003e43--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----391bfc003e43--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----391bfc003e43--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----391bfc003e43--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----391bfc003e43--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----391bfc003e43--------------------------------", "anchor_text": ""}, {"url": "https://andrewngai9255.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andrewngai9255.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrewngai"}, {"url": "https://andrewngai9255.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "160 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa9b59d3719b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&user=Andrewngai&userId=a9b59d3719b5&source=post_page-a9b59d3719b5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffa824db741a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-implementation-of-matrix-factorization-391bfc003e43&newsletterV3=a9b59d3719b5&newsletterV3Id=fa824db741a3&user=Andrewngai&userId=a9b59d3719b5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}