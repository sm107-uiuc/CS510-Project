{"url": "https://towardsdatascience.com/depth-estimation-on-camera-images-using-densenets-ac454caa893", "time": 1682996512.423058, "path": "towardsdatascience.com/depth-estimation-on-camera-images-using-densenets-ac454caa893/", "webpage": {"metadata": {"title": "Depth Estimation on Camera Images using DenseNets | by Priya Dwivedi | Towards Data Science", "h1": "Depth Estimation on Camera Images using DenseNets", "description": "The human brain possesses the remarkable ability to infer depth when viewing a two-dimensional scene, even with a single-point measurement, as in viewing a photograph. However, accurate depth mapping\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cs.nyu.edu/~silberman/datasets/nyu_depth_v2.html", "anchor_text": "NYU Depth Data", "paragraph_index": 0}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/tree/master/depth_estimation", "anchor_text": "Github repo", "paragraph_index": 2}, {"url": "https://www.jameco.com/jameco/workshop/howitworks/xboxkinect.html", "anchor_text": "Kinect", "paragraph_index": 4}, {"url": "https://cs.nyu.edu/~silberman/datasets/nyu_depth_v2.html", "anchor_text": "NYU v2 depth data set", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1812.11941", "anchor_text": "Dense Depth model from Alhashim and Wonka", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNet", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1812.11941", "anchor_text": "original paper", "paragraph_index": 7}, {"url": "https://github.com/ialhashim/DenseDepth", "anchor_text": "the repo", "paragraph_index": 8}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/tree/master/depth_estimation", "anchor_text": "github repo", "paragraph_index": 10}, {"url": "http://deeplearninganalytics.org/", "anchor_text": "http://deeplearninganalytics.org/", "paragraph_index": 14}, {"url": "https://medium.com/@priya.dwivedi", "anchor_text": "https://medium.com/@priya.dwivedi", "paragraph_index": 15}], "all_paragraphs": ["The human brain possesses the remarkable ability to infer depth when viewing a two-dimensional scene, even with a single-point measurement, as in viewing a photograph. However, accurate depth mapping from a single image remains a challenge in computer vision. Depth informationfrom a scene is valuable for many tasks like augmented reality, robotics, self driving cars etc. In this blog we explore how to train a depth estimation model on NYU Depth Data set. The model gets state of the art results on this data set. We also add code to test this model on images + videos collected by the user.", "The trained model performs very well on data from the wild as shown in the video below.", "The full code is open sourced on my Github repo.", "What does the depth information look like? Depth can be stored as the distance from the camera in meters for each pixel in the image frame. Figure below shows the depth map for a single RGB image. The depth map is on the right where actual depth has been converted to relative depth using the maximum depth of this room.", "To build a depth estimation model, we need RGB images and corresponding depth information. Depth information can be collected through low cost sensors like Kinect. For this exercise, I have used the popular NYU v2 depth data set to build a model. This data set consists of over 400,000 images and their corresponding depth maps. I used a subset of 50,000 images from the overall data set for the training task.", "I read through several papers that perform the task of depth estimation and many of them use an encoder decoder type neural network. For depth estimation task, the input to the model is a RGB image and the output is a depth image which is either the same dimension as the input image or sometimes scaled down version of the input image with the same aspect ratio.A standard loss function used for this task considers difference between the actual and predicted depth map. This can be L1 or L2 loss.", "I decided to work with the Dense Depth model from Alhashim and Wonka. This model is impressive in its simplicity and its accuracy. It is easy to understand and relatively fast to train. It uses image augmentation and a custom loss function to get better results than from more complex architectures. This model uses the powerful DenseNet model with pretrained weights to power the Encoder.", "The encoder presented in the paper is a pretrained DenseNet 169. Theencoder consists of 4 dense blocks that occur before the fully connected layers in the DenseNet 169 model. It is different from other depth models in that it uses a very simple decoder. Each decoder block consists of a single bi-linear upsampling layer followed by 2 convolution layers. Following another standard practice in encoder decoder architecture, the up sampling layers are concatenated with the corresponding layers in the encoder. Figure below, explains the architecture in more detail. For more details on layers please read the original paper. It is very well written!", "Dense Depth was trained on a 50K sample of NYU-v2 data set. The input were RGB image of 640x480 resolution and output was a depth map of 320 x 240 resolution. The model was trained in Keras using Adam optimizer. I leveraged the repo from Dense Depth authors to get started.", "Three different model architectures were trained:", "All these code modifications are pushed to the github repo with explanations on how to do training, evaluation and testing.", "We compare the model performance using three different metrics \u2014 average relative error (rel) in predicted and actual depth, RMSE (rms) \u2014 root mean square error in actual and predicted depth and average log error (log) between the two depths. Lower values for all these metrics indicate a stronger model.", "As shown in the table above, DenseNet 169 model has better performance than DenseNet121 and ResNet 50. Also my trained DenseNet 169 is very close in performance to the one from the original authors (Alhashim and Wonka).", "We hope this blog proves to be a good starting point to understand how depth estimation works. We have provided a pipeline to use a powerful, simple and easy to train Depth Estimation model. We have also shared code that can be used to get depth images from indoor images or videos you collect. Hope you try the code out for yourself.", "I have my own deep learning consultancy and love to work on interesting problems. I have helped many startups deploy innovative AI based solutions. Check us out at \u2014 http://deeplearninganalytics.org/. If you have a project that we can collaborate on, then please contact me through my website or at info@deeplearninganalytics.org", "You can also see my other writings at: https://medium.com/@priya.dwivedi", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac454caa893&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac454caa893--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac454caa893--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----ac454caa893--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----ac454caa893--------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438----ac454caa893---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac454caa893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac454caa893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cs.nyu.edu/~silberman/datasets/nyu_depth_v2.html", "anchor_text": "NYU Depth Data"}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/tree/master/depth_estimation", "anchor_text": "Github repo"}, {"url": "https://www.jameco.com/jameco/workshop/howitworks/xboxkinect.html", "anchor_text": "Kinect"}, {"url": "https://cs.nyu.edu/~silberman/datasets/nyu_depth_v2.html", "anchor_text": "NYU v2 depth data set"}, {"url": "https://arxiv.org/abs/1812.11941", "anchor_text": "Dense Depth model from Alhashim and Wonka"}, {"url": "https://arxiv.org/abs/1608.06993", "anchor_text": "DenseNet"}, {"url": "https://arxiv.org/abs/1812.11941", "anchor_text": "original paper"}, {"url": "https://github.com/ialhashim/DenseDepth", "anchor_text": "the repo"}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/tree/master/depth_estimation", "anchor_text": "github repo"}, {"url": "http://deeplearninganalytics.org/", "anchor_text": "http://deeplearninganalytics.org/"}, {"url": "https://medium.com/@priya.dwivedi", "anchor_text": "https://medium.com/@priya.dwivedi"}, {"url": "https://github.com/ialhashim/DenseDepth", "anchor_text": "Dense Depth Original Github"}, {"url": "https://arxiv.org/abs/1812.11941", "anchor_text": "Dense Depth Paper"}, {"url": "https://cs.nyu.edu/~silberman/datasets/nyu_depth_v2.html", "anchor_text": "NYU V2 data set"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac454caa893---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ac454caa893---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ac454caa893---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----ac454caa893---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ac454caa893---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac454caa893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&user=Priya+Dwivedi&userId=b040ce924438&source=-----ac454caa893---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac454caa893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&user=Priya+Dwivedi&userId=b040ce924438&source=-----ac454caa893---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac454caa893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac454caa893--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac454caa893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac454caa893---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac454caa893--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac454caa893--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac454caa893--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac454caa893--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac454caa893--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac454caa893--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac454caa893--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac454caa893--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://priya-dwivedi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.1K Followers"}, {"url": "http://www.deeplearninganalytics.org/", "anchor_text": "http://www.deeplearninganalytics.org/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F373349a3bfb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdepth-estimation-on-camera-images-using-densenets-ac454caa893&newsletterV3=b040ce924438&newsletterV3Id=373349a3bfb7&user=Priya+Dwivedi&userId=b040ce924438&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}