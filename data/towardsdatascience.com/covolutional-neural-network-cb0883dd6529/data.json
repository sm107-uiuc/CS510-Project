{"url": "https://towardsdatascience.com/covolutional-neural-network-cb0883dd6529", "time": 1682995154.21339, "path": "towardsdatascience.com/covolutional-neural-network-cb0883dd6529/", "webpage": {"metadata": {"title": "Convolutional Neural Network. Learn Convolutional Neural Network from\u2026 | by dshahid380 | Towards Data Science", "h1": "Convolutional Neural Network", "description": "Computer vision is evolving rapidly day-by-day. Its one of the reason is deep learning. When we talk about computer vision, a term convolutional neural network( abbreviated as CNN) comes in our mind\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/dshahid380/CIFAR-10", "anchor_text": "You can find all code in my Github", "paragraph_index": 40}], "all_paragraphs": ["Computer vision is evolving rapidly day-by-day. Its one of the reason is deep learning. When we talk about computer vision, a term convolutional neural network( abbreviated as CNN) comes in our mind because CNN is heavily used here. Examples of CNN in computer vision are face recognition, image classification etc. It is similar to the basic neural network. CNN also have learnable parameter like neural network i.e, weights, biases etc.", "Suppose you are working with MNIST dataset, you know each image in MNIST is 28 x 28 x 1(black & white image contains only 1 channel). Total number of neurons in input layer will 28 x 28 = 784, this can be manageable. What if the size of image is 1000 x 1000 which means you need 10\u2076 neurons in input layer. Oh! This seems a huge number of neurons are required for operation. It is computationally ineffective right. So here comes Convolutional Neural Network or CNN. In simple word what CNN does is, it extract the feature of image and convert it into lower dimension without loosing its characteristics. In the following example you can see that initial the size of the image is 224 x 224 x 3. If you proceed without convolution then you need 224 x 224 x 3 = 100, 352 numbers of neurons in input layer but after applying convolution you input tensor dimension is reduced to 1 x 1 x 1000. It means you only need 1000 neurons in first layer of feedforward neural network.", "There are few definitions you should know before understanding CNN", "Thinking about images, its easy to understand that it has a height and width, so it would make sense to represent the information contained in it with a two dimensional structure (a matrix) until you remember that images have colors, and to add information about the colors, we need another dimension, and that is when Tensors become particularly helpful.", "Images are encoded into color channels, the image data is represented into each color intensity in a color channel at a given point, the most common one being RGB, which means Red, Blue and Green. The information contained into an image is the intensity of each channel color into the width and height of the image, just like this", "So the intensity of the red channel at each point with width and height can be represented into a matrix, the same goes for the blue and green channels, so we end up having three matrices, and when these are combined they form a tensor.", "Every image has vertical and horizontal edges which actually combining to form a image. Convolution operation is used with some filters for detecting edges. Suppose you have gray scale image with dimension 6 x 6 and filter of dimension 3 x 3(say). When 6 x 6 grey scale image convolve with 3 x 3 filter, we get 4 x 4 image. First of all 3 x 3 filter matrix get multiplied with first 3 x 3 size of our grey scale image, then we shift one column right up to end , after that we shift one row and so on.", "The convolution operation can be visualized in the following way. Here our image dimension is 4 x 4 and filter is 3 x 3, hence we are getting output after convolution is 2 x 2.", "If we have N x N image size and F x F filter size then after convolution result will be", "Stride denotes how many steps we are moving in each steps in convolution.By default it is one.", "We can observe that the size of output is smaller that input. To maintain the dimension of output as in input , we use padding. Padding is a process of adding zeros to the input matrix symmetrically. In the following example,the extra grey blocks denote the padding. It is used to make the dimension of output same as input.", "Let say \u2018p\u2019 is the padding", "If we apply filter F x F in (N+2p) x (N+2p) input matrix with padding, then we will get output matrix dimension (N+2p-F+1) x (N+2p-F+1). As we know that after applying padding we will get the same dimension as original input dimension (N x N). Hence we have,", "The equation (3) clearly shows that Padding depends on the dimension of filter.", "There are five different layers in CNN", "Input layer in CNN should contain image data. Image data is represented by three dimensional matrix as we saw earlier. You need to reshape it into a single column. Suppose you have image of dimension 28 x 28 =784, you need to convert it into 784 x 1 before feeding into input. If you have \u201cm\u201d training examples then dimension of input will be (784, m).", "Convo layer is sometimes called feature extractor layer because features of the image are get extracted within this layer. First of all, a part of image is connected to Convo layer to perform convolution operation as we saw earlier and calculating the dot product between receptive field(it is a local region of the input image that has the same size as that of filter) and the filter. Result of the operation is single integer of the output volume. Then we slide the filter over the next receptive field of the same input image by a Stride and do the same operation again. We will repeat the same process again and again until we go through the whole image. The output will be the input for the next layer.", "Convo layer also contains ReLU activation to make all negative value to zero.", "Pooling layer is used to reduce the spatial volume of input image after convolution. It is used between two convolution layer. If we apply FC after Convo layer without applying pooling or max pooling, then it will be computationally expensive and we don\u2019t want it. So, the max pooling is only way to reduce the spatial volume of input image. In the above example, we have applied max pooling in single depth slice with Stride of 2. You can observe the 4 x 4 dimension input is reduce to 2 x 2 dimension.", "There is no parameter in pooling layer but it has two hyperparameters \u2014 Filter(F) and Stride(S).", "In general, if we have input dimension W1 x H1 x D1, then", "Where W2, H2 and D2 are the width, height and depth of output.", "Fully connected layer involves weights, biases, and neurons. It connects neurons in one layer to neurons in another layer. It is used to classify images between different category by training.", "Softmax or Logistic layer is the last layer of CNN. It resides at the end of FC layer. Logistic is used for binary classification and softmax is for multi-classification.", "Output layer contains the label which is in the form of one-hot encoded.", "Now you have a good understanding of CNN. Let\u2019s implement a CNN in Keras.", "We will use CIFAR-10 dataset to build a CNN image classifier. CIFAR-10 dataset has 10 different labels", "If you are using google colaboratory, then make sure you are using GPU. To check whether your GPU is on or not. Try following code.", "First of all, import all necessary modules and libraries.", "Then load the dataset and split it into train and test sets.", "We will print training sample shape, test sample shape and total number of classes present in CIFAR-10. There are 10 classes as we saw earlier. For the sake of example, we will print two example image from training set and test set.", "Find the shape of input image then reshape it into input format for training and testing sets. After that change all datatypes into floats.", "Normalize the data between 0\u20131 by dividing train data and test data with 255 then convert all labels into one-hot vector with to_catagorical() function.", "Display the change for category label using one-hot encoding.", "Now create our model. We will add up Convo layers followed by pooling layers. Then we will connect Dense(FC) layer to predict the classes. Input data fed to first Convo layer, output of that Convo layer acts as input for next Convo layer and so on. Finally data is fed to FC layer which try to predict the correct labels.", "Initialize all parameters and compile our model with rmsprops optimizer. There are many optimizers for example adam, SGD, GradientDescent, Adagrad, Adadelta and Adamax ,feel free to experiment with it. Here batch is 256 with 50 epochs.", "model.summary() is used to see all parameters and shapes in each layers in our models. You can observe that total parameters are 276, 138 and total trainable parameters are 276, 138. Non-trainable parameter is 0.", "After compiling our model, we will train our model by fit() method, then evaluate it.", "After training we got 83.86% accuracy and 75.48% validation accuracy. It is not actually bad at all.", "Congratulations! You have made Convolutional Neural Network in Keras by understanding its basic concepts. Feel free to experiment with it by changing its hyperparameters and let me know in the comment section.", "You can find all code in my Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcb0883dd6529&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dshahid380?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshahid380?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": "dshahid380"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F86ba77a143ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&user=dshahid380&userId=86ba77a143ad&source=post_page-86ba77a143ad----cb0883dd6529---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcb0883dd6529&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcb0883dd6529&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://cs231n.github.io/assets/cnn/pool.jpeg", "anchor_text": "Source"}, {"url": "https://github.com/dshahid380/CIFAR-10", "anchor_text": "You can find all code in my Github"}, {"url": "http://cs231n.github.io/convolutional-networks/", "anchor_text": "CS231n Convolutional Neural Network"}, {"url": "https://keras.io/", "anchor_text": "Keras documentation"}, {"url": "https://medium.com/deep-learning-turkey/deep-learning-lab-episode-2-cifar-10-631aea84f11e", "anchor_text": "Deep Learning Lab"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cb0883dd6529---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----cb0883dd6529---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----cb0883dd6529---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/convolutional-neural-net?source=post_page-----cb0883dd6529---------------convolutional_neural_net-----------------", "anchor_text": "Convolutional Neural Net"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----cb0883dd6529---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcb0883dd6529&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&user=dshahid380&userId=86ba77a143ad&source=-----cb0883dd6529---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcb0883dd6529&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&user=dshahid380&userId=86ba77a143ad&source=-----cb0883dd6529---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcb0883dd6529&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcb0883dd6529&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cb0883dd6529---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cb0883dd6529--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cb0883dd6529--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cb0883dd6529--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cb0883dd6529--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshahid380?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshahid380?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "dshahid380"}, {"url": "https://medium.com/@dshahid380/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "169 Followers"}, {"url": "https://www.linkedin.com/in/dshahid380/", "anchor_text": "https://www.linkedin.com/in/dshahid380/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F86ba77a143ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&user=dshahid380&userId=86ba77a143ad&source=post_page-86ba77a143ad--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5fdc47c99adc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovolutional-neural-network-cb0883dd6529&newsletterV3=86ba77a143ad&newsletterV3Id=5fdc47c99adc&user=dshahid380&userId=86ba77a143ad&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}