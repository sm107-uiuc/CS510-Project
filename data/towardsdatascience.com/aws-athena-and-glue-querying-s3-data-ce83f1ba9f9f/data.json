{"url": "https://towardsdatascience.com/aws-athena-and-glue-querying-s3-data-ce83f1ba9f9f", "time": 1683005787.026231, "path": "towardsdatascience.com/aws-athena-and-glue-querying-s3-data-ce83f1ba9f9f/", "webpage": {"metadata": {"title": "AWS Athena and Glue: Querying S3 data | by Michael Grogan | Towards Data Science", "h1": "AWS Athena and Glue: Querying S3 data", "description": "In this particular example, let\u2019s see how AWS Glue can be used to load a csv file from an S3 bucket into Glue, and then run SQL queries on this data in Athena. Here is the CSV file in the S3 bucket\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/MGCodesandStats/aws-glue-athena-hotels", "anchor_text": "MGCodesandStats GitHub repository", "paragraph_index": 19}, {"url": "https://www.michael-grogan.com/", "anchor_text": "michael-grogan.com", "paragraph_index": 20}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 23}], "all_paragraphs": ["In this particular example, let\u2019s see how AWS Glue can be used to load a csv file from an S3 bucket into Glue, and then run SQL queries on this data in Athena.", "Here is the CSV file in the S3 bucket as illustrated below \u2014 the dataset itself is available from the GitHub repository referenced at the end of this article.", "A crawler is used to extract data from a source, analyse that data and then ensure that the data fits a particular schema \u2014 or structure that defines the data type for each variable in the table.", "The crawler is defined, with the Data Store, IAM role, and Schedule set.", "The crawler will take a little while to extract the table, depending on the size of your data. Here, the crawler was scheduled to run on demand.", "However, it is also possible to set the crawler to run on a particular schedule.", "This is particularly important for when the data in an S3 bucket is being updated or changed at periodic intervals \u2014 one must ensure that the data in Glue remains current.", "The table is now present in AWS Glue. Here, the schema is being detected automatically.", "However, the schema can also be edited by selecting Edit Schema, and then manually defining the data types for each variable:", "Now that the table is formulated in AWS Glue, let\u2019s try to run some queries!", "Athena is an AWS service that allows for running of standard SQL queries on data in S3. As the schema has already been established in Glue and the table loaded into a database, all we simply have to do is now query our data.", "The particular dataset that is being analysed is that of hotel bookings.", "Let\u2019s use some SQL queries to do the following:", "select * from table where country like \u2018P%\u2019;", "select avg(leadtime) from table where country=\u2019PRT\u2019;", "select avg(adr) from table where country=\u2019GBR\u2019 and marketsegment=\u2019Direct\u2019;", "select * from table order by country, reservedroomtype, customertype;", "These queries can also be saved for use later. Let\u2019s save query 3 as an example.", "In this example, you have seen:", "Many thanks for your time, and the relevant dataset is available at the MGCodesandStats GitHub repository.", "You can also find further of my data science content at michael-grogan.com.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fce83f1ba9f9f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----ce83f1ba9f9f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fce83f1ba9f9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fce83f1ba9f9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/MGCodesandStats/aws-glue-athena-hotels", "anchor_text": "MGCodesandStats GitHub repository"}, {"url": "https://www.michael-grogan.com/", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/tag/amazon-web-services?source=post_page-----ce83f1ba9f9f---------------amazon_web_services-----------------", "anchor_text": "Amazon Web Services"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ce83f1ba9f9f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ce83f1ba9f9f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/big-data?source=post_page-----ce83f1ba9f9f---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/aws?source=post_page-----ce83f1ba9f9f---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fce83f1ba9f9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&user=Michael+Grogan&userId=eec017a8b178&source=-----ce83f1ba9f9f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fce83f1ba9f9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&user=Michael+Grogan&userId=eec017a8b178&source=-----ce83f1ba9f9f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fce83f1ba9f9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fce83f1ba9f9f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ce83f1ba9f9f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ce83f1ba9f9f--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faws-athena-and-glue-querying-s3-data-ce83f1ba9f9f&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}