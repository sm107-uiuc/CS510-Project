{"url": "https://towardsdatascience.com/the-nbas-2023-mvp-is-ff78deb85122", "time": 1683008343.171633, "path": "towardsdatascience.com/the-nbas-2023-mvp-is-ff78deb85122/", "webpage": {"metadata": {"title": "The NBA\u2019s 2023 MVP Is \u2026. Predicting NBA Players\u2019 Careers Using\u2026 | by Alex Muhr | Towards Data Science", "h1": "The NBA\u2019s 2023 MVP Is \u2026", "description": "There\u2019s something about being a sports fan, some insatiable itch that causes us to incessantly make bold predictions of the future. Massive industries have arisen to scratch this itch, fantasy sports\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/the-asset-of-age-e4b45599ea94", "anchor_text": "The Asset of Age", "paragraph_index": 1}, {"url": "https://github.com/alexmuhr/NBA_Player_Predictions", "anchor_text": "Github", "paragraph_index": 3}, {"url": "https://sportsreference.readthedocs.io/en/stable/", "anchor_text": "Sports Reference API", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/sports-reference-api-intro-dbce09e89e52", "anchor_text": "article", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Logit", "anchor_text": "logit", "paragraph_index": 15}, {"url": "https://towardsdatascience.com/beating-the-odds-8d26b1a83f1b", "anchor_text": "Beating the Odds", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Sigmoid_function", "anchor_text": "sigmoid", "paragraph_index": 15}, {"url": "https://www.sun-sentinel.com/news/fl-xpm-2001-04-13-0104121399-story.html", "anchor_text": "rule changes in 2001 eliminated restrictions on zone defense", "paragraph_index": 31}], "all_paragraphs": ["There\u2019s something about being a sports fan, some insatiable itch that causes us to incessantly make bold predictions of the future. Massive industries have arisen to scratch this itch, fantasy sports and gambling immediately come to mind. Further, when we run out of things to predict within the field of play, our predictions bleed outside the lines. With the most recent Super Bowl it was not only possible to bet on the game\u2019s MVP, one could also place bets on the Puppy Bowl MVP. Clearly we just can\u2019t help ourselves. When it comes to making predictions, I\u2019m no different than the rest.", "Welcome to the fourth installment in my sports-themed data science series. A couple weeks ago I published The Asset of Age, which details why NBA GMs covet teenagers in the NBA draft. To summarize, players typically develop rapidly during their late teens and early twenties, and this can be quite clearly shown with data.", "To take this concept of player development a step further and into the realm of predictions, I used the data I had collected for my previous analysis to build a model for projecting the stats of NBA players into the future. In this article, I discuss the overall concept of the project, data preparation, model design, and performance characterization. At the end of the article, I\u2019ll present my prediction for the NBA\u2019s 2023 MVP.", "All code needed to reproduce this project can be found on Github.", "The general concept for this project is that a player\u2019s past performance and age are predictive of their future performance. Barring injury, a player\u2019s next season will usually be similar to their most recent season. With this in mind, it\u2019s possible to use statistics of past seasons to predict 1 season into the future. The output prediction can then be used as an input to predict 2 seasons into the future, which can then be used to predict 3 seasons into the future, etc.", "What I\u2019ve just described is a recurrent model. Recurrent neural networks are the most popular recurrent models these days due to their ability to learn complex functions. However, it\u2019s possible to make any type of regression model recurrent by feeding outputs back through the model as inputs. This can be done with linear regression, random forest regression, or gradient boosted regression to name a few. Since the trajectory of an NBA career is relatively simple it turns out that less complex recurrent models, linear regressions for example, actually produce the best results. More complex models such as recurrent neural networks tend to over-fit this problem, which leads to some very strange predictions when projecting multiple seasons into the future.", "Another important thing to note about predicting NBA player careers is that although this seems like a typical time series problem, it\u2019s really not. Most time series are cyclical, something like agricultural output increases and decreases repeatedly over the years with many peaks and valleys. On the other hand, the career of an NBA player generally has a single period of growth followed by a single period of decline; there is one peak and no valleys. This is not a cyclical process. As a result, time series models designed to predict cyclical data will obviously perform quite poorly on this type of problem.", "For this project, I wanted to be able to predict all of a player\u2019s traditional box score statistics for a season. These prediction targets would also have to function as model inputs in order to produce recurrent predictions. In the end, I decided to predict the following 13 features: two point percentage, two point attempts, three point percentage, three point attempts, free throw percentage, free throw attempts, defensive rebounds, offensive rebounds, assists, steals, blocks, turnovers, and personal fouls.", "The non-percentage features, aka counting stats, listed above were all converted to per 36 minute statistics. This helped to smooth the dataset as many seasons are cut short by injury. To convert predictions of per 36 minute statistics back to totals, a separate model was trained to predict minutes based on a player\u2019s past minutes and predicted performance.", "Like most data science projects, optimizing predictive performance largely comes down to acquiring quality data, data cleaning, and feature engineering. The following details most of the data preparation steps used.", "Data for this project was gathered from the Sports Reference API which was previously discussed in this linked article. The article walks through how to use the API to build a comprehensive dataset of NBA player statistics. This is the same dataset used as a starting point for this project. The dataset contains a variety of traditional and advanced statistics for every season of every player to have played in the NBA within the past 20 years.", "A number of data cleaning steps needed to be performed before training a predictive model. The most obvious being removal of seasons composed of a very small sample size of minutes. These seasons were much more likely to contain extreme statistical outliers. Seasons with less than 400 total minutes played were removed.", "Another necessary cleaning step was to account for occasions of low sample size shooting. For example, did you know that Enes Kanter shot 100% from 3 for the Utah Jazz in the 2013 season (1 for 1). Data points like this one, if not accounted for, lead to some rather ridiculous predictions around 3pt shooting. There were also about 700 seasons in the dataset where a player did not shoot a single three, and these had to be assigned a finite percentage. The solution implemented was to constrain shooting percentages to a certain band when sample size was low.", "The first feature engineering step was to convert number of minutes played to proportion of minutes played out of all possible minutes. For this step an assumption was made that the realistic maximum number of minutes possible was 40 minutes per game. Using this assumption, proportion of minutes played can be easily calculated as follows, (minutes proportion) = (minutes played) / ((games played) * 40). This helps to account for seasons shortened by injury or lockout.", "The second feature engineering trick applied was to multiply 3 point percentage by 1.8. Combined with the step described below, this effectively capped the model\u2019s output for 3 point percentage at 55.5%, helping to prevent the model from over-predicting three point percentage.", "After applying the above feature engineering steps, all percentage features, shooting splits and proportion of minutes played, were converted to log-odds using the logit function. In essence, this converts any subsequent linear regression into a logistic regression and bounds predictions of the features to the range (0,1). This technique is described in more detail in my previous article Beating the Odds. To convert from log-odds back to percentages is easily done using the sigmoid function.", "Lastly, nonlinear features age\u00b2 and age\u00b3 were introduced. These features allowed the recurrent linear regression model to learn higher order polynomial functions with respect to age, greatly improving performance.", "Training and testing sets were split on the basis of players rather than individual seasons. This was to allow for evaluation of long term career predictions of players that the model had not been trained on at all.", "The first step towards building a recurrent model was to test various types of regression at predicting a single feature. This was to give some indication of the type of model that would work well for building the full model. For this simplified test scikit-learn\u2019s LinearRegression, RandomForestRegressor, and GradientBoostedRegressor, along with a Neural Network Regressor created in tensorflow, were used to predict a player\u2019s two point attempts based on their age and a limited set of highly correlated past features. The simple linear regression model was able to obtain the best accuracy on the test set for this task, predicting two point attempts per 36 minutes with a mean absolute error of 1.2 attempts. By creating some synthetic data the model\u2019s adjustments to two point attempts by age for an otherwise statistically average player were revealed.", "As can be seen, this simple linear model predicts an increase in two point attempts per 36 minutes up to the age of 25, after which shot attempts are predicted to decrease. Also note the shape of this curve, which is made possible by the inclusion of nonlinear features based on age.", "The full recurrent model was essentially a combination of many regressions each fit to predict one of 13 features. While possible to create each of these models individually, in practice, this would result in extremely messy code. The solution was to define a python class to serve as a container for the various models. This class fit every model upon instantiation and contained a method for generating predictions from all 13 models at once. The result, clean and easy code. Applying this class also made it simple to switch between a recurrent model using linear regressions and one using random forest regressors or gradient boosted regressors.", "The first step in evaluating model performance was to see how well the model could predict one season of performance into the future. For this task MAE (mean absolute error) was chosen as the evaluation metric since MAE is relatively easy to interpret. To do this each individual model in the multi-model container instance was accessed and assessed individually.", "Although MAE is easy to interpret, it is rather difficult to compare across categories for unscaled data. It\u2019s difficult to say whether an MAE of 1.2 two point attempts is better or worse than an MAE of 1.2 free throw attempts. A simple fix is to divide each MAE by the standard deviation of its category within the dataset. This essentially converts the MAE value into a Z-score which can more easily be compared across categories. For predictions of one season into the future using linear regressions, the results were as shown below. These results were slightly worse for random forest regressors and gradient boosted regressors.", "This table shows that although the model was able to predict two point percentage within a MAE of 3%, the Z-score suggests the model had most difficulty predicting this category. To generate a single measure of overall model performance, these Z-scores were summed across all categories. This gave a total score of 4.91 for the training set and 4.93 for the test set. Worth noting here is that performance was very similar between the training and testing sets, a great sign that the model did not over-fit to the training set.", "Predicting performance one season into the future is nice, but the whole point of building a recurrent model was to be able to make longer term predictions; predictions of performance 3, 5, or even 10 years into the future. To evaluate performance of long term predictions, the recurrent model was seeded with the rookie season of every player and used in a recurrent manner to predict each subsequent season of that player\u2019s career. The average career length for players in both the training and test sets was 9.8 seasons, so on average the model was used to predict 8.8 seasons into the future. Results were compiled using the same techniques described for single season predictions and are shown below.", "The total Z-score in this scenario was 6.84 for the training set and 6.89 for the test set. Although performance was obviously worse for these full career predictions, given the massively increased difficulty of the task this is actually a very good result.", "In addition, it was also of interest to determine how the model\u2019s predictions degraded over time. This was accomplished by aggregating prediction errors on the basis of how far beyond a player\u2019s rookie season the prediction was made. The same techniques described above were applied to generate MAEs, divide by standard deviation of the categories, and sum the Z-scores for every category. Results are shown below.", "With a model in hand to predict shooting splits and per 36 minute counting stats, it was time to build a model to predict a player\u2019s minutes played. This would allow for the predictions discussed above to be converted into predictions of per game averages and season totals.", "The model for predicting minutes played was developed in a slightly different way than discussed above. Rather than use a player\u2019s past performance to predict current minutes, the model was trained to make predictions based on current performance. In other words, the model was designed under the assumption that current minutes are determined by current performance. It was also clear that prior minutes played were the best predictor for current minutes played, as such the model was designed to use this as a feature as well. Beyond prior minutes played, it was found that personal fouls also had a disproportionately large influence in predicting minutes played. Various types of regression models were used to predict minutes played, yet once again it was found that linear regression provided the best results.", "The minutes model performance was then evaluated on individual player seasons. In this case the model was fed and a player\u2019s actual performance and the model predicted the proportion of available minutes that player played. Under these circumstances MAE was about 8.5% for both the training and test sets, equivalent to an MAE of 3 minutes and 25 seconds per game.", "Following this, the minutes model was then evaluated on player\u2019s full careers in much the same way the performance model was. This was done by feeding the minutes model a players actual rookie season performance then predictions of that players performance for all subsequent seasons. Predictions of minutes played for each season were then compared to actual minutes played. Under these circumstances, MAE was about 10.5% for both the training and test sets, equivalent to an MAE of 4 minutes and 25 seconds per game. This MAE was converted to a Z-score of 0.52 for the test set, suggesting that the model was able to predict minutes about as well as other categories.", "Before moving on, it\u2019s worth considering some of the biases of this model. While the evaluations discussed above determine a reasonable baseline for accuracy of predictions beyond 2020, it should also be considered that the NBA is constantly evolving in terms of team strategies, rules, and officiating. The way the NBA game is played today is not the same as it was played 20 years ago. For example, the defensive schemes employed by many teams today would have been illegal in the year 2000 before rule changes in 2001 eliminated restrictions on zone defense. The point here is, this model has been trained and evaluated on the careers of players from the most recent eras of NBA basketball. Future eras could be quite different and cause long term predictions made today to be worse than current evaluations suggest.", "With that quick disclaimer out of the way, let\u2019s have a bit of fun and make some bold predictions for the future. Both the training and testing sets were combined and the models were fit to the combined dataset. Then using the 2020 season as a seed, player performance was projected into the future. Without further ado, your 2023 NBA statistical leaders are:", "After posting impressive per game averages of 33.2 points, 8.8 rebounds, and 8.7 assists in 38.2 minutes per night and on efficient 49/41/83 shooting splits, your 2023 NBA MVP is Luka Doncic!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Using data science to uncover new perspectives, solve practical problems, and have some fun along the way."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fff78deb85122&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff78deb85122--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff78deb85122--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@acmuhr?source=post_page-----ff78deb85122--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@acmuhr?source=post_page-----ff78deb85122--------------------------------", "anchor_text": "Alex Muhr"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd932be500623&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&user=Alex+Muhr&userId=d932be500623&source=post_page-d932be500623----ff78deb85122---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff78deb85122&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff78deb85122&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@neonbrand", "anchor_text": "NeONBRAND"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/the-asset-of-age-e4b45599ea94", "anchor_text": "The Asset of Age"}, {"url": "https://github.com/alexmuhr/NBA_Player_Predictions", "anchor_text": "Github"}, {"url": "https://sportsreference.readthedocs.io/en/stable/", "anchor_text": "Sports Reference API"}, {"url": "https://towardsdatascience.com/sports-reference-api-intro-dbce09e89e52", "anchor_text": "article"}, {"url": "https://en.wikipedia.org/wiki/Logit", "anchor_text": "logit"}, {"url": "https://towardsdatascience.com/beating-the-odds-8d26b1a83f1b", "anchor_text": "Beating the Odds"}, {"url": "https://en.wikipedia.org/wiki/Sigmoid_function", "anchor_text": "sigmoid"}, {"url": "https://www.sun-sentinel.com/news/fl-xpm-2001-04-13-0104121399-story.html", "anchor_text": "rule changes in 2001 eliminated restrictions on zone defense"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ff78deb85122---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/predictive-modeling?source=post_page-----ff78deb85122---------------predictive_modeling-----------------", "anchor_text": "Predictive Modeling"}, {"url": "https://medium.com/tag/nba?source=post_page-----ff78deb85122---------------nba-----------------", "anchor_text": "NBA"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ff78deb85122---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/predictive-analytics?source=post_page-----ff78deb85122---------------predictive_analytics-----------------", "anchor_text": "Predictive Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff78deb85122&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&user=Alex+Muhr&userId=d932be500623&source=-----ff78deb85122---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff78deb85122&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&user=Alex+Muhr&userId=d932be500623&source=-----ff78deb85122---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff78deb85122&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff78deb85122--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fff78deb85122&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ff78deb85122---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff78deb85122--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ff78deb85122--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ff78deb85122--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ff78deb85122--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ff78deb85122--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ff78deb85122--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ff78deb85122--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ff78deb85122--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@acmuhr?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@acmuhr?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alex Muhr"}, {"url": "https://medium.com/@acmuhr/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "179 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd932be500623&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&user=Alex+Muhr&userId=d932be500623&source=post_page-d932be500623--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F459ab5d3c363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-nbas-2023-mvp-is-ff78deb85122&newsletterV3=d932be500623&newsletterV3Id=459ab5d3c363&user=Alex+Muhr&userId=d932be500623&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}