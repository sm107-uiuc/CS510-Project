{"url": "https://towardsdatascience.com/unzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb", "time": 1683015955.219559, "path": "towardsdatascience.com/unzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb/", "webpage": {"metadata": {"title": "Unzip, update and zip again XMLs in a folder | by Vaclav Dekanovsky | Towards Data Science", "h1": "Unzip, update and zip again XMLs in a folder", "description": "Unzip many archives from the folder, update their content, and zip them again to another location. Automate with python."}, "outgoing_paragraph_urls": [{"url": "https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/Unzip/XML/Unzip_Update_Zip_full.ipynb", "anchor_text": "Unzip_Update_Zip_full.ipynb", "paragraph_index": 3}, {"url": "https://www.anaconda.com/", "anchor_text": "Anaconda", "paragraph_index": 4}, {"url": "http://stackoverflow.com/", "anchor_text": "stackoverflow,", "paragraph_index": 5}, {"url": "https://medium.com/", "anchor_text": "medium", "paragraph_index": 5}, {"url": "https://stackoverflow.com/questions/3451111/unzipping-files-in-python", "anchor_text": "stackoverflow\u2019s Unzipping files in Python", "paragraph_index": 6}, {"url": "https://docs.python.org/3.9/library/xml.etree.elementtree.html#module-xml.etree.ElementTree", "anchor_text": "xml.etree", "paragraph_index": 14}, {"url": "https://www.w3schools.com/xml/xml_xpath.asp", "anchor_text": "Xpath", "paragraph_index": 18}, {"url": "https://docs.python.org/3/library/shutil.html", "anchor_text": "shutil.make_archive", "paragraph_index": 31}, {"url": "https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/Unzip/XML/Unzip_Update_Zip_full.ipynb", "anchor_text": "Unzip_Update_Zip_full.ipynb", "paragraph_index": 34}, {"url": "https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/Unzip/XML/Unzip_Update_Zip_full.ipynb", "anchor_text": "Github", "paragraph_index": 38}], "all_paragraphs": ["In daily office work, you often have to do something with a bunch of files. Unzip, move, rename, update, zip again, and send or load to FTP. All of these things are simple to do, but very time-consuming of you have to repeat them manually on the tens or hundreds of files.", "Luckily you can use programming languages to automate these repetitive tasks. Python is an ideal choice because it\u2019s easy to set up on a computer and with little trial and error even the computing newbie can create a program. Python is a versatile programming language and you can tackle basically any problem with it.", "Let\u2019s explore quite a common task in many industries. We will:", "You can follow up this exercise in the github notebook-Unzip_Update_Zip_full.ipynb.", "There are several ways how you can set up python on your computer. I personally enjoy using Anaconda and Jupyter notebook. You download and install the conda package meant to make python environment easy to manage with all possible enhancements and run the notebook, which is an essential part of the package.", "In the notebook, you can run a separate cell containing one or more lines of code and immediately see the results. Such an approach is ideal for prototyping. With help from google, stackoverflow, and tutorials for example here on medium you can quickly combine the pieces of code required for what you need to do.", "Let\u2019s explore how you would approach a task to unzip a file in python. Just go to google and type \u201cunzip python\u201d. It quickly lists results and you pick, let\u2019s say one of the coding biggest Q/A sites \u2014 stackoverflow\u2019s Unzipping files in Python. Within 3 lines of code you learn how to do that:", "You import the library needed for work with .zip files \u2014 zipfile. That allows you to use its functions and methods to unpack the archives and zip them again.", "First, you open the archive for reading using zipfile.ZipFile(path_to_zip_file, 'r') and then you extract the content of the package to a directory zip_ref.extractall(directory_to_extract_to).", "I used the with notation to ensure that the archive is opened, an action performed, and then the archive is closed so its content is released from the memory. It prevents memory leaks in case you process hundreds or thousands of files.", "To unzip a file in python you use three lines of code. To unzip a bunch of files you add only a few lines more. You have to identify the zip files in a folder and pass them to the procedure we have described above.", "The os library lets you both get the content of a folder os.listdir() and combine the folder and file names using os.path.join(folder,file). Listdir returns both the files and the subfolders. You can add file.endswith(\".zip\") to identify only the archives.", "Alternatively you can use os.path.splitext(). Its second output is the file extension.", "Knowing all the files in the folder, you can apply the previous code to unzip them. Again you can iterate over the files and unzip each, or wrap the unzipping into a function which is called within the one line comprehensive notation.", "Once we have extracted the XML to the temp folder we can work with it. Python contains xml.etree library to process the XML files. In our case we know that the zip archive contained one XML file a.xml, though you can always list all the files in the archive using \u2014 zip_ref.namelist().", "To update the XML file you have to import the tree library and load the XML document.", "Remember that any variable derived from the tree is a reference. When you update the content of these variables, you update the tree as well.", "Let\u2019s say we want to update the <id>...</id> node in our XML. We have to first locate it. There are several methods in the etree library for locating XML nodes.", "Both methods accept the name of the element or you can find it using xpath. Xpath is kind of the address inside the XML to locate the desired element. Once the node is found use, it\u2019s .text argument to get the value written between the tags.", "Our Id has three parts split by the \u201c_\u201d underscore:", "One of the XML has the id \u2014 test_001_20201026. .text returns the values as a string and you can apply .split(\"_\") function to break the text into the details.", "The output is a python list, which can be easily updated element-wise. First we change the prefix split_id[0] = new_prefix. Then we update the version.", "We have used the \"{:03d}\".format(new_version) to add the leading zeros up to 3 characters, if needed to turn 1 to 001.", "Updated values can be combined together into single string by .join(\"_\") and the original XML component can be updated with it:", "As I\u2019ve mentioned any update to a variable derived from the tree updates the tree as well. We have achieved our desired update of the XML and we only need to export it using tree.write(output_path).", "Let\u2019s look on the complete code of the XML update:", "Now the updated a.xml lies in the temp folder. We only need to zip it and place this archive to processed folder. Let\u2019s first create the output folder, if it doesn\u2019t exist. We will use the Path from pathlib library.", "Then we pack the XML into the zip archive using zipfile lib. Now we have to open the archive for writing 'w'. Then we use the reference to this archive and .write(path_to_file, name_of_this_file).", "If you don\u2019t specify the second parameter name_of_the_zipped_file then whole path including the folders and subfolders will be zipped.", "If you don\u2019t know the file name, os library can help you with its os.path.basename() function.", "Sometimes though you need to pack folders and files as well. In our example Folder_001_20201101.zip contains a file and another files in a folder.", "In such a case it would a bit too completed to use zipfile, but you have an alternative in shutil.make_archive(output_folder, format, folder_to_pack). This method only archives the content of the folder_to_pack and places the result to the output_folder. You can choose from the zip, tar, gztar, bztar, xztar formats.", "Now we know all the components of the process:", "In this final exercise, we must do a few little tweaks. We will use the name of the original archive, update it as well as we update the content of all the contained XMLs. The reason is that there can be two or more XMLs in the archive each with a different ids and we zip all of them back into the updated zip archive (which cannot have 2 different names).", "The complete code, can be found in this notebook \u2014 Unzip_Update_Zip_full.ipynb", "In this simple tutorial, you have seen the power of python (or any other programming language). Within a few lines of codes, you can automate tasks which would take a lot of time if done manually. I use this principle when deciding whether it\u2019s worth to spend time coding:", "If you do something small once, do it manually. If it\u2019s big, you repeat the same operation on many items or you think you will have to do it in the future \u2014 automate with a programming language.", "The operation in this example can have many variations. You might want to update a different XML node. The zip contains CSV files maybe. You rather update the date and not the prefix and version. You might need to modify the input \u2014 e.g. increase the version by 1 or add a week to the date.", "All that is possible with only small changes to the code. You can also review the complete example in the jupyter notebook on Github.", "I hope you like this tutorial about zipping and XML processing and that you like what you can achieve with python. The possibilities are endless.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist who loves to explore everything and write about the topics from multiple points of view."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7d57f9710ddb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vdekanovsky.medium.com/?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": ""}, {"url": "https://vdekanovsky.medium.com/?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": "Vaclav Dekanovsky"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fed473176733b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&user=Vaclav+Dekanovsky&userId=ed473176733b&source=post_page-ed473176733b----7d57f9710ddb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d57f9710ddb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d57f9710ddb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/Unzip/XML/Unzip_Update_Zip_full.ipynb", "anchor_text": "Unzip_Update_Zip_full.ipynb"}, {"url": "https://www.anaconda.com/", "anchor_text": "Anaconda"}, {"url": "http://stackoverflow.com/", "anchor_text": "stackoverflow,"}, {"url": "https://medium.com/", "anchor_text": "medium"}, {"url": "https://stackoverflow.com/questions/3451111/unzipping-files-in-python", "anchor_text": "stackoverflow\u2019s Unzipping files in Python"}, {"url": "https://docs.python.org/3.9/library/xml.etree.elementtree.html#module-xml.etree.ElementTree", "anchor_text": "xml.etree"}, {"url": "https://www.w3schools.com/xml/xml_xpath.asp", "anchor_text": "Xpath"}, {"url": "https://docs.python.org/3/library/shutil.html", "anchor_text": "shutil.make_archive"}, {"url": "https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/Unzip/XML/Unzip_Update_Zip_full.ipynb", "anchor_text": "Unzip_Update_Zip_full.ipynb"}, {"url": "https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/Unzip/XML/Unzip_Update_Zip_full.ipynb", "anchor_text": "Github"}, {"url": "https://towardsdatascience.com/visualization-with-plotly-express-comprehensive-guide-eb5ee4b50b57", "anchor_text": "Plotly Express complete tutorial"}, {"url": "https://towardsdatascience.com/highlighted-line-chart-with-plotly-express-e69e2a27fea8", "anchor_text": "Very illustrative highlighted line chart"}, {"url": "https://towardsdatascience.com/histograms-with-plotly-express-complete-guide-d483656c5ad7", "anchor_text": "Plotly Histogram - Complete Guide"}, {"url": "https://towardsdatascience.com/complete-guide-to-pythons-cross-validation-with-examples-a9676b5cac12", "anchor_text": "Everything you wanted to know about Kfold train-test split"}, {"url": "https://towardsdatascience.com/pythons-geocoding-convert-a-list-of-addresses-into-a-map-f522ef513fd6", "anchor_text": "How to turn a list of addreses into a map"}, {"url": "https://medium.com/tag/python?source=post_page-----7d57f9710ddb---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/zip?source=post_page-----7d57f9710ddb---------------zip-----------------", "anchor_text": "Zip"}, {"url": "https://medium.com/tag/xml?source=post_page-----7d57f9710ddb---------------xml-----------------", "anchor_text": "Xml"}, {"url": "https://medium.com/tag/programming?source=post_page-----7d57f9710ddb---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d57f9710ddb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&user=Vaclav+Dekanovsky&userId=ed473176733b&source=-----7d57f9710ddb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d57f9710ddb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&user=Vaclav+Dekanovsky&userId=ed473176733b&source=-----7d57f9710ddb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d57f9710ddb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7d57f9710ddb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7d57f9710ddb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7d57f9710ddb--------------------------------", "anchor_text": ""}, {"url": "https://vdekanovsky.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vdekanovsky.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vaclav Dekanovsky"}, {"url": "https://vdekanovsky.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "623 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fed473176733b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&user=Vaclav+Dekanovsky&userId=ed473176733b&source=post_page-ed473176733b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F41f38caa0bb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb&newsletterV3=ed473176733b&newsletterV3Id=41f38caa0bb5&user=Vaclav+Dekanovsky&userId=ed473176733b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}