{"url": "https://towardsdatascience.com/keras-for-beginners-building-your-first-neural-network-f21cdf90789e", "time": 1683002403.7126489, "path": "towardsdatascience.com/keras-for-beginners-building-your-first-neural-network-f21cdf90789e/", "webpage": {"metadata": {"title": "Keras for Beginners: Building Your First Neural Network | by Victor Zhou | Towards Data Science", "h1": "Keras for Beginners: Building Your First Neural Network", "description": "Keras is a simple-to-use but powerful deep learning library for Python. In this post, we\u2019ll see how easy it is to build a feedforward neural network and train it to solve a real problem with Keras\u2026"}, "outgoing_paragraph_urls": [{"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 0}, {"url": "https://victorzhou.com/blog/intro-to-neural-networks/", "anchor_text": "introduction to Neural Networks", "paragraph_index": 1}, {"url": "https://victorzhou.com/blog/keras-neural-network-tutorial/#the-full-code", "anchor_text": "full source code", "paragraph_index": 2}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "MNIST", "paragraph_index": 3}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow", "paragraph_index": 6}, {"url": "https://keras.io/models/sequential/", "anchor_text": "Sequential", "paragraph_index": 10}, {"url": "https://keras.io/models/model/", "anchor_text": "Model", "paragraph_index": 10}, {"url": "https://keras.io/layers/about-keras-layers/", "anchor_text": "Layers", "paragraph_index": 12}, {"url": "https://keras.io/layers/core/#dense", "anchor_text": "Dense", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU", "paragraph_index": 14}, {"url": "https://victorzhou.com/blog/softmax/", "anchor_text": "Softmax", "paragraph_index": 14}, {"url": "https://victorzhou.com/blog/softmax/", "anchor_text": "simple Softmax explanation", "paragraph_index": 15}, {"url": "https://keras.io/models/sequential/#fit", "anchor_text": "a lot of possible parameters", "paragraph_index": 20}, {"url": "https://keras.io/utils/#to_categorical", "anchor_text": "to_categorical", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/One-hot", "anchor_text": "one-hot", "paragraph_index": 22}, {"url": "https://keras.io/models/sequential/#evaluate", "anchor_text": "evaluate()", "paragraph_index": 27}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.argmax.html", "anchor_text": "np.argmax()", "paragraph_index": 30}, {"url": "https://keras.io/optimizers/#adam", "anchor_text": "Adam", "paragraph_index": 32}, {"url": "https://en.wikipedia.org/wiki/Sigmoid_function", "anchor_text": "sigmoid", "paragraph_index": 35}, {"url": "https://keras.io/layers/core/#dropout", "anchor_text": "Dropout", "paragraph_index": 36}, {"url": "https://victorzhou.com/blog/intro-to-cnns-part-1/", "anchor_text": "introduction to Convolutional Neural Networks", "paragraph_index": 39}, {"url": "https://victorzhou.com/blog/keras-cnn-tutorial/", "anchor_text": "implementing a CNN with Keras", "paragraph_index": 39}, {"url": "https://victorzhou.com", "anchor_text": "https://victorzhou.com", "paragraph_index": 43}], "all_paragraphs": ["Keras is a simple-to-use but powerful deep learning library for Python. In this post, we\u2019ll see how easy it is to build a feedforward neural network and train it to solve a real problem with Keras.", "This post is intended for complete beginners to Keras but does assume a basic background knowledge of neural networks. My introduction to Neural Networks covers everything you need to know (and more) for this post \u2014 read that first if necessary.", "Just want the code? Here\u2019s the full source code.", "We\u2019re going to tackle a classic machine learning problem: MNIST handwritten digit classification. It\u2019s simple: given an image, classify it as a digit.", "Each image in the MNIST dataset is 28x28 and contains a centered, grayscale digit. We\u2019ll flatten each 28x28 into a 784 dimensional vector, which we\u2019ll use as input to our neural network. Our output will be one of 10 possible classes: one for each digit.", "I\u2019m assuming you already have a basic Python installation ready (you probably do). Let\u2019s first install some packages we\u2019ll need:", "Note: We need to install tensorflow because we're going to run Keras on a TensorFlow backend (i.e. TensorFlow will power Keras).", "You should now be able to import these packages and poke around the MNIST dataset:", "As mentioned earlier, we need to flatten each image before we can pass it into our neural network. We\u2019ll also normalize the pixel values from [0, 255] to [-0.5, 0.5] to make our network easier to train (using smaller, centered values is often better).", "We\u2019re ready to start building our neural network!", "Every Keras model is either built using the Sequential class, which represents a linear stack of layers, or the functional Model class, which is more customizable. We\u2019ll be using the simpler Sequential model, since our network is indeed a linear stack of layers.", "We start by instantiating a Sequential model:", "The Sequential constructor takes an array of Keras Layers. Since we're just building a standard feedforward network, we only need the Dense layer, which is your regular fully-connected (dense) network layer.", "Let\u2019s throw in 3 Dense layers:", "The first two layers have 64 nodes each and use the ReLU activation function. The last layer is a Softmax output layer with 10 nodes, one for each class.", "If you need a refresher, read my simple Softmax explanation.", "The last thing we always need to do is tell Keras what our network\u2019s input will look like. We can do that by specifying an input_shape to the first layer in the Sequential model:", "Once the input shape is specified, Keras will automatically infer the shapes of inputs for later layers. We\u2019ve finished defining our model! Here\u2019s where we\u2019re at:", "Before we can begin training, we need to configure the training process. We decide 3 key factors during the compilation step:", "Here\u2019s what that compilation looks like:", "Training a model in Keras literally consists only of calling fit() and specifying some parameters. There are a lot of possible parameters, but we'll only manually supply a few:", "This doesn\u2019t actually work yet, though \u2014 we overlooked one thing. Keras expects the training targets to be 10-dimensional vectors, since there are 10 nodes in our Softmax output layer, but we\u2019re instead supplying a single integer representing the class for each image.", "Conveniently, Keras has a utility method that fixes this exact issue: to_categorical. It turns our array of class integers into an array of one-hot vectors instead. For example, 2 would become [0, 0, 1, 0, 0, 0, 0, 0, 0, 0] (it's zero-indexed).", "We can now put everything together to train our network:", "Running that code gives us something like this:", "We reached 96.6% training accuracy after 5 epochs! This doesn\u2019t tell us much, though \u2014 we may be overfitting. The real challenge will be seeing how our model performs on our test data.", "Evaluating the model is pretty simple:", "evaluate() returns an array containing the test loss followed by any metrics we specified. Thus, our model achieves a 0.108 test loss and 96.5% test accuracy! Not bad for your first neural network.", "Now that we have a working, trained model, let\u2019s put it to use. The first thing we\u2019ll do is save it to disk so we can load it back up anytime:", "We can now reload the trained model whenever we want by rebuilding it and loading in the saved weights:", "Using the trained model to make predictions is easy: we pass an array of inputs to predict() and it returns an array of outputs. Keep in mind that the output of our network is 10 probabilities (because of softmax), so we'll use np.argmax() to turn those into actual digits.", "What we\u2019ve covered so far was but a brief introduction \u2014 there\u2019s much more we can do to experiment with and improve this network. I\u2019ve included a few examples below:", "A good hyperparameter to start with is the learning rate for the Adam optimizer. What happens when you increase or decrease it?", "What about the batch size and number of epochs?", "What happens if we remove or add more fully-connected layers? How does that affect training and/or the model\u2019s final performance?", "What if we use an activation other than ReLU, e.g. sigmoid?", "What if we tried adding Dropout layers, which are known to prevent overfitting?", "We can also use the testing dataset for validation during training. Keras will evaluate the model on the validation set at the end of each epoch and report the loss and any metrics we asked for. This allows us to monitor our model\u2019s progress over time during training, which can be useful to identify overfitting and even support early stopping.", "You\u2019ve implemented your first neural network with Keras! We achieved a test accuracy of 96.5% on the MNIST dataset after 5 epochs, which is not bad for such a simple network. I\u2019ll include the full source code again below for your reference.", "If you want to learn about more advanced techniques to approach MNIST, I recommend checking out my introduction to Convolutional Neural Networks (CNNs). In it, we see how to achieve much higher (>99%) accuracies on MNIST using more complex networks. I also recommend my guide on implementing a CNN with Keras, which is similar to this post.", "Further reading you might be interested in include:", "Thanks for reading this post! The full source code is below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CS @ Princeton University. I write about web development, machine learning, and more at https://victorzhou.com."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff21cdf90789e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://victorczhou.medium.com/?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": ""}, {"url": "https://victorczhou.medium.com/?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": "Victor Zhou"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdd190d205cab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&user=Victor+Zhou&userId=dd190d205cab&source=post_page-dd190d205cab----f21cdf90789e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff21cdf90789e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff21cdf90789e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://victorzhou.com/blog/intro-to-neural-networks/", "anchor_text": "introduction to Neural Networks"}, {"url": "https://victorzhou.com/blog/keras-neural-network-tutorial/#the-full-code", "anchor_text": "full source code"}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "MNIST"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://keras.io/models/sequential/", "anchor_text": "Sequential"}, {"url": "https://keras.io/models/model/", "anchor_text": "Model"}, {"url": "https://keras.io/layers/about-keras-layers/", "anchor_text": "Layers"}, {"url": "https://keras.io/layers/core/#dense", "anchor_text": "Dense"}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU"}, {"url": "https://victorzhou.com/blog/softmax/", "anchor_text": "Softmax"}, {"url": "https://victorzhou.com/blog/softmax/", "anchor_text": "simple Softmax explanation"}, {"url": "https://arxiv.org/abs/1412.6980", "anchor_text": "Adam"}, {"url": "https://keras.io/optimizers/", "anchor_text": "many other optimizers"}, {"url": "https://keras.io/losses/", "anchor_text": "See all Keras losses"}, {"url": "https://keras.io/models/sequential/#fit", "anchor_text": "a lot of possible parameters"}, {"url": "https://keras.io/utils/#to_categorical", "anchor_text": "to_categorical"}, {"url": "https://en.wikipedia.org/wiki/One-hot", "anchor_text": "one-hot"}, {"url": "https://keras.io/models/sequential/#evaluate", "anchor_text": "evaluate()"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.argmax.html", "anchor_text": "np.argmax()"}, {"url": "https://keras.io/optimizers/#adam", "anchor_text": "Adam"}, {"url": "https://en.wikipedia.org/wiki/Sigmoid_function", "anchor_text": "sigmoid"}, {"url": "https://keras.io/layers/core/#dropout", "anchor_text": "Dropout"}, {"url": "https://victorzhou.com/blog/intro-to-cnns-part-1/", "anchor_text": "introduction to Convolutional Neural Networks"}, {"url": "https://victorzhou.com/blog/keras-cnn-tutorial/", "anchor_text": "implementing a CNN with Keras"}, {"url": "https://keras.io/#getting-started-30-seconds-to-keras", "anchor_text": "getting started with Keras"}, {"url": "http://www.datastuff.tech/machine-learning/convolutional-neural-networks-an-introduction-tensorflow-eager/", "anchor_text": "introduction to CNNs with Keras"}, {"url": "https://github.com/keras-team/keras/tree/master/examples", "anchor_text": "Keras examples"}, {"url": "https://victorzhou.com/blog/keras-neural-network-tutorial/", "anchor_text": "https://victorzhou.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f21cdf90789e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/keras?source=post_page-----f21cdf90789e---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----f21cdf90789e---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f21cdf90789e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----f21cdf90789e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff21cdf90789e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&user=Victor+Zhou&userId=dd190d205cab&source=-----f21cdf90789e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff21cdf90789e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&user=Victor+Zhou&userId=dd190d205cab&source=-----f21cdf90789e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff21cdf90789e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff21cdf90789e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f21cdf90789e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f21cdf90789e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f21cdf90789e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f21cdf90789e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f21cdf90789e--------------------------------", "anchor_text": ""}, {"url": "https://victorczhou.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://victorczhou.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Victor Zhou"}, {"url": "https://victorczhou.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "925 Followers"}, {"url": "https://victorzhou.com", "anchor_text": "https://victorzhou.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdd190d205cab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&user=Victor+Zhou&userId=dd190d205cab&source=post_page-dd190d205cab--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb8d9c8575861&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeras-for-beginners-building-your-first-neural-network-f21cdf90789e&newsletterV3=dd190d205cab&newsletterV3Id=b8d9c8575861&user=Victor+Zhou&userId=dd190d205cab&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}