{"url": "https://towardsdatascience.com/my-first-adventures-in-nlp-631faa6aadd4", "time": 1682994535.326057, "path": "towardsdatascience.com/my-first-adventures-in-nlp-631faa6aadd4/", "webpage": {"metadata": {"title": "My First Adventures in NLP. Exploring sentiment analysis as a\u2026 | by Britton Winterrose | Towards Data Science", "h1": "My First Adventures in NLP", "description": "For the past 24 months my wife has struggled through a major depressive episode. Treatment protocol has taken her from one medication trial (and failure) to the next. Each drug trial takes anywhere\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Drug+Review+Dataset+%28Drugs.com%29", "anchor_text": "Drug Review (Drugs.com) Dataset", "paragraph_index": 13}, {"url": "https://towardsdatascience.com/sentiment-analysis-with-python-part-1-5ce197074184", "anchor_text": "\u201cSentiment Analysis with Python\u201d", "paragraph_index": 17}, {"url": "https://github.com/BrittonWinterrose/Drug_Review_NLP/blob/master/01_Drug_Review_Dataset_Exploration.ipynb", "anchor_text": "See my notebook here", "paragraph_index": 17}, {"url": "https://blog.insightdatascience.com/how-to-solve-90-of-nlp-problems-a-step-by-step-guide-fda605278e4e", "anchor_text": "Emmanuel Ameisen", "paragraph_index": 22}, {"url": "https://github.com/BrittonWinterrose/how-to-solve-NLP", "anchor_text": "Leonardo Apolonio\u2019s \u201cHow-to-solve-NLP\u201d code", "paragraph_index": 22}, {"url": "https://github.com/BrittonWinterrose/Drug_Review_NLP/blob/master/02_Drug_Data_NLP_Analysis1.ipynb", "anchor_text": "My notebook is here.", "paragraph_index": 22}, {"url": "http://kdd.cs.ksu.edu/Publications/Student/kallumadi2018aspect.pdf", "anchor_text": "the original paper", "paragraph_index": 23}, {"url": "https://youtu.be/OxGuGzXITcw?t=5448", "anchor_text": "Here\u2019s a short presentation I did on this method.", "paragraph_index": 25}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "reading and learning about LSTM\u2019s", "paragraph_index": 32}, {"url": "https://github.com/BrittonWinterrose/Drug_Review_NLP/blob/master/03_Drug_LSTM_w_Custom_Stopwords.ipynb", "anchor_text": "See my notebook here", "paragraph_index": 32}], "all_paragraphs": ["November 15, 2018 I set out on a mission to create a drug-review sentiment analysis model.", "It began as most ideas do\u2026 with a problem.", "For the past 24 months my wife has struggled through a major depressive episode. Treatment protocol has taken her from one medication trial (and failure) to the next. Each drug trial takes anywhere between 8 to 16 weeks depending on titration, follow-up appointments, and tapering off. Throughout this process she\u2019s experienced the whole gambit of side effects. Nausea, fatigue, drowsiness, and severe anxiety to name a few. Some drugs helped a little with the depression. Others made it noticeably worse. Terrifyingly worse.", "In those moments I felt powerless to help the one that I love. My only course of action was to contact the physician and leave a message or note. And often by the time I heard back from the physician the side effects would have changed.", "I don\u2019t blame the physician for the level of responsiveness. They communicated as best they could given the volume of individuals that they help in their practice. But the thought often crossed my mind \u201cWhy even (call or) email them? It\u2019s not like they\u2019re going to get this message soon enough to do anything about it.\u201d", "Often we\u2019d end up waiting to report back to the doctor until the follow-up appointment. But it is hard to remember how difficult each day, or week, of trying a new medication was when you\u2019re on the spot. Especially when it was 8 weeks into using a new drug. This creates a slow, inconsistent and labor intensive medication-experience feedback cycle.", "These breakdowns & bottlenecks in doctor \u2014 patient communication slow down the treatment process. If doctors can find the correct medications immediately then patients care outcomes improve. Correct drug fit means fewer followup visits, which helps to reduce the cost of patient care. A problem with real costs & lives attached.", "So what if I could create a system to allow health care providers to identify effective / ineffective drugs more quickly?", "Quantified reviews create clean simple data. Data that can visualized, analyzed, monitored, and compared.", "By gathering daily patient drug-feedback and performing sentiment analysis one could:", "But this system\u2019s success would hinge on one key component. A model that can consistently and accurately predict the sentiment of a patient\u2019s drug review.", "So that is what I set out to see if I could build.", "Walking into this project I knew very little about NLP and sentiment analysis other than what it can do conceptually. But I needed some quality data to start with.", "The internet delivered some terrific data. The \u201cDrug Review (Drugs.com) Dataset\u201d from the UCI Machine Learning Repository contributed by Felix Gr\u00e4\u00dfer & Surya Kallumadi.", "\u201cThe dataset provides patient reviews on specific drugs along with related conditions and a 10 star patient rating reflecting overall patient satisfaction. The data was obtained by crawling online pharmaceutical review sites. (Drugs.com)\u201d", "An excellent dataset that contains the text reviews, a rating, as well as category fields for condition and medication.", "I started by importing & exploring the dataset. Once satisfied that I grasped the structure of the data I began looking for guidance on sentiment analysis.", "I googled, read many, and selected a simple starting tutorial to launch my NLP journey. My first attempt at NLP began with taking a bit of code from the \u201cSentiment Analysis with Python\u201d tutorial and applying it to my dataset. (See my notebook here) I quickly learned that adapting even the best written code to a new dataset can be quite the challenge. The RegEx provided for cleaning the data was insufficient, so I wrote and tested my own.", "After normalizing and vectorizing the review text I binned the review-ratings from 11 categories into three. \u201cPositive\u201d, \u201cNegative\u201d, and \u201cNeutral\u201d. Then using scikit-learn\u2019s Logistic Regression I trained a model and checked the accuracy of the model\u2019s performance.", "After a small amount of tuning, this model produced a final accuracy of 81.95%. At this point I was uncertain how to measure the performance of this model and unsure whether accuracy alone was a valid metric.", "But as I inspected the weights for each of the top and bottom 10 features (words) I realized that there were some discrepancies that I was unable to explain.", "I\u2019m not the type to give up. So, I needed to learn more and sought out after a more in depth tutorial.", "After some questioning with one of my friends he recommended a post from Insight AI\u2019s Emmanuel Ameisen. Using that post as a guide and Leonardo Apolonio\u2019s \u201cHow-to-solve-NLP\u201d code as a framework I set off on my next journey in NLP with my freshly inspected dataset. (My notebook is here.)", "I first reviewed the original paper that was published using the dataset. I\u2019ve included notes about the methodology for data collection, preprocessing, tokenizing, and modeling used in that study.", "As I worked through the tutorial I followed a simple process of \u201cstop and learn\u201d anytime there was ML vocabulary I didn\u2019t understand. I learned about embedding, Word2Vec, Bag-of-Words, corpus, tokenizing, normalizing, non-ASCII characters, stemming, lemmatizing, and vectorizing in data preparation. This process is time consuming but effective.", "My goal with each of these tutorials is simple: make it work, then gain understanding. This process works well for people like me who could be described as \u201cmechanically inclined\u201d. It allows us to build an understanding of the entire system\u2019s structure first, then take a deeper dive into knowledge of each part. I find that this method helps me to retain what I learn. My brain locks in the explanation of the details because they are perceived as relevant and essential parts of the whole. (Here\u2019s a short presentation I did on this method.)", "\u201cTake chances, make mistakes, GET MESSY!\u201d\u200a\u2014\u200aMs. Frizzle", "The danger of this method is when the working internals are not explored. If the mechanisms of the model are treated like a black box forever the user misses the opportunity to learn.", "It took a lot of work to get it working cleanly with my dataset but work it did. The tutorial clearly illustrated new-to-me concepts within a framework of evaluating model performance including:", "The highest performing embedding + logreg model was my Bag-of-Words model at 78% accuracy. The CNN ended up coming in at ~75% accurate leaving plenty of room for improvement.", "But the resulting feature weighting & importance improved dramatically.", "With these small successes under my belt I was still hungry to find and build an even better fitting model. And in the third attempt I was able to do just that.", "This attempt was different as I had been reading and learning about LSTM\u2019s while working through my previous attempts and I had resolved to give it a go on this same dataset with some fresh LSTM code. (See my notebook here)", "Preprocessing data was fun this time after all the struggles in my first two attempts.", "This time I inspected my NaN data using MissingNo. I think this visualization package is super clever.", "Then I binned my values as I had done before and inspected the distribution in a plot.", "I removed outlier-length sentences from the dataset.", "Lastly I applied my RegEx, stemming, and stop word removal (including my custom made drug name stop word corpus) to further clean and reduce the feature size while maintaining the relevant words. The end result is a substantially smaller feature set that is easier to effectively process.", "I\u2019ll spare you the details of how I worked through all the different components of the LSTM and evaluated various parameters through time-consuming trial and error. But the end result of all that hard work was a model that performed better than any of my previous models.", "My simple LSTM model ended up achieving 88.4% accuracy.", "Even more impressive was how well it performed at predicting positive sentiment with a 90% accuracy rate.", "Most surprising of all\u2026 this attempt was fun. Much of the drudgery of learning the preprocessing had already taken place and the model performed so much better than I expected.", "All things considered this journey into understanding how sentiment analysis has deepened my understanding of NLP. Most of all, it has helped me to see how much more I have to learn and I look forward to returning to this dataset in the future.", "It would certainly be better than nothing but it is far from perfect.", "And this blog post is done.", "Note for readers: As of the time of publishing this post my wife has since found some relief from her depression thanks to gene-drug testing. If you or a loved one are suffering with depression and are frustrated with the effectiveness of your medication I would highly recommend it. It should be part of every depression diagnosis.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Enthusiast Interested in ML & Deep Learning 2x Founder, one folded and one sold."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F631faa6aadd4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@brittonwinterrose?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@brittonwinterrose?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": "Britton Winterrose"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6766375747a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&user=Britton+Winterrose&userId=b6766375747a&source=post_page-b6766375747a----631faa6aadd4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F631faa6aadd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F631faa6aadd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Drug+Review+Dataset+%28Drugs.com%29", "anchor_text": "Drug Review (Drugs.com) Dataset"}, {"url": "https://towardsdatascience.com/sentiment-analysis-with-python-part-1-5ce197074184", "anchor_text": "\u201cSentiment Analysis with Python\u201d"}, {"url": "https://github.com/BrittonWinterrose/Drug_Review_NLP/blob/master/01_Drug_Review_Dataset_Exploration.ipynb", "anchor_text": "See my notebook here"}, {"url": "https://blog.insightdatascience.com/how-to-solve-90-of-nlp-problems-a-step-by-step-guide-fda605278e4e", "anchor_text": "Emmanuel Ameisen"}, {"url": "https://github.com/BrittonWinterrose/how-to-solve-NLP", "anchor_text": "Leonardo Apolonio\u2019s \u201cHow-to-solve-NLP\u201d code"}, {"url": "https://github.com/BrittonWinterrose/Drug_Review_NLP/blob/master/02_Drug_Data_NLP_Analysis1.ipynb", "anchor_text": "My notebook is here."}, {"url": "http://kdd.cs.ksu.edu/Publications/Student/kallumadi2018aspect.pdf", "anchor_text": "the original paper"}, {"url": "https://youtu.be/OxGuGzXITcw?t=5448", "anchor_text": "Here\u2019s a short presentation I did on this method."}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "reading and learning about LSTM\u2019s"}, {"url": "https://github.com/BrittonWinterrose/Drug_Review_NLP/blob/master/03_Drug_LSTM_w_Custom_Stopwords.ipynb", "anchor_text": "See my notebook here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----631faa6aadd4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----631faa6aadd4---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----631faa6aadd4---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----631faa6aadd4---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----631faa6aadd4---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F631faa6aadd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&user=Britton+Winterrose&userId=b6766375747a&source=-----631faa6aadd4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F631faa6aadd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&user=Britton+Winterrose&userId=b6766375747a&source=-----631faa6aadd4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F631faa6aadd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F631faa6aadd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----631faa6aadd4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----631faa6aadd4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----631faa6aadd4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----631faa6aadd4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----631faa6aadd4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@brittonwinterrose?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@brittonwinterrose?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Britton Winterrose"}, {"url": "https://medium.com/@brittonwinterrose/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "147 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6766375747a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&user=Britton+Winterrose&userId=b6766375747a&source=post_page-b6766375747a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F527deb2d0591&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmy-first-adventures-in-nlp-631faa6aadd4&newsletterV3=b6766375747a&newsletterV3Id=527deb2d0591&user=Britton+Winterrose&userId=b6766375747a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}