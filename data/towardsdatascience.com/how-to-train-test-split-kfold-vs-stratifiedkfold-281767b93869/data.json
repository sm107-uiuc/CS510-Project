{"url": "https://towardsdatascience.com/how-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869", "time": 1683007788.276424, "path": "towardsdatascience.com/how-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869/", "webpage": {"metadata": {"title": "How to train_test_split : KFold vs StratifiedKFold | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "How to train_test_split : KFold vs StratifiedKFold", "description": "The data used in supervised learning tasks contains features and a label for a set of observations. The algorithms try to model the relationship between features (independent variables) and label\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html", "anchor_text": "cross_val_score.", "paragraph_index": 13}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 17}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 17}], "all_paragraphs": ["The data used in supervised learning tasks contains features and a label for a set of observations. The algorithms try to model the relationship between features (independent variables) and label (dependent variable). We first train the model by providing both features and label for some observations. Then test the model by only providing features and expecting it to predict the labels. Thus, we need to split the data into training and test subsets. We let the model to learn on training set and then measure its performance on test set.", "Scikit-learn library provides many tools to split data into training and test sets. The most basic one is train_test_split which just divides the data into two parts according to the specified partitioning ratio. For instance, train_test_split(test_size=0.2) will set aside 20% of the data for testing and 80% for training. Let\u2019s see how it is done on an example. We will create a sample dataframe with one feature and a label:", "The first 80% is training and the last 20% is test set. If we set the shuffle parameter to True, the data will be randomly split:", "The default value of shuffle is True so data will be randomly splitted if we do not specify shuffle parameter. If we want the splits to be reproducible, we also need to pass in an integer to random_state parameter. Otherwise, each time we run train_test_split, different indices will be splitted into training and test set. Please note that the numbers seen in the outputs are indices of data points, not the actual values.", "Data is a valuable asset and we want to make use of every bit of it. If we split data using train_test_split, we can only train a model with the portion set aside for training. The models get better as the amount of training data increases. One solution to overcome this issue is cross validation. With cross validation, dataset is divided into n splits. N-1 split is used for training and the remaining split is used for testing. The model runs through the entire dataset n times and at each time, a different split is used for testing. Thus, we use all of data points for both training and testing. Cross validation is also useful to measure the performance of a model more accurately, especially on new, previously unseen data points.", "There are different methods to split data in cross validation. KFold and StratifiedKFold are commonly used.", "As the name suggests, KFold divides the dataset into k folds. If shuffle is set to False, consecutive folds will be the shifted version of previous fold:", "At first iteration, test set is the first four indices. Then KFold keeps shifting the test set k times. If shuffle is set to True, then the splitting will be random.", "StratifiedKFold takes the cross validation one step further. The class distribution in the dataset is preserved in the training and test splits. Let\u2019s take a look at our sample dataframe:", "There are 16 data points. 12 of them belong to class 1 and remaining 4 belong to class 0 so this is an imbalanced class distribution. KFold does not take this into consideration. Therefore, in classifications tasks with imbalanced class distributions, we should prefer StratifiedKFold over KFold.", "The ratio of class 0 to class 1 is 1/3. If we set k=4, then the test sets include three data points from class 1 and one data point from class 0. Thus, training sets include three data points from class 0 and nine data points from class 1.", "The indices of class 0 are 12, 13, 14, and 15. As we can see, the class distribution of the dataset is preserved in the splits. We can also use shuffling with StratifiedKFold:", "Another method used for splitting is called \u201cleave one out\u201d which only use one data point for testing and remaining data points for training. Scikit learn has LeaveOneOut class to perform this type of partitioning.", "Finally, I would like to mention about another important tool provided by scikit-learn which is cross_val_score.", "Cross_val_score takes the dataset and applies cross validation to split the data. Then, train a model using the specified estimator (e.g. logistic regression, decision tree, \u2026) and measure the performance of the model (scoring parameter).", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F281767b93869&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----281767b93869--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----281767b93869--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----281767b93869--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----281767b93869--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----281767b93869---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F281767b93869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F281767b93869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@elizabethlies?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "elizabeth lies"}, {"url": "https://unsplash.com/s/photos/divide?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html", "anchor_text": "cross_val_score."}, {"url": "https://medium.com/tag/data-science?source=post_page-----281767b93869---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----281767b93869---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----281767b93869---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----281767b93869---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F281767b93869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----281767b93869---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F281767b93869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----281767b93869---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F281767b93869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----281767b93869--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F281767b93869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----281767b93869---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----281767b93869--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----281767b93869--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----281767b93869--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----281767b93869--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----281767b93869--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----281767b93869--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----281767b93869--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----281767b93869--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}