{"url": "https://towardsdatascience.com/predicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e", "time": 1683000255.345967, "path": "towardsdatascience.com/predicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e/", "webpage": {"metadata": {"title": "Predicting the Winner of the Rugby World Cup 2019 | by Justin Fisher | Towards Data Science", "h1": "Predicting the Winner of the Rugby World Cup 2019", "description": "I love rugby and I love the Springboks. Its a special kind of feeling when we get to watch our favourite teams showcase their skills over a 6 week period all in quest for the William Webb-Ellis\u2026"}, "outgoing_paragraph_urls": [{"url": "http://stats.espnscrum.com/statsguru/rugby/stats/index.html", "anchor_text": "ESPN", "paragraph_index": 2}, {"url": "https://www.world.rugby/rankings/mru?lang=en", "anchor_text": "World Ruby\u2019s site", "paragraph_index": 4}, {"url": "https://cmsapi.pulselive.com/rugby/rankings/mru?date=%s-11-05&client=pulse", "anchor_text": "rankings/mru?date=2019-08-26&client=pulse", "paragraph_index": 5}, {"url": "https://docs.pymc.io/notebooks/rugby_analytics.html", "anchor_text": "fantastic notebook in the PYMC documentation", "paragraph_index": 7}, {"url": "https://www.walesonline.co.uk/sport/rugby/rugby-news/wales-officially-ranked-best-rugby-15477823", "anchor_text": "Wales was declared the best defensive team in 2018", "paragraph_index": 9}, {"url": "https://medium.com/the-artificial-impostor/march-madness-predictions-using-pymc3-e64574497f47", "anchor_text": "see this awesome blog for more", "paragraph_index": 10}, {"url": "https://github.com/hyperopt/hyperopt", "anchor_text": "Hyperopt", "paragraph_index": 13}, {"url": "https://fixturedownload.com/download/csv/rugby-world-cup-2019", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://medium.com/u/77f178710653?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Mark Ramotowski", "paragraph_index": 21}, {"url": "https://medium.com/u/75d60115fbcb?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Richard Fitzgerald", "paragraph_index": 21}, {"url": "https://medium.com/u/11514ad6479a?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Danielle Fisher", "paragraph_index": 21}], "all_paragraphs": ["I love rugby and I love the Springboks. Its a special kind of feeling when we get to watch our favourite teams showcase their skills over a 6 week period all in quest for the William Webb-Ellis Trophy. Hearts will be broken, hearts will mend and hearts will soar only to be broken once more. Tears (mostly mine) will be shed, beers will be drunk and in true rugby fashion congratulatory and conciliatory hugs will be shared among fans and players alike.", "But I also like to code. Pragmatically. I have, in the past, tried to model the outcomes of various weekly rugby matches using what I know of stats and machine learning. So I decided to blow the dust off the directory, update the data and model and see which team is going to be victorious in this years competition.", "First off, I need data. ESPN has lovely historical database but I can\u2019t seem to find a download button. I need to scrape it. They only show 50 results per page.", "Inspecting the page and more importantly the next page button, I noticed there is an href \u201cgo to page 2 of the results\u201d with a url. So I can use this and BeautifulSoup to parse the htmlmatch data on the page, get a new url and load the next page. Rinse and repeat.", "Also, I want to get official team World Rugby Rankings as it should be a useful feature. Heading over to World Ruby\u2019s site we have rankings configurable by year. Again we chuck an html parser at the page but I require data for every year (and I\u2019m lazy).", "Using essentially the same trick, I can scrape a historical record for rugby rankings by year by inspecting the widget url rankings/mru?date=2019-08-26&client=pulse and simply decrementing the year in the string (* you could, for each match, get the ranking at each day of the match but I didn\u2019t, for now). Merging the data I get the following basic structure:", "Calling a team the home or away team isn\u2019t really applicable in a WC context as all teams are away except for Japan, but the data is organised that way. So I went with the naming convention (it beats left_team and right_team).", "While googling around trying to see if anyone else has done something similar, I stumbled upon a fantastic notebook in the PYMC documentation by Peadar Coyle which uses Hierarchical Bayesian models to allow for the quantification of attacking and defensive strengths for each team. With a bit of copy-pasta and fiddling, we can extend the PYMC model for all the WC teams as well as estimate parameters per season. The strengths and weaknesses for the 2018** season can be seen below.", "These seem to make sense. According to the PYMC article: \u201cWe expect our strong teams to have strong positive effects in attack and strong negative effects in defence.\u201d", "The results are also in accordance with stats from 2018. Wales was declared the best defensive team in 2018 followed by Ireland, NZ and England. On the offensive side, from what I can see on ESPNs stats website, there is close agreement between the strongest attacking teams here and the highest scoring teams for 2018 (** Note the matches included in the plot above are exclusively for 2018 however in the final PYMC model we grouped 2019 into an extended 2018 season. It has been observed small samples from the shortened 2019 pre-world cup season has biased parameters).", "PYMC is a beautiful analysis tool. We can use it to further the analysis by running a few (hundred) simulations of every game and calculate a winning probability for each historical game as well as an estimate of the points difference (see this awesome blog for more).", "We now have our main feature set for each game \u2014 Bayesian offensive and defensive strengths for home and away teams, world rugby ranking for home & away, bayesian probability of a home win as well as the predicted points difference according to PYMC.", "The final data consists of 2613 matches for all international rugby since 2004\u2014 We label encode our teams, the venue (why not), and proceed to a run a classifier on the dataset. To make things simpler for myself I have framed this as a binary problem by classifying a home win as 1 (i.e. home_score \u2014 away_score > 0) and 0 otherwise.", "Chucking the data into my favourite classifier - an XGBoost classifier - with a random train test split and hyper-optimising with Hyperopt gives me the following results:", "Finally, we need WC fixtures. We can download a complete csv list here. Again I make assumptions regarding results for simplification and ignore draws. Assign the home_team 4 points if its a home win, otherwise the away_team gets the points.", "The outcome of the group stages is somewhat predictable. NZ is predicted to beat SA and top group B while Wales is predicted to top pool D. Unsurprisingly England and Ireland are set to top their respective groups. No major upsets are predicted here.", "The outcome of the final stages below is plotted using graphviz and Networkx colour coded by probability of winning. The Ireland vs SA QF looks to be less decisive with a SA win predicted at 51%. Likewise the NZ vs Wales final we do not observe strong probabilities for either team (55% vs 45% in favour of Wales).", "We can probe the model to find out which are the most important features and why it\u2019s making certain predictions. The global feature importance plot below suggests the Bayesian data (probability of win and predicted points difference) are the most important features followed by world ranking position for the relevant teams.", "Similarly, we can understand the predictions locally for each individual game. In the great LIME vs SHAP debate, I chose SHAP for this. No real reason, I just like the idea behind the \u2018removal effect\u2019 of Shapely values. Below we can observe which features are important for each of the quarter finals.", "We see the ranking of the home team plays a significant role in all QF predictions as well as the Bayesian probability data. A strong defensive score also has a strong impact when deciding who is going to win.", "No model is perfect. This was done as a bit of fun over a weekend. I hope you enjoyed the analysis.", "Thanks to Mark Ramotowski, Richard Fitzgerald and Danielle Fisher for indulging me.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F89a27d3f5b8e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@justin.fisher?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@justin.fisher?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Justin Fisher"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd870e553e2b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&user=Justin+Fisher&userId=d870e553e2b1&source=post_page-d870e553e2b1----89a27d3f5b8e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89a27d3f5b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89a27d3f5b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://stats.espnscrum.com/statsguru/rugby/stats/index.html", "anchor_text": "ESPN"}, {"url": "https://www.world.rugby/rankings/mru?lang=en", "anchor_text": "World Ruby\u2019s site"}, {"url": "https://cmsapi.pulselive.com/rugby/rankings/mru?date=%s-11-05&client=pulse", "anchor_text": "rankings/mru?date=2019-08-26&client=pulse"}, {"url": "https://docs.pymc.io/notebooks/rugby_analytics.html", "anchor_text": "fantastic notebook in the PYMC documentation"}, {"url": "https://www.walesonline.co.uk/sport/rugby/rugby-news/wales-officially-ranked-best-rugby-15477823", "anchor_text": "Wales was declared the best defensive team in 2018"}, {"url": "https://medium.com/the-artificial-impostor/march-madness-predictions-using-pymc3-e64574497f47", "anchor_text": "see this awesome blog for more"}, {"url": "https://github.com/hyperopt/hyperopt", "anchor_text": "Hyperopt"}, {"url": "https://fixturedownload.com/download/csv/rugby-world-cup-2019", "anchor_text": "here"}, {"url": "https://medium.com/u/77f178710653?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Mark Ramotowski"}, {"url": "https://medium.com/u/75d60115fbcb?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Richard Fitzgerald"}, {"url": "https://medium.com/u/11514ad6479a?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Danielle Fisher"}, {"url": "https://medium.com/tag/data-science?source=post_page-----89a27d3f5b8e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/rugby-union?source=post_page-----89a27d3f5b8e---------------rugby_union-----------------", "anchor_text": "Rugby Union"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----89a27d3f5b8e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----89a27d3f5b8e---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/sports?source=post_page-----89a27d3f5b8e---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89a27d3f5b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&user=Justin+Fisher&userId=d870e553e2b1&source=-----89a27d3f5b8e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89a27d3f5b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&user=Justin+Fisher&userId=d870e553e2b1&source=-----89a27d3f5b8e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89a27d3f5b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F89a27d3f5b8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----89a27d3f5b8e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----89a27d3f5b8e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@justin.fisher?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@justin.fisher?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Justin Fisher"}, {"url": "https://medium.com/@justin.fisher/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "10 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd870e553e2b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&user=Justin+Fisher&userId=d870e553e2b1&source=post_page-d870e553e2b1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fd870e553e2b1%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-the-winner-of-the-rugby-world-cup-2019-89a27d3f5b8e&user=Justin+Fisher&userId=d870e553e2b1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}