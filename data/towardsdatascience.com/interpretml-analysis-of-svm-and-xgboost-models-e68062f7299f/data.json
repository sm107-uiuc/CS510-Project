{"url": "https://towardsdatascience.com/interpretml-analysis-of-svm-and-xgboost-models-e68062f7299f", "time": 1683015128.800587, "path": "towardsdatascience.com/interpretml-analysis-of-svm-and-xgboost-models-e68062f7299f/", "webpage": {"metadata": {"title": "InterpretML: Analysis of SVM and XGBoost models | by Michael Grogan | Towards Data Science", "h1": "InterpretML: Analysis of SVM and XGBoost models", "description": "InterpretML by Microsoft is designed with the aim of expanding interpretability of machine learning models. In other words, make those models easier to understand and ultimately facilitate human\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/interpretml/interpret", "anchor_text": "InterpretML", "paragraph_index": 0}, {"url": "https://github.com/interpretml/interpret-community", "anchor_text": "Interpret-Community", "paragraph_index": 1}, {"url": "https://christophm.github.io/interpretable-ml-book/global.html", "anchor_text": "global surrogate model", "paragraph_index": 2}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "Antonio, Almeida and Nunes (2019): Hotel booking demand datasets", "paragraph_index": 5}, {"url": "https://machinelearningmastery.com/tune-number-size-decision-trees-xgboost-python/", "anchor_text": "number of trees", "paragraph_index": 23}, {"url": "https://xgboost.readthedocs.io/en/latest/parameter.html", "anchor_text": "\u2018reg:squarederror\u2019", "paragraph_index": 23}, {"url": "https://github.com/MGCodesandStats/hotel-cancellations/tree/master/notebooks%20and%20datasets/regression", "anchor_text": "here", "paragraph_index": 34}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 37}], "all_paragraphs": ["InterpretML by Microsoft is designed with the aim of expanding interpretability of machine learning models. In other words, make those models easier to understand and ultimately facilitate human interpretation.", "Microsoft\u2019s Interpret-Community is an extension of this repository, which includes additional interpretability techniques.", "In particular, one useful feature is what is called the MimicExplainer. This is a type of global surrogate model that allows for interpretability of any black box model.", "In this example, the MimicExplainer is used in interpreting regression models built using SVM (support vector machines) and XGBRegressor (XGBoost for regression problems).", "Specifically, these two models are used as follows:", "The original data is available from Antonio, Almeida and Nunes (2019): Hotel booking demand datasets.", "For the purposes of demonstrating how MimicExplainer works, the original models and results are illustrated \u2014 with further information on how MimicExplainer can make such results more interpretable.", "In order to predict the average daily rate (or rate that a customer pays on average per day) for a hotel booking, an SVM model is constructed with the following features:", "The model is trained as follows:", "When this model was validated against a test set, an RMSE (root mean squared error) of 44.6 was obtained, along with an MAE (mean absolute error) of 29.5. With a mean ADR of 105, the model does show a degree of predictive power in estimating ADR values by customer.", "Here is how we can use MimicExplainer for further interpretability of these results.", "The MimicExplainer is the black box model, while the LinearExplainableModel is being used as the global surrogate to this black box model.", "Note that when running the model, it is possible to set augment_data = True if dealing with high-dimensional data, i.e. a situation where the number of columns exceeds the number of rows. This allows for oversampling of initialization samples.", "However, given that this is not the case here, i.e. the dataset has many more rows than columns (features) \u2014 this will not be invoked.", "Next, a global explanation is printed out which features the top K features and their values indicating importance:", "From the above, feature number 3 (market segment), 7 (week of arrival), and 1 (booking cancellation) are indicated as the most important features in influencing customer ADR.", "That said, what if we wish to isolate certain observations in the validation data? e.g. suppose that we only wish to determine feature importance for a select few customers?", "From the validation set, features of importance and their values are determined for customers ordered 10 to 15.", "Here are the identified features of importance and their values:", "This allows for isolation of feature importance by customer. For instance, feature 1 (booking cancellation) was the most influencing factor for customer 10, whereas feature 7 (week of arrival) was the most influencing factor for customer 11.", "As mentioned, an XGBRegressor model was originally used in order to predict the number of weekly cancellations for the hotel in question.", "The model was defined as follows:", "Here are the defined model parameters:", "As we can see from the above, there are numerous model parameters that could be modified in training the XGBRegressor. However, n_estimators is set to 1000 in this instance. This defines the number of trees in the XGBoost model.The objective is set to \u2018reg:squarederror\u2019, i.e. a regression with squared loss which penalizes errors on extreme values more heavily.", "The RMSE yielded across the validation set was 50.14 along with an MAE of 38.63, which was lower than the mean value of 109 yielded across this set.", "Using MimicExplainer, the interpretability of the model results can now be generated in a similar manner to the previous example:", "For this purpose, we can identify the features that are the most important in determining the weekly hotel cancellation value at time t. However, given that this is a time series \u2014 the model is effectively indicating which lag value is most informative in predicting the cancellation for a particular week, e.g. is a 1-week lag, or a 3-week lag of most importance in influencing cancellations at time t?", "From the above, it is indicated that a lag for feature 3 (t-4) is of most importance when forecasting weekly hotel cancellations at time t.", "However, what if we wish to isolate certain weeks?", "Taking the validation set, let us isolate the weeks across observations 8 to 13 (which corresponds to the year 2017, weeks 13 to 18).", "Identifying the features of importance across the time series in this manner can potentially yield useful insights as to the importance of lagged values in predicting cancellations across different weeks. For instance, we can see that in predicting cancellations for week 13, the lag at t-5 (feature 4) was identified as the most important feature.", "However, when predicting cancellations for week 18, the lag at t-3 (feature 2) was identified as most important.", "As opposed to using a one size fits all forecasting model, interpretability can allow for identification of suitable forecasting methods for a particular point in time, and in turn allow for customisation of time series forecasting methods across different periods.", "In this example, we have seen how interpretability can yield valuable insights when analysing machine learning output \u2014 which would be much more difficult when simply using black box ML models in their own right.", "Many thanks for your time, and any questions or feedback are greatly appreciated. The relevant Jupyter Notebooks for the above examples can be found here.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as any sort of professional advice. The findings are that of the author, and are not affiliated with any third-party mentioned above.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe68062f7299f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e68062f7299f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e68062f7299f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----e68062f7299f--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----e68062f7299f--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----e68062f7299f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe68062f7299f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe68062f7299f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/geralt-9301/", "anchor_text": "geralt"}, {"url": "https://pixabay.com/illustrations/network-earth-block-chain-globe-3537401/", "anchor_text": "Pixabay"}, {"url": "https://github.com/interpretml/interpret", "anchor_text": "InterpretML"}, {"url": "https://github.com/interpretml/interpret-community", "anchor_text": "Interpret-Community"}, {"url": "https://christophm.github.io/interpretable-ml-book/global.html", "anchor_text": "global surrogate model"}, {"url": "https://towardsdatascience.com/support-vector-machines-and-regression-analysis-ad5d94ac857f?source=---------23----------------------------", "anchor_text": "Original findings are available here."}, {"url": "https://towardsdatascience.com/predicting-weekly-hotel-cancellations-with-xgbregressor-d73eb74a8624", "anchor_text": "Original findings are available here."}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "Antonio, Almeida and Nunes (2019): Hotel booking demand datasets"}, {"url": "https://machinelearningmastery.com/tune-number-size-decision-trees-xgboost-python/", "anchor_text": "number of trees"}, {"url": "https://xgboost.readthedocs.io/en/latest/parameter.html", "anchor_text": "\u2018reg:squarederror\u2019"}, {"url": "https://github.com/MGCodesandStats/hotel-cancellations/tree/master/notebooks%20and%20datasets/regression", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e68062f7299f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e68062f7299f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----e68062f7299f---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----e68062f7299f---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/regression?source=post_page-----e68062f7299f---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe68062f7299f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&user=Michael+Grogan&userId=eec017a8b178&source=-----e68062f7299f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe68062f7299f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&user=Michael+Grogan&userId=eec017a8b178&source=-----e68062f7299f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe68062f7299f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e68062f7299f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe68062f7299f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e68062f7299f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e68062f7299f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e68062f7299f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e68062f7299f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e68062f7299f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e68062f7299f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e68062f7299f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e68062f7299f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e68062f7299f--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpretml-analysis-of-svm-and-xgboost-models-e68062f7299f&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}