{"url": "https://towardsdatascience.com/are-you-using-pipeline-in-scikit-learn-ac4cd85cb27f", "time": 1683009628.313916, "path": "towardsdatascience.com/are-you-using-pipeline-in-scikit-learn-ac4cd85cb27f/", "webpage": {"metadata": {"title": "Are you using Pipeline in Scikit-Learn? | by Ankit Goel | Towards Data Science", "h1": "Are you using Pipeline in Scikit-Learn?", "description": "Create Machine Learning workflow using Pipeline and GridSearchCV. Find best Scaler, Imputer, model hyper-parameters and different transformers."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/8b7aca3e5b1c?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Rebecca Vickery", "paragraph_index": 1}, {"url": "https://medium.com/vickdata/a-simple-guide-to-scikit-learn-pipelines-4ac0d974bdcf", "anchor_text": "A Simple Guide to Scikit-learn Pipelines", "paragraph_index": 1}, {"url": "https://medium.com/u/9a3c3c477239?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Saptashwa Bhattacharyya", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/a-simple-example-of-pipeline-in-machine-learning-with-scikit-learn-e726ffbb6976", "anchor_text": "A Simple Example of Pipeline in Machine Learning with Scikit-learn", "paragraph_index": 1}, {"url": "https://medium.com/u/8b7aca3e5b1c?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Rebecca Vickery", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/swlh/start-your-data-science-journey-today-37366ee463f", "anchor_text": "Start your Data Science journey today", "paragraph_index": 23}, {"url": "http://www.linkedin.com/in/ankit-goel-9b2b2037", "anchor_text": "www.linkedin.com/in/ankit-goel-9b2b2037", "paragraph_index": 25}], "all_paragraphs": ["If you are doing Machine Learning, you would have come across pipelines as they help you to make a better machine learning workflow which is easy to understand and reproducible.", "In case you are not aware of the pipelines you can refer awesome blogs from Rebecca Vickery \u201cA Simple Guide to Scikit-learn Pipelines\u201d and Saptashwa Bhattacharyya \u201cA Simple Example of Pipeline in Machine Learning with Scikit-learn\u201d.", "I recently discovered that you can combine Pipeline with GridSearchCV to not only find best hyperparameters for your model but can also find the best transformers for your machine learning tasks like-", "and many others. Let\u2019s see how it can be done.", "To best demonstrate, I am going to use the Titanic dataset from OpenML here to walkthrough on how you can create a data pipeline.", "You can download the dataset using the following commands-", "Also, have a look at my notebook which have more details about each operation, feel free to download and import it in your environment and play around-", "I am going to use a subset of features for the demo purposes here. The dataset has both categorical and numerical features and we would be applying different operations on them. Here is the flow-", "1. Define numerical and categorical features.", "2. For numerical features, fill the missing values and then scale the data.", "The numerical features in the dataset have few missing values and we are using SimpleImputer here to fill these values, other imputers can be used as well. Also, we should standardize the range of numerical features using Scaling as many machine learning models require features that follow the same scale. I have not defined the strategy for imputing and the scaler need to be used as the same can be searched using GridSearchCV.", "3. For categorical features, fill the missing values and then apply one-hot encoding.", "The \u2018Embarked\u2019 feature in our dataset has few missing values. The reason to create a different imputer for this as we have different strategies to fill categorical features. Also, as categorical features have only a few values, I am using OneHotEncoder which is commonly used to create different features for each value in categorical columns. The strategy of imputing is searched using GridSearchCV.", "4. Combine numerical and categorical transformer using ColumnTransformer.", "ColumnTransformer helps to define different transformers for different types of inputs and combine them into a single feature space after transformation. Here we are applying numerical transformer and categorical transformer created above for our numerical and categorical features.", "5. Apply PCA to reduce dimensions.", "Principle Component Analysis aka PCA is a linear dimensionality reduction algorithm that is used to reduce the number of features in the dataset by keeping the maximum variance. We might not need to apply PCA here as it is a small dataset but the idea is to show how you can search for number_of _components in PCA using GridSearchCV.", "Above, we created a preprocessor pipeline with all the operations we would like to apply to our data. I am going to use Logistic Regression here as a classifier for our problem. In case you are interested to know how you can apply multiple models, Rebecca Vickery has mentioned a nice way of doing it in her blog.", "Every Data Scientist would be aware of GridSearchCV which helps us to find the best hyperparameters of the model. One thing which is missed is that you can even use it to find out the best transformers with the help of Pipeline. In the preprocessor pipeline we created above, you might have noticed that we didn\u2019t define-", "as we can use GridSearchCV to find the optimal value for them. Here is how it can be done-", "Above, I am trying to find the best Scaler out of 3 different scalers and Impute strategy for our numerical and categorical columns as well as components for PCA along with hyper-parameters for our model. Helpful, isn\u2019t it?", "Scikit-Learn 0.23.1 has added the functionality to visualize composite estimators which can be very helpful to cross-check the steps you applied. The below code can help you to visualize the data pipeline.", "Here I created many different transformers on the data which can be computationally intensive. The pipeline provides a parameter \u2018memory\u2019 which can be used to cache the transformer if the parameters and input data are identical. We can set \u2018memory\u2019 as the directory path where to cache the transformers or it can be a joblib.Memory object. Below, I am using the current directory as the cache directory where all the cache objects for the transformer would be created.", "I use Pipeline all the time as it is super easy to implement and helps us to get rid of many problems. I hope this would help you guys as well to improve your machine learning workflow. If you are just starting your data science journey or would like to learn about some cool python libraries for data science, then check out this- Start your Data Science journey today.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Recently developed my interest in Data Science and exploring the field to see what all we can achieve. Linkedin- www.linkedin.com/in/ankit-goel-9b2b2037"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac4cd85cb27f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ankitgoel16?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankitgoel16?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Ankit Goel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76a91f429f35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&user=Ankit+Goel&userId=76a91f429f35&source=post_page-76a91f429f35----ac4cd85cb27f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac4cd85cb27f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac4cd85cb27f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/u/8b7aca3e5b1c?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Rebecca Vickery"}, {"url": "https://medium.com/vickdata/a-simple-guide-to-scikit-learn-pipelines-4ac0d974bdcf", "anchor_text": "A Simple Guide to Scikit-learn Pipelines"}, {"url": "https://medium.com/u/9a3c3c477239?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Saptashwa Bhattacharyya"}, {"url": "https://towardsdatascience.com/a-simple-example-of-pipeline-in-machine-learning-with-scikit-learn-e726ffbb6976", "anchor_text": "A Simple Example of Pipeline in Machine Learning with Scikit-learn"}, {"url": "https://www.openml.org/d/40945", "anchor_text": "https://www.openml.org/d/40945"}, {"url": "https://github.com/ankitgoel1602/data-science/tree/master/data-pipeline", "anchor_text": "ankitgoel1602/data-scienceThis directory has the details on how you can use Data Pipelines to apply various operations on the data. And also\u2026github.com"}, {"url": "https://medium.com/u/8b7aca3e5b1c?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Rebecca Vickery"}, {"url": "https://towardsdatascience.com/swlh/start-your-data-science-journey-today-37366ee463f", "anchor_text": "Start your Data Science journey today"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ac4cd85cb27f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac4cd85cb27f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----ac4cd85cb27f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----ac4cd85cb27f---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/pipeline?source=post_page-----ac4cd85cb27f---------------pipeline-----------------", "anchor_text": "Pipeline"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac4cd85cb27f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&user=Ankit+Goel&userId=76a91f429f35&source=-----ac4cd85cb27f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac4cd85cb27f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&user=Ankit+Goel&userId=76a91f429f35&source=-----ac4cd85cb27f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac4cd85cb27f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac4cd85cb27f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac4cd85cb27f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac4cd85cb27f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankitgoel16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankitgoel16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ankit Goel"}, {"url": "https://medium.com/@ankitgoel16/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "130 Followers"}, {"url": "http://www.linkedin.com/in/ankit-goel-9b2b2037", "anchor_text": "www.linkedin.com/in/ankit-goel-9b2b2037"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76a91f429f35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&user=Ankit+Goel&userId=76a91f429f35&source=post_page-76a91f429f35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff84a21a690ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-using-pipeline-in-scikit-learn-ac4cd85cb27f&newsletterV3=76a91f429f35&newsletterV3Id=f84a21a690ae&user=Ankit+Goel&userId=76a91f429f35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}