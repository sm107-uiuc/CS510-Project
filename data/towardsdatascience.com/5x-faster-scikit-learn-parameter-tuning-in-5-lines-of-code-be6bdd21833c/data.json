{"url": "https://towardsdatascience.com/5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c", "time": 1683012319.831133, "path": "towardsdatascience.com/5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c/", "webpage": {"metadata": {"title": "5x Faster Scikit-Learn Parameter Tuning in 5 Lines of Code | by Michael Chau | Towards Data Science", "h1": "5x Faster Scikit-Learn Parameter Tuning in 5 Lines of Code", "description": "GridSearchCV is too slow. 1 line change for 5x faster Scikit-Learn GridSearchCV. Easily leverage bayesian optimization, early stopping, distributed execution with tune-sklearn."}, "outgoing_paragraph_urls": [{"url": "http://mchau.pythonanywhere.com/", "anchor_text": "Michael Chau", "paragraph_index": 0}, {"url": "http://anthonyhsyu.com", "anchor_text": "Anthony Yu", "paragraph_index": 0}, {"url": "http://people.eecs.berkeley.edu/~rliaw/", "anchor_text": "Richard Liaw", "paragraph_index": 0}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn", "paragraph_index": 3}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "Tune-sklearn", "paragraph_index": 3}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn", "paragraph_index": 4}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "Tune-sklearn", "paragraph_index": 5}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn", "paragraph_index": 5}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "Tune-sklearn", "paragraph_index": 6}, {"url": "https://docs.ray.io/en/master/tune-schedulers.html", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn", "paragraph_index": 17}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn", "paragraph_index": 20}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn here", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/distributed-computing-with-ray/easy-distributed-scikit-learn-training-with-ray-54ff8b643b33", "anchor_text": "replacement", "paragraph_index": 20}], "all_paragraphs": ["By Michael Chau, Anthony Yu, Richard Liaw", "Everyone knows about Scikit-Learn \u2014 it\u2019s a staple for data scientists, offering dozens of easy-to-use machine learning algorithms. It also provides two out-of-the-box techniques to address hyperparameter tuning: Grid Search (GridSearchCV) and Random Search (RandomizedSearchCV).", "Though effective, both techniques are brute-force approaches to finding the right hyperparameter configurations, which is an expensive and time-consuming process!", "In this blog post, we introduce tune-sklearn. Tune-sklearn is a drop-in replacement for Scikit-Learn\u2019s model selection module with cutting edge hyperparameter tuning techniques (bayesian optimization, early stopping, distributed execution) \u2014 these techniques provide significant speedups over grid search and random search!", "Here\u2019s what tune-sklearn has to offer:", "Tune-sklearn is also fast. To see this, we benchmark tune-sklearn (with early stopping enabled) against native Scikit-Learn on a standard hyperparameter sweep. In our benchmarks we can see significant performance differences on both an average laptop and a large workstation of 48 CPU cores.", "For the larger benchmark 48-core computer, Scikit-Learn took 20 minutes for a 40,000-size dataset searching over 75 hyperparameter sets. Tune-sklearn took a mere 3 and a half minutes \u2014 sacrificing minimal accuracy.*", "* Note: For smaller datasets (10,000 or fewer data points), there may be a sacrifice in accuracy when attempting to fit with early stopping. We don\u2019t anticipate this to make a difference for users as the library is intended to speed up large training tasks with large datasets.", "Let\u2019s take a look at how it all works.", "Run pip install tune-sklearn ray[tune] or pip install tune-sklearn \"ray[tune]\" to get started with our example code below.", "To start out, it\u2019s as easy as changing our import statement to get Tune\u2019s grid search cross validation interface:", "And from there, we would proceed just like how we would in Scikit-Learn\u2019s interface! Let\u2019s use a \u201cdummy\u201d custom classification dataset and an SGDClassifier to classify the data.", "We choose the SGDClassifier because it has a partial_fit API, which enables it to stop fitting to the data for a certain hyperparameter configuration. If the estimator does not support early stopping, we would fall back to a parallel grid search.", "As you can see, the setup here is exactly how you would do it for Scikit-Learn! Now, let\u2019s try fitting a model.", "Note the slight differences we introduced above:", "The early_stopping determines when to stop early \u2014 MedianStoppingRule is a great default but see Tune\u2019s documentation on schedulers here for a full list to choose from. max_iters is the maximum number of iterations a given hyperparameter set could run for; it may run for fewer iterations if it is early stopped.", "Try running this compared to the GridSearchCV equivalent.", "Other than the grid search interface, tune-sklearn also provides an interface, TuneSearchCV, for sampling from distributions of hyperparameters.", "In addition, you can easily enable Bayesian optimization over the distributions in TuneSearchCV in only a few lines of code changes.", "Run pip install scikit-optimize to try out this example:", "As you can see, it\u2019s very simple to integrate tune-sklearn into existing code. Check out more detailed examples and get started with tune-sklearn here and let us know what you think! Also take a look at Ray\u2019s replacement for joblib, which allows users to parallelize training over multiple nodes, not just one node, further speeding up training.", "*Note: importing from ray.tune as shown in the linked documentation is available only on the nightly Ray wheels and will be available on pip soon", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CS & Stats @ UC Berkeley"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbe6bdd21833c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@michaelchau_99485?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michaelchau_99485?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": "Michael Chau"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fda63c0610e34&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&user=Michael+Chau&userId=da63c0610e34&source=post_page-da63c0610e34----be6bdd21833c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6bdd21833c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6bdd21833c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "Tune-sklearn"}, {"url": "http://mchau.pythonanywhere.com/", "anchor_text": "Michael Chau"}, {"url": "http://anthonyhsyu.com", "anchor_text": "Anthony Yu"}, {"url": "http://people.eecs.berkeley.edu/~rliaw/", "anchor_text": "Richard Liaw"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "Tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "Tune-sklearn"}, {"url": "http://tune.io/", "anchor_text": "Ray Tune"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "Tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "Tune-sklearn"}, {"url": "https://docs.ray.io/en/master/tune-schedulers.html", "anchor_text": "here"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn", "anchor_text": "tune-sklearn here"}, {"url": "https://towardsdatascience.com/distributed-computing-with-ray/easy-distributed-scikit-learn-training-with-ray-54ff8b643b33", "anchor_text": "replacement"}, {"url": "https://docs.ray.io/en/master/tune/api_docs/sklearn.html", "anchor_text": "Documentation"}, {"url": "https://github.com/ray-project/tune-sklearn/blob/master/examples/torch_nn.py", "anchor_text": "Skorch with tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn/blob/master/examples/sklearn_pipeline.py", "anchor_text": "Scikit-Learn Pipelines with tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn/blob/master/examples/xgbclassifier.py", "anchor_text": "XGBoost with tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn/blob/master/examples/keras_example.py", "anchor_text": "KerasClassifier with tune-sklearn"}, {"url": "https://github.com/ray-project/tune-sklearn/blob/master/examples/lgbm.py", "anchor_text": "LightGBM with tune-sklearn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----be6bdd21833c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----be6bdd21833c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----be6bdd21833c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----be6bdd21833c---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----be6bdd21833c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe6bdd21833c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&user=Michael+Chau&userId=da63c0610e34&source=-----be6bdd21833c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe6bdd21833c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&user=Michael+Chau&userId=da63c0610e34&source=-----be6bdd21833c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6bdd21833c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbe6bdd21833c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----be6bdd21833c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----be6bdd21833c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----be6bdd21833c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----be6bdd21833c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----be6bdd21833c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michaelchau_99485?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michaelchau_99485?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Chau"}, {"url": "https://medium.com/@michaelchau_99485/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "83 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fda63c0610e34&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&user=Michael+Chau&userId=da63c0610e34&source=post_page-da63c0610e34--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fda63c0610e34%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5x-faster-scikit-learn-parameter-tuning-in-5-lines-of-code-be6bdd21833c&user=Michael+Chau&userId=da63c0610e34&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}