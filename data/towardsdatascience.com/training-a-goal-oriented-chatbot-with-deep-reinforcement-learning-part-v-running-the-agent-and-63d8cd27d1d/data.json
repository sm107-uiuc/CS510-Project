{"url": "https://towardsdatascience.com/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d", "time": 1682994044.2979121, "path": "towardsdatascience.com/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d/", "webpage": {"metadata": {"title": "Training a Goal-Oriented Chatbot with Deep Reinforcement Learning \u2014 Part V | by Max Brenner | Towards Data Science", "h1": "Training a Goal-Oriented Chatbot with Deep Reinforcement Learning \u2014 Part V", "description": "Final part, in which we discuss future research and running the code"}, "outgoing_paragraph_urls": [{"url": "https://github.com/MiuLab/TC-Bot", "anchor_text": "TC-Bot", "paragraph_index": 2}, {"url": "https://github.com/maxbren/GO-Bot-DRL", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/user.py", "anchor_text": "user.py", "paragraph_index": 2}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/test.py", "anchor_text": "test.py.", "paragraph_index": 2}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/constants.json", "anchor_text": "constants.json", "paragraph_index": 10}, {"url": "https://medium.com/analytics-vidhya/building-a-simple-chatbot-in-python-using-nltk-7c8c8215ac6e", "anchor_text": "Medium article", "paragraph_index": 13}, {"url": "https://www.csie.ntu.edu.tw/~yvchen/doc/IS16_MultiJoint.pdf", "anchor_text": "NTU paper", "paragraph_index": 13}, {"url": "https://www.csie.ntu.edu.tw/~yvchen/doc/SLT16_SyntaxSemantics.pdf", "anchor_text": "NTU and Microsoft", "paragraph_index": 13}, {"url": "https://github.com/MiuLab/TC-Bot", "anchor_text": "TC-Bot", "paragraph_index": 13}, {"url": "http://aclweb.org/anthology/I17-1074", "anchor_text": "paper", "paragraph_index": 13}, {"url": "https://github.com/google-research-datasets/simulated-dialogue", "anchor_text": "google datasets", "paragraph_index": 14}, {"url": "https://nlp.stanford.edu/blog/a-new-multi-turn-multi-domain-task-oriented-dialogue-dataset/", "anchor_text": "stanford", "paragraph_index": 14}, {"url": "https://arxiv.org/pdf/1506.07190.pdf", "anchor_text": "Cambridge paper", "paragraph_index": 15}, {"url": "https://www.sigdial.org/files/workshops/conference17/proceedings/pdf/SIGDIAL02.pdf", "anchor_text": "Yahoo", "paragraph_index": 15}, {"url": "https://pdfs.semanticscholar.org/4ba3/39bd571585fadb1fb1d14ef902b6784f574f.pdf", "anchor_text": "dialogue state tracking challenge", "paragraph_index": 15}, {"url": "http://alborz-geramifard.com/workshops/nips17-Conversational-AI/Papers/17nipsw-cai-collaboration-based-simulator.pdf", "anchor_text": "paper", "paragraph_index": 17}, {"url": "https://www.microsoft.com/en-us/research/uploads/prod/2017/04/emnlp2017_arxiv.pdf", "anchor_text": "paper", "paragraph_index": 18}], "all_paragraphs": ["In the previous parts we covered all of the parts and code of a goal-oriented agent!", "This is the fifth and final part in which we will cover how to run the code and future research and improvements!", "This tutorial series is based off of TC-Bot. The code for this series can be found here. In this part we will quickly review user.py and test.py.", "You can both train an agent and test a trained agent. Also instead of using the user simulator you can input actions yourself as a real user.", "Run train.py as is to train from scratch with the given constants.json file. Alter constants values to see if you can find better hyperparameters.", "You can save the weights of your trained model in a directory by setting \"save_weights_file_path\u201d in constants.json to the the relative file path of where you want to save both behavior and target model weights. To load saved weights set \"load_weights_file_path\u201d to the same path. For example, to load the weights in the repo set it to \"weights/model.h5\". The weights file must be a .h5 file which is the file type that Keras uses. You can load in already trained weights and train them more!", "An agent can be tested with trained weights by running test.py and setting \"load_weights_file_path\u201d to the correct file path.", "You can test the agent by inputting your own actions as the user (instead of using a user sim) by setting \"usersim\u201d under \u201crun\u201d in constants.json to false. You input an action and a success indicator every step of an episode in console. The format for the action input is: intent/inform slots/request slots.", "In addition the console will ask for an indicator on whether the agent succeeded yet (other than after the initial action input of an episode). Allowed inputs are -1 for loss, 0 for no outcome yet, 1 for success.", "Have fun with a trained agent and qualitatively test your improvements!", "My data was collected using the hyperparameters as they are set in constants.json and averaged over 10 training runs.", "Table of episodes (every 2000 out of 40000) by max success rate of a period/train frequency (every 100 episodes) up to that episode:", "What we just coded is a pretty simple example of a goal-oriented chatbot system. The user sim isn\u2019t too advanced and unlike TC-Bot there is no natural language components in this system. There is a lot of room for improvement on the agent including allowing more complex actions. However, this is a very good starting point for further research and experimenting on this topic. Here are some important places to improve or add on to this existing code or just to research:", "Add natural language components such as in TC-Bot so that you can test it in a more realistic conversational setting. Keep in mind natural language components are not trained with this deep reinforcement learning loop, they are pretrained separately using different usually supervised learning methods with LSTMs. Here are a few resources on this topic: Medium article, NTU paper, NTU and Microsoft and of course TC-Bot and its paper.", "We only saw how well this system worked with a simple movie ticket database. Try it on another database with the same structure as this one. Make sure to alter the dialogue configuration accordingly, but remember this is a simple system that only works with the goal of finding a single item to fulfill a user goal. See if you can alter it to find multiple items needed for a goal! Here are some google datasets and one from stanford. But there are plenty more out there.", "Developments in state tracking is probably the most prominent topic in chatbots. It is very important for the state tracker of a system to prepare a useful state for the agent to take close-to-optimal actions. If important info is missing such as what the user\u2019s action just was then it could be hard for the agent to reply well. In addition, the way this info is encoded and if there is useless info also have effects on the optimality of the actions taken. Here are some resources on ST: Cambridge paper, Yahoo, and the dialogue state tracking challenge.", "While I couldn\u2019t find any papers or other resources that discuss this, experimenting with more advanced/different DRL algorithms such as A3C, PPO, TRPO, ACKTR, model-based approaches, hybrid model-free model-based etc. would be a great area to experiment in for GO bots! Remember, because the training method in this code centered around using memory and flushing memory at specific times, new training methods would have to accompany algorithms that don\u2019t use memory pools (which is most of them).", "There is currently a lot of research on creating more human-like user simulators as this is important to get high-quality training. The user sim built here is solid but can still be greatly improved upon. This paper goes into building realistic user sims.", "The movie ticket domain covered here is a realistic use-case for GO chatbots but is still pretty simple. In most cases the complexity of a problem goes up in the real world and that is true here too. Goal-oriented problems tend to be composite and hierarchical meaning that the problem is really a bunch of sub-problems that have to be completed. This paper explains how to augment the existing TC-Bot framework to allow for more complex hierarchical goals to be completed. This in turn can be added to the code created here.", "Experiment with what you have learned and coded so far! This field is advancing fast with the new capabilities of machine and deep learning!", "Thanks for following along and hopefully you got a whole lot out of this series and code! Feel free to comment if you have any questions!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in all things machine learning, procedural and generative"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F63d8cd27d1d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maxbrenner110?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxbrenner110?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": "Max Brenner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe83c3988e008&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&user=Max+Brenner&userId=e83c3988e008&source=post_page-e83c3988e008----63d8cd27d1d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d8cd27d1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d8cd27d1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.nasa.gov/mission_pages/shuttle/shuttlemissions/sts127/launch/index.html", "anchor_text": ""}, {"url": "https://www.nasa.gov/mission_pages/shuttle/shuttlemissions/sts127/launch/index.html", "anchor_text": "https://www.nasa.gov/mission_pages/shuttle/shuttlemissions/sts127/launch/index.html"}, {"url": "https://github.com/MiuLab/TC-Bot", "anchor_text": "TC-Bot"}, {"url": "https://github.com/maxbren/GO-Bot-DRL", "anchor_text": "here"}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/user.py", "anchor_text": "user.py"}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/test.py", "anchor_text": "test.py."}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/constants.json", "anchor_text": "constants.json"}, {"url": "https://www.csie.ntu.edu.tw/~yvchen/doc/SLT16_SyntaxSemantics.pdf", "anchor_text": ""}, {"url": "https://medium.com/analytics-vidhya/building-a-simple-chatbot-in-python-using-nltk-7c8c8215ac6e", "anchor_text": "Medium article"}, {"url": "https://www.csie.ntu.edu.tw/~yvchen/doc/IS16_MultiJoint.pdf", "anchor_text": "NTU paper"}, {"url": "https://www.csie.ntu.edu.tw/~yvchen/doc/SLT16_SyntaxSemantics.pdf", "anchor_text": "NTU and Microsoft"}, {"url": "https://github.com/MiuLab/TC-Bot", "anchor_text": "TC-Bot"}, {"url": "http://aclweb.org/anthology/I17-1074", "anchor_text": "paper"}, {"url": "https://github.com/google-research-datasets/simulated-dialogue", "anchor_text": "google datasets"}, {"url": "https://nlp.stanford.edu/blog/a-new-multi-turn-multi-domain-task-oriented-dialogue-dataset/", "anchor_text": "stanford"}, {"url": "https://arxiv.org/pdf/1506.07190.pdf", "anchor_text": "Cambridge paper"}, {"url": "https://www.sigdial.org/files/workshops/conference17/proceedings/pdf/SIGDIAL02.pdf", "anchor_text": "Yahoo"}, {"url": "https://pdfs.semanticscholar.org/4ba3/39bd571585fadb1fb1d14ef902b6784f574f.pdf", "anchor_text": "dialogue state tracking challenge"}, {"url": "http://alborz-geramifard.com/workshops/nips17-Conversational-AI/Papers/17nipsw-cai-collaboration-based-simulator.pdf", "anchor_text": "paper"}, {"url": "https://www.microsoft.com/en-us/research/uploads/prod/2017/04/emnlp2017_arxiv.pdf", "anchor_text": ""}, {"url": "https://www.microsoft.com/en-us/research/uploads/prod/2017/04/emnlp2017_arxiv.pdf", "anchor_text": "paper"}, {"url": "http://aclweb.org/anthology/N18-3006", "anchor_text": "Advanced real-life training"}, {"url": "https://arxiv.org/pdf/1802.00500.pdf", "anchor_text": "Transfer learning with GO bots"}, {"url": "https://arxiv.org/pdf/1809.08267.pdf", "anchor_text": "Overview on everything GO bots in deep learning"}, {"url": "https://www.poly-ai.com/docs/naacl18.pdf", "anchor_text": "Another overview on everything GO Bots in deep learning"}, {"url": "https://medium.com/gobeyond-ai/a-reading-list-and-mini-survey-of-conversational-ai-32fceea97180", "anchor_text": "Great Medium post with a bunch of resources on chatbots"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----63d8cd27d1d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----63d8cd27d1d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/chatbots?source=post_page-----63d8cd27d1d---------------chatbots-----------------", "anchor_text": "Chatbots"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----63d8cd27d1d---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63d8cd27d1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&user=Max+Brenner&userId=e83c3988e008&source=-----63d8cd27d1d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63d8cd27d1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&user=Max+Brenner&userId=e83c3988e008&source=-----63d8cd27d1d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d8cd27d1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F63d8cd27d1d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----63d8cd27d1d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----63d8cd27d1d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxbrenner110?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxbrenner110?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Max Brenner"}, {"url": "https://medium.com/@maxbrenner110/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "238 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe83c3988e008&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&user=Max+Brenner&userId=e83c3988e008&source=post_page-e83c3988e008--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffb2cbe1972e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d&newsletterV3=e83c3988e008&newsletterV3Id=fb2cbe1972e0&user=Max+Brenner&userId=e83c3988e008&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}