{"url": "https://towardsdatascience.com/i-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588", "time": 1683017205.575841, "path": "towardsdatascience.com/i-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588/", "webpage": {"metadata": {"title": "I made an AI to recognize over 10,000 Yugioh cards | by Anthony Lowhur | Towards Data Science", "h1": "I made an AI to recognize over 10,000 Yugioh cards", "description": "There is a childhood card game that I have liked when I was younger called Yugioh. It involves summoning different monsters as well as using different spells and traps with the goal of destroying\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/vanstorm9/yugioh-one-shot-learning", "anchor_text": "here", "paragraph_index": 45}], "all_paragraphs": ["There is a childhood card game that I have liked when I was younger called Yugioh. It involves summoning different monsters as well as using different spells and traps with the goal of destroying your opponent\u2019s monsters and reducing their life points to 0.", "In this game as of right now, there are over 10,000 cards in the game (10,856 to be exact). And I decided to take the ambitious task of making an AI to recognize all of them.", "Got inspiration to try this out after seeing when Konami made:", "I wanted to try to replicate as close to Konami\u2019s results as much as possible, but tried a different approach to the problem.", "Konami used a method that involves rendering two slightly different semi-transparent images and merging them together to aid in training.", "I decided to challenge myself and try out a different approach to this problem, one shot learning. One shot learning is a method that is designed to work with datasets that has a massive amount of classes, but very few images per class, which made this method seem to be very suitable to this problem.", "First, we had to extract our dataset. The card dataset was retrieved from an API. The full size version of the cards were used:", "The API was used to download all Yugioh cards (10,856 cards) onto our machine so that we can turn it into a dataset.", "However, the main problem is that most cards only contain one card art (and other cards with multiple card arts have card arts significantly different from each other). In a machine learning sense, essentially there are over 10,000 classes where each of those classes contain only one image each.", "This is a problem, as traditional deep learning methods would not do well on datasets with classes that contain lower than a hundred images, let alone one image per class. And we are doing this for 10,000 classes.", "As a result, we would have to use one shot learning to tackle this problem. One shot learning is a method that compares similarity between two images rather than predict a class.", "Full size image vs normal size image", "The API from YGO to retrieve card images at either full size or smaller size. I originally tried to work with smaller size images in an attempt to optimize image processing/network prediction speed though full size images were used in the end in order to optimize network accuracy.", "The first method I tried to do one shot learning was using siamese network. This involves using a network with a loss function that compares the similarity / distance between two images. The entire process involves taking two images and feeding it into a network with the same weights. The output feature maps from the network are then compared to each other through a distance-measuring metric and gives a similarity score (0 meaning the two images are exactly the same, and 1 means that they are rather different images)", "While we are working with only one image per class, we want to see if we can get as much robustness from this model as we possibly can. As a result, we perform image augmentation to create multiple versions of each card art, but with subtle differences (brightness change, contrast change, shifting, etc). This will give our network slightly more data to work with allowing our model to generalize better.", "After doing some experimentation, our model was not achieving a high training accuracy so a different architecture was used. I thought that adding more layers to our model would solve our bias problem, so I decided to change our architecture to resnet101. This brought a jump in accuracy and is the model architecture that I ended up sticking with.", "I didn\u2019t know too much about triplet net at the time, it was something that I learned about when I was looking for ways to improve from the Siamese network architecture.", "It takes an image and finds two other images to accompany it, one of the image is another image of the same class, and another is from a different class. These are referred to as positive anchor (image of same class) and negative anchor (image of different class). During the training process, the triplet loss function tries to take the target image and have the distance between the image and positive anchor to be closer while the image and negative anchor to be further.", "The transition from siamese neural network to triplet net was simple as all this involved was passing three images through the same neural network as opposed to two images and changing the loss function to triplet loss.", "While triplet net made from resnet101 showed significant improvement, there seems to be some borderline cases in which it doesn\u2019t predict the correct rank-1 class, but got relatively close. To overcome this, the ORB algorithm is used as support. ORB is an algorithm that searches for feature points within an image, so if two images are completely identical, the two images should have the same amount of feature points as each other.", "This algorithm serves as support to our one shot learning method. As soon as our neural network generates a score on all 10,000 cards and ranks them, our ORB takes the top n card ranking (for example, top 50 cards) and calculates the amount of ORB points on the images. The original similarity score and number of ORB points are then fed into a formula to get a final weighted similarity score. The weighted score of the top n cards gets compared, and the scores get rearrange to their final rankings.", "After some experimentation and tuning of certain values, we are able to significantly improve the amount of correct predictions.", "Another problem encountered was one shot learning is not translation-invariant. This means that if you have two identical photos and start shifting one of them in a direction, the model will slowly no longer be able to recognize the two photos as the same thing.", "On the left side, the original image being compared with the same image, but translated to the right (we jumped up by 0.71 points).", "In the middle image, the original image being compared with the same image, but translated to right and upward.", "In the right image, the original image being compared with the same image, but translated to right and upward.", "This is a problem shows that our model would be very sensitive to slight misalignment and would prevent our model from achieving its full potential.", "As a result, I had to look up methods that would help tackle this issue. As a result, I found some research that created blur pooling algorithm for the purpose of tried to tackle a similar problem. Blur pooling is a method that was made to solve the problem of CNNs not being sift-invariant and is a method applied at the end of every convolution layer.", "You can check out more details about Blur Pooling here:", "So at this point, I have a model capable of generating similarity score of every card at a reasonable accuracy. Now all I have to do is generate similarity scores for our input image and all the cards I wish to compare it with.", "If I measure the inference time of my model, we can see that it takes around 0.12 seconds to pass a single image through our Triplet Resnet architecture along with a 0.08 second image preprocessing step. This does not sound bad on the surface, but remember that we have to do this on all cards we have on the dataset. The problem is that there are over 10,000 cards we will have to compare with the input and generate a score for.", "So if we take the amount of seconds it takes to generate a similarity score and the total amount of cards (10,856) there are in the dataset, we get this:", "To get a prediction on what a single input image is, we would have to wait well over 30 minutes. This does not make our model practical to use as a result.", "In order to solve this, I ended up using is pre-calculating the output convolution feature maps of all 10,000 cards ahead of time and storing them in a dictionary. The great thing about dictionaries is that retrieving the pre-calculated feature maps from them would be constant time ( O(1) time). So this would do a decent job scaling with the number of cards in the dataset.", "So what happens is that after training, we iterate through over 10,000 cards, feed them into our triplet net to get the output convolution feature map, and store that in our dictionary. Doing prediction phase, we just iterate through our new dictionary instead of having our model performing forward propagation 10,000 times.", "As a result, the previous single-image prediction time of 36 minutes has been significantly reduced to close to 5 seconds. This definitely makes the model a lot more easier to work with.", "The AI/machine learning model was tested on real photos of cards (cards with and without sleeves)", "These types of images are what I ultimately want my AI classifer to be successful on: having a camera point down on your card and be able to recognize it.", "However, since buying over 10,000 cards and taking pictures of them wasn\u2019t a realistic scenario for me, so I tried the next best thing, which was to test it on an online dataset of Yugioh cards and artificially add challenging modifications to it. Modifications included changing brightness, contrast, and shear to simulate Yugioh cards under different lighting/photo quality scenarios in real life.", "Here is some of the (right is the modified simulated image and the right the original art):", "The AI classifier managed to achieve around 99% accuracy on all the cards in the game of Yugioh.", "This was meant to be a quick project, so I am happy with progress that was made. I may try to see if I can gather more Yugioh cards and try to improve the system.", "The dataset used for training were official card art images used from ygoprodeck (dataset A) and not real life photos of cards in the wild / pictures of cards taken by a camera (dataset B).", "The 99% accuracy results were from training and testing on dataset A while the trained model also was tested on a handful of cards on dataset B. However we don\u2019t have a lot of data for dataset B to preform actual training on it or even mass-evaluation. This repo proves that our model is capable of learning Yugioh cards through dataset A and has potential on succeeding with dataset B, which is the more realistic and natural set of images we are aiming to succeed on. Setting up a data collection infrastructure to mass-collect image samples for dataset B would greatly advance this project and help confirm the strength of the model.", "Also, this program does not have a proper object detector and just uses simple image processing methods (4 point transformation) to get the bounding box of the card and align it. Using a proper object detector like YOLO would be ideal, which would also aid in being able to detect multiple cards in the demo.", "Feel free to take a look at the Github repository here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F26fc6aed1588&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vanstorm9.medium.com/?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": ""}, {"url": "https://vanstorm9.medium.com/?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": "Anthony Lowhur"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F64fb6ae9d372&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&user=Anthony+Lowhur&userId=64fb6ae9d372&source=post_page-64fb6ae9d372----26fc6aed1588---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F26fc6aed1588&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F26fc6aed1588&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://ygorganization.com/konami-staff-develop-powerful-image-recognition-technology/", "anchor_text": "https://ygorganization.com/konami-staff-develop-powerful-image-recognition-technology/"}, {"url": "https://db.ygoprodeck.com/api-guide/", "anchor_text": "https://db.ygoprodeck.com/api-guide/"}, {"url": "https://richzhang.github.io/antialiased-cnns/", "anchor_text": "Making Convolutional Networks Shift-Invariant Again.Modern convolutional networks are not shift-invariant, as small input shifts or translations can cause drastic changes\u2026richzhang.github.io"}, {"url": "https://github.com/vanstorm9/yugioh-one-shot-learning", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----26fc6aed1588---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/one-shot-learning?source=post_page-----26fc6aed1588---------------one_shot_learning-----------------", "anchor_text": "One Shot Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----26fc6aed1588---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/siamese-networks?source=post_page-----26fc6aed1588---------------siamese_networks-----------------", "anchor_text": "Siamese Networks"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----26fc6aed1588---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F26fc6aed1588&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&user=Anthony+Lowhur&userId=64fb6ae9d372&source=-----26fc6aed1588---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F26fc6aed1588&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&user=Anthony+Lowhur&userId=64fb6ae9d372&source=-----26fc6aed1588---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F26fc6aed1588&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F26fc6aed1588&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----26fc6aed1588---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----26fc6aed1588--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----26fc6aed1588--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----26fc6aed1588--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----26fc6aed1588--------------------------------", "anchor_text": ""}, {"url": "https://vanstorm9.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vanstorm9.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anthony Lowhur"}, {"url": "https://vanstorm9.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://www.linkedin.com/in/anthony-lowhur-886264b1", "anchor_text": "https://www.linkedin.com/in/anthony-lowhur-886264b1"}, {"url": "http://vanstorm9.github.io/", "anchor_text": "http://vanstorm9.github.io/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F64fb6ae9d372&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&user=Anthony+Lowhur&userId=64fb6ae9d372&source=post_page-64fb6ae9d372--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8abb164c4f6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fi-made-an-ai-to-recognize-over-10-000-yugioh-cards-26fc6aed1588&newsletterV3=64fb6ae9d372&newsletterV3Id=8abb164c4f6b&user=Anthony+Lowhur&userId=64fb6ae9d372&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}