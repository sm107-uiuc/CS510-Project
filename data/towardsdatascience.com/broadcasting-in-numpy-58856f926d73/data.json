{"url": "https://towardsdatascience.com/broadcasting-in-numpy-58856f926d73", "time": 1683018421.7076192, "path": "towardsdatascience.com/broadcasting-in-numpy-58856f926d73/", "webpage": {"metadata": {"title": "Broadcasting in NumPy. Broadcasting is an operation of\u2026 | by Lev Maximov | Towards Data Science", "h1": "Broadcasting in NumPy", "description": "Broadcasting is an operation of matching the dimensions of differently shaped arrays in order to be able to perform further operations on those arrays (eg per-element arithmetic). A very powerful\u2026"}, "outgoing_paragraph_urls": [{"url": "http://shop.oreilly.com/product/0636920034919.do", "anchor_text": "Python Data Science Handbook", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Grayscale", "anchor_text": "grayscale", "paragraph_index": 11}, {"url": "https://numpy.org/doc/stable/user/basics.broadcasting.html", "anchor_text": "broadcast", "paragraph_index": 13}, {"url": "https://medium.com/better-programming/numpy-illustrated-the-visual-guide-to-numpy-3b1d4976de1d?source=friends_link&sk=57b908a77aa44075a49293fa1631dd9b", "anchor_text": "Numpy Illustrated", "paragraph_index": 15}, {"url": "https://pytorch.org/docs/stable/notes/broadcasting.html", "anchor_text": "PyTorch", "paragraph_index": 16}, {"url": "https://www.tensorflow.org/xla/broadcasting", "anchor_text": "TensorFlow", "paragraph_index": 16}, {"url": "https://www.kite.com/python/docs/keras.backend.ctc.sparse_ops.control_flow_ops.gen_array_ops.broadcast_to", "anchor_text": "Keras", "paragraph_index": 16}, {"url": "https://www.mathworks.com/help/parallel-computing/broadcast-variable.html", "anchor_text": "Matlab", "paragraph_index": 16}, {"url": "https://blogs.mathworks.com/loren/2016/10/24/matlab-arithmetic-expands-in-r2016b/", "anchor_text": "in 2016b", "paragraph_index": 16}], "all_paragraphs": ["Broadcasting is an operation of matching the dimensions of differently shaped arrays in order to be able to perform further operations on those arrays (eg per-element arithmetic).", "A very powerful feature, but the documentation in somewhat insufficient. Usually people learn about it from the error messages when the array sizes don\u2019t match each other.", "The simplest example of broadcasting is the multiplication of an n-dimensional array by a scalar, which evidently means per-element multiplication of its elements by the scalar value:", "Broadcasting is akin to the well known \u201ctype promotion\u201d: in most languages when adding an integer and a float, the integer is auto converted to the float type first.", "In 2D (eg dividing a matrix by a vector) the broadcasting is somewhat trickier since the result of the operation depends on the particular shapes of the operands:", "All of those shape changes (digits in gray) happen on-the-fly, without taking extra memory (aka views).", "In 3D and above the broadcasting is even less intuitive and using it requires knowledge of the broadcasting rules in their generic form. They have been formulated in slightly different ways in different sources and the exact wording has been changed in time. I find the three-step rules from the Python Data Science Handbook\u00b9 to be the most comprehensive:", "Rule 1: If the two arrays differ in their number of dimensions, the shape of the one with fewer dimensions is padded with ones on its leading (left) side.", "Rule 2: If the shape of the two arrays does not match in any dimension, the array with shape equal to 1 in that dimension is stretched to match the other shape.", "Rule 3: If in any dimension the sizes disagree and neither is equal to 1, an error is raised.", "Stretching means that the corresponding layers are replicated:", "Converting a color image to grayscale\u00b2 is a nice example of 3D broadcasting. According to the formula for the sRGB color space one can get luminance through a linear combinations of the image color channels:", "Using broadcasting this is written as simple as", "There is a specialized function np.broadcast\u00b3 which returns a generator object", "though broadcasting is rarely done explicitly (as looping would be performed in python which is slower than in C). Usually it happens \u2018behind the scene\u2019.", "But broadcasting is not limited to arithmetic operations. See more usage examples in my article \u201cNumpy Illustrated\u2074\u201d", "Broadcasting was initially introduced in the library called Numeric\u2075, the predecessor of NumPy, somewhere around 1995\u20131999, adopted by PyTorch, TensorFlow, Keras and so on. Even Matlab added it in 2016b thanks of the users who have \u201casked for this behavior over the years\u201d.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F58856f926d73&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----58856f926d73--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----58856f926d73--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://levmaximov.medium.com/?source=post_page-----58856f926d73--------------------------------", "anchor_text": ""}, {"url": "https://levmaximov.medium.com/?source=post_page-----58856f926d73--------------------------------", "anchor_text": "Lev Maximov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7f0da47ee5ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&user=Lev+Maximov&userId=7f0da47ee5ba&source=post_page-7f0da47ee5ba----58856f926d73---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58856f926d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58856f926d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://shop.oreilly.com/product/0636920034919.do", "anchor_text": "Python Data Science Handbook"}, {"url": "https://en.wikipedia.org/wiki/Grayscale", "anchor_text": "grayscale"}, {"url": "http://openastronomy.org/pyastro/logo/", "anchor_text": "openastronomy.org"}, {"url": "https://numpy.org/doc/stable/user/basics.broadcasting.html", "anchor_text": "broadcast"}, {"url": "https://medium.com/better-programming/numpy-illustrated-the-visual-guide-to-numpy-3b1d4976de1d?source=friends_link&sk=57b908a77aa44075a49293fa1631dd9b", "anchor_text": "Numpy Illustrated"}, {"url": "https://pytorch.org/docs/stable/notes/broadcasting.html", "anchor_text": "PyTorch"}, {"url": "https://www.tensorflow.org/xla/broadcasting", "anchor_text": "TensorFlow"}, {"url": "https://www.kite.com/python/docs/keras.backend.ctc.sparse_ops.control_flow_ops.gen_array_ops.broadcast_to", "anchor_text": "Keras"}, {"url": "https://www.mathworks.com/help/parallel-computing/broadcast-variable.html", "anchor_text": "Matlab"}, {"url": "https://blogs.mathworks.com/loren/2016/10/24/matlab-arithmetic-expands-in-r2016b/", "anchor_text": "in 2016b"}, {"url": "https://jakevdp.github.io/PythonDataScienceHandbook/02.05-computation-on-arrays-broadcasting.html", "anchor_text": "Computation on Arrays: Broadcasting"}, {"url": "https://en.wikipedia.org/wiki/Grayscale", "anchor_text": "Grayscale"}, {"url": "https://numpy.org/doc/stable/user/basics.broadcasting.html", "anchor_text": "Broadcasting"}, {"url": "https://medium.com/better-programming/numpy-illustrated-the-visual-guide-to-numpy-3b1d4976de1d?source=friends_link&sk=57b908a77aa44075a49293fa1631dd9b", "anchor_text": "Numpy Illustrated: The Visual Guide to NumPy"}, {"url": "http://www.cs.mcgill.ca/~hv/articles/Numerical/numpy.pdf", "anchor_text": "\u201cNumerical Python\u201d"}, {"url": "https://medium.com/tag/python?source=post_page-----58856f926d73---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/numpy?source=post_page-----58856f926d73---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/broadcasting?source=post_page-----58856f926d73---------------broadcasting-----------------", "anchor_text": "Broadcasting"}, {"url": "https://medium.com/tag/data-science?source=post_page-----58856f926d73---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----58856f926d73---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F58856f926d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&user=Lev+Maximov&userId=7f0da47ee5ba&source=-----58856f926d73---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F58856f926d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&user=Lev+Maximov&userId=7f0da47ee5ba&source=-----58856f926d73---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58856f926d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----58856f926d73--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F58856f926d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----58856f926d73---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----58856f926d73--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----58856f926d73--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----58856f926d73--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----58856f926d73--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----58856f926d73--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----58856f926d73--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----58856f926d73--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----58856f926d73--------------------------------", "anchor_text": ""}, {"url": "https://levmaximov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://levmaximov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lev Maximov"}, {"url": "https://levmaximov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7f0da47ee5ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&user=Lev+Maximov&userId=7f0da47ee5ba&source=post_page-7f0da47ee5ba--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa05f86901ea7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbroadcasting-in-numpy-58856f926d73&newsletterV3=7f0da47ee5ba&newsletterV3Id=a05f86901ea7&user=Lev+Maximov&userId=7f0da47ee5ba&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}