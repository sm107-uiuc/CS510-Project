{"url": "https://towardsdatascience.com/granger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6", "time": 1683000759.687798, "path": "towardsdatascience.com/granger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6/", "webpage": {"metadata": {"title": "Forecasting using Granger\u2019s Causality and Vector Auto-regressive Model | by Sarit Maitra | Towards Data Science", "h1": "Forecasting using Granger\u2019s Causality and Vector Auto-regressive Model", "description": "FORECASTING of Gold and Oil have garnered major attention from academics, investors and Government agencies like. These two products are known for their substantial influence on global economy. I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://stackoverflow.com/questions/58005681/is-it-possible-to-run-a-vector-autoregression-analysis-on-a-large-gdp-data-with", "anchor_text": "stackoverflow", "paragraph_index": 17}], "all_paragraphs": ["FORECASTING of Gold and Oil have garnered major attention from academics, investors and Government agencies like. These two products are known for their substantial influence on global economy. I will show here, how to use Granger\u2019s Causality Test to test the relationships of multiple variables in the time series and Vector Auto Regressive Model (VAR) to forecast the future Gold & Oil prices from the historical data of Gold prices, Silver prices, Crude Oil prices, Stock index , Interest Rate and USD rate.", "The Gold prices are closely related with other commodities. A hike in Oil prices will have positive impact on Gold prices and vice versa. Historically, we have seen that, when there is a hike in equities, Gold prices goes down.", "Let\u2019s understand how a multivariate time series is formulated. Below are the simple K-equations of multivariate time series where each equation is a lag of the other series. X is the exogenous series here. The objective is to see if the series is affected by its own past and also the past of the other series.", "This kind of series allow us to model the dynamics of the series itself and also the interdependence of other series. We will explore this inter-dependence through Granger\u2019s Causality Analysis.", "Let\u2019s load the data and do some analysis with visualization to know insights of the data. Exploratory data analysis is quite extensive in multivariate time series. I will cover some areas here to get insights of the data. However, it is advisable to conduct all statistical tests to ensure our clear understanding on data distribution.", "Let\u2019s fix the dates for all the series.", "The NaN values in the data are filled with previous days data. After doing some necessary pre-processing, the dataset now clean for further analysis.", "From the above plots, we can visible conclude that, all the series contain unit root with stochastic trend showing a systematic pattern that is unpredictable.", "To extract maximum information from our data, it is important to have a normal or Gaussian distribution of the data. To check for that, we have done a normality test based on the Null and Alternate Hypothesis intuition.", "These two distributions give us some intuition about the distribution of our data. The kurtosis of this dataset is -0.95. Since this value is less than 0, it is considered to be a light-tailed dataset. It has as much data in each tail as it does in the peak. Moderate skewness refers to the value between -1 and -0.5 or 0.5 and 1.", "Normal probability plot also shows the data is far from normally distributed.", "Auto-correlation or serial correlation can be a significant problem in analyzing historical data if we do not know how to look out for it.", "We see here from the above plots, the auto-correlation of +1 which represents a perfect positive correlation which means, an increase seen in one time series leads to a proportionate increase in the other time series. We definitely need to apply transformation and neutralize this to make the series stationary. It measures linear relationships; even if the auto-correlation is minuscule, there may still be a nonlinear relationship between a time series and a lagged version of itself.", "The VAR model will be fitted on X_train and then used to forecast the next 15 observations. These forecasts will be compared against the actual present in test data.", "Applying first differencing on training set to make all the series stationary. However, this is an iterative process where we after first differencing, the series may still be non-stationary. We shall have to apply second difference or log transformation to standardize the series in such cases.", "The formal definition of Granger causality can be explained as, whether past values of x aid in the prediction of yt, conditional on having already accounted for the effects on yt of past values of y (and perhaps of past values of other variables). If they do, the x is said to \u201cGranger cause\u201d y. So, the basis behind VAR is that each of the time series in the system influences each other.", "Granger\u2019s causality Tests the null hypothesis that the coefficients of past values in the regression equation is zero. So, if the p-value obtained from the test is lesser than the significance level of 0.05, then, you can safely reject the null hypothesis. This has been performed on original data-set.", "Below piece of code taken from stackoverflow.", "The row are the response (y) and the columns are the predictor series (x).", "So, looking at the p-Values, we can assume that, except USD, all the other variables (time series) in the system are interchangeably causing each other. This justifies the VAR modeling approach for this system of multi time-series to forecast.", "VAR requires stationarity of the series which means the mean to the series do not change over time (we can find this out from the plot drawn next to Augmented Dickey-Fuller Test).", "Let\u2019s understand the mathematical intuition of VAR model.", "Here each series is modeled by it\u2019s own lag and other series' lag. y{1,t-1, y{2,t-1}\u2026. are the lag of time series y1,y2,\u2026. respectively. The above equations are referred to as a VAR (1) model, because, each equation is of order 1, that is, it contains up to one lag of each of the predictors (y1, y2, \u2026..). Since the y terms in the equations are interrelated, the y\u2019s are considered as endogenous variables, rather than as exogenous predictors. To thwart the issue of structural instability, the VAR framework was utilized choosing the lag length according to AIC.", "So, I will fit the VAR model on training set and then used the fitted model to forecast the next 15 observations. These forecasts will be compared against the actual present in test data. I have taken the maximum lag (15) to identify the required lags for VAR model.", "The biggest correlations are 0.38 (Silver & Gold) and -0.19 (Oil & USD); however, there are small enough to ignore in this case.", "Residual plot looks normal with constant mean throughout apart from some large fluctuation during 2009, 2011, 2014 etc.", "Durbin-Watson Statistic is related to related to auto correlation.", "The Durbin-Watson statistic will always have a value between 0 and 4. A value of 2.0 means that there is no auto-correlation detected in the sample. Values from 0 to less than 2 indicate positive auto-correlation and values from 2 to 4 indicate negative auto-correlation. A rule of thumb is that test statistic values in the range of 1.5 to 2.5 are relatively normal. Any value outside this range could be a cause for concern.", "A stock price displaying positive auto-correlation would indicate that the price yesterday has a positive correlation on the price today \u2014 so if the stock fell yesterday, it is also likely that it falls today. A stock that has a negative auto-correlation, on the other hand, has a negative influence on itself over time \u2014 so that if it fell yesterday, there is a greater likelihood it will rise today.", "There is no auto-correlation (2.0) exist; so, we can proceed with the forecast.", "In order to forecast, the VAR model expects up to the lag order number of observations from the past data. This is because, the terms in the VAR model are essentially the lags of the various time series in the data-set, so we need to provide as many of the previous values as indicated by the lag order used by the model.", "The forecasts are generated but it is on the scale of the training data used by the model. So, to bring it back up to its original scale, we need to de-difference it.", "The way to convert the differencing is to add these differences consecutively to the base number. An easy way to do it is to first determine the cumulative sum at index and then add it to the base number.", "This process can be reversed by adding the observation at the prior time step to the difference value. inverted(ts) = differenced(ts) + observation(ts-1)", "To evaluate the forecasts, a comprehensive set of metrics, such as the MAPE, ME, MAE, MPE and RMSE can be computed. We have computed some of these as below.", "Mean absolute error tells us how big of an error we can expect from the forecast on average. Our error rates are quite low here indicating we have the right fit of the model.", "The VAR model is a popular tool for the purpose of predicting joint dynamics of multiple time series based on linear functions of past observations. More analysis e.g. impulse response (IRF) and forecast error variance decomposition (FEVD) can also be done along-with VAR to for assessing the impacts of shock from one asset on another to assess the impacts of shock from one asset on another. However, I will keep this simple here for easy understanding. In real-life business case, we should do multiple models with different approach to do the comparative analysis before zeroed down on one or a hybrid model.", "Notice: The programs described here are experimental and should be used with caution. All such use at your own risk.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics & Data Science Practice Lead"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3226a64889a6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3226a64889a6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3226a64889a6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----3226a64889a6--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----3226a64889a6--------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8----3226a64889a6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3226a64889a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3226a64889a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://stackoverflow.com/questions/58005681/is-it-possible-to-run-a-vector-autoregression-analysis-on-a-large-gdp-data-with", "anchor_text": "stackoverflow"}, {"url": "https://www.linkedin.com/in/saritmaitra/", "anchor_text": "here"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----3226a64889a6---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/autoregressive?source=post_page-----3226a64889a6---------------autoregressive-----------------", "anchor_text": "Autoregressive"}, {"url": "https://medium.com/tag/econometrics?source=post_page-----3226a64889a6---------------econometrics-----------------", "anchor_text": "Econometrics"}, {"url": "https://medium.com/tag/vector-auto-regression?source=post_page-----3226a64889a6---------------vector_auto_regression-----------------", "anchor_text": "Vector Auto Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3226a64889a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&user=Sarit+Maitra&userId=c611876588a8&source=-----3226a64889a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3226a64889a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&user=Sarit+Maitra&userId=c611876588a8&source=-----3226a64889a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3226a64889a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3226a64889a6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3226a64889a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3226a64889a6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3226a64889a6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3226a64889a6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3226a64889a6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3226a64889a6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3226a64889a6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3226a64889a6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3226a64889a6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3226a64889a6--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://sarit-maitra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba440ad8d04d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgranger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6&newsletterV3=c611876588a8&newsletterV3Id=ba440ad8d04d&user=Sarit+Maitra&userId=c611876588a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}