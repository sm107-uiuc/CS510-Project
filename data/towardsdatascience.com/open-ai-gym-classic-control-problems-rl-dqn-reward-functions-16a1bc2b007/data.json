{"url": "https://towardsdatascience.com/open-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007", "time": 1683001409.769248, "path": "towardsdatascience.com/open-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007/", "webpage": {"metadata": {"title": "Reinforcement Learning Custom Rewards OpenAI Gym | Towards Data Science", "h1": "Reward Engineering for Classic Control Problems on OpenAI Gym |DQN |RL", "description": "Custom rewards in Reinforcement Learning for Classic Control Problems on Open AI Gym"}, "outgoing_paragraph_urls": [{"url": "https://gym.openai.com/", "anchor_text": "OpenAI", "paragraph_index": 0}, {"url": "https://gym.openai.com/envs/#classic_control", "anchor_text": "classic control", "paragraph_index": 0}, {"url": "https://smodi93.wixsite.com/msachin/blogs", "anchor_text": "here", "paragraph_index": 8}], "all_paragraphs": ["I started learning reinforcement learning by trying to solve problems on OpenAI gym. I specifically chose classic control problems as they are a combination of mechanics and reinforcement learning. In this article, I will show how choosing an appropriate reward function leads to faster learning using deep Q networks (DQN).", "This is the simplest classic control problem on OpenAI gym. The default reward value for every time step the pole stays balanced is 1. I changed this default reward to a value proportional to the decrease in the absolute value of the pole angle, this way it gets rewarded for actions that bring the pole closer to the equilibrium position. A neural network with 2 hidden layers having 24 nodes each solves this problem within 50 episodes.", "The objective here is to get to the top of the right hill, the car will have to go to and fro to reach to the top of the right hill. For the network to figure out this strategy on its own, it needs to be provided with an appropriate reward function. Simply giving a positive reward once the car reaches the destination by trial and error in some episode and a negative reward for all other time steps will not work and it will take a pretty long time before the network learns the optimal strategy.", "To reach the peak from the valley, the car needs to gain mechanical energy so the optimal strategy would be one in which the car gains mechanical energy (Potential energy + Kinetic energy) at every time step. So a good reward function would be the increase in mechanical energy at every time step.", "With this reward function, the network learns the optimal strategy pretty fast.", "In this problem, I need to swing up a pendulum and keep it balanced in an inverted position using torque in the clockwise or counterclockwise direction. This problem is similar to the mountain car problem but this has an added difficulty of keeping the pole balanced when it reaches the inverted position.Initially, the mechanical energy of the rod needs to be increased but once it has gained enough energy to reach the inverted position, any more gain in energy will force the pendulum to keep rotating.", "The optimal strategy would be to provide torque in such a way that it keeps increasing the mechanical energy of the pendulum to a limit of mgl/2 which is equal to the potential energy of the inverted pendulum. This will ensure that the pendulum reaches the inverted position. In addition to this, to keep the pole balanced, a positive reward should be given for positions of the pendulum in the vicinity of the inverted position.", "The graph below shows the amount of time for which the pendulum stayed balanced in the inverted position out of 200-time steps for different episodes.", "Reinforcement learning is a process in which the machine learns to perform a task or achieve a target in the most optimal way. The human intuition regarding the problem at hand can be added to the neural network algorithm in the form of an engineered reward function. The default reward functions in the problems we considered were crude, rewarding the agent only on completing the task which makes it tough for the RL agent to learn. Engineered reward functions make the training process faster and more intuitive for us to understand.Read more blogs here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist by profession and a science enthusiast | Exploring life"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F16a1bc2b007&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://smodi93.medium.com/?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": ""}, {"url": "https://smodi93.medium.com/?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": "Sachin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c12ba0ce9ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&user=Sachin&userId=3c12ba0ce9ba&source=post_page-3c12ba0ce9ba----16a1bc2b007---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F16a1bc2b007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F16a1bc2b007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://gym.openai.com/", "anchor_text": "OpenAI"}, {"url": "https://gym.openai.com/envs/#classic_control", "anchor_text": "classic control"}, {"url": "https://github.com/msachin93/RL/blob/master/CartPole/cartpole.ipynb", "anchor_text": "here"}, {"url": "https://github.com/msachin93/RL/blob/master/MountainCar", "anchor_text": "here"}, {"url": "https://github.com/msachin93/RL/blob/master/Pendulum/pendulum.ipynb", "anchor_text": "here"}, {"url": "https://smodi93.wixsite.com/msachin/blogs", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----16a1bc2b007---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----16a1bc2b007---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----16a1bc2b007---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----16a1bc2b007---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----16a1bc2b007---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F16a1bc2b007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&user=Sachin&userId=3c12ba0ce9ba&source=-----16a1bc2b007---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F16a1bc2b007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&user=Sachin&userId=3c12ba0ce9ba&source=-----16a1bc2b007---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F16a1bc2b007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F16a1bc2b007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----16a1bc2b007---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----16a1bc2b007--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----16a1bc2b007--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----16a1bc2b007--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----16a1bc2b007--------------------------------", "anchor_text": ""}, {"url": "https://smodi93.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://smodi93.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sachin"}, {"url": "https://smodi93.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "92 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c12ba0ce9ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&user=Sachin&userId=3c12ba0ce9ba&source=post_page-3c12ba0ce9ba--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffed5d4632aba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fopen-ai-gym-classic-control-problems-rl-dqn-reward-functions-16a1bc2b007&newsletterV3=3c12ba0ce9ba&newsletterV3Id=fed5d4632aba&user=Sachin&userId=3c12ba0ce9ba&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}