{"url": "https://towardsdatascience.com/train-a-neural-network-to-predict-robot-dynamics-bd08fd589eca", "time": 1683008073.338788, "path": "towardsdatascience.com/train-a-neural-network-to-predict-robot-dynamics-bd08fd589eca/", "webpage": {"metadata": {"title": "Train a neural network in python to predict robot dynamics | by Nathan Lambert | Towards Data Science", "h1": "Train a neural network in python to predict robot dynamics", "description": "Train a pytorch neural network to predict data from a simulated and real flying robot. Code is included."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Universal_approximation_theorem", "anchor_text": "a fun theorem", "paragraph_index": 1}, {"url": "https://pytorch.org/docs/master/generated/torch.nn.MSELoss.html", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://arxiv.org/abs/1412.6980", "anchor_text": "Adam optimizer", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1710.05941", "anchor_text": "Swish activation function", "paragraph_index": 6}, {"url": "https://arxiv.org/abs/1710.05941", "anchor_text": "scheduler", "paragraph_index": 6}, {"url": "https://github.com/natolambert/dynamicslearn/blob/master/learn/trainer.py", "anchor_text": "the code", "paragraph_index": 7}, {"url": "https://arxiv.org/abs/1901.03737", "anchor_text": "Crazyflie", "paragraph_index": 9}, {"url": "https://people.eecs.berkeley.edu/~ddrew73/files/RAL18.pdf", "anchor_text": "Ionocraft", "paragraph_index": 9}, {"url": "https://github.com/natolambert/dynamicslearn/blob/master/learn/envs/rigidbody.py", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://pytorch.org/tutorials/beginner/blitz/neural_networks_tutorial.html", "anchor_text": "detailed in many tutorials", "paragraph_index": 13}, {"url": "https://github.com/natolambert/dynamicslearn/blob/master/learn/models/model_general_nn.py", "anchor_text": "is here", "paragraph_index": 14}, {"url": "https://github.com/natolambert/dynamicslearn/blob/master/learn/trainer.py", "anchor_text": "is here", "paragraph_index": 14}, {"url": "https://github.com/natolambert/dynamicslearn", "anchor_text": "is here", "paragraph_index": 14}, {"url": "https://drive.google.com/file/d/1zINn9Uj9vGita_NIPqpWS1cSH79twNJB/view?usp=sharing", "anchor_text": "here", "paragraph_index": 15}, {"url": "http://robotic.substack.com", "anchor_text": "robotic.substack.com", "paragraph_index": 17}, {"url": "http://natolambert.com", "anchor_text": "natolambert.com", "paragraph_index": 17}], "all_paragraphs": ["My life as a robotics learning researcher is mostly data science (understanding data) and a bit of fun math (reinforcement learning). Here\u2019s a snippet you can run for yourself and take lessons away into your projects (and career)!", "Neural networks have become state-of-the-art in multiple digital domains, particularly computer vision and language processing. The neural networks are complex function approximations (capable of fitting any function sufficiently accurately, from a fun theorem), so why not use them for robotics?", "In robots, we want to model the dynamics for two things:", "When learning with a neural network will predict a discrete step in the dynamics of the system. Dynamic systems take the form shown below:", "What we will model with the neural network (intentionally) is the underlying function, f, and we implicitly capture the disturbance, w, in the data. How do we do this? For data \u201cniceness\u201d we do a couple of things. Niceness means that the data is close to uniformly distributed with a mean of 0 and a standard deviation of 1.", "What does this look like in the context of a neural network? Specifically, we can minimize the norm squared of the difference between the change in state and the function approximator. This is a mean squared error. It\u2019s implemented in PyTorch here.", "State of the art is using things like the Adam optimizer, Swish activation function (smooth version of ReLU), a learning rate scheduler, and more. The important way to get NN\u2019s to work is data normalization. If you look closely at the code, I handle it in a very modular way. Without it, fitting models to real data would be near impossible.", "This is how you will run the code. I include a conda environment called ml (PyTorch, AI Gym, Mujoco, and more). The trainer code will be found in the learn directory. Parameters are stored in a configuration file.", "There are pre-filtered data in the repository from real flights of experimental robots learning control with reinforcement learning. It is an active research repository at University of California, Berkeley.", "The code includes simulators for two flying robots, the Crazyflie and the Ionocraft. Both of these allow you to control the robots at 100 Hz, and the simulator calculates dynamics at 1000Hz. You can find the dynamic simulator here. The specific robot defines the force transforms for different actuators.", "When working with a complex task (figuring out how to model a robot), it helps to have a configurable network object. You\u2019ll see a series of flags here:", "Notice that I use X for states and U for actions.", "This may be the most useful part of the article for someone new to PyTorch. It lets you create a network of various depths and widths (the alternate is hard coding the configurations).", "Omitting the optimizer code that is publicly available, and detailed in many tutorials, we can have a nice training function as our top-level object. Let lower levels of abstraction handle the details.", "The neural network code is here. The training script is here. The overall code is here.", "There is a lot more to play with this repository. I happily will take questions, pull-requests, and feedback. Or you can learn about my research here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Trying to think freely and create equitable & impactful automation @ UCBerkeley EECS. Subscribe directly at robotic.substack.com. More at natolambert.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbd08fd589eca&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://natolambert.medium.com/?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": ""}, {"url": "https://natolambert.medium.com/?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": "Nathan Lambert"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F890b1765e6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&user=Nathan+Lambert&userId=890b1765e6d&source=post_page-890b1765e6d----bd08fd589eca---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd08fd589eca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd08fd589eca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Universal_approximation_theorem", "anchor_text": "a fun theorem"}, {"url": "https://pytorch.org/docs/master/generated/torch.nn.MSELoss.html", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1412.6980", "anchor_text": "Adam optimizer"}, {"url": "https://arxiv.org/abs/1710.05941", "anchor_text": "Swish activation function"}, {"url": "https://arxiv.org/abs/1710.05941", "anchor_text": "scheduler"}, {"url": "https://arxiv.org/abs/1901.03737", "anchor_text": "Crazyflie"}, {"url": "https://people.eecs.berkeley.edu/~ddrew73/files/RAL18.pdf", "anchor_text": "Ionocraft"}, {"url": "https://github.com/natolambert/dynamicslearn/blob/master/learn/trainer.py", "anchor_text": "the code"}, {"url": "https://arxiv.org/abs/1901.03737", "anchor_text": "Crazyflie"}, {"url": "https://people.eecs.berkeley.edu/~ddrew73/files/RAL18.pdf", "anchor_text": "Ionocraft"}, {"url": "https://github.com/natolambert/dynamicslearn/blob/master/learn/envs/rigidbody.py", "anchor_text": "here"}, {"url": "http://papers.nips.cc/paper/7725-deep-reinforcement-learning-in-a-handful-of-trials-using-probabilistic-dynamics-models.pdf", "anchor_text": "this paper"}, {"url": "https://pytorch.org/tutorials/beginner/blitz/neural_networks_tutorial.html", "anchor_text": "detailed in many tutorials"}, {"url": "https://github.com/natolambert/dynamicslearn/blob/master/learn/models/model_general_nn.py", "anchor_text": "is here"}, {"url": "https://github.com/natolambert/dynamicslearn/blob/master/learn/trainer.py", "anchor_text": "is here"}, {"url": "https://github.com/natolambert/dynamicslearn", "anchor_text": "is here"}, {"url": "https://drive.google.com/file/d/1zINn9Uj9vGita_NIPqpWS1cSH79twNJB/view?usp=sharing", "anchor_text": "here"}, {"url": "https://github.com/natolambert/dynamicslearn", "anchor_text": "natolambert/dynamicslearnWorking directory for my work on model-based reinforcement learning for novel robots. Best for robots with high test\u2026github.com"}, {"url": "https://robotic.substack.com/", "anchor_text": "Democratizing AutomationA blog about robots & artificial intelligence, making them beneficial for everyone, and the coming automation wave\u2026robotic.substack.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----bd08fd589eca---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/robotics?source=post_page-----bd08fd589eca---------------robotics-----------------", "anchor_text": "Robotics"}, {"url": "https://medium.com/tag/programming?source=post_page-----bd08fd589eca---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----bd08fd589eca---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/technology?source=post_page-----bd08fd589eca---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbd08fd589eca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&user=Nathan+Lambert&userId=890b1765e6d&source=-----bd08fd589eca---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbd08fd589eca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&user=Nathan+Lambert&userId=890b1765e6d&source=-----bd08fd589eca---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbd08fd589eca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbd08fd589eca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bd08fd589eca---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bd08fd589eca--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bd08fd589eca--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bd08fd589eca--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bd08fd589eca--------------------------------", "anchor_text": ""}, {"url": "https://natolambert.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://natolambert.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nathan Lambert"}, {"url": "https://natolambert.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "653 Followers"}, {"url": "http://robotic.substack.com", "anchor_text": "robotic.substack.com"}, {"url": "http://natolambert.com", "anchor_text": "natolambert.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F890b1765e6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&user=Nathan+Lambert&userId=890b1765e6d&source=post_page-890b1765e6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F15278b7ad062&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftrain-a-neural-network-to-predict-robot-dynamics-bd08fd589eca&newsletterV3=890b1765e6d&newsletterV3Id=15278b7ad062&user=Nathan+Lambert&userId=890b1765e6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}