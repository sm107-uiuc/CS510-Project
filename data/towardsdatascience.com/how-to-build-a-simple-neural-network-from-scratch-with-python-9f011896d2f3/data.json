{"url": "https://towardsdatascience.com/how-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3", "time": 1682995432.464694, "path": "towardsdatascience.com/how-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3/", "webpage": {"metadata": {"title": "How to build a simple Neural Network from scratch with Python | by Konstantinos Kitsios | Towards Data Science", "h1": "How to build a simple Neural Network from scratch with Python", "description": "Neural Networks are becoming more and more popular every day and as a core field of Machine Learning and Artificial Intelligence, they are going to play a major role in technology, science and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.coursera.org/learn/machine-learning", "anchor_text": "course", "paragraph_index": 9}, {"url": "https://gitlab.com/kitsiosk/xor-neural-net", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://gitlab.com/kitsiosk/xor-neural-net", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://www.linkedin.com/in/konstantinoskitsios/", "anchor_text": "LinkedIn", "paragraph_index": 28}, {"url": "http://kitsios.eu/", "anchor_text": "webpage", "paragraph_index": 28}], "all_paragraphs": ["Neural Networks are becoming more and more popular every day and as a core field of Machine Learning and Artificial Intelligence, they are going to play a major role in technology, science and industry over the next years. This high popularity has given rise to many frameworks that allow you to implement Neural Networks very easily without knowing the complete theory behind them. On the other side, the strict theoretical explanation of neural network mechanisms demands some knowledge on high-level mathematics.", "In this post, we will do something between. Specifically, in order to get a more solid understanding of neural networks, we will go through the actual implementation of a NN from scratch without using any framework, but we will omit the proofs for the sake of simplicity. This may be a bit more difficult than using a framework but you will gain a much better understanding of the mechanism behind the algorithm. Of course, in large scale projects a framework implementation is preferred as it is easier and faster to set up.", "The tools used in this tutorial are just Python with numpy library (Scientific library for Linear Algebra operations). Supposing that you have python and pip installed, you can install numpy by running this command:", "A Neural Network is actually a function of many variables: It takes an input, makes computations and produces an output. We like to visualize it as neurons in different layers, with each neuron in a layer connected with all neurons in the previous and the next layer. All the computations take place inside those neurons and depend on the weights that connect the neurons with each other. So all we have to do is learn the right weights in order to get the desired output.", "Their structure is generally very complex including a lot of layers and even more than a million (Dec 2020 Update: GPT-3 now uses 175B parameters! ) neurons in order to be able to handle the large datasets of our era. However, in order to understand how large deep neural networks work one should start with the simplest ones.", "Consequently, below we will implement a very simple network with 2 layers. In order to do that we need a very simple dataset as well, so we will use the XOR dataset in our example, as shown below. A and B are the 2 inputs of the NN and A XOR B is the output. We will try to make our NN learn weights such that whatever pair of A and B it takes as input, it will return the corresponding result.", "First, we need to define the structure of our Neural Network. Because our dataset is relatively simple, a network with just a hidden layer will do fine. So we will have an input layer, a hidden layer and an output layer. Next, we need an activation function. The sigmoid function is a good choice for the last layer because it outputs values between 0 and 1 while tanh (hyperbolic tangent) works better in the hidden layer, but every other commonly used function will work(e.g. ReLU). So the structure of our Neural Network will look like this:", "Here, the parameters to be learned are the weights W1, W2 and the biases b1, b2. As you can see W1 and b1 connect the input layer with the hidden layer while W2, b2 connect the hidden layer with the output layer. From the basic theory we know that the activations A1 and A2 are calculated as follows:", "where g and h are the two activation functions we chose (for us sigmoid and tanh) and W1, W1, b1, b2 are generally Matrices.", "Now let\u2019s jump into the actual code. The code style follows the guidelines proposed by prof. Andrew Ng at this course in general.", "Note: You can find the fully working code in my repository here", "First we will implement our sigmoid activation function defined as follows: g(z) = 1/(1+e^(-z)) where z will be a matrix in general. Luckily numpy supports calculations with matrices so the code is relatively simple:", "Next, we have to initialize our parameters. Weight matrices W1 and W2 will be randomly initialized from a normal distribution while biases b1 and b2 will be initialized to zero. The function initialize_parameters(n_x, n_h, n_y) takes as input the number of units in each of the 3 layers and initializes the parameters properly:", "The next step is to implement the Forward Propagation. The function forward_prop(X, parameters) takes as input the neural network input matrix X and the parameters dictionary and returns the output of the NN A2 with a cache dictionary that will be used later in backpropagation.", "We now have to compute the loss function. We will use the Cross-Entropy Loss function. Calculate_cost(A2, Y) takes as input the result of the NN A2 and the ground truth matrix Y and returns the cross-entropy cost:", "Now the most difficult part of the Neural Network algorithm, Back Propagation. The code here may seem a bit weird and difficult to understand but we will not dive into details of why it works here. This function will return the gradients of the Loss function with respect to the 4 parameters of our network(W1, W2, b1, b2):", "Nice, now we have all the gradients of the Loss function, so we can proceed to the actual learning! We will use Gradient Descent algorithm to update our parameters and make our model learn with the learning rate passed as a parameter:", "By now we have implemented all the functions needed for one circle of training. Now, all we have to do is just put them all together inside a function called model() and call model() from the main program.", "Model() function takes as input the features matrix X, the labels matrix Y, the number of units n_x, n_h, n_y, the number of iterations we want our Gradient Descent algorithm to run and the learning rate of Gradient Descent and combines all the functions above to return the trained parameters of our model:", "The training part is now over. The function above will return the trained parameters of our NN. Now we just have to make our prediction. The function predict(X, parameters) takes as input the matrix X with elements the 2 numbers for which we want to compute the XOR function and the trained parameters of the model and returns the desired result y_predict by using a threshold of 0.5:", "We are done with all the functions needed finally. Now let\u2019s go to the main program and declare our matrices X, Y and the hyperparameters n_x, n_h, n_y, num_of_iters, learning_rate:", "Having all the above set up, training the model on them is as easy as calling this line of code:", "Finally, let\u2019s make our prediction for a random pair of numbers, let\u2019s say (1,1):", "That was the actual code! Let\u2019s see our results. If we run our file, let\u2019s say xor_nn.py, with this command", "we get the following result, which is indeed correct because 1XOR1=0.", "That\u2019s it! We have trained a Neural Network from scratch using just Python.", "Of course, in order to train larger networks with many layers and hidden units you may need to use some variations of the algorithms above, for example, you may need to use Batch Gradient Descent instead of Gradient Descent or use many more layers but the main idea of a simple NN is as described above.", "Feel free to play with the hyperparameters yourself and try different architectures of the Neural Network. For example, you can try a smaller number of iterations because the Cost seems to be going down quickly and 1000 of them may be a bit large. Remember that you can find the fully working code in my GitLab repository here.", "Thanks for reading and I will be glad to discuss any questions or corrections you may have :) Find me on LinkedIn or my webpage if you want to talk about Machine Learning or anything else.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Enthusiast/ Electrical & Computer Engineering Undergraduate Student"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9f011896d2f3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@konstantinoskitsios?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konstantinoskitsios?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": "Konstantinos Kitsios"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5b3f5dcabb78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&user=Konstantinos+Kitsios&userId=5b3f5dcabb78&source=post_page-5b3f5dcabb78----9f011896d2f3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f011896d2f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f011896d2f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@franckinjapan?utm_source=medium&utm_medium=referral", "anchor_text": "Franck V."}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.coursera.org/learn/machine-learning", "anchor_text": "course"}, {"url": "https://gitlab.com/kitsiosk/xor-neural-net", "anchor_text": "here"}, {"url": "https://gitlab.com/kitsiosk/xor-neural-net", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/konstantinoskitsios/", "anchor_text": "LinkedIn"}, {"url": "http://kitsios.eu/", "anchor_text": "webpage"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9f011896d2f3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----9f011896d2f3---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/xor?source=post_page-----9f011896d2f3---------------xor-----------------", "anchor_text": "Xor"}, {"url": "https://medium.com/tag/simple-neural-network?source=post_page-----9f011896d2f3---------------simple_neural_network-----------------", "anchor_text": "Simple Neural Network"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9f011896d2f3---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9f011896d2f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&user=Konstantinos+Kitsios&userId=5b3f5dcabb78&source=-----9f011896d2f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9f011896d2f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&user=Konstantinos+Kitsios&userId=5b3f5dcabb78&source=-----9f011896d2f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9f011896d2f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9f011896d2f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9f011896d2f3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9f011896d2f3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9f011896d2f3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9f011896d2f3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9f011896d2f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konstantinoskitsios?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konstantinoskitsios?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Konstantinos Kitsios"}, {"url": "https://medium.com/@konstantinoskitsios/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "45 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5b3f5dcabb78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&user=Konstantinos+Kitsios&userId=5b3f5dcabb78&source=post_page-5b3f5dcabb78--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F5b3f5dcabb78%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-simple-neural-network-from-scratch-with-python-9f011896d2f3&user=Konstantinos+Kitsios&userId=5b3f5dcabb78&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}