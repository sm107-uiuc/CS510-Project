{"url": "https://towardsdatascience.com/extracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2", "time": 1683002999.666071, "path": "towardsdatascience.com/extracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2/", "webpage": {"metadata": {"title": "Extracting the author of news stories with DOM-based segmentation and BERT | by Cesc Canet | Towards Data Science", "h1": "Extracting the author of news stories with DOM-based segmentation and BERT", "description": "Obtaining the author of large volumes of news stories is daunting. Web pages come in different formats, and a perfect solution should identify in all cases, when available, the full name of the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/snapcrack/all-the-news", "anchor_text": "All the News", "paragraph_index": 3}, {"url": "https://archive.org/", "anchor_text": "Archive.org", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1801.02607.pdf", "anchor_text": "Web2Text: Deep Structured Boilerplate Removal", "paragraph_index": 6}, {"url": "https://github.com/dalab/web2text", "anchor_text": "Github repo", "paragraph_index": 6}, {"url": "https://huggingface.co/bert-large-cased-finetuned-conll03-english", "anchor_text": "link to the model", "paragraph_index": 24}, {"url": "https://en.wikipedia.org/wiki/Inside%E2%80%93outside%E2%80%93beginning_(tagging)", "anchor_text": "IOB format", "paragraph_index": 24}, {"url": "https://arxiv.org/abs/1801.02607", "anchor_text": "Web2text: Deep structured boilerplate removal", "paragraph_index": 26}, {"url": "https://pdfs.semanticscholar.org/a355/13ebc494326f7ba0141b718b08cbb3a7dff7.pdf", "anchor_text": "Web Content Extraction Through Machine Learning", "paragraph_index": 27}, {"url": "http://cs229.stanford.edu/proj2013/YaoZuo-AMachineLearningApproachToWebpageContentExtraction.pdf", "anchor_text": "A machine learning approach to webpage content extraction", "paragraph_index": 28}, {"url": "http://hypefactors.com", "anchor_text": "Hypefactors", "paragraph_index": 29}], "all_paragraphs": ["Obtaining the author of large volumes of news stories is daunting. Web pages come in different formats, and a perfect solution should identify in all cases, when available, the full name of the author(s). The author\u2019s name can sometimes be right below the title, but other times it is found under the article or almost hidden in a different column altogether. The author\u2019s name may come in any language and may or may not have a particle in it, such as the English preposition by. In some instances, there is more than one author, and names are comma- or and- separated.", "A heuristics-based parser, i.e., using regular expressions and bash scripts with conditionals, would work well in many cases. Still, a good solution should generalize to unseen formats. For example, some articles have lists of given names in the document (linking to other articles or other elements on the website), which could create ambiguity.", "Classifiers are known\u00b9 \u00b2 to work well for content-extraction tasks because they can look at multiple contextual and layout features.", "I used Andrew Thompson\u2019s All the News dataset (in which there are 73,000 articles from 15 American publications with a URL and an author). The news articles span for the 2015\u20132017 period. Archive.org stores about 27,000 of the news articles in their original format, and the other ones are in their original news websites. Scraping all the links took about three days (4.1 GB compressed data).", "Since newspapers change their website structure every once in a while, there is an unknown (but arguably small) number of different cases covered by the corpus. It should be reasonably easy to collect and manually label more training examples of other news outlets to cover more cases.", "The pipeline contains three steps: a Preprocessor, a Classifier, and Named-Entity recognition", "I used the preprocessor from the paper Web2Text: Deep Structured Boilerplate Removal\u00b3 (Github repo).", "Web2Text can build a DOM tree for compliant and uncompliant HTML alike. It has logic to clean up DOM nodes known to contain non-informative data, traverse the DOM tree downwards and collapse single-child nodes with their respective children.", "The training examples of the model are the DOM nodes of the HTML files. Each HTML file has an average of 138 DOM nodes. So, in total the dataset contains m = 73K * 138 = 101M training examples. On average, the code takes 127 ms to convert each of the HTML files into a CSV feature representation file where each row represents a feature, and each column is a DOM node (running on a 1.7GHz Dual-Core i7 with 8GB DDR3 memory).", "The main class ExtractPageFeatures takes as an input a raw HTML file and produces a CSV file with features for the Boilerplate Removal task. I modified this code and created new features that better suit the author extraction task in hand. After compiling the Scala project, you can run on any HTML file:", "Let\u2019s take a simple example of one of the texts in our dataset:", "The algorithm reaches the token Politics (8 characters) through the route header -> div -> div -> h2 / a. Notice how <h2> and <a> are collapsed into one single leaf.", "For each Collapsed DOM (CDOM) node, Web2Text constructs a vector of features:", "Web2Text comes with a set of 128 predefined features:", "Features exist at the following levels:", "The preprocessor calculates ancestor-level features (parent, grandparent, or root) with the SUM over the descendants\u2019 features (on integers) or with an OR (on booleans). For instance, if there are two sibling nodes, one with an email address and the other one without, the preprocessor would mark the common parent node as containing an email.", "Having features capturing data at an ancestor level comes handy in the author extraction task because, in many news sites, author names are surrounded by small boxes together with the date of the publication and sometimes the social media profile of the author. That information can help the classifier learn to identify which blocks contain the author.", "The Author Extraction task extends Web2Text with some additional features (for performance reasons, the checks run only if 2<=nWords<=5):", "I was excited to learn that I could use some of Web2Text\u2019s standard features to capture relevant information for my task:", "Some features which would be very interesting to extend the model would be:", "Web2Text\u2019s architecture uses Convolutional Neural Networks followed by a Hidden Markov model to calculate unary and pairwise potentials on blocks and pairs of adjacent blocks, respectively. In our case, however, we want to find at most one block per page containing the author\u2019s name, so I framed the problem as a binary classifier with two classes: {contains_author, not_contains_author}, and picked the block minimizing binary cross-entropy loss. The actual model is a simple Neural Network (1 hidden layer; 140 hidden units)", "The weights of the trained model are stored in our repository, at /public/trained_model_all_the_news/.", "The model performs two steps during inference time:", "1.- Run the trained neural network on the HTML document to choose the DOM block with the minimum cost.", "2.- Run a BERT Named-Entity Recognizer to extract all person names from the block. This model uses HuggingFace Transformer\u2019s implementation of BERT (Large, Cased)\u2074 (link to the model ), and will label each token in a sentence as belonging to four types: Person, MISC, Organization, and Location, using the standard IOB format. For the Author Extraction task, only Person names (PER tags) are relevant. The model is fine-tuned using the CoNLL-2003\u2075 dataset, a standard dataset for Named-Entity Recognition.", "You can finally run the following command to predict the author name of a news article:", "[1] T. Vogels, O.E. Ganea, and C. Eickhoff. \u201cWeb2text: Deep structured boilerplate removal\u201d (2018) European Conference on Information Retrieval. Springer, Cham.", "[2] Z. Zhou, and M. Mashuq. \u201cWeb Content Extraction Through Machine Learning\u201d (2014) Stanford University.", "[3] J. Yao and X. Zuo. \u201cA machine learning approach to webpage content extraction\u201d (2013) Stanford University.", "Many thanks to Hypefactors for providing the idea for this post. Hypefactors is a platform for media professionals, and a component in their pipeline is to identify the author of millions of news articles each day. This post is motivated by a real business need they have, although the implementation may be different.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning, Data Science and Natural Language Processing practitioner. Previously at Truecaller, Ericsson, and University of Edinburgh"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F69225ea0e5c2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cesccanet?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cesccanet?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": "Cesc Canet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4ca0ebce1fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&user=Cesc+Canet&userId=b4ca0ebce1fa&source=post_page-b4ca0ebce1fa----69225ea0e5c2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69225ea0e5c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69225ea0e5c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/snapcrack/all-the-news", "anchor_text": "All the News"}, {"url": "https://archive.org/", "anchor_text": "Archive.org"}, {"url": "https://arxiv.org/pdf/1801.02607.pdf", "anchor_text": "Web2Text: Deep Structured Boilerplate Removal"}, {"url": "https://github.com/dalab/web2text", "anchor_text": "Github repo"}, {"url": "https://github.com/hadley/data-baby-names", "anchor_text": "dataset"}, {"url": "https://huggingface.co/bert-large-cased-finetuned-conll03-english", "anchor_text": "link to the model"}, {"url": "https://en.wikipedia.org/wiki/Inside%E2%80%93outside%E2%80%93beginning_(tagging)", "anchor_text": "IOB format"}, {"url": "https://www.theguardian.com/us-news/2016/jul/13/alton-sterling-son-cameron-protesters-baton-rouge", "anchor_text": "https://www.theguardian.com/us-news/2016/jul/13/alton-sterling-son-cameron-protesters-baton-rouge"}, {"url": "https://github.com/canetcesc/AuthorExtractor", "anchor_text": "https://github.com/canetcesc/AuthorExtractor"}, {"url": "https://arxiv.org/abs/1801.02607", "anchor_text": "Web2text: Deep structured boilerplate removal"}, {"url": "https://pdfs.semanticscholar.org/a355/13ebc494326f7ba0141b718b08cbb3a7dff7.pdf", "anchor_text": "Web Content Extraction Through Machine Learning"}, {"url": "http://cs229.stanford.edu/proj2013/YaoZuo-AMachineLearningApproachToWebpageContentExtraction.pdf", "anchor_text": "A machine learning approach to webpage content extraction"}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "Bert: Pre-training of deep bidirectional transformers for language understanding"}, {"url": "https://arxiv.org/abs/cs/0306050", "anchor_text": "Introduction to the CoNLL-2003 shared task: Language-independent named entity recognition"}, {"url": "http://hypefactors.com", "anchor_text": "Hypefactors"}, {"url": "http://www.freepik.com", "anchor_text": "studiogstock"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----69225ea0e5c2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/bert?source=post_page-----69225ea0e5c2---------------bert-----------------", "anchor_text": "Bert"}, {"url": "https://medium.com/tag/nlp?source=post_page-----69225ea0e5c2---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/data-science?source=post_page-----69225ea0e5c2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----69225ea0e5c2---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F69225ea0e5c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&user=Cesc+Canet&userId=b4ca0ebce1fa&source=-----69225ea0e5c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F69225ea0e5c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&user=Cesc+Canet&userId=b4ca0ebce1fa&source=-----69225ea0e5c2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69225ea0e5c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F69225ea0e5c2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----69225ea0e5c2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----69225ea0e5c2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cesccanet?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cesccanet?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cesc Canet"}, {"url": "https://medium.com/@cesccanet/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "28 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4ca0ebce1fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&user=Cesc+Canet&userId=b4ca0ebce1fa&source=post_page-b4ca0ebce1fa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F58ba4d0fa53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextracting-the-author-of-news-stories-with-dom-based-segmentation-and-bert-69225ea0e5c2&newsletterV3=b4ca0ebce1fa&newsletterV3Id=58ba4d0fa53&user=Cesc+Canet&userId=b4ca0ebce1fa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}