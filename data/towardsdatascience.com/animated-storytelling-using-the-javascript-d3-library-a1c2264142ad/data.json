{"url": "https://towardsdatascience.com/animated-storytelling-using-the-javascript-d3-library-a1c2264142ad", "time": 1683001995.423481, "path": "towardsdatascience.com/animated-storytelling-using-the-javascript-d3-library-a1c2264142ad/", "webpage": {"metadata": {"title": "Animated storytelling using the Javascript D3 library | by Keith McNulty | Towards Data Science", "h1": "Animated storytelling using the Javascript D3 library", "description": "On the day I publish this article, the UK goes to the polls in its first December general election since 1923. Representative government is very interesting, and the data on votes cast can often tell\u2026"}, "outgoing_paragraph_urls": [{"url": "https://flowingdata.com/2015/12/15/a-day-in-the-life-of-americans/", "anchor_text": "original viz", "paragraph_index": 1}, {"url": "http://ustimeuse.github.io/oneday.html", "anchor_text": "these guys", "paragraph_index": 1}, {"url": "https://github.com/keithmcnulty/uk_election_bubble", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://keithmcnulty.github.io/uk_election_bubble/", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/data/elec_results.csv", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/transform_data.R", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/data/elec_results.tsv", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/js/election_bubble.js", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/js/election_bubble.js", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://www.linkedin.com/in/keith-mcnulty/", "anchor_text": "LinkedIn", "paragraph_index": 29}, {"url": "https://twitter.com/dr_keithmcnulty", "anchor_text": "Twitter", "paragraph_index": 29}, {"url": "http://keithmcnulty.org", "anchor_text": "keithmcnulty.org", "paragraph_index": 31}], "all_paragraphs": ["On the day I publish this article, the UK goes to the polls in its first December general election since 1923. Representative government is very interesting, and the data on votes cast can often tell a different story from what eventuates in terms of seats in the House of Commons and which party \u2014 or coalition of parties \u2014 forms a government.", "Inspired by Nathan Yau\u2019s original viz and by a fantastic project by these guys \u2014 for which I liberally stole and adjusted code \u2014 I set about creating a story of all UK general elections since 1918 (which is considered the first modern era election). I had in mind a fairly simple layout where I would have a force directed bubble chart of 1000 eligible voters of the left, where voters would \u2018move around\u2019 from election to election, showing how the popular vote distributed. On the right, I would have a simple narrative with a photo of the elected Prime Minister and a short narrative about what happened. Here\u2019s my initial sketch of what I wanted to do.", "If you can\u2019t be bothered reading the \u2018how\u2019, my full code is here and the visualization is hosted here.", "For this project I\u2019m going to need:", "From the UK Parliament library, I was able to get the data on the percent of the vote which went to the various political parties and I was able to combine this with turnout statistics so that I could include those who did not vote in my chart. So my starting csv file is here.", "I needed to reimagine how this would look if it were 1000 voters, each represented by a small bubble on a bubble chart. So what I needed to do was to convert these statistics in a dataframe with 1000 rows and 27 columns, with each row being a voter and each column being an election date. Then I coded each vote 0, 1, 2, 3, 4, 5 according to the five party groups and the \u2018did not vote\u2019 group. In each cell of my dataframe is the code of the party that person voted for in that election.", "Then I needed to add some time series to the data, as it will be used to illustrate people\u2019s movements through time. Making use of the approach used by the work that inspired this, I decided to imagine the 27 elections as a single day in minutes, and to split the time equally over 1440 minutes, so that the end visualization would display each election result for the same amount of time before moving onto the next one.", "Finally, I needed to output each person\u2019s data as a comma-separated string where the odd elements represented a political party code and the even elements represented time, as this will be the format that will feed into the web code.", "I did this transformation in R and wrote the output as a tsv file which I will later feed into my web code. The R code I used is here and the final tsv output is here.", "We need to have D3 v3.5.5 available in our js folder. I took the Javascript code used in the American Time Use viz and adjusted it for my purposes here, making a file called election_bubbles.js. First I set a starting speed and chart dimensions, created a list to use later and set the clock at zero:", "Next, I defined each activity code as being a political party:", "I also set my speed options in milliseconds for use later:", "Now I used a list calledtime_notes to hold all the display information I need for the visualization. For each election I created key-value pairs as follows:", "This is a fairly long list so I won\u2019t display it here \u2014 you can see it in the linked source code. Also, I will set a variable notes_index = 0 to indicate in later code that I want to start at the first element of the list \u2014 the 1918 election.", "Next, I want to set the position for \u201cDid not vote\u201d at the center of the viz, and then equally space the five political party groupings in a circle around the center. I want the first party on the list to take the top-right position in the circle and will use my indices to ensure that:", "Now I am going to start the initial svg \u2014 I plan to position it absolutely within its parent when I finally put it in HTML:", "Now I am going to edit the main viz function to move through the force directed networks for each election. All of the code in this section will be wrapped in a function which will run on our tsv file of 1000 voters, like this:", "First, we pull from the tsv to create a list of key-value pairs of voting activity and duration and these will populate out sched_objs list:", "Next, we just steal the code to populate the 1000 nodes of each election and write them onto our initial svg along with the labels. I won\u2019t copy it all here but you can find it at lines 99\u2013175 here.", "Now we use the timer() function to run the switches in data as our virtual clock ticks in the background. You\u2019ll find the full timer() function in lines 179\u2013294 here, but within this function, I want to highlight a few things unique to this visualization.", "First, we scroll through the dates in the title of the chart by using D3\u2019s transition() function to make text appear rapidly by fading it in from the background color (this is the first time that you\u2019ll see certain style elements appearing like background color and font):", "Similarly, we can fade images in and out by transitioning their opacity:", "And we can also scroll the notes up and down:", "You\u2019ll see a number of other code segments like this that handle the appearance and disappearance of text and images according to the timing of the movements in the force-directed bubble chart. Also, there\u2019s a function to set the colors of the nodes according to the official colors of the political parties in the UK.", "Our Javascript now gives us several animated objects to slot into our webpage.", "Some simple html alongside some css styling to be found in the css folder will achieve this \u2014 here is the general setup which worked for me:", "I inserted this in electionvis.html, which also calls in some bootstrap styling and my JS scripts. This was then inserted as an iframe into the main index.html to allow for controlling of the overall height and width of the viz if I needed.", "Here is what the finished product looks like:", "Working in Javascript takes some learning, but D3 is an incredibly flexible tool for building data-driven storytelling, and totally worth the effort in my opinion. Plus there is a lot of pre-built code out there ready for you to repurpose for your own aims, just like I did here.", "Originally I was a Pure Mathematician, then I became a Psychometrician and a Data Scientist. I am passionate about applying the rigor of all those disciplines to complex people questions. I\u2019m also a coding geek and a massive fan of Japanese RPGs. Find me on LinkedIn or on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Expert and Author in Applied Mathematics, Data Science, Statistics. Also writes History, Science, Culture. Find me on Twitter or keithmcnulty.org"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa1c2264142ad&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://keith-mcnulty.medium.com/?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": "Keith McNulty"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa859aab532a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&user=Keith+McNulty&userId=a859aab532a0&source=post_page-a859aab532a0----a1c2264142ad---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1c2264142ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1c2264142ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://flowingdata.com/2015/12/15/a-day-in-the-life-of-americans/", "anchor_text": "original viz"}, {"url": "http://ustimeuse.github.io/oneday.html", "anchor_text": "these guys"}, {"url": "https://github.com/keithmcnulty/uk_election_bubble", "anchor_text": "here"}, {"url": "https://keithmcnulty.github.io/uk_election_bubble/", "anchor_text": "here"}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/data/elec_results.csv", "anchor_text": "here"}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/transform_data.R", "anchor_text": "here"}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/data/elec_results.tsv", "anchor_text": "here"}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/js/election_bubble.js", "anchor_text": "here"}, {"url": "https://github.com/keithmcnulty/uk_election_bubble/blob/master/js/election_bubble.js", "anchor_text": "here"}, {"url": "https://keithmcnulty.github.io/uk_election_bubble/", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/keith-mcnulty/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/dr_keithmcnulty", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/web-development?source=post_page-----a1c2264142ad---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a1c2264142ad---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----a1c2264142ad---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/politics?source=post_page-----a1c2264142ad---------------politics-----------------", "anchor_text": "Politics"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----a1c2264142ad---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa1c2264142ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&user=Keith+McNulty&userId=a859aab532a0&source=-----a1c2264142ad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa1c2264142ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&user=Keith+McNulty&userId=a859aab532a0&source=-----a1c2264142ad---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa1c2264142ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa1c2264142ad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a1c2264142ad---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a1c2264142ad--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a1c2264142ad--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a1c2264142ad--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a1c2264142ad--------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Keith McNulty"}, {"url": "https://keith-mcnulty.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11K Followers"}, {"url": "http://keithmcnulty.org", "anchor_text": "keithmcnulty.org"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa859aab532a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&user=Keith+McNulty&userId=a859aab532a0&source=post_page-a859aab532a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7991b3dbcee9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanimated-storytelling-using-the-javascript-d3-library-a1c2264142ad&newsletterV3=a859aab532a0&newsletterV3Id=7991b3dbcee9&user=Keith+McNulty&userId=a859aab532a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://peopleanalytics-regression-book.org/", "anchor_text": "Handbook of Regression Modeling in People Analytics2021"}, {"url": "https://ona-book.org", "anchor_text": "Handbook of Graphs and Networks in People Analytics2022"}, {"url": "https://medium.com/@keith-mcnulty/books?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "See all (2)"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}