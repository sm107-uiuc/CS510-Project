{"url": "https://towardsdatascience.com/complete-image-augmentation-in-opencv-31a6b02694f5", "time": 1683007263.796582, "path": "towardsdatascience.com/complete-image-augmentation-in-opencv-31a6b02694f5/", "webpage": {"metadata": {"title": "Complete Image Augmentation in OpenCV | Towards Data Science", "h1": "Complete Image Augmentation in OpenCV", "description": "An exhaustive article covering all of image augmentation like flip, rotation, shift, etc. functions through a custom data generator using OpenCV in Python."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/different-colorspaces-as-inputs-to-cnns-406ae62d1bd6?source=friends_link&sk=92a03aaf5c423b0c61558b87febfdb3d", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/exploring-image-data-augmentation-with-keras-and-tensorflow-a8162d89b844", "anchor_text": "article", "paragraph_index": 1}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator", "anchor_text": "documentation", "paragraph_index": 12}, {"url": "https://www.linkedin.com/in/leommiranda/", "anchor_text": "Leonardo Miranda", "paragraph_index": 16}, {"url": "https://github.com/aleju/imgaug", "anchor_text": "imagaug", "paragraph_index": 16}, {"url": "https://github.com/albumentations-team/albumentations", "anchor_text": "albumentations", "paragraph_index": 16}], "all_paragraphs": ["A couple of days ago I was writing an article on using different colorspaces as inputs to CNN\u2019s and for that, I had to use a custom data generator. This meant I could not use the Tensorflow\u2019s inbuilt Image Data Generator for image augmentation. I searched online and found some articles but could not find anything which covered the subject in its entirety so I decided I\u2019ll do one.", "If you want to know how any of these works, you can have a look at this article. For visualization, I will be using an image of arc de Triomphe shown below.", "Horizontal shift or translation is shifting the image left or right based on a ratio that defines how much maximum to shift. To resize the image back to its original dimensions Keras by default uses a filling mode called \u2018nearest\u2019.", "I feel this renders that part of that image useless and hence I will simply resize them to their original size. So to perform this we need to generate a random number and then shift the image left or right using indexing.", "After we know how to implement a horizontal shift, it is pretty easy to implement a vertical shift.", "This was easy as I had already written an article on creating different Image filters cartooning, summer, winter, etc and it already included brightness function.", "We utilize HSV colorspace for this task. The more the value of Saturation and Value matrices the greater is the brightness. So to increase brightness, multiply them by a value greater than 1 and to reduce brightness, by a value less than 1. In Tensorflow a range is specified and a random value is chosen between it, so that is how we\u2019ll make it.", "In Tensorflow, zoom function takes a range and uses random values between it. If those values are less than 1 it magnifies the image and for values greater than 1 it shrinks it and fills it \u2018nearest\u2019. However, as we are resizing the images to their size we will only take values less than 1. Example: A value of 0.6 will mean to take 60% of the whole image and then we will resize it back to the original size.", "In Channel shift, a random amount of value is added to all the channels of the images chosen from the range specified. Its results are somewhat like the brightness functions only.", "I don\u2019t think this requires any explanation. It takes a boolean variable that defines if a horizontal flip is to be performed or not. There is an inbuilt function in OpenCV cv2.flip which is used to perform just this operation.", "Like a horizontal flip, it is performed using cv2.flip however, its second argument should be 0.", "To perform a rotation in OpenCV we need to create a rotation matrix and them apply affine transform on it.", "Above I had mentioned the \u2018nearest\u2019 fill mode and I had stated that I am not going to use it but instead resize the images. I decided I\u2019ll show you how that and all the other fill modes can be made in OpenCV anyway as I was trying to make a complete list, so if you ever want to perform one, you won\u2019t have any problems. From Tensorflow\u2019s documentation:", "fill_mode: One of {\"constant\", \"nearest\", \"reflect\" or \"wrap\"}. Default is 'nearest'. Points outside the boundaries of the input are filled according to the given mode:", "I\u2019ll make them with a horizontal shift. cv2.copyMakeBorder can be utilized for filling. It takes arguments as image, top, bottom, left, right, and mode. Top, bottom, left, right are the size of the border.", "That\u2019s all from this article. If you want to know how to create a custom data generator then you can have a look at my article below.", "Leonardo Miranda brought to my notice about two awesome libraries called imagaug and albumentations for image augmentation. They are available for both pip and conda install. They provide a large number of image augmentations from basic to very advanced. The best part I found about them was that there were augmentations even for segmentation and bounding boxes. I would encourage everyone to check out their Readme\u2019s they are brilliant.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F31a6b02694f5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vardanagarwal16?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": "Vardan Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0b122513e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&user=Vardan+Agarwal&userId=e0b122513e3b&source=post_page-e0b122513e3b----31a6b02694f5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31a6b02694f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31a6b02694f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@steve_j?utm_source=medium&utm_medium=referral", "anchor_text": "Steve Johnson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/different-colorspaces-as-inputs-to-cnns-406ae62d1bd6?source=friends_link&sk=92a03aaf5c423b0c61558b87febfdb3d", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/exploring-image-data-augmentation-with-keras-and-tensorflow-a8162d89b844", "anchor_text": "article"}, {"url": "https://medium.com/dataseries/designing-image-filters-using-opencv-like-abode-photoshop-express-part-1-8765e3f4495b", "anchor_text": "Designing Image Filters using OpenCV like Abode Photoshop Express (Part 1)We all have edited our images to perhaps improve the white balance, increase warmth, use different filters or even to\u2026medium.com"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator", "anchor_text": "documentation"}, {"url": "https://towardsdatascience.com/different-colorspaces-as-inputs-to-cnns-406ae62d1bd6", "anchor_text": "Different Colorspaces as Inputs to CNNsFind out if using different colorspaces in CNNs through a custom data generator leads to better results or not and\u2026towardsdatascience.com"}, {"url": "https://www.linkedin.com/in/leommiranda/", "anchor_text": "Leonardo Miranda"}, {"url": "https://github.com/aleju/imgaug", "anchor_text": "imagaug"}, {"url": "https://github.com/albumentations-team/albumentations", "anchor_text": "albumentations"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----31a6b02694f5---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----31a6b02694f5---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----31a6b02694f5---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----31a6b02694f5---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----31a6b02694f5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F31a6b02694f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&user=Vardan+Agarwal&userId=e0b122513e3b&source=-----31a6b02694f5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F31a6b02694f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&user=Vardan+Agarwal&userId=e0b122513e3b&source=-----31a6b02694f5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31a6b02694f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F31a6b02694f5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----31a6b02694f5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----31a6b02694f5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----31a6b02694f5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----31a6b02694f5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----31a6b02694f5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vardan Agarwal"}, {"url": "https://medium.com/@vardanagarwal16/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "399 Followers"}, {"url": "https://www.linkedin.com/in/vardan-agarwal-6bb123168/", "anchor_text": "https://www.linkedin.com/in/vardan-agarwal-6bb123168/"}, {"url": "https://www.buymeacoffee.com/vardan", "anchor_text": "https://www.buymeacoffee.com/vardan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0b122513e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&user=Vardan+Agarwal&userId=e0b122513e3b&source=post_page-e0b122513e3b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4ce0157411b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomplete-image-augmentation-in-opencv-31a6b02694f5&newsletterV3=e0b122513e3b&newsletterV3Id=4ce0157411b4&user=Vardan+Agarwal&userId=e0b122513e3b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}