{"url": "https://towardsdatascience.com/deep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0", "time": 1682995812.228498, "path": "towardsdatascience.com/deep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0/", "webpage": {"metadata": {"title": "Deep embedding\u2019s for categorical variables (Cat2Vec) | by Prajwal Shreyas | Towards Data Science", "h1": "Deep embedding\u2019s for categorical variables (Cat2Vec)", "description": "In this blog I am going to take you through the steps involved in creating a embedding for categorical variables using a deep learning network on top of keras. The concept was originally introduced\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.fast.ai/2018/04/29/categorical-embeddings/", "anchor_text": "details", "paragraph_index": 0}, {"url": "https://www.datacamp.com/community/tutorials/categorical-data", "anchor_text": "encoding methods", "paragraph_index": 5}, {"url": "https://www.kaggle.com/contactprad/bike-share-daily-data", "anchor_text": "bicycle sharing", "paragraph_index": 6}, {"url": "https://gitlab.com/praj88/deepembeddings", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/", "anchor_text": "here", "paragraph_index": 16}], "all_paragraphs": ["In this blog I am going to take you through the steps involved in creating a embedding for categorical variables using a deep learning network on top of keras. The concept was originally introduced by Jeremy Howard in his fastai course. Please see the link for more details.", "Across most of the data sources that we work with we will come across mainly two types of variables:", "When we build a ML model more often then not it is required for us to transform the categorical variable before we can use it in the algorithm. The transformation applied has a big impact on the performance of the model, especially if the data has a large number of categorical features with high cardinality. Example\u2019s of some of the usual transformation\u2019s applied include:", "One-Hot encoding: Here we convert each category value into a new column and assign and assign a 1 or 0(True/False) value to the column.", "Binary encoding: This creates fewer features than one-hot, while preserving some uniqueness of values in the the column. It can work well with higher dimensional ordinal data.", "These usual transformation\u2019s however do not capture the relationship between the categorical variables. Please see the below link for more information on different type of encoding methods.", "To demonstrate the application of deep embedding\u2019s let\u2019s take an example of the bicycle sharing data from Kaggle. Also link to the git repo is here.", "As we can see there are a number of columns in the data set. In order to demonstrate this concept we shall use just the date_dt, cnt and mnth columns from the data.", "Traditional one-hot encoding would result in 12 columns, one of each month. However in this type of embedding equal importance is given to each day of the week and there is no relationship between each of the months.", "We can see a seasonal pattern\u2019s of each of the months in the below graph. As we can see months 4 to 9 are the peak months. Months 0, 1, 10,11 are months of low demand for bike hire.", "Additionally when we plot the daily usage for each month, represented by a different colour, we cam see some weekly patterns within each month.", "Ideally we would expect such relationships to be captured by use of embeddings. In the next section we will examine the generation of these embeddings using a deep network built on top of keras.", "The code is as shown below. We will build a perceptron network with dense layer network and a \u2018relu\u2019 activation function.", "The input for the network i.e. \u2018x\u2019 variable is the month number. This is a numeric representation of each of the months in the year and ranges from 0 to 11. Hence the input_dim is set to 12.", "The output for the network i.e. \u2018y\u2019 is a scaled column of \u2018cnt\u2019. However \u2018y\u2019 can be increased to include other continuous variables. Here as we are using a single continuous variable we will set the last number of the output dense layer to 1. We will train the model for 50 iterations or epochs.", "Embedding Layer: Here we specify the embedding size for our categorical variable. I have used 3 in this case, if we were to increase this it will capture more details on the relationship between the categorical variables. Jeremy Howard suggests the following solution for choosing embedding sizes:", "We are using an \u201cadam\u201d optimiser with a mean-square error loss function. Adam is preferred to sgd (stochastic gradient descent) as it is much faster optimiser due to its adaptive learning rate. You can find more details on the different types of optimisers here.", "The final resulting embedding for each of the months are as follows. Here \u20180\u2019 is for January and \u201811\u2019 for December.", "When we visualise this using a 3D plot, we can see a clear relationship between the months. The months with similar \u2018cnt\u2019 are grouped closer together e.g. months 4 to 9 are very similar to each other.", "In conclusion we have seen that by using Cat2Vec (categorical variable to vectors) we can represent high cardinality categorical variable using low dimension embedding while preserving the relationship between each of the categories.", "In the next few blogs we will explore on how we can use these embeddings to build supervised and unsupervised machine learning models with better performance.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist/ ML Engineer \u2014 Experienced in building and deploying large scale ML models to enhance business value."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb05c8ab63ac0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@prajwalshreyas?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prajwalshreyas?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": "Prajwal Shreyas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdaf1da2a65fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=post_page-daf1da2a65fa----b05c8ab63ac0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb05c8ab63ac0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb05c8ab63ac0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.fast.ai/2018/04/29/categorical-embeddings/", "anchor_text": "details"}, {"url": "https://www.datacamp.com/community/tutorials/categorical-data", "anchor_text": "encoding methods"}, {"url": "https://www.kaggle.com/contactprad/bike-share-daily-data", "anchor_text": "bicycle sharing"}, {"url": "https://gitlab.com/praj88/deepembeddings", "anchor_text": "here"}, {"url": "https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b05c8ab63ac0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b05c8ab63ac0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/embedding?source=post_page-----b05c8ab63ac0---------------embedding-----------------", "anchor_text": "Embedding"}, {"url": "https://medium.com/tag/cat2vec?source=post_page-----b05c8ab63ac0---------------cat2vec-----------------", "anchor_text": "Cat2vec"}, {"url": "https://medium.com/tag/keras?source=post_page-----b05c8ab63ac0---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb05c8ab63ac0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=-----b05c8ab63ac0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb05c8ab63ac0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=-----b05c8ab63ac0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb05c8ab63ac0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb05c8ab63ac0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b05c8ab63ac0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b05c8ab63ac0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prajwalshreyas?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prajwalshreyas?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Prajwal Shreyas"}, {"url": "https://medium.com/@prajwalshreyas/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "366 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdaf1da2a65fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=post_page-daf1da2a65fa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F79d4dbc0a15a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-embeddings-for-categorical-variables-cat2vec-b05c8ab63ac0&newsletterV3=daf1da2a65fa&newsletterV3Id=79d4dbc0a15a&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}