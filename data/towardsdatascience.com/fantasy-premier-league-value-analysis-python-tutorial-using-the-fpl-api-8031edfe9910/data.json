{"url": "https://towardsdatascience.com/fantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910", "time": 1683009244.1044638, "path": "towardsdatascience.com/fantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910/", "webpage": {"metadata": {"title": "How to Access the Fantasy Premier League API, Build a Dataframe, and Analyze Using Jupyter, Python, and Pandas | by David Allen | Towards Data Science", "h1": "How to Access the Fantasy Premier League API, Build a Dataframe, and Analyze Using Jupyter, Python, and Pandas", "description": "As of the writing of this tutorial, before match week 30+, I\u2019m ranked #3,919 in the world in Fantasy Premier League Soccer (team: Yin Aubameyang), which equates to the top 0.05% in the world. It\u2019s\u2026"}, "outgoing_paragraph_urls": [{"url": "https://deallen7.medium.com/membership", "anchor_text": "my link", "paragraph_index": 69}], "all_paragraphs": ["As of the writing of this tutorial, before match week 30+, I\u2019m ranked #3,919 in the world in Fantasy Premier League Soccer (team: Yin Aubameyang), which equates to the top 0.05% in the world.", "It didn\u2019t happen by accident, and it wasn\u2019t all luck.", "Over these several years, I\u2019ve learned 2 skills really help:", "The first will help you stop making stupid mistakes. The second will assist you in uncovering value that other fantasy managers are missing.", "This tutorial will help develop these 2 skills by teaching you how to access new data. And then help you look at it in new ways.", "This document is far from perfect, but at the very least, it will give you a taste of what is possible with Jupyter Notebooks, Pandas, Python, and a new data source.", "By the end of this tutorial, you will have the basic skills to pull down data from the Fantasy Premier League API and work with the data to squeeze out new understandings.", "Note from the author: for your next FPL API challenge, bookmark my blog here on Looping through the \u201cElement-Summary\u201d FPL API endpoint:", "This tutorial assumes a little familiarity with Jupyter and Python. If you are just getting started, start with my tutorial here:", "Once you complete your setup, come right back to this article!", "If you already have Jupyter, Python, and Pandas installed then move on to step 2!", "First, we\u2019ll need our package imports. We really only need 3:", "Note: If you get an import error, it\u2019s probably because you haven\u2019t added the package to your environment, or activated your development environment. Head over to your Anaconda Navigator and make sure to add the package needed to whatever environment you activate for your Jupyter Notebook work. Apply the update, and don\u2019t forget to restart your terminal before you activate your development environment!", "Next, we\u2019ll need the API URL:", "Use the requests package to make a GET request from the API endpoint:", "Then, transform that request into a json object:", "Let\u2019s look at the json keys, and then we\u2019ll create our dataframe(s)", "This returns a list of all the keys to the json:", "The three keys I really care for this article are elements , element_type , and teams .", "Next, we\u2019ll create three different dataframes using these three keys, and then map some columns from the teams and element_type dataframes into our elements dataframe.", "Once we build our dataframes, we\u2019ll be able to work with the data and do things like sort, filter, map (similar to a v-lookup in Excel), and organize our data into a pivot table.", "So let\u2019s start by building our dataframes:", "Preview the top 5 rows of your dataframes with the head() method. Like so:", "You can also get a glimpse of all of the columns in each dataframe with the columns method:", "There is an awful lot of data, so I\u2019m going to make a copy of this dataframe, but only copy over some of the columns. I like to prepend slim_ to these smaller, lighter dataframe copies:", "Now, most of the data I\u2019m currently interested in is viewable in a single window:", "This section will be broken into sub-sections:", "The first thing I\u2019m going to do is map the position name from the elements_type_df to the slim_elements_df . If you\u2019ve ever used Excel, you\u2019ll notice that map() is very similar to a v-lookup.", "Now that we\u2019ve done that, take a look at the top few rows:", "Great, now we can easily see the position. This will come in handy when we organize value_season by position.", "Next, let\u2019s add the team name. We can do that by mapping \u201cname\u201d from our teams_df:", "Next, let\u2019s sort this table by value_season . I\u2019m curious to look at the top value picks this year.", "BUT FIRST, we have to create a new column called value .", "Why? Because some of the values in the column value_season are string values. I know this because I\u2019ve attempted to sort by value_season and got a strange, incorrect result. Unexplained behavior in your dataframe can often be due to conflicting types of data stored in the same column (for example: strings, integers, and float values all stored in the same column).", "We need to make sure every single value is of the same type. To do this, we\u2019ll create a new column, and use the astype() method to set all of the values to a float value (fancy-talk for numbers with decimals, example: 4.5).", "Now we can sort our dataframe on the column value . Let\u2019s do it:", "Sort_values() allows you to, well, sort values :)", "By default, Pandas will sort values in the ascending direction from low to high. But we want values sorted in the descending direction: high to low. So we need to explicitly set the ascending parameter to False like so:", "Well, will ya look at that? Two players tied for the top spot. Pope and Lundstram. A goalkeeper and a defender. Nice.", "This essentially means Pope and Lundstram have earned the most points per cost, because value is simply calculated by dividing total_points by now_cost .", "Did you expect that to be the case? A defender and a goalkeeper? Might this change how you think about team selection next year? Or next week?", "Next, we\u2019ll create a pivot_table on the column position , and look at value-by-position:", "After creating the pivot_table and assigning the pivot_table to the variable pivot , we\u2019ll sort the pivot table descending by value:", "Interesting. One of the two highest-value players in the game is a goalkeeper, yet the goalkeeper position contributes the lowest value on average. I think this is likely because all the goalkeepers that play 0 minutes. bring down the average of the starters.", "To address this, let\u2019s remove all the players from our dataframe that have zero minutes this season. We\u2019ll use loc[] for the first time:", ".loc lets you locate specific rows that have specific column values. It\u2019s like filtering a spreadsheet on a specific value in a column.", "For our current purposes, we want to locate all rows in our dataframe that have a value greater than zero so as to remove all values = 0. We aren\u2019t just doing this for keepers. We need to do this for every position. We write:", "Now let\u2019s run that pivot table back again:", "Now let\u2019s do a different type of pivot table next. This time, we\u2019ll look at which teams are providing the most value this year. The only things that need to change about this pivot_table statement are the index and the pivot_table variable. Take a look:", "Now we\u2019ll display the team_pivot sorted, from the highest value team to the lowest:", "Wolves fans don\u2019t have to worry about their innate biases. Lucky!", "Spurs fans, on the other hand, have had to be a little more conscious of their bias towards their own team to succeed in the FPL this year. How stressful.", "Next, let\u2019s look at a histogram distribution of value by position. Before we do that, we\u2019ll create some filtered dataframes for each position. We will use .loc again to accomplish this:", "Then, we\u2019ll use the .hist() method on our goal_df.value dataframe column:", "There is a decent amount of value here above 20. Let\u2019s look at our dataframe, sorted by value to see who these characters are:", "Take-away? There\u2019s a lot of value available in the goalkeeper position.", "Plenty of other ways to cut this cheese, but let\u2019s move on to histograms of the defender position:", "Our defensive histogram points out something interesting. Notice the difference between the goalkeeper histogram and the defender histogram?", "For a goalkeeper, there is a \u201cbest\u201d choice, but we don\u2019t really know who that is going to be starting the season. It turns out, goalkeeper selection was pretty forgiving seeing how many goalkeepers offered value between 20 and 26:", "Defenders, on the other hand, had just one clear winner this year, and only a few others in the 20\u201325 value range that stood out from the pack. Let\u2019s look at the top of the defender value table:", "Lundstram was THE essential defender this year, offering a huge amount of value per cost: 26.1. Impressive!", "The most important takeaway from this whole analysis is that Goal Keepers and Defenders offer more value than Midfielders and Forwards. But if you review FPL Twitter, you\u2019ll see many FPL managers that don\u2019t quite grasp this insight. That, my friend, is called \u201copportunity.\u201d", "It\u2019s not all about value of course. It\u2019s a team optimization challenge. You have 100 currency units to spend, and a team of high-value returners may not score enough points to challenge for a high finish in your mini-leagues or overall. A team of the highest-value returners will leave you with some money in the bank. And the game is to leverage your money for POINTS, not VALUE.", "Let\u2019s look at the top midfielders, for example:", "Cantwell offers the highest value out of all midfielders, but he still has just 100 points. Meanwhile, De Bruyne has a value of just 16.8, but 178 total points\u2026", "The point? You need both value and high-returns. You\u2019re looking for a balance; a balanced optimization of value and points.", "Before we go, I wanted to show you how to export to a CSV that you can work with in Google Sheets or Excel.", "Run that cell and Boom! Done. Nice job :)", "Now have fun exploring the data in Google Sheets or Excel, if that\u2019s your thing.", "If you enjoy reading stories like these and want to support me as a writer, consider signing up to become a Medium member. It\u2019s $5 a month, giving you unlimited access to thousands of Python guides and Data science articles. If you sign up using my link, I\u2019ll earn a small commission with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Documentation and tutorials on Python, Pandas, Jupyter Notebook, and Data Analysis."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8031edfe9910&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8031edfe9910--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8031edfe9910--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://deallen7.medium.com/?source=post_page-----8031edfe9910--------------------------------", "anchor_text": ""}, {"url": "https://deallen7.medium.com/?source=post_page-----8031edfe9910--------------------------------", "anchor_text": "David Allen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8ad9b3b5ef74&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&user=David+Allen&userId=8ad9b3b5ef74&source=post_page-8ad9b3b5ef74----8031edfe9910---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8031edfe9910&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8031edfe9910&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/Pexels-2286921/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1866738", "anchor_text": "Pexels"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1866738", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/looping-through-the-fantasy-premier-league-api-element-summary-endpoint-to-download-player-df4ab5151fcb", "anchor_text": "Looping through the Fantasy Premier League API \u201cElement-Summary\u201d Endpoint to Download Player\u2026Documentation for Creating a Master DataFrame of All Player Gameweek Histories for the Current Season, and All Past\u2026towardsdatascience.com"}, {"url": "https://medium.com/@deallen7/getting-started-with-python-pandas-and-jupyter-notebooks-bd08c963914", "anchor_text": "Getting Started with Python, Pandas, and Jupyter NotebooksDocumentation for everything you need to set up your machine with Jupyter Notebooks and start programming in Python\u2026medium.com"}, {"url": "https://fantasy.premierleague.com/api/bootstrap-static/'", "anchor_text": "https://fantasy.premierleague.com/api/bootstrap-static/'"}, {"url": "https://deallen7.medium.com/membership", "anchor_text": "my link"}, {"url": "https://deallen7.medium.com/membership", "anchor_text": "Join Medium with my referral link - David AllenRead every story from David Allen (and thousands of other writers on Medium). Your membership fee directly supports\u2026deallen7.medium.com"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----8031edfe9910---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/programming?source=post_page-----8031edfe9910---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----8031edfe9910---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8031edfe9910---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/soccer-analytics?source=post_page-----8031edfe9910---------------soccer_analytics-----------------", "anchor_text": "Soccer Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8031edfe9910&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&user=David+Allen&userId=8ad9b3b5ef74&source=-----8031edfe9910---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8031edfe9910&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&user=David+Allen&userId=8ad9b3b5ef74&source=-----8031edfe9910---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8031edfe9910&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8031edfe9910--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8031edfe9910&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8031edfe9910---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8031edfe9910--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8031edfe9910--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8031edfe9910--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8031edfe9910--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8031edfe9910--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8031edfe9910--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8031edfe9910--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8031edfe9910--------------------------------", "anchor_text": ""}, {"url": "https://deallen7.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://deallen7.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "David Allen"}, {"url": "https://deallen7.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "721 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8ad9b3b5ef74&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&user=David+Allen&userId=8ad9b3b5ef74&source=post_page-8ad9b3b5ef74--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb3ab0e36e387&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffantasy-premier-league-value-analysis-python-tutorial-using-the-fpl-api-8031edfe9910&newsletterV3=8ad9b3b5ef74&newsletterV3Id=b3ab0e36e387&user=David+Allen&userId=8ad9b3b5ef74&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}