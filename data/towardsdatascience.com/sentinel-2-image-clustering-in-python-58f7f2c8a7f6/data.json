{"url": "https://towardsdatascience.com/sentinel-2-image-clustering-in-python-58f7f2c8a7f6", "time": 1683008909.87504, "path": "towardsdatascience.com/sentinel-2-image-clustering-in-python-58f7f2c8a7f6/", "webpage": {"metadata": {"title": "Sentinel-2 image clustering in python | by Wathela Hamed | Towards Data Science", "h1": "Sentinel-2 image clustering in python", "description": "Clustering or unsupervised classification is the process of grouping or aggregating the pixel values of an image into a certain number of natural classes (groups) based on statistical similarity. In\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.esa.int/Applications/Observing_the_Earth/Copernicus/Sentinel-2", "anchor_text": "sentinel-2", "paragraph_index": 0}, {"url": "https://jupyter.org/", "anchor_text": "jupyter notebook", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Scikit-learn", "paragraph_index": 1}, {"url": "https://rasterio.readthedocs.io/en/latest/", "anchor_text": "Rasterio", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-Means", "paragraph_index": 3}, {"url": "https://github.com/wathela/Sentinel2-clustering", "anchor_text": "github.", "paragraph_index": 4}, {"url": "https://seos-project.eu/remotesensing/remotesensing-c05-p02.html", "anchor_text": "here", "paragraph_index": 7}], "all_paragraphs": ["Clustering or unsupervised classification is the process of grouping or aggregating the pixel values of an image into a certain number of natural classes (groups) based on statistical similarity. In this tutorial, we will be using the rasterio for sentinel-2 image manipulation and the power full scikit-learn python package for clustering in jupyter notebook.", "Scikit-learn is a free software machine learning library for the Python programming language which contains various classification, regression and clustering algorithms. To install this package:", "Rasterio is an open source python library that reads and writes raster datasets such as satellite imagery and terrain models in different formats like GEOTIFF and JP2.", "Algorithm: Scikit-learn has different algorithms for clustering, these algorithms can be directly imported form the cluster sub-library. K-Means is one of the most used algorithms in clustering for its simplicity. It basically divides n observations (pixels values in our case) into k clusters (number of classes predefined by user) where each observation belongs to the cluster with the nearest mean. This tutorial will be based on K-means but you can easily switch to try out the rest, the code will almost stay the same but you will only need to change the algorithm.", "Sentinel-2 image of El-hasaheesa and Elmanagel localities in Gezira state/Sudan will be used in this tutorial for training and prediction respectively. This data and the full code of this tutorial can be found on github.", "To kick this off will start by importing all the packages will need:", "Then will use rasterio to open the image and read in its meta data", "Meta data give us information about the image such as the data type, size ( width, height), counts (number of bands) and coordinate reference system. To visualize this image nicely will need to adjust its contrast first by stretching it out, you can read more about image enhancement here.", "If we print the shape of this image we will see it has the order of (bands, height, width), this needs to be changed first to the shape order (height, width, bands). We will reform this shape by:", "At the end of this loop we will get a new array with the required shape order and has the same size and number of bands.", "Now we are almost ready to train our classifier, but first, we need to convert our X (width) and Y (height) dimensions to 1 dimension, so to have a 2d array instead of 3d, then we can feed it to K-means classifier.", "Training: The most important parameter to set is the n_clusters which represents the number of clusters that we want to group our pixels into, in our image we can visually see that it has three main classes (built-up areas, bare lands and cultivated areas), but we have one additional class which is the black sides outside the region of interest which its pixels can also be clustered into a group. K-means has some others parameters such as the number of maximum number iterations and the number of initialization but we will leave them to the default for this tutorials.", "To show the resulting image, I would like to use a custom color map where I can control the color of each class. We will keep the outsides region as black and use red, green and yellow for the rest of the classes.", "Prediction: Once the classifier is trained, it can be used to predict the same learned clusters in any unseen image. We will use an image of Elmanagel locality (adjacent to Elhasaheesa) to predict the same 4 classes on it.", "To use Elmanagel\u2019s image for prediction, all the prepossessing that we have done to the previous image (reforming the shape and reshaping to a 2d array) need to be done before we can feed it to the classifier. Also the same previous steps are required to show the resulting predicted clusters.", "Now let\u2019s show the original and the resulting predicted image in a subplot, but first, we will enhance the original image for better viewing through contrast stretch.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Astrophysicist | GIS Developer | Machine Learning Engineer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F58f7f2c8a7f6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wathelahamed?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wathelahamed?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": "Wathela Hamed"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65f15e0d6014&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&user=Wathela+Hamed&userId=65f15e0d6014&source=post_page-65f15e0d6014----58f7f2c8a7f6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58f7f2c8a7f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58f7f2c8a7f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.esa.int/Applications/Observing_the_Earth/Copernicus/Sentinel-2", "anchor_text": "sentinel-2"}, {"url": "https://jupyter.org/", "anchor_text": "jupyter notebook"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Scikit-learn"}, {"url": "https://rasterio.readthedocs.io/en/latest/", "anchor_text": "Rasterio"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-Means"}, {"url": "https://github.com/wathela/Sentinel2-clustering", "anchor_text": "github."}, {"url": "https://seos-project.eu/remotesensing/remotesensing-c05-p02.html", "anchor_text": "here"}, {"url": "https://link.springer.com/chapter/10.1007/978-981-13-6424-2_3", "anchor_text": "Satellite Image ClusteringPart of the SpringerBriefs in Applied Sciences and Technology book series (BRIEFSAPPLSCIENCES) Remote Sensing\u2026link.springer.com"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "scikit-learn\"We use scikit-learn to support leading-edge basic research [...]\" \"I think it's the most well-designed ML package I've\u2026scikit-learn.org"}, {"url": "https://rasterio.readthedocs.io/en/latest/", "anchor_text": "Rasterio: access to geospatial raster data - rasterio documentationEdit descriptionrasterio.readthedocs.io"}, {"url": "https://seos-project.eu/remotesensing/remotesensing-c05-p02.html", "anchor_text": "Introduction to Remote SensingWhy do we enhance satellite images? Different methods of image enhancement are used to prepare the \"raw data\" so that\u2026seos-project.eu"}, {"url": "https://medium.com/tag/sentinel-2?source=post_page-----58f7f2c8a7f6---------------sentinel_2-----------------", "anchor_text": "Sentinel 2"}, {"url": "https://medium.com/tag/k-means-clustering?source=post_page-----58f7f2c8a7f6---------------k_means_clustering-----------------", "anchor_text": "K Means Clustering"}, {"url": "https://medium.com/tag/python?source=post_page-----58f7f2c8a7f6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/rasterio?source=post_page-----58f7f2c8a7f6---------------rasterio-----------------", "anchor_text": "Rasterio"}, {"url": "https://medium.com/tag/satellite-imagery?source=post_page-----58f7f2c8a7f6---------------satellite_imagery-----------------", "anchor_text": "Satellite Imagery"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F58f7f2c8a7f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&user=Wathela+Hamed&userId=65f15e0d6014&source=-----58f7f2c8a7f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F58f7f2c8a7f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&user=Wathela+Hamed&userId=65f15e0d6014&source=-----58f7f2c8a7f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58f7f2c8a7f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F58f7f2c8a7f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----58f7f2c8a7f6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----58f7f2c8a7f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wathelahamed?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wathelahamed?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wathela Hamed"}, {"url": "https://medium.com/@wathelahamed/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "72 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65f15e0d6014&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&user=Wathela+Hamed&userId=65f15e0d6014&source=post_page-65f15e0d6014--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8a1fb3c90d9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentinel-2-image-clustering-in-python-58f7f2c8a7f6&newsletterV3=65f15e0d6014&newsletterV3Id=8a1fb3c90d9d&user=Wathela+Hamed&userId=65f15e0d6014&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}