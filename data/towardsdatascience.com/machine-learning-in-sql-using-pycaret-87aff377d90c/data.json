{"url": "https://towardsdatascience.com/machine-learning-in-sql-using-pycaret-87aff377d90c", "time": 1683007220.91308, "path": "towardsdatascience.com/machine-learning-in-sql-using-pycaret-87aff377d90c/", "webpage": {"metadata": {"title": "Machine Learning in SQL using PyCaret | by Umar Farooque, MMA, MCS, PMP\u00ae, CSM | Towards Data Science", "h1": "Machine Learning in SQL using PyCaret", "description": "This post is a step-by-step tutorial on how to train and deploy an Unsupervised Machine Learning Clustering model in SQL Server using PyCaret(a low-code ML library in Python). 4. How to train a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pycaret.org/", "anchor_text": "PyCaret", "paragraph_index": 0}, {"url": "https://www.microsoft.com/en-ca/sql-server/sql-server-downloads", "anchor_text": "SQL Server 2019 Developer", "paragraph_index": 10}, {"url": "https://www.microsoft.com/en-ca/sql-server/sql-server-downloads", "anchor_text": "click here", "paragraph_index": 11}, {"url": "https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?redirectedfrom=MSDN&view=sql-server-ver15", "anchor_text": "Click here", "paragraph_index": 17}, {"url": "https://raw.githubusercontent.com/pycaret/pycaret/master/datasets/jewellery.csv", "anchor_text": "Github repository", "paragraph_index": 43}, {"url": "http://pycaret.org/", "anchor_text": "PyCaret", "paragraph_index": 52}], "all_paragraphs": ["This post is a step-by-step tutorial on how to train and deploy an Unsupervised Machine Learning Clustering model in SQL Server using PyCaret(a low-code ML library in Python).", "Things we will cover in this article:", "1. How to download and install SQL Server for free", "2. How to create a new database and importing data into a database", "3. How to enable and use Python scripting in database", "4. How to train a clustering algorithm in order to assign cluster labels to each observation in the dataset", "The go-to tools/ environments for performing ML experiments are Command-Line, IDEs, or Notebooks. However, such tools/environments may pose limitations when the data size gets very large, or when the ML model is required to be put in production. There has been a dire need to have the ability to programme and train models where data reside. MS SQL Server introduced this capability in their SQL Server version 2019. The distinct advantages of using SQL Server for Machine Learning are:", "i. Extracting a large amount of data from the system is tedious and time-consuming. Conducting ML experiments on a server brings the code to data, rather than taking data to the code", "ii. ML experiments are executed mostly in computer/cpu memory. Most of the machines hit a performance ceiling when training an ML algorithm on large data sets. ML on the SQL Server database avoids this", "iii. It is easy to integrate and deploy ML Pipelines along with other ETL processes", "SQL Server is a Microsoft relational database management system. As a database server, it performs the primary function of storing and retrieving data as requested by different applications. In this tutorial, we will use SQL Server 2019 Developer for machine learning by importing PyCaret library into SQL Server.", "If you have used SQL Server before, it is likely that you have it installed and have access to the database. If not, click here to download SQL Server 2019 Developer or other edition.", "Before using PyCaret functionality into SQL Server, you\u2019ll need to install SQL Server and PyCaret. This is a multi-step process:", "Open the file and follow the instructions to install (recommended to use Custom install option)", "Choose New SQL Server stand-alone installation", "In the Instance Features option, select the features including \u201cPython\u201d under Machine Learning Services and Language Extensions and Machine Learning Server (Standalone)", "Click \u201cAccept\u201d to provide consent to install Python", "Click here or Open SQL Server Installation Center to download \u201cSQL Server Management Tools\u201d file \u201cSSMS-Setup-ENU.exe\u201d", "Open \u201cSSMS-Setup-ENU.exe\u201d file to start the installation", "Once you have everything installed, you will need to start an instance of the server. To do so, start SSMS. At the login stage, you\u2019ll be asked to the name of the SQL Server that you can choose from the drop-down menu. Once a connection is established, you can see all the objects from the server. If you have downloaded SQL Server for the first time and you do not have a database to work with, you will need to create a new database first.", "In the Object Explorer panel, right-click on Databases, and choose New Database", "Enter the database name and other information", "The setup may take 2\u20133 minutes including creating a database, user and setting ownership", "You will now have to import a CSV file into a database using SQL Server Management Studio.", "Create a table \u201cjewellery\u201d in the database", "Right-click the database and select Tasks -> Import Data", "For Data Source, select Flat File Source. Then use the Browse button to select the CSV file. Spend some time configuring the data import before clicking the Next button.", "For Destination, select the correct database provider (e.g. SQL Server Native Client 11.0). Enter the Server name; check Use SQL Server Authentication, enter the Username, Password, and Database before clicking the Next button.", "In the Select Source Tables and Views window, you can Edit Mappings before clicking the Next button.", "Check Run immediately and click the Next button", "Click the Finish button to run the package", "We will run Python \u201cinside\u201d the SQL Server by using the sp_execute_external_script system stored procedure. To begin, you need to open a \u2018New Query\u2019. Execute the following query in your instance to enable the use of the procedure for remote script execution:", "Note: Restart the instance before proceeding to the next steps.", "Following SQL Statements can be executed to check the Python path and list installed packages.", "To install PyCaret package, open a command prompt and browse to the location of Python packages where SQL Server is installed. The default location is:", "Navigate to \u201cScripts\u201d directory and use pip command to install PyCaret package", "Note: Make sure, you have access to the SQL Server directory to install package and/or change configurations. Otherwise, the package installation will fail.", "Note: In case encounter issue about missing \u201clightgbm\u201d module when running SQL script. Follow the instructions below:", "Execute the following SQL to verify the PyCaret installation from SQL Server:", "Clustering is a machine learning technique that groups data points with similar characteristics. These groupings are useful for exploring data, identifying patterns, and analyzing a subset of data. Some common business use cases for clustering are:", "\u2714 Customer segmentation for the purpose of marketing.", "\u2714 Customer purchasing behaviour analysis for promotions and discounts.", "\u2714 Identifying geo-clusters in an epidemic outbreak such as COVID-19.", "In this tutorial, we will use the \u2018jewellery.csv\u2019 file that is available on PyCaret\u2019s Github repository.", "Run the following SQL code in SQL Server:", "A new column \u2018Cluster\u2019 containing the label is attached to the original table.", "By default, PyCaret trains a K-Means clustering model with 4 clusters (i.e. all the data points in the table are categorized into 4 groups). Default values can be changed easily:", "To change the number of clusters you can use num_clusters parameter within get_clusters( ) function.", "To change model type use model parameter within get_clusters( ).", "See the following code for training K-Modes model with 6 clusters:", "Following these steps, you can assign cluster value to every observation point in the jewellery dataset. You can use similar steps on other datasets too, to perform clustering on them.", "In this post, we learnt how to build a clustering model using running a Python library (PyCaret) in SQL Server. Similarly, you can build and run other types of supervised and unsupervised ML models depending on the need of the business problem.", "You can further check out the PyCaret website for documentation on other supervised and unsupervised experiments that can be implemented in a similar manner within SQL Server.", "My future posts will be tutorials on exploring supervised learning techniques (regression/classification) using Python and Pycaret within a SQL Server.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "BI/Data Architect | Management | Data Engineering | Data Analytics | BI Reporting & Visualization Expert"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F87aff377d90c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----87aff377d90c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----87aff377d90c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@muhammad.u.farooque?source=post_page-----87aff377d90c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@muhammad.u.farooque?source=post_page-----87aff377d90c--------------------------------", "anchor_text": "Umar Farooque, MMA, MCS, PMP\u00ae, CSM"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c0277167441&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&user=Umar+Farooque%2C+MMA%2C+MCS%2C+PMP%C2%AE%2C+CSM&userId=2c0277167441&source=post_page-2c0277167441----87aff377d90c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87aff377d90c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87aff377d90c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pycaret.org/", "anchor_text": "PyCaret"}, {"url": "https://www.microsoft.com/en-ca/sql-server/sql-server-downloads", "anchor_text": "SQL Server 2019 Developer"}, {"url": "https://www.microsoft.com/en-ca/sql-server/sql-server-downloads", "anchor_text": "click here"}, {"url": "https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?redirectedfrom=MSDN&view=sql-server-ver15", "anchor_text": "Click here"}, {"url": "https://raw.githubusercontent.com/pycaret/pycaret/master/datasets/jewellery.csv", "anchor_text": "Github repository"}, {"url": "http://pycaret.org/", "anchor_text": "PyCaret"}, {"url": "https://pycaret.org/", "anchor_text": "PyCaret"}, {"url": "https://pycaret.org/guide/", "anchor_text": "PyCaret: User guide and documentation"}, {"url": "https://pycaret.org/tutorial/", "anchor_text": "PyCaret: Tutorials"}, {"url": "https://www.linkedin.com/in/umarfarooque/", "anchor_text": "My LinkedIn Profile"}, {"url": "https://medium.com/tag/sql-server?source=post_page-----87aff377d90c---------------sql_server-----------------", "anchor_text": "Sql Server"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----87aff377d90c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----87aff377d90c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/database?source=post_page-----87aff377d90c---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/tag/technology?source=post_page-----87aff377d90c---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F87aff377d90c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&user=Umar+Farooque%2C+MMA%2C+MCS%2C+PMP%C2%AE%2C+CSM&userId=2c0277167441&source=-----87aff377d90c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F87aff377d90c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&user=Umar+Farooque%2C+MMA%2C+MCS%2C+PMP%C2%AE%2C+CSM&userId=2c0277167441&source=-----87aff377d90c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F87aff377d90c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----87aff377d90c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F87aff377d90c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----87aff377d90c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----87aff377d90c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----87aff377d90c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----87aff377d90c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----87aff377d90c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----87aff377d90c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----87aff377d90c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----87aff377d90c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----87aff377d90c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@muhammad.u.farooque?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@muhammad.u.farooque?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Umar Farooque, MMA, MCS, PMP\u00ae, CSM"}, {"url": "https://medium.com/@muhammad.u.farooque/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "40 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c0277167441&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&user=Umar+Farooque%2C+MMA%2C+MCS%2C+PMP%C2%AE%2C+CSM&userId=2c0277167441&source=post_page-2c0277167441--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffeaf131d314&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-sql-using-pycaret-87aff377d90c&newsletterV3=2c0277167441&newsletterV3Id=feaf131d314&user=Umar+Farooque%2C+MMA%2C+MCS%2C+PMP%C2%AE%2C+CSM&userId=2c0277167441&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}