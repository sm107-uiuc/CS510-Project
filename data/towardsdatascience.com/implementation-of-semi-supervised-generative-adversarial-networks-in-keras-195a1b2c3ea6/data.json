{"url": "https://towardsdatascience.com/implementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6", "time": 1683015109.582464, "path": "towardsdatascience.com/implementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6/", "webpage": {"metadata": {"title": "Implementation of Semi-Supervised Generative Adversarial Networks in Keras | by Kunal Vaidya | Towards Data Science", "h1": "Implementation of Semi-Supervised Generative Adversarial Networks in Keras", "description": "Everyone has heard about supervised learning and unsupervised learning but there is also another set of learning techniques in between them called semi-supervised learning. Supervised Learning is the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/kunal-vaidya-0bab51198/", "anchor_text": "https://www.linkedin.com/in/kunal-vaidya-0bab51198/", "paragraph_index": 43}], "all_paragraphs": ["Everyone has heard about supervised learning and unsupervised learning but there is also another set of learning techniques in between them called semi-supervised learning.", "Supervised Learning is the most popular technique used in Machine Learning but there is one disadvantage to it that it requires a lot of labeled data. It takes a lot of effort and time to label the data. So this is where Semi-Supervised Learning comes into the picture.", "Semi-Supervised Learning is a technique where we only use a small set of labeled data from a large amount of unlabeled data to train our model.", "Seems like an interesting approach and also the cost of labeling the data is reduced drastically.", "Generative Adversarial Networks (known as GAN\u2019s) are a class of generative models designed by Ian Goodfellow and his colleagues in 2014. It was a breakthrough in terms of generative models.", "In GAN\u2019s there are two neural networks that are trying to defeat each other (i.e one network\u2019s loss is the other network\u2019s gain). The two neural networks are called Generator and Discriminator.", "The generator model tries to generate images (similar to training data) and the discriminator\u2019s job is to classify the images as real (from training data) or fake (from the generator). So Basically Discriminator is trying not to get fooled by Generator and Generator is trying it\u2019s best to fool the discriminator so that\u2019s why this is called a Game Theory approach as both Generator and Discriminator are in a game trying to overcome each other.", "Below is the model for Semi-Supervised GAN", "Let\u2019s Understand the modelThe discriminator is passed through three types of images namely Labeled Training Images, Unlabeled Training Images, and Fake Images generated by Generator. Its job is not only to distinguish between Real/Fake Images but also to classify the Labeled Training Images into their correct classes.", "The Discriminator has two different outputs:", "The powerful aspect of this is that discriminator is not only trained on labeled data but also on a large amount of unlabeled data as it has to also discriminate between Real/Fake images so for this task discriminator will need to learn to extract features for classifying images as real or fake. This adversarial training will help the discriminator to classify the labeled data more accurately as it will recognize other patterns as well while learning to classify real/fake images which normally it would not on just a small set of labeled data.", "So Let\u2019s see the implementation of the above model in KerasThe dataset which I am gonna use is the good old MNIST Dataset (Everyone\u2019s Favourite)", "First import all the necessary packages required", "z_dim is the dimension of our random normal variable which we will pass to our generator.", "We need to prepare two datasets as follows:", "Only batch_labeled() function needs explanation here", "batch_labeled() prepares the dataset for supervised discriminator by selecting a subset of samples along with their labels. We are just going to use 100 labeled examples(i.e 10 examples per class)to train our classifier.", "batch_unlabeled() randomly samples images from the dataset with number of images equal to given batch_size.", "Using Keras Sequential API for building our generator model. It is a basic generator model as our task is not complicated.", "Dense layer is used to reshape our dimensional z_dim which is of shape (batch_size,100) to (batch_size,7,7,256) so we can apply Conv2DTranspose Layer on it to generate image.", "So this is our Discriminator which takes input an image (fake or real) and outputs whether the image is real or fake i.e \u201c1\u201d or \u201c0\u201d.", "Here output has been kept an output from dense layer without any activation so these are values which can be negative as well. It will become clear in the next step why it\u2019s been done like this.", "build_discriminator_supervised() takes as input the discriminator model we created in above step and uses softmax activation to classify our input image into one of 10 classes (for MNIST).", "build_discriminator_unsupervised() takes input the discriminator we created before and it applies a custom_activation() on the output of discriminator.", "As when we created discriminator we had kept its output as the output of a Dense layer which gives values without any activation. So the custom activation does the following", "Here z is the output of dense layer without any activation,k for our case is 10 and y is between 0 and 1.", "As the probability of the image being real or fake will be the sum of probabilities over all classes so the activation function basically sums over all classes and scales output between [0,1] to get the probability of the image being real or not. This trick was much more effective than using a sigmoid.", "The weights used by supervised and unsupervised discriminator are the same only the output nodes used by both are different.", "build_gan() basically takes input both the generator and discriminator and merges them to form a model. This is done to train the generator network. This will be called the composite model.", "Note that here discriminator is the unsupervised discriminator as GAN is just used for unlabeled images.", "First, let's build our model by compiling all the model functions we created above.", "Note that while building GAN (composite model) we have kept discriminator_unsupervised as non-trainable (line 7) because the training of GAN is done in steps of training the Discriminator and then training the Generator so while training our Generator we don\u2019t want our discriminator to get updated.", "Cost Function used is Binary Cross Entropy for unsupervised discriminator and Categorical Cross Entropy for Supervised Discriminator.", "So, we start our training by training supervised discriminator on a batch of real labeled images, then we train unsupervised discriminator on real unlabeled images (labeled as \u201c1\u201d) and fake images (labeled as \u201c0\u201d) generated by Generator and Finally, we train our generator through discriminator by using the composite model which we had defined earlier.", "So the way training of Generator works is as follows:", "So, as Generator gets trained on more images it starts generating better images and the discriminator also starts getting better because it does not want its loss to get high while classifying fake or real images. So this is exactly why both discriminator and generator are in a game against each other if one gets better the other also needs to improve.", "After training, we just use the Discriminator and discard the Generator because our main aim was to build a classifier for MNIST.", "So, the accuracy obtained on the test set is approx 90.67 % which is quite impressive given the fact that we have just used 100 labeled images (10 per class) to train our discriminator. So, this is a powerful classifier which does not need lots of labeled data. Of course, performance will improve even more if we use say 1000 labeled images which are still quite low compared to modern datasets.", "So, these are the fake images generated by the generator which are quite realistic with few exceptions.You can also try training the same discriminator model without the GAN on 100 labeled images and see how it performs. It will be no doubt worse than the Discriminator trained with GAN.", "This is the Github Repo Linked to this implemenatation", "If you want to learn more about GAN\u2019s you can try reading this book GANs in Action Deep learning with Generative Adversarial Networks by Jakub Langr, Vladimir Bok.", "This is my first article on Medium, please let me know if you like it. Thanks for Reading!.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Enjoying in this fascinating world of Data Science. Let\u2019s connect on LinkedIn https://www.linkedin.com/in/kunal-vaidya-0bab51198/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F195a1b2c3ea6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kunalvaidya-58402.medium.com/?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": ""}, {"url": "https://kunalvaidya-58402.medium.com/?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": "Kunal Vaidya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe919dc869e73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&user=Kunal+Vaidya&userId=e919dc869e73&source=post_page-e919dc869e73----195a1b2c3ea6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F195a1b2c3ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F195a1b2c3ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mohamadaz?utm_source=medium&utm_medium=referral", "anchor_text": "mohammad alizade"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/KunalVaidya99/Semi-Supervised-GAN", "anchor_text": "https://github.com/KunalVaidya99/Semi-Supervised-GAN"}, {"url": "https://arxiv.org/pdf/1606.01583.pdf", "anchor_text": "https://arxiv.org/pdf/1606.01583.pdf"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----195a1b2c3ea6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/generative-adversarial?source=post_page-----195a1b2c3ea6---------------generative_adversarial-----------------", "anchor_text": "Generative Adversarial"}, {"url": "https://medium.com/tag/keras?source=post_page-----195a1b2c3ea6---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F195a1b2c3ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&user=Kunal+Vaidya&userId=e919dc869e73&source=-----195a1b2c3ea6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F195a1b2c3ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&user=Kunal+Vaidya&userId=e919dc869e73&source=-----195a1b2c3ea6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F195a1b2c3ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F195a1b2c3ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----195a1b2c3ea6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----195a1b2c3ea6--------------------------------", "anchor_text": ""}, {"url": "https://kunalvaidya-58402.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kunalvaidya-58402.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kunal Vaidya"}, {"url": "https://kunalvaidya-58402.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "16 Followers"}, {"url": "https://www.linkedin.com/in/kunal-vaidya-0bab51198/", "anchor_text": "https://www.linkedin.com/in/kunal-vaidya-0bab51198/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe919dc869e73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&user=Kunal+Vaidya&userId=e919dc869e73&source=post_page-e919dc869e73--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faacd8ce91131&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementation-of-semi-supervised-generative-adversarial-networks-in-keras-195a1b2c3ea6&newsletterV3=e919dc869e73&newsletterV3Id=aacd8ce91131&user=Kunal+Vaidya&userId=e919dc869e73&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}