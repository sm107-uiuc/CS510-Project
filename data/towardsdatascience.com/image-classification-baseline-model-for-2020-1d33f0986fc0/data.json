{"url": "https://towardsdatascience.com/image-classification-baseline-model-for-2020-1d33f0986fc0", "time": 1683010051.942358, "path": "towardsdatascience.com/image-classification-baseline-model-for-2020-1d33f0986fc0/", "webpage": {"metadata": {"title": "Image Classification Baseline Model For 2020 | by Sanjeev Suresh | Towards Data Science", "h1": "Image Classification Baseline Model For 2020", "description": "Computer vision has been there since the 1950s but it is only in the last decade that the field totally transformed itself(in fact the special moment happened in 2012 when AlexNet won the ImageNet\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/AlexNet", "anchor_text": "AlexNet", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/ImageNet#ImageNet_Challenge", "anchor_text": "ImageNet", "paragraph_index": 1}, {"url": "https://docs.fast.ai/vision.html", "anchor_text": "docs", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1506.01186", "anchor_text": "Cyclical Learning Rate", "paragraph_index": 10}, {"url": "https://benchmarks.ai/cifar-10", "anchor_text": "benchmarks", "paragraph_index": 19}, {"url": "https://colab.research.google.com/drive/1dj03Y-IxLcxCULFLq6nTge3wFcqmRj_S?usp=sharing", "anchor_text": "notebook", "paragraph_index": 21}], "all_paragraphs": ["Have some basic idea and just here for a snippet of code to build your baseline model? Use this:", "Computer vision has been there since the 1950s but it is only in the last decade that the field totally transformed itself(in fact the special moment happened in 2012 when AlexNet won the ImageNet challenge).", "A lot of powerful frameworks have come up in the last few years. We are going to use fastai since, at the time of writing, it offers the easiest APIs and strongest defaults. It\u2019s a high-level wrapper over PyTorch. Our aim is to build a general-purpose image classification baseline by 2020 standards.", "Let\u2019s use the popular CIFAR-10 dataset which contains 60,000 32x32 color images in 10 different classes. It\u2019s divided into 50,000 training examples and 10,000 test examples. The CIFAR dataset is already provided as a sample dataset in the fastai library.", "Let\u2019s start with a minimal example straight from the docs and modify it as we go along", "Let\u2019s break down the 3 most important things happening here:", "We are getting about 70% accuracy at this point after training for 3 epochs.", "The ResNet was originally trained on 224x224 images and our dataset has 32x32 images. If you use input images that are too different from the original size, then it is not optimal for the model. Let\u2019s see the effect on accuracy once we resize these images to 128x128. ImageDataBunch API lets you pass in a size.", "The accuracy shoots up to 94%. We have already reached about human-level performance on this task. We could\u2019ve resized to 224x224 as well but that\u2019ll increase the training time and also since these are quite low-resolution images, it might leave artifacts when we scale up a lot. You can experiment with this later, as needed, once you have a baseline.", "Learning Rate is often the most important hyper-parameter to tune when training neural networks. It affects the rate at which the weights of the network are modified with each training batch. A very small learning rate can lead to slow training. A very large learning rate, on the other hand, can cause the loss function to fluctuate around the minimum or even diverge. Traditionally, it is a hyperparameter tuned and set using grid-search with optional formulas that decrease the learning rate using a particular strategy (like Time-Based Decay, Step Decay, etc).", "Leslie Smith, in 2015, came up with a new method for setting the learning rates called Cyclical Learning Rate(CLR). Instead of monotonically decreasing the learning rate, this method lets the learning rate cyclically vary between reasonable boundary values. This eliminates the need to find the best value for the learning rate. Fastai has an implementation of one-cycle CLR policy in which the learning rate starts at a low value, increases to a very large value, and then decreases to a value much lower than its initial one.", "Fastai also comes with a handy method to estimate the maximum learning rate to be used in the one-cycle policy. For this, it begins to train the model while increasing the learning rate from a very low value to a very large one. Initially, the losses come down but as the learning rate keeps going up, the losses start to increase. When the loss is around the minimum, the learning rate is already too high. A rule of thumb is to set the maximum learning rate to be an order of magnitude less than the minimum.", "Here you can try setting the learning rate between 1e-03 and 1-e02. For now, we\u2019ll just use 1e-03.", "We get to about 95% accuracy on the validation set now in 3 epochs.", "We earlier trained only the new randomly initialized head of our model, keeping the weights of the body frozen. We can now unfreeze the body and train the whole network. Let\u2019s use lr_find and estimate the new learning rate to use before we do that.", "The training curve seems to have shifted by an order of magnitude from the previous one and looks like 1e-4 seems like a reasonable training rate. Unlike before, we may not want to use the same maximum learning rate for all the layers in the body. We may instead want to use discriminative learning rates, where earlier layers get much smaller learning rates. The idea again is that earlier layers would learn more basic features like edges(which is useful for your new task also) and later layers would learn more complex features(like maybe recognize heads which may not necessarily be useful for your new task). Fastai lets you send a slice, where the first value would be used as the learning rate of first layers, the second value would be the learning rate of the final layer and the layers in between would have values in between.", "We can see that the accuracy is still improving.", "One final thing that you can do for your general-purpose benchmark is Test Time Augmentation(TTA). TTA is done on the test/validation set to improve the prediction quality \u2014 it involves first creating multiple versions of each image using data augmentation, and then we pass those through our trained model to get multiple predictions and finally we take the average of those predictions to get the final prediction. TTA often gives us a better performance without needing any additional training but it takes a hit on the final prediction time.", "We reached over 96% accuracy. That\u2019s great. Another simple thing that could improve our accuracy is just training and fine-tuning simply for more epochs. But let\u2019s stop here for now.", "Check out the state of the art benchmarks achieved on CIFAR-10. Above 96% is only something achieved in the last couple of years. Most of the models there are trained for a significantly longer time, using more resources than a collab notebook and having more parameters \u2014 hence we can be confident that our 96% for this general-purpose image classification is really good.", "One of the most useful things you can do at the beginning of a new machine learning project is establishing a baseline. For image classification, fastai helps you to create a strong baseline quickly with almost no hyperparameter tuning.", "You can find the complete code used for this post in this colab notebook. Feel free to play around with it and use it in your projects. I\u2019d love to discuss if you have any thoughts or questions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1d33f0986fc0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sanjeevsuresh.medium.com/?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": ""}, {"url": "https://sanjeevsuresh.medium.com/?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": "Sanjeev Suresh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3a054120b3c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&user=Sanjeev+Suresh&userId=3a054120b3c9&source=post_page-3a054120b3c9----1d33f0986fc0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d33f0986fc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d33f0986fc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/AlexNet", "anchor_text": "AlexNet"}, {"url": "https://en.wikipedia.org/wiki/ImageNet#ImageNet_Challenge", "anchor_text": "ImageNet"}, {"url": "https://pixabay.com/users/Gellinger-201217/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2198994", "anchor_text": "Gerhard Gellinger"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2198994", "anchor_text": "Pixabay"}, {"url": "https://docs.fast.ai/vision.html", "anchor_text": "docs"}, {"url": "https://docs.google.com/document/d/1llqIWIsCKbTF-apBBXxAsh5yKz8XAX-HwSIN_xU844s/edit#heading=h.ew127o18zyqq", "anchor_text": "ImageDatabunch API"}, {"url": "https://docs.fast.ai/data_block.html", "anchor_text": "DataBlock API"}, {"url": "https://arxiv.org/abs/1506.01186", "anchor_text": "Cyclical Learning Rate"}, {"url": "https://benchmarks.ai/cifar-10", "anchor_text": "benchmarks"}, {"url": "https://colab.research.google.com/drive/1dj03Y-IxLcxCULFLq6nTge3wFcqmRj_S?usp=sharing", "anchor_text": "notebook"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1d33f0986fc0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----1d33f0986fc0---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1d33f0986fc0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/fastai?source=post_page-----1d33f0986fc0---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----1d33f0986fc0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1d33f0986fc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&user=Sanjeev+Suresh&userId=3a054120b3c9&source=-----1d33f0986fc0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1d33f0986fc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&user=Sanjeev+Suresh&userId=3a054120b3c9&source=-----1d33f0986fc0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d33f0986fc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1d33f0986fc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1d33f0986fc0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1d33f0986fc0--------------------------------", "anchor_text": ""}, {"url": "https://sanjeevsuresh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sanjeevsuresh.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sanjeev Suresh"}, {"url": "https://sanjeevsuresh.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27 Followers"}, {"url": "https://www.linkedin.com/in/sanjeevsuresh/", "anchor_text": "https://www.linkedin.com/in/sanjeevsuresh/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3a054120b3c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&user=Sanjeev+Suresh&userId=3a054120b3c9&source=post_page-3a054120b3c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F3a054120b3c9%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-baseline-model-for-2020-1d33f0986fc0&user=Sanjeev+Suresh&userId=3a054120b3c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}