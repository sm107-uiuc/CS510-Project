{"url": "https://towardsdatascience.com/neural-fictitious-self-play-in-practice-132836b69bf5", "time": 1683004397.362179, "path": "towardsdatascience.com/neural-fictitious-self-play-in-practice-132836b69bf5/", "webpage": {"metadata": {"title": "Neural Fictitious Self-Play in Practice | by Ziad SALLOUM | Towards Data Science", "h1": "Neural Fictitious Self-Play in Practice", "description": "Update: The best way of learning and practicing Reinforcement Learning is by going to http://rl-lab.com This article describes an implementation of Neural Fictitious Self-Play (NFSP) in Leduc Hold\u2019em\u2026"}, "outgoing_paragraph_urls": [{"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com", "paragraph_index": 0}, {"url": "https://github.com/EricSteinberger", "anchor_text": "Eric Steinberger", "paragraph_index": 1}, {"url": "https://github.com/EricSteinberger/Neural-Fictitous-Self-Play", "anchor_text": "Github repository", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/introduction-to-fictitious-play-12a8bc4ed1bb", "anchor_text": "Introduction to Fictitious Play", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/fictitious-self-play-30b76e30ec6a?source=your_stories_page---------------------------", "anchor_text": "Fictitious Self Play", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/neural-fictitious-self-play-800612b4a53f", "anchor_text": "Neural Fictitious Self-Play", "paragraph_index": 2}, {"url": "https://github.com/lifrordi/DeepStack-Leduc", "anchor_text": "DeepStack-Leduc", "paragraph_index": 5}, {"url": "http://poker.cs.ualberta.ca/publications/UAI05.pdf", "anchor_text": "Bayes\u2019 Bluff: Opponent Modeling in Poker", "paragraph_index": 6}, {"url": "https://github.com/EricSteinberger", "anchor_text": "Eric Steinberger", "paragraph_index": 12}, {"url": "https://pdfs.semanticscholar.org/7a33/0ac108ec90f405efb4ce3bec158566c1d9db.pdf", "anchor_text": "slides", "paragraph_index": 14}, {"url": "https://github.com/EricSteinberger", "anchor_text": "Eric Steinberger", "paragraph_index": 15}, {"url": "https://github.com/EricSteinberger/Neural-Fictitous-Self-Play", "anchor_text": "source code here", "paragraph_index": 15}, {"url": "https://github.com/EricSteinberger", "anchor_text": "Eric Steinberger", "paragraph_index": 16}, {"url": "https://medium.com/u/7e968a07c09e?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "Arman Didandeh", "paragraph_index": 16}], "all_paragraphs": ["Update: The best way of learning and practicing Reinforcement Learning is by going to http://rl-lab.com", "This article describes an implementation of Neural Fictitious Self-Play (NFSP) in Leduc Hold\u2019em Poker Game, based on code by Eric Steinberger. The full source code can be found on his Github repository.", "If you are new to the topic it is better to start with these articles first:Introduction to Fictitious PlayFictitious Self PlayNeural Fictitious Self-Play", "Disclaimer: this article does not aim to explain every bit of detail in the implementation code, but rather to highlight the main axis and the mapping between the implementation of the code and the academic solution.", "The implementation involves distributed computation which adds a level of complexity to the code. However in this article, we will focus on the algorithm per se, and we will bypass the distributed computation aspect.For this purpose, we will do the parallel with the academic algorithm below.", "First, let\u2019s define Leduc Hold\u2019em game. Here is a definition taken from DeepStack-Leduc. It reads:", "Leduc Hold\u2019em is a toy poker game sometimes used in academic research (first introduced in Bayes\u2019 Bluff: Opponent Modeling in Poker). It is played with a deck of six cards, comprising two suits of three ranks each (often the king, queen, and jack \u2014 in our implementation, the ace, king, and queen). The game begins with each player being dealt one card privately, followed by a betting round. Then, another card is dealt faceup as a community (or board) card, and there is another betting round. Finally, the players reveal their private cards. If one player\u2019s private card is the same rank as the board card, he or she wins the game; otherwise, the player whose private card has the higher rank wins.", "The main class is workers\\driver\\Driver.py which has a method run() that sets everything in motion.It sets the main loop and the execution of the algorithm at each iteration, as seen in the following image.", "The bulk of the action happens in the _HighLevelAlgo.py where it is easy to distinguish the different parts of the academic solution.", "Let\u2019s zoom on the play phase.The code does not perfectly map to the academic solution but it is not far from it. It is only reorganized differently.The sampling of the action a(t) happens in the class SeatActor class. You can think of the SeatActor as the player. There are more than one.", "On the other hand, PockerEnv.py (PokerRL\\game\\_\\rl_env\\base) is in fact the game engine, where the game dynamics and rules are executed. Each time a \u201cplayer\u201d acts in the game, the PockerEnv.step() method is called.", "Finally, the LearnerActor (workers\\la\\local.py) is the class that coordinates the different SeatActors. It contains the play() method that performs calls to several classes and methods of the sequence below:", "According to Eric Steinberger the code has achieved the same result as the academic paper.", "The graph shows the exploitability curve according to the number of NFSP iterations.", "As a reminder, the exploitability is the measure of strategy\u2019s worst-case performance. Introduction to exploitability can be found in these slides.", "This was a quick overview of the implementation of the NFSP in practice as done by Eric Steinberger (check the source code here).It will help you find your way into the code, that has rather a complex structure, and gives you a clear understanding of where the real action is happening.", "Finally, I would like to thank Eric Steinberger for reviewing this article and for sharing his remarks.Another thanks for Arman Didandeh for proof reading the article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F132836b69bf5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----132836b69bf5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zsalloum.medium.com/?source=post_page-----132836b69bf5--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2----132836b69bf5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F132836b69bf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F132836b69bf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@keenangrams?utm_source=medium&utm_medium=referral", "anchor_text": "Keenan Constance"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com"}, {"url": "https://github.com/EricSteinberger", "anchor_text": "Eric Steinberger"}, {"url": "https://github.com/EricSteinberger/Neural-Fictitous-Self-Play", "anchor_text": "Github repository"}, {"url": "https://towardsdatascience.com/introduction-to-fictitious-play-12a8bc4ed1bb", "anchor_text": "Introduction to Fictitious Play"}, {"url": "https://towardsdatascience.com/fictitious-self-play-30b76e30ec6a?source=your_stories_page---------------------------", "anchor_text": "Fictitious Self Play"}, {"url": "https://towardsdatascience.com/neural-fictitious-self-play-800612b4a53f", "anchor_text": "Neural Fictitious Self-Play"}, {"url": "https://arxiv.org/pdf/1603.01121.pdf", "anchor_text": "NFSP Algorithm from Heinrich/Silver paper"}, {"url": "https://github.com/lifrordi/DeepStack-Leduc", "anchor_text": "DeepStack-Leduc"}, {"url": "http://poker.cs.ualberta.ca/publications/UAI05.pdf", "anchor_text": "Bayes\u2019 Bluff: Opponent Modeling in Poker"}, {"url": "https://github.com/EricSteinberger/Neural-Fictitous-Self-Play/blob/master/NFSP/workers/driver/Driver.py", "anchor_text": "Driver.py"}, {"url": "https://github.com/EricSteinberger/Neural-Fictitous-Self-Play/blob/master/NFSP/workers/driver/_HighLevelAlgo.py", "anchor_text": "_HighLevelAlgo.py"}, {"url": "https://github.com/EricSteinberger", "anchor_text": "Eric Steinberger"}, {"url": "https://github.com/EricSteinberger/Neural-Fictitous-Self-Play", "anchor_text": "Exploitability Graph"}, {"url": "https://pdfs.semanticscholar.org/7a33/0ac108ec90f405efb4ce3bec158566c1d9db.pdf", "anchor_text": "slides"}, {"url": "https://github.com/EricSteinberger", "anchor_text": "Eric Steinberger"}, {"url": "https://github.com/EricSteinberger/Neural-Fictitous-Self-Play", "anchor_text": "source code here"}, {"url": "https://github.com/EricSteinberger", "anchor_text": "Eric Steinberger"}, {"url": "https://medium.com/u/7e968a07c09e?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "Arman Didandeh"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----132836b69bf5---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----132836b69bf5---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----132836b69bf5---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----132836b69bf5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----132836b69bf5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F132836b69bf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----132836b69bf5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F132836b69bf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----132836b69bf5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F132836b69bf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F132836b69bf5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----132836b69bf5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----132836b69bf5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----132836b69bf5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----132836b69bf5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----132836b69bf5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----132836b69bf5--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://zsalloum.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "845 Followers"}, {"url": "https://rl-lab.com", "anchor_text": "https://rl-lab.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F408fc441c93b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-fictitious-self-play-in-practice-132836b69bf5&newsletterV3=1f2b933522e2&newsletterV3Id=408fc441c93b&user=Ziad+SALLOUM&userId=1f2b933522e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}