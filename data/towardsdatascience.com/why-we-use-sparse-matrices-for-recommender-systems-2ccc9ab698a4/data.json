{"url": "https://towardsdatascience.com/why-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4", "time": 1683007045.920177, "path": "towardsdatascience.com/why-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4/", "webpage": {"metadata": {"title": "Why We Use Sparse Matrices for Recommender Systems | by David Chong | Towards Data Science", "h1": "Why We Use Sparse Matrices for Recommender Systems", "description": "In recommender systems, we typically work with very sparse matrices as the item universe is very large while a single user typically interacts with a very small subset of the item universe. Take\u2026"}, "outgoing_paragraph_urls": [{"url": "https://davidcjw.medium.com/membership", "anchor_text": "here", "paragraph_index": 21}, {"url": "https://rushter.com/blog/scipy-sparse-matrices/", "anchor_text": "Sparse data structures in Python", "paragraph_index": 22}, {"url": "http://bit.ly/3CmUbUf;", "anchor_text": "bit.ly/3CmUbUf;", "paragraph_index": 24}, {"url": "http://tinyurl.com/2rk9ub8k;", "anchor_text": "tinyurl.com/2rk9ub8k;", "paragraph_index": 24}, {"url": "http://tinyurl.com/davidcjw", "anchor_text": "tinyurl.com/davidcjw", "paragraph_index": 24}], "all_paragraphs": ["In recommender systems, we typically work with very sparse matrices as the item universe is very large while a single user typically interacts with a very small subset of the item universe. Take YouTube for example \u2014 a user typically watches hundreds if not thousands of videos, compared to the millions of videos YouTube has in its corpus, resulting in sparsity of >99%.", "This means that when we represent the users (as rows) and items (as columns) in a matrix, the result is an extremely sparse matrix consisting of many zero values (see below).", "In a real-life scenario, how do we best represent such a sparse user-item interaction matrix?", "Why can\u2019t we just use Numpy Arrays or Pandas DataFrames?", "To understand this, we have to understand the two major constraints on computing \u2014 time and memory. The former is simply what we know as \u201chow much time a program takes to run\u201d whereas the latter is \u201chow much RAM is being used by the program\u201d. The former is quite straightforward but as for the latter, making sure our program doesn\u2019t consume all our memory is important especially when we deal with large datasets, otherwise we would encounter the famous \u201cout-of-memory\u201d error.", "Yes, every program and application on our PC uses some memory (see below image). When we run matrix computations and we want to store those sparse matrices as a Numpy array or Pandas DataFrame, they consume memory as well.", "To formalize these two constraints, they are known as time and space complexity (memory).", "When dealing with sparse matrices, storing them as a full matrix (from this point referred to as a dense matrix) is simply inefficient. This is because a full array occupies a block of memory for each entry, so a n x m array requires n x m blocks of memory. From a simple logic standpoint, it simply doesn\u2019t make sense to store so many zeros!", "In addition to space complexity, dense matrices exacerbate our runtimes as well. We shall illustrate using an example below.", "How then do we represent these matrices?", "In Python, sparse data structures are efficiently implemented in the scipy.sparse module, which are mostly based on Numpy arrays. The idea behind the implementation is simple: Instead of storing all values in a dense matrix, let\u2019s just store the non-zero values in some format (e.g. using their row and column indices).", "Before we dive into what CSR is, let\u2019s compare the efficiency difference in using numpy arrays versus sparse matrices in both time and space complexity.", "We then time these different matrices stored in these different forms and also how much memory they use.", "Clearly, the best performance in terms of both time and space is obtained when we store a sparse matrix with the sparse module.", "Even though there are many types of sparse matrices in SciPy such as Dictionary of Keys (DOK) and List of List (LIL), I will only touch on Compressed Sparse Rows (CSR) because it is the most used and widely known format.", "CSR (and also CSC, a.k.a. compressed sparse column) is used for write-once-read-many tasks [1]. To efficiently represent a sparse matrix, CSR uses three numpy arrays to store some relevant information, including:", "Create a full matrix and convert it to a sparse matrix", "As seen earlier, this method is not efficient because we have to first obtain this dense matrix which is very memory consuming, before we can convert it into a sparse matrix.", "Note that we should not create an empty sparse matrix and populate them subsequently because the csr_matrix is designed to write-once-read-many. Writing to the csr_matrix will be inefficient and one should consider other types of sparse matrices like List of lists that is more efficient at manipulating the sparsity structure.", "Create a sparse matrix with data", "Hope this was helpful in getting you kick-started in using sparse matrices!", "Support me! \u2014 If you like my content and are not subscribed to Medium, do consider supporting me and subscribing via my referral link here (NOTE: a portion of your membership fees will be apportioned to me as referral fees).", "[1] Sparse data structures in Python", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer @ Gojek; Closet n3rd; Avid investor; LinkedIn \u2192 bit.ly/3CmUbUf; Medium \u2014 tinyurl.com/2rk9ub8k; Support me \u2192 tinyurl.com/davidcjw"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2ccc9ab698a4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://davidcjw.medium.com/?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": ""}, {"url": "https://davidcjw.medium.com/?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": "David Chong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff392dd76f846&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&user=David+Chong&userId=f392dd76f846&source=post_page-f392dd76f846----2ccc9ab698a4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ccc9ab698a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ccc9ab698a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nordwood?utm_source=medium&utm_medium=referral", "anchor_text": "NordWood Themes"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://apple.stackexchange.com/questions/158639/your-system-has-run-out-of-application-memory-how-is-that-possible", "anchor_text": "alessandro308"}, {"url": "https://stackoverflow.com/questions/52299420/scipy-csr-matrix-understand-indptr", "anchor_text": "Tanguy"}, {"url": "https://davidcjw.medium.com/membership", "anchor_text": "here"}, {"url": "https://rushter.com/blog/scipy-sparse-matrices/", "anchor_text": "Sparse data structures in Python"}, {"url": "http://www.acme.byu.edu/wp-content/uploads/2015/11/Vol1Lab4Complexity.pdf", "anchor_text": "Complexity and Sparse Matrices"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2ccc9ab698a4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----2ccc9ab698a4---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----2ccc9ab698a4---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/scipy?source=post_page-----2ccc9ab698a4---------------scipy-----------------", "anchor_text": "Scipy"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2ccc9ab698a4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2ccc9ab698a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&user=David+Chong&userId=f392dd76f846&source=-----2ccc9ab698a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2ccc9ab698a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&user=David+Chong&userId=f392dd76f846&source=-----2ccc9ab698a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ccc9ab698a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2ccc9ab698a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2ccc9ab698a4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2ccc9ab698a4--------------------------------", "anchor_text": ""}, {"url": "https://davidcjw.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://davidcjw.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "David Chong"}, {"url": "https://davidcjw.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.5K Followers"}, {"url": "http://bit.ly/3CmUbUf;", "anchor_text": "bit.ly/3CmUbUf;"}, {"url": "http://tinyurl.com/2rk9ub8k;", "anchor_text": "tinyurl.com/2rk9ub8k;"}, {"url": "http://tinyurl.com/davidcjw", "anchor_text": "tinyurl.com/davidcjw"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff392dd76f846&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&user=David+Chong&userId=f392dd76f846&source=post_page-f392dd76f846--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F125267d6c78d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-we-use-sparse-matrices-for-recommender-systems-2ccc9ab698a4&newsletterV3=f392dd76f846&newsletterV3Id=125267d6c78d&user=David+Chong&userId=f392dd76f846&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}