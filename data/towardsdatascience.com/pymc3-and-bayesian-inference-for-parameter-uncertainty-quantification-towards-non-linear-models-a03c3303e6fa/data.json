{"url": "https://towardsdatascience.com/pymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa", "time": 1683008604.4938262, "path": "towardsdatascience.com/pymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa/", "webpage": {"metadata": {"title": "PyMC3 and Bayesian inference for Parameter Uncertainty Quantification Towards Non-Linear Models: Part 2 | by Adam Watts | Towards Data Science", "h1": "PyMC3 and Bayesian inference for Parameter Uncertainty Quantification Towards Non-Linear Models: Part 2", "description": "In part 2 of this series, we are going to dive right into PyMC3 and learn how to apply it for uncertainty quantification (UQ) towards a non-linear model. For validation, we will also see how the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@aldburg/pymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a", "anchor_text": "part 1", "paragraph_index": 0}, {"url": "https://elevanth.org/blog/2017/11/28/build-a-better-markov-chain/", "anchor_text": "webpage", "paragraph_index": 10}], "all_paragraphs": ["In part 2 of this series, we are going to dive right into PyMC3 and learn how to apply it for uncertainty quantification (UQ) towards a non-linear model. For validation, we will also see how the Bayesian methods compare to the frequentist approach for parameter UQ. I\u2019m going to assume you already optimized the parameters for your model. The model I will be using comes from part 1 of this series.", "The libraries we will be using in this series are listed:", "For those skipping to part 1 to here, or those that need a refresher from part 1, the nonlinear model is the solution to a first-order transient thermal response of a lumped-capacitance object (what a mouthful).", "We are assuming T_0 = 100C and T_env = 30C. We were trying to estimate the uncertainty in the cooling parameter \u03c4 and in the model. Our every-day example of this problem was the cooling of a well-insulated hot drink!", "To begin our Bayesian inference on the UQ for the model parameters we first create a Model using PyMC3, here I called it \u201cmodel_g\u201d in line 1.", "To quote Therese Donovan and Ruth M. Micket [1],", "\u201cYou cannot conduct a Bayesian analysis without using a prior distribution\u201d.", "Here our prior is P(\u03c4, \u03f5), we will decompose this prior into two priors, one for each parameter. While we don\u2019t know much or have much prior knowledge about the distribution of \u03c4. We can, however, provide a weakly-informative prior [2]. By simply plotting different values of \u03c4 we can see that \u03c4 must be bounded. We will assume a uniform distribution for \u03c4 with a lower bound of 0 and upper bound of 100. We can see that this easily covers the possible values for this problem, and then some. From part 1, we found the optimal parameter for \u03c4 was 14.93 which visually makes sense from the plot.", "The next prior we need is that of the standard deviation of the error, \u03f5. We know that this parameter cannot be less than 0 since the standard deviation is always greater to or equal to 0. A Half-Normal distribution seems fitting for the prior distribution for \u03f5. Once again we pick a weakly-informed prior by picking a Half-Normal distribution with a scale value of 5. I am using \u03f5 instead of \u03c3 that was used in part 1 to avoid confusion with the sigma term also used to scale our Half-Normal distribution", "Combing everything together, line 5 describes that the predicted temperature \u201cT_pred\u201d comes from a Normal distribution with a mean value (\u03bc)using our nonlinear Newton\u2019s cooling function. This model is our likelihood and represents P(data| \u03c4, \u03f5 ). We also let the PyMC3 know that the standard deviation for our model is the prior distribution for \u03f5. Lastly, our final argument we pass is the observed \u201cexperimental\u201d temperature data.", "Using line 8, we let PyMC3 do the heavy lifting by drawing 2000 posterior, samples, using NUTS sampling. I highly, highly recommend checking out Richard\u2019s McElreath\u2019s webpage on sampling algorithms. We are often unable to explicitly solve for the numerator in the Bayesian framework equation above, thus we must use a sampling algorithm to help us explore it.", "Once the sampling is performed, we can retrieve a summary", "In part 1, we found \u03c4_opt = 14.93 and the estimate for \u03c3 =1.42. Looking at the table above, it makes sense that the mean value from our sampling methods also provides very similar results. The optimization we did previously also allows us to check our Bayesian inference.", "Using the code above we can generate a joint plot by sampling out of our posterior, P(\u03c4, \u03f5 | data).", "We can also get a trace plot to verify that our sampling didn\u2019t get stuck and that our sampling is exploring the parameter space sufficiently. We want, \u201cfuzzy caterpillar\u201d like traces.", "We can also get the highest posterior density (HPD) for our parameters by using the following method, here we selected 99%.", "If there was no noise, our mean values would perfectly be equal to the \u201cunknown\u201d parameters. Since there is noise, just like real data, there is uncertainty in the values of our parameters and we need to quantify the uncertainty in them.", "From part 1, the real value were \u03c4=15 and \u03c3=1.5. Not only are the mean posteriors close to these values, but the HPD easily envelopes the real values, exactly what we wanted.", "One of the benefits of Bayesian inference is that besides calculating the mean values of our parameters, we also get distributions for our parameters as shown above. UQ of our non-linear model is as easy as sampling from our distribution which was done above in the sample_posterior.py, and below for clarity, with the method", "Calculating uncertainty in our model from not only the parameters but also the data was done by sampling from our posterior. Generating quantiles from our posterior predictions is extremely easy using the percentile method in NumPy.", "Putting this all together, let us plot not only the mean posterior response but also the 95% posterior predictions.", "If we want to validate our Bayesian inference, we should also compare our results with a frequentist approach. This will require a little more manual computation since the model is non-linear, but it shouldn\u2019t be too difficult with the libraries we will be using.", "First, we will need to construct a sensitivity matrix for the model, \u201cgrad_newton_values\u201d. Since there is only 1 parameter in the model, this matrix is just a column vector. We will be using the autograd library to auto-differentiate the model with respect to \u03c4.", "The model error \u03b4_k can be calculated from our sensitivity array. With \u03b4_k, t-inverse value (1.99), and our estimate for \u03c3 from part 1 (1.42), we can calculate the confidence intervals for the parameter \u03c4 [3].", "We find that with a 95% confidence interval that \u03c4 is between 14.571 and 15.292. Extremely close to the Bayesian method!", "Next, we want to compare UQ propagation in our model between the Bayesian and Frequentist methods. This includes uncertainty in our model parameters and data. Below I generated confidence and prediction intervals for our non-linear model.", "I plotted the Bayesian posterior prediction at 95% with star hatches and the 95% Frequentist prediction intervals as solid light purple. The two methods almost perfectly overlap as the star hatches can be seen underneath the purple shaded region. We see at the very boundary, the tiniest of green. It looks like our Bayesian approach agrees with the frequentist approach.", "From these predictions, we can provide uncertainty in the temperature of our drink as a function of time. For example at 25 minutes, we expect the if we ran the experiment multiple times, that the majority of hot drinks to be between 40C and about 45C with a certainty of 95%.", "We have performed UQ on the estimation of the parameters but also on the model itself. We have found how powerful the PyMC3 library is for working with non-linear models and how well it integrates into Python. Bayesian methods allow for an immense amount of freedom in how we develop and design our models. We could change our likelihood or temperature model from a normal distribution to another parametric model if needed. The procedure wouldn\u2019t change much with PyMC3.", "[1] T. Donovan and R. M. Mickey, Bayesian Statistics for Beginners: a step-by-step approach. Oxford University Press.", "[2] O. Martin, Bayesian Analysis with Python: Introduction to statistical modeling and probabilistic programming using PyMC3 and ArviZ, 2nd Edition. Packt Publishing Ltd, 2018.", "[3] R. C. Smith, Uncertainty Quantification: Theory, Implementation, and Applications. SIAM, 2013.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am an engineer and Ph.D. student at North Carolina State University. My passion is combining the field of data science with traditional engineering."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa03c3303e6fa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aldburg?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aldburg?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": "Adam Watts"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5577d2680e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&user=Adam+Watts&userId=a5577d2680e0&source=post_page-a5577d2680e0----a03c3303e6fa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa03c3303e6fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa03c3303e6fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@aldburg/pymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a", "anchor_text": "part 1"}, {"url": "https://elevanth.org/blog/2017/11/28/build-a-better-markov-chain/", "anchor_text": "webpage"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----a03c3303e6fa---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/nonlinear-models?source=post_page-----a03c3303e6fa---------------nonlinear_models-----------------", "anchor_text": "Nonlinear Models"}, {"url": "https://medium.com/tag/uncertainty?source=post_page-----a03c3303e6fa---------------uncertainty-----------------", "anchor_text": "Uncertainty"}, {"url": "https://medium.com/tag/parameter?source=post_page-----a03c3303e6fa---------------parameter-----------------", "anchor_text": "Parameter"}, {"url": "https://medium.com/tag/pymc3?source=post_page-----a03c3303e6fa---------------pymc3-----------------", "anchor_text": "Pymc3"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa03c3303e6fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&user=Adam+Watts&userId=a5577d2680e0&source=-----a03c3303e6fa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa03c3303e6fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&user=Adam+Watts&userId=a5577d2680e0&source=-----a03c3303e6fa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa03c3303e6fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa03c3303e6fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a03c3303e6fa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a03c3303e6fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aldburg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aldburg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adam Watts"}, {"url": "https://medium.com/@aldburg/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5577d2680e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&user=Adam+Watts&userId=a5577d2680e0&source=post_page-a5577d2680e0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2fdd7ba74e7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa&newsletterV3=a5577d2680e0&newsletterV3Id=2fdd7ba74e7f&user=Adam+Watts&userId=a5577d2680e0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}