{"url": "https://towardsdatascience.com/dockerizing-airflow-58a8888bd72d", "time": 1682993536.2326038, "path": "towardsdatascience.com/dockerizing-airflow-58a8888bd72d/", "webpage": {"metadata": {"title": "Dockerizing Airflow. Apache Airflow on Docker for local\u2026 | by Shah Newaz Khan | Towards Data Science", "h1": "Dockerizing Airflow", "description": "Airflow is the de facto ETL orchestration tool in most data engineers tool box. It provides an intuitive web interface for a powerful backend to schedule and manage dependencies for your ETL\u2026"}, "outgoing_paragraph_urls": [{"url": "https://airflow.apache.org/", "anchor_text": "Airflow", "paragraph_index": 0}, {"url": "https://aws.amazon.com/s3/", "anchor_text": "AWS S3", "paragraph_index": 1}, {"url": "https://aws.amazon.com/emr/", "anchor_text": "EMR Apache Spark", "paragraph_index": 1}, {"url": "https://aws.amazon.com/fargate/", "anchor_text": "Fargate", "paragraph_index": 1}, {"url": "https://www.docker.com/", "anchor_text": "Dockerize", "paragraph_index": 3}, {"url": "https://airflow.apache.org/concepts.html#workflows", "anchor_text": "work-flows", "paragraph_index": 3}, {"url": "https://airflow.apache.org/concepts.html#workflows", "anchor_text": "work-flows", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Directed_acyclic_graph", "anchor_text": "directed acyclic graphs", "paragraph_index": 5}, {"url": "https://airflow.apache.org/concepts.html#dags", "anchor_text": "Airflow DAG", "paragraph_index": 5}, {"url": "https://airflow.apache.org/start.html", "anchor_text": "started", "paragraph_index": 6}], "all_paragraphs": ["Airflow is the de facto ETL orchestration tool in most data engineers tool box. It provides an intuitive web interface for a powerful backend to schedule and manage dependencies for your ETL workflows.", "In my day to day work-flow, I use it to maintain and curate a data lake built on top of AWS S3. Nodes in my Airflow DAGs include multi-node EMR Apache Spark and Fargate clusters that aggregate, prune and produce para-data from the data lake.", "Since these work-flows are executed on distributed clusters (20+ nodes) and have heavy dependencies (output from one ETL is fed in as input to the next) it made sense to orchestrate them using Airflow. However it did not make sense to have a central Airflow deployment as I will be the only one using it.", "I therefore chose to Dockerize Airflow so that I could spin up a container and easily run these work-flows without having to worry about the Airflow deployment.", "In this post I will go over how I achieved this along with some brief explanation of design decisions along the way.", "In Airflow ETL work-flows are defined as directed acyclic graphs (Airflow DAG) where each node is a self-contained ETL with each downstream node being dependent on successful completion of the upstream node.", "It is quick and easy to get started with airflow:", "Upon running these commands, Airflow will create the $AIRFLOW_HOME folder and lay an airflow.cfgfile with defaults that get you going fast. You can inspect the file either in $AIRFLOW_HOME/airflow.cfg, or through the UI in the Admin->Configuration menu. The PID file for the webserver will be stored in $AIRFLOW_HOME/airflow-webserver.pid or in /run/airflow/webserver.pid if started by systemd.", "Out of the box, Airflow uses a sqlite database, which you should outgrow fairly quickly since no parallelization is possible using this database backend. It works in conjunction with the SequentialExecutor which will only run task instances sequentially. While this is very limiting, it allows you to get up and running quickly and take a tour of the UI and the command line utilities.", "Here are a few commands that will trigger a few task instances. You should be able to see the status of the jobs change in the example1 DAG as you run the commands below.", "A container\u2019s main running process is the ENTRYPOINT and/or CMD at the end of the Dockerfile. It is generally recommended that you separate areas of concern by using one service per container.", "However since we want to have the Airflow Webserver & the Airflow Scheduler processes both running, we will usesupervisord as a process manager.", "This is a moderately heavy-weight approach that requires you to package supervisord and its configuration in the docker image (or base your image on one that includes supervisord), along with the different applications it manages.", "Then you start supervisord, which manages your processes for you. First we will need to define supervisord.conf :", "Then we will use supervisord as the ENTRYPOINT to our Dockerfile:", "Open a browser and navigate to http://localhost:8080 to monitor the DAG instance run.", "That\u2019s all folks, stay tuned to future posts where I will go into defining AWS EMR dags, defining custom Airflow Operators, injecting AWS Credentials and more!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science enthusiast & cloud infrastructure integration expert with a keen interest in all things information technology related!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F58a8888bd72d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shahnewazk?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shahnewazk?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": "Shah Newaz Khan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F375467dbf668&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&user=Shah+Newaz+Khan&userId=375467dbf668&source=post_page-375467dbf668----58a8888bd72d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58a8888bd72d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58a8888bd72d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@koushikc?utm_source=medium&utm_medium=referral", "anchor_text": "Koushik Chowdavarapu"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://airflow.apache.org/", "anchor_text": "Airflow"}, {"url": "https://aws.amazon.com/s3/", "anchor_text": "AWS S3"}, {"url": "https://aws.amazon.com/emr/", "anchor_text": "EMR Apache Spark"}, {"url": "https://aws.amazon.com/fargate/", "anchor_text": "Fargate"}, {"url": "https://www.docker.com/", "anchor_text": "Dockerize"}, {"url": "https://airflow.apache.org/concepts.html#workflows", "anchor_text": "work-flows"}, {"url": "https://airflow.apache.org/concepts.html#workflows", "anchor_text": "work-flows"}, {"url": "https://en.wikipedia.org/wiki/Directed_acyclic_graph", "anchor_text": "directed acyclic graphs"}, {"url": "https://airflow.apache.org/concepts.html#dags", "anchor_text": "Airflow DAG"}, {"url": "http://flask.pocoo.org/", "anchor_text": "Flask"}, {"url": "https://airflow.apache.org/start.html", "anchor_text": "started"}, {"url": "https://medium.com/tag/docker?source=post_page-----58a8888bd72d---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/tag/apache-airflow?source=post_page-----58a8888bd72d---------------apache_airflow-----------------", "anchor_text": "Apache Airflow"}, {"url": "https://medium.com/tag/data-science?source=post_page-----58a8888bd72d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/etl?source=post_page-----58a8888bd72d---------------etl-----------------", "anchor_text": "Etl"}, {"url": "https://medium.com/tag/aws?source=post_page-----58a8888bd72d---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F58a8888bd72d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&user=Shah+Newaz+Khan&userId=375467dbf668&source=-----58a8888bd72d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F58a8888bd72d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&user=Shah+Newaz+Khan&userId=375467dbf668&source=-----58a8888bd72d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58a8888bd72d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F58a8888bd72d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----58a8888bd72d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----58a8888bd72d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----58a8888bd72d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----58a8888bd72d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----58a8888bd72d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shahnewazk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shahnewazk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shah Newaz Khan"}, {"url": "https://medium.com/@shahnewazk/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "51 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F375467dbf668&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&user=Shah+Newaz+Khan&userId=375467dbf668&source=post_page-375467dbf668--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F85af724fb04e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdockerizing-airflow-58a8888bd72d&newsletterV3=375467dbf668&newsletterV3Id=85af724fb04e&user=Shah+Newaz+Khan&userId=375467dbf668&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}