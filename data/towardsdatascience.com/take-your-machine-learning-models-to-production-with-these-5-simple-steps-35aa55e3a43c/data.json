{"url": "https://towardsdatascience.com/take-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c", "time": 1683001295.240936, "path": "towardsdatascience.com/take-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c/", "webpage": {"metadata": {"title": "Take your Machine Learning Models to Production with these 5 simple steps | by Rahul Agarwal | Towards Data Science", "h1": "Take your Machine Learning Models to Production with these 5 simple steps", "description": "There are a lot of things to consider while building a great machine learning system. But often it happens that we as data scientists only worry about certain parts of the project. I have seen a lot\u2026"}, "outgoing_paragraph_urls": [{"url": "https://click.linksynergy.com/link?id=lVarvwc5BD0&offerid=467035.11421702016&type=2&murl=https%3A%2F%2Fwww.coursera.org%2Flearn%2Fmachine-learning-projects", "anchor_text": "third course", "paragraph_index": 12}, {"url": "https://click.linksynergy.com/deeplink?id=lVarvwc5BD0&mid=40328&murl=https%3A%2F%2Fwww.coursera.org%2Fspecializations%2Fdeep-learning", "anchor_text": "Deep Learning Specialization", "paragraph_index": 12}, {"url": "https://www.wired.com/2012/04/netflix-prize-costs/", "anchor_text": "never", "paragraph_index": 24}, {"url": "https://www.quora.com/What-is-a-teacher-student-model-in-a-Convolutional-neural-network", "anchor_text": "Source", "paragraph_index": 28}, {"url": "https://coursera.pxf.io/7mKnnY", "anchor_text": "third course", "paragraph_index": 39}, {"url": "https://coursera.pxf.io/7mKnnY", "anchor_text": "Deep Learning Specialization", "paragraph_index": 39}, {"url": "https://medium.com/@rahul_agarwal?source=post_page---------------------------", "anchor_text": "Medium", "paragraph_index": 40}, {"url": "http://eepurl.com/dbQnuX?source=post_page---------------------------", "anchor_text": "blog", "paragraph_index": 40}, {"url": "https://twitter.com/MLWhiz?source=post_page---------------------------", "anchor_text": "@mlwhiz", "paragraph_index": 40}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 42}], "all_paragraphs": ["Creating a great machine learning system is an art.", "There are a lot of things to consider while building a great machine learning system. But often it happens that we as data scientists only worry about certain parts of the project.", "But do we ever think about how we will deploy our models once we have them?", "I have seen a lot of ML projects, and a lot of them are doomed to fail as they don\u2019t have a set plan for production from the onset.", "This post is about the process requirements for a successful ML project \u2014 One that goes to production.", "You don\u2019t really have to have a model to get the baseline results.", "Let us say we will be using RMSE as an evaluation metric for our time series models. We evaluated the model on the test set, and the RMSE came out to be 3.64.", "Is 3.64 a good RMSE? How do we know? We need a baseline RMSE.", "This could come from a currently employed model for the same task. Or by using some very simple heuristic. For a Time series model, a baseline to defeat is last day prediction. i.e., predict the number on the previous day.", "Or how about Image classification task. Take 1000 labelled samples and get them classified by humans. And Human accuracy can be your Baseline. If a human is not able to get a 70% prediction accuracy on the task, you can always think of automating a process if your models reach a similar level.", "Learning: Try to be aware of the results you are going to get before you create your models. Setting some out of the world expectations is only going to disappoint you and your client.", "You have created your model now. It performs better than the baseline/your current model on your local test dataset. Should we go forward?", "I am a fan of the second approach. In his awesome\u00a0third course\u00a0named Structuring Machine learning projects in the Coursera\u00a0Deep Learning Specialization, Andrew Ng says \u2014", "\u201cDon\u2019t start off trying to design and build the perfect system. Instead, build and train a basic system quickly \u2014 perhaps in just a few days. Even if the basic system is far from the \u201cbest\u201d system you can build, it is valuable to examine how the basic system functions: you will quickly find clues that show you the most promising directions in which to invest your time.\u201d", "Learning: If your new model is better than the current model in production or your new model is better than the baseline, it doesn\u2019t make sense to wait to go to production.", "Is your model better than the Baseline? It performed better on the local test dataset, but will it really work well on the whole?", "To test the validity of your assumption that your model is better than the existing model, you can set up an A/B test. Some users(Test group)see predictions from your model while some users(Control) see the predictions from the previous model.", "In fact, this is the right way to deploy your model. And you might find that indeed your model is not as good as it seems.", "Being wrong is not wrong really, what\u2019s wrong is to not anticipate that we could be wrong.", "It is hard to point out the real reason behind why your model performs poorly in production settings, but some causes could be:", "Learning: Don\u2019t go into production with a full scale. A/B test is always an excellent way to go forward. Have something ready to fall back upon(An older model perhaps). There might always be things that might break, which you couldn\u2019t have anticipated.", "I have created this impressive ML model, it gives 90% accuracy, but it takes around 10 seconds to fetch a prediction.", "Is that acceptable? For some use-cases maybe, but really no.", "In the past, there have been many Kaggle competitions whose winners ended up creating monster ensembles to take the top spots on the leaderboard. Below is a particular mindblowing example model which was used to win Otto classification challenge on Kaggle:", "Another example is the Netflix Million dollar Recommendation Engine Challenge. The Netflix team ended up\u00a0never\u00a0using the wining solution due to the engineering costs involved.", "So how do you make your models accurate yet easy on the machine?", "Here comes the concept of Teacher-Student models or Knowledge distillation. In Knowledge distillation, we train a smaller student model on a bigger already trained teacher model.", "Here we use the soft labels/probabilities from the teacher model and use it as the training data for the Student model.", "The point is that the teacher is outputting class probabilities \u2014 \u201csoft labels\u201d rather than \u201chard labels\u201d. For example, a fruit classifier might say \u201cApple 0.9, Pear 0.1\u201d instead of \u201cApple 1.0, Pear 0.0\u201d . Why bother? Because these \u201csoft labels\u201d are more informative than the original ones \u2014 telling the student that yes, a particular apple does very slightly resemble a pear. Student models can often come very close to teacher-level performance, even while using 1\u20132 orders of magnitude fewer parameters! \u2014 Source", "Learning: Sometimes, we don\u2019t have a lot of compute available at prediction time, and so we want to have a lighter model. We can try to build simpler models or try using knowledge distillation for such use cases.", "The world is not constant and so are your model weights", "The world around us is rapidly changing, and what might be applicable two months back might not be relevant now. In a way, the models we build are reflections of the world, and if the world is changing our models should be able to reflect this change.", "Model performance deteriorates typically with time.", "For this reason, we must think of ways to upgrade our models as part of the maintenance cycle at the onset itself.", "The frequency of this cycle depends entirely on the business problem that you are trying to solve. In an Ad prediction system where the users tend to be fickle and buying patterns emerge continuously, the frequency needs to be pretty high. While in a review sentiment analysis system, the frequency need not be that high as language doesn\u2019t change its structure quite so much.", "I would also like to acknowledge the importance of the feedback loop in a machine learning system. Let\u2019s say that you predicted that a particular image is a dog with low probability in a dog vs cat classifier. Can we learn something from these low confidence examples? You can send it to manual review to check if it could be used to retrain the model or not. In this way, we train our classifier on instances it is unsure about.", "Learning: When thinking of production, come up with a plan to maintain and improve the model using feedback as well.", "These are some of the things I find important before thinking of putting a model into production.", "While this is not an exhaustive list of things that you need to think about and things that could go wrong, it might undoubtedly act as food for thought for the next time you create your machine learning system.", "If you want to learn more about how to structure a Machine Learning project and the best practices, I would like to call out his excellent third course named Structuring Machine learning projects in the Coursera Deep Learning Specialization. Do check it out.", "Thanks for the read. I am going to be writing more beginner-friendly posts in the future too. Follow me up at\u00a0Medium\u00a0or Subscribe to my\u00a0blog\u00a0to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter\u00a0@mlwhiz", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F35aa55e3a43c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----35aa55e3a43c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35aa55e3a43c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35aa55e3a43c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/lumix2004-3890388/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1873078", "anchor_text": "lumix2004"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1873078", "anchor_text": "Pixabay"}, {"url": "https://click.linksynergy.com/link?id=lVarvwc5BD0&offerid=467035.11421702016&type=2&murl=https%3A%2F%2Fwww.coursera.org%2Flearn%2Fmachine-learning-projects", "anchor_text": "third course"}, {"url": "https://click.linksynergy.com/deeplink?id=lVarvwc5BD0&mid=40328&murl=https%3A%2F%2Fwww.coursera.org%2Fspecializations%2Fdeep-learning", "anchor_text": "Deep Learning Specialization"}, {"url": "https://www.kaggle.com/c/otto-group-product-classification-challenge/discussion/14335", "anchor_text": "Source"}, {"url": "https://www.wired.com/2012/04/netflix-prize-costs/", "anchor_text": "never"}, {"url": "https://towardsdatascience.com/knowledge-distillation-simplified-dd4973dbc764", "anchor_text": "Source"}, {"url": "https://www.quora.com/What-is-a-teacher-student-model-in-a-Convolutional-neural-network", "anchor_text": "Source"}, {"url": "https://www.clarifai.com/blog/closing-the-loop-how-feedback-loops-help-to-maintain-quality-long-term-ai-results", "anchor_text": "Source"}, {"url": "https://coursera.pxf.io/7mKnnY", "anchor_text": "third course"}, {"url": "https://coursera.pxf.io/7mKnnY", "anchor_text": "Deep Learning Specialization"}, {"url": "https://medium.com/@rahul_agarwal?source=post_page---------------------------", "anchor_text": "Medium"}, {"url": "http://eepurl.com/dbQnuX?source=post_page---------------------------", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz?source=post_page---------------------------", "anchor_text": "@mlwhiz"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----35aa55e3a43c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----35aa55e3a43c---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/data-science?source=post_page-----35aa55e3a43c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----35aa55e3a43c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----35aa55e3a43c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F35aa55e3a43c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----35aa55e3a43c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F35aa55e3a43c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----35aa55e3a43c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35aa55e3a43c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F35aa55e3a43c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----35aa55e3a43c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----35aa55e3a43c--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftake-your-machine-learning-models-to-production-with-these-5-simple-steps-35aa55e3a43c&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}