{"url": "https://towardsdatascience.com/k-means-clustering-fa4df5990fff", "time": 1683005138.706676, "path": "towardsdatascience.com/k-means-clustering-fa4df5990fff/", "webpage": {"metadata": {"title": "K-Means Clustering. An overview | by Carter Bouley | Towards Data Science", "h1": "K-Means Clustering", "description": "Most applications of machine learning today are based on supervised learning. However the large majority of data is unlabelled: We have inputs X, but no label Y. Computer scientist Yann LeCunn\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/Carterbouley/kmeans", "anchor_text": "here", "paragraph_index": 27}], "all_paragraphs": ["Most applications of machine learning today are based on supervised learning. However the large majority of data is unlabelled: We have inputs X, but no label Y. Computer scientist Yann LeCunn famously said", "\u2018If intelligence was a cake, unsupervised learning would be the cake, supervised learning would be the icing, and reinforcement learning would be the cherry on top\u2019.", "In other words, there is a huge potential in unsupervised learning.", "One form or unsupervised learning is grouping similar instances together in clusters. Clustering is a great tool for data analysis, customer segmentation, recommendation systems, search engines, semi-supervised learning, dimensionality reduction and more.", "If you wander around a park on your one lockdown walk a day, you may stumble upon a tree you have never seen before. If you look around and notice a few more, which are not identical but are similar enough looking that you know they belong to the same genus. You may need an arborist to tell you which species it is, but you don\u2019t need the expert to just group your trees into similar looking groups. This is the essence of clustering: the task of identifying similar instances, and assigning them into clusters, or groups of similar instances.", "One of the most commonly used clustering techniques is K-means. The K-means algorithm was proposed by Stuart Lloyd and Bell Labs in 1957 as a technique for pulse-code modulation, but only published outside the company in 1982. Edward Forgy published virtually the same algorithm in 1965 so it is referred to as Lloyd-Forgy. The following generates our data which we will cluster:", "K-Means is very efficient at clustering data like the set above, often in very few iterations. It will try to find the centre of each cluster, and assign each instance to the closes cluster. Let\u2019s train a K-Means clutterer:", "Each instance is assigned to one of the five clusters. It receives a label as the index of the cluster it gets assigned to.", "We can also see the five centroids (cluster centres) that the algorithm found:", "We can easily do this for new data too, by seeing which centroid any new data point is closest to. We can also visualise the decision boundaries, and each centroid is represented by X.", "Initially, centroids are placed randomly, instances labelled, and the centroids are updated. This process iterates until the centroids stop moving, and the clusters have been defined.", "Accelerated K-Means is the default for Sklearn. it considerably accelerates this algorithm by keeping track of the lower and upper bounds for the distances between instances and centroids. You can force Sklearn to use the original algorithm, although its unlikely to be needed.", "Instead of using the full dataset at each iteration, the algorithm is capable of using mini-batches, moving the centroid slightly at each iteration. This increases the speed of the algorithm by a factor of 3\u20134 typically. Especially important, it makes it possible to cluster huge datasets that do not fit in memory. One limitation is that its inertia is usually slightly worse, especially as clusters increase, however with many clusters the speed is much faster using mini-batch.", "In this dataset we can see that there are clearly 5 clusters we want to segment from each other. However that is not always the case, and often our data isn\u2019t as obviously segmented as this. Our result can be quite poor if we don\u2019t take precautions to figure out the optimal number of clusters:", "The first thought is to choose the k which minimises inertia, however we cannot do that as inertia will always decrease with a higher k. Indeed, the more clusters there are, the closer each instance will be to its closest centroid, and therefore the lower the inertia will be. As we can see with a k=8, we are splitting clusters for no good reason.", "Inertia drops very quickly up to 5, but then it decreases very slowly afterwards. Any k lower than 5and the gain would be dramatic, and any higher and we are not gaining much more information. This is a rather rough, subjective way of assigning k, however it generally works pretty well. When doing this it allows us to take context of a specific needs of a business problem too.", "However, in this case we could see that there were 5 clusters we wanted to segment. 4 clusters may be adequate but we should investigate the difference between k=4 and k=5", "Another, more precise approach is to use silhouette score for each instance and plot them for different numbers of clusters, however it is more computationally intensive, it will give us a more clear optimal k:", "As we can see, using silhouette score for each level of k, it is far more obvious which k is optimal.", "Even more informative is plotting every instances silhouette coefficient, sorted by the cluster they are in and by the value of the coefficient. This is a silhouette diagram. The shapes height indicates number of instances the cluster contains, and its width represents the sorted silhouette coefficients of the instances in the cluster (the wider the better). The dashed line indicates the mean silhouette coefficient.", "The vertical dashed lines represent the silhouette score for each number of clusters. If many instances stop short (left) of the dashed line, then the cluster is rather bad because it means the instances are much too close to each other. at k=3, and k=6 we get bad clusters, but at k=4 and k=5 they are pretty good. Most instances extend beyond the dashed line. When k=4 though, the orange cluster is rather big, and at k=5 they are all similar sizes, so it seems like 5 should be used to get clusters of similar sizes.", "Performing this process shows a clear limitation of the elbow method, and doing it regularly can reinforce the robustness of your choices of k.", "To be a good data scientist, it\u2019s important to know the assumptions behind methods you use so that you have an idea about the strength and weakness of them. This will help you decide when to use each method and under what circumstances:", "In this article, I discussed one of the most famous clustering algorithms \u2014 K-Means. We looked at the challenges which we might face while working with K-Means.", "We implemented k-means and looked at the elbow curve which helps to find the optimum number of clusters in the K-Means algorithm, and showed its limitations too.", "If you have any doubts or feedback, feel free to share them in the comments section below", "Aurelien Geron (2019) Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems Book , 2 edn., : O\u2019Reilly.", "All code for visualisations can be found at my GitHub here", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist with a background in Economics \u2014 London"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffa4df5990fff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@carterbouley?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carterbouley?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": "Carter Bouley"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bafa8e14c09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&user=Carter+Bouley&userId=5bafa8e14c09&source=post_page-5bafa8e14c09----fa4df5990fff---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa4df5990fff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa4df5990fff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/Carterbouley/kmeans", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fa4df5990fff---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----fa4df5990fff---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/tag/k-means-clustering?source=post_page-----fa4df5990fff---------------k_means_clustering-----------------", "anchor_text": "K Means Clustering"}, {"url": "https://medium.com/tag/k-means?source=post_page-----fa4df5990fff---------------k_means-----------------", "anchor_text": "K Means"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffa4df5990fff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&user=Carter+Bouley&userId=5bafa8e14c09&source=-----fa4df5990fff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffa4df5990fff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&user=Carter+Bouley&userId=5bafa8e14c09&source=-----fa4df5990fff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa4df5990fff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffa4df5990fff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fa4df5990fff---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fa4df5990fff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fa4df5990fff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fa4df5990fff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fa4df5990fff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carterbouley?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carterbouley?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Carter Bouley"}, {"url": "https://medium.com/@carterbouley/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bafa8e14c09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&user=Carter+Bouley&userId=5bafa8e14c09&source=post_page-5bafa8e14c09--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F943b53c93eeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-means-clustering-fa4df5990fff&newsletterV3=5bafa8e14c09&newsletterV3Id=943b53c93eeb&user=Carter+Bouley&userId=5bafa8e14c09&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}