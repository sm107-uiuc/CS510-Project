{"url": "https://towardsdatascience.com/structuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57", "time": 1683000293.143414, "path": "towardsdatascience.com/structuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57/", "webpage": {"metadata": {"title": "Structuring data to predict the future, aka Project Flux Capacitor | by Drew Jarrett | Towards Data Science", "h1": "Structuring data to predict the future, aka Project Flux Capacitor", "description": "To help pass on some learnings and make your process easier, my team and I have published code to support, speed up, and maybe even improve, the way you build ML models such as propensity models\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/kathrina-rose-ondap-7842b64b", "anchor_text": "Kathy", "paragraph_index": 1}, {"url": "https://www.linkedin.com/in/rukshan-batuwita-3881a526/?originalSubdomain=au", "anchor_text": "Rukshan", "paragraph_index": 1}, {"url": "https://cloud.google.com/dataflow/", "anchor_text": "Google Cloud Dataflow", "paragraph_index": 2}, {"url": "https://cloud.google.com/bigquery/", "anchor_text": "Google Cloud BigQuery", "paragraph_index": 2}, {"url": "https://support.google.com/analytics/answer/3437618?hl=en", "anchor_text": "Google Analytics BigQuery table", "paragraph_index": 3}, {"url": "https://cloud.google.com/dataflow/pricing", "anchor_text": "Google Cloud Dataflow pricing guide", "paragraph_index": 24}, {"url": "https://cloud.google.com/products/calculator/", "anchor_text": "Google Cloud Platform Pricing Calculator", "paragraph_index": 24}], "all_paragraphs": ["To help pass on some learnings and make your process easier, my team and I have published code to support, speed up, and maybe even improve, the way you build ML models such as propensity models, customer life time value models, recommender systems\u2026 etc.", "Super proud of the work David, Kathy, and Rukshan have put in to developing this solution, and making it possible.", "Under the hood the code utilises Google Cloud Dataflow to run Apache Beam pipelines, and Google Cloud BigQuery to read from and save to. Both powerful, and fast, ways to transform a ton of data at scale into ML ready format.", "We\u2019ve optimised the code to plug into a Google Analytics BigQuery table, but can also be plugged into other BigQuery data sources instead if useful. Input your BigQuery table, run the pipelines, and \u2014 voil\u00e0 \u2014 output new BigQuery table with structured features and label. Ready to train an ML model by using your favourite ML tool such as AutoML-Tables, BigQuery ML, Tensorflow, Python sklearn\u2026 etc.", "Eager to dive straight in? Go for it\u2026", "or, if you stick with me for a few minutes, understanding how the Flux Capacitor pipelines structure the data is important to understanding it\u2019s value. I attempted to explain this technique to my non-techy mate (yikes), and so decided to publish what I came up with here as a more unofficial \u2014 hopefully more fun \u2014 explanation.", "Our official project name is the ML Data Windowing Pipeline. Still, everything needs a fun name, and as we are structuring data to predict the future based on what\u2019s happened in the past, Flux Capacitor seems fitting. It\u2019s the data that makes \u201ctime travel possible\u201d \ud83e\uddc0 . Ok, putting the cheesiness aside, let me explain what it does.", "\u201cDoc\u201d Brown is looking to buy a car", "Let\u2019s consider one random person, and call that person the Doc. In this example Doc is buying a new car from our website.", "Our car website has Google Analytics setup on it, letting us record and see the Doc\u2019s browsing activity. Let\u2019s remember in reality we are only looking at anonymous metrics (we\u2019re just using the Doc reference for fun).", "This is the timeline representing the activity, with a blue boxes indicating interactions, leading to a purchase event. Each interaction has a number of metrics we can take from Google Analytics e.g. the browser, the time of day, pages visited, the number of hits\u2026 etc.", "Let\u2019s look at the detail in this timeline from a snapshot in time, and call that snapshot date d.", "Now, in respect to date d, we can start looking back into the past by a defined period of time and aggregate the Doc\u2019s session information together. This defined period of time is called the lookback window.", "In this example the Google Analytics interactions are aggregated to create new metrics e.g. most frequent page, browser, the number of days active, the total hits\u2026 etc. which represent the features we\u2019ll train our ML model with.", "Next, from our date d, we look into the future by a specified amount of time and call this the prediction window.", "So \u2014 as far as the data is concerned \u2014 if a purchase happened within the prediction window respective to date d, then it happened on date d. In other words, the label is based on whether a purchase event happened or not during the prediction window.", "That\u2019s the key here, so our model is being trained on what will happen in the future and accordingly how to predict it.", "This represents the label we\u2019ll train our ML model with.", "Once we extract the features and the label for the Doc \u2014our anonymous user\u2014 in respect to date d, we have a row in a table that looks like this:", "We then take these snapshots for all users on the website in respect to date d.", "and the resulted table starts to look like:", "Then we move our date d by a set sliding window at an interval w (e.g. a day, a week\u2026 etc), to create more snapshots in time for all users in respect to d + w, d + 2w\u2026 and so on.", "With multiple snapshots over time, our dataset gets a sense of how the data changes to accommodate seasonality (recency and frequency information).", "The result. A powerful (and big) dataset, ready for training your ML model.", "One last thing to remember is cost. A simple run of the ML Data Windowing Pipeline code, using say the Google Analytics Sample dataset, should be minimal. However production costs will depend on your data size. The pipeline has been designed to be as efficient as possible, but please still take note of the Google Cloud Dataflow pricing guide and Google Cloud Platform Pricing Calculator just to make sure there are no surprises.", "I hope this has been useful, and we would love to read in the comments section how you\u2019ve applied it.", "PS. Apologies if you\u2019ve never seen the movie Back to The Future! as a lot of these analogies / pictures may seem a bit random.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Working @Google across SYD & LDN. Developer. Innovative. Problem solver. Passion for making a difference through what I do. Proud Dad of two amazing girls."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7133715d7e57&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7133715d7e57--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7133715d7e57--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://drewjarrett.medium.com/?source=post_page-----7133715d7e57--------------------------------", "anchor_text": ""}, {"url": "https://drewjarrett.medium.com/?source=post_page-----7133715d7e57--------------------------------", "anchor_text": "Drew Jarrett"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7c14bbed83b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&user=Drew+Jarrett&userId=7c14bbed83b0&source=post_page-7c14bbed83b0----7133715d7e57---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7133715d7e57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7133715d7e57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.linkedin.com/in/kathrina-rose-ondap-7842b64b", "anchor_text": "Kathy"}, {"url": "https://www.linkedin.com/in/rukshan-batuwita-3881a526/?originalSubdomain=au", "anchor_text": "Rukshan"}, {"url": "https://cloud.google.com/dataflow/", "anchor_text": "Google Cloud Dataflow"}, {"url": "https://cloud.google.com/bigquery/", "anchor_text": "Google Cloud BigQuery"}, {"url": "https://support.google.com/analytics/answer/3437618?hl=en", "anchor_text": "Google Analytics BigQuery table"}, {"url": "https://github.com/GoogleCloudPlatform/cloud-for-marketing/tree/master/marketing-analytics/predicting/ml-data-windowing-pipeline", "anchor_text": "GoogleCloudPlatform/cloud-for-marketing/\u2026 GitHub Repo"}, {"url": "https://github.com/GoogleCloudPlatform/cloud-for-marketing/blob/master/marketing-analytics/predicting/ml-data-windowing-pipeline/README.md", "anchor_text": "README file"}, {"url": "https://cloud.google.com/solutions/preparing-ml-ready-data-for-personalization", "anchor_text": "Preparing ML-ready data for personalization"}, {"url": "https://cloud.google.com/dataflow/pricing", "anchor_text": "Google Cloud Dataflow pricing guide"}, {"url": "https://cloud.google.com/products/calculator/", "anchor_text": "Google Cloud Platform Pricing Calculator"}, {"url": "https://medium.com/tag/big-data?source=post_page-----7133715d7e57---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7133715d7e57---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----7133715d7e57---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7133715d7e57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&user=Drew+Jarrett&userId=7c14bbed83b0&source=-----7133715d7e57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7133715d7e57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&user=Drew+Jarrett&userId=7c14bbed83b0&source=-----7133715d7e57---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7133715d7e57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7133715d7e57--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7133715d7e57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7133715d7e57---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7133715d7e57--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7133715d7e57--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7133715d7e57--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7133715d7e57--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7133715d7e57--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7133715d7e57--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7133715d7e57--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7133715d7e57--------------------------------", "anchor_text": ""}, {"url": "https://drewjarrett.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://drewjarrett.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Drew Jarrett"}, {"url": "https://drewjarrett.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "50 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7c14bbed83b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&user=Drew+Jarrett&userId=7c14bbed83b0&source=post_page-7c14bbed83b0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F7c14bbed83b0%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstructuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57&user=Drew+Jarrett&userId=7c14bbed83b0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}