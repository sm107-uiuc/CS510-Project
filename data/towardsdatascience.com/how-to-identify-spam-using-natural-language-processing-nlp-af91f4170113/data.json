{"url": "https://towardsdatascience.com/how-to-identify-spam-using-natural-language-processing-nlp-af91f4170113", "time": 1683015689.391955, "path": "towardsdatascience.com/how-to-identify-spam-using-natural-language-processing-nlp-af91f4170113/", "webpage": {"metadata": {"title": "How to detect Spam using Natural Language Processing (NLP)? | by Patrizia Castagno | Oct, 2020 | Medium | Towards Data Science", "h1": "How to identify Spam using Natural Language Processing (NLP)?", "description": "The purpose of this article is to show you how to detect spam in SMS. We will train a model to learn to automatically discriminate between ham / spam. Then we will use \u201ctest data\u201d to test the model. Finally to evaluate if our model is efficient, we will calculate Accuracy, Classification report and Confusion Matrix."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Computing_Machinery_and_Intelligence", "anchor_text": "Alan Turing (1950)", "paragraph_index": 1}, {"url": "http://www.nltk.org/", "anchor_text": "http://nltk.org", "paragraph_index": 2}, {"url": "https://medium.com/@patriziacastagnod/artificial-intelligence-ai-d741e3549fe", "anchor_text": "Artificial Intelligence (AI)", "paragraph_index": 3}, {"url": "https://archive.ics.uci.edu/ml/datasets/SMS+Spam+Collection", "anchor_text": "UCI datasets", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Bag-of-words_model#:~:text=The%20bag%2Dof%2Dwords%20model,word%20order%20but%20keeping%20multiplicity.", "anchor_text": "bag-of-words", "paragraph_index": 13}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "CountVectorizer", "paragraph_index": 21}, {"url": "https://www.educative.io/edpresso/countvectorizer-in-python", "anchor_text": "CountVectorizer in Python", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "TF-IDF", "paragraph_index": 26}, {"url": "http://www.tfidf.com/#:~:text=TF(t)%20%3D%20(Number,terms%20are%20considered%20equally%20important.&text=IDF(t)%20%3D%20log_e(,with%20term%20t%20in%20it).", "anchor_text": "\u201cWhat does tf-idf mean?\u201d", "paragraph_index": 33}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html", "anchor_text": "Support Vector Classification (SVC)", "paragraph_index": 36}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "recision, Recall", "paragraph_index": 40}, {"url": "https://en.wikipedia.org/wiki/F-score", "anchor_text": "F1-Score", "paragraph_index": 40}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "Confusion Matri", "paragraph_index": 40}, {"url": "https://github.com/patrycas/How-to-identify-Spam-using-Natural-Language-Processing-NLP-", "anchor_text": "How to identify Spam using NLP", "paragraph_index": 42}], "all_paragraphs": ["Humans master millions of words, but computationally speaking: how can we manipulate large amounts of text using programming techniques?", "The idea that computers can understand ordinary languages and hold conversations with human beings has been a staple of science fiction. However, the first half of the twentieth century and was envisaged in a classic paper by Alan Turing (1950) as a hallmark of computational intelligence.", "This article will focus on how computer systems can analyze and interpret texts, using the Natural Language Processing (NLP). For that, you should install Natural Language Toolkit, you can do it from http://nltk.org. Instructions are available on the cited website along with details of associated packages that need to be installed as well, including Python itself, which is also freely available.", "Natural Language processing or NLP is a subset of Artificial Intelligence (AI), where it is basically responsible for the understanding of human language by a machine or a robot.", "One of the important subtopics in NLP is Natural Language Understanding (NLU) and the reason is that it is used to understand the structure and meaning of human language, and then with the help of computer science transform this linguistic knowledge into algorithms of Rules-based machine learning that can solve specific problems and perform desired tasks.", "The purpose of this article is to show you how to detect spam in SMS.", "For that, we use a dataset from the UCI datasets, which is a public set that contain SMS labelled messages that have been collected for mobile phone spam research. It has one collection composed by 5.574 SMS phone messages in English, tagged according being legitimate (ham) or spam.", "Therefore, we will train a model to learn to automatically discriminate between ham / spam. Then we will use \u201ctest data\u201d to test the model. Finally to evaluate if our model is efficient, we will calculate Accuracy, Classification report and Confusion Matrix.", "To get started, we should first imports all the library, then load the data and rename names columns:", "Let\u2019s see a description of our data:", "Note that our data contains a collection of 5574 SMS and also we have only 2 label: ham and spam. Now, we create a column called \u2018length\u2019 to know how long the text messages are and then plot it against the label:", "Note that through the histogram, we have been able to discover that spam messages tend to have more characters.", "Most likely, most of the data you have come across is numeric or categorical, but what happens when it is of type string (text format)?", "As you may have noticed, our data is of type string. Therefore, we should transform it into a numeric vector to be able to perform the classification task. To do this, we use bag-of-words where each unique word in a text will be represented by a number. However, before doing this transformation, we should remove all punctuations and then common words like: [\u2018I\u2019, \u2018my\u2019, \u2018myself\u2019, \u2018we\u2019, \u2018our\u2019, \u2018our\u2019 , \u2018ourselves\u2019, \u2018you\u2019, \u2018are\u2019 \u2026]. This process is called tokenization. After this process, we convert our string sequence into number sequences.", "and we want to remove !!! and .", "First, we load the import string library and do the following:", "To do that, we use the library nltk, i.e, from nltk.corpus import stopwords", "Is important to know that stopwords have 23 languages supported by it (this number must be up to date). In this case, we use English language:", "Thus, with the steps 1 and 2, we can create the following function:", "Now, we can apply the above function to our data analysis in the following way:", "Note that, we have the messages as lists of tokens. So, the next step is to convert each of those messages into a vector.", "To do that, we use CountVectorizer from Scikit Learn. CountVectorizer converts a collection of documents to an array of token counts. If you want to see an example of countvectorizer in Python, we invite you to read the following article: CountVectorizer in Python", "First all of, we import CountVectorizer from sklearn learn:", "CountVectorizer has many parameters, but we only use \u201canalyzer\u201d, which is our own previously defined function:", "Now, we should transform the entire DataFrame of the messages in a vector representation. For that, we use transform function:", "After applying \u201cCountVectorizer\u201d on our data, we use TF-IDF. Surely, you are wondering what is TD-FT? and why should we use it? Let me explain you:", "TF-IDF is the abbreviation of Inverse document frequency is a numerical measure that expresses how relevant a word is to a document in a collection.", "The value of TF-IDF increases proportionally to the number of times a word appears in the document, and is offset by the frequency of the word in the document collection, which allows handling of the fact that some words are generally more common than others.", "TF-IDF is composed by two terms: the first term is the Term Frequency (TF) and the second is the Inverse Document Frequency (IDF):", "Term Frequency (TF): Which measures how frequently a term occurs in a document, that is, the number of times a word appears in a document, divided by the total number of words in that document:", "TF(t) = (Number of times term t appears in a document) / (Total number of terms in the document)", "Inverse Document Frequency (IDF): Measures how important a term is, computed as the logarithm of the number of the documents in the corpus divided by the number of documents where the specific term appears.", "IDF(t) = log_e(Total number of documents / Number of documents with term t in it)", "For more information, please refer to \u201cWhat does tf-idf mean?\u201d", "Continuing with our code, we import TfidfVectorizer from sklearn.feature_extraction.text and then:", "To transform the entire bag-of-words corpus into TF-IDF corpus at once:", "Having the features represented as vectors, we can finally train our spam/ham classifier. You can use any classification algorithms . Here we use Support Vector Classification (SVC) algortihm.", "First, we split the data into train and test data. We take 80 % (0.80) training data and 30% (0.30) test data and the we fit the model using SVC:", "To test the model we use X_test previously calculated:", "The question that arises is: our model reliable across the entire data set?", "For that, we can use SciKit Learn\u2019s built-in classification report, which returns Precision, Recall, F1-Score and also Confusion Matrix", "The accuracy is a good way to know is the model is efficient but this is not enough to say that our model is good, for this reason we have used Classification Report and Confusion Matrix. You can see that results obtained are quite good.", "We\u2019re done !!! I hope this information has been useful to you.f you are interested in the full code, you can get it from the link below: How to identify Spam using NLP", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Physics. Data Science. This is my space where I can contribute my knowledge and also learn from others."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf91f4170113&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----af91f4170113--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af91f4170113--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://patriziacastagnod.medium.com/?source=post_page-----af91f4170113--------------------------------", "anchor_text": ""}, {"url": "https://patriziacastagnod.medium.com/?source=post_page-----af91f4170113--------------------------------", "anchor_text": "Patrizia Castagno"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd58cc64055d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&user=Patrizia+Castagno&userId=d58cc64055d2&source=post_page-d58cc64055d2----af91f4170113---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf91f4170113&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf91f4170113&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Computing_Machinery_and_Intelligence", "anchor_text": "Alan Turing (1950)"}, {"url": "http://www.nltk.org/", "anchor_text": "http://nltk.org"}, {"url": "https://medium.com/@patriziacastagnod/artificial-intelligence-ai-d741e3549fe", "anchor_text": "Artificial Intelligence (AI)"}, {"url": "https://archive.ics.uci.edu/ml/datasets/SMS+Spam+Collection", "anchor_text": "UCI datasets"}, {"url": "https://en.wikipedia.org/wiki/Bag-of-words_model#:~:text=The%20bag%2Dof%2Dwords%20model,word%20order%20but%20keeping%20multiplicity.", "anchor_text": "bag-of-words"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "CountVectorizer"}, {"url": "https://www.educative.io/edpresso/countvectorizer-in-python", "anchor_text": "CountVectorizer in Python"}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "TF-IDF"}, {"url": "http://www.tfidf.com/#:~:text=TF(t)%20%3D%20(Number,terms%20are%20considered%20equally%20important.&text=IDF(t)%20%3D%20log_e(,with%20term%20t%20in%20it).", "anchor_text": "\u201cWhat does tf-idf mean?\u201d"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html", "anchor_text": "Support Vector Classification (SVC)"}, {"url": "https://en.wikipedia.org/wiki/Precision_and_recall", "anchor_text": "recision, Recall"}, {"url": "https://en.wikipedia.org/wiki/F-score", "anchor_text": "F1-Score"}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "Confusion Matri"}, {"url": "https://github.com/patrycas/How-to-identify-Spam-using-Natural-Language-Processing-NLP-", "anchor_text": "How to identify Spam using NLP"}, {"url": "https://medium.com/tag/spam-filter?source=post_page-----af91f4170113---------------spam_filter-----------------", "anchor_text": "Spam Filter"}, {"url": "https://medium.com/tag/nlp?source=post_page-----af91f4170113---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/tokenization?source=post_page-----af91f4170113---------------tokenization-----------------", "anchor_text": "Tokenization"}, {"url": "https://medium.com/tag/tfidf-vectorizer?source=post_page-----af91f4170113---------------tfidf_vectorizer-----------------", "anchor_text": "Tfidf Vectorizer"}, {"url": "https://medium.com/tag/bag-of-words?source=post_page-----af91f4170113---------------bag_of_words-----------------", "anchor_text": "Bag Of Words"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf91f4170113&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&user=Patrizia+Castagno&userId=d58cc64055d2&source=-----af91f4170113---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf91f4170113&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&user=Patrizia+Castagno&userId=d58cc64055d2&source=-----af91f4170113---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf91f4170113&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af91f4170113--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faf91f4170113&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----af91f4170113---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----af91f4170113--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----af91f4170113--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----af91f4170113--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----af91f4170113--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----af91f4170113--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----af91f4170113--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----af91f4170113--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----af91f4170113--------------------------------", "anchor_text": ""}, {"url": "https://patriziacastagnod.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://patriziacastagnod.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Patrizia Castagno"}, {"url": "https://patriziacastagnod.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd58cc64055d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&user=Patrizia+Castagno&userId=d58cc64055d2&source=post_page-d58cc64055d2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa98b7c3545e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-identify-spam-using-natural-language-processing-nlp-af91f4170113&newsletterV3=d58cc64055d2&newsletterV3Id=a98b7c3545e2&user=Patrizia+Castagno&userId=d58cc64055d2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}