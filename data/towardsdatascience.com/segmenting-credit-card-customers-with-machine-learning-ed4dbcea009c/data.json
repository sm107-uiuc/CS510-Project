{"url": "https://towardsdatascience.com/segmenting-credit-card-customers-with-machine-learning-ed4dbcea009c", "time": 1682996384.121891, "path": "towardsdatascience.com/segmenting-credit-card-customers-with-machine-learning-ed4dbcea009c/", "webpage": {"metadata": {"title": "Segmenting Credit Card Customers with Machine Learning | by Rebecca Vickery | Towards Data Science", "h1": "Segmenting Credit Card Customers with Machine Learning", "description": "Segmentation in marketing is a technique used to divide customers or other entities into groups based on attributes such as behaviour or demographics. It is useful to identify segments of customers\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/arjunbhasin2013/ccdata", "anchor_text": "website", "paragraph_index": 1}, {"url": "https://scikit-learn.org/stable/modules/clustering.html", "anchor_text": "scikit-learn", "paragraph_index": 1}, {"url": "https://www.kaggle.com/arjunbhasin2013/ccdata/discussion/91399", "anchor_text": "data dictionary", "paragraph_index": 2}, {"url": "https://blog.jupyter.org/jupyterlab-is-ready-for-users-5a6f039b8906", "anchor_text": "JupyterLab", "paragraph_index": 3}, {"url": "https://github.com/rasbt/watermark", "anchor_text": "iPython magic", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Elbow_method_(clustering)", "anchor_text": "elbow method", "paragraph_index": 15}, {"url": "https://blog.cambridgespark.com/how-to-determine-the-optimal-number-of-clusters-for-k-means-clustering-14f27070048f", "anchor_text": "article", "paragraph_index": 15}, {"url": "https://blog.cambridgespark.com/@tolaalade_48082", "anchor_text": "Tola Alade", "paragraph_index": 15}], "all_paragraphs": ["Segmentation in marketing is a technique used to divide customers or other entities into groups based on attributes such as behaviour or demographics. It is useful to identify segments of customers who may respond in a similar way to specific marketing techniques such as email subject lines or display advertisements. As it gives businesses the ability to tailor marketing messages and timing to generate better response rates and provide improved consumer experiences.", "In the following post, I will be using a dataset containing a number of behavioural attributes for credit card customers. The dataset can be downloaded from the Kaggle website. I will be using the scikit-learn python machine learning library to apply an unsupervised machine learning technique known as clustering to identify segments that may not immediately be apparent to human cognition.", "The dataset consists of 18 features about the behaviour of credit card customers. These include variables such as the balance currently on the card, the number of purchases that have been made on the account, the credit limit, and many others. A complete data dictionary can be found on the data download page.", "I am running the following code in JupyterLab. I am using the iPython magic extension watermark to record the versions of tools that I am running this in. The output of this is shown below if you having any trouble running the code. Library imports are also shown below.", "To begin with, we will need to inspect the data to find out what cleaning and transformation may be needed. The scikit-learn library requires that all data have no null values and that all values must be numeric.", "To begin with, I have read in the downloaded csv file.", "Firstly I run the following to inspect the data types to find out if there are any categorical variables that may need transforming. We can see from the result that all features are numeric except for CUST_ID. But since we won\u2019t need this feature to train the model we don\u2019t have to do any transforming here.", "Running the following code tells me that only two features have null values \u2018CREDIT_LIMIT\u2019 and \u2018MINIMUM_PAYMENTS\u2019. Additionally, less than 5% of each column has nulls. This means that we should be ok to fill these with a sensible replacement value and should still be able to use the feature.", "The following code fills the missing value with the most commonly occurring value in the column. We could equally use mean or median, or indeed another approach but we will start here and iterate on this if needed.", "I am also going to drop the CUST_ID column as we won\u2019t need this for training.", "The final piece of processing I will do before training a model is to scale the features.", "The model that I am going to use for clustering in this post is K-Means. The following, in simple terms, is how the algorithm works:", "As it is reliant on this distance metric feature scaling is a very important consideration. In the example of the data set I am using let\u2019s take two features PURCHASES_FREQUENCY and BALANCE. The feature PURCHASES_FREQUENCY is a number between 0 and 1, whereas BALANCE as it is a monetary value in this dataset is between \u00a30 and \u00a319,043. These features have very different scales which means that if we don\u2019t normalise them so that they are on the same scale. There are likely to be instances where the algorithm will give more weight to one variable.", "The following code scales all the features in the data frame. I am using the min_max_scaler for the first iteration. Different techniques for scaling may have different results.", "To illustrate how this looks here are the PURCHASES_FREQUENCY and BALANCE columns before scaling.", "I mentioned previously that we need to tell the K-Means algorithm the number of clusters it should use. There are a number of techniques that can be used to find the optimal number. For this example, I am going to use the elbow method so named because the chart that it produces is similar in shape to the curve of an elbow. This method computes the sum of squared distances for clusters k. As more clusters are used the variance will reduce until you reach a point at which increasing clusters no longer results in a better model. This is illustrated in the following code borrowed from this article. Thank you Tola Alade!", "You can see that after 8 clusters adding more gives minimal benefit to the model. I am therefore going to use 8 clusters to train my model.", "Before training, I am going to divide the data set into a train and test set. The following code divides the data reserving 20% for testing.", "I then convert both the train and test set into numpy arrays.", "Next, I call the KMeans fit method using 8 clusters.", "Using the trained model I will now predict the clusters on the test set.", "I\u2019ll now assign the prediction as a new column on the original test data frame to analyse the results.", "I am going to use the pandas groupby function to analyse a selected number of features for the clusters in order to understand if the model has successfully identified unique segments.", "Just looking at \u2018PURCHASES_FREQUENCY\u2019 we can see that the model has identified some high-frequency purchase segments, clusters 2 and 3. Let\u2019s understand the differences between these two segments to further determine why they are in separate clusters. We can see that cluster 3 has a higher number of total purchases, a higher credit limit, they make frequent one-off purchases and are more likely to pay in full. We can draw the conclusion that these are high-value customers and therefore there will almost certainly be a difference between how you may market to these customers.", "As a first iteration of the model, this appears to be identifying some useful segments. There are many ways in which we could tune the model including alternative data cleaning methods, feature engineering, dropping features with high correlation and hyperparameter optimisation. However, for the purpose of this post I wanted to give a high-level end to end view of how to start a machine learning model that performs unsupervised clustering.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Writer | Speaker"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fed4dbcea009c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@rebeccalvickery", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rebeccalvickery.medium.com/?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": ""}, {"url": "https://rebeccalvickery.medium.com/?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": "Rebecca Vickery"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8b7aca3e5b1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=post_page-8b7aca3e5b1c----ed4dbcea009c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed4dbcea009c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed4dbcea009c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/x8i6FfaZAbs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ryan Born"}, {"url": "https://unsplash.com/search/photos/credit-card?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/arjunbhasin2013/ccdata", "anchor_text": "website"}, {"url": "https://scikit-learn.org/stable/modules/clustering.html", "anchor_text": "scikit-learn"}, {"url": "https://www.kaggle.com/arjunbhasin2013/ccdata/discussion/91399", "anchor_text": "data dictionary"}, {"url": "https://blog.jupyter.org/jupyterlab-is-ready-for-users-5a6f039b8906", "anchor_text": "JupyterLab"}, {"url": "https://github.com/rasbt/watermark", "anchor_text": "iPython magic"}, {"url": "https://en.wikipedia.org/wiki/Elbow_method_(clustering)", "anchor_text": "elbow method"}, {"url": "https://blog.cambridgespark.com/how-to-determine-the-optimal-number-of-clusters-for-k-means-clustering-14f27070048f", "anchor_text": "article"}, {"url": "https://blog.cambridgespark.com/@tolaalade_48082", "anchor_text": "Tola Alade"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ed4dbcea009c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ed4dbcea009c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----ed4dbcea009c---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/tag/clustering?source=post_page-----ed4dbcea009c---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ed4dbcea009c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed4dbcea009c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=-----ed4dbcea009c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed4dbcea009c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=-----ed4dbcea009c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed4dbcea009c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fed4dbcea009c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ed4dbcea009c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ed4dbcea009c--------------------------------", "anchor_text": ""}, {"url": "https://rebeccalvickery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rebeccalvickery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rebecca Vickery"}, {"url": "https://rebeccalvickery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8b7aca3e5b1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=post_page-8b7aca3e5b1c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F558d5c99b70b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsegmenting-credit-card-customers-with-machine-learning-ed4dbcea009c&newsletterV3=8b7aca3e5b1c&newsletterV3Id=558d5c99b70b&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}