{"url": "https://towardsdatascience.com/resnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e", "time": 1682993737.997819, "path": "towardsdatascience.com/resnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e/", "webpage": {"metadata": {"title": "Review: Pre-Activation ResNet with Identity Mapping \u2014 Over 1000 Layers Reached (Image Classification) | by Sik-Ho Tsang | Towards Data Science", "h1": "Review: Pre-Activation ResNet with Identity Mapping \u2014 Over 1000 Layers Reached (Image Classification)", "description": "In this story, An improved ResNet [1] by Microsoft is reviewed. With Identity Mapping, over 1000 layers can be reached for the deep learning architecture, without error increased. In the previous\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@sh.tsang/review-inception-v3-1st-runner-up-image-classification-in-ilsvrc-2015-17915421f77c", "anchor_text": "Inception-v3 review", "paragraph_index": 4}, {"url": "https://medium.com/u/aff72a0c1243?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "Sik-Ho Tsang", "paragraph_index": 4}, {"url": "https://linktr.ee/shtsang", "anchor_text": "https://linktr.ee/shtsang", "paragraph_index": 36}], "all_paragraphs": ["In this story, An improved ResNet [1] by Microsoft is reviewed. With Identity Mapping, over 1000 layers can be reached for the deep learning architecture, without error increased.", "In the previous version of ResNet [2], when ResNet goes from 101 layers to 1202 layers, though ResNet-1202 still can converge, there is degradation of error rate from 6.43% to 7.93% (This result can be seen in [2]). And it is stated as open question without any explanation in [2].", "The following figure shows the results of ResNet with Identity Mapping. With layers are up to 1001, previous ResNet [2] only got 7.61% error while new ResNet with Identity Mapping [1] can get 4.92% for CIFAR-10 Dataset.", "But why it can be better by keeping the shortcut connection path clean (by moving the ReLU layer from shortcut connection path to conv layer path as in the figure)? In this paper, it is well-explained. And a series of ablation study are done to support the importance of this identity mapping.", "The result is even better than Inception-v3 [3]. (If interested, please also read my Inception-v3 review.) With such good result, it is published in 2016 ECCV paper with more than 1000 citations when I was writing this story. (Sik-Ho Tsang @ Medium)", "The forward feeding, backpropagation and gradient updates which seems to make the deep learning as a secret. I think the explanation here is excellent.", "In ResNet with Identity Mapping, it is essential to keep clean for the shortcut connection path from input to output without any conv layers, BN and ReLU.", "xl is the input at l layer, F(.) is the function which represents the conv layers, BN and ReLU. Then we can formulate like this:", "We can see that the input signal xl is still kept here!", "During backpropagation, we can get the gradient which decomposed into two additive terms:", "Inside the blanket, we can always get \u201c1\u201d at the left term no matter how deep the network. And the right term cannot be always -1 which makes the gradient zero. Thus, the gradient does not vanish!!", "On the other hand, what if the left term is not equal to one:", "Similarly, the left term of gradient is the product of \u03bb.", "If \u03bb>1, the left term will be exponentially large, and gradient exploding problem occurs. As we should remember, when the gradient exploded, the loss cannot be converged.", "If \u03bb<1, the left term will be exponentially small, and gradient vanishing problem occurs. We cannot update the gradient with large value, the loss stays at plateau and end up converged with large loss.", "Thus, that\u2019s why we need to keep clean for the shortcut connection path from input to output without any conv layers, BN and ReLU.", "110-layer ResNet (54 two-layer residual units) with various types of shortcut connections are tested on CIFAR-10 dataset as below:", "Original: That is the previous version of ResNet in [2], with 6.61% error.", "Constant Scaling: \u03bb=0.5, suffering from gradient vanishing problem as mentioned, gets 12.35% error with careful selection of bias bg.", "Exclusive Gating & Shortcut-only gating: Both attempt to add complexity to shortcut path while still keeping the path equal to \u201c1\u201d. But both cannot get a better results.", "1\u00d71 Conv Shortcut: It is similar to the option C in previous ResNet [2]. In previous ResNet, It was found to better using option C. But right now it is found that it is not the case when there are many residual units (too deep).", "Dropout Shortcut: It is actually statistically performing \u03bb=0.5.", "The following results are obtained by playing around the positions of the BN and ReLU:", "The Previous ResNet & BN After Addition: Both cannot keep clean on the shortcut connection which violates the identity mapping.", "ReLU Before Addition: The residual function after ReLU must be non-negative which makes the forward propagated signal is monotonically increasing, while the residual function should be better to have negative values as well.", "ReLU-only Pre-Activation: ReLU is not used in conjunction with BN, which cannot enjoy the benefits of BN well.", "Full Pre-Activation: The shortcut path is clean, and ReLU is used in conjunction with BN, which make it become the best setting.", "Using previous ResNet structure (Baseline) has worse results when going too deep (1001) due to the wrong position of ReLU layer. Using pre-activation unit can always get a better result when the network is going deeper and deeper from 110 to 1001.", "Pre-activation unit is on regularization that slightly higher training loss at convergence but with lower test error.", "For both CIFAR-10 & CIFAR-100, ResNet-1001 with proposed pre-activation unit does not have larger error than ResNet-164, but the previous ResNet [2] does.", "With only scale augmentation, the previous version of ResNet-152 (5.5%), the winner of ILSVRC 2015, has worse performance than the previous version of ResNet-200 (6.0%) when going deeper due to the wrong position of ReLU.", "With both scale and aspect ratio augmentation, the proposed ResNet-200 with Pre-Activation (4.8%) is better than Inception-v3 [3] by Google (5.6%).", "Concurrently, Google also has a Inception-ResNet-v2 which has 4.9% error, with pre-activation unit, the error is expected to be have further reduction.", "On ILSVRC, ResNet-200 takes about 3 weeks to train on 8 GPUs.", "After reviewed ResNet and ResNet with Identity Mapping, as well as Inception-v1, Inception-v2 and Inception-v3, I will also have a review for Inception-v4. Please stay tuned!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD, Researcher. I share what I learn. :) Linktree: https://linktr.ee/shtsang for Twitter, LinkedIn, etc."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbb50a42af03e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sh-tsang.medium.com/?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": ""}, {"url": "https://sh-tsang.medium.com/?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "Sik-Ho Tsang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Faff72a0c1243&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&user=Sik-Ho+Tsang&userId=aff72a0c1243&source=post_page-aff72a0c1243----bb50a42af03e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb50a42af03e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb50a42af03e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@sh.tsang/review-inception-v3-1st-runner-up-image-classification-in-ilsvrc-2015-17915421f77c", "anchor_text": "Inception-v3 review"}, {"url": "https://medium.com/u/aff72a0c1243?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "Sik-Ho Tsang"}, {"url": "https://arxiv.org/abs/1603.05027", "anchor_text": "Identity Mappings in Deep Residual Networks"}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/He_Deep_Residual_Learning_CVPR_2016_paper.pdf", "anchor_text": "Deep Residual Learning for Image Recognition"}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Szegedy_Rethinking_the_Inception_CVPR_2016_paper.pdf", "anchor_text": "Rethinking the Inception Architecture for Computer Vision"}, {"url": "https://towardsdatascience.com/review-resnet-winner-of-ilsvrc-2015-image-classification-localization-detection-e39402bfa5d8", "anchor_text": "Review: ResNet \u2014 Winner of ILSVRC 2015 (Image Classification, Localization, Detection)"}, {"url": "https://medium.com/@sh.tsang/review-inception-v3-1st-runner-up-image-classification-in-ilsvrc-2015-17915421f77c", "anchor_text": "Review: Inception-v3\u20131st Runner Up (Image Classification) in ILSVRC 2015"}, {"url": "https://medium.com/@sh.tsang/review-batch-normalization-inception-v2-bn-inception-the-2nd-to-surpass-human-level-18e2d0f56651", "anchor_text": "Review: Batch Normalization (Inception-v2 / BN-Inception) -The 2nd to Surpass Human-Level Performance in ILSVRC 2015 (Image Classification)"}, {"url": "https://medium.com/coinmonks/paper-review-of-googlenet-inception-v1-winner-of-ilsvlc-2014-image-classification-c2b3565a64e7", "anchor_text": "Review: GoogLeNet (Inception v1) \u2014 Winner of ILSVRC 2014 (Image Classification)"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bb50a42af03e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----bb50a42af03e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----bb50a42af03e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bb50a42af03e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----bb50a42af03e---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb50a42af03e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&user=Sik-Ho+Tsang&userId=aff72a0c1243&source=-----bb50a42af03e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb50a42af03e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&user=Sik-Ho+Tsang&userId=aff72a0c1243&source=-----bb50a42af03e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb50a42af03e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbb50a42af03e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bb50a42af03e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bb50a42af03e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bb50a42af03e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bb50a42af03e--------------------------------", "anchor_text": ""}, {"url": "https://sh-tsang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sh-tsang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sik-Ho Tsang"}, {"url": "https://sh-tsang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.8K Followers"}, {"url": "https://linktr.ee/shtsang", "anchor_text": "https://linktr.ee/shtsang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Faff72a0c1243&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&user=Sik-Ho+Tsang&userId=aff72a0c1243&source=post_page-aff72a0c1243--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1804ee7051b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fresnet-with-identity-mapping-over-1000-layers-reached-image-classification-bb50a42af03e&newsletterV3=aff72a0c1243&newsletterV3Id=1804ee7051b3&user=Sik-Ho+Tsang&userId=aff72a0c1243&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}