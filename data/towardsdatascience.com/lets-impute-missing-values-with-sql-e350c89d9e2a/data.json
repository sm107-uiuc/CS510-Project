{"url": "https://towardsdatascience.com/lets-impute-missing-values-with-sql-e350c89d9e2a", "time": 1683013042.772665, "path": "towardsdatascience.com/lets-impute-missing-values-with-sql-e350c89d9e2a/", "webpage": {"metadata": {"title": "Let\u2019s Impute Missing Values with SQL | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Let\u2019s Impute Missing Values with SQL", "description": "Missing values are a huge problem in machine learning. In a day and age when machine learning can be done directly in the database, one wonders how to perform adequate data preparation with SQL\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.oracle.com/index.html", "anchor_text": "Oracle Cloud", "paragraph_index": 1}, {"url": "https://gist.githubusercontent.com/michhar/2dfd2de0d4f8727f873422c5d959fff5/raw/fa71405126017e6a37bea592440b4bee94bf7b9e/titanic.csv", "anchor_text": "Titanic dataset", "paragraph_index": 2}, {"url": "https://stackoverflow.com/questions/9541013/oracle-what-statements-need-to-be-committed", "anchor_text": "here\u2019s an explanation", "paragraph_index": 23}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 32}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights.", "paragraph_index": 33}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 35}], "all_paragraphs": ["Missing values are a huge problem in machine learning. In a day and age when machine learning can be done directly in the database, one wonders how to perform adequate data preparation with SQL, without other programming languages, such as Python and R. Today we\u2019ll see just how easy it is.", "We\u2019ll use Oracle Cloud for the purpose of this article, as it\u2019s free and can be used without any downloads and installations on your machine \u2014 through the SQL Developer Web. If you decide to follow along, create a free OLTP database, and go to Service Console \u2014 Development \u2014 SQL Developer Web.", "With regards to the dataset, we\u2019ll use the well-known Titanic dataset for two reasons:", "Once you have the dataset downloaded, you can use the Upload Data functionality of SQL Developer Web to create the table and upload data:", "Change data types using your best judgment and you\u2019re ready to roll!", "I don\u2019t want to mess anything up with the source table, called titanic, so let\u2019s make a copy of it:", "Let\u2019s just make a quick Select to verify everything is as it should be:", "Awesome! If you\u2019ve done any work with this dataset, you know the Age column is the most problematic one when it comes to missing values. Let\u2019s just check how many there are:", "Now that\u2019s a lot if we take into account that the dataset has less than 1000 rows. For that reason, we need to figure out how to fill these missing values and do so in an easy and automated fashion.", "To handle missing data imputation, we\u2019ll create a PL/SQL procedure. Don\u2019t worry if you don\u2019t know what that is, as it will be utterly simple to follow along. Before we do anything in code, let\u2019s list things this procedure should do:", "Great! This shouldn\u2019t be hard to do. We\u2019ll also be accepting some input from the user \u2014 3 parameters to be more precise:", "And that\u2019s all we have to know to get started. Let\u2019s create a procedure with what we know so far:", "Awesome! Below the IS keyword we\u2019ll declare some other variables \u2014 for holding things such as impute function that will be used, a statement for getting the average value, the average value itself, and an update statement. Our procedure now looks as follows:", "The remaining of the code will be located between the BEGIN and END keywords.", "As discussed earlier, our procedure can handle missing value imputation by using mean, median, or mode statistical functions. Also, those are values that the user can provide for the in_impute_method parameter.", "The only problem is \u2014 these statistical functions are called a bit differently in SQL. We can use the CASE operator to handle this and store the result into impute_func variable. Here\u2019s the code:", "We\u2019re almost halfway done, and the following parts are also plain simple.", "To get the average value, we\u2019ll have to use something known as a Dynamic SQL. This means we won\u2019t hardcode the SQL statements, but instead, the statements get created based on provided user input.", "Let\u2019s see how to create a Dynamic query for getting the average value, with respect to parameters the user has entered (table name, attribute, and impute method):", "It might look and feel a bit strange until you get used to this, but you\u2019ll see later what it all boils down to. This DBMS_OUTPUT line isn\u2019t required, but it prints the get_avg_stmt to the console once we run the procedure.", "This isn\u2019t enough though, as we still need to execute this statement and store its result in the avg_value variable. It\u2019s simple to do:", "This part is now done, and now we should somehow make an update to the table to actually fill the missing values. Let\u2019s see how.", "If you\u2019ve understood the previous section, you\u2019ll understand this one. Once again, we need to create a SQL statement dynamically and execute it. The only difference is that this time results won\u2019t be stored in a variable, as that makes no sense for an UPDATE statement. The table is modified in-place, instead:", "The only new thing here is the COMMIT keyword. It is used to end the current transaction and make all of the changes permanent. If you\u2019re not sure which statements have to be committed, here\u2019s an explanation. You\u2019re welcome.", "And that\u2019s it basically, we\u2019ve done everything we had to.", "Here\u2019s the entire procedure, just in case you\u2019ve missed something:", "And now, let\u2019s test the thing!", "We\u2019ve done all the hard work, and now we can test if everything works as advertised. To do so, we\u2019ll impute the missing values of age column with its median value. Here\u2019s how:", "And that\u2019s it! If we execute this block of code, we\u2019ll get some output to the console, due to all DBMS_OUTPUT calls in the procedure:", "Awesome! If we once again check for the number of missing values, we can see that everything worked out as it should:", "Our procedure does the job, but that doesn\u2019t mean it can\u2019t be improved further. Here are a couple of ideas:", "This is not a definite list, so feel free to tailor the procedure to your needs.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Join my private email list for more helpful insights.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe350c89d9e2a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----e350c89d9e2a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe350c89d9e2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe350c89d9e2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@elijahdhiett?utm_source=medium&utm_medium=referral", "anchor_text": "Elijah Hiett"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.oracle.com/index.html", "anchor_text": "Oracle Cloud"}, {"url": "https://gist.githubusercontent.com/michhar/2dfd2de0d4f8727f873422c5d959fff5/raw/fa71405126017e6a37bea592440b4bee94bf7b9e/titanic.csv", "anchor_text": "Titanic dataset"}, {"url": "https://stackoverflow.com/questions/9541013/oracle-what-statements-need-to-be-committed", "anchor_text": "here\u2019s an explanation"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----e350c89d9e2a---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e350c89d9e2a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/sql?source=post_page-----e350c89d9e2a---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/programming?source=post_page-----e350c89d9e2a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e350c89d9e2a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe350c89d9e2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----e350c89d9e2a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe350c89d9e2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----e350c89d9e2a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe350c89d9e2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe350c89d9e2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e350c89d9e2a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e350c89d9e2a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-impute-missing-values-with-sql-e350c89d9e2a&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}