{"url": "https://towardsdatascience.com/can-deep-learning-perform-better-than-pigeons-d37ef1581a2f", "time": 1683000485.12429, "path": "towardsdatascience.com/can-deep-learning-perform-better-than-pigeons-d37ef1581a2f/", "webpage": {"metadata": {"title": "Can Deep Learning Perform Better Than Pigeons? | by Laura Langdon | Towards Data Science", "h1": "Can Deep Learning Perform Better Than Pigeons?", "description": "Classifying images with the fast.ai library, from Lesson 2 of the fast.ai course \u2018Practical Deep Learning for Coders\u2019."}, "outgoing_paragraph_urls": [{"url": "https://course.fast.ai/videos/?lesson=2", "anchor_text": "Lesson 2", "paragraph_index": 0}, {"url": "https://course.fast.ai/", "anchor_text": "\u201cPractical Deep Learning for Coders\u201d", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/classifying-pregnancy-test-results-99adda4bca4c", "anchor_text": "classify images of pregnancy tests", "paragraph_index": 0}, {"url": "https://www.dailyartmagazine.com/monet-and-pigeons/", "anchor_text": "over 90% accuracy", "paragraph_index": 1}, {"url": "https://forums.fast.ai/t/determining-when-you-are-overfitting-underfitting-or-just-right/7732/5?u=go_go_gadget", "anchor_text": "this post", "paragraph_index": 4}, {"url": "https://course.fast.ai/deployment_render.html for deploying on Render (https://render.com/", "anchor_text": "deploying on Render", "paragraph_index": 10}, {"url": "https://forums.fast.ai/t/deployment-platform-render/33953/174?u=go_go_gadget", "anchor_text": "a thread", "paragraph_index": 11}, {"url": "https://forums.fast.ai/t/deployment-platform-render/33953/288?u=go_go_gadget", "anchor_text": "post", "paragraph_index": 12}, {"url": "https://www.wonderplugin.com/wordpress-tutorials/how-to-apply-for-a-google-drive-api-key/", "anchor_text": "these instructions", "paragraph_index": 13}, {"url": "https://forums.fast.ai/u/mrfabulous1", "anchor_text": "mrfabulous1", "paragraph_index": 16}, {"url": "https://picasso-or-monet.onrender.com/", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://github.com/g0g0gadget/picasso_vs_monet", "anchor_text": "GitHub", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/getting-started-with-fast-ai-350914ee65d2", "anchor_text": "Getting Started with fast.ai", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/classifying-pregnancy-test-results-99adda4bca4c", "anchor_text": "Classifying Pregnancy Test Results", "paragraph_index": 21}, {"url": "https://towardsdatascience.com/predicting-a-waiters-tips-1990342a0d02", "anchor_text": "Predicting a Waiter\u2019s Tips", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/but-where-does-the-pickle-go-53619676bf5f", "anchor_text": "But Where Does the Pickle Go?", "paragraph_index": 23}, {"url": "https://towardsdatascience.com/everybody-wants-to-be-a-cat-6dd6190c5d9c", "anchor_text": "Everybody Wants to be a Cat", "paragraph_index": 24}, {"url": "https://linkedin.com/in/laura-langdon/", "anchor_text": "LinkedIn", "paragraph_index": 25}, {"url": "https://twitter.com/laura_e_langdon", "anchor_text": "Twitter", "paragraph_index": 25}], "all_paragraphs": ["I\u2019m working through Lesson 2 of the marvelous \u201cPractical Deep Learning for Coders\u201d course by Jeremy Howard and Rachel Thomas of fast.ai, and last week, I trained a deep learning model to classify images of pregnancy tests whose results were not distinctly positive or negative, but were either faintly positive or showing evaporation lines. The model\u2019s accuracy wasn\u2019t what I wanted it to be, however, so I decided to start again with a classification problem for which I could easily acquire better sets of images than I could for the tricky pregnancy test classification problem. I then tried to train a model to classify redwood vs. sequoia trees, but again achieved a very low accuracy rate, with most of the errors coming from sequoias classified as redwoods. Sequoias\u2019 trunks are much larger than redwoods\u2019, but in images, it can be challenging to get a sense of scale, and I think that issue is most likely the reason why the model mistook sequoias for redwoods.", "So once again, I need a new problem. I consider classifying paintings as having been painted by either Monet or Manet, but I find my own ability to distinguish between the two insufficient to check the model\u2019s accuracy, so I decide to try Picasso vs. Monet instead. I want to be able to compare my model\u2019s accuracy to another\u2019s, and don\u2019t find a deep learning model for this problem, but do find a study that trained several sets of pigeons to identify paintings by Picasso vs. Monet with over 90% accuracy! I figure beating the pigeons is an acceptable first benchmark for my model.", "Following the instructions in the Lesson 2 lecture, I search for \u201cpicasso paintings\u201d and \u201cmonet paintings\u201d on Google Images and download both sets of images (see my previous post for the slight tweaks I needed to make to the code for this in the notebook).", "On its first time out of the gate, my model beats the pigeons!", "My training set loss is 0.396 while my validation set loss is 0.086 and my error rate is 0.278. It\u2019ll be hard to improve on that! My spidey sense is pinging, though, because my training set loss is higher than that of my validation set, and I think Jeremy said in the lecture that that\u2019s a sign of overfitting. I search and find this post on the fast.ai forum in which Jeremy says that as long as the error rate is low, a little overfitting is acceptable. Whew!", "Now for some hyperparameter tuning, though the accuracy is so high that I\u2019m not at all sure I can increase it significantly. I run the learning rate finder and try to plot the graph, but it shows as blank. There\u2019s a tip in the notebook that says if the learning rate finder plot is blank, to try running learn.lr_find(start_lr=1e-5, end_lr=1e-1 .", "Based on the graph, I set the learning rate to stay between 1e-6 to 1e-4:", "I\u2019ve brought down both my training set loss and my validation set loss considerably, but the error rate is essentially the same (which I expected). The model only made one mistake, classifying a Picasso as a Monet.", "I run the ImageCleaner, but I don\u2019t find any poor quality or noisy images, so I keep them all. Since my loss and my error rate are both low, I think my model\u2019s all set!", "Next, I\u2019m meant to put my model into production in a web app. I\u2019ve played with HTML and CSS before, and like the card-carrying Millennial that I am, I absolutely did have a Geocities site long ago, but I\u2019ve never built a web app. Jeremy says \u201cBuild a web app,\u201d like I might say \u201cMake some coffee,\u201d so perhaps it\u2019ll be relatively easy?", "I follow the fast.ai instructions for deploying on Render and fork the repo provided. I run into a small roadblock: the instructions tell us to edit the server.py file in the \u201capp\u201d directory, but I can\u2019t find one anywhere in the Jupyter directory tree. Eventually, I realize the \u201capp\u201d directory is in the forked repo on GitHub, not in Jupyter! Maybe that would have been obvious to some, but it wasn\u2019t to me. The next tiny snag is that a variable we need to edit in the server.py file is called \u2018export_file_url,\u2019 not \u2018model_file_url,\u2019 as indicated in the instructions. No big deal.", "I continue following the deployment instructions, but my web app fails to deploy, and I get this error in my logs on Render: TypeError: __call__() missing 2 required positional arguments: 'receive' and 'send' . I have no idea what that means, so I consult the fast.ai forums and find a thread addressing this issue. Apparently there\u2019s a file called requirements.txt in the forked repo which needs the version numbers of the various libraries my model is running. I find my requirements.txt file, create a new cell in the notebook, and in it run! pip list . I find most of the values sought by the requirements.txt file, but there\u2019s no entry for starlette, aiofiles, or aiohttp. I copy and paste the values given in the most recent post on the thread, crossing my fingers, but that doesn\u2019t work.", "So I post to the incredibly friendly and helpful forums myself and get some new values to try in my requirements.txt file.", "Progress! My web app deploys, but it seems to have defaulted to the teddy bear classifier example that\u2019s given as the default in the repo. I did update the URL link in the server.py file, but since my export.pkl was under 100 MB, I didn\u2019t generate an API key the first time. Perhaps I need one, though, so this time I follow these instructions to do that. I edit the server.py file again with the new link, and re-deploy. Nope, still bears.", "There\u2019s an example link still in server.py, but it appears to be commented out. I\u2019ll try deleting it? But I also edited the classes to be \u201cpicasso\u201d and \u201cmonet\u201d instead of types of bears, so those should have changed, too. Hmm\u2026 what if they did? Maybe it looks like the bear classifier, but it\u2019s actually my painting classifier?", "Yes! I run a Picasso image through the classifier, and the model classifies it correctly. So it is displaying as if it\u2019s the bear classifier, while actually running my classifier.", "I see that I need to edit some code for the user-facing text somewhere, but can\u2019t figure out where to do that. The wonderfully helpful mrfabulous1 on the fast.ai forums comes through for me again and tells me that the code I need to edit is the index.html file in the \u201cview\u201d subdirectory of the \u201capp\u201d directory. It works!", "Try my \u201cPicasso or Monet?\u201d classifier for yourself here!", "So now I have an image classification model with 97% accuracy, and a web app deployed to play with it. On to Lesson 3!", "Check out the code on GitHub!", "Lesson 1: Getting Started with fast.ai", "Lesson 2 (attempt 1): Classifying Pregnancy Test Results!", "Lesson 4: Predicting a Waiter\u2019s Tips", "Lesson 5: But Where Does the Pickle Go?", "Lesson 6: Everybody Wants to be a Cat", "I\u2019m a mathematics lecturer at CSU East Bay, and an aspiring data scientist. Connect with me on LinkedIn, or say hi on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Technical Writing | Data | Teaching M.S. in math"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd37ef1581a2f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@laura.langdon?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laura.langdon?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": "Laura Langdon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d6420372e98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&user=Laura+Langdon&userId=3d6420372e98&source=post_page-3d6420372e98----d37ef1581a2f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd37ef1581a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd37ef1581a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://course.fast.ai/videos/?lesson=2", "anchor_text": "Lesson 2"}, {"url": "https://course.fast.ai/", "anchor_text": "\u201cPractical Deep Learning for Coders\u201d"}, {"url": "https://towardsdatascience.com/classifying-pregnancy-test-results-99adda4bca4c", "anchor_text": "classify images of pregnancy tests"}, {"url": "https://www.dailyartmagazine.com/monet-and-pigeons/", "anchor_text": "over 90% accuracy"}, {"url": "https://forums.fast.ai/t/determining-when-you-are-overfitting-underfitting-or-just-right/7732/5?u=go_go_gadget", "anchor_text": "this post"}, {"url": "https://course.fast.ai/deployment_render.html for deploying on Render (https://render.com/", "anchor_text": "deploying on Render"}, {"url": "https://forums.fast.ai/t/deployment-platform-render/33953/174?u=go_go_gadget", "anchor_text": "a thread"}, {"url": "https://forums.fast.ai/t/deployment-platform-render/33953/288?u=go_go_gadget", "anchor_text": "post"}, {"url": "https://www.wonderplugin.com/wordpress-tutorials/how-to-apply-for-a-google-drive-api-key/", "anchor_text": "these instructions"}, {"url": "https://forums.fast.ai/u/mrfabulous1", "anchor_text": "mrfabulous1"}, {"url": "https://picasso-or-monet.onrender.com/", "anchor_text": "here"}, {"url": "https://github.com/g0g0gadget/picasso_vs_monet", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/getting-started-with-fast-ai-350914ee65d2", "anchor_text": "Getting Started with fast.ai"}, {"url": "https://towardsdatascience.com/classifying-pregnancy-test-results-99adda4bca4c", "anchor_text": "Classifying Pregnancy Test Results"}, {"url": "https://towardsdatascience.com/10-000-ways-that-wont-work-311925525cf0", "anchor_text": "10,000 Ways that Won\u2019t Work"}, {"url": "https://towardsdatascience.com/predicting-a-waiters-tips-1990342a0d02", "anchor_text": "Predicting a Waiter\u2019s Tips"}, {"url": "https://towardsdatascience.com/but-where-does-the-pickle-go-53619676bf5f", "anchor_text": "But Where Does the Pickle Go?"}, {"url": "https://towardsdatascience.com/everybody-wants-to-be-a-cat-6dd6190c5d9c", "anchor_text": "Everybody Wants to be a Cat"}, {"url": "https://linkedin.com/in/laura-langdon/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/laura_e_langdon", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d37ef1581a2f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d37ef1581a2f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/fastai?source=post_page-----d37ef1581a2f---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/self-study?source=post_page-----d37ef1581a2f---------------self_study-----------------", "anchor_text": "Self Study"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----d37ef1581a2f---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd37ef1581a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&user=Laura+Langdon&userId=3d6420372e98&source=-----d37ef1581a2f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd37ef1581a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&user=Laura+Langdon&userId=3d6420372e98&source=-----d37ef1581a2f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd37ef1581a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd37ef1581a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d37ef1581a2f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d37ef1581a2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laura.langdon?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laura.langdon?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Laura Langdon"}, {"url": "https://medium.com/@laura.langdon/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "82 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d6420372e98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&user=Laura+Langdon&userId=3d6420372e98&source=post_page-3d6420372e98--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc73c28198d96&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcan-deep-learning-perform-better-than-pigeons-d37ef1581a2f&newsletterV3=3d6420372e98&newsletterV3Id=c73c28198d96&user=Laura+Langdon&userId=3d6420372e98&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}