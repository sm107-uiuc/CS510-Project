{"url": "https://towardsdatascience.com/lagged-variable-regressions-and-truth-4edb7b9e8f47", "time": 1682996891.2954729, "path": "towardsdatascience.com/lagged-variable-regressions-and-truth-4edb7b9e8f47/", "webpage": {"metadata": {"title": "Lagged Variable Regressions and Truth | by Ben Ogorek | Towards Data Science", "h1": "Lagged Variable Regressions and Truth", "description": "Turn a nonlinear structural time-series model into a regression on lagged variables using rational transfer functions and common filters. See bias in OLS regression, and use GLS to get to the truth."}, "outgoing_paragraph_urls": [{"url": "https://books.google.com/books/about/A_Guide_to_Econometrics.html?id=B8I5SP69e4kC&source=kp_book_description", "anchor_text": "A Guide to Econometrics", "paragraph_index": 1}, {"url": "https://www.researchgate.net/publication/276953549_Identification_of_Multiple-Input_Transfer_Function_Models", "anchor_text": "Identification of Multiple-Input Transfer Function Models", "paragraph_index": 13}, {"url": "https://gist.github.com/baogorek/6d682e42079005b3bde951e98ebae89e", "anchor_text": "R gist", "paragraph_index": 17}, {"url": "https://drive.google.com/open?id=1kk40wiVYzPXOkrPffU55Vzy-LLTrgAVh", "anchor_text": "csv file", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/modeling-cumulative-impact-part-i-f7ef490ed5e3", "anchor_text": "nonlinear least squares", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/modeling-cumulative-impact-part-ii-2bf65db3bb98", "anchor_text": "inear regression with complex spline-convolution features", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/the-kalman-filter-and-external-control-inputs-70ea6bcbc55f", "anchor_text": "the Kalman Filter", "paragraph_index": 28}], "all_paragraphs": ["\u201cNear things are more related than distant things,\u201d states Tobler\u2019s (very believable) first law of geography. However little we know about an underlying data generating mechanism, we can often exploit sheer nearness \u2014 in time or space \u2014 to gain an advantage. But we also know that regressing on a time-shifted copy of the dependent variable, one that is affected by all the same factors, comes with caveats.", "The biggest caveat is the potential for asymptotic bias in ordinary least squares (OLS) regression that no amount of additional data can alleviate. This happens when regressors are contemporaneously correlated with the error term. As explained by Peter Kennedy in A Guide to Econometrics, \u201cThis is because the OLS procedure, in assigning \u2018credit\u2019 to regressors for explaining variation in the dependent variable, assigns, in error, some of the disturbance-generated variation of the dependent variable to the regressor with which that disturbance is contemporaneously correlated.\u201d In short, OLS can\u2019t separate the effects of regressor and error when the two are correlated.", "From a passive prediction standpoint, the bias might not matter, and \u201ctruth,\u201d in this article\u2019s title, refers to the true data generating process underlying a time series. Henceforth, our goal is quality estimation of the process parameters. For both an objective truth and a case where parameters have scientific meaning, I\u2019ll turn to a nonlinear, nonstationary, structural time-series model, the \u201cfitness-fatigue\u201d model of athletic performance. This model relates training history to athletic performance via latent fitness and fatigue constructs and is tuned by scientifically meaningful parameters.", "By rewriting this model using rational transfer functions of input to output, a set of \u201ccommon filtering\u201d operations will become apparent. Applying these filters will transform the model into a dynamic linear regression, but the filtering operations will also have a side effect: errors with an MA(2) correlation structure. We will see the destructive power of contemporaneous correlation between regressors and error in OLS regression, but in the end, we will get to the truth via a GLS regression that accommodates that structure.", "The \u201cfitness-fatigue\u201d model of athletic performance has the form:", "where p_t is a numeric measure of (athletic) performance, w_t is training \u201cdose,\u201d and \u03f5_t is i.i.d. Gaussian error. The model can be viewed as a linear regression with two nonlinear features,", "latent representations of athletic \u201cfitness\u201d and \u201cfatigue,\u201d respectively. These features are convolutions of athletic training history with exponential decay, differing only in the decay rate. Typically, fatigue (g_t) is relatively transient and associated with a faster exponential decay, but also has a relatively large regression weight compared to fitness.", "With a bit of algebra, fitness and fatigue can be put into the dynamic form:", "If we plug the dynamic representation of fitness and fatigue into the original model, we arrive at", "which looks nicer but is not immediately useful as h_t and g_t depend on unknown parameters.", "Working a little harder, we can use the \u201cbackshift operator\u201d B defined by B y_t = y_{t-1} for any time-indexed variable y, and arrive at", "Solving for h_t and g_t and plugging them back into the original model, we arrive at:", "Thus we have two rational transfer functions operating on the exogenous input series w_t. With rational transfer functions, denominator terms of the form (1- \u03b8 B) correspond to an autoregressive impulse response, i.e., a process with a long memory, and this is a nuisance to us. There is an option to rid ourselves of the denominator component, but not one without a cost.", "A \u201ccommon filter,\u201d as discussed in Identification of Multiple-Input Transfer Function Models (Liu & Hanssens, 1982) premultiplies the right and left-hand side of a time-series equation by (1- \u03b8B). It does not change the transfer function weights, so you can apply multiple common filters in succession, and besides causing complexity and losing some rows due to lags, you have not destroyed the relationship between the input and output series.", "The point is, if we were to use the common filter (1- \u03b8_1 B) (1 -\u03b8_2 B), we rid ourselves of the autoregressive components:", "The above still looks ugly, but after expanding the polynomials applying the backshift operations, we arrive at:", "This is a regression of performance on two lagged versions of itself and on the external training input, but one with a twist. There is the issue of the MA(2) error structure induced by the common filters, and it has real consequences.", "This section will use simulated data that can be reproduced from an R gist or downloaded directly as a csv file. To run the R code below, change the file path in the following R code block:", "The following calculations show the theoretical values of all the coefficients in the lagged variable model as simulated:", "And thus the goal is to recover the following equation:", "Side note: To go the opposite direction, solve for \u03b8_1 and \u03b8_2 by substitution, which leads to a quadratic equation in one of the two parameters. They lead to the same two roots, so choose \u03b8_1 to be the larger of the two. With \u03b8_1 and \u03b8_2 in hand, solving for \u03bc is trivial and k_1 and k_2 constitute a linear system with two equations and two unknowns.", "To prepare for the regression, the code below lags performance and training variables once and twice each. The dplyr package makes it easy:", "Let\u2019s see what happens when we regress performance on these lagged variables using OLS:", "The above code results in the partial output:", "There is clearly bias in the OLS coefficient estimates as a results of the serial correlation remaining in the residuals.", "Fortunately, R\u2019s nlme package offers generalized least squares (GLS) model fitting via the gls function, which handles the MA(2) error structure:", "The following partial output comes from the above code:", "Via GLS regression, we\u2019ve recovered the true parameter values to within plausible estimation error.", "Previous articles on the fitness-fatigue model have used heavy machinery to estimate the parameters: nonlinear least squares, linear regression with complex spline-convolution features and the Kalman Filter, to name three. That a linear regression (fit via GLS) on a few lagged variables was able to recover the theoretical underlying process speaks to the expressive power of the dynamic regression model", "What is the cost of blindly regressing on a few lags of input and output each? Focusing only on one-step ahead forecast accuracy, probably not much. The OLS regression with lagged variables \u201cexplained\u201d most of the variation in the next performance value, but it\u2019s also suggesting a quite different process than the one used to simulate the data. The internals of this process were recovered by the GLS regression, and this speaks of getting to the \u201ctruth\u201d that the title mentioned.", "A topic for further research and discussion would be whether it is wise to use GLS regression with an MA(q) error structure for all dynamic regressions. It is easy enough to implement in R via nlme. On the other hand, its prediction function did not use the error structure, and it would thus require additional effort from the user to make the GLS forecasts competitive with those of OLS. For out-of-the-box, one-step-ahead prediction, may be difficult to justify the added complexity of the GLS procedure. For getting to the true underlying system parameters, incorporating an MA(q) error structure via GLS may very well bring us closer to the truth.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist who enjoys learning and writing about methods. @benogorek on Twitter"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4edb7b9e8f47&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@baogorek?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@baogorek?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": "Ben Ogorek"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa7ecfd165396&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&user=Ben+Ogorek&userId=a7ecfd165396&source=post_page-a7ecfd165396----4edb7b9e8f47---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4edb7b9e8f47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4edb7b9e8f47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0", "anchor_text": "CC BY-SA 4.0"}, {"url": "https://books.google.com/books/about/A_Guide_to_Econometrics.html?id=B8I5SP69e4kC&source=kp_book_description", "anchor_text": "A Guide to Econometrics"}, {"url": "https://www.researchgate.net/publication/276953549_Identification_of_Multiple-Input_Transfer_Function_Models", "anchor_text": "Identification of Multiple-Input Transfer Function Models"}, {"url": "https://gist.github.com/baogorek/6d682e42079005b3bde951e98ebae89e", "anchor_text": "R gist"}, {"url": "https://drive.google.com/open?id=1kk40wiVYzPXOkrPffU55Vzy-LLTrgAVh", "anchor_text": "csv file"}, {"url": "https://towardsdatascience.com/modeling-cumulative-impact-part-i-f7ef490ed5e3", "anchor_text": "nonlinear least squares"}, {"url": "https://towardsdatascience.com/modeling-cumulative-impact-part-ii-2bf65db3bb98", "anchor_text": "inear regression with complex spline-convolution features"}, {"url": "https://towardsdatascience.com/the-kalman-filter-and-external-control-inputs-70ea6bcbc55f", "anchor_text": "the Kalman Filter"}, {"url": "https://medium.com/tag/statistics?source=post_page-----4edb7b9e8f47---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4edb7b9e8f47---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4edb7b9e8f47---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----4edb7b9e8f47---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/math?source=post_page-----4edb7b9e8f47---------------math-----------------", "anchor_text": "Math"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4edb7b9e8f47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&user=Ben+Ogorek&userId=a7ecfd165396&source=-----4edb7b9e8f47---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4edb7b9e8f47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&user=Ben+Ogorek&userId=a7ecfd165396&source=-----4edb7b9e8f47---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4edb7b9e8f47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4edb7b9e8f47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4edb7b9e8f47---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4edb7b9e8f47--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@baogorek?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@baogorek?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ben Ogorek"}, {"url": "https://medium.com/@baogorek/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "177 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa7ecfd165396&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&user=Ben+Ogorek&userId=a7ecfd165396&source=post_page-a7ecfd165396--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F536bc54ba88c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flagged-variable-regressions-and-truth-4edb7b9e8f47&newsletterV3=a7ecfd165396&newsletterV3Id=536bc54ba88c&user=Ben+Ogorek&userId=a7ecfd165396&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}