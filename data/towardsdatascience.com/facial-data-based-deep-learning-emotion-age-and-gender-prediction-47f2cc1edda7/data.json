{"url": "https://towardsdatascience.com/facial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7", "time": 1683011553.5581498, "path": "towardsdatascience.com/facial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7/", "webpage": {"metadata": {"title": "Facial Data-Based Deep Learning: Emotion, Age and Gender Prediction | by Abhijit Roy | Towards Data Science", "h1": "Facial Data-Based Deep Learning: Emotion, Age and Gender Prediction", "description": "Deep Learning has found huge applications in the fields of Computer vision. Some of the most important applications of computer vision are in the fields that deal with facial data. Face Detection and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/shawon10/ckplus", "anchor_text": "Kaggle\u2019s CKPlus Dataset", "paragraph_index": 4}, {"url": "https://www.kaggle.com/jangedoo/utkface-new?", "anchor_text": "UTKFace Dataset", "paragraph_index": 20}, {"url": "https://abhijitroy1998.wixsite.com/abhijitcv", "anchor_text": "https://abhijitroy1998.wixsite.com/abhijitcv", "paragraph_index": 50}], "all_paragraphs": ["Deep Learning has found huge applications in the fields of Computer vision. Some of the most important applications of computer vision are in the fields that deal with facial data. Face Detection and recognition are being widely used in security-based applications. If you want to explore these two areas feel free to go through:", "I have tried to give a total explanation of how the mechanisms work in the above articles.", "In this article, we are going to talk about two of the other most important applications of face-based deep learning, emotion detection, or facial expression detection, and age and gender prediction from a facial image.", "First, let us talk about Emotion detection or prediction.", "For this part, we will be using Kaggle\u2019s CKPlus Dataset.", "The dataset has 981 images in total. These images are classified into seven labels based on seven different expressions: Anger, Contempt, Disgust, Fear, Happy, Sadness, and Surprise. Each expression has a folder. So, there are seven folders in which the 981 images are stored.", "First, we list the classes or folders in the order using listdir().", "So, we save the expression in the order in a list which we will refer to create the labels.", "Next, we move to preprocess the images.", "The above snippet opens the image reads it using OpenCV, resizes it to (48 x 48) dimension. I have converted it to an RGB image, so, it is having three channels. The size of each image is (48 x 48 x 3). We will append the images in the \u2018images\u2019 list, and the corresponding labels in the \u2018labels\u2019 list. Let\u2019s visualize a few examples after preprocessing.", "Using the above snippet, we convert the labels and images to NumPy arrays and normalize the images array by dividing it with 255. I have used one-hot encoding to encode the labels into vectors. We will be using a test split of 25%.", "We are going to use the above model to predict the expressions.", "The above snippet will train the model.", "The model gives an accuracy of 100% on the test data.", "Note: Whenever a model gives a 100% accuracy on test data, we need to check the training accuracy, if that is also 100%. It means the model is actually overfitting and the test set is having a very close distribution to the train set. So, it is showing great results. I think in these circumstances, it\u2019s better to use cross-validation to get the correct intuition of how the model actually works.", "The two curves show the learning of the model. The first curve shows the loss function decrease and the second shows the accuracy growth with epochs.", "We obtain predictions as shown, Let us check the classification report and Confusion Matrix.", "We have seen the confusion matrix and classification report for our model.", "The above snippet will let us have a look at some of the images, their true labels, and the predicted labels.", "So, we have seen how to predict Emotion using Deep Learning. Let\u2019s check out Age and Gender Prediction.", "We will use Kaggle\u2019s UTKFace Dataset for predicting age and Gender.", "Here I have used the dataset having 9780 files. It has 9780 images of faces belonging to both males and females with ages ranging from 0 to 116. Each image has labels that show the corresponding age and gender. Male is given by 0 and Female is given by 1.", "The above snippet helps to get the data and prepare the training sets. The \u2018images\u2019 list contains all the 9780 images, each image of size (48 x 48 x 3). The \u2018ages\u2019 list has the corresponding ages and the \u2018genders\u2019 list has the corresponding genders.", "Let us look at the images after preprocessing.", "Now, we need to check the distribution of our sets.", "The first bar graph shows the distribution of gender. It seems well balanced. The second line graph shows the variation of samples of different ages. We can see that the samples with age less than 40 is much more than the number of samples with age more than 40. This creates a skewness in the train set distribution.", "We have seen in this case, we will actually need to predict both age and gender using the same model. So, to create the actual labels for our training set, we will need to do some processing.", "The above snippet takes the age and gender for each image sample index wise and converts each one into a list and appends them to the labels list. This is done to create the one-dimensional label vectors.", "So, the shape of the \u2018labels\u2019 list will be:", "Next, we convert the labels and images list into NumPy arrays, normalize the images, and create the training and test data splits. We will use a 25% test split.", "Currently, our Y_train and Y_test are of the form:", "We need to transform them in a way such that Y_train[0] denotes the gender labels vector, and Y_train[1] denotes the age labels vector.", "The simple snippet does the work for us.", "Now, we are ready to proceed and design our model.", "We are going to use the above model to predict both the sex and age", "The above is a schematic diagram of our model. After the \u2018flatten\u2019 layer we are going to use two different dense layers and dropouts corresponding to the corresponding outputs. Now, gender prediction is a classification problem, while age prediction is a regression problem, so, we will use sigmoid as output activation for gender prediction and ReLU as the activation function for Age prediction. Similarly, we will use \u2018binary cross-entropy\u2019 as the loss function for gender and \u2018mean absolute error\u2019 as the loss function for the age.", "The above snippet will train the model.", "The model gives an accuracy of 82% for the gender classification.", "Let us look at the model\u2019s loss curve.", "This is the generated loss curve for our model.", "Let\u2019s look at the evaluation for age prediction:", "The above curve shows the model traced linear regression line in black and the blue dots show the distribution of test samples. So, we can see our predicted line almost passes through the middle of the distribution. Above the age of 80, there were very few samples, so, maybe owing to that there our model didn\u2019t perform so well.", "The above curve shows the increase in gender accuracy with epochs.", "Our model obtained an F1 score of 0.84 for the female gender and 0.78 for Male gender. So, it classifies female gender better than males.", "Let\u2019s look at some samples from our set and their corresponding predicted age and gender.", "The above snippet helps to generate our samples:", "For the last sample, the actual age label was 62, and the predicted age label is 60.", "Thus we can predict gender and age using face data.", "We have seen how to predict emotion, gender, and sex from a facial image in this article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a Computer Science and Technology Graduate from NIT, Durgapur. Find Me at https://abhijitroy1998.wixsite.com/abhijitcv"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F47f2cc1edda7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@myac.abhijit?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@myac.abhijit?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": "Abhijit Roy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4c235a4f4b95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&user=Abhijit+Roy&userId=4c235a4f4b95&source=post_page-4c235a4f4b95----47f2cc1edda7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F47f2cc1edda7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F47f2cc1edda7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@_imkiran?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Sai Kiran Anagani"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://levelup.gitconnected.com/a-small-gui-application-based-on-computer-vision-and-python-imaging-libraries-using-opencv-e07b3f8c06c1", "anchor_text": "Face Detection"}, {"url": "https://medium.com/ai-in-plain-english/an-approach-towards-building-a-gui-based-and-voice-controlled-security-lock-mechanism-based-on-f06b47d0426e", "anchor_text": "Face Recognition"}, {"url": "https://www.kaggle.com/shawon10/ckplus", "anchor_text": "Kaggle\u2019s CKPlus Dataset"}, {"url": "https://www.kaggle.com/jangedoo/utkface-new?", "anchor_text": "UTKFace Dataset"}, {"url": "https://github.com/abr-98/Face_data_based_deeplearning", "anchor_text": "here"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----47f2cc1edda7---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/cnn?source=post_page-----47f2cc1edda7---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F47f2cc1edda7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&user=Abhijit+Roy&userId=4c235a4f4b95&source=-----47f2cc1edda7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F47f2cc1edda7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&user=Abhijit+Roy&userId=4c235a4f4b95&source=-----47f2cc1edda7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F47f2cc1edda7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F47f2cc1edda7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----47f2cc1edda7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----47f2cc1edda7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@myac.abhijit?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@myac.abhijit?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abhijit Roy"}, {"url": "https://medium.com/@myac.abhijit/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "458 Followers"}, {"url": "https://abhijitroy1998.wixsite.com/abhijitcv", "anchor_text": "https://abhijitroy1998.wixsite.com/abhijitcv"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4c235a4f4b95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&user=Abhijit+Roy&userId=4c235a4f4b95&source=post_page-4c235a4f4b95--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2ba8066c30a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffacial-data-based-deep-learning-emotion-age-and-gender-prediction-47f2cc1edda7&newsletterV3=4c235a4f4b95&newsletterV3Id=2ba8066c30a7&user=Abhijit+Roy&userId=4c235a4f4b95&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}