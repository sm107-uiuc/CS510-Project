{"url": "https://towardsdatascience.com/cat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a", "time": 1682996043.572802, "path": "towardsdatascience.com/cat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a/", "webpage": {"metadata": {"title": "Cat or Dog \u2014 Image Classification with Convolutional Neural Network | by Andrej Baranovskij | Towards Data Science", "h1": "Cat or Dog \u2014 Image Classification with Convolutional Neural Network", "description": "This post is based on code and explanation of CNN Neural Network shared in Fran\u00e7ois Chollet book \u2014 Deep Learning with Python. I run an experiment to classify images and detect if image contains a dog."}, "outgoing_paragraph_urls": [{"url": "https://www.manning.com/books/deep-learning-with-python", "anchor_text": "Deep Learning with Python", "paragraph_index": 0}, {"url": "https://github.com/fchollet/deep-learning-with-python-notebooks", "anchor_text": "GitHub", "paragraph_index": 0}, {"url": "https://github.com/fchollet/deep-learning-with-python-notebooks/blob/master/5.2-using-convnets-with-small-datasets.ipynb", "anchor_text": "notebook", "paragraph_index": 2}, {"url": "https://github.com/fchollet/deep-learning-with-python-notebooks/blob/master/5.4-visualizing-what-convnets-learn.ipynb", "anchor_text": "notebook", "paragraph_index": 2}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/tree/master/convnet", "anchor_text": "GitHub", "paragraph_index": 2}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/blob/master/convnet/cats_dogs_endpoint.ipynb", "anchor_text": "notebook", "paragraph_index": 8}], "all_paragraphs": ["The goal of this post is to show how convnet (CNN \u2014 Convolutional Neural Network) works. I will be using classical cat/dog classification example described in Fran\u00e7ois Chollet book \u2014 Deep Learning with Python. Source code for this example is available on Fran\u00e7ois Chollet GitHub. I\u2019m using this source code to run my experiment.", "Convnet works by abstracting image features from the detail to higher level elements. An analogy can be described with the way how humans think. Each of us knows how airplane looks, but most likely when thinking about airplane we are not thinking about every little bit of airplane structure. In a similar way, convnet learns to recognize higher level elements in the image and this helps to classify new images when they look similar to the ones used for the training.", "Image classification model should be trained using this notebook (you will find a description there from where to download image dataset with cats and dogs images). Model is being used and classification prediction is invoked in this notebook. For the convenience, I uploaded my own notebooks (based on the code from Deep Learning with Python book) to GitHub.", "I was running notebook in Jupyter Docker image, a path to image dataset should be updated (refer to code example in my GitHub repo), you should use Docker configured path as the root to fetch dataset images from the disk:", "Model is built using a subset of data:", "First model training attempt is done directly using available images from the dataset. Convnet trains to identify cats vs dogs using Keras and TensorFlow backend. But overfitting happens during early iterations. This is the result of training executed by me \u2014 validation performance doesn\u2019t improve, when training performance improves \u2014 Convnet adjusting according to training data and doesn\u2019t perform as good with validation data:", "To fight with overfitting, more training data is supplied by applying a data augmentation technique. Augmentation process allows generating more training data from existing data, by altering existing data. Random transformations are applied to adjust the existing image and create multiple images out of one (refer to the source from Deep Learning with Python book).", "After data augmentation convnet trains better by far \u2014 validation quality stays very close to the training quality:", "Image classification based on convnet model is done in endpoint notebook. A good practice is save trained model and later re-open it for classification task:", "I will be testing model with our dog images. Let\u2019s see based on the model classification results how close our dog looks to be a dog :) (well, at least based on those 1000 dog pictures used for convnet training).", "I will be using 11 pictures, all are uploaded to the GitHub repo along with Python notebooks. First picture:", "Using the code from Deep Learning with Python book to transform the image into the format to be sent to model.predict function:", "It might be useful to display a transformed image of 150x150 pixels:", "Classification result: 58% a dog. I think this is a good result, anything more than 50% is good for a dog, less than 50% => a cat look.", "We repeat the same steps (calling model.predict function) with more pictures.", "Summary: convnet was trained on a small dataset and still it can offer fantastic classification results (verified with my dog pictures :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd421a9363c7a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andrejusb.medium.com/?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b----d421a9363c7a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd421a9363c7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd421a9363c7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.manning.com/books/deep-learning-with-python", "anchor_text": "Deep Learning with Python"}, {"url": "https://github.com/fchollet/deep-learning-with-python-notebooks", "anchor_text": "GitHub"}, {"url": "https://github.com/fchollet/deep-learning-with-python-notebooks/blob/master/5.2-using-convnets-with-small-datasets.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/fchollet/deep-learning-with-python-notebooks/blob/master/5.4-visualizing-what-convnets-learn.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/tree/master/convnet", "anchor_text": "GitHub"}, {"url": "https://github.com/abaranovskis-redsamurai/automation-repo/blob/master/convnet/cats_dogs_endpoint.ipynb", "anchor_text": "notebook"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d421a9363c7a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/convnets?source=post_page-----d421a9363c7a---------------convnets-----------------", "anchor_text": "Convnets"}, {"url": "https://medium.com/tag/python?source=post_page-----d421a9363c7a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----d421a9363c7a---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd421a9363c7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----d421a9363c7a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd421a9363c7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----d421a9363c7a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd421a9363c7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd421a9363c7a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d421a9363c7a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d421a9363c7a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d421a9363c7a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d421a9363c7a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d421a9363c7a--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://andrejusb.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://github.com/katanaml", "anchor_text": "https://github.com/katanaml"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd22cc5338107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcat-or-dog-image-classification-with-convolutional-neural-network-d421a9363c7a&newsletterV3=bbd1211c851b&newsletterV3Id=d22cc5338107&user=Andrej+Baranovskij&userId=bbd1211c851b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}