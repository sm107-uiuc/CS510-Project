{"url": "https://towardsdatascience.com/spam-filtering-system-with-deep-learning-b8070b28f9e0", "time": 1682995148.707902, "path": "towardsdatascience.com/spam-filtering-system-with-deep-learning-b8070b28f9e0/", "webpage": {"metadata": {"title": "Spam Filtering System With Deep Learning | by gannestweb | Towards Data Science", "h1": "Spam Filtering System With Deep Learning", "description": "Deep learning is getting very popular in many industry and many interesting problems can be solved by deep learning technology. In this article, I am showing you how to utilize a deep learning model\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@edricgan.44/email-spam-detection-1-2-b0e06a5c0472", "anchor_text": "here!", "paragraph_index": 2}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "blog", "paragraph_index": 37}, {"url": "https://maxwell.ict.griffith.edu.au/spl/publications/papers/ieeesp97_schuster.pdf", "anchor_text": "paper", "paragraph_index": 42}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "website", "paragraph_index": 47}, {"url": "https://medium.com/@edricgan.44/email-spam-detection-1-2-b0e06a5c0472", "anchor_text": "article", "paragraph_index": 53}, {"url": "https://github.com/huai99/Email-Spam-Detection-Python/blob/master/Email%20Spam%20(%20Medium%20Part%202).ipynb", "anchor_text": "repository", "paragraph_index": 64}, {"url": "https://colab.research.google.com/drive/1mvY1vFMvMnUIbC8hvHvlm-UeSeSAlil9", "anchor_text": "Colab", "paragraph_index": 64}], "all_paragraphs": ["Deep learning is getting very popular in many industry and many interesting problems can be solved by deep learning technology. In this article, I am showing you how to utilize a deep learning model to design a super effective spam filtering system.", "Not long ago, I had written an article about Spam Filtering with Traditional Machine Learning algorithm.", "In that article, I have covered from data exploration, data preprocessing , feature extraction to choosing the right scoring metrics for your algorithm. If you are interested, you can read the article here!", "Today, I am going to focus more on the following two parts when building a spam filtering system:", "Word Embedding is a representation of text data in vectorized format. So, for a word like \u2018dog\u2019, the word embedding will translate it into a vector which is of shape (1,x) and x is a value that you can configure.", "Intuitively, you can see this vector as a way to describe the word. If the word is a vector of shape (1,300), it means there are 300 different features describing this word.", "What are those features? To be honest, we don\u2019t know. Deep learning will identify those features during the training process.", "The final outcome of the training process is a mapping from the word to a meaningful word vector.", "Sounds like a cool magic trick huh? What made this even cooler, is the cosine distance between two word vectors actually signify something important.", "Words that have closer semantic meaning will have shorter cosine distance in the vector space.", "For example, vector \u2018man\u2019 and vector \u2018woman\u2019 have a very close cosine distance between each other.", "There are some open source word embeddings that have been trained over a large number of text data and their weights are opened for public to download.", "By using the open source word embedding, you can save the time from collecting text data. Moreover, you can also save the time and computing resources to generate the word embedding.", "The downside of using pre-trained word embedding is that the word embedding may be trained over data sources from different domains. This may not always fit the use case that you are applying.", "For instance, pre-trained word embedding that is trained over text data of scientific journal may not be a best fit for problems like, detection of malicious tweets. The benefits from this word embedding will not be that significant.", "Different variants of pre-trained word embedding", "Most of the open source word embeddings list out the sources they are being trained, so you need to choose carefully based on the problems that you are solving.", "Below are some of the examples:", "In this tutorial, we are using glove word embedding. The format of glove embedding is a little bit different from what the python library, gensim, is expecting.", "So after you download the word embedding from the glove official website, you need to do some simple transformation.", "You can easily transform it to the format that is compatible with word2vec embedding by running the python scripts below.", "Make sure you have the python gensim module installed.", "After that you can load it using gensim library easily,", "We can also perform some operations on this vector and get back some interesting results.", "Example 1 : King- Man + Woman = Queen", "Let\u2019s see how we actually do that in the code and what interesting results we might get.", "We can also ask the word embedding model to figure out which is the outlier given a list of words", "I have included the relevant code inside the notebook, you can try around with different inputs and see whether it aligns with your expectation.", "Now I think you have witnessed the powerful feature extraction capabilities of word embedding.", "In the next section, we are going to see how can we combine this pre-trained word embedding with the Embedding Layer in Keras so that we can use it during our training.", "Keras is an awesome high level deep learning library that helps you to build deep learning model easily. It abstracts a lot of low level mathematical details and let you build your model in a very intuitive way.", "Embedding Layer is one of the wrapper layer provided by Keras for us to train the word embedding easily.", "First, we will need to make use of tokenizer to help us convert all the words to some kind of tokens/indexes.", "In the tokenization layer, they maintain a dictionary that map a word to an index. For example, dog -> 0, cat->1, and so on.", "Embedding layer will internally maintain a lookup table, and the lookup table will map the index/token to a vector, and that vector is what represent the word in the higher dimensional space.", "GRU is a variant of LSTM architecture and a lot of articles has done a great job in explaining the theory behind.", "For the sake of brevity, I would not do much explanation on the theory behind all these models.", "I would recommend the blog written by Chris Olah on this topic. His blogpost has shown some nice graphics to explain the internal working of GRU.", "The idea of Bidirectional is simple yet powerful. What it does is having two LSTM network instead of one.", "For the first LSTM network, it will feed in the input sequence as per normal. For the second LSTM network, it will reverse the input sequence and feed in to the LSTM network. The output of these two networks will be merged and then passed on to the next layer.", "The intuition behind Bidirectional is that, for some of the sentences, the context information is at the end of the sentence. Without the context info, ambiguity might arise. For example:", "So reading the sentence in bi-direction helps the model to determine the exact meaning of the word.", "I would recommend reading the original paper if you are interested in the theoretical knowledge.", "Now, let\u2019s start building our network in Keras, we are going to involve components such as Embedding Layer, Bidirectional Layer and Gated Recurrent Units (GRU).", "For the Embedding, there is two options that we can take:", "In the end of this article we are going to compare the results produced by using Vanilla Word Embedding and Glove Word Embedding.", "The code snippet below shows how to construct the embedding layer, Bidirectional and GRU easily in Keras.", "Glove Word Embedding is open sourced by Stanford NLP Group. We need to download the word embedding first, you can find the source information at the official website.", "They have released different versions of word embedding, and they are trained over different sources of data. Feel free to experiment more using other variants of word embedding listed there.", "The code to transfer weight from glove to Keras embedding layer is rather lengthy, here I will only show a short code snippet to give you an idea of how the transfer was being done. I would share the notebook code at the end of this article.", "Now the embedding matrix contains all the weight from the glove embedding, and transfer them to Keras layer is just one extra line of code.", "You need to specify the weight of the Embedding Layer when you are constructing the model. The rest of the code are same as how you build the vanilla embedding layer.", "After training a few iterations on the training set, let us compare the performance of the model in terms of accuracy, precision and recall.", "If you are interested in why these metrics are chosen, you can read the previous article that I have written. I have included a detailed explanation over these different choices of performance metrics.", "From the table above, you can clearly tell both of the LSTM model is doing way more better than the Naive Bayes Algorithm. The reasons can be due to:", "I have only run the model for 20 epochs and did not do any further fine tuning.", "The precision and recall of the two models does not differ by a very great margin. Some of the reason might be due to:", "Comparing the accuracy graph of these two models, you will discover something interesting:", "The accuracy of the vanilla word embedding plateau and remain flat at the first few epochs, before starting to have a better performance.", "Whereas, the accuracy of the glove word embedding has a smooth accuracy curve and improved gradually.", "These observations can roughly give us some insight that the vanilla word embedding models are still learning and adjusting its weight at the earlier epoch of the training.", "Hence pre-trained word embedding is still helpful in speeding up the learning of the model, you might not notice the speed advantage in this problem, but when you are training over a large enough text data, these speed differences will be quite significant.", "In this article, I have shown how to build a spam filtering system using word embedding and LSTM models with Keras.", "Word embedding is definitely a good feature extraction tool for text data and with LSTM model, we can build a spam filtering system with very decent performance.", "You can find the code of this notebook in this Github repository or you can run it directly from Colab.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer in the payment industry, Foodie and Deeply Interested in History, Psychology and Economics"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb8070b28f9e0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gannestweb?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gannestweb?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": "gannestweb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65d58216b9a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&user=gannestweb&userId=65d58216b9a9&source=post_page-65d58216b9a9----b8070b28f9e0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb8070b28f9e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb8070b28f9e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rozetsky?utm_source=medium&utm_medium=referral", "anchor_text": "Ant Rozetsky"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@edricgan.44/email-spam-detection-1-2-b0e06a5c0472", "anchor_text": "here!"}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "Glove"}, {"url": "https://fasttext.cc/docs/en/english-vectors.html", "anchor_text": "Wiki-News"}, {"url": "https://code.google.com/archive/p/word2vec/", "anchor_text": "Google News Vectors"}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "blog"}, {"url": "https://maxwell.ict.griffith.edu.au/spl/publications/papers/ieeesp97_schuster.pdf", "anchor_text": "paper"}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "website"}, {"url": "https://medium.com/@edricgan.44/email-spam-detection-1-2-b0e06a5c0472", "anchor_text": "article"}, {"url": "https://unsplash.com/@rawpixel?utm_source=medium&utm_medium=referral", "anchor_text": "rawpixel"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/huai99/Email-Spam-Detection-Python/blob/master/Email%20Spam%20(%20Medium%20Part%202).ipynb", "anchor_text": "repository"}, {"url": "https://colab.research.google.com/drive/1mvY1vFMvMnUIbC8hvHvlm-UeSeSAlil9", "anchor_text": "Colab"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b8070b28f9e0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/spam-filter?source=post_page-----b8070b28f9e0---------------spam_filter-----------------", "anchor_text": "Spam Filter"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b8070b28f9e0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/lstm?source=post_page-----b8070b28f9e0---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/bidirectional?source=post_page-----b8070b28f9e0---------------bidirectional-----------------", "anchor_text": "Bidirectional"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb8070b28f9e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&user=gannestweb&userId=65d58216b9a9&source=-----b8070b28f9e0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb8070b28f9e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&user=gannestweb&userId=65d58216b9a9&source=-----b8070b28f9e0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb8070b28f9e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb8070b28f9e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b8070b28f9e0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b8070b28f9e0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gannestweb?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gannestweb?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "gannestweb"}, {"url": "https://medium.com/@gannestweb/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "64 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65d58216b9a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&user=gannestweb&userId=65d58216b9a9&source=post_page-65d58216b9a9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe21f931870ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fspam-filtering-system-with-deep-learning-b8070b28f9e0&newsletterV3=65d58216b9a9&newsletterV3Id=e21f931870ee&user=gannestweb&userId=65d58216b9a9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}