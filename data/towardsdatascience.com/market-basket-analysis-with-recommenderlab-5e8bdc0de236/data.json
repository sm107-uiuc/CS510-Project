{"url": "https://towardsdatascience.com/market-basket-analysis-with-recommenderlab-5e8bdc0de236", "time": 1682995515.6920562, "path": "towardsdatascience.com/market-basket-analysis-with-recommenderlab-5e8bdc0de236/", "webpage": {"metadata": {"title": "Market Basket Analysis with recommenderlab | by Diego Usai | Towards Data Science", "h1": "Market Basket Analysis with recommenderlab", "description": "Market Basket Analysis PART 2 - apply various machine learning algorithms for Product Recommendation and select the best performing model with the support of the recommenderlab package"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/clean-a-complex-dataset-for-modelling-with-recommendation-algorithms-c977f7ba28b1", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/clean-a-complex-dataset-for-modelling-with-recommendation-algorithms-c977f7ba28b1", "anchor_text": "Part 1", "paragraph_index": 3}, {"url": "http://archive.ics.uci.edu/ml/datasets/online+retail", "anchor_text": "dataset", "paragraph_index": 3}, {"url": "https://github.com/DiegoUsaiUK/Market_Basket_Analysis/blob/master/Market_Basket_Analysis_Part1.R", "anchor_text": "R code for Part 1", "paragraph_index": 3}, {"url": "https://github.com/DiegoUsaiUK/Market_Basket_Analysis", "anchor_text": "Github profile", "paragraph_index": 3}, {"url": "https://cran.r-project.org/web/packages/recommenderlab/index.html", "anchor_text": "recommenderlab", "paragraph_index": 4}, {"url": "http://archive.ics.uci.edu/ml/index.php", "anchor_text": "UCI Machine Learning Repository", "paragraph_index": 8}, {"url": "https://github.com/DiegoUsaiUK/Market_Basket_Analysis", "anchor_text": "my GitHub profile", "paragraph_index": 33}, {"url": "http://www.linkedin.com/in/diegousaiuk/", "anchor_text": "www.linkedin.com/in/diegousaiuk/", "paragraph_index": 35}], "all_paragraphs": ["Recently I wanted to learn something new and challenged myself to carry out an end-to-end Market Basket Analysis. To continue to challenge myself, I\u2019ve decided to put the results of my efforts before the eyes of the data science community.", "This is the second of three post arranged as follows:", "Part 1: (which can be found here) explore and cleanse a dataset suitable for modelling with recommendation algorithmsPart 2: apply various Product Recommendation models with the recommenderlab R packagePart 3: implement the best performing model in a Shiny Web Application", "For the analysis I will be using the retail dataset prepared and cleansed in Part 1. If you want to follow along with this post, make sure you get the dataset and run R code for Part 1 , which you can find on my Github profile.", "For the analysis part of this project I am using recommenderlab, an R package which provides a convenient framework to evaluate and compare various recommendation algorithms and quickly establish the best suited approach.", "Before I can start, I need to arrange the purchase history in a rating matrix, with orders in rows and products in columns. This format is often called a user_item matrix because \u201cusers\u201d (e.g. customers or orders) tend to be on the rows and \u201citems\u201d (e.g. products) on the columns.", "recommenderlab accepts 2 types of rating matrix for modelling:", "However, when creating the rating matrix, it becomes apparent that some orders contain the same item more than once, as shown in the example below.", "It is possible that the company that donated this dataset to the UCI Machine Learning Repository had an order processing system that allowed for an item to be added multiple times to the same order. For this analysis, I only need to know if an item was included in an order, so these duplicates need to be removed.", "I can now create the rating matrix.", "In order to establish the models effectiveness, recommenderlab implements a number of evaluation schemes. In this scheme, I split the data into a train and a test set by selecting train = 0.8 for a 80/20 train/test split. I have also set method = \u201ccross\u201d and k = 5 for a 5-fold cross validation. This means that the data is divided into k subsets of equal size, with 80% of the data used for training and the remaining 20% used for evaluation. The models are recursively estimated 5 times, each time using a different train/test split, which ensures that all users and items are considered for both training and testing. The results can then be averaged to produce a single evaluation set.", "Selecting given = -1 means that for the test users \u2018all but 1\u2019 randomly selected item is withheld for evaluation.", "One of recommenderlab main features is the ability to estimate multiple algorithms in one go. First, I create a list with the algorithms I want to estimate, specifying all the models parameters. Here, I consider schemes which evaluate on a binary rating matrix. I include the random items algorithm for benchmarking purposes.", "All I have to do now is to pass scheme and algoritms to the evaluate() function, select type = topNList to evaluate a Top N List of product recommendations and specify how many recommendations to calculate with the parameter n = c(1, 3, 5, 10, 15, 20).", "Please note that the CF based algorithms take a few minutes each to estimate.", "The output is stored as a list containing all the evaluations.", "recommenderlab has a basic plot function that can be used to compare models performance. However, I prefer to sort out the results in a tidy format for added flexibility and charting customisation.", "First, I arrange the confusion matrix output for one model in a convenient format.", "Then, I put the previous steps into a formula.", "Next, I use the map() function from the purrr package to get all results in a tidy format, ready for charting.", "Classification models performance can be compared using the ROC curve, which plots the true positive rate (TPR) against the false positive rate (FPR).", "The item-based collaborative filtering model is the clear winner as it achieves the highest TPR for any given level of FPR. This means that the model is producing the highest number of relevant recommendations (true positives) for the same level of non-relevant recommendations (false positives).", "Note that using fct_reorder2() arranges plot legend entries by best final FPR and TPR, alligning them with the curves and making the plot easier to read.", "Another common way to compare classification models performance is with Precision Vs Recall curves. Precision shows how sensitive models are to False Positives (i.e. recommending an item not very likely to be purchased) whereas Recall (which is just another name for the TPR) looks at how sensitive models are to False Negatives (i.e. do not suggest an item which is highly likely to be purchased).", "Normally, we care about accurately predicting which items are more likely to be purchased because this would have a positive impact on sales and revenue. In other words, we want to maximise Recall (or minimise FNs) for the same level of Precision.", "The plot confirms that item-based Collaborative Filter (IBCF) is the best model because it has higher Recall for any given level of Precision. This means that IBCF minimises FNs (i.e. not suggesting an item highly likely to be purchased) for all level of FPs.", "The final step is to generate a prediction with the best performing model. To do that, I need to create a made-up purchase order.", "First, I create a string containing 6 products selected at random.", "Next, I put this order in a format that recommenderlab accept.", "Now, I can create a Recommender. I use getData to retrieve training data and set method = \u201cIBCF\u201d to select the best performing model (\u201citem-based collaborative filtering\u201d).", "Finally, I can pass the Recommender and the made-up order to the predict function to create a top 10 recommendation list for the new customer.", "Lastly, the suggested items can be inspected as a list", "This brings to an end the modelling and evaluation part of this project, which I found straightforward and quite enjoyable. recommenderlab is intuitive and easy to use and I particularly appreciated its ability to estimate and compare several classification algorithms at the same time. In summary, I have learned how to carry out Market Basket Analysis with recommenderlab in R, to interpret the results and choose the best performing model.", "The full R code can be found on my GitHub profile", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Customer Insight | Business Intelligence | Marketing Analytics | www.linkedin.com/in/diegousaiuk/ | CURRENTLY SEEKING NEW JOB OPPORTUNITIES"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5e8bdc0de236&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@diegousaiuk?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@diegousaiuk?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": "Diego Usai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21986549abda&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&user=Diego+Usai&userId=21986549abda&source=post_page-21986549abda----5e8bdc0de236---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e8bdc0de236&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e8bdc0de236&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@victoriano?utm_source=medium&utm_medium=referral", "anchor_text": "Victoriano Izquierdo"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/clean-a-complex-dataset-for-modelling-with-recommendation-algorithms-c977f7ba28b1", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/clean-a-complex-dataset-for-modelling-with-recommendation-algorithms-c977f7ba28b1", "anchor_text": "Part 1"}, {"url": "http://archive.ics.uci.edu/ml/datasets/online+retail", "anchor_text": "dataset"}, {"url": "https://github.com/DiegoUsaiUK/Market_Basket_Analysis/blob/master/Market_Basket_Analysis_Part1.R", "anchor_text": "R code for Part 1"}, {"url": "https://github.com/DiegoUsaiUK/Market_Basket_Analysis", "anchor_text": "Github profile"}, {"url": "https://cran.r-project.org/web/packages/recommenderlab/index.html", "anchor_text": "recommenderlab"}, {"url": "http://archive.ics.uci.edu/ml/index.php", "anchor_text": "UCI Machine Learning Repository"}, {"url": "https://github.com/DiegoUsaiUK/Market_Basket_Analysis", "anchor_text": "my GitHub profile"}, {"url": "https://cran.r-project.org/package=recommenderlab", "anchor_text": "https://cran.r-project.org/package=recommenderlab"}, {"url": "https://cran.r-project.org/web/packages/recommenderlab/vignettes/recommenderlab.pdf", "anchor_text": "https://cran.r-project.org/web/packages/recommenderlab/vignettes/recommenderlab.pdf"}, {"url": "https://diegousai.io/2019/03/market-basket-analysis-part-2-of-3/", "anchor_text": "https://diegousai.io"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5e8bdc0de236---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5e8bdc0de236---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----5e8bdc0de236---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/visualization?source=post_page-----5e8bdc0de236---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/market-research?source=post_page-----5e8bdc0de236---------------market_research-----------------", "anchor_text": "Market Research"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5e8bdc0de236&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&user=Diego+Usai&userId=21986549abda&source=-----5e8bdc0de236---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5e8bdc0de236&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&user=Diego+Usai&userId=21986549abda&source=-----5e8bdc0de236---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e8bdc0de236&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5e8bdc0de236&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5e8bdc0de236---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5e8bdc0de236--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@diegousaiuk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@diegousaiuk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Diego Usai"}, {"url": "https://medium.com/@diegousaiuk/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "148 Followers"}, {"url": "http://www.linkedin.com/in/diegousaiuk/", "anchor_text": "www.linkedin.com/in/diegousaiuk/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21986549abda&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&user=Diego+Usai&userId=21986549abda&source=post_page-21986549abda--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F21986549abda%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmarket-basket-analysis-with-recommenderlab-5e8bdc0de236&user=Diego+Usai&userId=21986549abda&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}