{"url": "https://towardsdatascience.com/batch-normalization-explained-algorithm-breakdown-23d2794511c", "time": 1683006215.4439192, "path": "towardsdatascience.com/batch-normalization-explained-algorithm-breakdown-23d2794511c/", "webpage": {"metadata": {"title": "Batch Normalization In Neural Networks Explained (Algorithm Breakdown) | by Richmond Alake | Towards Data Science", "h1": "Batch Normalization In Neural Networks Explained (Algorithm Breakdown)", "description": "Batch normalization(BN) is a technique many machine learning practitioners would have encountered. If you\u2019ve ever utilised convolutional neural networks such as Xception, ResNet50 and Inception V3\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1610.02357", "anchor_text": "Xception", "paragraph_index": 0}, {"url": "https://www.mathworks.com/help/deeplearning/ref/resnet50.html", "anchor_text": "ResNet50", "paragraph_index": 0}, {"url": "https://uk.mathworks.com/help/deeplearning/ref/inceptionv3.html", "anchor_text": "Inception V3", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1502.03167", "anchor_text": "paper", "paragraph_index": 5}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow", "paragraph_index": 29}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch", "paragraph_index": 29}], "all_paragraphs": ["Batch normalization(BN) is a technique many machine learning practitioners would have encountered. If you\u2019ve ever utilised convolutional neural networks such as Xception, ResNet50 and Inception V3, then you\u2019ve used batch normalization.", "This article explains the basic intuition behind BN. And for those who are already familiar with BN technique, this article dives into the BN algorithm and explains the key components.", "Batch Normalization is a technique that mitigates the effect of unstable gradients within deep neural networks. BN introduces an additional layer to the neural network that performs operations on the inputs from the previous layer.", "The operation standardizes and normalizes the input values. The input values are then transformed through scaling and shifting operations.", "If this is confusing, the next section below will make the technique a bit clearer.", "The technique batch normalization was presented in 2015 by Christian Szegedy and Sergey Ioffe in this published paper.", "Batch normalization was performed as a solution to speed up the training phase of deep neural networks through the introduction of internal normalization of the inputs values within the neural network layer.", "The reason for the \u2018batch\u2019 in the term Batch Normalization is because neural networks are usually trained with a collated set of data at a time, this set or group of data is referred to as a batch. The operation within the BN technique occurs to an entire batch of input values as opposed to a single input value.", "Typically in machine learning, it is common to normalize input data before passing the data to the input layer. The reason we normalize is partly to ensure that our model can generalize appropriately. This is achieved by ensuring that the scale of the values is balanced, and also the range of the values are maintained and proportional despite the scale change in the values.", "Normalization is typically carried out on the input data, but it would make sense that the flow of internal data within the network should remain normalized.", "BN is the internal enforcer of normalization within the input values passed between the layer of a neural network. Internal normalization limits the covariate shift that usually occurs to the activations within the layers.", "As mentioned earlier, the BN technique works by performing a series of operations on the input data coming into the BN layer. Below is a snippet of the mathematical notation of the BN algorithm on a mini-batch.", "The math notation in image above might seem intimidating, but there are the main key takeaways.", "Standardization is an operation that transforms a batch of input data to have a mean of zero and a standard deviation of one. Within the BN algorithm, we need to calculate the mean of the mini-batch and then the variance. The variance provides information on the standard deviation; we just simply have to square root the variance.", "Let\u2019s break down the mathematical notation of the algorithm and explain the process.", "This first operation calculates the mean of the inputs within a mini-batch. The result of the operation is a vector that contains each input\u2019s mean.", "\u2018m\u2019 refers to the number of inputs in the mini-batch.", "\u2018B\u2019 is a subscript that refers to the current batch.", "\u2018xi\u2019 is an instance of the input data.", "The mean(\u2018\u00b5\u2019) of a batch(\u2018B\u2019) is calculated by the sum of the several input instances of the batch and dividing it by the total number of inputs(\u2018m\u2019).", "In the operation above, the input variance (\u03c3\u00b2) is being calculated by squaring the standard deviations of the input. To calculate the standard deviations, we take each input instance(Xi) within the current mini-batch and subtract the mean(\u00b5B) of the mini-batch that was calculated in the previous operation and square the result.", "This value is then squared to obtain the variance(\u03c3).", "Now we have all the required values for zero-centring and normalizing the inputs. In the operation above we are putting the input data through a process of standardization. The terms standardization and normalization can be used interchangeably. There is a subtle difference between the two terms.", "In the operation above, the mean of the batch is subtracted from each input instant. Then we divide the result by the square root value of addition between the standard deviation value of the current batch and the smoothing term(\u03b5).", "The smoothing term(\u03b5) assures numerical stability within the operation by stopping a division by a zero value. The smoothing term is usually 0.00005.", "In the last operation is where rescaling and offsetting the of the input values occurs. The output of this operation is the result of the BN algorithm on the current mini-batch.", "In the final operation, we are introduced to two new components of the BN algorithm. The components are parameters vectors that are used for the scaling(\u03b3) and shifting(\u03b2) of the vector containing values from the previous operations. The values of the parameter vectors for scaling and shifting are learnable parameters. During neural network training, BN ensures that the learnable parameters are the optimal values that enable accurate normalization of each mini-batch.", "BN transformation is an effective method of increasing the performance of deep neural networks.", "The algorithm behind BN is not as complicated as it might seem.", "The complexity of the implementation of BN within a neural network is abstracted through the introduction of modern machine learning libraries such as TensorFlow and PyTorch. This makes implementing BN within a neural network a trivial task.", "It is still a worthwhile skill to understand how the Batch Normalization algorithm operates.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Content Creator with 1M+ views\u2014 Computer Vision Engineer. Interested in gaining and sharing knowledge on Technology and Finance"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F23d2794511c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----23d2794511c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----23d2794511c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://richmondalake.medium.com/?source=post_page-----23d2794511c--------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=post_page-----23d2794511c--------------------------------", "anchor_text": "Richmond Alake"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88797ba3f2f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&user=Richmond+Alake&userId=88797ba3f2f6&source=post_page-88797ba3f2f6----23d2794511c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F23d2794511c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F23d2794511c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@madebyvadim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Vadim Sherbakov"}, {"url": "https://unsplash.com/s/photos/breakdown?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1610.02357", "anchor_text": "Xception"}, {"url": "https://www.mathworks.com/help/deeplearning/ref/resnet50.html", "anchor_text": "ResNet50"}, {"url": "https://uk.mathworks.com/help/deeplearning/ref/inceptionv3.html", "anchor_text": "Inception V3"}, {"url": "https://arxiv.org/abs/1502.03167", "anchor_text": "paper"}, {"url": "https://arxiv.org/pdf/1502.03167.pdf", "anchor_text": "paper"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----23d2794511c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----23d2794511c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----23d2794511c---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/data-science?source=post_page-----23d2794511c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----23d2794511c---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F23d2794511c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&user=Richmond+Alake&userId=88797ba3f2f6&source=-----23d2794511c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F23d2794511c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&user=Richmond+Alake&userId=88797ba3f2f6&source=-----23d2794511c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F23d2794511c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----23d2794511c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F23d2794511c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----23d2794511c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----23d2794511c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----23d2794511c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----23d2794511c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----23d2794511c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----23d2794511c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----23d2794511c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----23d2794511c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----23d2794511c--------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richmond Alake"}, {"url": "https://richmondalake.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88797ba3f2f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&user=Richmond+Alake&userId=88797ba3f2f6&source=post_page-88797ba3f2f6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F366f35b0b39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatch-normalization-explained-algorithm-breakdown-23d2794511c&newsletterV3=88797ba3f2f6&newsletterV3Id=366f35b0b39b&user=Richmond+Alake&userId=88797ba3f2f6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}