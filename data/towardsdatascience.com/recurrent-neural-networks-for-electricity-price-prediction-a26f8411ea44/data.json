{"url": "https://towardsdatascience.com/recurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44", "time": 1683003587.544791, "path": "towardsdatascience.com/recurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44/", "webpage": {"metadata": {"title": "Recurrent Neural Networks for Electricity Price Prediction | by Carter Bouley | Towards Data Science", "h1": "Recurrent Neural Networks for Electricity Price Prediction", "description": "Demand flexibility can be described as the capacity for end users of electricity (think both business and homes) to change their electricity consumption patterns in response to market signals, such\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/Carterbouley/ElectricityPricePrediction/blob/master/multivariate_LSTM_electricity.ipynb", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://octopus.energy/agile/", "anchor_text": "Octopus Energy\u2019s Agile tariff", "paragraph_index": 4}, {"url": "https://github.com/Carterbouley/ElectricityPricePrediction/tree/master/data", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://github.com/Carterbouley/ElectricityPricePrediction/blob/master/re_fixed_multivariate_timeseires.csv", "anchor_text": "here", "paragraph_index": 11}], "all_paragraphs": ["The final model used to predict these prices can be found (here)", "Demand flexibility can be described as the capacity for end users of electricity (think both business and homes) to change their electricity consumption patterns in response to market signals, such as time variable electricity prices.", "Electricity prices follow daily, weekly and seasonal patterns. Above we can see the daily pattern. In the morning, everyone wakes up, turns all their devices on and prices rise. As the population goes off to work, demand and prices fall (and solar generation comes online). Come around 5pm people start leaving the office and heading back home, turning on TVs and doing laundry etc, prices rise once again, until bedtime, and prices fall. This cycle then repeats.", "Given the correlation of electricity prices and Carbon emissions (see my previous blog for this), if we can shift people away from peak times, to non-peak times we can make cost and carbon emission savings.", "Not many companies offer this day ahead price to their customers, but Octopus Energy\u2019s Agile tariff does exactly that.", "First however, an accurate prediction of the price would be useful.", "Usually when feature engineering, we need to ensure that our inputs are definitely helping (not hindering) the model. Luckily neural networks are pretty good at discerning what is helpful and what is not, so we can be pretty generous.", "The inputs of the production of electricity are probably quite helpful in determining the price. Below are plots taking data from 2013 to 2019.", "Each input seems to have some correlation with electricity price over time.", "On top of that, it is helpful to include temperature data, to account for seasonal variation. Summer may have higher prices due to air conditioning demand.", "All this data must be taken from different sources. I took Nordpools day ahead market for the price data, DarkSky API for temperatures, and Investing.com for commodity data. (This can all be found here.)", "Now, after some cleaning, I have a completed data frame (here).", "Because I am performing time series analysis, where the variable I am trying to predict is also used in the prediction I need to reshape the data into a supervised learning problem.", "Taking the values of the data frame (after scaling it for the neural network) I define that it can see 168 time steps backwards (1 week), and I want it to predict 24 hours ahead.", "What this does is it creates a window over the data data frame, so that I have a matrix of 192 rows X 6 columns. This window moves down the original data frame, row my row, creating a new matrix for every hour. If midday on January 1st 2013 is the first row of the first matrix, 1pm will be the first row of the second matrix.", "Adding dimensions like this will allow the neural network to understand that the order in which the hours come matter.", "Now that the data is in this format, I split it so we have blocks of 168 hours (1 week) of every feature for the input data, and for every 168 block of hours, we have a 24 hour output of prices, so our model can \u2018see\u2019 the next 24 hours. This transfers the data into a supervised learning problem.", "Now the X training data is 168 hours of the past of all commodities, and the Y training data is 24 hours of prices, into the future.", "With the data formatted to feed into the neural network, it was just a matter of trying different formats.", "After trying LSTM\u2019s, GRU\u2019s with convolutional layers, as well as classical machine learning (regression trees and ARIMA forecasting), a Recurrent Neural Network provided the best result.", "There are two important things to pick up on here, for those who are into the more technical side of things, and that is return_sequences=True, and the final time distributed layer of 24. the first ensures that the data keeps the same multidimensional (time-series) format through the network, and the second is that it outputs 24 hours into the future, in that same structure, hour by hour.", "For the prediction, I only care about that final 24th hour, as one hour later, there will be a new input, which will produces the next hour after that as a prediction.", "Having trained the model on 2013 to 2018, I used 2019 to assess how well the model worked on unseen data. Selecting a random few days so you can actually see the effect, its quite accurate.", "Given that the model now can predict the price of electricity 24 hours ahead of time, we can now adjust our consumption of electricity away from those peak times. This can mean setting our dryers, and appliances to run just when we go to sleep, or even investing in smart plugs to automate our devices that cycle (such as fridges, and air conditioning).", "For simplicity, I simulated a home battery. It is loosely based on a Tesla Powerwall 2, and it has 14KW capacity and 5 KW of power. For simplicity, this means it can hold almost 3 hours of charge. It looks at the 24 hour prediction from the model, and selects the 3 cheapest hours to charge at, and 3 most expensive hours to discharge at.", "It's unlikely you can sell electricity back to the grid at these day-ahead prices, however, for a valuation metric I simulated exactly that. Over the course of 2019, this battery would have spent \u00a3151.02 on charging, and \u2018earned\u2019 \u00a3280.23 from selling to the grid, leading to an 85.5% ROI. Considering this is quite a rudimentary battery model its not a bad result.", "Not bad, but not much money either. The really interesting scenarios come about when we begin to consider the true potential scale of flexible demand, and the fact that there are thousands of huge, 1MW + air conditioning units that can be doing exactly this, saving both carbon emissions, and generating huge cost savings.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist with a background in Economics \u2014 London"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa26f8411ea44&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@carterbouley?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carterbouley?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": "Carter Bouley"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bafa8e14c09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&user=Carter+Bouley&userId=5bafa8e14c09&source=post_page-5bafa8e14c09----a26f8411ea44---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa26f8411ea44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa26f8411ea44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/Carterbouley/ElectricityPricePrediction/blob/master/multivariate_LSTM_electricity.ipynb", "anchor_text": "here"}, {"url": "https://github.com/Carterbouley/ElectricityPricePrediction", "anchor_text": "ull GitHub repository"}, {"url": "https://octopus.energy/agile/", "anchor_text": "Octopus Energy\u2019s Agile tariff"}, {"url": "https://github.com/Carterbouley/ElectricityPricePrediction/tree/master/data", "anchor_text": "here"}, {"url": "https://github.com/Carterbouley/ElectricityPricePrediction/blob/master/re_fixed_multivariate_timeseires.csv", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a26f8411ea44---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----a26f8411ea44---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/energy?source=post_page-----a26f8411ea44---------------energy-----------------", "anchor_text": "Energy"}, {"url": "https://medium.com/tag/climate-change?source=post_page-----a26f8411ea44---------------climate_change-----------------", "anchor_text": "Climate Change"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----a26f8411ea44---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa26f8411ea44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&user=Carter+Bouley&userId=5bafa8e14c09&source=-----a26f8411ea44---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa26f8411ea44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&user=Carter+Bouley&userId=5bafa8e14c09&source=-----a26f8411ea44---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa26f8411ea44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa26f8411ea44&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a26f8411ea44---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a26f8411ea44--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a26f8411ea44--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a26f8411ea44--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a26f8411ea44--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carterbouley?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carterbouley?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Carter Bouley"}, {"url": "https://medium.com/@carterbouley/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bafa8e14c09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&user=Carter+Bouley&userId=5bafa8e14c09&source=post_page-5bafa8e14c09--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F943b53c93eeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frecurrent-neural-networks-for-electricity-price-prediction-a26f8411ea44&newsletterV3=5bafa8e14c09&newsletterV3Id=943b53c93eeb&user=Carter+Bouley&userId=5bafa8e14c09&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}