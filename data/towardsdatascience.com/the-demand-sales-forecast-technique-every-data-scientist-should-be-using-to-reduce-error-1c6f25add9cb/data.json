{"url": "https://towardsdatascience.com/the-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb", "time": 1683010553.419415, "path": "towardsdatascience.com/the-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb/", "webpage": {"metadata": {"title": "The Demand Sales Forecast Technique Every Data Scientist Should be Using to Reduce Error | by Federico Riveroll | Towards Data Science", "h1": "The Demand Sales Forecast Technique Every Data Scientist Should be Using to Reduce Error", "description": "Thousands of companies around the world, from small startups to global corporations, find great value in being able to accurately predict sales, and it\u2019s almost always one of the priorities for their\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/walmart-recruiting-store-sales-forecasting", "anchor_text": "Walmart Sales Forecast", "paragraph_index": 7}, {"url": "https://github.com/federico2001/walmart_data", "anchor_text": "here", "paragraph_index": 23}, {"url": "https://www.openblender.io/#/welcome/or/39", "anchor_text": "openblender.io", "paragraph_index": 36}, {"url": "https://www.openblender.io/#/dataset/explore/5e1deeda9516290a00c5f8f6/or/39", "anchor_text": "Walmart Tweets", "paragraph_index": 38}, {"url": "https://www.openblender.io/#/api_documentation", "anchor_text": "here", "paragraph_index": 40}, {"url": "https://www.openblender.io/#/dataset/explore/5e91029d9516297827b8f08c", "anchor_text": "Dollar index", "paragraph_index": 45}, {"url": "http://5e91045a9516297827b8f5b1", "anchor_text": "Oil price", "paragraph_index": 45}, {"url": "https://www.openblender.io/#/dataset/explore/5e979cf195162963e9c9853f", "anchor_text": "Monthly Consumer Sentiment", "paragraph_index": 45}], "all_paragraphs": ["\u201cTo better understand the marketplace, it is incumbent for organizations to look beyond their own four walls for data sources.\u201d", "Thousands of companies around the world, from small startups to global corporations, find great value in being able to accurately predict sales, and it\u2019s almost always one of the priorities for their Data Science / Analytics teams.", "However, all of them seem to attempt to increase accuracy (reduce error) by focusing on mainly two things:", "1) Feature engineering (getting the most out of your features)", "2) Model/parameter optimization (choosing the best model & best parameters)", "Both of the above are very necessary indeed, but there is a third thing that adds value in a complementary way, and it\u2019s wildly underused not only in this use case but in most data science projects:", "In this article, we\u2019ll do a simple sales forecast model and then blend external variables (properly done).", "There have been several implementations of the popular Walmart Sales Forecast competition to predict their sales.", "For this article, we\u2019ll use the data and improve a model only by combining external information.", "Walmart released data containing weekly sales for 99 departments (clothing, electronics, food\u2026) in every physical store along with some other added features.", "For this, we will create an ML model with \u2018Weekly_Sales\u2019 as target, and train with the first 70% observations and test on the posterior 30%.", "The objective is to minimize the Prediction error on future weekly sales.", "We\u2019ll add external variables that impact or have a relationship with sales such as dollar index, oil price and news about Walmart.", "We won\u2019t use model/parameter optimization nor feature engineering so we can distinguish the benefit from adding the external features.", "First, you need to have Python 3 installed and the following libraries:", "Then, open a Python script (preferably Jupyter notebook) and let\u2019s import the needed libraries.", "Now, let\u2019s define the methodology and model to be used on all experiments.", "First, the date range of the data is from Jan 2010 to Dec 2012. Let\u2019s define the first 70% of the data used for training and the posterior 30% for testing (because we don\u2019t want data leakage on our predictions).", "Next, let\u2019s define as our standard model a RandomForestRegressor with 50 estimators, which is a reasonably good option.", "Finally, to keep things as simple as possible, let\u2019s define the error as the absolute sum of errors.", "Now, let\u2019s put it in a Python class.", "Above we have an object with 3 elements:", "We will use this configuration for all of the experiments, although you can modify it as you want to test different models, parameters, configuration or whatever else. The value added will remain and could potentially improve.", "Now, let\u2019s get the Walmart data. You can get that csv here.", "There are 421, 570 observations. As we said before, the observations are registers of weekly sales by store per department.", "Let\u2019s plug the data into the model without tampering with it at all.", "The sum of all errors for the complete model is $ 967,705,992.5 USD from all the predictions vs. the real sales.", "This doesn\u2019t mean much by itself, the only reference is that the sum of all sales in that period is $ 6,737,218,987.11 USD.", "Since there is a whole lot of data, we will only focus on Store #1 for this tutorial, but the methodology is absolutely replicable for all stores.", "Let\u2019s take a look at the error generated by Store 1 alone.", "So, Store 1 is responsible for the $24,009,404.06 USD error and this will be our threshold for comparison.", "Now let\u2019s break down the error by department to have more visibility later.", "Now we have a dataframe with the errors corresponding to each department on Store 1 with our threshold model.", "Lets select department 1 to make a simple example.", "Now, lets search for intersected datasets.", "Now, let\u2019s search in OpenBlender for time intersected (overlapped) datasets about \u2018business\u2019 or \u2018walmart\u2019.", "Note: To get a token you need have to create an account on openblender.io (free), you\u2019ll find it in the \u2018Account\u2019 tab on your profile icon.", "The search found several datasets. We can see name, description, url, features, and most importantly, time interesction with ours so we can blend them to our dataset.", "Let\u2019s start by blending this Walmart Tweets dataset and look for promos.", "We can blend new columns to our dataset by searching terms on texts or news aggregated by time. For instance, we could create a \u2018promo\u2019 feature with the number of mentions which will match our self made ngrams:", "The parameters for the timeBlend function (you can find the documentation here):", "We now have our original dataset but with 2 new columns, the \u2018COUNT\u2019 of our \u2018promo\u2019 feature and a list of the actual texts in case one wants to iterate through each one.", "So now we have a numerical feature about how many times our ngrams were mentioned. We could probably do better ngrams if we knew which store or department corresponds to \u20181\u2019 (Walmart didn\u2019t share that).", "Let\u2019s apply the Standard Model and compare the error vs. the original.", "But this doesn\u2019t prove much, it could be that the RandomForest got lucky. After all, the original model trained with over 299K observations. The current one only training with 102!!", "We can also blend numerical features. Let\u2019s try blending Dollar index, Oil price, and Monthly Consumer Sentiment", "Now we have 6 more features, the average of oil index, dollar index and consumer sentiment on the 7 day intervals and the count of each (which for this case is irrelevant).", "So let\u2019s now try it with every department separately to measure how consistent the benefit is.", "To get a glimpse, we\u2019re gonna experiment with the first 10 Departments first and compare the benefit of adding each additional source.", "Let\u2019s get the results into a DataFrame and visualize.", "Departments 4 and 6 are on a higher order than the rest Let\u2019s remove them to take a closer look at the rest.", "We can see that almost on all departments the error lowered as we added new features. We can also see that the Oil Index (third feature) was not only not helpful but even harmful for some departments.", "I excluded the Oil Index and ran the algorithm with the 3 features on all the departments (which you can do by iterating all the error_summary_df and not just the first 10).", "These are the results of the \u20183 feature\u2019 blend and the improvement percentage on all departments:", "Not only did the added features improve the error on over 88% of the Departments, but some improvements were significant.", "This is the histogram for the improvement percentage.", "And this is just one store.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An attempt to separate signal from noise. | MSDS"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1c6f25add9cb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://federicoriveroll.medium.com/?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": "Federico Riveroll"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6be3377832b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&user=Federico+Riveroll&userId=b6be3377832b&source=post_page-b6be3377832b----1c6f25add9cb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1c6f25add9cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1c6f25add9cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/walmart-recruiting-store-sales-forecasting", "anchor_text": "Walmart Sales Forecast"}, {"url": "https://github.com/federico2001/walmart_data", "anchor_text": "here"}, {"url": "https://www.openblender.io/#/welcome/or/39", "anchor_text": "openblender.io"}, {"url": "https://www.openblender.io/#/dataset/explore/5e1deeda9516290a00c5f8f6/or/39", "anchor_text": "Walmart Tweets"}, {"url": "https://www.openblender.io/#/api_documentation", "anchor_text": "here"}, {"url": "https://www.openblender.io/#/dataset/explore/5e91029d9516297827b8f08c", "anchor_text": "Dollar index"}, {"url": "http://5e91045a9516297827b8f5b1", "anchor_text": "Oil price"}, {"url": "https://www.openblender.io/#/dataset/explore/5e979cf195162963e9c9853f", "anchor_text": "Monthly Consumer Sentiment"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1c6f25add9cb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----1c6f25add9cb---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/tag/python?source=post_page-----1c6f25add9cb---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1c6f25add9cb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----1c6f25add9cb---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1c6f25add9cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&user=Federico+Riveroll&userId=b6be3377832b&source=-----1c6f25add9cb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1c6f25add9cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&user=Federico+Riveroll&userId=b6be3377832b&source=-----1c6f25add9cb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1c6f25add9cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1c6f25add9cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1c6f25add9cb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1c6f25add9cb--------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Federico Riveroll"}, {"url": "https://federicoriveroll.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6be3377832b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&user=Federico+Riveroll&userId=b6be3377832b&source=post_page-b6be3377832b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb9c3878e20f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-demand-sales-forecast-technique-every-data-scientist-should-be-using-to-reduce-error-1c6f25add9cb&newsletterV3=b6be3377832b&newsletterV3Id=b9c3878e20f9&user=Federico+Riveroll&userId=b6be3377832b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}