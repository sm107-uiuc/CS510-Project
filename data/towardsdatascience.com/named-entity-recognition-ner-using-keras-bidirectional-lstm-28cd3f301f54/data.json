{"url": "https://towardsdatascience.com/named-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54", "time": 1683010082.29158, "path": "towardsdatascience.com/named-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54/", "webpage": {"metadata": {"title": "Named-Entity Recognition using Keras Bi-LSTM | Towards Data Science", "h1": "Named-Entity Recognition (NER) using Keras Bidirectional LSTM", "description": "Use Bi-LSTM to build a muti label classifier for named entity recognition in Keras"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Named-entity_recognition", "anchor_text": "Named-entity recognition (NER)", "paragraph_index": 0}, {"url": "https://www.kaggle.com/abhinavwalia95/entity-annotated-corpus", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.kaggle.com/abhinavwalia95/entity-annotated-corpus?select=ner_dataset.csv", "anchor_text": "link", "paragraph_index": 2}, {"url": "https://github.com/snehalnair/Named-Entity-Recognition", "anchor_text": "Github Repository", "paragraph_index": 22}], "all_paragraphs": ["Named-entity recognition (NER) (also known as entity identification, entity chunking, and entity extraction) is a sub-task of information extraction that seeks to locate and classify named entities mentioned in unstructured text into pre-defined categories such as person names, organizations, locations, medical codes, time expressions, quantities, monetary values, percentages, etc.", "In this project, we will work with a NER dataset provided by Kaggle. The dataset can be accessed here. This dataset is the extract from the GMB corpus, which is tagged, annotated, and built specifically to train the classifier to predict named entities such as name, location, etc. Dataset also includes one additional feature, POS (parts of speech) that can be used in classification. In this project, however, we are working only with one feature sentence.", "Let us begin by loading and visualizing the dataset. To download ner_dataset.csv, go to this link in Kaggle.", "Please use encoding = \u2018unicode_escape\u2019 while loading the data. This function takes a parameter to toggle the wrapping quotes\u2019 addition and escape that quote\u2019s quote in a string.", "Note that the sentences in the dataset are tokenized in the column \u201cWord\u201d. The column \u201csentence #\u201d displays the sentence number once and then prints NaN until the next sentence begins. The \u2018Tag\u2019 column will be our label (y).", "To train a neural network, we will use two mappings as given below.", "This step is desired in any machine learning model, including the neural network, which requires integers as input.", "We can see that the function has added two new index columns for our X (Word_idx) and y (Tag_idx) variables. Next, let us collect tokens into arrays in the respective sequence to make the recurrent neural network\u2019s best use.", "To transform columns into sequential arrays, we will", "Padding: The LSTM layers accept sequences of the same length only. Therefore, every sentence represented as integers (\u2018Word_idx\u2019) must be padded to have the same length. We will work with the max length of the longest sequence and pad the shorter sequences to achieve this.", "Please note we can use shorter padding lengths as well. In that case, you will be padding the shorter sequences and truncating the longer sequences.", "We will also be converting the y variable as one-hot encoded vector using the to_categorical function in Keras. Let us import the required packages.", "Neural network models work with graphical structure. Therefore we will first need to design the architecture and set input and out dimensions for every layer. RNNs are capable of handling different input and output combinations. We will use \u201cmany to many\u201d architectures for this task. Refer to the last architecture in the image given below. Our task is to output tag (y) for a token (X) ingested at each time step.", "Let\u2019s begin by loading, the required packages.", "It\u2019s always best to set a seed for reproducibility.", "To build a better understanding of the layers\u2019 input and output dimensions, compare the layers in the model plot with the brief on each layer given in the image (model plot) below.", "In this architecture, we are primarily working with three layers (embedding, bi-lstm, lstm layers) and the 4th layer, which is TimeDistributed Dense layer, to output the result. We will discuss the layers in detail in the below sections.", "The dimensions (?, 104, 64) that we see in the given neural network plot\u2019s embedding layer come from these specifications. Please note the 1st dimension shows \u2018?\u2019 or None in the plots. They represent the batch sizes. If it is not provided, they show \u2018?\u2019 or None, which means the model can take any batch size.", "Since this is bidirectional lstm, we will have forward and backward outputs. Combine these outputs before passing them to the next layer by summing or taking average or concatenating or multiplying. Find these functions in the merge mode argument in the bi-lstm layer. The outputs are concatenated in the default mode, which in turn doubles the number of outputs to the next layer. In our case, it becomes 128(64 * 2).", "This layer takes the output dimension of the previous lstm layer (104, 256) and outputs the max sequence length (104) and max tags (17).", "Given below is the code used to build the model architecture we discussed above. Before fitting the model, check the model graph by plotting the model using plot_model function or run model.summary() for the model summary.", "We will fit the model with a for loop to save and visualize the loss at every epoch.", "Please experiment with the model with different batch sizes, dropout value, optimizers, metrics, and layers to a better result. Find the complete code for this project in the Github Repository.", "For anyone interested, here is a piece of code that will highlight the entities in any given sentence using spaCy.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F28cd3f301f54&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@snehalnair", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@snehalnair?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@snehalnair?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": "Snehal Nair"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8608717798b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&user=Snehal+Nair&userId=8608717798b8&source=post_page-8608717798b8----28cd3f301f54---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28cd3f301f54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28cd3f301f54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Named-entity_recognition", "anchor_text": "Named-entity recognition (NER)"}, {"url": "https://www.kaggle.com/abhinavwalia95/entity-annotated-corpus", "anchor_text": "here"}, {"url": "https://www.kaggle.com/abhinavwalia95/entity-annotated-corpus?select=ner_dataset.csv", "anchor_text": "link"}, {"url": "https://adventuresinmachinelearning.com/keras-lstm-tutorial/", "anchor_text": "LSTM"}, {"url": "https://github.com/snehalnair/Named-Entity-Recognition", "anchor_text": "Github Repository"}, {"url": "https://github.com/keras-team/keras/issues/1029", "anchor_text": "When and How to use TimeDistributedDense \u00b7 Issue #1029 \u00b7 keras-team/kerasDismiss GitHub is home to over 50 million developers working together to host and review code, manage projects, and\u2026github.com"}, {"url": "https://machinelearningmastery.com/timedistributed-layer-for-long-short-term-memory-networks-in-python/", "anchor_text": "How to Use the TimeDistributed Layer in Keras - Machine Learning MasteryLast Updated on Long Short-Term Networks or LSTMs are a popular and powerful type of Recurrent Neural Network, or RNN\u2026machinelearningmastery.com"}, {"url": "https://medium.com/tag/named-entity-recognition?source=post_page-----28cd3f301f54---------------named_entity_recognition-----------------", "anchor_text": "Named Entity Recognition"}, {"url": "https://medium.com/tag/ner?source=post_page-----28cd3f301f54---------------ner-----------------", "anchor_text": "Ner"}, {"url": "https://medium.com/tag/keras?source=post_page-----28cd3f301f54---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/bidirectional?source=post_page-----28cd3f301f54---------------bidirectional-----------------", "anchor_text": "Bidirectional"}, {"url": "https://medium.com/tag/bi-lstm?source=post_page-----28cd3f301f54---------------bi_lstm-----------------", "anchor_text": "Bi Lstm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28cd3f301f54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&user=Snehal+Nair&userId=8608717798b8&source=-----28cd3f301f54---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28cd3f301f54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&user=Snehal+Nair&userId=8608717798b8&source=-----28cd3f301f54---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28cd3f301f54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F28cd3f301f54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----28cd3f301f54---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----28cd3f301f54--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----28cd3f301f54--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----28cd3f301f54--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----28cd3f301f54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@snehalnair?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@snehalnair?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Snehal Nair"}, {"url": "https://medium.com/@snehalnair/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "165 Followers"}, {"url": "https://www.linkedin.com/in/snehal-nair-5351998/", "anchor_text": "https://www.linkedin.com/in/snehal-nair-5351998/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8608717798b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&user=Snehal+Nair&userId=8608717798b8&source=post_page-8608717798b8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcf6738b778fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-entity-recognition-ner-using-keras-bidirectional-lstm-28cd3f301f54&newsletterV3=8608717798b8&newsletterV3Id=cf6738b778fa&user=Snehal+Nair&userId=8608717798b8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}