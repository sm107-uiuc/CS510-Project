{"url": "https://towardsdatascience.com/designing-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a", "time": 1683017316.479127, "path": "towardsdatascience.com/designing-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a/", "webpage": {"metadata": {"title": "Designing AI Agents\u2019 Behaviors with Behavior Trees | by Debby Nirwan | Towards Data Science", "h1": "Designing AI Agents\u2019 Behaviors with Behavior Trees", "description": "In our previous posts, we discussed about Planning and Acting. Both are for planning, one with a Descriptive Model and the other with an Operational Model of actions. Acting with Operational Model\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In our previous posts, we discussed about Planning and Acting. Both are for planning, one with a Descriptive Model and the other with an Operational Model of actions.", "Acting with Operational Model uses Refinement Methods to refine abstract tasks into subtasks or commands that can be executed by Execution Platform. In a rather complex domain where there are multiple methods that we can use to refine a task, this approach excels.", "However, for many less complex systems, we only have one/two methods that we can use to refine an abstract task into. One may argue that we don\u2019t need planning in these systems. What we need is:", "A hierarchical reactive and modular control system.", "Which is what Behavior Tree is. In this post, I will explain the Behavior Tree and implement it on our Pacman to show that Behavior Tree is easy to understand and powerful in reacting to real-time changes in a dynamic world.", "Behavior trees are similar to HFSM (Hierarchical Finite State Machines \u2014 we\u2019ll discuss about it in another article) in which we can use them to structure the refinement and switching of tasks in the Acting Engine.", "There are two main advantages in using behavior trees:", "By splitting the logical parts of the program into tasks, we basically improve the modularity of our software. A task can be a Behavior Tree which can be implemented as a single software module.", "Behavior Trees use the concept of Tick, a signal that is sent in a fixed frequency, which starts from the root node and is propagated to its children. By doing this Behavior Trees can react in real-time to events that happen in the world.", "As the name suggests, a Behavior Tree is a tree data structure which has two main types of nodes:", "As mentioned in the previous section, BT uses a signal called Tick started from the Root Node and propagated to its children (left-to-right) until certain conditions happen.", "A node has a program that is executed only when it receives a Tick signal.", "When ticked, a node executes its program or propagate the Tick signal if it is a Control Flow node. A node has to return status to its parent. The status is either one of these below:", "There are four different types of Control Nodes:", "There are two different types of Execution Nodes:", "We mentioned above that one of the advantages of Behavior Trees is its reactivity. However, in some systems checking the whole trees every tick might be considered too excessive.", "This is true for systems that don\u2019t require reactivity such as those in a structured environment, for example, a robotic arm in a factory where its environment is static.", "For that, we can use the nonreactive Control Nodes.", "In nonreactive Control Nodes, only children that are running or not ticked are sent the Tick signal.", "Now let\u2019s see an example to get a feeling of how a behavior tree works.", "Imagine that we have a humanoid robot and we want it to go around the house helping us to do the chores.", "For our robot to go from Room 1 to Room 2, we need, let\u2019s call it Go-To Behavior Tree. The robot has to do the following:", "It\u2019s simple, isn\u2019t it? Now let\u2019s see how the Behavior Tree for that looks like.", "In a high-level view, this is our behavior tree for Go-To. For this example all our Control Nodes are reactive. Meaning that they don\u2019t memorize the status of their children.", "When InRoom2 is ticked(dashed arrow), if the robot is already in Room 2, it returns SUCCESS and the whole tree terminates. Otherwise, it continues ticking the next node.", "When InRoom2 returns FAILURE (red arrow), the tick is propagated to AtTheDoor to check whether the robot is already at the door or not. If it is already at the door, the fallback node returns SUCCESS (blue arrow) and the sequence node carries on to check whether the door is opened or closed.", "Let\u2019s assume that the door is closed, so the next few ticks we will tick OpenTheDoor to initiate the command and wait for its completion.", "If this action fails (returns FAILURE), the whole tree terminates with status FAILURE. But let\u2019s assume that it succeeds and returns SUCCESS.", "Our robot carries on to execute EnterTheRoom command, and once it is done, the tree looks like this, where only InRoom2 is ticked.", "The robot is now in Room 2.", "After going through this example, we can see that the Behavior Tree is very powerful and easy to understand. We can easily design the behaviors that we want our AI agents to have.", "In the next section, we\u2019ll implement Behavior Trees for our AI Agent, Pacman, and see how it can complete the task we ask it to do and react to changes in the environment.", "Let\u2019s start by giving our AI Agent \u2014 Pacman, a problem. Here it is:", "This is by far the most challenging problem that we give to Pacman. Four ghosts to avoid while trying to eat five foods. To help him, we provide five pills which when eaten will temporarily make the ghosts edible.", "First, we design the behaviors for our Pacman, the behaviors are the Execution Nodes(leaf nodes) in the behavior tree.", "Totally we have eight behaviors that we will use for our Pacman.", "Next, we design the whole trees by adding Control Flow Nodes.", "The picture above shows the complete behavior trees of our Pacman agent. Please try to enlarge the picture on your browser to help you see it more clearly.", "In the picture, we see new nodes such as Control Nodes with * which are Nonreactive Control Nodes, and Inverter which is a Decorator node which inverts the result of its child.", "The whole trees terminate when there are no more FoodsAvailable. If there are FoodsAvailable Pacman will try to eat a pill and a food. If it gets too close while trying to eat food or a pill it will execute AvoidGhosts.", "Eating food and eating a pill use Nonreactive Sequence Node, it is necessary because we don\u2019t want to change the destination while executing a planned path. This is shown in the diagram as a sequence of FindClosestPill, PlanAPath, and ExecutePlannedPath.", "After all pills have been eaten, the subtree for that always returns SUCCESS and the Pacman will only execute eat a pill subtree.", "You may have noticed that some subtrees are similar, they can be implemented as a parameterized software module which means we can re-use same modules for multiple subtrees.", "When we want to change the behavior of our agent, we can also move a subtree from one place to another.", "With the use of reactive control nodes our agent, Pacman, is able to react to events that occur in his environment.", "The video above shows how Pacman can complete the task to eat all foods while avoiding ghosts. Behavior trees implementation works well on our Pacman Agent.", "Behavior trees are commonly used in video games for implementing the Non Player Characters (NPC) and also in robotics.", "We have also seen the advantages of BTs in Modularity and Reactivity. BTs are able to solve complex problems such as Pacman videos shown above.", "Next time, we may want to incorporate planning into BTs so that we can have a more intelligent system.", "Finally, if you want to try to implement behavior trees, some open source libraries are available.", "Hopefully, this article helps you understand the Behavior Trees. If you like this article please give me claps and read my other posts if you\u2019re interested in Automated Planning and Acting.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineering Manager who loves reading, writing, and coding."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb28aa1c3cf8a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://debby-nirwan.medium.com/?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": ""}, {"url": "https://debby-nirwan.medium.com/?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": "Debby Nirwan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcfe9f4cd0e8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&user=Debby+Nirwan&userId=cfe9f4cd0e8f&source=post_page-cfe9f4cd0e8f----b28aa1c3cf8a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb28aa1c3cf8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb28aa1c3cf8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/splintered-reality/py_trees", "anchor_text": "splintered-reality/py_treesAbout][ Docs & Demos][ Releases][ Installation][ PyTrees-Ros Ecosystem] PyTrees is a python implementation of behaviour\u2026github.com"}, {"url": "https://github.com/BehaviorTree/BehaviorTree.CPP", "anchor_text": "BehaviorTree/BehaviorTree.CPPThis C++ 14 library provides a framework to create BehaviorTrees. It was designed to be flexible, easy to use, reactive\u2026github.com"}, {"url": "https://medium.com/tag/behavior-trees?source=post_page-----b28aa1c3cf8a---------------behavior_trees-----------------", "anchor_text": "Behavior Trees"}, {"url": "https://medium.com/tag/behaviour-tree?source=post_page-----b28aa1c3cf8a---------------behaviour_tree-----------------", "anchor_text": "Behaviour Tree"}, {"url": "https://medium.com/tag/automated-planning?source=post_page-----b28aa1c3cf8a---------------automated_planning-----------------", "anchor_text": "Automated Planning"}, {"url": "https://medium.com/tag/ai-planning?source=post_page-----b28aa1c3cf8a---------------ai_planning-----------------", "anchor_text": "Ai Planning"}, {"url": "https://medium.com/tag/robotics?source=post_page-----b28aa1c3cf8a---------------robotics-----------------", "anchor_text": "Robotics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb28aa1c3cf8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&user=Debby+Nirwan&userId=cfe9f4cd0e8f&source=-----b28aa1c3cf8a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb28aa1c3cf8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&user=Debby+Nirwan&userId=cfe9f4cd0e8f&source=-----b28aa1c3cf8a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb28aa1c3cf8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb28aa1c3cf8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b28aa1c3cf8a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b28aa1c3cf8a--------------------------------", "anchor_text": ""}, {"url": "https://debby-nirwan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://debby-nirwan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Debby Nirwan"}, {"url": "https://debby-nirwan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "773 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcfe9f4cd0e8f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&user=Debby+Nirwan&userId=cfe9f4cd0e8f&source=post_page-cfe9f4cd0e8f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5abacf9d5119&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdesigning-ai-agents-behaviors-with-behavior-trees-b28aa1c3cf8a&newsletterV3=cfe9f4cd0e8f&newsletterV3Id=5abacf9d5119&user=Debby+Nirwan&userId=cfe9f4cd0e8f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}