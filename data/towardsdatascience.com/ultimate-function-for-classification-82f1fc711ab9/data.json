{"url": "https://towardsdatascience.com/ultimate-function-for-classification-82f1fc711ab9", "time": 1683014419.538487, "path": "towardsdatascience.com/ultimate-function-for-classification-82f1fc711ab9/", "webpage": {"metadata": {"title": "Ultimate Function for Classification | by Darius Fuller | Towards Data Science", "h1": "Ultimate Function for Classification", "description": "In this post, I will go over how I created a function in Python that easily displays some performance metrics of a trained classification model. Since this function came about as part of a larger\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/", "anchor_text": "Sci-Kit Learn", "paragraph_index": 0}, {"url": "https://matplotlib.org/3.3.1/index.html", "anchor_text": "Matplotlib", "paragraph_index": 0}, {"url": "https://pandas.pydata.org/pandas-docs/stable/index.html", "anchor_text": "Pandas", "paragraph_index": 0}, {"url": "https://www.scikit-yb.org/en/latest/index.html", "anchor_text": "Yellowbrick\u2019s", "paragraph_index": 0}, {"url": "https://www.ufc.com/about", "anchor_text": "UFC", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Greg_Jackson_(MMA_trainer)", "anchor_text": "Greg Jackson", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Ultimate_Fighting_Championship#Rules", "anchor_text": "Wikipedia page", "paragraph_index": 3}, {"url": "https://www.kaggle.com/rajeevw/ufcdata", "anchor_text": "link", "paragraph_index": 6}, {"url": "https://towardsdatascience.com/the-ultimate-guide-to-data-cleaning-3969843991d4", "anchor_text": "link", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Supervised_learning#:~:text=Supervised%20learning%20is%20the%20machine,a%20set%20of%20training%20examples.", "anchor_text": "supervised learning", "paragraph_index": 16}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html?highlight=classification#sklearn.metrics.classification_report", "anchor_text": "classification report", "paragraph_index": 17}, {"url": "https://www.kdnuggets.com/2020/04/performance-evaluation-metrics-classification.html", "anchor_text": "link", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62", "anchor_text": "link", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Receiver_operating_characteristic", "anchor_text": "Receiver Operating Characteristic", "paragraph_index": 25}, {"url": "https://en.wikipedia.org/wiki/Sensitivity_and_specificity", "anchor_text": "Wikipedia", "paragraph_index": 25}, {"url": "https://www.scikit-yb.org/en/latest/api/model_selection/importances.html", "anchor_text": "More on feature importances", "paragraph_index": 31}, {"url": "https://gist.github.com/dfuller22/a9827d49ecda72240b084552a8cf7c88", "anchor_text": "code for plot_importance()", "paragraph_index": 31}], "all_paragraphs": ["In this post, I will go over how I created a function in Python that easily displays some performance metrics of a trained classification model. Since this function came about as part of a larger task, I will provide context along the way to help clarify as I share images and code of my process. Primarily I will be working with the Sci-Kit Learn and Matplotlib packages but have a special appearance from Pandas plotting method, Yellowbrick\u2019s classifier module.", "I was given a simple project: use a premade data set to create a use case for a classification model, then create that model. Essentially with a blank slate, I faced an entire internet\u2019s worth of possible data sets to take as the one. Eventually I settled on something sports related, and out of all of the sports I expected to come across, I found one on UFC fights.", "If you aren\u2019t familiar with the sport, the Ultimate Fighting Championship (UFC) is a mixed martial arts promoter. Mixed martial arts, frequently referred to as MMA, is a fighting style that is a non-specific blend of multiple traditional fighting disciplines. A great example of blending fighting styles is the fighter Jon Jones. He went from a national junior college wrestling champion to obtaining a purple belt in Brazilian Jiu-Jitsu (BJJ) and a black belt in Gaidojutsu; Gaidojutsu itself being a fighting style developed in 1992 by Greg Jackson using techniques from catch wrestling, BJJ, kickboxing, and judo.", "Beyond the greater freedom in how one is allowed to fight in MMA matches, the structure generally follows that of others combat sports such as boxing or wrestling. If you are curious about how it all works on a finer level, I recommend reading the \u201cRules\u201d section on this Wikipedia page.", "I was a big fan during the early 2010s; I had the video games, watched the shows, knew the fighters, etc. If there was one thing I remember about watching these fights, it\u2019s how unpredictable they felt. It seemed that until someone gets knocked down or put in a submission that either fighter could win, no matter the situation. No matter how much of an underdog a particular fighter was statistically, they still had a chance to win and occasionally would shock the MMA community in doing so. It was those unpredictable moments that inspired me to use this data set for my project. The big question I wanted to answer was:", "Can I predict the winner of a MMA fight based upon their prior performance?", "As mentioned before, one of my few restrictions in this project was that the data set needed to be already compiled before I start working with it. I started by going to Kaggle and a lot of time looking up data sets. While using the \u201csports\u201d tag I found \u201cUFC-Fight historical data from 1993 to 2019\u201d posted by Rajeev Warrier (link). This data set had an extensive amount of information on over 5,000 fights, containing 145 features on various aspects of the fights.", "**These averages dealt with advanced stats such as: significant strikes, submissions, passing on the ground, etc.**", "You will need to have these packages installed in order to follow along:", "I will be walking through the creation of this function with respect to my project on the UFC, although this function should work on any cleaned data set prepped for machine learning. If you need any information on how to do that and some good strategies, check out this data cleaning guide by Omar Elgabry (link).", "Otherwise, for brevity I will skip directly into the point where I can create my classifier evaluation function. At this point with the data set I have:", "Here\u2019s a small peek into what the DataFrame looks like:", "This is the easy part! Sci-Kit Learn really makes it simple to fit a model to training data and predict on new inputs. All you need to do is first instantiate your Sci-Kit Learn machine learning model of choice and use it\u2019s .fit() and .predict() methods.", "One unique aspect about this code is the use of the multi_class= parameter, which will only be relevant if you are trying to predict more the two classes. In my project, for each fighter I was looking to predict if their match will end (for them) in a:", "This important detail is why we will need to use the Yellowbrick package later when visualizing the performance of our model when predicting outcomes, but for now let\u2019s look at how to functionize this process.", "If you take a closer look, there really is not much of a change here. The variables (including the classifier itself) needed to be generalized and placed as required parameters. But besides the addition of a \u201creturn\u201d statement for the predictions, that is all I needed to do!", "So now that I have a model that can predict the winner of a UFC fight, I need a way to confirm it\u2019s accuracy. I can do this by using the data fed in as inputs for those same predictions as the ground truth, since we already had the correct outcomes for the model to learn from. This is why this type of task is called supervised learning, as we will be able to adjust (or supervise) how our model learns in hopes of improving it\u2019s performance when predicting on unseen data.", "Once again, Sci-Kit Learn makes this super easy to do once a model has been trained upon some data. The classification report function found in the metrics module can generate the four commonly used classification measures in a convenient manner for the user. All that one needs to do is feed in the true and predicted labels for the data to get results!", "Here\u2019s an example from my project:", "For such a simple implementation, the classification report from Sci-Kit Learn brings a lot to the table when trying to evaluate the performance of a classifier. It provides the main classification metrics on an aggregate and individual label level, which can help to identify strategies for tuning your model or explaining it\u2019s performance. In a general sense, these metrics are:", "If this stuff seems a bit off and you\u2019d like to know some more, I recommend checking this post out Clare Liu (link).", "Although it may seem as if the classification report has everything already (it kind of does), there is actually couple more things that can be easily added into this function to help round out the information displayed. I will next show how to create a confusion matrix and a ROC curve before putting it all together into one function.", "A confusion matrix is a great tool for visualizing the performance of a classification model. In a nutshell, it is a square divided into smaller squares that represent the values for true and false positives in addition to the true and false negatives. It\u2019s a bit easier to understand visually:", "Starting from the top left and going diagonally downwards, these values represent true values; alternatively they are the recall values for that specific class. Additional information about them can be found in this post by Sarang Narkhede (link).", "Confusion matrices are also easy to implement thanks to Sci-Kit Learn, here\u2019s how to do it:", "The second plot that I added into my function is a bit advanced, but can offer some interesting insights when evaluating a model\u2019s performance. The ROC (Receiver Operating Characteristic) curve, in simple terms, illustrates the tradeoff between the true positive rate (TPR) and false positive rate (FPR). If you want to get more into the math behind these rates, Wikipedia does a dense, but great job detailing the formulas.", "The ideal ROC curve will look like a smoother, sloped version of an upside-down \u201cL\u201d. Hopefully this will make more sense after looking at one:", "The above example is from one of the poorer performing models I tested during my project. The two lines representing the TPRs and FPRs for each class stay relatively close to the black dotted line; this black line represents the \u201crandom chance\u201d line, where the chance of being correct is essentially 50%. Thus, this model was not much better than flipping a coin and choosing which fighter would win. An ideal ROC curve would have a TPR that increases faster than the FPR, resulting in that upside-down \u201cL\u201d shape I was referring to.", "Normally, if one is training a binary classification model, this plot can be produced using Sci-Kit Learn. However, since I was predicting three different classes, I will show how I created a ROC curve using the Yellowbrick package that allows for multi-class curves (no need to specify either).", "Now its time to put all the code from above together into one, reusable function that can produce everything previously discussed in one line of code!", "I\u2019ll break it down in steps:", "Side note: In line 48 I use a custom function named plot_importance(). It\u2019s purpose as an add-on is to display, as an option, an additional plot that is only relevant to a decision tree classification model. More on feature importances; code for plot_importance().", "Here\u2019s an example of what this outputs:", "So if you\u2019ve been following along, you should have a fully functioning, function that will easily display a general report and two plots concerning the performance of a supervised classification model. Through the use of this function, one can quickly assess how well a model is learning the training data; doing so on a deeper level than each of the three tools could provide alone. I intended this function to be used as a judge for multiple classifiers when selecting one to train on a specific data set and also as a way to give insight during the tuning process. I would be interested to see what other uses may come of it as-is or altered (let me know!).", "Granted in order to create this function, there does need to be some preparation, but overall using it saved me a bunch of time during this project. I hope it will do the same for others!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F82f1fc711ab9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dariuslfuller.medium.com/?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": ""}, {"url": "https://dariuslfuller.medium.com/?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": "Darius Fuller"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd69ec7c31631&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&user=Darius+Fuller&userId=d69ec7c31631&source=post_page-d69ec7c31631----82f1fc711ab9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82f1fc711ab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82f1fc711ab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@bayleejadegramling?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Baylee Gramling"}, {"url": "https://unsplash.com/s/photos/fighting?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Sci-Kit Learn"}, {"url": "https://matplotlib.org/3.3.1/index.html", "anchor_text": "Matplotlib"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/index.html", "anchor_text": "Pandas"}, {"url": "https://www.scikit-yb.org/en/latest/index.html", "anchor_text": "Yellowbrick\u2019s"}, {"url": "https://www.ufc.com/about", "anchor_text": "UFC"}, {"url": "https://en.wikipedia.org/wiki/Greg_Jackson_(MMA_trainer)", "anchor_text": "Greg Jackson"}, {"url": "https://en.wikipedia.org/wiki/Ultimate_Fighting_Championship#Rules", "anchor_text": "Wikipedia page"}, {"url": "https://www.kaggle.com/rajeevw/ufcdata", "anchor_text": "link"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Sci-Kit Learn"}, {"url": "https://matplotlib.org/3.3.1/index.html", "anchor_text": "Matplotlib"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/index.html", "anchor_text": "Pandas"}, {"url": "https://www.scikit-yb.org/en/latest/index.html", "anchor_text": "Yellowbrick"}, {"url": "https://towardsdatascience.com/the-ultimate-guide-to-data-cleaning-3969843991d4", "anchor_text": "link"}, {"url": "https://en.wikipedia.org/wiki/Supervised_learning#:~:text=Supervised%20learning%20is%20the%20machine,a%20set%20of%20training%20examples.", "anchor_text": "supervised learning"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html?highlight=classification#sklearn.metrics.classification_report", "anchor_text": "classification report"}, {"url": "https://developers.google.com/machine-learning/crash-course/classification/accuracy", "anchor_text": "Accuracy"}, {"url": "https://www.kdnuggets.com/2020/04/performance-evaluation-metrics-classification.html", "anchor_text": "link"}, {"url": "https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62", "anchor_text": "link"}, {"url": "https://en.wikipedia.org/wiki/Receiver_operating_characteristic", "anchor_text": "Receiver Operating Characteristic"}, {"url": "https://en.wikipedia.org/wiki/Sensitivity_and_specificity", "anchor_text": "Wikipedia"}, {"url": "https://www.scikit-yb.org/en/latest/api/model_selection/importances.html", "anchor_text": "More on feature importances"}, {"url": "https://gist.github.com/dfuller22/a9827d49ecda72240b084552a8cf7c88", "anchor_text": "code for plot_importance()"}, {"url": "https://github.com/dfuller22/dsc-mod-3-project-v2-1-online-ds-pt-100719", "anchor_text": "Link to UFC classification project"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----82f1fc711ab9---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/classification?source=post_page-----82f1fc711ab9---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/functional-programming?source=post_page-----82f1fc711ab9---------------functional_programming-----------------", "anchor_text": "Functional Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----82f1fc711ab9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/ufc?source=post_page-----82f1fc711ab9---------------ufc-----------------", "anchor_text": "UFC"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F82f1fc711ab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&user=Darius+Fuller&userId=d69ec7c31631&source=-----82f1fc711ab9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F82f1fc711ab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&user=Darius+Fuller&userId=d69ec7c31631&source=-----82f1fc711ab9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F82f1fc711ab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F82f1fc711ab9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----82f1fc711ab9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----82f1fc711ab9--------------------------------", "anchor_text": ""}, {"url": "https://dariuslfuller.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dariuslfuller.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Darius Fuller"}, {"url": "https://dariuslfuller.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "8 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd69ec7c31631&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&user=Darius+Fuller&userId=d69ec7c31631&source=post_page-d69ec7c31631--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F62e25b83f715&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fultimate-function-for-classification-82f1fc711ab9&newsletterV3=d69ec7c31631&newsletterV3Id=62e25b83f715&user=Darius+Fuller&userId=d69ec7c31631&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}