{"url": "https://towardsdatascience.com/multiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b", "time": 1683016392.893888, "path": "towardsdatascience.com/multiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b/", "webpage": {"metadata": {"title": "Multiple regression as a machine learning algorithm | by Mahbubul Alam | Towards Data Science", "h1": "Multiple regression as a machine learning algorithm", "description": "Previously I wrote a couple of pieces on multivariate modeling but they both focused on time series forecasting. If curious, go ahead and check out the posts on vector autoregression and panel data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/multivariate-time-series-forecasting-653372b3db36", "anchor_text": "vector autoregression", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/panel-data-regression-a-powerful-time-series-modeling-technique-7509ce043fa8", "anchor_text": "panel data modeling", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/supervised-machine-learning-technique-for-anomaly-detection-logistic-regression-97fc7a9cacd4", "anchor_text": "11 consecutive posts", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/multivariate-time-series-forecasting-653372b3db36", "anchor_text": "Vector autoregression", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/panel-data-regression-a-powerful-time-series-modeling-technique-7509ce043fa8", "anchor_text": "panel data regression", "paragraph_index": 9}, {"url": "https://archive.ics.uci.edu/ml/datasets/automobile", "anchor_text": "UCI Machine Learning Repository", "paragraph_index": 14}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html", "anchor_text": "Label Encoder", "paragraph_index": 26}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html", "anchor_text": "One Hot Encoder", "paragraph_index": 26}, {"url": "https://medium.com/@mab.datasc", "anchor_text": "Medium", "paragraph_index": 32}, {"url": "https://twitter.com/DataEnthus", "anchor_text": "Twitter", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/mab-alam/", "anchor_text": "LinkedIn", "paragraph_index": 32}], "all_paragraphs": ["Previously I wrote a couple of pieces on multivariate modeling but they both focused on time series forecasting. If curious, go ahead and check out the posts on vector autoregression and panel data modeling. Writing on multivariate regression (i.e. multiple linear regression) was always on my list but something else was on its way \u2014 I started a series on anomaly detection techniques! Once started that series, I could not stop until I wrote 11 consecutive posts.", "Today I\u2019m back with multiple regression and here\u2019s the plan \u2014 first I\u2019ll define in broad terms what a multiple regression is, and then list some real-world use cases as examples. The second part is going to be a rapid implementation of multiple regression in Python, just to give a broad intuition. In the third part, I\u2019ll dive a bit deeper following the typical machine learning workflow. I\u2019ll end with some additional points to keep in mind while implementing linear regression", "Before talking multiple regression let\u2019s talk about simple linear regression.", "Simple linear regression is one that has one dependent variable and only one independent variable. If \u201cincome\u201d is explained by the \u201ceducation\u201d of an individual then the regression is expressed in terms of simple linear regression as follows:", "Multiple regression goes one step further, and instead of one, there will be two or more independent variables. If we have an additional variable (let\u2019s say \u201cexperience\u201d) in the equation above then it becomes a multiple regression:", "So why is multiple regression useful and how are they used in real-world data science?", "Regression-based machine learning applications can be grouped into (at least) three different problem domains:", "1) Quantifying relationships: We know that through correlation we can find the strength (expressed in terms of a number between 0\u20131) and direction (positive or negative) of the relationship between two variables. But multiple regression goes a step further and actually quantifies that relationship.", "2) Prediction: Machine learning is all about prediction. Since regression has the capacity to quantify relationships, we can turn this capability into solving prediction problems. That means, if we know the level of education and years of experience of an individual, we should be able to predict what the level of salary should be for that individual using a regression equation (as the equation above).", "3) Forecasting: The third problem domain for multiple regression is forecasting with time series analysis. Vector autoregression and panel data regression are two powerful forecasting techniques that use the principles of multiple regression.", "Now here are some real-world application cases of multiple regression:", "[make, model, year, shift, mpg] \u2192 car prices", "[location, lot size, # beds, # bath, crime rate, school ratings] \u2192 house prices", "[past ads expenditure $, marketing $, subscription rate] \u2192 revenue at time T", "Now it\u2019s time to show how multiple regression works in data scientists\u2019 notebooks. First I will give an intuition with a fire-drill and then will dive a bit deeper. If you want to follow along, you can do so by downloading the automobile dataset from the UCI Machine Learning Repository.", "The machine learning objective here is to predict the price of used cars based on their features.", "You\u2019ve got the intuition with a simplified example of how multiple regression makes prediction of the price of a used car based on two features: horsepower and high-way mpg.", "But the world we live in is complex and messy. Each of the steps I\u2019ve shown above will need to be branched out further. For example, in Step 2 we imported data and assigned features to X, y variables, without doing any further analysis. But who doesn\u2019t know that data wrangling alone can take upwards of 80% of all tasks in any machine learning project?", "I\u2019m not going to go into every situation you\u2019ll encounter as a data scientist in the real-world but I\u2019ll talk about some fundamental issues which are unavoidable.", "I\u2019m going to use a few libraries and modules to do some mandatory tasks.", "First I\u2019m reading the dataset in my environment (I\u2019m using Jupyter notebook, by the way) and as a ritual, taking a peek at the first few rows.", "As you can see, there are many columns that barely fit in the window. So I\u2019m going to get a list of all columns.", "(I\u2019m not a car expert so I really don\u2019t know what some of those columns represent, but in real-world data science, this is not a good excuse, some domain knowledge is essential).", "I did few other things as part of data exploration and preparation which I\u2019m skipping here (such as checking and converting data types, removing a couple of rows that had symbols like \u2018?\u2019 etc.), but suffice to reiterate my previous point that getting the data in the right format can be a real pain in the neck.", "We want to predict price, so the dependent variable is already set. Now comes which features to use for prediction. Ideally I\u2019d include all of the features in the initial model, but for this demo I\u2019m choosing 1 categorical feature (i.e. make) and two numeric features (i.e. horsepower and highway-mpg) which I think most people would care about while choosing a car.", "Following the ML convention, I\u2019m designating the independent variables as X and the dependent variable as y.", "I\u2019ve purposefully chosen a categorical variable (i.e. make) to highlight that you need to do some extra work to convert it into a machine-readable format (a.k.a. numbers!). There are several ways to do that such as with Label Encoder or One Hot Encoder \u2014 both available in sklearn module. But I\u2019m going with the classical \u201cdummy variable\u201d approach, which converts categorical features into numerical dichotomous variables (0s and 1s).", "At this stage, I\u2019m also splitting data into training and testing set for model evaluation.", "It\u2019s always amazing to think that within the whole complex machine learning pipeline the easiest part is (in my opinion of course!) actually specifying the model. It\u2019s just three easy steps of instantiate \u2014 fit \u2014 predict as in most ML algorithms. Of course, you have to parameterize the model and iterate it several times until you get the one that satisfies your criteria, but still, this step of the model building process gives me the least headache.", "Now comes the moment of truth \u2014 how well does the model perform? There are many ways to evaluate model performance but in classical statistics, the performance of linear regression models is evaluated with R\u00b2 \u2014 which gives a value between 0 and 1, and the higher the R\u00b2 the better the model.", "In our demonstration we are getting a R\u00b2 value of 0.81, meaning 81% of the variation in the dependent variable (i.e. used car price) can be explained by the three independent variables (i.e. make, horsepower and highway-mpg). Of course, this metric can be improved by including more variables and trying with different combinations of them and by tuning model parameters \u2014 the topic of a separate discussion.", "I felt like I could write forever on multiple regression, there are so many areas to cover but I have to stop somewhere. Here are few additional things to keep in mind while building a linear regression model for real-world application development:", "I hope this was a useful post. If you have comments feel free to write them down below. You can follow me on Medium, Twitter or LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa98a6b9f307b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mab-datasc.medium.com/?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": ""}, {"url": "https://mab-datasc.medium.com/?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": "Mahbubul Alam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F401531abcd36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&user=Mahbubul+Alam&userId=401531abcd36&source=post_page-401531abcd36----a98a6b9f307b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa98a6b9f307b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa98a6b9f307b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@trebron?utm_source=medium&utm_medium=referral", "anchor_text": "Norbert Kundrak"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/multivariate-time-series-forecasting-653372b3db36", "anchor_text": "vector autoregression"}, {"url": "https://towardsdatascience.com/panel-data-regression-a-powerful-time-series-modeling-technique-7509ce043fa8", "anchor_text": "panel data modeling"}, {"url": "https://towardsdatascience.com/supervised-machine-learning-technique-for-anomaly-detection-logistic-regression-97fc7a9cacd4", "anchor_text": "11 consecutive posts"}, {"url": "https://towardsdatascience.com/multivariate-time-series-forecasting-653372b3db36", "anchor_text": "Vector autoregression"}, {"url": "https://towardsdatascience.com/panel-data-regression-a-powerful-time-series-modeling-technique-7509ce043fa8", "anchor_text": "panel data regression"}, {"url": "https://archive.ics.uci.edu/ml/datasets/automobile", "anchor_text": "UCI Machine Learning Repository"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html", "anchor_text": "Label Encoder"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html", "anchor_text": "One Hot Encoder"}, {"url": "https://medium.com/@mab.datasc", "anchor_text": "Medium"}, {"url": "https://twitter.com/DataEnthus", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/mab-alam/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a98a6b9f307b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a98a6b9f307b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/regression?source=post_page-----a98a6b9f307b---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/python?source=post_page-----a98a6b9f307b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----a98a6b9f307b---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa98a6b9f307b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&user=Mahbubul+Alam&userId=401531abcd36&source=-----a98a6b9f307b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa98a6b9f307b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&user=Mahbubul+Alam&userId=401531abcd36&source=-----a98a6b9f307b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa98a6b9f307b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa98a6b9f307b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a98a6b9f307b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a98a6b9f307b--------------------------------", "anchor_text": ""}, {"url": "https://mab-datasc.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mab-datasc.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mahbubul Alam"}, {"url": "https://mab-datasc.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "http://www.linkedin.com/in/mab-alam/", "anchor_text": "www.linkedin.com/in/mab-alam/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F401531abcd36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&user=Mahbubul+Alam&userId=401531abcd36&source=post_page-401531abcd36--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc2e6ab93a2dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiple-regression-as-a-machine-learning-algorithm-a98a6b9f307b&newsletterV3=401531abcd36&newsletterV3Id=c2e6ab93a2dd&user=Mahbubul+Alam&userId=401531abcd36&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}