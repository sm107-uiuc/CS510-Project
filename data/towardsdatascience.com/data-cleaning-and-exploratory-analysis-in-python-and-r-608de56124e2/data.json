{"url": "https://towardsdatascience.com/data-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2", "time": 1683011401.130062, "path": "towardsdatascience.com/data-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2/", "webpage": {"metadata": {"title": "Data Cleaning and Exploratory Analysis in Python and R | by Sagar Uprety | Towards Data Science", "h1": "Data Cleaning and Exploratory Analysis in Python and R", "description": "This notebook is about using a combination of Python and R to perform data preproccesing and some exploratory statistical analysis on an untidy dataset. Blogs and articles for upcoming data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=yIYKR4sgzI8&list=PLblh5JKOoLUKxzEP5HA2d-Li7IJkHfXSe", "anchor_text": "this excellent series of videos explaining logistic regression.", "paragraph_index": 26}], "all_paragraphs": ["This notebook is about using a combination of Python and R to perform data preproccesing and some exploratory statistical analysis on an untidy dataset. Blogs and articles for upcoming data scientists often harp on the need for using real-world data which is messy and the importance of learning data cleaning and preprocessing for this profession. However, we mostly find blogs and tutorials with standard datasets which skip the pre-processing step. Similarly, real-world data analysis may require a combination of EDA and statistical analysis. For that purpose, it may require that data scientists use both Python and R and switch between them depending upon the micro-task at hand.", "In this tutorial, I share some steps of data processing and exploratory analysis which came across as part of an experiment during my PhD. I have introduced a toy dataset for this purpose but the structure and messyness of the data is similar to what I encountered. Imagine a retail company with five stores in different geographic locations. Each store has two billing counters. The company is trialing a new product which they have only put at the billing counter. The cashiers are supposed to pitch the item to the customers during billing. The cashiers also ask each customer three questions about the product and then ask if they want to buy that product. The questions are about three attributes of the product and the customers have to answer \u2018Yes\u2019 \u2014 if they like the attribute or \u2018No\u2019 \u2014 if they don\u2019t like the attribute. Thus we have 4 columns in our dataset for each copy of the product \u2014 3 for the attributes and 1 for recording whether customers end up buying the item or not. All values are categorical \u2014 \u201cYes\u201d or \u201cNo\u201d.", "However, the way the data has been stored \u2014 it is stored in a single csv file but it has 40 columns \u2014 each of the 5 stores and each of the two billing counters in each store has a separate record. Thus we get multi-level columns as shown in the screenshot below.", "There is one more problem with the way in which the data is stored. If you look at the data for Store 1, and compare the two tills, you see that the records are mutually exclusive. That is, for a customer who visits Till 1, the corresponding record for Till 2 is left empty. There could have been some valid or lazy reasons why it was stored this way. But right now, as a data scientist, we have got this dataset to work on.", "So we begin. We first read our csv file and store it as a pandas dataframe. Note that we use header=[2] to use the third row as header and skip the first two rows.", "We see that pandas has labelled the columns with the \u2018.\u2019 extension. So the \u2018Buy\u2019 variable for {Store_1, Till_1} remains \u2018Buy\u2019, but that of {Store_1, Till_2} is \u2018Buy.1\u2019. Similarly, \u2018Buy\u2019 variable for {Store_2, Till_1} is \u2018Buy.2\u2019. Also note that for any store, an item record is registered as NaN if it was purchased from the other till.", "In total there are 40 columns here \u2014 4 variables x 5 stores x 2 tills per store.", "Our final aim of data processessing is to merge item records of all tills and all stores. This will result in a dataframe with only four columns \u2014 corresponding to the three attributes and the Buy decision.", "The first step is to merge the data of two tills of a store into one. We iterate over the columns of the dataframe, replace the NaNs with a null string (\u2018\u2019) and then concatenate the columns corresponding to any two tills of a store. The new dataframe is stored in a different variable d2.", "As we see above, we have merged the Till level information into Store level. In the next step, we merge the records for all stores into one. We create subsets of dataframes corresponding to the five stores and then append them below each other.", "Above is the data frame corresponding to Store 5. Similarly we have dataframes corresponding to each store. Note below that each of them has 202 rows.", "Now we append the dataframes corresponding to each store below each other and reset the index, otherwise the index will repeat in a loop from 0 to 201 for the 5 dataframes.", "Note that the final dataframe has 202 x 5 = 1010 rows and 4 columns. It represents the data for the whole company rather than Store wise and Till wise. Let us now proceed to some basic statistical analysis of the data. R is one of the most popular languages for statistical analysis and we will use that here. Jupyter (which stands for JUlia PYThon R) notebooks allow us to embedd R code snippets in a Python notebook.", "We first need to download the following R package in order to do so:", "%R is a magic command which helps us switch from Python to R. Beginning any line of code with %R will enable us to write in R.", "The following line instructs the machine to take the python variable named df and convert it into an R variable of the same name. So we convert our pandas dataframe into an R dataframe.", "Next, we examine the structure of the R dataframe. This shows that internally the values of the different attributes are stored as strings.", "The following lines of code stores the values of different attributes as categorical variables (called factors in R). But we see that there are 3 types of categorical variables. There is a null string which is due to some missing values in the dataset.", "Note that you can also use the magic command %%R which enables the whole cell to be used for R.", "This is something we should have checked in the first place. We can easily do that in pandas. Note the empty values are not NaN but rather empty character literals. So we need to first convert them into NaN and then use pandas dropna function to drop rows with NaN values.", "Now run the above piece of R code again, and we get an R dataframe with 2 levels of categorical variables.", "Now we can perform some analysis on the data. The purpose is to find out which of the three attributes influences the buying decision most. We first use xtabs to calculate cross category frequencies. This gives us a glimpse of the influence of each attribute on the Buy decision.", "Note in the above matrices that Attribute_1 appears to be heavily influencing the buying decision. Almost 80% of customers who like attribute 1 of the new product buy it and almost 90% of those who do not like attribute 1, do not end up buying it. The same cannot be said of the other two attributes where the fractions tend towards 50\u201350.", "Since we are dealing with categorical variables here, we need to use the binomial family of generalised linear models (GLM) in order to analyse the effect of different attributes. So we fit a logistic regression model into the data.", "In the summary below, we find the significant influence of attribute 1 in the buying decision as the corresponding p-values is very low.", "The negative intercept means that if all the attributes have value \u2018No\u2019, then the customer is highly unlikely to buy the product, which makes sense. Note that in logistic regression, the output variables \u2018Buy\u2019 is converted into a log odds scale. So a negative value actually means the odds are stacked against the customer buying the product.", "If you are not familiar with the concepts and intution behind logistic regression, refer to this excellent series of videos explaining logistic regression.", "We want to know whether we should consider all three variables in order to model the data or whether some variable, maybe Attribute_2, does not contribute to the buying decision. We can test this using Anova technique as shown below.", "The deviance of attribute_1 is much higher than the others. Attributes 2 and 3 do not contribute as much to the buying decision. So if you want to keep the model simpler, attribute_1 can be alone used to make prediction about the buying decision. Although when using all three attributes the residual deviance is the lowest, so the model is best fitted using all the three attributes.", "We can make predictions using this fitted model on new customers. For example, we see below that if a customer does not like the first attribute but likes other two, the probability of buying the product is 0.2.", "So this was just an introduction to some real-world data science work. We worked from a very untidy dataset to prepare the data in order to carry out some statistical analysis and predictions. Also, we used a combination of Python and R for the purpose. The model is very simple, with just three atrtibutes. Even then, one of them alone is sufficient to predict the decision.", "For those of you into behavioural aspects of decision-making, it would be interesting to think whether the predictions will change if the cashier asks the three questions to the customers in different orders. Machine Learning models do not take into account the order of features. We know that human answers are affected by the order of questions asked (Order Effects). So, when the features of a machine learning model correspond to human decisions/answers/judgements, ML models need to take into account the ordering of features too when predicting a decision.", "Thank you for going through this post. I am still learning the trades of data science and analysis and would love to get feedback on all the aspects of this post.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Researcher in Human-Centric AI. Interested in combining data and behavioural sciences."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F608de56124e2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----608de56124e2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----608de56124e2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sagaruprety?source=post_page-----608de56124e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sagaruprety?source=post_page-----608de56124e2--------------------------------", "anchor_text": "Sagar Uprety"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41387d13762b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&user=Sagar+Uprety&userId=41387d13762b&source=post_page-41387d13762b----608de56124e2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F608de56124e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F608de56124e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@thecreative_exchange?utm_source=medium&utm_medium=referral", "anchor_text": "The Creative Exchange"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.youtube.com/watch?v=yIYKR4sgzI8&list=PLblh5JKOoLUKxzEP5HA2d-Li7IJkHfXSe", "anchor_text": "this excellent series of videos explaining logistic regression."}, {"url": "https://medium.com/tag/data-cleaning?source=post_page-----608de56124e2---------------data_cleaning-----------------", "anchor_text": "Data Cleaning"}, {"url": "https://medium.com/tag/data-pre-processing?source=post_page-----608de56124e2---------------data_pre_processing-----------------", "anchor_text": "Data Pre Processing"}, {"url": "https://medium.com/tag/exploratory-data-analysis?source=post_page-----608de56124e2---------------exploratory_data_analysis-----------------", "anchor_text": "Exploratory Data Analysis"}, {"url": "https://medium.com/tag/python-and-r?source=post_page-----608de56124e2---------------python_and_r-----------------", "anchor_text": "Python And R"}, {"url": "https://medium.com/tag/real-world-example?source=post_page-----608de56124e2---------------real_world_example-----------------", "anchor_text": "Real World Example"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F608de56124e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&user=Sagar+Uprety&userId=41387d13762b&source=-----608de56124e2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F608de56124e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&user=Sagar+Uprety&userId=41387d13762b&source=-----608de56124e2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F608de56124e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----608de56124e2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F608de56124e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----608de56124e2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----608de56124e2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----608de56124e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----608de56124e2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----608de56124e2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----608de56124e2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----608de56124e2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----608de56124e2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----608de56124e2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sagaruprety?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sagaruprety?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sagar Uprety"}, {"url": "https://medium.com/@sagaruprety/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41387d13762b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&user=Sagar+Uprety&userId=41387d13762b&source=post_page-41387d13762b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdb68be23d04d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-cleaning-and-exploratory-analysis-in-python-and-r-608de56124e2&newsletterV3=41387d13762b&newsletterV3Id=db68be23d04d&user=Sagar+Uprety&userId=41387d13762b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}