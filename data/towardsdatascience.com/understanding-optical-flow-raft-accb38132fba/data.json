{"url": "https://towardsdatascience.com/understanding-optical-flow-raft-accb38132fba", "time": 1683014403.685483, "path": "towardsdatascience.com/understanding-optical-flow-raft-accb38132fba/", "webpage": {"metadata": {"title": "Understanding Optical Flow & RAFT | by Shuchen Du | Towards Data Science", "h1": "Understanding Optical Flow & RAFT", "description": "The most important problem in computer vision is correspondence learning. That is, given two images of an object, how to find the corresponding pixels of the object from the two images\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www2.cs.duke.edu/courses/spring19/compsci527/papers/Lucas.pdf", "anchor_text": "Lucas-Kanade method", "paragraph_index": 8}, {"url": "https://github.com/princeton-vl/RAFT", "anchor_text": "source", "paragraph_index": 17}, {"url": "https://www2.cs.duke.edu/courses/spring19/compsci527/papers/Lucas.pdf", "anchor_text": "An iterative image registration technique with an application to stereo vision, 1981", "paragraph_index": 18}, {"url": "https://arxiv.org/pdf/2003.12039.pdf", "anchor_text": "RAFT: Recurrent All-Pairs Field Transforms for Optical Flow, 2020", "paragraph_index": 19}], "all_paragraphs": ["The most important problem in computer vision is correspondence learning. That is, given two images of an object, how to find the corresponding pixels of the object from the two images?", "Correspondence learning, mainly for videos, has broad applications in object detection and tracking. Especially when the objects are occluded, color-changed, deformed in a video.", "Optical flow is a vector field between two images, showing how the pixels of an object in the first image can be moved to form the same object in the second image. It is a kind of correspondence learning, because if the corresponding pixels of an object are known, the optical flow field can be calculated.", "Let \u2018s take the most succinct form: one point flow between two images. Imagine a pixel at (x, y) in H flows to (x+u, y+v) in I, the optical flow vector is therefore (u, v).", "How to solve for (u, v) ? Is there any constraints for us to build some equations ?", "Then, abandon higher order terms and combine with H(x, y) = I(x+u, y+v):", "Finally, in the limit as u and v go to zero, we got the optical flow equation as:", "However, in real applications, u and v might be large or small, spanning several to tens of pixels, other than being zero-limit. Thus we can only get an approximation of the real optical flow. However, the flow field would be more accurate if u and v are closer to zero.", "In the above equation, the unknowns are u and v, because other variables can be calculated from differences from x, y and time dimensions. Thus, there are two unknowns in one equation, which cannot be solved. Therefore, in the past 40 years, many researchers tried to provide other set of equations of u, v to make it solvable. Among them, the most famous method is Lucas-Kanade method.", "In deep learning era, can we solve optical flow by deep neural networks ? If we can, what is the point of network designing ?", "The answer is yes, and there are works on this area these years, the result is getting better and better. I will introduce a representing work called RAFT, which got the Best paper award of ECCV 2020.", "RAFT, aka Recurrent All-Pairs Field Transforms, is a deep learning method to solve optical flow iteratively.", "As discussed above, given two images, finding the corresponding pixel pairs of the same objects between them is the core. In deep learning, everything is based on the latent feature maps, which brings efficiency and accuracy. Thus the corresponding pixel pairs could be extracted by correlation field.", "Correlation shows the relationship between two pixels from two images. For two images with size (H, W), the size of their correlation field would be (H, W, H, W), which is called C1. If we pool the last two dimensions, we get C2 and C3 etc. For a pixel of image 1, C1 shows the pixel-wise correlation, C2 shows the 2x2-pixel-wise correlation, C3 shows the 4x4-pixel-wise correlation to image 2 etc. This multi-scale manner can help find small to large displacements, which is important for optical flow estimations in videos with large time steps.", "For every pixel of image 1, its optical flow is initialized to zero, and its surrounding area in multi-scale correlation maps are looked up to search for its corresponding pixel in image 2. Then the optical flow is estimated between the pixel in image 1 and its searched correspondence pixel in image 2. Finally, the pixel in image 1 is moved according to the estimated optical flow to a new place and the process is repeated until convergence. In this iterative manner, only a step of flow is estimated each time, and the final flow is their summation.", "The RAFT model can be separated to two parts: encoder and iterator. Encoder part is similar to those in encoder-decoder networks, which is used to extract latent feature maps of input images. Iterator is implemented as ConvGRU module, which is a kind of RNN structure that can predict a sequence of flow steps and be optimized iteratively, with shared parameters.", "Furthermore, norm and activation layers are only used in encoders.", "I tested the source provided by the authors and the result seems good. I used a video clip with 10 frames. As shown above, the first row is frame 0, the second row is frame 1~9, and the third row is the predicted optical flow between frame 0 and frame 1~9, respectively. The result shows that optical flow between two video frames, with both small and large time intervals and displacements, can be predicted smoothly.", "An iterative image registration technique with an application to stereo vision, 1981", "RAFT: Recurrent All-Pairs Field Transforms for Optical Flow, 2020", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faccb38132fba&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----accb38132fba--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----accb38132fba--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dushuchen.medium.com/?source=post_page-----accb38132fba--------------------------------", "anchor_text": ""}, {"url": "https://dushuchen.medium.com/?source=post_page-----accb38132fba--------------------------------", "anchor_text": "Shuchen Du"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc54b15dbe11e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&user=Shuchen+Du&userId=c54b15dbe11e&source=post_page-c54b15dbe11e----accb38132fba---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faccb38132fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faccb38132fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/2003.12039.pdf", "anchor_text": "source"}, {"url": "https://www2.cs.duke.edu/courses/spring19/compsci527/papers/Lucas.pdf", "anchor_text": "Lucas-Kanade method"}, {"url": "https://arxiv.org/pdf/2003.12039.pdf", "anchor_text": "source"}, {"url": "https://arxiv.org/pdf/2003.12039.pdf", "anchor_text": "source"}, {"url": "https://github.com/princeton-vl/RAFT", "anchor_text": "source"}, {"url": "https://www2.cs.duke.edu/courses/spring19/compsci527/papers/Lucas.pdf", "anchor_text": "An iterative image registration technique with an application to stereo vision, 1981"}, {"url": "https://arxiv.org/pdf/2003.12039.pdf", "anchor_text": "RAFT: Recurrent All-Pairs Field Transforms for Optical Flow, 2020"}, {"url": "https://dushuchen.medium.com/membership", "anchor_text": "Join Medium with my referral link - Shuchen DuRead every story from Shuchen Du (and thousands of other writers on Medium). Your membership fee directly supports\u2026dushuchen.medium.com"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----accb38132fba---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----accb38132fba---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----accb38132fba---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----accb38132fba---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----accb38132fba---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faccb38132fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&user=Shuchen+Du&userId=c54b15dbe11e&source=-----accb38132fba---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faccb38132fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&user=Shuchen+Du&userId=c54b15dbe11e&source=-----accb38132fba---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faccb38132fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----accb38132fba--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faccb38132fba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----accb38132fba---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----accb38132fba--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----accb38132fba--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----accb38132fba--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----accb38132fba--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----accb38132fba--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----accb38132fba--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----accb38132fba--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----accb38132fba--------------------------------", "anchor_text": ""}, {"url": "https://dushuchen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dushuchen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shuchen Du"}, {"url": "https://dushuchen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "299 Followers"}, {"url": "https://www.linkedin.com/in/shuchen-du-682958132/", "anchor_text": "https://www.linkedin.com/in/shuchen-du-682958132/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc54b15dbe11e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&user=Shuchen+Du&userId=c54b15dbe11e&source=post_page-c54b15dbe11e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F10055a136a19&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-optical-flow-raft-accb38132fba&newsletterV3=c54b15dbe11e&newsletterV3Id=10055a136a19&user=Shuchen+Du&userId=c54b15dbe11e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}