{"url": "https://towardsdatascience.com/using-snorkel-for-multi-label-annotation-cc2aa217986a", "time": 1683004743.9561, "path": "towardsdatascience.com/using-snorkel-for-multi-label-annotation-cc2aa217986a/", "webpage": {"metadata": {"title": "Using Snorkel For Multi-Label Annotation. | by Ori Cohen | Towards Data Science", "h1": "Using Snorkel For Multi-Label Annotation.", "description": "Snorkel is a nice little package that allows us to use labeling functions (LFs) as simple as heuristics or keywords or as complex as algorithms and human annotators in order to create a labeled\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.snorkel.org/get-started/", "anchor_text": "Snorkel.org", "paragraph_index": 1}, {"url": "http://Justt.ai", "anchor_text": "Justt.ai", "paragraph_index": 16}, {"url": "https://bit.ly/33Xcdwy", "anchor_text": "https://bit.ly/33Xcdwy", "paragraph_index": 16}], "all_paragraphs": ["Snorkel is a nice little package that allows us to use labeling functions (LFs) as simple as heuristics or keywords or as complex as algorithms and human annotators in order to create a labeled dataset for the purpose of training a classifier.", "\u201cSnorkel is a system for programmatically building and managing training datasets without manual labeling. In Snorkel, users can develop large training datasets in hours or days rather than hand-labeling them over weeks or months.\u201d \u2014 Snorkel.org", "The motivation to use snorkel in order to create multi-labels is simple. Snorkel allows us to use simple heuristics or keywords in order to create a supervised dataset. Using it as a labeling algorithm allows a certain level of clarity when we need to understand why a sample was assigned a certain class. You can also think of a scenario in which you created a heuristical multi-labeling algorithm that assigns a sparse amount of multi-labels; when your product or feature requires large quantities of multi-labels in order to give a higher value to your clients.", "It's worth noting that throughout the process, we are actually creating two classifiers, the first one using snorkel\u2019s MajorityLabelVoter or LabelModel, the former gives us a majority vote as a baseline and the latter gives us the secret-sauce model that Snorkel is known for and the latter is to train a machine or deep-learning (MLDL) algorithm because we don't want to rely on the labeling functions that we created. We want to train a classifier that is not limited to our keywords, regexes, etc. We want a classifier that generalizes beyond what we gave it. Ideally, it will find correlations between, for example, tokens that we didn't account for in the labeling process to our final labels.", "First, we need to understand how to use Snorkel. Consider a sentiment classification task and the following sentences: 1. \u201cthe cake tasted really bad\u201d, 2. \u201cthe cream is really good\u201d & 3. \u201cthis food is fair\u201d. These sentences are NEGATIVE, POSITIVE & NEUTRAL, respectively. Therefore, we will create several LFs that assign a label accordingly.", "The rest of the process is easy, once you have many LFs you apply them on your pandas.DataFrame and train one of the models, i.e., MajorityLabelVoter or LabelModel.", "df_train[\u201clabel\u201d] will contain ABSTAIN labels as well, therefore in order to further train our secondary classifier, we\u2019ll have to filter them out.", "Again, the purpose of training a secondary classifier (Random forest in this example) on the filtered dataset is \u201cto generalize beyond the coverage of the labeling functions and the LabelModel. \u2014 snorkel.org\"", "Snorkel can only be used out of the box as a multi-class labeler. To use it for Multi-label, you can do one of the following three methods:", "Because \u20181\u2019 & \u20182\u2019 gave similar outputs and the calculation to get multi-labels from \u20181\u2019 was simpler, I chose to assign multi-labels based on 1.", "Please note that when a model assigns an ABSTAIN label, it can\u2019t decide who is the winner. We observe this behavior in predict_proba()\u2019s output. For example, consider the following probability vector: [1.0, 0, 0], the winner here is the first class. Now, consider the following vector: [0.5,0, 0.5], we see that isn't a clear winner, therefore, Snorkel will assign an ABSTAIN label.", "When we assign a label for each class that has a non-zero probability, we are in fact eliminating all ABSTAIN labels, labeling all the dataset and assigning a lot of multi-labels per sample.", "The following codes use a MajorityLabelVoter classifier and assign labels according to all the classes that have a higher than zero score. It's as simple as that :).", "That\u2019s it, you have created multi labels for each sample. Please keep in mind that due to this methodology of using Snorkel, which is very greedy in terms of labeling strategy, you may get a very RECALL-ORIENTED model. Your experience will vary.", "Dr. Ori Cohen has a Ph.D. in Computer Science with a focus on machine-learning. He is a lead data-scientist at New Relic TLV, doing machine and deep learning research in the field of AIOps.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I hold a Ph.D. in CS. A Sr. Director of Data & Data Science at Justt.ai. https://bit.ly/33Xcdwy"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcc2aa217986a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cohenori.medium.com/?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": ""}, {"url": "https://cohenori.medium.com/?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": "Ori Cohen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4dde5994e6c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&user=Ori+Cohen&userId=4dde5994e6c1&source=post_page-4dde5994e6c1----cc2aa217986a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc2aa217986a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc2aa217986a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://snorkel.org", "anchor_text": "Snorkel.org"}, {"url": "https://www.snorkel.org/get-started/", "anchor_text": "Snorkel.org"}, {"url": "https://pypi.org/project/kneed/", "anchor_text": "Kneed"}, {"url": "https://pypi.org/project/kneed/", "anchor_text": "Kneed"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----cc2aa217986a---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cc2aa217986a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----cc2aa217986a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/product-design?source=post_page-----cc2aa217986a---------------product_design-----------------", "anchor_text": "Product Design"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----cc2aa217986a---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcc2aa217986a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&user=Ori+Cohen&userId=4dde5994e6c1&source=-----cc2aa217986a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcc2aa217986a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&user=Ori+Cohen&userId=4dde5994e6c1&source=-----cc2aa217986a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc2aa217986a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcc2aa217986a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cc2aa217986a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cc2aa217986a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cc2aa217986a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cc2aa217986a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cc2aa217986a--------------------------------", "anchor_text": ""}, {"url": "https://cohenori.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cohenori.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ori Cohen"}, {"url": "https://cohenori.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.6K Followers"}, {"url": "http://Justt.ai", "anchor_text": "Justt.ai"}, {"url": "https://bit.ly/33Xcdwy", "anchor_text": "https://bit.ly/33Xcdwy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4dde5994e6c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&user=Ori+Cohen&userId=4dde5994e6c1&source=post_page-4dde5994e6c1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F400509e694f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-snorkel-for-multi-label-annotation-cc2aa217986a&newsletterV3=4dde5994e6c1&newsletterV3Id=400509e694f1&user=Ori+Cohen&userId=4dde5994e6c1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}