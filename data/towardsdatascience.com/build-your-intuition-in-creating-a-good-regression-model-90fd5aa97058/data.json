{"url": "https://towardsdatascience.com/build-your-intuition-in-creating-a-good-regression-model-90fd5aa97058", "time": 1683000684.282517, "path": "towardsdatascience.com/build-your-intuition-in-creating-a-good-regression-model-90fd5aa97058/", "webpage": {"metadata": {"title": "Build your intuition in creating a good Regression model | by Tirmidzi Faizal Aflahi | Towards Data Science", "h1": "Build your intuition in creating a good Regression model", "description": "Hot dog or not a hot dog, cat or not a cat, fraud or not a fraud. Those problems are the common use case of classification. By looking at the examples, you can easily conclude that the classification\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/new-york-city-taxi-fare-prediction/data", "anchor_text": "New York City Taxi Fare Prediction", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Haversine_formula", "anchor_text": "here", "paragraph_index": 24}, {"url": "https://en.wikipedia.org/wiki/Bearing_(navigation)", "anchor_text": "here", "paragraph_index": 24}], "all_paragraphs": ["Two big problems, two different reasons.", "Hot dog or not a hot dog, cat or not a cat, fraud or not a fraud. Those problems are the common use case of classification.", "By looking at the examples, you can easily conclude that the classification problem is simply dividing some sets of data into several classes, or groups. In a sense that, the number of groups is finite.", "As you can guess, Regression is, on the other hand, dividing those data into infinite groups.", "For example, having a set of data about the area of houses. By looking at the data, you can predict the price of each house. Because price is, almost, infinite, you can create a Regression model against that data.", "So, how to start creating a Regression model?", "It\u2019s always better to do anything with examples because theories won\u2019t get you that far.", "New York City Taxi Fare Prediction", "A good starting problem to train your intuition on building good Regression models.", "Basically, you will be given a bunch of data about how much do you need to pay from one point to another in NYC. And you need to predict how much you need to pay a taxi ride given such data.", "The metrics they stated in the problem is, without doing all the necessary Machine Learning things, you can get RMSE (Root Mean Square Error) of $5 to $8. So, let\u2019s build something that can give you less error than that.", "Download the data and open train.csv (Yeah it's huge), and you will see around 55 million rows consisting of real taxi fare data.", "Each of the row will consist of 7 columns.", "For this tutorial, I will use Python with several standard libraries like Numpy, Pandas, and LGBM", "I imported GC. That is a library for collecting garbage in python. GC for Garbage Collector.", "Look at the data, for this tutorial, my computer can\u2019t load all of the rows inside the file, at maximum I only can load 22 million of rows. And even, it is helped by using a garbage collector manually so that I can free up my memory to load and process all those 22 million rows.", "Read and drops all rows with missing or invalid value.", "Now you have prepared the data. What\u2019s next?", "In a problem like this, you need several new features (there are only 6 available in the data). You can just try to train the model using that data, but the information you give is too little to the model.", "It is basically creating or modifying data using the features that currently exist. Doing this will increase your understanding of the data that eventually help your model in the training phase.", "For example, latitude and longitude maybe don\u2019t make any sense if you look at it directly. But, what makes sense for you? Distance! Correct.", "Let\u2019s prepare a function that computes the distance between the pickoff and dropoff.", "That is the Haversine formula, a function to compute the distance between two latitudes and longitudes.", "However, in navigation, besides the distance, often you need to compute the bearing, A.K.A. the azimuth or the angles of moving between north and the ride.", "You can read about Haversine distance here, and the Bearing here.", "Next, you might want to change the latitude and longitude degrees into radians. Since computing in radians will give you already normalized input. The maximum value of a radians parameter is 2\u03c0 radians.", "You might want to extract a detailed date and time data from the datetime feature.", "These are the common features you might want to see, as taxi fare could be seasonal. Let\u2019s just put all those features into the dataset.", "From this point, you are ready to go since you probably have extracted all possible features from initial features.", "This time, you might want to add some creativity to the table.", "Why people ride a taxi in NYC?", "Let\u2019s compute the distance between the rides and those points.", "It is up to your imagination, your feature might not look like what I created. You might have another intuition on what things affect taxi fare, such as distance from business districts or residential districts. Or whatever you imagine.", "Now, after you prepared the data, let\u2019s train the model.", "Split the data into the train-validation split with a 90:10 ratio. And don\u2019t forget to remove the dataframe after you get the training arrays. It hogs a lot of resources.", "It will train forever, until your model can not optimize the result anymore. It will get you to around 25,000 iterations and give you $3.47966 Root Mean Square Error.", "That is a huge boost that can save you from $1.5 to potentially $4.5 on a taxi fare. You can buy a simple snack with that. Lol.", "The intuition might be hard at first. But you know, it is often common sense that helps you through all of these. By understanding the data situation on the ground level, can make you a bit more intuitive than before.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Engineering is a process to make a better life. To make our life better."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F90fd5aa97058&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@kuzuryu71?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kuzuryu71?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": "Tirmidzi Faizal Aflahi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f0ba807d0dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&user=Tirmidzi+Faizal+Aflahi&userId=3f0ba807d0dd&source=post_page-3f0ba807d0dd----90fd5aa97058---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90fd5aa97058&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90fd5aa97058&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ejleusink?utm_source=medium&utm_medium=referral", "anchor_text": "Erik-Jan Leusink"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/new-york-city-taxi-fare-prediction/data", "anchor_text": "New York City Taxi Fare Prediction"}, {"url": "https://en.wikipedia.org/wiki/Haversine_formula", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Bearing_(navigation)", "anchor_text": "here"}, {"url": "https://unsplash.com/@aussieactive?utm_source=medium&utm_medium=referral", "anchor_text": "AussieActive"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@jentheodore?utm_source=medium&utm_medium=referral", "anchor_text": "Jen Theodore"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----90fd5aa97058---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/regression?source=post_page-----90fd5aa97058---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/data-science?source=post_page-----90fd5aa97058---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----90fd5aa97058---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F90fd5aa97058&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&user=Tirmidzi+Faizal+Aflahi&userId=3f0ba807d0dd&source=-----90fd5aa97058---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F90fd5aa97058&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&user=Tirmidzi+Faizal+Aflahi&userId=3f0ba807d0dd&source=-----90fd5aa97058---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90fd5aa97058&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F90fd5aa97058&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----90fd5aa97058---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----90fd5aa97058--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----90fd5aa97058--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----90fd5aa97058--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----90fd5aa97058--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kuzuryu71?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@kuzuryu71?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tirmidzi Faizal Aflahi"}, {"url": "https://medium.com/@kuzuryu71/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "696 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f0ba807d0dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&user=Tirmidzi+Faizal+Aflahi&userId=3f0ba807d0dd&source=post_page-3f0ba807d0dd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbbba613fb3d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-intuition-in-creating-a-good-regression-model-90fd5aa97058&newsletterV3=3f0ba807d0dd&newsletterV3Id=bbba613fb3d5&user=Tirmidzi+Faizal+Aflahi&userId=3f0ba807d0dd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}