{"url": "https://towardsdatascience.com/how-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc", "time": 1683014821.8522828, "path": "towardsdatascience.com/how-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc/", "webpage": {"metadata": {"title": "How to peek inside a black box model \u2014 Understand Partial Dependence Plot | by Yirui Feng | Towards Data Science", "h1": "How to peek inside a black box model \u2014 Understand Partial Dependence Plot", "description": "In this post, we will be learning a tool to reveal the working mechanism of a black box model. But before we start, let talk about something else. The racoon, is a very interesting animal and loves\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/unsdsn/world-happiness?select=2017.csv", "anchor_text": "dataset", "paragraph_index": 17}, {"url": "https://gist.github.com/fyr91/d29d1bb4ebac97e338dd2286002669d9", "anchor_text": "here", "paragraph_index": 20}], "all_paragraphs": ["In this post, we will be learning a tool to reveal the working mechanism of a black box model. But before we start, let talk about something else.", "The racoon, is a very interesting animal and loves to wash food before eating, just like what shows below:", "This behaviour may look normal to us as hygiene matters. But does it matter to the little cute raccoon?", "The fact is not. To unravel this mysterious behaviour, researchers studied raccoons\u2019 nerve fibers and brain cortex and eventually come up with a probable explanation. Raccoons have very senstitive nerve groupings on their forepaws. By wetting their paws, they are able to acquire more sensory information of what they are about to eat.", "Now, let\u2019s get back to our topic. What is a black box model. In computer science, a black box model is a system that can be viewed in terms of its inputs and outputs, without any knowledge of its internal workings.", "The raccoon in our little science story is a black box model, and the inputs include food and water, output is their good dining habit. From our observation alone, we could not understand why they behave like that. Thus our curiosity might drive us to explore further. Besides self-fulfilment emotionally, unvealing black box do have pratical values.", "For instance, in mission-critical industries like aerospace, even if black box model could give us a higher accuracy, it will be questionable to adopt this kind of solution as we do not understand how it works and what could be affected. Therefore, it will be better if we could have some tools to reveal this mysterious factory. One of the useful tools is called Partial Dependence Plot (PDP).", "Partial Dependence Plot (PDP) shows how the model predictions partially depend on values of the input variables of interest.", "In layman\u2019s terms, it is a plot. And from this plot, it will help us understand how one or two input features are affecting the model predicting outcomes.", "Why one or two features you may ask? Because we are living in a 3D world (Spatially). It will be hard for us to visualize higher dimensions.", "In principle, we will examine the marginal effect of feature sets on the prediction outcome given a trained model. The formular below defines how we are going to achieve this exactly:", "Function f on the left hand side is called the partial function. On the right hand side, it will hold constant for the features of interest Xs and take the average prediction over all other combinations of other features Xc in the data set.", "For instance, given the following dataset:", "If we want to examine the marginal effect of street values, we will take the unique street values A, B and C in the dateset and replace the street value for each samples respectively. Then we can use the newly generated data samples to calculate the average prediction value from the model:", "After acquiring the average prediction price for each street value, we will be able to plot a diagram with street value against the average prediction price:", "From the plot, we know that the model predicts a higher value for house on street A and lower on B generally.", "After understanding the overal idea of PDP, we will dive deeper into this with a real example.", "The following is a dataset snapshot of World Happiness Score for 2017.", "With this, I have build a simple regression model (XGBoost) on Happiness.Score with 7 features selected. Details of model training process can be found in the notebook below.", "Since we are using XGBoost, which is an ensemble method and results in a black box model, we could use PDP to explore and understand how each features is playing a role in this complex factory. The code could be found in the notebook below:", "For better illustration, I recreated the graph using Plotly. Code can be found here for your reference.", "There are three precautions we need to consider before analyzing a PDP.", "First is the feature correlation. By using PDP, we are assuming the independence between the target feature and the rest. If there is a correlation, replacing target feature value might result in case where it does not have any pratical value. For instance, Health.Life.Expectancy has a high correlation with Economy.GDP.per.Captita, by changing the value for Economy.GDP.per.Captita, Health.Life.Expectancy should be changed accordingly. However, while we are examing either of these two values\u2019 partial dependence, we are creating data points that are very unlikely to exist in the real life cases by fixing the other one. Thus, it is important keep this assumption in mind that target features should be independent from the rest.", "Second is the data distribution. You may notice that on the x axis, I have showed the distribution of the target feature value from the sample datasets. Since we are calculating partial dependence from these values, analysis without considering data distribution could be dangerous. We might over esitmate the effect of target feature in the no-data region.", "Third, there is one more booby trap we need to care about, the heterogeneous effects hidden. As partial dependence is an average estimation, the resulting value might not be able to represent the actually marginal effect of target feature given. For instance, as shown below:", "Half of the points are above the average, and halves are below. The resulting partial dependence however tells another story. To address this issue, we could use other tools like Individual Conditional Expectation (ICE) plot to provide a coarse view on a model.", "With these in mind, we can extract some useful information from the model. Generally, Family, Freedom and Dystopia.Residual have a positive effect on the happiness score from the model derived. Althouth Economy.GDP.per.Captita and Health.Life.Expectancy could have a potential positive effect as well, they are highly correlated and we could not trust this until further examinations.", "To conclude, PDP is a model agnostic approach to help understand how target features are affecting any derived model. It is intuitive and easy to implement but does have some constraints:", "Hope this post is helpful and helps you open the gate to the mysterious world. Stay tuned and see ya~", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F17d1b673aafc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@feng0049?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@feng0049?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": "Yirui Feng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc12376bf13d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&user=Yirui+Feng&userId=c12376bf13d9&source=post_page-c12376bf13d9----17d1b673aafc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17d1b673aafc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17d1b673aafc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://www.kaggle.com/unsdsn/world-happiness?select=2017.csv", "anchor_text": "dataset"}, {"url": "https://gist.github.com/fyr91/d29d1bb4ebac97e338dd2286002669d9", "anchor_text": "here"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://medium.com/tag/black-box?source=post_page-----17d1b673aafc---------------black_box-----------------", "anchor_text": "Black Box"}, {"url": "https://medium.com/tag/modeling?source=post_page-----17d1b673aafc---------------modeling-----------------", "anchor_text": "Modeling"}, {"url": "https://medium.com/tag/partial-dependence-plots?source=post_page-----17d1b673aafc---------------partial_dependence_plots-----------------", "anchor_text": "Partial Dependence Plots"}, {"url": "https://medium.com/tag/data-science?source=post_page-----17d1b673aafc---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----17d1b673aafc---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17d1b673aafc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&user=Yirui+Feng&userId=c12376bf13d9&source=-----17d1b673aafc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17d1b673aafc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&user=Yirui+Feng&userId=c12376bf13d9&source=-----17d1b673aafc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17d1b673aafc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F17d1b673aafc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----17d1b673aafc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----17d1b673aafc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----17d1b673aafc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----17d1b673aafc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----17d1b673aafc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@feng0049?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@feng0049?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yirui Feng"}, {"url": "https://medium.com/@feng0049/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "94 Followers"}, {"url": "https://www.linkedin.com/in/yirui-feng-239635a1/", "anchor_text": "https://www.linkedin.com/in/yirui-feng-239635a1/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc12376bf13d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&user=Yirui+Feng&userId=c12376bf13d9&source=post_page-c12376bf13d9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe87fd79bb808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-peek-inside-a-black-box-model-understand-partial-dependence-plots-17d1b673aafc&newsletterV3=c12376bf13d9&newsletterV3Id=e87fd79bb808&user=Yirui+Feng&userId=c12376bf13d9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}