{"url": "https://towardsdatascience.com/creating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5", "time": 1683015252.344958, "path": "towardsdatascience.com/creating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5/", "webpage": {"metadata": {"title": "Creating conditional columns on Pandas with Numpy select() and where() methods | by B. Chen | Towards Data Science", "h1": "Creating conditional columns on Pandas with Numpy select() and where() methods", "description": "Pandas is an amazing library that contains extensive built-in functions for manipulating data. Although the built-in functions are capable of performing efficient data analysis, incorporating methods\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/015-pandas-numpy-select-where/pandas-and-numpy-select-where.ipynb", "anchor_text": "Github repo", "paragraph_index": 2}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/015-pandas-numpy-select-where/pandas-and-numpy-select-where.ipynb", "anchor_text": "notebook on my Github", "paragraph_index": 18}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github", "paragraph_index": 20}], "all_paragraphs": ["Pandas is an amazing library that contains extensive built-in functions for manipulating data. Although the built-in functions are capable of performing efficient data analysis, incorporating methods from other library adds value to Pandas.", "In this article, we are going to take a look at how to create conditional columns on Pandas with Numpy select() and where() methods", "Please check out my Github repo for the source code", "Suppose we have a dataset about a fruit store.", "We can see that the store has purchased fruits from 2 suppliers \u201cT & C Bro\u201d and \u201cJM Wholesales\u201d. Their price lists are kept separately like below:", "We would like to retrieve the price from the supplier\u2019s price list, combine them and add the result to a new column. The expected output is:", "The tricky part in this calculation is that we need to retrieve the price (kg) conditionally (based on supplier and fruit) and then combine it back into the fruit store dataset.", "For this example, a game-changer solution is to incorporate with the Numpy where() function. A single line of code can solve the retrieve and combine.", "By calling set_index('fruit') to set the fruit column as index across all datasets. This is important so we can use loc[df.index] later to select a column for value mapping.", "The Numpy where(condition, x, y) method [1] returns elements chosen from x or y depending on the condition. The most important thing is that this method can take array-like inputs and returns an array-like output.", "By executing the above statement, you should get the output like below:", "A bit confusion? Here are some details:", "We have learnt how to create a conditional column from 2 datasets. What about more than 2 datasets, for example, 3 different suppliers in the fruit store dataset.", "For more than 2 datasets/choices, we can use Numpy select() method instead. Let\u2019s see how it works with the help of an example.", "The first step is to combine all price lists into one dataset.", "After that, set the fruit column as index.", "Numpy select(condlist, choicelist) method returns an array drawn from elements in choicelist, depending on condition in condlist.", "By executing the above statement, you should get the output like below:", "Please checkout the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "More can be found from my Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8ee6e2dbd5d5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----8ee6e2dbd5d5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ee6e2dbd5d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ee6e2dbd5d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pbernardon?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Pascal Bernardon"}, {"url": "https://unsplash.com/s/photos/pandas-data?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/015-pandas-numpy-select-where/pandas-and-numpy-select-where.ipynb", "anchor_text": "Github repo"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/015-pandas-numpy-select-where/pandas-and-numpy-select-where.ipynb", "anchor_text": "notebook on my Github"}, {"url": "https://towardsdatascience.com/when-to-use-pandas-transform-function-df8861aa0dcf", "anchor_text": "When to use Pandas transform() function"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-pandas-pivot-table-function-3e1002dcd4eb", "anchor_text": "A Practical Introduction to Pandas pivot_table() function"}, {"url": "https://medium.com/@bindiatwork/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac", "anchor_text": "Using Pandas method chaining to improve code readability"}, {"url": "https://towardsdatascience.com/working-with-datetime-in-pandas-dataframe-663f7af6c587", "anchor_text": "Working with datetime in Pandas DataFrame"}, {"url": "https://medium.com/@bindiatwork/all-the-pandas-read-csv-you-should-know-to-speed-up-your-data-analysis-1e16fe1039f3", "anchor_text": "Pandas read_csv() tricks you should know"}, {"url": "https://towardsdatascience.com/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e", "anchor_text": "4 tricks you should know to parse date columns with Pandas read_csv()"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github"}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.where.html", "anchor_text": "Numpy Documentation \u2014 where()"}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.select.html", "anchor_text": "Numpy Documentation \u2014 select()"}, {"url": "https://medium.com/tag/numpy?source=post_page-----8ee6e2dbd5d5---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/pandas?source=post_page-----8ee6e2dbd5d5---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----8ee6e2dbd5d5---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8ee6e2dbd5d5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8ee6e2dbd5d5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ee6e2dbd5d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&user=B.+Chen&userId=563d09da62a&source=-----8ee6e2dbd5d5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ee6e2dbd5d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&user=B.+Chen&userId=563d09da62a&source=-----8ee6e2dbd5d5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ee6e2dbd5d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8ee6e2dbd5d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8ee6e2dbd5d5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8ee6e2dbd5d5--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}