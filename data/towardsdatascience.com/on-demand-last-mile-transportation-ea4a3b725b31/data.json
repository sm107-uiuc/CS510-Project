{"url": "https://towardsdatascience.com/on-demand-last-mile-transportation-ea4a3b725b31", "time": 1683001746.05099, "path": "towardsdatascience.com/on-demand-last-mile-transportation-ea4a3b725b31/", "webpage": {"metadata": {"title": "On-demand last mile transportation | by Miguel \u00c1lvarez Garc\u00eda | Towards Data Science", "h1": "On-demand last mile transportation", "description": "The emergence of marketplace platforms connecting customers to products and services is a challenge from a logistics point of view. Learn how to use optimization for real-time routing."}, "outgoing_paragraph_urls": [{"url": "https://www.uber.com/", "anchor_text": "Uber", "paragraph_index": 0}, {"url": "https://postmates.com/", "anchor_text": "Postmates", "paragraph_index": 0}, {"url": "https://stuart.com/", "anchor_text": "Stuart", "paragraph_index": 0}, {"url": "https://carto.com/platform/data-enrichment/", "anchor_text": "Spatial Data Science", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Vehicle_routing_problem", "anchor_text": "vehicle routing problem (VRP)", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Mathematical_optimization", "anchor_text": "optimization problem", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Assignment_problem", "anchor_text": "assignment problem", "paragraph_index": 7}, {"url": "https://carto.com/blog/logistics-optimization-network-model/", "anchor_text": "described here", "paragraph_index": 14}, {"url": "https://carto.com/developers/cartoframes/", "anchor_text": "CARTOframes", "paragraph_index": 18}, {"url": "https://en.wikipedia.org/wiki/Assignment_problem", "anchor_text": "assignment problem", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/Hungarian_algorithm", "anchor_text": "Hungarian algorithm", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Linear_programming", "anchor_text": "Linear Programming", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Integer_programming", "anchor_text": "Integer Linear Programming", "paragraph_index": 23}, {"url": "https://carto.com/blog/last-mile-transportation-route-optimization/", "anchor_text": "CARTO blog", "paragraph_index": 32}], "all_paragraphs": ["In recent years we have seen the emergence of numerous marketplace platforms connecting customers to a wide variety of products and services. Clear examples of this are Uber, Postmates, and Stuart that allow you to order pickup and delivery services of basically anything from a ride, to food, to even small parcels, and get it delivered in less than one or two hours.", "Running this service efficiently is a challenge from a logistics point of view, and it is increasingly important in the face of fierce competition in the sector. Traditional logistics solutions are no longer suitable for planning such services due to the nature of the problem being very different from that of standard logistics companies. If we take a look at any regular third-party logistics (3PL) company, they normally accept next-day delivery orders until a certain cut-off time so that they have enough time to plan the next day\u2019s routes. This is not the case for an on-demand service in which new orders have to be processed and assigned in (almost) real-time with no future information on the orders that may come in.", "Both problems are notoriously difficult to solve, especially if we want to make sure we are operating optimally, or, at least, better than our competitors. This is where Spatial Data Science can make a difference as it allows us to build data models that simulate existing conditions, providing us insights on existing constraints, inefficient assignments, and much more.", "While both problems are difficult to solve, the complexity of each one can be found at very different stages. The traditional last mile transportation problem is a vehicle routing problem (VRP), a combinatorial optimization problem known for its complexity from an algorithmic design point of view as well as computationally. The clear advantage they have over the real-time on-demand transportation problem is that all the information about orders and driver availability is known beforehand, and normally a solution is not needed immediately. This makes it easier to find a near-optimal solution. There are several algorithms designed to solve this problem and several solvers with these algorithms implemented, both commercial and open source.", "On the other hand, real-time on-demand transportation problems are smaller problems because there is less information available, but a response is needed immediately. Here we only know what happened up until the moment we check the state of the system, and most of it cannot be changed because it was already delivered. This can lead to very inefficient routing due to the lack of future information and the inability to change past decisions. Overcoming this narrow vision of the problem becomes the main challenge.", "The following map is a good representation of this narrow vision, where we can only see the orders placed in every 3 minute time window. Once that time window is passed, we cannot change the assignments we made, and we do not have a vision of the orders that will come.", "In logistics literature, there is consensus on how to overcome this narrow vision problem: adding flexibility to the decisions made, and trying to get as much future information as possible. The first point has to do with postponing decisions as much as possible and making decisions that can be easily undone or changed. The second one relates to the use of other Data Science techniques such as forecasting to broaden our vision.", "This problem is harder to classify into a problem category because it will depend on the complexity of the service provided, and also on how far we want to go into optimizing our routes. It could go from a \u201csimple\u201d assignment problem (if we only need to consider the information related to a narrow time window) to a VRP (if we need to consider what drivers have done up until the current iteration of the algorithm).", "The main challenge is then to be able to calculate all the required costs, and design an algorithm that can find a near-optimal solution in a matter of seconds. There can also be other challenges to overcome, such as calculating how many drivers we will need before we even start the day, what fleet we will need, or calculating the forecast for the following minutes/hours.", "These big differences in the problem to be solved in both cases make it very hard, if not impossible, to adapt traditional logistics solutions to on-demand transportation problems.", "The following example shows a first step on how to apply optimization to solve the on-demand transportation problem, and the benefit obtained for doing so. Here\u2019s a scenario for which we will apply two initial approaches to solve the problem.", "The following assumptions are made to enhance the clarity of the presentation. However, bear in mind the problem can get more complicated depending on how far we want to go in optimizing how we function, and the requirements of the service provided as described later.", "On the following map we can see orders received from 7:00 pm to 7:05 pm on a Thursday. We can see the pickup and delivery locations, the optimal routes calculated for each order, and the riders/drivers available who are idle or will be at some point within the time window. We are going to focus on this 5 minute time window to make it easier to show and compare results.", "In order to solve any routing problem we need to build a cost matrix representing the cost of going from place A to place B, or in the case presented here, the cost of assigning a rider located at point A to an order with pickup location at point B. In our example, this OD matrix will be the distances from riders\u2019 locations to orders\u2019 pickup locations.", "Building an OD matrix, as described here, is a harder challenge for the on-demand transportation problem because of the need to calculate this matrix in real-time.", "This is usually the first approach followed when solving this problem. This algorithm is activated every time an order is received and it searches the nearest idle rider and assigns the order to that rider. In this case, we are taking the nearest, but it could be any other criteria to be optimized depending on the service provided or the business goals.", "This algorithm is widely used because it is very easy to implement, and to understand and analyze its results. In addition, when launching a new business, customer experience is usually one of the main metrics, so it makes sense to want to process each order as soon as possible. However, this does not necessarily mean that the customer will always be served faster.", "After solving the problem with this algorithm we get a total distance of 181.67 km traveled by riders from their starting locations to the pickup locations.", "In the following figure we can see the first six steps performed by the algorithm plotted using CARTOframes where black points are the locations of idle riders, and green points are the orders\u2019 pickup locations. This visualization is very powerful because it can help quickly identify inefficiencies in our algorithm.", "As mentioned before, a key factor to improve the assignments is to add as much information and flexibility as possible. One option to broaden our vision and get more information would be to postpone the order assignment and run the algorithm every n minutes. The more we can postpone it the better, because we will have more information.", "The following figure shows the number of orders received every minute.", "Running the algorithm every minute means that an order will have to wait (at most) one minute to be processed, which initially should not have a significant impact on customer experience. In fact, we\u2019ll see that some orders will get delivered even before.", "The algorithm will be activated every minute, and it will consider all the orders received in the last minute and assign them. This means it will have more than one order to assign. In order to make the most of all the information we have, we will solve this as an assignment problem.", "There are specific algorithms designed for this problem such as the Hungarian algorithm. Normally, these algorithms are designed for very specific cases of the problem and it is hard to evolve them when the problem starts to require complex features. That is why we will solve it using Linear Programming, or more specifically Integer Linear Programming. This technique will allow us to adapt to future changes or adding more complexity to the problem.", "After solving the problem with this Batch Assignment algorithm we get a total distance traveled of 159.10 km, i.e., we get a 13% improvement in our goal metric.", "If we compare the assignments done on the orders received in the first minute (from 7:00 to 7:01 pm) with both algorithms we can see some big differences. For example, if we look at the north-east part of the map, we can see a very inefficient assignment done with the greedy algorithm that has a much more efficient assignment with the batch assignment algorithm. This is thanks to having more information by postponing when assignments are done.", "Here again, being able to visualize the decisions made by both algorithms is very powerful:", "The previous two algorithms are just the first natural steps that are normally followed when faced with this problem. However, the complexity of the problem usually asks for more steps.", "As mentioned above, broadening the information available at each iteration of the problem is essential. One very useful step would be to make assignments considering what could happen in the following 30 to 60 minutes (or even more time depending on the length of the services). It would be very helpful to have some forecast of where the demand will be so as to avoid assignments that will move riders far from the higher demand areas. This could easily be incorporated into the Batch Assignment model by identifying which riders should not be assigned to orders with delivery location far from the higher demand areas. In addition, this information could be made available to riders so that they know where they should move when idle to be sure they\u2019re assigned more orders.", "The following map shows where the demand is expected to happen an hour from now, together with the idle riders. Depending on how far they are from the higher expected demand areas, they will be given a different priority to be assigned.", "Apart from this, there are other improvements that would lead to more efficient and higher quality assignments. These improvements would strongly depend on the type of service provided.", "Incorporating these criteria into our model is a complex task from an algorithmic point of view. Being able to visualize the steps and decisions made by the different algorithms we test is a very powerful tool for a very time-consuming task. Here, visualization tools can be of enormous help.", "This article was originally published on the CARTO blog.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fea4a3b725b31&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@malvarez_89900?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@malvarez_89900?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": "Miguel \u00c1lvarez Garc\u00eda"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe03b44b5baba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&user=Miguel+%C3%81lvarez+Garc%C3%ADa&userId=e03b44b5baba&source=post_page-e03b44b5baba----ea4a3b725b31---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea4a3b725b31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea4a3b725b31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.uber.com/", "anchor_text": "Uber"}, {"url": "https://postmates.com/", "anchor_text": "Postmates"}, {"url": "https://stuart.com/", "anchor_text": "Stuart"}, {"url": "https://carto.com/platform/data-enrichment/", "anchor_text": "Spatial Data Science"}, {"url": "https://en.wikipedia.org/wiki/Vehicle_routing_problem", "anchor_text": "vehicle routing problem (VRP)"}, {"url": "https://en.wikipedia.org/wiki/Mathematical_optimization", "anchor_text": "optimization problem"}, {"url": "https://en.wikipedia.org/wiki/Assignment_problem", "anchor_text": "assignment problem"}, {"url": "https://carto.com/blog/logistics-optimization-network-model/", "anchor_text": "described here"}, {"url": "https://carto.com/developers/cartoframes/", "anchor_text": "CARTOframes"}, {"url": "https://en.wikipedia.org/wiki/Assignment_problem", "anchor_text": "assignment problem"}, {"url": "https://en.wikipedia.org/wiki/Hungarian_algorithm", "anchor_text": "Hungarian algorithm"}, {"url": "https://en.wikipedia.org/wiki/Linear_programming", "anchor_text": "Linear Programming"}, {"url": "https://en.wikipedia.org/wiki/Integer_programming", "anchor_text": "Integer Linear Programming"}, {"url": "https://carto.com/blog/last-mile-transportation-route-optimization/", "anchor_text": "CARTO blog"}, {"url": "https://medium.com/tag/optimization?source=post_page-----ea4a3b725b31---------------optimization-----------------", "anchor_text": "Optimization"}, {"url": "https://medium.com/tag/on-demand?source=post_page-----ea4a3b725b31---------------on_demand-----------------", "anchor_text": "On Demand"}, {"url": "https://medium.com/tag/transportation?source=post_page-----ea4a3b725b31---------------transportation-----------------", "anchor_text": "Transportation"}, {"url": "https://medium.com/tag/spatial-data-science?source=post_page-----ea4a3b725b31---------------spatial_data_science-----------------", "anchor_text": "Spatial Data Science"}, {"url": "https://medium.com/tag/visualization?source=post_page-----ea4a3b725b31---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea4a3b725b31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&user=Miguel+%C3%81lvarez+Garc%C3%ADa&userId=e03b44b5baba&source=-----ea4a3b725b31---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea4a3b725b31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&user=Miguel+%C3%81lvarez+Garc%C3%ADa&userId=e03b44b5baba&source=-----ea4a3b725b31---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea4a3b725b31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fea4a3b725b31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ea4a3b725b31---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ea4a3b725b31--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@malvarez_89900?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@malvarez_89900?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Miguel \u00c1lvarez Garc\u00eda"}, {"url": "https://medium.com/@malvarez_89900/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "90 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe03b44b5baba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&user=Miguel+%C3%81lvarez+Garc%C3%ADa&userId=e03b44b5baba&source=post_page-e03b44b5baba--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffd675c26eec2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fon-demand-last-mile-transportation-ea4a3b725b31&newsletterV3=e03b44b5baba&newsletterV3Id=fd675c26eec2&user=Miguel+%C3%81lvarez+Garc%C3%ADa&userId=e03b44b5baba&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}