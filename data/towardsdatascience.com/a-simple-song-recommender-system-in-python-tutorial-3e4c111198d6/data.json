{"url": "https://towardsdatascience.com/a-simple-song-recommender-system-in-python-tutorial-3e4c111198d6", "time": 1683005593.167993, "path": "towardsdatascience.com/a-simple-song-recommender-system-in-python-tutorial-3e4c111198d6/", "webpage": {"metadata": {"title": "A Simple Song Recommender System in Python (Tutorial) | by Jack Bandy | Towards Data Science", "h1": "A Simple Song Recommender System in Python (Tutorial)", "description": "Most of us now use AI-based recommender systems every day: looking for a show on Netflix, scrolling through social media feeds, watching \u201cup next\u201d videos on YouTube, and listening to \u201cDiscover\u2026"}, "outgoing_paragraph_urls": [{"url": "https://qz.com/1609356/your-phone-is-not-recording-your-conversations/", "anchor_text": "a little voodoo doll, avatar-like version of you", "paragraph_index": 3}, {"url": "https://newsroom.spotify.com/company-info/", "anchor_text": "purportedly has over 50 million tracks and over 271 million active users", "paragraph_index": 14}, {"url": "https://gist.github.com/jackbandy/5cd988ab5c3d95b79219364dce7ee5ae", "anchor_text": "Here", "paragraph_index": 15}, {"url": "https://colab.research.google.com/drive/1HdMr5uPnCstdpfObJkxAZxDYOcspYP2i", "anchor_text": "here", "paragraph_index": 28}], "all_paragraphs": ["This material is based on content from a workshop I taught in April 2020.", "Most of us now use AI-based recommender systems every day: looking for a show on Netflix, scrolling through social media feeds, watching \u201cup next\u201d videos on YouTube, and listening to \u201cDiscover Weekly\u201d playlists on Spotify.", "So how do these recommenders work?", "They have become really good, and in some cases, creepily good. Many of us have received recommendations and advertisements that make us ask: \u201cwere they recording me?\u201d Generally speaking, companies do not make recommendations by hacking your microphone and recording your conversations. Instead, they make a model of you, or as Tristan Harris called it, \u201ca little voodoo doll, avatar-like version of you,\u201d and then make predictions about that doll. I\u2019ll refer to this doll as a mathematical model of your tastes.", "The methods in this tutorial are nowhere near as sophisticated as what Google, Facebook, and Spotify are using, and they will not produce any creepily good recommendations. Still, most recommendations principally work the same, and are bound up in three steps:", "I\u2019ll go over these three steps twice, first in a simple visual example, and then in a larger code-based example.", "Let\u2019s start by considering three people (Jack, Nick, and Trevor) and how they rated three songs (One Dance, Lean On, and Sunflower) on a scale of 1 to 5. Here they are in a simple table:", "We now have a simple mathematical model of musical taste. In the real world, Spotify uses other signals, such as how many times you listen to a song, to determine this rating. Regardless, the principle is to translate your tastes into a list of numbers, which is also called a vector, a matrix, or an array. Whatever you call them, it\u2019s helpful to visualize these numbers on a graph. Below, we put the rating for \u201cOne Dance\u201d on the x-axis, and the rating for \u201cLean On\u201d on the y-axis:", "We now have a list of numbers that capture your musical tastes, so we can go to the next step: finding people with similar tastes. Let\u2019s go back to the graph:", "In the visual representation, similar people are just nearby people. So figuring out who is \u201cmost similar\u201d to Jack is just a matter of figuring out who is closest to Jack. And we can measure this distance using the old Pythagorean theorem from middle school geometry:", "Cool! We\u2019re almost there. We can already see that Jack is most similar to Nick and not Trevor, but let\u2019s make it official:", "The maths confirm: in this tiny universe of song tastes, Jack is 3.2 units away from Trevor, but only 1.4 units away from Nick.", "Now that we know Jack and Nick have similar taste, we can predict whether Jack will like \u201cSunflower\u201d based on whether Nick liked sunflower. It\u2019s just a matter of looking it up in the table:", "Nick gave \u201cSunflower\u201d a 5/5 rating, so we can predict that Jack will probably like the song, too.", "Obviously, the scale of this tiny universe is a lot smaller than Spotify\u2019s universe. We looked at three songs and three people, while Spotify purportedly has over 50 million tracks and over 271 million active users. So now, we\u2019ll scale up.", "To make a bigger dataset, we will load in a larger table. Here is one with 25 songs and 8 people:", "In Python, you can use Pandas to load this data with the following command:", "Now, let\u2019s try to predict whether I (still Jack) will like the song \u201c7 Rings.\u201d As in the visual example, we will find the person closest to me. Using the Pythagorean theorem, the distance function in two dimensions was just distance=sqrt(a^2 + b^2) , which we could write like this:", "But this time, there are 25 dimensions, not just two. How do we find the closest person when we have 25 dimensions instead of just an x-axis and a y-axis?", "It turns out the trusty Pythagorean theorem generalizes pretty well. (Most recommenders use other distance metrics like cosine distance, but we\u2019ll ignore that for this tutorial). If there are three dimensions, we can call them a , b , and c , and then just add it under the square root:distance=sqrt(a^2 + b^2 + c^2) . And we can actually do this with any number of dimensions: distance=sqrt(a^2 + b^2 + c^2 + d^2 + ... + n^2) .", "The scipy library has written a function to do exactly what we need: calculate Euclidean distance in any number of dimensions. Let\u2019s use it:", "Now, we can use that distance function to look at the similarity between any two people. The only catch is that we need to fill in blanks with \u201c0,\u201d using fillna . The following block does that, and then retrieves the rows of data for the three people:", "Then, we can look at the distance between Jack and the other two people:", "Just like in the tiny universe, Jack is closer to Nick (10.63 units away) than to Trevor (13.49 units away). But really, we want to look at the distance between Jack and every other person. Here\u2019s a function that uses a \u201cfor loop\u201d to do just that:", "It starts by saying: \u201cthe closest person so far is infinitely far away.\u201d Then, it loops through to look at each person and asks \u201cis this person closer than the closest person so far?\u201d It\u2019s not very helpful to answer \u201cthe person most similar to Jack is Jack,\u201d which is why the loops skips (i.e., continue ) if the names are the same.", "Now, we can just call most_similar_to to see who is closest to any person. Let\u2019s try it for me (Jack):", "At last, we can predict whether I will like \u201c7 Rings\u201d by looking at the user who is most similar to me. At the time, the data said this was Meg, so let\u2019s see how Meg rated the song:", "Meg rated the song at 3/5, so I will probably not be too crazy about it.", "A Google Colab notebook with all the code is available here.", "If you really wanted to do what Spotify is doing, you would make predictions using musical tastes of every person, not just the closest person. For example, maybe if I knew that Trevor and I consistently had very different tastes, recognizing that Trevor liked \u201c7 Rings\u201d might tell me that I would dislike the song. I may cover this in a future tutorial, so let me know if you are interested!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student studying AI, ethics, and media. Trying to share things I learn in plain english. \ud83d\udc26 @jackbandy"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3e4c111198d6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jackbandy.medium.com/?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": ""}, {"url": "https://jackbandy.medium.com/?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": "Jack Bandy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8d75f62d60c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&user=Jack+Bandy&userId=8d75f62d60c4&source=post_page-8d75f62d60c4----3e4c111198d6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e4c111198d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e4c111198d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.billboard.com/articles/news/8528161/disneys-star-wars-galaxys-edge-cantina-music-album-playlist-one", "anchor_text": "Photo credit"}, {"url": "https://disneyparks.disney.go.com/blog/author/joshua-sudock/", "anchor_text": "Joshua Sudock"}, {"url": "https://qz.com/1609356/your-phone-is-not-recording-your-conversations/", "anchor_text": "a little voodoo doll, avatar-like version of you"}, {"url": "https://newsroom.spotify.com/company-info/", "anchor_text": "purportedly has over 50 million tracks and over 271 million active users"}, {"url": "https://gist.github.com/jackbandy/5cd988ab5c3d95b79219364dce7ee5ae", "anchor_text": "Here"}, {"url": "https://colab.research.google.com/drive/1HdMr5uPnCstdpfObJkxAZxDYOcspYP2i", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3e4c111198d6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----3e4c111198d6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/recommender-systems?source=post_page-----3e4c111198d6---------------recommender_systems-----------------", "anchor_text": "Recommender Systems"}, {"url": "https://medium.com/tag/spotify?source=post_page-----3e4c111198d6---------------spotify-----------------", "anchor_text": "Spotify"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----3e4c111198d6---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3e4c111198d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&user=Jack+Bandy&userId=8d75f62d60c4&source=-----3e4c111198d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3e4c111198d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&user=Jack+Bandy&userId=8d75f62d60c4&source=-----3e4c111198d6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e4c111198d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3e4c111198d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3e4c111198d6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3e4c111198d6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3e4c111198d6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3e4c111198d6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3e4c111198d6--------------------------------", "anchor_text": ""}, {"url": "https://jackbandy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jackbandy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jack Bandy"}, {"url": "https://jackbandy.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "238 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8d75f62d60c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&user=Jack+Bandy&userId=8d75f62d60c4&source=post_page-8d75f62d60c4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6654c366aa3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-simple-song-recommender-system-in-python-tutorial-3e4c111198d6&newsletterV3=8d75f62d60c4&newsletterV3Id=6654c366aa3a&user=Jack+Bandy&userId=8d75f62d60c4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}