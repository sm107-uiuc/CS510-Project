{"url": "https://towardsdatascience.com/just-used-machine-learning-in-my-workout-ff079b8e1939", "time": 1682992968.544615, "path": "towardsdatascience.com/just-used-machine-learning-in-my-workout-ff079b8e1939/", "webpage": {"metadata": {"title": "Just Used Machine Learning in My Workout! | by Antonello Calamea | Towards Data Science", "h1": "Just Used Machine Learning in My Workout!", "description": "I\u2019m a big fan of a bodyweight approach and generally of doing workouts, but I don\u2019t like too much going to the gym. Besides, in this time of forced lockdown due to Coronavirus, it could be useful to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/CMU-Perceptual-Computing-Lab/openpose", "anchor_text": "OpenPose", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "here", "paragraph_index": 24}, {"url": "https://towardsdatascience.com/used-again-machine-learning-in-my-workout-this-time-building-a-personal-trainer-3dfae9730c2b", "anchor_text": "here", "paragraph_index": 34}, {"url": "https://hub.docker.com/r/garyfeng/docker-openpose/", "anchor_text": "https://hub.docker.com/r/garyfeng/docker-openpose/", "paragraph_index": 39}, {"url": "https://github.com/NVIDIA/nvidia-docker", "anchor_text": "https://github.com/NVIDIA/nvidia-docker", "paragraph_index": 41}, {"url": "https://github.com/CMU-Perceptual-Computing-Lab/openpose", "anchor_text": "OpenPose documentation", "paragraph_index": 45}, {"url": "http://antonellocalamea.com", "anchor_text": "antonellocalamea.com", "paragraph_index": 57}], "all_paragraphs": ["I\u2019m a big fan of a bodyweight approach and generally of doing workouts, but I don\u2019t like too much going to the gym.", "Besides, in this time of forced lockdown due to Coronavirus, it could be useful to try a different way to approach fitness and training.", "So I asked myself: is there a way to use Machine Learning in this area? Can I join two passions together to make something useful?", "One of the main problems is having a way to validate the correctness of an exercise, so I did some experiments and tried an approach and found that\u2026", "Ok, don\u2019t want to spoil anything, just continue reading to find out!", "As always, let\u2019s start with framing the problem. What we want to achieve is having a way to assess the correctness of an exercise, using a video as input.", "The optimum should be using live streaming, but let\u2019s keep it simple using a file for now as, after all, we want to validate an approach before building something on top.", "So, having a video of a (hopefully) proper execution should be the first step, as it can be used as a baseline to compare other ones.", "Here\u2019s the first video, did in my underground fatigue room :)", "My first thought was to use CNNs to build a classifier but, besides the number of needed examples, I\u2019m not sure images sequence pixels can be useful to train a model about what is wrong and what is right in the exercise execution.", "So, I did some research to find if there is the possibility to have different features using a video as input and found a great library, OpenPose, a \u201cReal-time multi-person keypoint detection library for body, face, hands, and foot estimation\u201d.", "Seeing the demo videos, I understood could be very useful, so I tried to apply it to my problem and had this\u2026", "(I\u2019ll write later, in the Appendix, all the necessary steps to setup)", "As you can see in the video, the library works very well tracking different body parts (used the COCO configuration with 18 key points)", "The cool thing is it\u2019s possible to have as output a json file too, with all the positions, frame by frame, so it should be possible to have an alternative numeric representation of an exercise.", "So, doing some helper function and using Plotly, this is how this exercise looks considering the y-axis movements \u2014 skipping x-axis as less useful given the camera position.", "Nice, the next step is now to find a way to compare two different executions to spot if there are significant differences.", "Let\u2019s make first a visual comparison based on these metrics and let\u2019s call this execution \u201cfail1\u201d", "Let\u2019s compare the graphs of the movements", "Let\u2019s try with another failed performance (\u201cfail2\u201d)", "and let\u2019s compare with the baseline proper execution ok1", "Let\u2019s try now to compare two good performances (let\u2019s call it the second \u201cok2\u201d)", "The curves look very similar, so we empirically tested this approach.", "Now the question is: is there a way to evaluate the similarity between these univariate time-series curves, considering could have different timescale too?", "It turns out there is something called Dynamic Time Warping that can be used \u201cfor measuring similarity between two temporal sequences\u201d. More here", "Is there an implementation in Python? Of course, using tslearn.metrics", "So 0 values is the maximum similarity and a lower score means more similarity", "Let\u2019s try now measuring ok1 and fail1", "I found useful adopting an overall value to have a more condensed info, such as the median", "So it seems this value can be used as an indicator to compare the correctness of two executions based on a threshold to be found.", "As an empirically counter check, let\u2019s try with other examples starting from this value", "It seems that a median lower than 30 could be a starting threshold", "This is just the beginning of this experiment: assuming this is the right approach, there are a lot of open points such as:", "I had some ideas to check, and I\u2019ll do in the future, even because the possibilities are fantastic.", "UPDATE: I added other features starting from this. Check it out here", "Imagine a workstation with a camera that", "Even training could be customized on the fly based on previous sessions and overall person condition.", "As always, I\u2019m amazed about what is possible to achieve and imagine with these technologies and it\u2019s big fun to use them.", "In the meantime, happy workout and stay safe.", "Instead of installing directly OpenPose with all the necessary dependencies, I opted for a Docker approach. You can found here the image: https://hub.docker.com/r/garyfeng/docker-openpose/", "Keep in mind that probably for a real-time approach using a container is not the right solution as there is a lot of lag but I haven\u2019t tried other solutions so I cannot say it for sure.", "But before running it, you need to run containers using GPU, otherwise, OpenPose will not start. Here all the instruction to do it (with Invidia GPUs): https://github.com/NVIDIA/nvidia-docker", "You\u2019ll see in the command The \u201cprivileged\u201d and -e DISPLAY=$DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix parts that are used to access the camera inside the container if you need it.", "Before launching the docker command, be sure to execute:", "After a while, you\u2019ll enter in a bash shell inside the container", "if you check OpenPose documentation there are a lot of parameters but let\u2019s see a couple of examples", "It should turn on the camera and start to detect keypoint in your face.", "The command I used to create the data used before:", "Notice the \u201cdata\u201d folder that was mounted while launching the container. If you change it, be sure to adapt accordingly to the command.", "Let\u2019s see now some Python code to deal with the data used in the article", "This is used to return a DataFrame with all the json found in an OpenPose json output path (beware, it will break if there are 1000+ files \u2014 definitely to fix :)", "Here we\u2019re doing columns renaming based on COCO setup and a basic interpolation if there are 0 values (for example when a nose is behind the pull-up bar):", "Putting all together, the function to use to have the final DataFrame.", "Drawing the subplots for all the positions.", "Now drawing the comparison for two exercises:", "Finally the Dynamic Time Warping part:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech consultant and Coach (antonellocalamea.com) | Avid learner | Composer | Proudly believing less is more, except for love and knowledge"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fff079b8e1939&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://antonellocalamea.medium.com/?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": ""}, {"url": "https://antonellocalamea.medium.com/?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": "Antonello Calamea"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84eedabec793&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&user=Antonello+Calamea&userId=84eedabec793&source=post_page-84eedabec793----ff079b8e1939---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff079b8e1939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff079b8e1939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/CMU-Perceptual-Computing-Lab/openpose", "anchor_text": "OpenPose"}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/used-again-machine-learning-in-my-workout-this-time-building-a-personal-trainer-3dfae9730c2b", "anchor_text": "here"}, {"url": "https://hub.docker.com/r/garyfeng/docker-openpose/", "anchor_text": "https://hub.docker.com/r/garyfeng/docker-openpose/"}, {"url": "https://github.com/NVIDIA/nvidia-docker", "anchor_text": "https://github.com/NVIDIA/nvidia-docker"}, {"url": "https://github.com/CMU-Perceptual-Computing-Lab/openpose", "anchor_text": "OpenPose documentation"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----ff079b8e1939---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/fitness?source=post_page-----ff079b8e1939---------------fitness-----------------", "anchor_text": "Fitness"}, {"url": "https://medium.com/tag/python?source=post_page-----ff079b8e1939---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/openpose?source=post_page-----ff079b8e1939---------------openpose-----------------", "anchor_text": "Openpose"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ff079b8e1939---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff079b8e1939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&user=Antonello+Calamea&userId=84eedabec793&source=-----ff079b8e1939---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff079b8e1939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&user=Antonello+Calamea&userId=84eedabec793&source=-----ff079b8e1939---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff079b8e1939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fff079b8e1939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ff079b8e1939---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ff079b8e1939--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ff079b8e1939--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ff079b8e1939--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ff079b8e1939--------------------------------", "anchor_text": ""}, {"url": "https://antonellocalamea.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://antonellocalamea.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Antonello Calamea"}, {"url": "https://antonellocalamea.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "136 Followers"}, {"url": "http://antonellocalamea.com", "anchor_text": "antonellocalamea.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84eedabec793&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&user=Antonello+Calamea&userId=84eedabec793&source=post_page-84eedabec793--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F25c77bf17133&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-used-machine-learning-in-my-workout-ff079b8e1939&newsletterV3=84eedabec793&newsletterV3Id=25c77bf17133&user=Antonello+Calamea&userId=84eedabec793&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}