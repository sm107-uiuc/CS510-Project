{"url": "https://towardsdatascience.com/hands-on-time-series-forecasting-with-python-d4cdcabf8aac", "time": 1683008464.913171, "path": "towardsdatascience.com/hands-on-time-series-forecasting-with-python-d4cdcabf8aac/", "webpage": {"metadata": {"title": "Hands-on Time Series Forecasting with Python | by Idil Ismiguzel | Towards Data Science", "h1": "Hands-on Time Series Forecasting with Python", "description": "Time series analysis is the endeavor of extracting meaningful summary and statistical information from data points that are in chronological order. They are widely used in applied science and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "Time series", "paragraph_index": 0}, {"url": "https://github.com/Idilismiguzel/Time-Series/blob/master/SARIMA-forecasting.ipynb", "anchor_text": "Jupyter Notebook", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Box%E2%80%93Jenkins_method", "anchor_text": "Box-Jenkins method", "paragraph_index": 4}, {"url": "https://bigml.com/user/czuriaga/gallery/dataset/5a8dacbd2a834705180000ec", "anchor_text": "monthly milk production dataset.", "paragraph_index": 6}, {"url": "https://www.statsmodels.org/stable/index.html", "anchor_text": "statsmodels", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Akaike_information_criterion", "anchor_text": "AIC", "paragraph_index": 27}, {"url": "https://medium.com/@idilismiguzel", "anchor_text": "read my other articles here", "paragraph_index": 40}, {"url": "http://medium.com/@idilismiguzel/follow", "anchor_text": "follow me on Medium.", "paragraph_index": 40}, {"url": "https://idilismiguzel.medium.com/membership", "anchor_text": "Become a member for more!", "paragraph_index": 41}, {"url": "https://de.linkedin.com/in/idilismiguzel", "anchor_text": "https://de.linkedin.com/in/idilismiguzel", "paragraph_index": 43}], "all_paragraphs": ["Time series analysis is the endeavor of extracting meaningful summary and statistical information from data points that are in chronological order. They are widely used in applied science and engineering which involves temporal measurements such as signal processing, pattern recognition, mathematical finance, weather forecasting, control engineering, healthcare digitization, applications of smart cities, and so on.", "As we are continuously monitoring and collecting time series data, the opportunities for applying time series analysis and forecasting are increasing.", "In this article, I will show how to develop an ARIMA model with a seasonal component for time series forecasting in Python. We will follow Box-Jenkins three-stage modeling approach to reach at the best model for forecasting.", "I encourage anyone to check out the Jupyter Notebook on my GitHub for the full analysis.", "In time series analysis, Box-Jenkins method named after statisticians George Box and Gwilym Jenkins applying ARIMA models to find the best fit of a time series model.", "The model indicates 3 steps: model identification, parameter estimation and model validation.", "As data, we will use the monthly milk production dataset. It includes monthly production records in terms of pounds per cow between 1962\u20131975.", "As we can observe from the plot above, we have an increasing trend and very strong seasonality in our data.", "We will use the statsmodels library from Python to perform a time series decomposition. The decomposition of time series is a statistical method to deconstruct time series into its trend, seasonal and residual components.", "The decomposition plot indicates that the monthly milk production has an increasing trend and seasonal pattern.", "If we want to observe the seasonal component more precisely, we can plot the data based on the month.", "In this step, we need to detect whether time series is stationary, and if not, we need to understand what kind of transformation is required to make it stationary.", "A time series is stationary when its statistical properties such as mean, variance, and autocorrelation are constant over time. In other words, time series is stationary when it is not dependent on time and not have a trend or seasonal effects. Most statistical forecasting methods are based on the assumption that time series is (approximately) stationary.", "Imagine, we have a time series that is consistently increasing over time, the sample mean and variance will grow with the size of the sample, and they will always underestimate the mean and variance in future periods. This is why, we need to start with a stationary time series, which is removed from its time dependent trend and seasonal components.", "We can check stationarity by using different approaches:", "Here we see that both ACF and PACF plots do not show a quick cut off into the 95% confidence interval area (in blue) meaning time series is not stationary.", "P-value is greater than the threshold value, we fail to reject the null hypothesis and time series is non-stationary, it has time dependent component.", "All these approaches suggest we have non-stationary data. Now, we need to find a way to make it stationary.", "There are two major reasons behind non-stationary time series; trend and seasonality. We can apply differencing to make time series stationary by subtracting the previous observations from the current observations. Doing so we will eliminate trend and seasonality, and stabilize the mean of time series. Due to both trend and seasonal components, we apply one non-seasonal diff() and one seasonal differencing diff(12).", "Applying the previously listed stationarity checks, we notice the plot of differenced time series does not reveal any specific trend or seasonal behavior, ACF/PACF plots have a quick cut-off, and ADF test result returns p-value almost 0.00. which is lower than the threshold. All these checks suggest that differenced data is stationary.", "We will apply Seasonal Autoregressive Integrated Moving Average (SARIMA or Seasonal-ARIMA) which is an extension of ARIMA that supports time series data with a seasonal component. ARIMA stands for Autoregressive Integrated Moving Average which is one of the most common techniques of time series forecasting.", "ARIMA models are denoted with the order of ARIMA(p,d,q) and SARIMA models are denoted with the order of SARIMA(p, d, q)(P, D, Q)m.", "AR(p) is a regression model that utilizes the dependent relationship between an observation and some number of lagged observations.", "I(d) is the differencing order to make time series stationary.", "MA(q) is a model that uses the dependency between an observation and a residual error from a moving average model applied to lagged observations.", "(P, D, Q)m are the additional set of parameters that specifically describe the seasonal components of the model. P, D, and Q represent the seasonal regression, differencing, and moving average coefficients, and m represents the number of data points in each seasonal cycle.", "We will use Python\u2019s pmdarima library, to automatically extract the best parameters for our Seasonal ARIMA model. Inside auto_arima function, we will specify d=1and D=1 as we differentiate once for the trend and once for seasonality, m=12 because we have monthly data, and trend='C'to include constant and seasonal=Trueto fit a seasonal-ARIMA. Besides, we specify trace=Trueto print status on the fits. This helps us to determine the best parameters by comparing the AIC scores.", "AIC (Akaike Information Criterion) is an estimator of out of sample prediction error and the relative quality of our model. The desired result is to find the lowest possible AIC score.", "The result of auto_arima function with various (p, d, q)(P, D, Q)m parameters indicates that the lowest AIC score is obtained when the parameters equal to (1, 1, 0)(0, 1, 1, 12).", "We split the dataset into a train and test set. Here I\u2019ve used 85% as train split size. We create a SARIMA model, on the train set with the suggested parameters. We use SARIMAX function from statsmodel library (X describes the exogenous parameter, but here we don\u2019t add any). After fitting the model, we can also print the summary statistics.", "Primary concern of the model is to ensure that the residuals are normally distributed with zero mean and uncorrelated.", "To check for residuals statistics, we can print model diagnostics:", "All these results suggest residuals are normally distributed with low correlation.", "To measure the accuracy of forecasts, we compare the prediction values on the test set with its real values.", "From the plot, we see that model prediction nearly matches with the real values of the test set.", "The R squared of the model is 0.92, indicating that the coefficient of determination of the model is 92%.", "Mean absolute percentage error (MAPE) is one of the most used accuracy metrics, expressing the accuracy as a percentage of the error. MAPE score of the model equals to 1.64, indicating the forecast is off by 1.64% and 98.36% accurate.", "Since both the diagnostic test and the accuracy metrics intimates that our model is nearly perfect, we can continue to produce future forecasts.", "Here is the forecast for the next 60 months.", "I hope you enjoyed following this tutorial and building time series forecasts in Python.", "If you liked this article, you can read my other articles here and follow me on Medium. Let me know if you have any questions or suggestions.\u2728", "Enjoy this article? Become a member for more!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist @ Kolibri Games | Writing on Data Science & Machine Learning | Top 2000 Writer on Medium | MSc, MBA | https://de.linkedin.com/in/idilismiguzel"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd4cdcabf8aac&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@idil", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://idilismiguzel.medium.com/?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": ""}, {"url": "https://idilismiguzel.medium.com/?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": "Idil Ismiguzel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6d965c736f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&user=Idil+Ismiguzel&userId=6d965c736f2&source=post_page-6d965c736f2----d4cdcabf8aac---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4cdcabf8aac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4cdcabf8aac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@briansuman?utm_source=medium&utm_medium=referral", "anchor_text": "Brian Suman"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "Time series"}, {"url": "https://github.com/Idilismiguzel/Time-Series/blob/master/SARIMA-forecasting.ipynb", "anchor_text": "Jupyter Notebook"}, {"url": "https://en.wikipedia.org/wiki/Box%E2%80%93Jenkins_method", "anchor_text": "Box-Jenkins method"}, {"url": "https://bigml.com/user/czuriaga/gallery/dataset/5a8dacbd2a834705180000ec", "anchor_text": "monthly milk production dataset."}, {"url": "https://www.statsmodels.org/stable/index.html", "anchor_text": "statsmodels"}, {"url": "https://en.wikipedia.org/wiki/Autocorrelation", "anchor_text": "autocorrelation function"}, {"url": "https://en.wikipedia.org/wiki/Partial_autocorrelation_function", "anchor_text": "partial autocorrelation function"}, {"url": "https://en.wikipedia.org/wiki/Akaike_information_criterion", "anchor_text": "AIC"}, {"url": "https://medium.com/@idilismiguzel", "anchor_text": "read my other articles here"}, {"url": "http://medium.com/@idilismiguzel/follow", "anchor_text": "follow me on Medium."}, {"url": "https://idilismiguzel.medium.com/membership", "anchor_text": "Become a member for more!"}, {"url": "https://medium.com/tag/python?source=post_page-----d4cdcabf8aac---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----d4cdcabf8aac---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d4cdcabf8aac---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/timeseries?source=post_page-----d4cdcabf8aac---------------timeseries-----------------", "anchor_text": "Timeseries"}, {"url": "https://medium.com/tag/education?source=post_page-----d4cdcabf8aac---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd4cdcabf8aac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&user=Idil+Ismiguzel&userId=6d965c736f2&source=-----d4cdcabf8aac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd4cdcabf8aac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&user=Idil+Ismiguzel&userId=6d965c736f2&source=-----d4cdcabf8aac---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4cdcabf8aac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd4cdcabf8aac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d4cdcabf8aac---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d4cdcabf8aac--------------------------------", "anchor_text": ""}, {"url": "https://idilismiguzel.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://idilismiguzel.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Idil Ismiguzel"}, {"url": "https://idilismiguzel.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "890 Followers"}, {"url": "https://de.linkedin.com/in/idilismiguzel", "anchor_text": "https://de.linkedin.com/in/idilismiguzel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6d965c736f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&user=Idil+Ismiguzel&userId=6d965c736f2&source=post_page-6d965c736f2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F515eb8e2184b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-time-series-forecasting-with-python-d4cdcabf8aac&newsletterV3=6d965c736f2&newsletterV3Id=515eb8e2184b&user=Idil+Ismiguzel&userId=6d965c736f2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}