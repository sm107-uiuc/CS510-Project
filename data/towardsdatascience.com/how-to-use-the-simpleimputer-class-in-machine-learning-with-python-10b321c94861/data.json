{"url": "https://towardsdatascience.com/how-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861", "time": 1683015046.780959, "path": "towardsdatascience.com/how-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861/", "webpage": {"metadata": {"title": "How to use the SimpleImputer Class in Machine Learning with Python | by Stephen Fordham | Towards Data Science", "h1": "How to use the SimpleImputer Class in Machine Learning with Python", "description": "Datasets often have missing values and this can cause problems for machine learning algorithms. It is considered good practise to identify and replace missing values in each column of your dateset\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/dileep070/heart-disease-prediction-using-logistic-regression", "anchor_text": "kaggle", "paragraph_index": 4}, {"url": "https://github.com/StephenFordham/scikit-learn_tutorials", "anchor_text": "github page", "paragraph_index": 4}, {"url": "https://github.com/StephenFordham/scikit-learn_tutorials/blob/main/heart%20disease%20model.ipynb", "anchor_text": "here", "paragraph_index": 29}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham", "paragraph_index": 31}], "all_paragraphs": ["Datasets often have missing values and this can cause problems for machine learning algorithms. It is considered good practise to identify and replace missing values in each column of your dateset prior to performing predictive modelling. This method of missing data replacement is referred to as data imputation.", "Missing values in a dataset can arise due to a multitude of reasons. These commonly include, but are not limited to; malfunctioning measuring equipment, collation of non-identical datasets and changes in data collection during an experiment.", "A convenient strategy for missing data imputation is to replace all missing values with a statistic calculated from the other values in a column. This strategy can often lead to impressive results, and avoids discarding meaningful data when constructing your machine learning algorithms. Commonly used statistics include calculating either the mean, median and mode for the column and imputing this value for the missing values. In addition, a constant value can be imputed to complement these methods above.", "This tutorial is aimed at demonstrating the usage of the SimpleImputer class for statistical imputation.", "The dataset used in this tutorial is the \u201cLogistic regression To predict heart disease\u201d dataset, available via kaggle here or my github page.", "The dataset is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. The classification goal is to predict whether the patient has 10-year risk of future coronary heart disease (CHD).The dataset provides the patients\u2019 information. It includes over 4,000 records and 15 attributes. The attributes can be found via kaggle. My main purpose here is not to go into this dataset in depth, but rather demonstrate a use case for the utilisation of the SimpleImputer class for predictive modelling.", "First import the libraries required and perform some exploratory data analysis (EDA).", "The head of the dataframe and columns attribute called on the dataframe reveal all 15 data attributes.", "To calculate the number of missing values and their respective percentage in relation to their column, I first iterate over the columns. For each column I then assess the number of NaN values using the isna() method call, and sum these values through method chaining.", "I then calculate the number of missing values over the total number of rows to get a percentage of missing values for each column and print out this data.", "While this is informative, it requires some reading to fully interpret the results. A better way to determine missing results may be to produce a useful graphic using a seaborn heatmap.", "We first pass in the dataframe.isna(), which return True if a missing value is present. We can then set both cbar and ytickslabels to False, choose a colour mapping (here, the string viridis), and visualise the results.", "Now we have a quick reference graphic which usefully informs us, which columns are missing data. Here, we can see that the column glucose has the most number of missing data values.", "The sci-kit learn machine learning library provides the SimpleImputer class which implements statistical imputation.", "To use SimpleImputer, first import the class, and then instantiate the class with a string argument passed to the strategy parameter. For clarity, I have included \u2018mean\u2019 here, which is the default and therefore not necessary to explicitly include.", "I convert the dataframe into a numpy array by calling values on my dataframe (not necessary), but a habit I prefer. I then select my features and assign them to the variable X, and select my target variable and assign it to the variable y.", "The imputer is fit on the dataset to calculate the statistic for each column. The fit imputer is then applied to the dataset to create a copy of the dataset with all the missing values for each column replaced with the calculated mean statistic.", "To confirm that data imputation has worked, we can assess the number of missing values on the dataset with and without the data transform applied. When the data transform is applied 645 column values have been imputed.", "Model evaluation is best performed using repeated k-fold cross-validation. It is required that the calculated statistic for each column are calculated on the training dataset first, then applied to the train and test sets for each fold in the dataset.", "To achieve this, we can create a modelling pipeline, where the first step is the statistical imputation, and the second step is the model itself.", "The following pipeline uses the mean strategy for statistical imputation, and uses a RandomForestClassifier for making the model prediction.", "We achieved 84.7% accuracy with a standard deviation of 0.007. This is a reasonable result, but it would be useful to know which imputation strategy is best for predictive modelling performance.", "To test different imputation strategies, we can iterate through the strategies. For each pipeline we can construct a new strategy, calculate the cross val scores, and append them to the results list.", "We can use the arrays in the results list and the strategy type to produce a box and whisker plot to decipher which data imputation strategy is optimal. I have decided to check both the mean scores and the max scores for each strategy type.", "The box and whisker plots indicate the best accuracy scores are obtained using the constant (0) imputation strategy.", "A prediction can now be made using the best imputation strategy. The pipeline is defined and fitted on all available data.", "We can take the first row in our array, reshape it, assign it to the variable name sample and pass it as an argument to the predict method call, called on the pipeline.", "To confirm this is the correct result, we can check the first y target variable label. Our model predicts a 0 class and the class is in fact a 0 class too.", "The SimpleImputer class can be an effective way to impute missing values using a calculated statistic. By using k-fold cross validation, we can quickly determine which strategy passed to the SimpleImputer class gives the best predictive modelling performance.", "The link to the complete Jupyter notebook for this tutorial can be found here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Articles on Data Science and Programming https://github.com/StephenFordham"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F10b321c94861&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----10b321c94861--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----10b321c94861--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@stephenfordham?source=post_page-----10b321c94861--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=post_page-----10b321c94861--------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e----10b321c94861---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F10b321c94861&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F10b321c94861&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/sWlDOWk0Jp8", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/dileep070/heart-disease-prediction-using-logistic-regression", "anchor_text": "kaggle"}, {"url": "https://github.com/StephenFordham/scikit-learn_tutorials", "anchor_text": "github page"}, {"url": "https://github.com/StephenFordham/scikit-learn_tutorials/blob/main/heart%20disease%20model.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----10b321c94861---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----10b321c94861---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----10b321c94861---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----10b321c94861---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----10b321c94861---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F10b321c94861&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----10b321c94861---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F10b321c94861&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&user=Stephen+Fordham&userId=5d3f46276e7e&source=-----10b321c94861---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F10b321c94861&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----10b321c94861--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F10b321c94861&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----10b321c94861---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----10b321c94861--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----10b321c94861--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----10b321c94861--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----10b321c94861--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----10b321c94861--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----10b321c94861--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----10b321c94861--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----10b321c94861--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stephenfordham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Stephen Fordham"}, {"url": "https://medium.com/@stephenfordham/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "977 Followers"}, {"url": "https://github.com/StephenFordham", "anchor_text": "https://github.com/StephenFordham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5d3f46276e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&user=Stephen+Fordham&userId=5d3f46276e7e&source=post_page-5d3f46276e7e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbd4ed43cae00&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-the-simpleimputer-class-in-machine-learning-with-python-10b321c94861&newsletterV3=5d3f46276e7e&newsletterV3Id=bd4ed43cae00&user=Stephen+Fordham&userId=5d3f46276e7e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}