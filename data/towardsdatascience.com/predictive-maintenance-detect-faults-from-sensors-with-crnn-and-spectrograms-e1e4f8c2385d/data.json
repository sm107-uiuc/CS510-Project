{"url": "https://towardsdatascience.com/predictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d", "time": 1683003152.3770912, "path": "towardsdatascience.com/predictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d/", "webpage": {"metadata": {"title": "Predictive Maintenance: detect Faults from Sensors with CRNN and Spectrograms | by Marco Cerliani | Towards Data Science", "h1": "Predictive Maintenance: detect Faults from Sensors with CRNN and Spectrograms", "description": "Predictive Maintenance is an active field of research in every area. Especially in recent years, a great boom is registered in Machine Learning solutions. Some business invests a great amount of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Condition+monitoring+of+hydraulic+systems#", "anchor_text": "Condition monitoring of hydraulic systems", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/predictive-maintenance-detect-faults-from-sensors-with-cnn-6c6172613371", "anchor_text": "previous post", "paragraph_index": 5}], "all_paragraphs": ["Predictive Maintenance is an active field of research in every area. Especially in recent years, a great boom is registered in Machine Learning solutions. Some business invests a great amount of money to develop solutions that can predict in advance a possible fault occurring in the business activities.", "An interesting domain for these studies is the IoT industry, where we have sensors that monitor the working status of a machine or a particular engine part. The classical approach for this kind of problem involves usually the adoption of time series models in conjunction with signal process techniques which enable us to extract value from high-frequency data.", "In this post, we carry out a Predictive Maintenance task with the adoption of a Deep Learning architecture to deal with a high-frequency sequence of data which we preprocessed with Spectrograms. This step enables us to adopt a particular neural network structure, known as Convolution Recurrent Neural Network (CRNN), which learns at the same time from the spatial and recurrent structure of our data.", "Our task requires the study of a hydraulic pipeline under pressure conditions, in order to track the activity status of a particular part of the system.", "The data set was experimentally obtained with a hydraulic test rig. This test rig consists of a primary working and a secondary cooling-filtration circuit which are connected via the oil tank. The system cyclically repeats constant load cycles (duration 60 seconds) and measures process values such as pressures, volume flows and temperatures while the condition of four hydraulic components (cooler, valve, pump and accumulator) is quantitatively varied.", "The data were collected by UCI repository (Condition monitoring of hydraulic systems) and are well known to us because I used it in a previous post to develop a Predictive Maintenance solution. Now our scope is always to develop a Machine Learning solution that is able to detect faults, but we are interested to deal with high-frequency data. So we make use of the pressure data sampled at 100 Hz (6000 attributes per sensor: 6 in total) to build a model which classifies the status of the Accumulator in four classes (optimal pressure, slightly reduced pressure, severely reduced pressure, close to total failure).", "The first step to deal with this kind of raw data involves an adequate preprocess phase. The data are just split into fixed and equal labeled sequences, our duty is to extract value from this source of information. As introduced previously, we adopt Spectrograms to preprocess these signal pieces and feed a CRNN. Spectrograms are time-frequency portraits of signals. They are a plot of the intensity of the frequency content of the signal as time progresses. They are widely adopted in the audio process/classification and are useful to us for their ability to map the data behaviors in a high-frequency domain. To apply spectrogram transformations we have to first reduce the magnitude of our series; a simple differentiation, plus a proper clip to limit extreme variations, sounds good. Below an example of a raw and a standardized sequence composed of 6 different pressure signals:", "Compute spectrograms in python is quite easy; a good library which provides this functionality is Librosa. A transformation is operated for every pressure series at our disposal, so we ended with a sequence of 6 spectrograms for every sample instead of a sequence of raw signals.", "Convolutional and Recurrent Neural Network is the most common and powerful structure to build Deep Learning models. CNNs and RNNs are not mutually exclusive, as both can perform classification of image and text inputs, creating an opportunity to combine the two network types for increased effectiveness. This is especially true if the input to be classified is visually complex with added temporal characteristics that a CNN alone would be unable to process.", "Typically, when these two network types are combined, sometimes referred to as a CRNN, inputs are first processed by CNN layers whose outputs are then fed to RNN layers. These hybrid architectures are being explored for applications like video scene labeling, Optical Character Recognition, or audio classification. For our analysis, we feed CRNN with spectrograms we have previously generated, to detect the working status of the Accumulator in our hydraulic pipeline. Each observation is now composed of stacked spectrograms (6 in total, one for each pressure signal). In Keras language we can reproduce a CRNN in this way:", "In the first stage, the network extracts convolution features from spectrogram plots, preserving the structure frequency x time x n_features. When we pass to the recurrent part, we need to reshape our data in the format time x n_features: time is the same dimension we observe in the convolutional level and spectrograms; the new n_features is the result of the flattering operation computed on the convolutional n_features and frequency.", "In the end, our model can achieve around 86% accuracy on our test set.", "In this post, I\u2019ve carried out a Predictive Maintenance task classifying the working status of a particular kind of component in a hydraulic pipeline. We can achieve great performances applying, at preprocessing stage, a spectrogram transformation of the raw high-frequency pressure signals, and a powerful CRNN, as the model structure, to extract spatial and temporal features from our data.", "If you are interested in the topic, I suggest:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe1e4f8c2385d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----e1e4f8c2385d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1e4f8c2385d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1e4f8c2385d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@thegalaxyshooter?utm_source=medium&utm_medium=referral", "anchor_text": "James Thomas"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Condition+monitoring+of+hydraulic+systems#", "anchor_text": "Condition monitoring of hydraulic systems"}, {"url": "https://towardsdatascience.com/predictive-maintenance-detect-faults-from-sensors-with-cnn-6c6172613371", "anchor_text": "previous post"}, {"url": "https://towardsdatascience.com/predictive-maintenance-detect-faultsfrom-sensors-with-cnn-6c6172613371", "anchor_text": "Predictive Maintenance: detect Faults from Sensors with CNN"}, {"url": "https://towardsdatascience.com/predictive-maintenance-with-lstm-siamese-network-51ee7df29767", "anchor_text": "Predictive Maintenance with LSTM Siamese Network"}, {"url": "https://medium.com/towards-data-science/predictive-maintenance-with-resnet-ebb4f4a0be3d", "anchor_text": "Predictive Maintenance with ResNet"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e1e4f8c2385d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e1e4f8c2385d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/predictive-maintenance?source=post_page-----e1e4f8c2385d---------------predictive_maintenance-----------------", "anchor_text": "Predictive Maintenance"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----e1e4f8c2385d---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----e1e4f8c2385d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe1e4f8c2385d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&user=Marco+Cerliani&userId=c843902314c7&source=-----e1e4f8c2385d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe1e4f8c2385d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&user=Marco+Cerliani&userId=c843902314c7&source=-----e1e4f8c2385d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe1e4f8c2385d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe1e4f8c2385d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e1e4f8c2385d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e1e4f8c2385d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredictive-maintenance-detect-faults-from-sensors-with-crnn-and-spectrograms-e1e4f8c2385d&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}