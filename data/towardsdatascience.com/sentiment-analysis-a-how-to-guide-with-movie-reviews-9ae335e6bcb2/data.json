{"url": "https://towardsdatascience.com/sentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2", "time": 1683002231.8873699, "path": "towardsdatascience.com/sentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2/", "webpage": {"metadata": {"title": "Sentiment Analysis \u2014 A how-to guide with movie reviews | by Shiao-li Green | Towards Data Science", "h1": "Sentiment Analysis \u2014 A how-to guide with movie reviews", "description": "So, what exactly is sentiment? Sentiment relates to the meaning of a word or sequence of words and is usually associated with an opinion or emotion. And analysis? Well, this is the process of looking\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/word2vec-nlp-tutorial/data", "anchor_text": "IMDB movie dataset", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/word2vec-nlp-tutorial/", "anchor_text": "Kaggle challenge", "paragraph_index": 2}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "sklearn\u2019s library", "paragraph_index": 9}, {"url": "https://github.com/shiaoligreen/practical-data-science/tree/master/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn", "anchor_text": "the GitHub folder", "paragraph_index": 12}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfTransformer.html", "anchor_text": "sklearn\u2019s library", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/naive_bayes.html", "anchor_text": "sklearn\u2019s Na\u00efve Bayes package", "paragraph_index": 23}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html", "anchor_text": "sklearn\u2019s ensemble package", "paragraph_index": 24}, {"url": "https://www.kaggle.com/c/word2vec-nlp-tutorial/", "anchor_text": "https://www.kaggle.com/c/word2vec-nlp-tutorial/", "paragraph_index": 31}], "all_paragraphs": ["So, what exactly is sentiment? Sentiment relates to the meaning of a word or sequence of words and is usually associated with an opinion or emotion. And analysis? Well, this is the process of looking at data and making inferences; in this case, using machine learning to learn and predict whether a movie review is positive or negative.", "Maybe you\u2019re interested in knowing whether movie reviews are positive or negative, companies use sentiment analysis in a variety of settings, particularly for marketing purposes. Uses include social media monitoring, brand monitoring, customer feedback, customer service and market research (\u201cSentiment Analysis\u201d).", "We\u2019ll be using the IMDB movie dataset which has 25,000 labelled reviews for training and 25,000 reviews for testing. The Kaggle challenge asks for binary classification (\u201cBag of Words Meets Bags of Popcorn\u201d).", "Let\u2019s have a look at some summary statistics of the dataset (Li, 2019). We are told that there is an even split of positive and negative movie reviews. Here are some of the positive and negative reviews:", "It\u2019s also interesting to see the distribution of the length of movie reviews (word count) split according to sentiment. The spread is similar in shape for both types of reviews however negative reviews are on average a tad shorter.", "Text is messy, people love to throw in attempts at expressing themselves more clearly by adding extravagant punctuation and spelling words incorrectly. However, machine learning models can\u2019t cope with text as input, so we need to map the characters and words to numerical representations.", "Basic pre-processing for text consists of removing non-alphabetic characters, stop words (a set of very common words like the, a, and, etc.) and changing all words to lowercase. In this instance, we also need to remove HTML tags from the movie reviews. These steps can be packaged into the following function.", "The table below shows how the most frequent words change once stop words are removed from the reviews.", "How should we approach transforming word representations to numerical versions that a model can interpret? There are many ways, but for now, let\u2019s try a few of the simple approaches.", "We obtain the vocabulary list from the corpus (whole text dataset). The length of the vocabulary list is equal to the length of the vector that will be output when we apply Bag of Words (BOW). For each item (could be an entry, sentence, line of text), we transform the text into a frequency count in the form of a vector. In this case, we limit it to the top 5000 words to restrict the dimensionality of the data. We code this by setting up a count vectorizer from sklearn\u2019s library, fit it on the training data and then transform both the training and test data.", "An example of how this works is in the grey box below. We look at all the unique words in the corpus and then count how many times these appear in each of the pieces of texts, resulting in a vector representation of each piece of text.", "Word2vec (Word to Vector) is a two-layer neural net that processes text. Its input is a text corpus and its output is a set of vectors: feature vectors for words in that corpus. The algorithm was created by Google in 2013. The 50-D space can be visualised by using classical projection methods (e.g. PCA) to reduce the vectors to two-dimensional data that can be plotted on a graph.", "Why would we use Word2vec instead of BOW? It is better at learning words in their surrounding context. The process is a bit more convoluted than implementing BOW so I won\u2019t outline it here, but it can be found in the GitHub folder (Dar, Green, Kurban & Mitchell, 2019). In short, it requires tokenising reviews as sentences rather than words, determining the vector representations and then averaging them appropriately.", "This is short for Term-frequency-Inverse-Document-Frequency and gives us a measure of how important a word is in the document.", "Term frequency (the same as for bag of words):", "Inverse document frequency measures how rare a term is across all documents (the higher the value, the rarer the word)[1]:", "We combine these two to get Tf-Idf as follows:", "To implement this representation, we use the TfidfTransformer function from sklearn\u2019s library. Fitting occurs on the training set and the values for the same words are determined for the test set.", "[1] Where ln is the natural logarithm.", "We attempted two different models for this dataset: Na\u00efve Bayes and Random Forest. Na\u00efve Bayes builds on Bayes\u2019 Theorem while a Random Forest is a group of decision trees. Consolidated code for these two implementations can be found in the NLP_IMDb Jupyter notebook in the GitHub Repository (Dar et al., 2019).", "This is a probabilistic machine learning model used for classification, based on Bayes Theorem:", "B is the evidence while A is the hypothesis (Gandhi, 2018). We must assume that the features are independent (one does not affect the other).", "Framing it in terms of this problem we have y representing a positive or negative review, X represents a vector of the features from the reviews. The equation we end up with for finding the class is:", "This is implemented using sklearn\u2019s Na\u00efve Bayes package!", "A random forest is a series of decision trees in which the leaf nodes indicate the predicted class. We can use the RandomForestClassifier function from sklearn\u2019s ensemble package.", "Each decision tree incorporates a selection of features and outputs a decision at the end. These results are then combined from all the decision trees to give the final class prediction. The diagram below from DataCamp visualises the process quite nicely.", "Kaggle specifies using the area under the ROC curve as the metric for this competition. ROC is short for Receiving Operator Characteristic and is a probability curve. It plots the true positive rate against the false positive rate.[2] The higher the area under this curve, the better the model is at predicting the output. The graph for Bag of words and a Random Forest is below. The dotted line represents the baseline, which would be expected if the predictions were random.", "We can inspect a few different permutations in the table below.", "It\u2019s interesting to see that Tf-Idf does marginally better and Na\u00efve Bayes performs slightly better than the Random Forest. However, there is a significant drop in the performance of Na\u00efve Bayes with Word2Vec features. This is likely because some information is lost when the representation is transformed to be positive (since Na\u00efve Bayes only allows for positive values) and Gaussian Na\u00efve Bayes is used instead.", "[2] True positive represents when an item that is positive is predicted as positive. False positive represents when an item that is negative is predicted as positive.", "This is just the start of sentiment analysis. Further approaches could use bigrams (sequences of two words) to attempt to retain more contextual meaning, using neural networks like LSTMs (Long Short-Term Memory) to extend the distance of relationships among words in the reviews and more.", "Bag of Words Meets Bags of Popcorn. (n.d.). Retrieved from https://www.kaggle.com/c/word2vec-nlp-tutorial/", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9ae335e6bcb2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shiaoligreen?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shiaoligreen?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": "Shiao-li Green"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb1c74a1ba549&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&user=Shiao-li+Green&userId=b1c74a1ba549&source=post_page-b1c74a1ba549----9ae335e6bcb2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ae335e6bcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ae335e6bcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/data-science-in-the-real-world/home", "anchor_text": "Data Science in the Real World"}, {"url": "https://www.kaggle.com/c/word2vec-nlp-tutorial/data", "anchor_text": "IMDB movie dataset"}, {"url": "https://www.kaggle.com/c/word2vec-nlp-tutorial/", "anchor_text": "Kaggle challenge"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html", "anchor_text": "sklearn\u2019s library"}, {"url": "https://github.com/shiaoligreen/practical-data-science/tree/master/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn", "anchor_text": "the GitHub folder"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfTransformer.html", "anchor_text": "sklearn\u2019s library"}, {"url": "https://scikit-learn.org/stable/modules/naive_bayes.html", "anchor_text": "sklearn\u2019s Na\u00efve Bayes package"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html", "anchor_text": "sklearn\u2019s ensemble package"}, {"url": "https://www.kaggle.com/c/word2vec-nlp-tutorial/", "anchor_text": "https://www.kaggle.com/c/word2vec-nlp-tutorial/"}, {"url": "https://github.com/shiaoligreen/practical-data-science", "anchor_text": "https://github.com/shiaoligreen/practical-data-science"}, {"url": "https://towardsdatascience.com/naive-bayes-classifier-81d512f50a7c", "anchor_text": "https://towardsdatascience.com/naive-bayes-classifier-81d512f50a7c"}, {"url": "https://towardsdatascience.com/a-complete-exploratory-data-analysis-and-visualization-for-text-data-29fb1b96fb6a", "anchor_text": "https://towardsdatascience.com/a-complete-exploratory-data-analysis-and-visualization-for-text-data-29fb1b96fb6a"}, {"url": "https://monkeylearn.com/sentiment-analysis/", "anchor_text": "https://monkeylearn.com/sentiment-analysis/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9ae335e6bcb2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9ae335e6bcb2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----9ae335e6bcb2---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/movies?source=post_page-----9ae335e6bcb2---------------movies-----------------", "anchor_text": "Movies"}, {"url": "https://medium.com/tag/ds-in-the-real-world?source=post_page-----9ae335e6bcb2---------------ds_in_the_real_world-----------------", "anchor_text": "Ds In The Real World"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ae335e6bcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&user=Shiao-li+Green&userId=b1c74a1ba549&source=-----9ae335e6bcb2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9ae335e6bcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&user=Shiao-li+Green&userId=b1c74a1ba549&source=-----9ae335e6bcb2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9ae335e6bcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9ae335e6bcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9ae335e6bcb2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9ae335e6bcb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shiaoligreen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shiaoligreen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shiao-li Green"}, {"url": "https://medium.com/@shiaoligreen/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "19 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb1c74a1ba549&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&user=Shiao-li+Green&userId=b1c74a1ba549&source=post_page-b1c74a1ba549--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fb1c74a1ba549%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-a-how-to-guide-with-movie-reviews-9ae335e6bcb2&user=Shiao-li+Green&userId=b1c74a1ba549&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}