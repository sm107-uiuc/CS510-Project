{"url": "https://towardsdatascience.com/brute-forcing-the-cartpole-problem-4d04c9c34b12", "time": 1683009589.6248288, "path": "towardsdatascience.com/brute-forcing-the-cartpole-problem-4d04c9c34b12/", "webpage": {"metadata": {"title": "Brute Forcing The Cartpole Problem | by Adam Price | Towards Data Science", "h1": "Brute Forcing The Cartpole Problem", "description": "The cartpole problem is a prominent benchmark problem in Reinforcement Learning, its implementation on OpenAI\u2019s Gym being the most well known. It is also the most popular on their leaderboards; which\u2026"}, "outgoing_paragraph_urls": [{"url": "https://gym.openai.com/envs/CartPole-v0/", "anchor_text": "cartpole problem", "paragraph_index": 0}, {"url": "https://github.com/openai/gym/wiki/Leaderboard", "anchor_text": "It is also the most popular on their leaderboard", "paragraph_index": 0}, {"url": "https://github.com/adamprice97/Control/blob/master/BruteForceCartepole.ipynb", "anchor_text": "https://github.com/adamprice97/Control/blob/master/BruteForceCartepole.ipynb", "paragraph_index": 3}, {"url": "https://github.com/adamprice97/Control/blob/master/BruteForceCartepole2.ipynb", "anchor_text": "https://github.com/adamprice97/Control/blob/master/BruteForceCartepole2.ipynb", "paragraph_index": 16}], "all_paragraphs": ["The cartpole problem is a prominent benchmark problem in Reinforcement Learning, its implementation on OpenAI\u2019s Gym being the most well known. It is also the most popular on their leaderboards; which makes sense, it is one of the easier problems in classic control. But just how easy is it?", "As it stands right now, a solution needs to balance the pole for an average of 195 (or more) steps over 100 episodes. Keep in mind that each episode ends after 200 steps, so the solution does need to be somewhat stable.", "For a while now, I have thought that balancing the pole for only 200 steps is too easy. So, in an attempt to confirm my suspicions, I have brute-forced the problem.", "If you want to follow along with all the code that I used, please feel free to view it here: https://github.com/adamprice97/Control/blob/master/BruteForceCartepole.ipynb", "In cryptography, a brute force attack first calculates all the possible password strings. It then applies these passwords iteratively until it finds the correct one. To use a similar approach in control, we need to generate a range of policies to control the cartpole. This would be impossible to do with continuous state space so we will have to discretise the state-space.", "The cartpole problem has 4 observations: \u2018cart position\u2019, \u2018cart velocity\u2019, \u2018pole angle\u2019, and \u2018pole velocity\u2019. We will be completely disregarding \u2018cart position\u2019 and \u2018cart velocity\u2019, 200 timesteps won\u2019t be enough for the cart to move far enough to end the episode. This leaves us with \u2018pole angle\u2019 and \u2018pole velocity\u2019 which will both be \u2018discretised\u2019 into 3 separate bins, creating 9 possible states of the environment.", "The cartpole problem only has 2 actions, so with 9 states, we have a limit of 512 (2\u2079) deterministic greedy policies. All we need now is a way to generate these policies then we can attempt to solve using brute force:", "At each state-action pair, the cart will either move left or right (0 or 1). So, to create the policy, we simply generate the binary for every number from 0 to 511. The string then gets reshaped to form a 3 by 3 matrix for easier pipelining.", "It would be computationally expensive to completely evaluate every policy, so, to start, we ran each policy on the problem once and kept track of those that scored above 195.", "When we ran this script, we found that 34, of the initial 512, policies are potential solutions. To examine them further, we need to run these potential solutions for 100 episodes and average their performance.", "When we ran this we found 8 solutions in 39.1 seconds. So, there we have it. We successfully brute-forced the cartpole problem!", "Now, this is clearly a terrible method to solve control problems. The solutions we found are very precarious, none of them could balance the pole for more than 300 timesteps. To find better solutions, we would need to use more buckets in the state space and given the quadratic complexity of this method, this would be quite foolish to try.", "Yet, we have found valid solutions. Is this a damning indictment on cartpole as a benchmark problem? I don\u2019t think so. The problem can still be difficult, you just need to balance the pole for longer. Raising the average to reward to average to 490 with a cap at 500 would likely make a brute force method like this redundant.", "Besides, do benchmarks even need to be difficult? Algorithms solving cartpole are usually compared by the number of episodes they needed before solving the environment. This brute force algorithm needs 512 non-evaluation iterations, which would be last on Gym\u2019s leaderboard\u2026", "Edit: Towards the end of this article I claimed:", "\u2018Raising the average to reward to average to 490 with a cap at 500 would likely make a brute force method like this redundant.\u2019", "Well, it turns out I was wrong. This notebook has proof of this: https://github.com/adamprice97/Control/blob/master/BruteForceCartepole2.ipynb", "This method can, in fact, solve 500 steps within a reasonable time frame.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning and Data Science enthusiast!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4d04c9c34b12&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@adamprice97?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamprice97?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": "Adam Price"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e52daf12ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&user=Adam+Price&userId=9e52daf12ce1&source=post_page-9e52daf12ce1----4d04c9c34b12---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d04c9c34b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d04c9c34b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@eye__cup", "anchor_text": "Mohamed Jasir"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Upslash"}, {"url": "https://gym.openai.com/envs/CartPole-v0/", "anchor_text": "cartpole problem"}, {"url": "https://github.com/openai/gym/wiki/Leaderboard", "anchor_text": "It is also the most popular on their leaderboard"}, {"url": "https://github.com/adamprice97/Control/blob/master/BruteForceCartepole.ipynb", "anchor_text": "https://github.com/adamprice97/Control/blob/master/BruteForceCartepole.ipynb"}, {"url": "https://github.com/adamprice97/Control/blob/master/BruteForceCartepole2.ipynb", "anchor_text": "https://github.com/adamprice97/Control/blob/master/BruteForceCartepole2.ipynb"}, {"url": "https://medium.com/tag/control?source=post_page-----4d04c9c34b12---------------control-----------------", "anchor_text": "Control"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----4d04c9c34b12---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/cartpole?source=post_page-----4d04c9c34b12---------------cartpole-----------------", "anchor_text": "Cartpole"}, {"url": "https://medium.com/tag/brute-force?source=post_page-----4d04c9c34b12---------------brute_force-----------------", "anchor_text": "Brute Force"}, {"url": "https://medium.com/tag/openai-gym?source=post_page-----4d04c9c34b12---------------openai_gym-----------------", "anchor_text": "Openai Gym"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d04c9c34b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&user=Adam+Price&userId=9e52daf12ce1&source=-----4d04c9c34b12---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d04c9c34b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&user=Adam+Price&userId=9e52daf12ce1&source=-----4d04c9c34b12---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d04c9c34b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4d04c9c34b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4d04c9c34b12---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4d04c9c34b12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamprice97?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamprice97?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adam Price"}, {"url": "https://medium.com/@adamprice97/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e52daf12ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&user=Adam+Price&userId=9e52daf12ce1&source=post_page-9e52daf12ce1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F53e947916578&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbrute-forcing-the-cartpole-problem-4d04c9c34b12&newsletterV3=9e52daf12ce1&newsletterV3Id=53e947916578&user=Adam+Price&userId=9e52daf12ce1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}