{"url": "https://towardsdatascience.com/extending-pytorch-with-custom-activation-functions-2d8b065ef2fa", "time": 1682996868.808405, "path": "towardsdatascience.com/extending-pytorch-with-custom-activation-functions-2d8b065ef2fa/", "webpage": {"metadata": {"title": "Extending PyTorch with Custom Activation Functions | by Alexandra Deis | Towards Data Science", "h1": "Extending PyTorch with Custom Activation Functions", "description": "Today deep learning is going viral and is applied to a variety of machine learning problems such as image recognition, speech recognition, machine translation, and others. There is a wide range of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Activation_function", "anchor_text": "The activation function", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Sigmoid_function", "anchor_text": "Sigmoid", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Hyperbolic_function", "anchor_text": "Tanh", "paragraph_index": 1}, {"url": "https://pytorch.org", "anchor_text": "PyTorch", "paragraph_index": 3}, {"url": "https://github.com/Lexie88rus/Activation-functions-examples-pytorch/blob/master/custom_activations_example.py", "anchor_text": "on GitHub", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1606.08415.pdf", "anchor_text": "Sigmoid Linear Unit or just SiLU", "paragraph_index": 8}, {"url": "https://arxiv.org/pdf/1602.01321.pdf", "anchor_text": "Soft Exponential", "paragraph_index": 12}, {"url": "https://arxiv.org/pdf/1709.04054.pdf", "anchor_text": "BReLU", "paragraph_index": 16}, {"url": "https://github.com/Lexie88rus/Activation-functions-examples-pytorch/blob/master/custom_activations_example.py", "anchor_text": "GitHub", "paragraph_index": 21}, {"url": "https://pytorch.org", "anchor_text": "PyTorch", "paragraph_index": 21}, {"url": "https://keras.io", "anchor_text": "Keras", "paragraph_index": 21}, {"url": "https://github.com/digantamisra98/Echo/tree/Dev-adeis", "anchor_text": "this GitHub repository", "paragraph_index": 21}, {"url": "https://www.linkedin.com/in/aleksandra-deis-0912/", "anchor_text": "https://www.linkedin.com/in/aleksandra-deis-0912/", "paragraph_index": 25}], "all_paragraphs": ["Today deep learning is going viral and is applied to a variety of machine learning problems such as image recognition, speech recognition, machine translation, and others. There is a wide range of highly customizable neural network architectures, which can suit almost any problem when given enough data. Each neural network should be elaborated to suit the given problem well enough. You have to fine tune the hyperparameters of the network (the learning rate, dropout coefficients, weight decay, and many others) as well as the number of hidden layers, and the number of units in each layer. Choosing the right activation function for each layer is also crucial and may have a significant impact on metric scores and the training speed of the model.", "The activation function is an essential building block for every neural network. We can choose from a huge list of popular activation functions from popular Deep Learning frameworks, like ReLU, Sigmoid, Tanh, and many others.", "However, to create a state of the art model, customized particularly for your task, you may need to use a custom activation function, which is absent in Deep Learning framework you are using. Activation functions can be roughly classified into the following groups by complexity:", "In this tutorial, I cover the implementation and demo examples for all of these types of functions with PyTorch framework. You can find all the code for this article on GitHub.", "To go through the examples of the implementation of activation functions, you would require:", "The last thing is to set up a sample function, which runs the model training process and prints out the training loss for each epoch:", "Now everything is ready for the creation of models with custom activation functions.", "The most simple common activation functions", "One of the examples of such simple functions is Sigmoid Linear Unit or just SiLU, also known as Swish-1:", "Such a simple activation function can be implemented just as easy as a Python function:", "So now SiLU can be used in models created with nn.Sequential:", "Or in a simple model, which extends nn.Module class:", "There are lots of activation functions with parameters, which can be trained with gradient descent while training the model. A great example for one of these is Soft Exponential function:", "To implement an activation function with trainable parameters we have to:", "Here is an example for Soft Exponential:", "And now we can use Soft Exponential in our models as follows:", "The perfect example of an activation function, which needs implementation of a custom backward step is BReLU (Bipolar Rectified Linear Unit):", "This function is not differentiable at 0, so automatic gradient computation might fail. That\u2019s why we should provide a custom backward step to ensure stable computation.", "To impement custom activation function with backward step we should:", "Let\u2019s see an example for BReLU:", "We can now use BReLU in our models as follows:", "All code from this tutorial is available on GitHub. Other examples of implemented custom activation functions for PyTorch and Keras you can find in this GitHub repository.", "While building many custom activation functions, I noticed that they often consume much more GPU memory. Creation of in place implementations of custom activations using PyTorch in place methods improves this situation.", "Here are some links to the additional resources and further reading:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A business analyst turned data scientist passionate about solving business problems with data. Connect me: https://www.linkedin.com/in/aleksandra-deis-0912/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2d8b065ef2fa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@astakhova.aleksandra?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@astakhova.aleksandra?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": "Alexandra Deis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9f0981e41a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&user=Alexandra+Deis&userId=9f0981e41a86&source=post_page-9f0981e41a86----2d8b065ef2fa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d8b065ef2fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d8b065ef2fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@chivozol-43727?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "chivozol"}, {"url": "https://www.pexels.com/photo/close-up-photography-of-spider-web-167259/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://en.wikipedia.org/wiki/Activation_function", "anchor_text": "The activation function"}, {"url": "https://en.wikipedia.org/wiki/Rectifier_(neural_networks)", "anchor_text": "ReLU"}, {"url": "https://en.wikipedia.org/wiki/Sigmoid_function", "anchor_text": "Sigmoid"}, {"url": "https://en.wikipedia.org/wiki/Hyperbolic_function", "anchor_text": "Tanh"}, {"url": "https://arxiv.org/pdf/1710.09967.pdf", "anchor_text": "SiLU"}, {"url": "https://arxiv.org/pdf/1710.09967.pdf", "anchor_text": "Inverse Square Root Unit (ISRU)"}, {"url": "https://arxiv.org/pdf/1602.01321.pdf", "anchor_text": "Soft Exponential"}, {"url": "https://arxiv.org/pdf/1512.07030.pdf", "anchor_text": "S-shaped Rectified Linear Unit (SReLU)"}, {"url": "https://arxiv.org/pdf/1709.04054.pdf", "anchor_text": "Bipolar Rectified Linear Unit (BReLU)"}, {"url": "https://pytorch.org", "anchor_text": "PyTorch"}, {"url": "https://github.com/Lexie88rus/Activation-functions-examples-pytorch/blob/master/custom_activations_example.py", "anchor_text": "on GitHub"}, {"url": "https://pytorch.org/get-started/locally/", "anchor_text": "PyTorch"}, {"url": "https://www.kaggle.com/zalando-research/fashionmnist", "anchor_text": "Fashion MNIST dataset"}, {"url": "https://arxiv.org/pdf/1606.08415.pdf", "anchor_text": "Sigmoid Linear Unit or just SiLU"}, {"url": "https://arxiv.org/pdf/1602.01321.pdf", "anchor_text": "Soft Exponential"}, {"url": "https://arxiv.org/pdf/1709.04054.pdf", "anchor_text": "BReLU"}, {"url": "https://github.com/Lexie88rus/Activation-functions-examples-pytorch/blob/master/custom_activations_example.py", "anchor_text": "GitHub"}, {"url": "https://pytorch.org", "anchor_text": "PyTorch"}, {"url": "https://keras.io", "anchor_text": "Keras"}, {"url": "https://github.com/digantamisra98/Echo/tree/Dev-adeis", "anchor_text": "this GitHub repository"}, {"url": "https://en.wikipedia.org/wiki/Activation_function", "anchor_text": "Activation functions wiki page"}, {"url": "https://pytorch.org/docs/master/notes/extending.html", "anchor_text": "Tutorial on extending PyTorch"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2d8b065ef2fa---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----2d8b065ef2fa---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2d8b065ef2fa---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----2d8b065ef2fa---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----2d8b065ef2fa---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2d8b065ef2fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&user=Alexandra+Deis&userId=9f0981e41a86&source=-----2d8b065ef2fa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2d8b065ef2fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&user=Alexandra+Deis&userId=9f0981e41a86&source=-----2d8b065ef2fa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d8b065ef2fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2d8b065ef2fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2d8b065ef2fa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2d8b065ef2fa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@astakhova.aleksandra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@astakhova.aleksandra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alexandra Deis"}, {"url": "https://medium.com/@astakhova.aleksandra/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "131 Followers"}, {"url": "https://www.linkedin.com/in/aleksandra-deis-0912/", "anchor_text": "https://www.linkedin.com/in/aleksandra-deis-0912/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9f0981e41a86&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&user=Alexandra+Deis&userId=9f0981e41a86&source=post_page-9f0981e41a86--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2500290b436e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextending-pytorch-with-custom-activation-functions-2d8b065ef2fa&newsletterV3=9f0981e41a86&newsletterV3Id=2500290b436e&user=Alexandra+Deis&userId=9f0981e41a86&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}