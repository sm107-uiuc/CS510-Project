{"url": "https://towardsdatascience.com/infinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0", "time": 1683008573.702359, "path": "towardsdatascience.com/infinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0/", "webpage": {"metadata": {"title": "Infinite Steps CartPole Problem With Variable Reward | by Suraj Regmi | Towards Data Science", "h1": "Infinite Steps CartPole Problem With Variable Reward", "description": "In the last blog post, we wrote our first reinforcement learning application \u2014 CartPole problem. We used Deep -Q-Network to train the algorithm. As we can see in the blog, the fixed reward of +1 was\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/cartpole-problem-using-tf-agents-build-your-first-reinforcement-learning-application-3e6006adeba7", "anchor_text": "last blog post", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/cartpole-problem-using-tf-agents-build-your-first-reinforcement-learning-application-3e6006adeba7", "anchor_text": "blog", "paragraph_index": 1}], "all_paragraphs": ["In the last blog post, we wrote our first reinforcement learning application \u2014 CartPole problem. We used Deep -Q-Network to train the algorithm. As we can see in the blog, the fixed reward of +1 was used for all the stable states and when the CartPole loses its balance, a reward of 0 was given. We saw at the end: when the CartPole approaches 200 steps, it tends to lose balance. We ended the blog suggesting a remark: the maximum number of steps (which we defined 200) and the fixed reward may have led to such behavior. Today, let\u2019s not limit the number of steps and modify the reward and see how the CartPole behaves.", "The CartPole problem is considered to be solved when the average reward is greater than or equal to 195.0 over 100 consecutive trials. This is considering the fixed reward of 1.0. Thanks to its definition, it makes sense to keep a fixed reward of 1.0 for every balance state and limit the maximum number of steps to 200. It delights to know that the problem was solved in the previous blog.", "The CartPole problem has the following conditions for episode termination:", "Our goal here is to remove the number of steps limitation and give a variable reward to each state.", "If x and \u03b8 represents cart position and pole angle respectively, we define the reward as:", "Here, both the cart position and pole angle components are normalized to [0, 1] interval to give equal weightage to them. Let\u2019s see the screenshot of the 2D view of the 3D graph.", "We see in the graph that when the CartPole is perfectly balanced (i.e. x = 0 and \u03b8 = 0), the maximum reward is achieved (i.e. 1). With increase in the absolute values of x and \u03b8, the reward decreases and reaches 0 when |x| = 2.4 and |\u03b8| = 12.", "Let\u2019s inherit the CartPole environment gym class (CartPoleEnv) to our custom class, CustomCartPoleEnv, and overwrite the step method. In the step method, we write the variable reward instead of the fixed reward.", "By using the above block of code, the components of TF-Agents are made and the Deep Q-Network is trained. We see that the CartPole is even more balanced and stable over a large number of steps.", "Let\u2019s see the video of how our CartPole behaves after using the variable reward.", "One episode lasts 35.4 seconds on an average. Impressive, isn\u2019t it?", "Here, the reward becomes zero only when both of the expressions (pole angle and cart position) reach the extreme values. We can employ different reward function that returns zero when one of the extreme conditions is reached. I expect such a reward function to do even better. Therefore, readers are encouraged to try such a reward function and comment how the CartPole behaved. Happy RLing!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CS Graduate Student at UAH, Former Data Scientist at World Bank \u2014 the views and the content here represent my own and not of my employers."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7ad9a0dcf6d0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://surajregmi.medium.com/?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": ""}, {"url": "https://surajregmi.medium.com/?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": "Suraj Regmi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd455fd5a9ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&user=Suraj+Regmi&userId=fd455fd5a9ab&source=post_page-fd455fd5a9ab----7ad9a0dcf6d0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ad9a0dcf6d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ad9a0dcf6d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/cartpole-problem-using-tf-agents-build-your-first-reinforcement-learning-application-3e6006adeba7", "anchor_text": "last blog post"}, {"url": "https://towardsdatascience.com/cartpole-problem-using-tf-agents-build-your-first-reinforcement-learning-application-3e6006adeba7", "anchor_text": "blog"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----7ad9a0dcf6d0---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7ad9a0dcf6d0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7ad9a0dcf6d0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7ad9a0dcf6d0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----7ad9a0dcf6d0---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7ad9a0dcf6d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&user=Suraj+Regmi&userId=fd455fd5a9ab&source=-----7ad9a0dcf6d0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7ad9a0dcf6d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&user=Suraj+Regmi&userId=fd455fd5a9ab&source=-----7ad9a0dcf6d0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ad9a0dcf6d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7ad9a0dcf6d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7ad9a0dcf6d0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7ad9a0dcf6d0--------------------------------", "anchor_text": ""}, {"url": "https://surajregmi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://surajregmi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Suraj Regmi"}, {"url": "https://surajregmi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "135 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd455fd5a9ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&user=Suraj+Regmi&userId=fd455fd5a9ab&source=post_page-fd455fd5a9ab--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feacad15e45f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finfinite-steps-cartpole-problem-with-variable-reward-7ad9a0dcf6d0&newsletterV3=fd455fd5a9ab&newsletterV3Id=eacad15e45f2&user=Suraj+Regmi&userId=fd455fd5a9ab&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}