{"url": "https://towardsdatascience.com/how-to-find-feature-importances-for-blackbox-models-c418b694659d", "time": 1683000726.334451, "path": "towardsdatascience.com/how-to-find-feature-importances-for-blackbox-models-c418b694659d/", "webpage": {"metadata": {"title": "How to find Feature importances for BlackBox Models? | by Rahul Agarwal | Towards Data Science", "h1": "How to find Feature importances for BlackBox Models?", "description": "I grapple through with many algorithms on a day to day basis, so I thought of listing some of the most common and most used algorithms one will end up using in this new DS Algorithm series. How many\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/tagged/ds-algorithms", "anchor_text": "DS Algorithm series", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/the-5-feature-selection-algorithms-every-data-scientist-need-to-know-3a6b566efd2", "anchor_text": "The 5 Feature Selection Algorithms every Data Scientist should know", "paragraph_index": 3}, {"url": "https://www.kaggle.com/mlwhiz/permutation-feature-selection-using-football-data", "anchor_text": "Kaggle Kernel", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/the-hitchhikers-guide-to-feature-extraction-b4c157e96631", "anchor_text": "Feature engineering", "paragraph_index": 24}, {"url": "https://towardsdatascience.com/the-5-feature-selection-algorithms-every-data-scientist-need-to-know-3a6b566efd2", "anchor_text": "post", "paragraph_index": 26}, {"url": "https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0", "anchor_text": "How to Win a Data Science Competition: Learn from Top Kagglers", "paragraph_index": 27}, {"url": "https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0", "anchor_text": "Advanced machine learning specialization", "paragraph_index": 27}, {"url": "https://medium.com/@rahul_agarwal?source=post_page---------------------------", "anchor_text": "Medium", "paragraph_index": 28}, {"url": "http://eepurl.com/dbQnuX?source=post_page---------------------------", "anchor_text": "blog", "paragraph_index": 28}, {"url": "https://twitter.com/MLWhiz?source=post_page---------------------------", "anchor_text": "@mlwhiz", "paragraph_index": 28}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 30}], "all_paragraphs": ["Data Science is the study of algorithms.", "I grapple through with many algorithms on a day to day basis, so I thought of listing some of the most common and most used algorithms one will end up using in this new DS Algorithm series.", "How many times it has happened when you create a lot of features and then you need to come up with ways to reduce the number of features?", "Last time I wrote a post titled \u201cThe 5 Feature Selection Algorithms every Data Scientist should know\u201d in which I talked about using correlation or tree-based methods and adding some structure to the process of feature selection.", "Recently I got introduced to another novel way of feature selection called Permutation Importance and really liked it.", "So, this post is explaining how permutation importance works and how we can code it using ELI5.", "Simply speaking, we can attribute importance to a feature based on how our evaluation metric(F1, Accuracy AUC, etc.) changes if we remove a particular feature from our dataset.", "It could be pretty straightforward \u2014 We remove a feature from our dataset and train the classifier and see how the evaluation metric changes. And we do it for all features.", "So we fit our model at least n times, where n is the number of features in the model. It is so much work and computation. Can we do better?", "Yes, we can. To calculate permutation importance, we shuffle/permute the values for a single feature and make predictions using the resulting dataset.", "The predictions are then used to calculate our evaluation metric. Intuitively, if our accuracy or any evaluation metric doesn\u2019t take a hit, we can say that the feature is not important. If our accuracy does take a hit, we consider this feature important.", "We will try to do this using a dataset to understand it better.", "I am going to be using a football player dataset and try to find out the most important features using it.", "Don\u2019t worry if you don\u2019t understand football terminologies. I will try to keep it at a minimum.", "You can see the full code here in this Kaggle Kernel.", "We have done some basic preprocessing such as removing nulls and one hot encoding. We also convert the problem to a classification problem using:", "Here we use High Overall as a proxy for a great player. Our dataset(X) looks like below and has 223 columns.", "ELI5 library makes it quite easy for us to use permutation importance for sklearn models. First, we train our model.", "Then we use the function PermutationImportance from the eli5.sklearn module.", "Here we note that Reactions, Interceptions and BallControl are the most important features to access a player\u2019s quality.", "We can also use eli5 to calculate feature importance for non scikit-learn models also. Here we train a LightGBM model.", "We will need to create a wrapper for our score function to calculate our evaluation metric.", "We can now use get_score_importances function from eli5.permutation_importance to get the final feature importances.", "We can see the top 5 features using:", "Feature engineering and feature selection are critical parts of any machine learning pipeline.", "We strive for accuracy in our models, and one cannot get to a good accuracy without revisiting these pieces again and again.", "In this post, I tried to explain Permutation importance as a feature selection method. It helps us find feature importance for any BlackBox model, unlike the techniques in my previous post on feature selection.", "If you want to learn more about feature engineering/selection, I would like to call out the How to Win a Data Science Competition: Learn from Top Kagglers course in the Advanced machine learning specialization by Kazanova. This course talks about a lot of intuitive ways to improve your model using useful feature engineering/selection techniques. Definitely recommended.", "Thanks for the read. I am going to be writing more beginner-friendly posts in the future too. Follow me up at Medium or Subscribe to my blog to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter @mlwhiz.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc418b694659d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c418b694659d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c418b694659d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----c418b694659d--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----c418b694659d--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----c418b694659d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc418b694659d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc418b694659d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/DavidRockDesign-2595351/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1430105", "anchor_text": "DavidRockDesign"}, {"url": "https://towardsdatascience.com/tagged/ds-algorithms", "anchor_text": "DS Algorithm series"}, {"url": "https://towardsdatascience.com/the-5-feature-selection-algorithms-every-data-scientist-need-to-know-3a6b566efd2", "anchor_text": "The 5 Feature Selection Algorithms every Data Scientist should know"}, {"url": "https://www.kaggle.com/dansbecker/permutation-importance", "anchor_text": "Source"}, {"url": "https://www.kaggle.com/mlwhiz/permutation-feature-selection-using-football-data", "anchor_text": "Kaggle Kernel"}, {"url": "https://towardsdatascience.com/the-hitchhikers-guide-to-feature-extraction-b4c157e96631", "anchor_text": "Feature engineering"}, {"url": "https://towardsdatascience.com/the-5-feature-selection-algorithms-every-data-scientist-need-to-know-3a6b566efd2", "anchor_text": "post"}, {"url": "https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0", "anchor_text": "How to Win a Data Science Competition: Learn from Top Kagglers"}, {"url": "https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0", "anchor_text": "Advanced machine learning specialization"}, {"url": "https://medium.com/@rahul_agarwal?source=post_page---------------------------", "anchor_text": "Medium"}, {"url": "http://eepurl.com/dbQnuX?source=post_page---------------------------", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz?source=post_page---------------------------", "anchor_text": "@mlwhiz"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c418b694659d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c418b694659d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----c418b694659d---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c418b694659d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----c418b694659d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc418b694659d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----c418b694659d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc418b694659d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----c418b694659d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc418b694659d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c418b694659d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc418b694659d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c418b694659d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c418b694659d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c418b694659d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c418b694659d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c418b694659d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c418b694659d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c418b694659d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c418b694659d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c418b694659d--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-find-feature-importances-for-blackbox-models-c418b694659d&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}