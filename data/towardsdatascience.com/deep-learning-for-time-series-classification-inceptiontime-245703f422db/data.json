{"url": "https://towardsdatascience.com/deep-learning-for-time-series-classification-inceptiontime-245703f422db", "time": 1683003119.576798, "path": "towardsdatascience.com/deep-learning-for-time-series-classification-inceptiontime-245703f422db/", "webpage": {"metadata": {"title": "Deep Learning for Time Series Classification (InceptionTime) | by Vasilis Stylianou, PhD | Towards Data Science", "h1": "Deep Learning for Time Series Classification (InceptionTime)", "description": "Time series data have always been of major interest to financial services, and now with the rise of real-time applications, other areas such as retail and programmatic advertising are turning their\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1809.04356", "anchor_text": "2", "paragraph_index": 1}, {"url": "https://arxiv.org/pdf/1602.01711.pdf", "anchor_text": "3", "paragraph_index": 6}, {"url": "https://core.ac.uk/download/pdf/77027925.pdf", "anchor_text": "4", "paragraph_index": 12}, {"url": "https://www.cs.ucr.edu/~eamonn/time_series_data/", "anchor_text": "5", "paragraph_index": 12}, {"url": "https://arxiv.org/abs/1909.04939", "anchor_text": "6", "paragraph_index": 12}, {"url": "https://arxiv.org/pdf/1409.4842.pdf", "anchor_text": "7", "paragraph_index": 20}, {"url": "https://arxiv.org/abs/1909.04939", "anchor_text": "6", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1903.06602", "anchor_text": "8", "paragraph_index": 23}, {"url": "https://github.com/hfawaz/InceptionTime", "anchor_text": "Github", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1909.04939", "anchor_text": "6", "paragraph_index": 27}, {"url": "https://apps.dtic.mil/docs/citations/ADA164453", "anchor_text": "1", "paragraph_index": 29}, {"url": "https://arxiv.org/abs/1809.04356", "anchor_text": "2", "paragraph_index": 30}, {"url": "https://arxiv.org/pdf/1602.01711.pdf", "anchor_text": "3", "paragraph_index": 31}, {"url": "https://core.ac.uk/download/pdf/77027925.pdf", "anchor_text": "4", "paragraph_index": 32}, {"url": "https://www.cs.ucr.edu/~eamonn/time_series_data/", "anchor_text": "5", "paragraph_index": 33}, {"url": "https://arxiv.org/abs/1909.04939", "anchor_text": "6", "paragraph_index": 34}, {"url": "https://arxiv.org/pdf/1409.4842.pdf", "anchor_text": "7", "paragraph_index": 35}, {"url": "https://arxiv.org/abs/1903.06602", "anchor_text": "8", "paragraph_index": 36}], "all_paragraphs": ["Time series data have always been of major interest to financial services, and now with the rise of real-time applications, other areas such as retail and programmatic advertising are turning their attention to time-series data driven applications. In the last couple of years, several key players in cloud services, such as Apache Kafka and Apache Spark, have released new products for processing time series data. It is therefore of great interest to understand the role and potentials of Machine Learning (ML) in this rising field.", "In this article, I discuss the (very) recent discoveries on Time Series Classification (TSC) with Deep Learning, by following a series of publications from the authors of [2].", "TSC is the area of ML interested in learning how to assign labels to time series. To be more concrete, we are interested in training an ML model which when fed with a series of data points indexed in time order (e.g. the historical data of a financial asset), it outputs labels (e.g. the industry sector of the asset).", "More formally, let (X, y) be a training instance with T observations (X\u00b9, \u2026 ,X\u1d40)\u2261 X (the time series) and a discrete class variable y which takes k possible values (the labels). A dataset S is a set of n such training instances: S= { (X\u208d\u2081\u208e, y\u208d\u2081\u208e), \u2026 , (X\u208d n\u208e, y\u208d n\u208e)) }. The task of classifying time series data consists of learning a classifier on S in order to map from the space of possible inputs {X} to a probability distribution over the labels {y\u00b9, \u2026 , y\u1d4f}.", "It is always important to remind ourselves that DL is nothing but a set of tools for solving problems, and although DL can be very powerful, that doesn\u2019t mean that we should blindly apply DL techniques to every single problem out there. After all, training and tuning a neural network can be very time-consuming so it is always a good practice to test the performance of other ML models and then seek for any potential shortcomings.", "Oftentimes the nature of a problem is determined by the data itself; in our case, the way one chooses to process and classify a time series depends highly on the length and statistics of the data. That being said, let us run a quick dimensional analysis to estimate the complexity of our problem.", "Suppose that we wish to learn a one-nearest neighbor classifier for our TSC problem (which is pretty common in the literature). Now given a dataset of n time series of length T, we must compute some sort of a distance measure for \u207fC\u2082=n(n-1)/2 unique pairs. Moreover, in order to find the \u201coptimal distance\u201d between two time series X\u208d\u2081\u208e and X\u208d\u2082\u208e, we must compute the T\u00d7T point-wise distance matrix M\u02b2\u1d4f=(X\u208d\u2081\u208e \u02b2 -X\u208d\u2082\u208e\u1d4f)\u00b2 for every unique pair of training instances and then seek for the path which optimizes our objective function. As explained in [3], there are several optimization algorithms in the literature for this setup, and they all have complexity O(n\u00b2\u22c5 T\u1d9c) with c=3 or 4. Evidently, the length of the time series can really hurt the computational speed. However for certain types of data, this problem can be alleviated without digging into sophisticated machine learning models such as deep neural networks.", "In signal processing, a complex signal is analyzed by decomposing the signal into a series of \u201celementary\u201d signals, called Fourier modes. For instance, the square wave below can be approximated by three sinusoidal signals of distinct frequencies (f\u2081, f\u2082, f\u2083)=(\u03c9, 3\u03c9, 5\u03c9), for some constant angular frequency \u03c9.", "By taking the linear sum of these signals, we can reconstruct our original signal:", "Now consider a dataset within which any time series, originally represented by a series of T time-ordered data points, can also be represented by a weight vector in the space spanned by the three elementary frequency modes:", "Going from the \u201ctime\u201d representation to the \u201cfrequency\u201d representation of our time series data is called Fourier transformation, and though the Fourier space, in theory, is infinite-dimensional (rather than 3-dimensional), we can apply various approximation techniques to truncate the Fourier series down to finite dimensions. Most importantly, we can reduce the T-dimensional representation of our time series data, to a number of dimensions (in Fourier space) that makes our classification problem computationally trackable. Overall, we can apply Fourier transformation during the data pre-processing phase to convert the input time series into weight vectors, and thereafter proceed by building our classification model (e.g. a 1-nearest neighbors classifier). Working with such \u201cwell-behaved\u201d time series we can achieve high performance without the use of DL.", "Now the aforementioned processing method assumed that any input signal can be approximated by a Fourier series of elementary (harmonic) functions. However, a lot of real-world time-series data are so noisy (e.g. financial data) that do not admit such an elegant decomposition (or any sort of mathematical pre-processing). It is precisely for this type of data that DL comes to the rescue: letting the model learn how to process time series data on its own is a more promising solution when dealing with unstructured noisy data.", "As of today, there are two state-of-the-art DL models for TSC. The oldest model, called HIVE-COTE [4], is based on the nearest neighbor algorithm coupled with the Dynamic Time Warping similarity measure. Although this algorithm has achieved an outstanding performance on the benchmark datasets [5], it suffers from O(n \u00b2\u22c5 T \u2074)time complexity. Recently the authors of [6], introduced a deep Convolutional Neural Network (CNN), called InceptionTime, which not only outperforms the accuracy of HIVE-COTE but it is also substantially faster. InceptionTime\u2019s high accuracy together with its scalability renders it the perfect candidate for product development!", "To this end, let us present the most important components of InceptionTime and how these are implemented in Keras.", "In general, each data observation X\u02b2 (j=1, \u2026 ,T) of a time series X can be a list of one or more data measurements, i.e. X\u02b2 = ( X\u2081\u02b2, \u2026 ,X_m \u02b2 ) for m data measurements, all taken at the jth time instance. For example, the velocity of a particle moving in 3D space consists of three spatial components: V=(V\u2081, V\u2082, V\u2083). Keeping track of the velocity of the particle for T seconds, with one observation per second, amounts to collecting the series of data: (V\u00b9, \u2026 , V\u1d40 ).", "Definition 1: An m-dimensional Multivariate Time Series (MTS) X= (X\u00b9, \u2026 , X\u1d40) consists of T ordered elements X\u02b2 \u2208 \u211d\u1d50.", "Like in image classification problems, we can think of the input MTS as an array of shape (1, T, m), with m denoting the number of channels (the depth). In fact, it is convenient to suppress the width of the inputs and work directly with an input_shape = (T, m).", "The major building block of InceptionTime is the inception module, shown in the figure below:", "This consists of the following layers:", "All layers (excluding the concatenation layer) have stride 1 and \u201csame\u201d padding. In addition, all convolutional layers come with 32 filters.", "The network architecture of InceptionTime highly resembles to that of GoogleNet\u2019s [7]. In particular, the network consists of a series of Inception modules followed by a Global Average Pooling layer and a Dense layer with a softmax activation function.", "However, InceptionTime introduces an additional element within its network\u2019s layers: residual connections at every third inception module.", "3.4 InceptionTime: a neural network ensemble for TSC", "As explained in [6], it turns out that a single Inception network exhibits high variance in accuracy. This is probably because of the variability associated to the random weight initialization together with the stochastic optimization process itself. In order to overcome this instability, the proposed state-of-the-art InceptionTime model is actually an ensemble of 5 Inception networks, with each prediction given an even weight (see [8] for more on deep neural network ensembles for TSC). The full implementation of the model can be found on Github.", "As it was mentioned earlier, InceptionTime was primarily inspired by CNNs for computer vision problems, and we, therefore, expect our model to learn features in a similar fashion. For example, in image classification, the neurons in the bottom layers learn to identify low-level (local) features such as lines, while the neurons in higher layers learn to detect high-level (global) features such as shapes (e.g. eyes). Similarly, we expect the bottom-layer neurons of InceptionTime to capture the local structure of a time series such as lines and curves, and the top-layer neurons to identify various shape patterns such as \u201cvalleys\u201d and \u201chills\u201d.", "The region of the input signal that a neuron depends on is called the receptive field of that particular neuron. In object recognition, larger receptive fields are used to capture more context. It is therefore natural to pick larger receptive fields when working with very long time series data so that our InceptionTime will learn to detect larger patterns.", "An important aspect in TSC is the length of the time series as this can slow down training. Although there are various mathematical processing schemes that one can follow to tackle such a problem, InceptionTime is the leading algorithm for TSC, especially for long noisy time series data.", "InceptionTime is an ensemble of CNNs which learns to identify local and global shape patterns within a time series dataset (i.e. low- and high-level features). Different experiments [6] have shown that InceptionTime\u2019s time complexity grows linearly with both the training set size and the time series length, i.e. O(n \u22c5 T)! Overall, InceptionTime has put TSC problems on the same footing with image classification problems, and it is therefore exciting to explore its different applications in the industry sector.", "In an upcoming post, I will discuss how I used InceptionTime to classify and cluster financial assets based on different attributes, such as industry sector/class, location and performance.", "[1] Learning Internal Representations by Error Propagation", "[2] Deep learning for time series classification: a review", "[3] The Great Time Series Classification Bake Off: An Experimental Evaluation of Recently Proposed Algorithms. Extended Version", "[4] HIVE-COTE: The Hierarchical Vote Collective of Transformation-based Ensembles for Time Series Classification", "[5] UCR Time Series Classification Archive", "[6] InceptionTime: Finding AlexNet for Time Series Classification", "[7] Going deeper with convolutions (GoogleNet)", "[8] Deep Neural Network Ensembles for Time Series Classification", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | PhD in Theoretical Physics"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F245703f422db&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----245703f422db--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----245703f422db--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@stylianouvasilis?source=post_page-----245703f422db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stylianouvasilis?source=post_page-----245703f422db--------------------------------", "anchor_text": "Vasilis Stylianou, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb6147cb9dc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&user=Vasilis+Stylianou%2C+PhD&userId=cb6147cb9dc5&source=post_page-cb6147cb9dc5----245703f422db---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F245703f422db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F245703f422db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1809.04356", "anchor_text": "2"}, {"url": "https://arxiv.org/pdf/1602.01711.pdf", "anchor_text": "3"}, {"url": "https://core.ac.uk/download/pdf/77027925.pdf", "anchor_text": "4"}, {"url": "https://www.cs.ucr.edu/~eamonn/time_series_data/", "anchor_text": "5"}, {"url": "https://arxiv.org/abs/1909.04939", "anchor_text": "6"}, {"url": "https://arxiv.org/pdf/1409.4842.pdf", "anchor_text": "7"}, {"url": "https://arxiv.org/abs/1909.04939", "anchor_text": "6"}, {"url": "https://arxiv.org/abs/1903.06602", "anchor_text": "8"}, {"url": "https://github.com/hfawaz/InceptionTime", "anchor_text": "Github"}, {"url": "https://arxiv.org/abs/1909.04939", "anchor_text": "6"}, {"url": "https://apps.dtic.mil/docs/citations/ADA164453", "anchor_text": "1"}, {"url": "https://arxiv.org/abs/1809.04356", "anchor_text": "2"}, {"url": "https://arxiv.org/pdf/1602.01711.pdf", "anchor_text": "3"}, {"url": "https://core.ac.uk/download/pdf/77027925.pdf", "anchor_text": "4"}, {"url": "https://www.cs.ucr.edu/~eamonn/time_series_data/", "anchor_text": "5"}, {"url": "https://arxiv.org/abs/1909.04939", "anchor_text": "6"}, {"url": "https://arxiv.org/pdf/1409.4842.pdf", "anchor_text": "7"}, {"url": "https://arxiv.org/abs/1903.06602", "anchor_text": "8"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----245703f422db---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----245703f422db---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/time-series-data?source=post_page-----245703f422db---------------time_series_data-----------------", "anchor_text": "Time Series Data"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----245703f422db---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/classification?source=post_page-----245703f422db---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F245703f422db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&user=Vasilis+Stylianou%2C+PhD&userId=cb6147cb9dc5&source=-----245703f422db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F245703f422db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&user=Vasilis+Stylianou%2C+PhD&userId=cb6147cb9dc5&source=-----245703f422db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F245703f422db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----245703f422db--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F245703f422db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----245703f422db---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----245703f422db--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----245703f422db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----245703f422db--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----245703f422db--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----245703f422db--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----245703f422db--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----245703f422db--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----245703f422db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stylianouvasilis?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@stylianouvasilis?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vasilis Stylianou, PhD"}, {"url": "https://medium.com/@stylianouvasilis/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "188 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb6147cb9dc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&user=Vasilis+Stylianou%2C+PhD&userId=cb6147cb9dc5&source=post_page-cb6147cb9dc5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fde7268b65c0f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-time-series-classification-inceptiontime-245703f422db&newsletterV3=cb6147cb9dc5&newsletterV3Id=de7268b65c0f&user=Vasilis+Stylianou%2C+PhD&userId=cb6147cb9dc5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}