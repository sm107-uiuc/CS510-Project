{"url": "https://towardsdatascience.com/domain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564", "time": 1683014468.320251, "path": "towardsdatascience.com/domain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564/", "webpage": {"metadata": {"title": "What deep learning needs for better COVID-19 detection | by YANG Xiaozhou | Towards Data Science", "h1": "What deep learning needs for better COVID-19 detection", "description": "By now, you\u2019ve probably seen a few, if not many, articles on how deep learning could help detect COVID-19. In particular, convolutional neural networks (CNNs) have been studied as a faster and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scholar.google.com/scholar?hl=en&as_sdt=0%2C5&q=detecting+covid-19+using+neural+network&btnG=", "anchor_text": "articles", "paragraph_index": 0}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7227176/", "anchor_text": "specific", "paragraph_index": 1}, {"url": "https://www.linkedin.com/in/yuchen-shi-2830ba158/?originalSubdomain=sg", "anchor_text": "Yuchen", "paragraph_index": 2}, {"url": "https://www.eng.nus.edu.sg/isem/staff/chen-nan/", "anchor_text": "A/P Chen", "paragraph_index": 2}, {"url": "https://connect.informs.org/HigherLogic/System/DownloadDocumentFile.ashx?DocumentFileKey=f404f7b8-fcd6-75d5-f7a7-d262eab132e7", "anchor_text": "Challenge", "paragraph_index": 2}, {"url": "https://github.com/YangXiaozhou/CNN-COVID-19-classification-using-chest-CT-scan", "anchor_text": "repo", "paragraph_index": 3}, {"url": "https://covid19.who.int/", "anchor_text": "WHO", "paragraph_index": 4}, {"url": "https://github.com/UCSD-AI4H/COVID-CT", "anchor_text": "data set", "paragraph_index": 7}, {"url": "https://cs231n.github.io/transfer-learning/", "anchor_text": "transfer learning", "paragraph_index": 14}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/applications/EfficientNetB0", "anchor_text": "EfficientNetB0", "paragraph_index": 14}, {"url": "https://arxiv.org/abs/1905.11946", "anchor_text": "EfficientNets", "paragraph_index": 14}, {"url": "https://www.kaggle.com/plameneduardo/sarscov2-ctscan-dataset", "anchor_text": "set", "paragraph_index": 18}, {"url": "https://www.tensorflow.org/guide/keras/transfer_learning#the_typical_transfer-learning_workflow", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://github.com/YangXiaozhou/CNN-COVID-19-classification-using-chest-CT-scan/blob/master/notebooks/2-COVID-19-classification-based-on-CT-scan.ipynb", "anchor_text": "notebook", "paragraph_index": 27}, {"url": "http://yangxiaozhou.github.io/", "anchor_text": "http://yangxiaozhou.github.io/", "paragraph_index": 33}], "all_paragraphs": ["By now, you\u2019ve probably seen a few, if not many, articles on how deep learning could help detect COVID-19. In particular, convolutional neural networks (CNNs) have been studied as a faster and cheaper alternative to the gold-standard PCR test by just analyzing the patient\u2019s computed tomography (CT) scan. It\u2019s not surprising since CNN is excellent at image recognition; many places have CT scanners rather than COVID-19 testing kits (at least initially).", "Despite its success in image recognition tasks such as the ImageNet challenge, can CNN really help doctors detect COVID-19? If it can, how accurately can it do so? It\u2019s well known that CT scans are sensitive but not specific to COVID-19. That is, COVID-19 almost always produces abnormal lung patterns visible from CT scans. However, other pneumonia can create the same abnormal patterns. Can the powerful and sometimes magical CNN tackle this ambiguity issue?", "We had a chance to answer these questions ourselves (with my colleague Yuchen and advisor A/P Chen). I\u2019ll walk you through a COVID-19 classifier that we\u2019ve built as an entry to 2020 INFORMS QSR Data Challenge. If you are not familiar with CNN or would like a refresher on the key features of CNNs, I highly recommend reading this article first:", "Also, if you\u2019d like to get hands-on, you can get all the code and data from this Github repo.", "COVID-19 pandemic has changed lives around the world. This is the current situation as of 2020/09/26, according to WHO.", "CT scans have been used to screen and diagnose COVID-19, especially in areas where swab test resources are severely lacking. The goal of this data challenge is to diagnose COVID-19 using chest CT scans. Therefore, we need to build a classification model that can classify patients to COVID or NonCOVID based on their chest CT scans, as accurately as possible.", "Relatively even number of COVID and NonCOVID images are provided to train the model. The competition also requires that the model\u2019s training with provided data must take less than one hour.", "All challenge data are taken from a public data set.", "Let\u2019s first take a look at the result, shall we?", "The trained model is evaluated with an independent set of test data. Here you can see the confusion matrix. The overall accuracy is about 85% with slightly better sensitivity than specificity, i.e., true positive rate > true negative rate.", "It\u2019s important to note that the challenge is to distinguish between COVID and NonCOVID CT scans, rather than COVID and Normal scans. In fact, there may be some NonCOVID CT scans that belong to other pneumonia patients (the specificity issue). Here\u2019s an example of what COVID and other pneumonia CT scan may look like:", "We reserve 20% of the data for validation. Since some consecutive images come from the same patient, they tend to be similar to each other. That is, many of our data are not independent. To prevent data leakage (information of training data spills over to validation data), we keep the original image sequence and use the last 20% as the validation set. After the splitting, we have two pairs of data:", "X is a list of CT scans, and y is a list of binary labels (0 for NonCOVID, 1 for COVID).", "Data augmentation is a common way to include more random variations in the training data. It helps to prevent overfitting. For image-related learning problems, augmentation typically means applying random geometric (e.g., crop, flip, rotate, etc.) and appearance transformation (e.g., contrast, edge filter, Gaussian blur, etc.). We use tf.keras.Sequential to create a pipeline in which the input image is randomly transformed through the following operations:", "We do not build a CNN from scratch. For an image-related problem with only a modest number of training images, it is recommended to use a pre-trained model as the backbone and do transfer learning on that. The chosen model is EfficientNetB0. It belongs to the family of models called EfficientNets proposed by researchers from Google. EfficientNets are among the current state-of-the-art CNNs for computer vision tasks. They", "EfficientNets, and other well-known pre-trained models, can be easily loaded from tf.keras.applications. We first import the pre-trained EfficientNetB0 and use it as our model backbone. We remove the original output layer of EfficientNetB0 since it was trained for 1000-class classification. Also, we freeze the model's weights so that they won't be updated during the initial training.", "With EfficientNet imported, we can use it to our problem by wrapping our classification model around it. You can think of the EfficientNetB0 as a trained feature extractor. The final model has:", "We can also use tf.keras.utils.plot_model to visualize our model.", "Public data pre-training: To help EfficientNetB0 adapt to COVID vs NonCOVID image classification, we\u2019ve actually trained our model on another public CT scan data set. The hope is that training the model on CT scans would allow it to learn features specific to our COVID-19 classification task. We will not go into the public data training part, but the procedure is essentially the same as what I will show below.", "Transfer learning workflow: We use a typical transfer-learning workflow:", "You can read more about the workflow here.", "Key configurations: We use the following metrics and loss function:", "2. Loss function: to guide gradient search", "We use the Adam optimizer, the learning rates is set to [1e-3, 1e-4] and the number of training epochs is set to [10, 30] for the two phases, respectively. The two-phase training is iterated for two times.", "Training history: Let\u2019s visualize the training history:", "Here you can see that after we\u2019ve allowed some layers of EfficientNets to update (after Epoch 10), we obtain a significant improvement in classification accuracy. The final training and validation accuracy is around 98% and 82%.", "We can obtain a set of test data from the same data repo that contains 105 NonCOVID and 98 COVID images. Let\u2019s see how the trained model performs on them. Here\u2019s a breakdown of the result on test data using sklearn.metrics.classification_report :", "We can dive into the classification result and see which ones are identified correctly and identified incorrectly. Potential patterns found could be leveraged to help further improve the model. See the images in this jupyter notebook. From those images, we see that:", "The point is, to a non-medical person like me, many of the COVID and NonCOVID images look the same. The ambiguity is even more severe when some images have unclear lung boundaries. It seems like our CNN is also having trouble distinguishing those images.", "From the above results, we can see that a pre-trained CNN can be adapted to achieve a really strong baseline performance. However, there are clear limitations to what a deep learning model (or any other model) alone can achieve. In this case, computer vision researchers and medical experts need to collaborate in a meaningful way so that the end model is both computationally capable and medically reliable.", "There are several directions for which we could make the model better:", "That\u2019s it for our CNN COVID-19 CT scan classification! Thank you!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Run, cycle, dive, and blog at http://yangxiaozhou.github.io/. But mostly working on my research in data-driven critical infrastructure system resilience."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F56cdeefde564&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----56cdeefde564--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56cdeefde564--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@yangxiaozhou?source=post_page-----56cdeefde564--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yangxiaozhou?source=post_page-----56cdeefde564--------------------------------", "anchor_text": "YANG Xiaozhou"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22b8d9e0d922&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&user=YANG+Xiaozhou&userId=22b8d9e0d922&source=post_page-22b8d9e0d922----56cdeefde564---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56cdeefde564&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56cdeefde564&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/towards-data-science/data-science-in-the-real-world/home", "anchor_text": "Data Science in the Real World"}, {"url": "https://unsplash.com/@aboutiwe?utm_source=medium&utm_medium=referral", "anchor_text": "Irwan \uf8ff"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scholar.google.com/scholar?hl=en&as_sdt=0%2C5&q=detecting+covid-19+using+neural+network&btnG=", "anchor_text": "articles"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7227176/", "anchor_text": "specific"}, {"url": "https://www.linkedin.com/in/yuchen-shi-2830ba158/?originalSubdomain=sg", "anchor_text": "Yuchen"}, {"url": "https://www.eng.nus.edu.sg/isem/staff/chen-nan/", "anchor_text": "A/P Chen"}, {"url": "https://connect.informs.org/HigherLogic/System/DownloadDocumentFile.ashx?DocumentFileKey=f404f7b8-fcd6-75d5-f7a7-d262eab132e7", "anchor_text": "Challenge"}, {"url": "https://towardsdatascience.com/a-math-free-introduction-to-convolutional-neural-network-ff38fbc4fc76", "anchor_text": "Convolutional Neural Network: How is it different from the other networks?What\u2019s so unique about CNNs and what does convolution really do? This is a math-free introduction to the wonders of\u2026towardsdatascience.com"}, {"url": "https://github.com/YangXiaozhou/CNN-COVID-19-classification-using-chest-CT-scan", "anchor_text": "repo"}, {"url": "https://covid19.who.int/", "anchor_text": "WHO"}, {"url": "https://github.com/UCSD-AI4H/COVID-CT", "anchor_text": "data set"}, {"url": "https://creativecommons.org/licenses/by/4.0", "anchor_text": "CC BY"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0", "anchor_text": "CC BY-SA"}, {"url": "https://cs231n.github.io/transfer-learning/", "anchor_text": "transfer learning"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/applications/EfficientNetB0", "anchor_text": "EfficientNetB0"}, {"url": "https://arxiv.org/abs/1905.11946", "anchor_text": "EfficientNets"}, {"url": "https://www.kaggle.com/plameneduardo/sarscov2-ctscan-dataset", "anchor_text": "set"}, {"url": "https://www.tensorflow.org/guide/keras/transfer_learning#the_typical_transfer-learning_workflow", "anchor_text": "here"}, {"url": "https://github.com/YangXiaozhou/CNN-COVID-19-classification-using-chest-CT-scan/blob/master/notebooks/2-COVID-19-classification-based-on-CT-scan.ipynb", "anchor_text": "notebook"}, {"url": "https://pubs.rsna.org/doi/full/10.1148/rg.2015140232", "anchor_text": "here"}, {"url": "https://ruder.io/multi-task/", "anchor_text": "learning"}, {"url": "https://en.wikipedia.org/wiki/Domain_adaptation#The_different_types_of_domain_adaptation", "anchor_text": "adaptation"}, {"url": "https://scikit-learn.org/stable/modules/ensemble.html", "anchor_text": "model"}, {"url": "https://yangxiaozhou.github.io/data/2020/09/27/detecting-covid19-using-cnn.html", "anchor_text": "https://yangxiaozhou.github.io"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----56cdeefde564---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----56cdeefde564---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----56cdeefde564---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/covid-19?source=post_page-----56cdeefde564---------------covid_19-----------------", "anchor_text": "Covid-19"}, {"url": "https://medium.com/tag/ds-in-the-real-world?source=post_page-----56cdeefde564---------------ds_in_the_real_world-----------------", "anchor_text": "Ds In The Real World"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56cdeefde564&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&user=YANG+Xiaozhou&userId=22b8d9e0d922&source=-----56cdeefde564---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56cdeefde564&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&user=YANG+Xiaozhou&userId=22b8d9e0d922&source=-----56cdeefde564---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56cdeefde564&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56cdeefde564--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F56cdeefde564&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----56cdeefde564---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----56cdeefde564--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----56cdeefde564--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----56cdeefde564--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----56cdeefde564--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----56cdeefde564--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----56cdeefde564--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----56cdeefde564--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----56cdeefde564--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yangxiaozhou?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yangxiaozhou?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "YANG Xiaozhou"}, {"url": "https://medium.com/@yangxiaozhou/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "128 Followers"}, {"url": "http://yangxiaozhou.github.io/", "anchor_text": "http://yangxiaozhou.github.io/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22b8d9e0d922&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&user=YANG+Xiaozhou&userId=22b8d9e0d922&source=post_page-22b8d9e0d922--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F49a94dd007ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdomain-expertise-what-deep-learning-needs-for-better-covid-19-detection-56cdeefde564&newsletterV3=22b8d9e0d922&newsletterV3Id=49a94dd007ca&user=YANG+Xiaozhou&userId=22b8d9e0d922&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}