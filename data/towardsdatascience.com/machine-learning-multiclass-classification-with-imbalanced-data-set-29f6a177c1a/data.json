{"url": "https://towardsdatascience.com/machine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a", "time": 1682994338.1468081, "path": "towardsdatascience.com/machine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a/", "webpage": {"metadata": {"title": "Machine Learning \u2014 Multiclass Classification with Imbalanced Dataset | by Javaid Nabi | Towards Data Science", "h1": "Machine Learning \u2014 Multiclass Classification with Imbalanced Dataset", "description": "Classification problems having multiple classes with imbalanced dataset present a different challenge than a binary classification problem. The skewed distribution makes many conventional machine\u2026"}, "outgoing_paragraph_urls": [{"url": "http://qwone.com/~jason/20Newsgroups/", "anchor_text": "\u201c20 News groups\u201d", "paragraph_index": 1}, {"url": "https://scikit-learn.org/0.19/datasets/twenty_newsgroups.html", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/machine-learning-word-embedding-sentiment-classification-using-keras-b83c28087456", "anchor_text": "article", "paragraph_index": 5}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.over_sampling.SMOTE.html", "anchor_text": "imblearn", "paragraph_index": 15}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.utils.class_weight.compute_class_weight.html", "anchor_text": "scikit_learn", "paragraph_index": 20}, {"url": "http://qwone.com/~jason/20Newsgroups/", "anchor_text": "20 News groups", "paragraph_index": 24}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html", "anchor_text": "scikit-learn", "paragraph_index": 24}, {"url": "https://github.com/javaidnabi31/Multi-class-with-imbalanced-dataset-classification/blob/master/20-news-group-classification.ipynb", "anchor_text": "Github", "paragraph_index": 27}], "all_paragraphs": ["Classification problems having multiple classes with imbalanced dataset present a different challenge than a binary classification problem. The skewed distribution makes many conventional machine learning algorithms less effective, especially in predicting minority class examples. In order to do so, let us first understand the problem at hand and then discuss the ways to overcome those.", "The data set we will be using for this example is the famous \u201c20 News groups\u201d data set. The 20 Newsgroups data set is a collection of approximately 20,000 newsgroup documents, partitioned (nearly) evenly across 20 different newsgroups. The 20 newsgroups collection has become a popular data set for experiments in text applications of machine learning techniques, such as text classification and text clustering.", "scikit-learn provides the tools to pre-process the dataset, refer here for more details. The number of articles for each news group given below is roughly uniform.", "Removing some news articles from some groups to make the overall dataset imbalanced like below.", "Now our imbalanced dataset with 20 classes is ready for further analysis.", "As this is a classification problem, we will use the similar approach as described in my previous article for sentiment analysis. The only difference is here we are dealing with multiclass classification problem.", "The last layer in the model is Dense(num_labels, activation =\u2019softmax'),with num_labels=20 classes, \u2018softmax\u2019 is used instead of \u2018sigmoid\u2019 . The other change in the model is about changing the loss function to loss = \u2018categorical_crossentropy\u2019, which is suited for multi-class problems.", "Training the model with 20% validation set validation_split=20 and usingverbose=2, we see validation accuracy after each epoch. Just after 10 epochs we reach validation accuracy of 90%.", "This looks like a very good accuracy but is the model really doing well?", "How to measure model performance? Let us consider that we train our model on imbalanced data of earlier example of fruits and since data is heavily biased towards Class-1 (Oranges), the model over-fits on the Class-1 label and predicts it in most of the cases and we achieve an accuracy of 80% which seems very good at first but looking closely, it may never be able to classify apples or pears correctly. Now the question is if the accuracy, in this case, is not the right metric to choose then what metrics to use to measure the performance of the model?", "With imbalanced classes, it\u2019s easy to get a high accuracy without actually making useful predictions. So, accuracy as an evaluation metrics makes sense only if the class labels are uniformly distributed. In case of imbalanced classes confusion-matrix is good technique to summarizing the performance of a classification algorithm.", "Confusion Matrix is a performance measurement for a classification algorithm where output can be two or more classes.", "When we closely look at the confusion matrix, we see that the classes [alt.athiesm, talk.politics.misc, soc.religion.christian] which have very less samples [65,53, 86] respectively are indeed having very less scores [0.42, 0.56, 0.65] as compared to the classes with higher number of samples like [rec.sport.hockey, rec.motorcycles]. Thus looking at the confusion matrix one can clearly see how the model is performing on classifying various classes.", "There are various techniques involved in improving the performance of imbalanced datasets.", "To make our dataset balanced there are two ways to do so:", "SMOTE is an over-sampling method. It creates synthetic samples of the minority class. We use imblearn python package to over-sample the minority classes .", "we have 4197 samples before and 4646 samples after applying SMOTE, looks like SMOTE has increased the samples of minority classes. We will check the performance of the model with the new dataset.", "Improved validation accuracy from 90 to 94%. Let us test the model:", "Little improvement in test accuracy than before (from 87 to 88%). Let us have a look at the confusion matrix now.", "We see that the classes [alt.athiesm, talk.politics.misc, sci.electronics, soc.religion.christian] having improved scores [0.76, 0.58, 0.75, 0.72] than before.Thus the model is performing better than before while classifying the classes even though accuracy is similar.", "Since classes are imbalanced, what about providing some bias to minority classes ? We can estimate class weights in scikit_learn by using compute_class_weight and use the parameter \u2018class_weight\u2019, while training the model. This can help to provide some bias towards the minority classes while training the model and thus help in improving performance of the model while classifying various classes.", "Precision-Recall is a useful measure of success of prediction when the classes are very imbalanced. Precision is a measure of the ability of a classification model to identify only the relevant data points, while recall is a measure of the ability of a model to find all the relevant cases within a dataset.", "The precision-recall curve shows the trade-off between precision and recall for different threshold. A high area under the curve represents both high recall and high precision, where high precision relates to a low false positive rate, and high recall relates to a low false negative rate.", "High scores for both precision and recall show that the classifier is returning accurate results (precision), as well as returning a majority of all positive results (recall). An ideal system with high precision and high recall will return many results, with all results labeled correctly.", "Below is a precision-recall plot for 20 News groups dataset using scikit-learn.", "We would like to have the area of P-R curve for each class to be close to 1. Except classes 0 , 3 & 18 rest of the classes are having area above .75. You can try with different classification models and hyper-parameter tuning techniques to improve the result further.", "We discussed the problems associated with classification of multi classes in an imbalanced dataset. We also demonstrated how using the right tools and techniques help us in developing better classification models.", "Thanks for reading. The code can be found on Github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F29f6a177c1a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@javaid.nabi?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@javaid.nabi?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": "Javaid Nabi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F70c04bf6660e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&user=Javaid+Nabi&userId=70c04bf6660e&source=post_page-70c04bf6660e----29f6a177c1a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29f6a177c1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29f6a177c1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/1CsaVdwfIew", "anchor_text": "Unsplash"}, {"url": "http://qwone.com/~jason/20Newsgroups/", "anchor_text": "\u201c20 News groups\u201d"}, {"url": "https://scikit-learn.org/0.19/datasets/twenty_newsgroups.html", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/machine-learning-word-embedding-sentiment-classification-using-keras-b83c28087456", "anchor_text": "article"}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.over_sampling.SMOTE.html", "anchor_text": "imblearn"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.utils.class_weight.compute_class_weight.html", "anchor_text": "scikit_learn"}, {"url": "http://qwone.com/~jason/20Newsgroups/", "anchor_text": "20 News groups"}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html", "anchor_text": "scikit-learn"}, {"url": "https://github.com/javaidnabi31/Multi-class-with-imbalanced-dataset-classification/blob/master/20-news-group-classification.ipynb", "anchor_text": "Github"}, {"url": "https://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/", "anchor_text": "8 Tactics to Combat Imbalanced Classes in Your Machine Learning DatasetHas this happened to you? You are working on your dataset. You create a classification model and get 90% accuracy\u2026machinelearningmastery.com"}, {"url": "https://www.analyticsvidhya.com/blog/2017/03/imbalanced-classification-problem/", "anchor_text": "How to handle Imbalanced Classification Problems in machine learning?Introduction If you have spent some time in machine learning and data science, you would have definitely come across\u2026www.analyticsvidhya.com"}, {"url": "https://towardsdatascience.com/working-with-highly-imbalanced-datasets-in-machine-learning-projects-c70c5f2a7b16", "anchor_text": "Three techniques to improve machine learning model performance with imbalance datasetsThis project was part of my recent job interview skill test for a \u201cMachine learning engineer\u201d position. I had to\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62", "anchor_text": "Understanding Confusion MatrixWhen we get the data, after data cleaning, pre-processing and wrangling, the first step we do is to feed it to an\u2026towardsdatascience.com"}, {"url": "https://www.opencodez.com/python/text-classification-using-keras.htm", "anchor_text": "Simple Text Classification using Keras Deep Learning Python Library \u2014 opencodezDeep Learning is everywhere. All organizations big or small, trying to leverage the technology and invent some cool\u2026www.opencodez.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----29f6a177c1a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----29f6a177c1a---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/classifcation-models?source=post_page-----29f6a177c1a---------------classifcation_models-----------------", "anchor_text": "Classifcation Models"}, {"url": "https://medium.com/tag/data-science?source=post_page-----29f6a177c1a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----29f6a177c1a---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29f6a177c1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&user=Javaid+Nabi&userId=70c04bf6660e&source=-----29f6a177c1a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29f6a177c1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&user=Javaid+Nabi&userId=70c04bf6660e&source=-----29f6a177c1a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29f6a177c1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F29f6a177c1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----29f6a177c1a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----29f6a177c1a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----29f6a177c1a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----29f6a177c1a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----29f6a177c1a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@javaid.nabi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@javaid.nabi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Javaid Nabi"}, {"url": "https://medium.com/@javaid.nabi/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F70c04bf6660e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&user=Javaid+Nabi&userId=70c04bf6660e&source=post_page-70c04bf6660e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F146b1e2d6450&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-multiclass-classification-with-imbalanced-data-set-29f6a177c1a&newsletterV3=70c04bf6660e&newsletterV3Id=146b1e2d6450&user=Javaid+Nabi&userId=70c04bf6660e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}