{"url": "https://towardsdatascience.com/everything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f", "time": 1682996457.937844, "path": "towardsdatascience.com/everything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f/", "webpage": {"metadata": {"title": "Preparing EHR & Tabular Data for Neural Networks | by Rachel Draelos, MD, PhD | Towards Data Science", "h1": "Preparing EHR & Tabular Data for Neural Networks", "description": "This post could also be called \u201ceverything I learned during the first year of my PhD while working with a massive electronic health record data set.\u201d Here, I\u2019ll overview the difference between\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/rachellea/glassboxmedicine/blob/master/2019-06-01-dataprocessing.py", "anchor_text": "rachellea/glassboxmedicine/2019\u201306\u201301-dataprocessing.py", "paragraph_index": 1}, {"url": "https://stattrek.com/statistics/dictionary.aspx?definition=categorical%20variable", "anchor_text": "categorical variable", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Fruit#/media/File:Culinary_fruits_front_view.jpg", "anchor_text": "fruit", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/London#/media/File:Palace_of_Westminster_from_the_dome_on_Methodist_Central_Hall.jpg", "anchor_text": "london", "paragraph_index": 3}, {"url": "https://commons.wikimedia.org/wiki/File:BeachDog2.jpg", "anchor_text": "beach dog", "paragraph_index": 3}, {"url": "https://bolt.mph.ufl.edu/6050-6052/preliminaries/types-of-variables/", "anchor_text": "nominal and ordinal variables", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Cabbage#/media/File:Chou_1.jpg", "anchor_text": "cabbage", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Coronary_artery_bypass_surgery", "anchor_text": "CABG", "paragraph_index": 7}, {"url": "https://bolt.mph.ufl.edu/6050-6052/preliminaries/types-of-variables/", "anchor_text": "Quantitative", "paragraph_index": 9}, {"url": "https://github.com/rachellea/glassboxmedicine/blob/master/2019-06-01-dataprocessing.py", "anchor_text": "the provided code", "paragraph_index": 22}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html", "anchor_text": "the pandas function get_dummies()", "paragraph_index": 22}, {"url": "https://github.com/rachellea/glassboxmedicine/blob/master/2019-06-01-dataprocessing.py", "anchor_text": "the provided code", "paragraph_index": 29}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html", "anchor_text": "StandardScaler", "paragraph_index": 29}, {"url": "https://github.com/rachellea/glassboxmedicine/blob/master/2019-06-01-dataprocessing.py", "anchor_text": "the provided code", "paragraph_index": 33}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html", "anchor_text": "the pandas function fillna()", "paragraph_index": 33}, {"url": "https://commons.wikimedia.org/wiki/File:BeachDog2.jpg", "anchor_text": "a Samoyed dog", "paragraph_index": 34}, {"url": "https://en.wikipedia.org/wiki/Samoyed_dog", "anchor_text": "Fun facts about Samoyeds", "paragraph_index": 34}, {"url": "https://glassboxmedicine.com/2019/06/01/everything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included/", "anchor_text": "http://glassboxmedicine.com", "paragraph_index": 35}], "all_paragraphs": ["This post could also be called \u201ceverything I learned during the first year of my PhD while working with a massive electronic health record data set.\u201d Here, I\u2019ll overview the difference between categorical and quantitative variables, and I\u2019ll explain how to prepare tabular data for a neural network model, including:", "Best of all, broadly-applicable code is provided to do all of the above on your tabular data! You can download the code for this tutorial on GitHub: rachellea/glassboxmedicine/2019\u201306\u201301-dataprocessing.py.", "A categorical variable is a variable that takes on different category names. Here are some examples of categorical variables:", "Image credits: fruit, london, beach dog", "Categorical variables are further subdivided into nominal and ordinal variables:", "Here are some example nominal variables (no natural ordering) in medical data sets, along with some example values:", "*Side note: CABG stands for \u201ccoronary artery bypass graft\u201d which is a type of open-heart surgery. Doctors pronounce this abbreviation \u201ccabbage\u201d (seriously).", "cabbage, not to be confused with CABG", "Here are some examples of ordinal variables (inherently ordered) in medical data sets:", "Quantitative variables have numerical values that usually represent the result of a measurement. There are two kinds of quantitative variables:", "If your variable is the NAME of a laboratory test, then that\u2019s a nominal (categorical) variable because the values it can take on are different names of different lab tests, e.g. \u201cComplete Blood Count,\u201d \u201cBasic Metabolic Panel,\u201d \u201cComplete Metabolic Panel.\u201d", "If your variable is the RESULT of a laboratory test, it could be:", "In machine learning, categorical variables are typically represented as \u201cone-hot vectors.\u201d A one-hot vector is a vector where all the entries are zero except for one, i.e. only one element is \u201chot\u201d (nonzero). Here are some one-hot vectors:", "What\u2019s cool about one-hot vectors is that they allow you to represent your categorical variables without assuming any particular relationship between them.", "Let\u2019s say you wanted to represent the categorical variable \u201canimal\u201d which takes on values dog, cat, and fish.", "If you had 20 different animals you wanted to represent, that\u2019s no problem: just use one-hot vectors of length 20. The resulting 20 different one-hot vectors are STILL perpendicular to each other, in a 20-dimensional space (which, you will be gratified to know, I will not attempt to sketch):", "In general, the length of the one-hot vector you need is equal to the number of different possible values your categorical variable can take on. If it can take on 5 values, the one-hot vector should be length 5. If it can take on 1,298 values, the length of your one-hot vector should be 1,298.", "What if I have many categorical variables in my data set?", "Just make a different one-hot vector for each categorical variable. Let\u2019s say you took a survey and asked 3 people for their favorite animal, location, and fruit. In the end, your data set of survey responses includes the categorical variables \u201canimal\u201d (3 possible values), \u201clocation\u201d (4 possible values), and \u201cfruit\u201d (2 possible values). Thus, you should:", "What if my categorical variable can take on multiple values at the same time?", "What if in the previous survey you gave people the option of choosing multiple animal(s), location(s), or fruit(s)? You can use a \u201cmulti-hot vector\u201d which is exactly the same as a one-hot vector except more than one entry can be equal to 1. Here\u2019s an example (modified from the previous example; the additional entries are highlighted in yellow):", "Categorical variables that can take on more than one value like this are common in medicine. For example, diagnoses, procedures, and medications extracted from a patient\u2019s medical record over ten years are likely to take on more than one value. Many patients will have several past diagnoses, several past procedures, and several past medications. Thus, you will need a multi-hot vector for diagnoses, another multi-hot vector for procedures, and another multi-hot vector for medications.", "Here\u2019s a snippet of the provided code that transforms each categorical variable into a one-hot or multi-hot vector as appropriate, using the pandas function get_dummies():", "Now we are going to switch gears and talk about representing quantitative variables. It seems like you could just throw these variables straight into the model without any extra work, because they\u2019re already numbers. However, if you\u2019re building a neural network model, you don\u2019t want to feed in raw quantitative variables because they will likely have very different scales, and giving a neural networks numbers of different scales will make it sad (i.e. it will be more difficult for the neural network to learn anything.)", "What I mean by \u201cdifferent scales\u201d is that some variables may take on small values (e.g. tumor diameter = 0.5 cm) and others variables may take on large values (e.g. weight = 350 pounds.) A neural network will train more effectively if you feed it only small, normalized values.", "Here\u2019s a common procedure for normalizing a quantitative variable before training a neural network:", "You must do this separately for each quantitative variable in your data set (e.g. separately for \u201ctumor diameter\u201d and \u201cweight\u201d), because each quantitative variable will have a different mean and a different standard deviation.", "The effect of performing the above steps is that all your quantitative variables will now be represented as small numbers centered on 0, which will make them good food for your neural network.", "Why do we calculate the mean and standard deviation using ONLY the training set? Why not use the entire data set? Answer: If we included the test set in our calculation of mean and standard deviation, we would be leaking information about the test set into our training data, which is cheating.", "Here\u2019s a snippet of the provided code that normalizes continuous variables, using StandardScaler from scikit-learn:", "Frequently, data values are missing. Perhaps a survey participant didn\u2019t answer all the questions or a patient received care in a different state and their diagnoses, procedures, and medications didn\u2019t make it in to their local medical record.", "If we read in a data file with missing values, these values will be \u201cNaNs\u201d, or \u201cnot a number.\u201d We have to replace them with a number in order to train. Filling in missing values is called \u201cimputation.\u201d", "There are different strategies for imputation. Here\u2019s one reasonable strategy:", "Here\u2019s a snippet of the provided code that performs imputation of missing values, using the pandas function fillna():", "The featured image is a Samoyed dog, which happens to be my all-time favorite kind of dog. This dog made a cameo appearance in the \u201cexample categorical variables\u201d table. Fun facts about Samoyeds:", "Originally published at http://glassboxmedicine.com on June 1, 2019.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a physician with a PhD in Computer Science. My research focuses on machine learning methods development for medical data. I am the CEO of Cydoc."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd1b6779b934f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rachel-draelos.medium.com/?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": ""}, {"url": "https://rachel-draelos.medium.com/?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": "Rachel Draelos, MD, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F209c0f742bcf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&user=Rachel+Draelos%2C+MD%2C+PhD&userId=209c0f742bcf&source=post_page-209c0f742bcf----d1b6779b934f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1b6779b934f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1b6779b934f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/rachellea/glassboxmedicine/blob/master/2019-06-01-dataprocessing.py", "anchor_text": "rachellea/glassboxmedicine/2019\u201306\u201301-dataprocessing.py"}, {"url": "https://stattrek.com/statistics/dictionary.aspx?definition=categorical%20variable", "anchor_text": "categorical variable"}, {"url": "https://en.wikipedia.org/wiki/Fruit#/media/File:Culinary_fruits_front_view.jpg", "anchor_text": "fruit"}, {"url": "https://en.wikipedia.org/wiki/London#/media/File:Palace_of_Westminster_from_the_dome_on_Methodist_Central_Hall.jpg", "anchor_text": "london"}, {"url": "https://commons.wikimedia.org/wiki/File:BeachDog2.jpg", "anchor_text": "beach dog"}, {"url": "https://bolt.mph.ufl.edu/6050-6052/preliminaries/types-of-variables/", "anchor_text": "nominal and ordinal variables"}, {"url": "https://grants.nih.gov/grants/guide/notice-files/not-od-15-089.html", "anchor_text": "race"}, {"url": "https://www.drugs.com/drug_information.html", "anchor_text": "medication"}, {"url": "https://en.wikipedia.org/wiki/Cabbage#/media/File:Chou_1.jpg", "anchor_text": "cabbage"}, {"url": "https://en.wikipedia.org/wiki/Coronary_artery_bypass_surgery", "anchor_text": "CABG"}, {"url": "https://bolt.mph.ufl.edu/6050-6052/preliminaries/types-of-variables/", "anchor_text": "Quantitative"}, {"url": "https://emedicine.medscape.com/article/2074001-overview", "anchor_text": "urinalysis"}, {"url": "https://github.com/rachellea/glassboxmedicine/blob/master/2019-06-01-dataprocessing.py", "anchor_text": "the provided code"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html", "anchor_text": "the pandas function get_dummies()"}, {"url": "https://github.com/rachellea/glassboxmedicine/blob/master/2019-06-01-dataprocessing.py", "anchor_text": "the provided code"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html", "anchor_text": "StandardScaler"}, {"url": "https://github.com/rachellea/glassboxmedicine/blob/master/2019-06-01-dataprocessing.py", "anchor_text": "the provided code"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html", "anchor_text": "the pandas function fillna()"}, {"url": "https://commons.wikimedia.org/wiki/File:BeachDog2.jpg", "anchor_text": "a Samoyed dog"}, {"url": "https://en.wikipedia.org/wiki/Samoyed_dog", "anchor_text": "Fun facts about Samoyeds"}, {"url": "https://glassboxmedicine.com/2019/06/01/everything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included/", "anchor_text": "http://glassboxmedicine.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d1b6779b934f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/medicine?source=post_page-----d1b6779b934f---------------medicine-----------------", "anchor_text": "Medicine"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----d1b6779b934f---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d1b6779b934f---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d1b6779b934f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1b6779b934f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&user=Rachel+Draelos%2C+MD%2C+PhD&userId=209c0f742bcf&source=-----d1b6779b934f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1b6779b934f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&user=Rachel+Draelos%2C+MD%2C+PhD&userId=209c0f742bcf&source=-----d1b6779b934f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1b6779b934f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd1b6779b934f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d1b6779b934f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d1b6779b934f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d1b6779b934f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d1b6779b934f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d1b6779b934f--------------------------------", "anchor_text": ""}, {"url": "https://rachel-draelos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rachel-draelos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rachel Draelos, MD, PhD"}, {"url": "https://rachel-draelos.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "576 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F209c0f742bcf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&user=Rachel+Draelos%2C+MD%2C+PhD&userId=209c0f742bcf&source=post_page-209c0f742bcf--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa0377bd1bf3d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-preparing-tabular-data-for-machine-learning-code-included-d1b6779b934f&newsletterV3=209c0f742bcf&newsletterV3Id=a0377bd1bf3d&user=Rachel+Draelos%2C+MD%2C+PhD&userId=209c0f742bcf&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}