{"url": "https://towardsdatascience.com/generating-mri-images-of-multiple-contrast-levels-89c3b6c00e68", "time": 1683002216.2441878, "path": "towardsdatascience.com/generating-mri-images-of-multiple-contrast-levels-89c3b6c00e68/", "webpage": {"metadata": {"title": "Generating MRI Images of Multi-Contrast | by Joey Mach | Towards Data Science", "h1": "Generating MRI Images of Multi-Contrast", "description": "While other things like technology are constantly innovating, we also have to significantly improve methods of disease diagnosis. By simply reducing false-negative and false-positive misdiagnosed\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwjsqKS-y8DmAhVJXK0KHYHrCK0QFjAAegQIBxAB&url=https%3A%2F%2Fca.linkedin.com%2Fin%2Fjoey-mach-6293b1175&usg=AOvVaw2zgAwIF5r8P-8rHkWc5B_A", "anchor_text": "LinkedIn", "paragraph_index": 54}, {"url": "https://landing.mailerlite.com/webforms/landing/j8c7g3", "anchor_text": "here", "paragraph_index": 54}], "all_paragraphs": ["Radiologist misdiagnose 40 million people worldwide each and every single year\ud83e\udd2f!", "While other things like technology are constantly innovating, we also have to significantly improve methods of disease diagnosis. By simply reducing false-negative and false-positive misdiagnosed cases, we can literally solve half of the healthcare problem.", "If better imaging tools and equipment existed to be able to spot diseased sites more accurately, this can potentially save millions of lives! Diseases like cancer in particular have significantly higher 5-year survival rates when diagnosed in early stages in comparison to later-stages, but rarely do any \u201csigns\u201d of disease goes detected during early stages, and this is a problem.", "Let\u2019s play a little game, where you can pretend to be the radiologist. Your job is to find abnormal regions in the following MRI image:", "Hint: There are two abnormal regions.", "All this would have been so much easier and you would have been so much more confident with your answer if I\u2019ve also given you this MRI scan:", "Notice that the two abnormal regions are much brighter and easier to spot in the above MRI scan.", "The two different MRI images shown above have different contrasts. In this scenario, the abnormal regions happen to indicate signs of a tumor, specifically this patient has multiple myeloma.", "There are two main types of MRI images, T1-weighted MRI and T2-weighted MRI images. Both types of MRI contrast different regions within the body.", "The first MRI image presented above is a T1-weighted MRI image \ud83d\udc46, while the second one presented is a T2-weighted MRI image.", "T1-weighted images specifically highlight fat tissue, while T2-weighted images highlight both fat and water within the body.", "Having both types of MRI scans can drastically enhance the accuracy of diagnosis by providing practitioners with a more comprehensive understanding.", "However, in practice, pathologists rarely have access to both types of MRI images for review and diagnosis purposes. This is because of a variety of reasons such as certain scan time limitations as well as other factors such as distorted contrast found in MRI images due to noise or artifacts.", "One of the ways to overcome these inefficiencies is to use a type of artificial intelligence technique called style transfer to synthesize MRI images of different contrast levels from existing MRI scans.", "Specifically, I leveraged an algorithm that can perform style transfer called Cycle Generative Adversarial Networks (CycleGAN) to synthesize T1-weighted MRI images from T2-weighted MRI images and vice versa.", "Style transfer is exactly what it sounds like! Let\u2019s break it down further by using a Elon Musk analogy \ud83d\ude0d.", "So here\u2019s Elon Musk in the 21st century:", "Elon Musk is pretty cool, but I\u2019ve always wondered what the good old Elon Musk would look like in the 16th century. Style transfer allowed to me satisfy my curiosity, and this is what it did to Elon Musk:", "That\u2019s a painting of Elon Musk in the 16th century \ud83d\udc46!", "This is a demonstration of style transfer turning a \u201cmodern\u201d day photo into a classical painting almost flawlessly. In particular, this is called image-to-image translation, the task of transferring images from one domain to another.", "\ud83d\udc34 I\u2019ve never seen a zebra galloping in the beautiful nature before, but now I have\u2026", "\u2600\ufe0f I really wish the magic of season transfer actually exists in real life and not just with images.", "\ud83c\udfa8 How about the 5 seasons of Mona Lisa? (I know, I know, you wanted to say there are only 4 seasons right, well I guess conventional is there to break.)", "\ud83d\udc30 The cutest hamster ever! (ps: I actually have no idea if that\u2019s a hamster or not, but it might as well be)", "Ok, I get the style transfer part, but what makes CycleGan suitable for the specific task of applying style transfer to MRI images?", "Style transfer isn\u2019t a really new concept, there has been tons and tons of work being done. But what makes CycleGAN an attractive model is that it doesn\u2019t require paired training data but is still able to synthesize \u201camazing\u201d quality style-transferred images.", "Paired data is data in which x1 corresponds to y1, x2 to y2, and etc. In terms of T1-weighted and T1- weighted MRI images, if the data is paired, this means that each T1-weighted MRI image and its corresponding T2-weighted MRI images come from the same patient.", "Unpaired data, on the other hand, is two sets of data in which x1 doesn\u2019t need to correspond to y1, x2 to y2, and etc.", "Previous machine learning methods for style-transfer works well and produces \u201cdecent\u201d results only under circumstances in which it is trained with paired data. However, large datasets of paired data is exceptionally rare.", "CycleGAN is useful because it can perform as exceptionally well as other style transfer methods but with unpaired data. Finding datasets are a pain, and if you\u2019ve done some work in machine learning, you know how much of a pain it is! It\u2019s even more of a pain if you want large datasets of paired data, and most of the time, for datasets like MRI images, public paired datasets don\u2019t even exist (or maybe, I\u2019m not digging enough \ud83d\ude05).", "This is what makes CycleGAN so useful, it can train just as well with unpaired data compared to paired data.", "Before we dive into CycleGAN, let\u2019s take a look at regular Generative Adversarial Networks (GANs).", "The magic of GANs involves two key components:", "Let\u2019s use an analogy to help us understand this more intuitively.", "Jessica is a specialist art detective and her responsibility is to detect counterfeit art.", "There are thousands and thousands of \u201cforgers\u201d out there in the art community producing \u201ccounterfeit\u201d art.", "Jessica and the forger are essentially competing in this Tom and Jerry race. For the purposes of training GANs to produce realistic images, the ultimate goal is to train the generator (\u201cthe forger\u201d) to become really good at fooling the discriminator (\u201cJessica\u201d).", "Both Jessica and the forger are very competitive, and they depend on each other to be better. As the discriminator gets better at detecting fake images synthesized by the generator from real images, this forces the generator to also become better at generating \u201crealistically\u201d looking images.", "A CycleGAN is more complicated than a regular GAN, but it involves similar components, like the generator and the discriminator. Don\u2019t worry, it\u2019s only slightly more complicated, well maybe\u2026", "Let\u2019s first take a look at the dataset, which includes 2 separate datasets. The two datasets I used to train my CycleGAN model consist of the following:", "The architecture of CycleGAN is kind of like a combination of 2 GANs, which consist of a total of 4 models (2 sets of 1 generator network + 1 discriminator network). Here\u2019s a breakdown of what each GAN is responsible for in a CycleGAN:", "GAN #1 is responsible for applying style transfer to T1-weighted MRI image (1st dataset) to synthetically generate its corresponding T2-weighted MRI image (2nd dataset).", "GAN #2 is responsible for applying style transfer to T2-weighted MRI image (2nd dataset) to synthetically generate its corresponding T1-weighted MRI image (1st dataset).", "Ok, but what exactly are the components of the generator and the discriminator?", "The architecture of the generator consists of an encoder-decoder network.", "There are three main types of components involved in the generator:", "1. Encoder \u2014 Consist of convolutional layers which decompresses the image into a vector which represents its compressed features.", "2. Transformer \u2014 Consist of residual neural networks (ResNet) which is responsible for interpreting the encoding.", "3. Decoder \u2014 Consist of de-convolutional layers (opposite of convolutional layers) which deconstructs the compact representation of the image back to its original size.", "The architecture of the decoder network is much simpler and consists of a convolutional neural network which performs image classification. As mentioned, the convolutional layers determine whether the image fed into the model is real [1] or fake [0].", "After training my model for only 2 epochs, it was able to synthesize \u201cclean-ish\u201d looking MRI images! However, I would recommend training such model for ~50 epochs, which can take up to a couple of days \ud83d\udcc6.", "This is one of the examples of a generated T2-weighted MRI image from a T1-weighted MRI image.", "This is another example of the model generating a T1-weighted MRI image of the corresponding T2-weighted MRI image.", "The implications of this technology are insane! CycleGAN can be leveraged to synthesize MRI images of any contrast levels! Moreover, it can even potentially be deployed accurately derive CT scans, PET scans, X-rays and etc. from MRI scans and vice versa!", "Before you leave, feel free to reach out to me if you have any inquiries and connect with me on LinkedIn! PS: I send out monthly newsletters and if you\u2019re interested in keeping up to date about what the16-year innovator/AI enthusiast is up to, feel free to subscribe here!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F89c3b6c00e68&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@joeym.mach?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joeym.mach?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": "Joey Mach"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F831a4b5b46b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&user=Joey+Mach&userId=831a4b5b46b9&source=post_page-831a4b5b46b9----89c3b6c00e68---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89c3b6c00e68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89c3b6c00e68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.radiologymasterclass.co.uk/tutorials/mri/t1_and_t2_images#top_3rd_img", "anchor_text": "Source"}, {"url": "https://www.radiologymasterclass.co.uk/tutorials/mri/t1_and_t2_images#top_3rd_img", "anchor_text": "Source"}, {"url": "https://www.radiologymasterclass.co.uk/tutorials/mri/t1_and_t2_images#top_3rd_img", "anchor_text": "Source"}, {"url": "https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwjsqKS-y8DmAhVJXK0KHYHrCK0QFjAAegQIBxAB&url=https%3A%2F%2Fca.linkedin.com%2Fin%2Fjoey-mach-6293b1175&usg=AOvVaw2zgAwIF5r8P-8rHkWc5B_A", "anchor_text": "LinkedIn"}, {"url": "https://landing.mailerlite.com/webforms/landing/j8c7g3", "anchor_text": "here"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----89c3b6c00e68---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----89c3b6c00e68---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mri?source=post_page-----89c3b6c00e68---------------mri-----------------", "anchor_text": "Mri"}, {"url": "https://medium.com/tag/generative-adversarial?source=post_page-----89c3b6c00e68---------------generative_adversarial-----------------", "anchor_text": "Generative Adversarial"}, {"url": "https://medium.com/tag/cyclegan?source=post_page-----89c3b6c00e68---------------cyclegan-----------------", "anchor_text": "Cyclegan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89c3b6c00e68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&user=Joey+Mach&userId=831a4b5b46b9&source=-----89c3b6c00e68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89c3b6c00e68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&user=Joey+Mach&userId=831a4b5b46b9&source=-----89c3b6c00e68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89c3b6c00e68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F89c3b6c00e68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----89c3b6c00e68---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----89c3b6c00e68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joeym.mach?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@joeym.mach?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Joey Mach"}, {"url": "https://medium.com/@joeym.mach/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "172 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F831a4b5b46b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&user=Joey+Mach&userId=831a4b5b46b9&source=post_page-831a4b5b46b9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5065d4dcf64f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-mri-images-of-multiple-contrast-levels-89c3b6c00e68&newsletterV3=831a4b5b46b9&newsletterV3Id=5065d4dcf64f&user=Joey+Mach&userId=831a4b5b46b9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}