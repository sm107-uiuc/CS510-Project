{"url": "https://towardsdatascience.com/plant-disease-detection-web-application-using-fastai-b0c389b82371", "time": 1682997677.788126, "path": "towardsdatascience.com/plant-disease-detection-web-application-using-fastai-b0c389b82371/", "webpage": {"metadata": {"title": "Plant Disease Detection Web Application using Fastai | by Shubham Kumar | Towards Data Science", "h1": "Plant Disease Detection Web Application using Fastai", "description": "Creating an AI web application that detects diseases in plants using FastAi which built on the top of Facebook\u2019s deep learning platform: PyTorch. According to the Food and Agriculture Organization of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://plantvillage.psu.edu/", "anchor_text": "PlanVillage", "paragraph_index": 1}, {"url": "https://course.fast.ai/start_gcp.html", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://plantvillage.org/", "anchor_text": "PlantVillage", "paragraph_index": 3}, {"url": "http://dags.stanford.edu/projects/scenedataset.html", "anchor_text": "DAGS", "paragraph_index": 3}, {"url": "https://ipython.readthedocs.io/en/stable/interactive/magics.html", "anchor_text": "Line Magics", "paragraph_index": 6}, {"url": "https://docs.fast.ai/vision.data#ImageDataBunch.from_folder", "anchor_text": "ImageDataBunch.from_folder", "paragraph_index": 11}, {"url": "https://docs.fast.ai/", "anchor_text": "awesome documentation", "paragraph_index": 11}, {"url": "https://arxiv.org/abs/1506.01186", "anchor_text": "Learning Rate", "paragraph_index": 20}, {"url": "https://rb.gy/ydggvu", "anchor_text": "https://rb.gy/ydggvu", "paragraph_index": 29}], "all_paragraphs": ["Creating an AI web application that detects diseases in plants using FastAi which built on the top of Facebook\u2019s deep learning platform: PyTorch. According to the Food and Agriculture Organization of the United Nations (UN), transboundary plant pests and diseases affect food crops, causing significant losses to farmers and threatening food security.", "For this challenge, I used the \u201cPlanVillage\u201d dataset. This dataset contains an open access repository of images on plant health to enable the development of mobile disease diagnostics. The dataset contains 54, 309 images. The images span 14 crop species: Apple, Blueberry, Cherry, Grape, Orange, Peach, Bell Pepper, Potato, Raspberry, Soybean, Squash, Strawberry, and Tomato. It contains images of 17 fundal diseases, 4 bacterial diseases, 2 molds (oomycete) diseases, 2 viral diseases, and 1 disease caused by a mite. 12 crop species also have images of healthy leaves that are not visibly affected by a disease.", "I have used Google Cloud Platform with the base platform called, n1-highmem-8, and costs $0.12 per hour. Attaching a P4 GPU costs $0.26 per hour so both together amount to $0.38 per hour. And the suggested 200GB Standard Disk storage size, there will be an additional charge of $9.60 a month. For a full walkthrough, setup visit here!", "I have used fastai which is built on top of Pytorch. Dataset consists of 38 disease classes from PlantVillage dataset and 1 background class from Stanford\u2019s open dataset of background images DAGS. 80% of the dataset is used for training and 20% for validation.", "We will use the pre-trained resnet34 model to solve the issue with the training.", "Start every notebook with the following three lines:", "The lines in jupyter notebook that start with \u2018%\u2019 are called Line Magics. These are not instructions for Python to execute but to Jupyter notebook.", "The first two lines will ensure automatic reload whenever you make any changes in the library. And the third line to show charts and graphs in the notebook.", "Now, give the path of the dataset (in my case it is in the root directory):", "Batch size means we will feed x images at once to update parameters of our deep learning model. Set batch size to 64, if smaller GPU use 16 or 32 instead of 64.", "ImageDataBunch is used to do classification based on images.", "ImageDataBunch.from_folder gets the label names from the folder name automatically. fastai library has awesome documentation to navigate through their library functions with live examples on how to use them. Once the data is loaded, we can also normalize the data by using .normalize to ImageNet parameters.", "To look at a random sample of images, we can use .show_batch() function ImageDataBunch class.", "Let\u2019s print all the data classes present in the data. In total, we have images in 39 classes as mentioned above!", "To create the transfer learning model we will need to use the function cnn_learner that takes the data, network and the metrics . The metrics is just used to print out how the training is performing.", "We will train for 5 epochs.", "As we can see above by just running five epochs with the default setting our accuracy for this fine-grained classification task is around ~99.10%.", "Let\u2019s train it for two more epochs.", "Now save the model with .save().", "We can also plot the confusion matrix.", "We use the lr_find method to find the optimum learning rate. Learning Rate is an important hyper-parameter to look for. We traditionally use \u03b1\u03b1 to denote this parameter. If the Learning rate is too slow, we take more time to reach the most accurate result. If it is too high, we might not even end up reaching the accurate result. Learning Rate Finder was the idea of automatically getting the magic number (which is near perfect), to get this optimum learning rate. This was introduced in last year\u2019s Fast AI course and continues to be useful.", "After we run the finder, we plot the graph between loss and learning rate. We see a graph and typically choose a higher learning rate for which the loss is minimal. The higher learning rate makes sure that the machine ends up learning faster.", "Considering the fact that we are using a pre-trained model of Resnet34, we know for sure that our previous layers of this neural network would learn to detect the edges and the later layers would learn complicated shapes. We don\u2019t want to ruin out the earlier layers which presumably does a good job of detecting the edges. But would like to improve the model in narrowing down classifying the images.", "So, we will set a lower learning rate for earlier layers and a higher one for the last layers.", "The slice is used to provide the learning rate wherein, we just provide the range of learning rates (its min and max). The learning rate is set gradually higher as we move from the earlier layer to the latest layers.", "Let\u2019s unfreeze all the layers so that we can train the entire model using unfreeze() function.", "Freeze the model, find the learning rate, and fine-tune the model:", "Finally, we achieved the state of the art results close to 99.654% Accuracate using Resnet34.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Artist & Internet Cowboy! NewsLetter: https://rb.gy/ydggvu"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb0c389b82371&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0c389b82371--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0c389b82371--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://imskr.medium.com/?source=post_page-----b0c389b82371--------------------------------", "anchor_text": ""}, {"url": "https://imskr.medium.com/?source=post_page-----b0c389b82371--------------------------------", "anchor_text": "Shubham Kumar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2612c96405e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&user=Shubham+Kumar&userId=2612c96405e4&source=post_page-2612c96405e4----b0c389b82371---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0c389b82371&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0c389b82371&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://plantvillage.psu.edu/", "anchor_text": "PlanVillage"}, {"url": "https://course.fast.ai/start_gcp.html", "anchor_text": "here"}, {"url": "https://plantvillage.org/", "anchor_text": "PlantVillage"}, {"url": "http://dags.stanford.edu/projects/scenedataset.html", "anchor_text": "DAGS"}, {"url": "https://ipython.readthedocs.io/en/stable/interactive/magics.html", "anchor_text": "Line Magics"}, {"url": "https://docs.fast.ai/vision.data#ImageDataBunch.from_folder", "anchor_text": "ImageDataBunch.from_folder"}, {"url": "https://docs.fast.ai/", "anchor_text": "awesome documentation"}, {"url": "https://arxiv.org/abs/1506.01186", "anchor_text": "Learning Rate"}, {"url": "https://github.com/imskr/Plant_Disease_Detection", "anchor_text": "imskr/Plant_Disease_DetectionTraining and evaluating state-of-the-art deep architectures for plant disease classification task using pyTorch. Models\u2026github.com"}, {"url": "http://plantdisease.ap-south-1.elasticbeanstalk.com/", "anchor_text": "Visit Here!"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b0c389b82371---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b0c389b82371---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/fastai?source=post_page-----b0c389b82371---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----b0c389b82371---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/plants?source=post_page-----b0c389b82371---------------plants-----------------", "anchor_text": "Plants"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0c389b82371&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&user=Shubham+Kumar&userId=2612c96405e4&source=-----b0c389b82371---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0c389b82371&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&user=Shubham+Kumar&userId=2612c96405e4&source=-----b0c389b82371---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0c389b82371&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0c389b82371--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb0c389b82371&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b0c389b82371---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0c389b82371--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b0c389b82371--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b0c389b82371--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b0c389b82371--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b0c389b82371--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b0c389b82371--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b0c389b82371--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b0c389b82371--------------------------------", "anchor_text": ""}, {"url": "https://imskr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://imskr.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shubham Kumar"}, {"url": "https://imskr.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "383 Followers"}, {"url": "https://rb.gy/ydggvu", "anchor_text": "https://rb.gy/ydggvu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2612c96405e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&user=Shubham+Kumar&userId=2612c96405e4&source=post_page-2612c96405e4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F77d604794086&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplant-disease-detection-web-application-using-fastai-b0c389b82371&newsletterV3=2612c96405e4&newsletterV3Id=77d604794086&user=Shubham+Kumar&userId=2612c96405e4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}