{"url": "https://towardsdatascience.com/time-series-forecasting-with-autoregressive-processes-ba629717401", "time": 1683008966.138198, "path": "towardsdatascience.com/time-series-forecasting-with-autoregressive-processes-ba629717401/", "webpage": {"metadata": {"title": "Time Series Forecasting with Autoregressive Processes | by Marco Peixeiro | Towards Data Science", "h1": "Time Series Forecasting with Autoregressive Processes", "description": "In this hands-on tutorial, we will cover the topic of time series modelling with autoregressive processes. Make sure to have a Jupyter notebook ready to follow along. The code and the dataset is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/marcopeix/time-series-analysis", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://www.datasciencewithmarco.com/offers/tdU2mtVK", "anchor_text": "Applied Time Series Analysis in Python", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/basic-statistics-for-time-series-analysis-in-python-4cb147d56535", "anchor_text": "moving average process", "paragraph_index": 18}], "all_paragraphs": ["In this hands-on tutorial, we will cover the topic of time series modelling with autoregressive processes.", "This article will cover the following key elements in time series analysis:", "Make sure to have a Jupyter notebook ready to follow along. The code and the dataset is available here.", "Learn how to work with more complex models such as SARIMAX, VARMAX, and apply deep learning models (LSTM, CNN, ResNet, autoregressive LSTM) for time series analysis with Applied Time Series Analysis in Python!", "An autoregressive model uses a linear combination of past values of the target to make forecasts. Of course, the regression is made against the target itself. Mathematically, an AR(p) model is expressed as:", "AR(p) model is incredibly flexible and it can model a many different types of time series patterns. This is easily visualized when we simulate autoregressive processes.", "Usually, autoregressive models are applied to stationary time series only. This constrains the range of the parameters phi.", "For example, an AR(1) model will constrain phi between -1 and 1. Those constraints become more complex as the order of the model increases, but they are automatically considered when modelling in Python.", "Let\u2019s simulate an AR(2) process in Python.", "We start off by importing some libraries. Not all will be used for the simulation, but they will be required for the rest of this tutorial.", "We will use the ArmaProcess library to simulate the time series. It requires us to define our parameters.", "We will simulate the following process:", "Since we are dealing with an autoregressive model of order 2, we need to define the coefficient at lag 0, 1 and 2.", "Also, we will cancel the effect of a moving average process.", "Finally, we will generate 10 000 data points.", "We can plot the time series:", "And you should get something similar to this:", "Now, let\u2019s take a look at the autocorrelation plot (correlogram):", "You can see that the coefficient is slowly decaying. This means that it is unlikely a moving average process and it suggests that the time series can probably be modelled with an autoregressive process (which makes sense since that what we are simulating).", "To make sure that this is right, let\u2019s plot the partial autocorrelation plot:", "As you can see the coefficients are not significant after lag 2. Therefore, the partial autocorrelation plot is useful to determine the order of an AR(p) process.", "You can also check the values of each coefficients by running:", "Now, in a real project setting, it can be easy to find the order of an AR(p) process, but we need to find a way to estimate the coefficients phi.", "To do so, we use the Yule-Walker equation. This equations allows us to estimate the coefficients of an AR(p) model, given that we know the order.", "As you can see, the Yule-Walker equation did a decent job at estimating our coefficients and got very close to 0.33 and 0.5.", "Now, let\u2019s simulate an AR(3) process. Specifically, we will simulate:", "Similarly to what was previously done, let\u2019s define our coefficients and generate 10 000 data points:", "Then, we can visualize the time series:", "And you should see something similar to:", "Now, looking at the PACF and ACF:", "You see that the coefficients are not significant after lag 3 for the PACF function as expected.", "Finally, let\u2019s use the Yule-Walker equation to estimate the coefficients:", "Again, the estimations are fairly close to the actual values.", "Now, let\u2019s apply our knowledge of autoregressive processes in a project setting.", "The objective is to model the quarterly earnings per share (EPS) of the company Johnson&Johnson between 1960 and 1980.", "Now, the first five rows are not very useful for us. Let\u2019s plot the entire dataset to get a better visual representation.", "Awesome! Now we can the there is clear upwards trend in the data. While this may be a good sign for the company, it is not good in terms of time series modelling, since it means that the time series is not stationary.", "As aforementioned, the AR(p) process works only for stationary series.", "Therefore, we must apply some transformations to our data to make it stationary.", "In this case, will take the log difference. This is equivalent to taking the log of each value, and subtracting the previous value.", "Now, it seems that we removed the trend. However, we have to be sure that our series is stationary before modelling with an AR(p) process.", "We will thus use the augmented Dicker-Fuller test. This will give us the statistical confidence that our time series is indeed stationary.", "Since we get a large negative ADF statistic and p-value smaller than 0.05, we can reject the null hypothesis and say that our time series is stationary.", "Now, let\u2019s find the order of the process by plotting the PACF:", "As you can see, after lag 4, the PACF coefficients are not significant anymore. Therefore, we will assume an autoregressive process of order 4.", "Now, we will use this information to estimate the coefficients using the Yule-Walker equation:", "Therefore, the function is approximated as:", "Note that this equation models the transformed series.", "Congratulations! You now understand what an autoregressive model is, how to recognize an autoregressive process, how to determine its order, and how to use it to model a real-life time series.", "Sharpen your time series analysis skills and learn the latest best practices for time series analysis in Python:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior data scientist | Author | Instructor. I write hands-on articles with a focus on practical skills."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fba629717401&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ba629717401--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ba629717401--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----ba629717401--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----ba629717401--------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd----ba629717401---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba629717401&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba629717401&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lenneek?utm_source=medium&utm_medium=referral", "anchor_text": "Elena Koycheva"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/marcopeix/time-series-analysis", "anchor_text": "here"}, {"url": "https://www.datasciencewithmarco.com/offers/tdU2mtVK", "anchor_text": "Applied Time Series Analysis in Python"}, {"url": "https://towardsdatascience.com/basic-statistics-for-time-series-analysis-in-python-4cb147d56535", "anchor_text": "moving average process"}, {"url": "https://github.com/marcopeix/time-series-analysis", "anchor_text": "dataset"}, {"url": "https://www.datasciencewithmarco.com/offers/tdU2mtVK", "anchor_text": "Applied Time Series Analysis in Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ba629717401---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ba629717401---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ba629717401---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----ba629717401---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ba629717401---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fba629717401&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----ba629717401---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fba629717401&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----ba629717401---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fba629717401&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ba629717401--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fba629717401&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ba629717401---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ba629717401--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ba629717401--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ba629717401--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ba629717401--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ba629717401--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ba629717401--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ba629717401--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ba629717401--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/@marcopeixeiro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9835bccb3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-forecasting-with-autoregressive-processes-ba629717401&newsletterV3=741c1c8fcfbd&newsletterV3Id=9835bccb3d51&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/time-series-forecasting-in-python-book", "anchor_text": "Time Series Forecasting in Python2022"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}