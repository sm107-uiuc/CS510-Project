{"url": "https://towardsdatascience.com/hangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55", "time": 1683013657.194102, "path": "towardsdatascience.com/hangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55/", "webpage": {"metadata": {"title": "Hangar Tutorial (2/2): Training a Model with Versioned data | by JJmachan | Towards Data Science", "h1": "Hangar Tutorial (2/2): Training a Model with Versioned data", "description": "In the last tutorial, we introduced Hangar, a python library that helps you version control data. Well, data is the new oil and properly managing and streaming your dataflow is vital for your\u2026"}, "outgoing_paragraph_urls": [{"url": "https://hangar-py.readthedocs.io/en/stable/", "anchor_text": "Hangar", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/hangar-tutorial-1-2-adding-your-data-to-hangar-d7f039265455", "anchor_text": "previous blog", "paragraph_index": 0}, {"url": "https://github.com/jjmachan/hangar_tutorials", "anchor_text": "link", "paragraph_index": 1}, {"url": "https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html", "anchor_text": "Pytorch tutorials", "paragraph_index": 10}, {"url": "https://hangar-py.readthedocs.io/en/stable/Tutorial-003.html", "anchor_text": "Remote Repositories", "paragraph_index": 14}, {"url": "https://hangar-py.readthedocs.io/en/stable/Tutorial-003.html#Partial-Fetching-and-Clones", "anchor_text": "Partial Downloads", "paragraph_index": 14}, {"url": "https://hangar-py.readthedocs.io/en/stable/externals.html", "anchor_text": "Hangar External", "paragraph_index": 14}, {"url": "https://github.com/jjmachan/hangar_tutorials", "anchor_text": "GitHub repo.", "paragraph_index": 17}, {"url": "http://jjmachan.in", "anchor_text": "jjmachan.in", "paragraph_index": 25}], "all_paragraphs": ["In the last tutorial, we introduced Hangar, a python library that helps you version control data. Well, data is the new oil and properly managing and streaming your dataflow is vital for your company. Hangar is a nice tool to have in your toolbox which brings in best practices like version control from software development to ML engineering which in turn helps you to serve robust ML services to your customer. If you haven\u2019t checked out the previous blog do check it out. I discuss the core concepts of Hangar and how to create your own Hangar repo there.", "Note: There is an accompanying GitHub repo with some detailed notebooks explaining all of the concepts discussed. You can try that out along with this tutorial. [link]", "So we have learned the core concepts of Hangar and we added our toy dataset (MNIST) into Hangar. Today we will continue from where we left off and train a model from the data we have added to Hangar. First of all, let\u2019s connect to the Hangar repo.", "Let's take a quick look at the summary to get an idea of the data in our repo.", "As you can see the data is stored in 6 ndarray columns. 2 columns each store the image and target pair for the 3 data splits, train, test and validation. Now let\u2019s create a read-only checkout from the master branch to access the columns.", "Now, let\u2019s load the data from Hangar to feed it into our neural network for training. Even though you can directly access the data using the checkout, the recommended way is to use the make_torch_dataset. It offers more configurable options and makes it efficient and easier to load into PyTorch.", "make_torch_dataset(columns, keys: Sequence[str] = None, index_range: slice = None, field_names: Sequence[str] = None)", "The make_torch_dataset creates a PyTorch Dataset with the columns passed to it. In our example, if we would pass the \u2018mnist_training_images\u2019 column and \u2018mnist_training_labels\u2019 column. Now make_torch_dataset will return, for each index, a tuple with the image and label corresponding with the index.", "Since it returns a PyTorch Dataset we can pass it into a PyTorch DataLoader to perform shuffling, batching etc.", "Now, iterating through the trainDataloader will give us the data in batches and as tensors ready to be used for training.", "We will not go into the details of how models are defined and trained. If you find the code below hard to catch up I highly recommend that you check out the Pytorch tutorials", "We will define a simple 3 layer, fully connected neural network for MNIST.", "Now using the dataloader we iterate through batches, do the forward propagation, calculate the loss, find the gradients via backpropagation and adjust the model parameters, just the standard the neural network training you are familiar with.", "We have successfully trained our model using the data from Hangar.", "By now you should have learned the basics of Hangar, how to define columns according to your dataset, add data to these columns and load the data from it to train models in PyTorch. Hangar also has a bunch of other cool features like Remote Repositories, Partial Downloads of data from these remote repos, Hangar External which is a high-level interface to Hangar which you can use when you are integrating Hangar with your existing dataflow etc. I\u2019ve linked the relevant docs and I recommend that you check them out to unlock all the features Hangar has to offer.", "As more and more companies are figuring out new ways to get the power of machine learning into their products it is important that we incorporate some best practices into it in order to avoid building up technical debt. This is still a growing field and everyone is still figuring out what these \u201cbest practices\u201d are and which workflows might work best for them. Versioning your data is one such practice that can be added to ensure reproducibility, collaboration and better management. Tools like Hangar and DVC are the best options when it comes to this even though there is still a lot of work to be done. Hangar is super easy to add to your existing ML workflow and hopefully, this tutorial has given you a better understanding it.", "This is an auxiliary section which compares two aspects hangar", "Now, these are my personal experiments and benchmarks so try them out for yourself and check if the results I discuss below are the same. If now I would love it if you could share it for everyone! The code is available on the GitHub repo.", "First, let's talk about dataset sizes. Now internal Hangar does perform a really good job to crunch the data when saving it into disk. In our example the original MNIST file is 210Mb but in Hangar it only takes up 105Mb. But I\u2019m talking about the uncompressed version of MNIST. The compressed version is just 17Mb which is a lot. This is one of the biggest problems I have seen with Hangar. It does a great job of compressing numerical data but most probably there are other formats for your data that will likely offer significant size reduction. this becomes quite apparent when saving jpeg files in Hangar and they took up a significant amount of space.", "Now there are ways to make it more efficient by manually tweaking the backends hangar chooses to save the data in. But this comes at the cost of higher read times. According to the developers, this is taken with good intension in mind. Storage is cheap, time isn't.", "Second is loading from disk for training. It takes almost 7x more time, which is a lot! also in this example, I\u2019m performing a decompression before loading the data into memory and still, it just takes around 1sec.", "This is the output from my system.", "This again comes back to the backends choices. All these results are with the default settings but can be tweaked. So the question is how do we actually tweak these. There is an official guide that is in the works. I\u2019ll comment on backend selection more when that is out.", "Meanwhile, you check these out and tell me your result. Would love to hear it!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Engineer | Building tools for the software 2.0 stack | I blog about best practices in ML Engineering \u2014 jjmachan.in"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F78460404c55&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----78460404c55--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----78460404c55--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jjmachan?source=post_page-----78460404c55--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jjmachan?source=post_page-----78460404c55--------------------------------", "anchor_text": "JJmachan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa951476f1bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&user=JJmachan&userId=fa951476f1bf&source=post_page-fa951476f1bf----78460404c55---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78460404c55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78460404c55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://hangar-py.readthedocs.io/en/stable/", "anchor_text": "Hangar"}, {"url": "https://towardsdatascience.com/hangar-tutorial-1-2-adding-your-data-to-hangar-d7f039265455", "anchor_text": "previous blog"}, {"url": "https://giphy.com/gifs/HUplkVCPY7jTW", "anchor_text": "Giphy"}, {"url": "https://github.com/jjmachan/hangar_tutorials", "anchor_text": "link"}, {"url": "https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html", "anchor_text": "Pytorch tutorials"}, {"url": "https://hangar-py.readthedocs.io/en/stable/Tutorial-003.html", "anchor_text": "Remote Repositories"}, {"url": "https://hangar-py.readthedocs.io/en/stable/Tutorial-003.html#Partial-Fetching-and-Clones", "anchor_text": "Partial Downloads"}, {"url": "https://hangar-py.readthedocs.io/en/stable/externals.html", "anchor_text": "Hangar External"}, {"url": "https://github.com/jjmachan/hangar_tutorials", "anchor_text": "GitHub repo."}, {"url": "https://medium.com/tag/hangar?source=post_page-----78460404c55---------------hangar-----------------", "anchor_text": "Hangar"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----78460404c55---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-version-control?source=post_page-----78460404c55---------------data_version_control-----------------", "anchor_text": "Data Version Control"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F78460404c55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&user=JJmachan&userId=fa951476f1bf&source=-----78460404c55---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F78460404c55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&user=JJmachan&userId=fa951476f1bf&source=-----78460404c55---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78460404c55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----78460404c55--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F78460404c55&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----78460404c55---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----78460404c55--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----78460404c55--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----78460404c55--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----78460404c55--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----78460404c55--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----78460404c55--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----78460404c55--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----78460404c55--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jjmachan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jjmachan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "JJmachan"}, {"url": "https://medium.com/@jjmachan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "26 Followers"}, {"url": "http://jjmachan.in", "anchor_text": "jjmachan.in"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa951476f1bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&user=JJmachan&userId=fa951476f1bf&source=post_page-fa951476f1bf--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb97b431730d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhangar-tutorial-2-2-training-a-model-with-the-versioned-data-78460404c55&newsletterV3=fa951476f1bf&newsletterV3Id=b97b431730d4&user=JJmachan&userId=fa951476f1bf&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}