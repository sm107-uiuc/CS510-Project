{"url": "https://towardsdatascience.com/learnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3", "time": 1683016965.420774, "path": "towardsdatascience.com/learnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3/", "webpage": {"metadata": {"title": "Learning about handling fraud with data and machine learning | by Juan De Dios Santos | Towards Data Science", "h1": "Learning about handling fraud with data and machine learning", "description": "Anomaly detectors, rule-based systems, fallback options, and common sense"}, "outgoing_paragraph_urls": [{"url": "https://koaning.github.io/human-learn/", "anchor_text": "human-learn", "paragraph_index": 6}, {"url": "https://koaning.github.io/human-learn/api/outlier.html#hulearn.outlier.interactiveoutlier.InteractiveOutlierDetector", "anchor_text": "InteractiveOutlierDetector", "paragraph_index": 8}, {"url": "https://juandes.com", "anchor_text": "https://juandes.com", "paragraph_index": 19}], "all_paragraphs": ["The Internet is a sea of information. Whenever you have a question, you visit Google and ask: \u201cHow to make a pancake?\u201d \u201cWhat\u2019s the best Pokemon?\u201d \u201cWhat are things I should keep in mind while dealing with fraud?\u201d One of these is not like the other, right? At the end of the day, we all know Pikachu is going to win. Jokes asides, I would like you to read that last question and make a mental list of things you believe someone should keep in mind while using data to deal with fraud; I\u2019ll come back to the list later.", "I work with moderation and data. First, it was spam prevention, and now, fraud. Dealing with fraud has been something I\u2019ve always wanted to work with, so I remember spending a considerable amount of time reading about fraud moderation techniques, tips, etc. While interesting as these sources were, I realized that many of them cover similar topics and examples. And don\u2019t get me wrong; there\u2019s nothing bad with that. After all, fraud is a very particular topic. But now that I\u2019m working in the field, I recognized that those concepts and techniques I learned are far from the reality I face in my daily work, and so, in this article, I want to share some of the details I\u2019ve learned during my time using data to combat fraud. Let\u2019s go!", "One of the most common believes I\u2019ve seen about handling fraud with machine learning is that the datasets are highly imbalanced. This fact prompts many of the available resources to center the discussion around this characteristic and, therefore, focus on methods that are good at handling these cases. In my case, I\u2019ve taken a liking to try unsupervised learning models, in particular anomaly detection models. I tend to formulate fraud detection problems as anomaly detection problems because fraudulent cases are a small minority and could often be seen as outliers. On top of that, with unsupervised learning, I don\u2019t have to worry about the labels.", "One of my to-go algorithm from this group is Isolation Forest because it has proven to work well and fast in many use cases. To show an actual example, below is a normalized and dimensionality reduced sample of an unlabeled test dataset I used at work. With this dataset, my goal is to use the algorithm to learn in an unsupervised fashion, a function that separates the inliers from outliers. Without getting into details, I\u2019ll mention that it involves the spending of the in-app currency. On the bottom left area of the chart, we have many entries, which implies that most of the spending habits fall in this region. On the other hand, the rest of the plot\u2019s data points denote users with an unusual spending pattern.", "The red contour we see on the image is what I call the model\u2019s \u201chard\u201d learned decision boundary \u2014 everything that\u2019s inside is considered an inlier while everything outside an outlier. However, the blue contour is the \u201csoft\u201d decision boundary, an area where the outlier values aren\u2019t as extremes as those in the red part.", "Another technique I found useful is the rule-based systems. Yes, that\u2019s right. As restrictive or limited as they could be, a well-prepared, handcrafted, and data-driven rule-based system consisting of if\u2019s and else\u2019s could allow us to detect fraudulent events while minimizing the risk of making a wrong decision. Furthermore, they are simpler to explain than an ML model. But of course, they are far from perfect. To build one, the responsible person needs to be well aware of the domain since they can be quite complex to tweak (that\u2019s why we use machine learning, right?).", "For example, suppose that you want to build a rule-based system to create a decision boundary manually using the dataset presented above. In this case, it shouldn\u2019t be that complex since we are dealing in a two-dimensional space where the outlier or possible fraudulent cases are well-defined. But what if we would have a messier and more complex dataset? If so, building such a rule system could be very time-consuming. To aid with the development of rule-based systems, I\u2019ve been experimenting with a Python package named human-learn, which, and I quote the official documentation, \u201cmake it easier to construct and benchmark rule-based systems that are designed by humans.\u201d", "My favorite \u2014 and probably the coolest \u2014 human-learn feature is that it let you interactively draw with your mouse (yes, draw!) the decision boundary on a plot. For example, in the image below, I\u2019m defining the \u201crules\u201d by drawing a decision boundary in the desired area.", "After setting the rules, I\u2019m using an InteractiveOutlierDetector object to create a scikit-learn-like model to train and predict as if it were one (using the fit() and predict() methods, respectively). The following image is the same dataset with the predictions obtained from the model (the outliers are the same as above because I predicted using the training set). Below is the code I used for my human-learn model. The tool is not mainly made for handling unlabeled or one-class cases, so I had to modify my DataFrame to make it work.", "But rule-based systems can be more than that. Even if you don\u2019t use them as your primary decision-making module, they could serve quite well as a fallback or double-check option for cases where we should debate over the ML model\u2019s decision.", "When dealing with spam and fraud, I learned that we should not blindly apply the model\u2019s output because there\u2019s model prior knowledge or decision that must come first; this is where domain knowledge shines.To handle this, I resorted to building numerous \u201csafety net\u201d mechanisms that double-checked my \u201ctrue\u201d predictions (\u201cspammer\u201d or \u201cfraudster\u201d) before taking action to avoid certain situations from happening.", "In a fraud setting (and many others), such measures are suitable for preventing possible false positives or intended cases. For instance, you wouldn\u2019t be so happy if your bank blocks your account if you do X or Y transaction. However, if you call them beforehand, they might put a flag on the account and \u201cignore\u201d any transaction that otherwise might seem fraudulent. Or hypothetically speaking, suppose that during analysis, you discovered that most users who have feature X and Y and are classified as fraudulent are typically false positives. In this case, add a small module that checks for these features. Remember that your opinion and knowledge is as essential as that of the model.", "In the first point, I said that I treat many of my problems as anomaly detection ones. So, it is easy to interpret these detected anomalies as something \u201cbad\u201d (which makes sense considering the term \u201canomaly\u201d might convey a negative feeling). But this is not always true \u2014 anomalies could also be good! For example, a sudden surge in activity could either mean more activity caused because of a promotion (which is excellent) or a spam wave (which is not ideal at all). But how do we separate the good anomalies from the bad ones? How should we treat them, particularly in a production system where everything is automatic? Well, an option is the rule system from above.", "Before getting started here, I\u2019ll admit that detecting the fraudulent event before it occurs is not always an option. That\u2019s because there are cases in which there are no incoming signals before the fraudulent action is executed or because there\u2019s no way to do it because of the way the platform is built. And so, we would essentially be blind until the fraud happens.", "However, if this is not the case, then I propose \u2014 no \u2014 I encourage you to try to prevent the fraud before it even happens. Maybe I sound a bit biased because this was a strategy back when I dealt with spam, but wouldn\u2019t it better to avoid the consequences from happening in the first place? For example, I\u2019m willing to say that most platforms with a feature that prevents users from sending nude images first scan the image for any sort of nudity and then allow it to reach the destination if it is clean.", "But how could we prevent a fraudulent event and detect it before it happens? There could be a million ways, which, again, depends on the design of the platform. For instance, in an event-based setting, you could have a classifier that predicts whether the user is \u201cfraud\u201d based on the sequence of the events it executes and another model that uses the same sequence to predict the likelihood of the next action being fraudulent", "As with most things machine learning, fraud detection is a non-trivial topic that requires more than knowing machine learning algorithms to tackle it. Therefore, it helps to think about the problem from an out-of-the-box perspective and apply unconventional methods and solutions that could help us solve them. In this article, I\u2019ve discussed four different strategies I\u2019ve used during my time trying to moderate fraud, many of them which I learned from my time working with spam. However, as I mentioned early in the article, we need to understand that no solution compatible with every case and that every now and then, we will surely fail. Yet, I\u2019d invite you to consider them and reflect on if or how they could help you.", "At the beginning of the article, I asked you to do a mental list of things one should keep in mind would consider when applying machine learning to a fraud-related dataset. Did you do it? Did any of my points make your list? Share yours with me! I\u2019d love to hear it and, even better, see how I could apply them.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data storyteller, Trust and Safety Software Engineer, and fan of quantifying my life. Also, I like Pokemon. https://juandes.com, @jdiossantos."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb41e76bbb9d3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@juandes?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": "Juan De Dios Santos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9998a144da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=post_page-9b9998a144da----b41e76bbb9d3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb41e76bbb9d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb41e76bbb9d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@will_myers?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Will Myers"}, {"url": "https://unsplash.com/s/photos/outlier?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://juandes.com/p/c9ab22c1-a6f6-46f7-83ce-b9b83370eeaf/instagram.com/juandesr/", "anchor_text": "me"}, {"url": "https://koaning.github.io/human-learn/", "anchor_text": "human-learn"}, {"url": "https://koaning.github.io/human-learn/api/outlier.html#hulearn.outlier.interactiveoutlier.InteractiveOutlierDetector", "anchor_text": "InteractiveOutlierDetector"}, {"url": "https://unsplash.com/@unstable_affliction?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ivan Bandura"}, {"url": "https://unsplash.com/s/photos/contrast?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b41e76bbb9d3---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b41e76bbb9d3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/fraud-detection?source=post_page-----b41e76bbb9d3---------------fraud_detection-----------------", "anchor_text": "Fraud Detection"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b41e76bbb9d3---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b41e76bbb9d3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb41e76bbb9d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=-----b41e76bbb9d3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb41e76bbb9d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=-----b41e76bbb9d3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb41e76bbb9d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb41e76bbb9d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b41e76bbb9d3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b41e76bbb9d3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juandes?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Juan De Dios Santos"}, {"url": "https://medium.com/@juandes/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "882 Followers"}, {"url": "https://juandes.com", "anchor_text": "https://juandes.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9b9998a144da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=post_page-9b9998a144da--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8e4ad12e7160&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearnings-about-handling-fraud-with-data-and-machine-learning-b41e76bbb9d3&newsletterV3=9b9998a144da&newsletterV3Id=8e4ad12e7160&user=Juan+De+Dios+Santos&userId=9b9998a144da&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}