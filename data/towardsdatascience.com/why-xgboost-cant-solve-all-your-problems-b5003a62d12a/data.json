{"url": "https://towardsdatascience.com/why-xgboost-cant-solve-all-your-problems-b5003a62d12a", "time": 1683016235.809199, "path": "towardsdatascience.com/why-xgboost-cant-solve-all-your-problems-b5003a62d12a/", "webpage": {"metadata": {"title": "Why XGBoost Can't Solve All Your Problems | Towards Data Science", "h1": "Why XGBoost can\u2019t solve all your problems.", "description": "XGBoost is definitely powerful and useful for many tasks, but there is one problem that affects not only XGBoost but all tree-based algorithms in general."}, "outgoing_paragraph_urls": [{"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "XGBoost", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Gradient_boosting", "anchor_text": "gradient boosting", "paragraph_index": 1}, {"url": "https://www.kaggle.com/c/avito-context-ad-clicks", "anchor_text": "Avito", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/web-traffic-time-series-forecasting", "anchor_text": "Kaggle competition", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Universal_approximation_theorem", "anchor_text": "universal approximation theorem", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/fake-news-classification-with-recurrent-convolutional-neural-networks-4a081ff69f1a", "anchor_text": "this article", "paragraph_index": 15}], "all_paragraphs": ["If you\u2019ve ever competed in machine learning competitions on Kaggle or browsed articles or forums written by the data science community, you\u2019ve probably heard of XGBoost. It\u2019s the algorithm that has won many Kaggle competitions and there are more than a few benchmark studies that show instances in which XGBoost consistently outperforms other algorithms. The fact that XGBoost is parallelized and runs faster than other implementations of gradient boosting only adds to its mass appeal.", "For those who are unfamiliar with this tool, XGBoost (which stands for \u201cExtreme Gradient Boosting\u201d) is a highly optimized framework for gradient boosting, an algorithm that iteratively combines the predictions of several weak learners such as decision trees to produce a much stronger and more robust model. Since its inception in 2014, XGBoost has become the go-to algorithm for many data scientists and machine learning practitioners.", "\u201cWhen in doubt, use XGBoost\u201d \u2014 Owen Zhang, Winner of Avito Context Ad Click Prediction competition on Kaggle", "This probably sounds too good to be true, right? XGBoost is definitely powerful and useful for many tasks, but there is one problem\u2026 In fact, this is a problem that affects not only XGBoost but all tree-based algorithms in general.", "This is perhaps the fundamental flaw inherent in all tree-based models. It doesn\u2019t matter if you have a single decision tree, a random forest with 100 trees, or an XGBoost model with 1000 trees. Due to the method with which tree-based models partition the input space of any given problem, these algorithms are largely unable to extrapolate target values beyond the limits of the training data when making predictions. This is usually not a huge problem in classification tasks, but it is definitely a limitation when it comes to regression tasks that involve predicting a continuous output.", "If the training dataset only contains target values between 0 and 100, a tree-based regression model will have a hard time predicting a value outside of this range. Here are some examples of predictive tasks in which extrapolation is important and XGBoost might not do the trick\u2026", "Over the last 100 years, global temperatures have risen at an increasing rate. Imagine trying to predict the global temperatures for the next 20 years using data from 1900 to 2020. A tree-based algorithm like XGBoost will be bounded by the highest global temperatures as of today. If the temperatures continue to rise, the model will surely underestimate the rise in global temperatures over the next 20 years.", "If we look at the trends of a popular stock market index like the S&P 500 over the last 50 years we will find that the price of the index goes through highs and lows but ultimately increases over time. In fact, the S&P 500 has an average annual return of around 10 percent based on historical data, meaning the price goes up by around 10 percent on average each year. Just try to forecast the price of the S&P 500 using XGBoost and you\u2019ll see that it may predict decreases in prices, but fails to capture the overall increasing trend in the data. To be fair, predicting stock market prices is an extremely difficult problem that even machine learning hasn\u2019t solved, but the point is, XGBoost can\u2019t predict increases in prices beyond the range present in the training data.", "This task was the goal of the following Kaggle competition that I participated in a few years ago. Just as XGBoost may fail to capture an increasing trend in global temperatures or stock prices, if a webpage is going viral then XGBoost may not be able to predict the increase in traffic to that page even if the increasing trend is obvious.", "Decision trees take the input space and partition it into subsections which each correspond to a singular output value. Even in regression problems, a decision tree uses a finite set of rules to output one of a finite set of possible values. For this reason, a decision tree used for regression will always struggle to model a continuous function. Consider the following example where a decision tree can be used to predict the price of a house. Keep in mind the dataset I created below is completely made up and only used for the purpose of proving a point.", "If we used this small dataset to train a decision tree, the following tree might end up being our model for predicting housing prices.", "Obviously, this is not a very good model or a good dataset, but it demonstrates one of the fundamental issues with decision tree regression. According to the dataset, it seems that the number of bedrooms and the size of a house is positively correlated with its price. In other words, larger houses with more bedrooms will cost more than smaller houses with fewer bedrooms. This seems logical, but the decision tree will never predict a price below $200,000 or a price above $550,000 because it has partitioned the infinite input space into a finite set of possibilities. Since decision tree regression models assign values to leaves based on averages, note that since there are two 4000 square-foot houses with three bedrooms, the decision tree predicts the average price of the two houses ($550,000) for this condition. Even though a $600,000 house exits in the dataset, the decision tree will never be able to identify a $600,000 house.", "Even if a model like XGBoost computed a weighted average of 1000 decision trees, each decision tree would be limited to predicting only a set range of values and as a result, the weighted average is also limited to a predetermined range of values depending on the training data.", "While tree-based models are not good at extrapolation, they are still good at solving a wide range of machine learning problems. XGBoost generally can\u2019t predict the future very well, but it is well suited for tasks such as the following:", "For forecasting or any machine learning problem involving extrapolation, neural networks will generally outperform tree-based methods. Unlike tree-based algorithms, neural networks are capable of fitting any continuous function, allowing them to capture complex trends in data. In the theory behind neural networks, this statement is known as the universal approximation theorem. This theorem essentially states that a neural network with just one hidden layer of arbitrary size can approximate any continuous function to any desired level of precision. Based on this theorem, a neural network can capture an increasing trend in stock prices or a rise in global temperatures and can predict values outside the range of the training data.", "For time-series forecasting problems such as forecasting global temperatures, recurrent neural networks with LSTM (long short-term memory) units can be very effective. In fact, LSTMs work well with sequential data in general and I even used them for text classification in this article.", "No, not necessarily. Neural networks are better than XGBoost for some but definitely not all problems. In machine learning, there is \u201cno free lunch\u201d and there is a price that you pay for the advantages of any algorithm.", "In fact, while the generalization power of neural networks is a strength it is also a weakness because a neural network can fit any function and can also easily overfit the training data. Neural networks also tend to require larger amounts of training data to make reasonable predictions. Interestingly, the same complexity that makes neural networks so powerful is the same complexity that makes them much harder to explain and interpret compared to tree-based algorithms.", "The moral of the story is that not all algorithms were created equal, but every algorithm has flaws and no algorithm is universally superior across all machine learning problems and business use cases.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb5003a62d12a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://amolmavuduru.medium.com/?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": "Amol Mavuduru"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511816e5976d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&user=Amol+Mavuduru&userId=511816e5976d&source=post_page-511816e5976d----b5003a62d12a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5003a62d12a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5003a62d12a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://unsplash.com/@drkolomiyets?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Sergey Kolomiyets"}, {"url": "https://unsplash.com/s/photos/tree-algorithms?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://xgboost.readthedocs.io/en/latest/", "anchor_text": "XGBoost"}, {"url": "https://en.wikipedia.org/wiki/Gradient_boosting", "anchor_text": "gradient boosting"}, {"url": "https://www.kaggle.com/c/avito-context-ad-clicks", "anchor_text": "Avito"}, {"url": "https://climate.nasa.gov/vital-signs/global-temperature/", "anchor_text": "NASA GISS"}, {"url": "https://www.multpl.com/s-p-500-historical-prices", "anchor_text": "multpl.com"}, {"url": "https://www.kaggle.com/c/web-traffic-time-series-forecasting", "anchor_text": "Kaggle competition"}, {"url": "https://en.wikipedia.org/wiki/Universal_approximation_theorem", "anchor_text": "universal approximation theorem"}, {"url": "http://alexlenail.me/NN-SVG/LeNet.html", "anchor_text": "NN SVG"}, {"url": "https://towardsdatascience.com/fake-news-classification-with-recurrent-convolutional-neural-networks-4a081ff69f1a", "anchor_text": "this article"}, {"url": "https://arxiv.org/abs/1603.02754", "anchor_text": "XGBoost: A Scalable Tree Boosting System"}, {"url": "https://www.kaggle.com/c/avito-context-ad-clicks", "anchor_text": "Avito Context Ad Clicks"}, {"url": "https://climate.nasa.gov/vital-signs/global-temperature/", "anchor_text": "Global Temperature"}, {"url": "https://www.multpl.com/s-p-500-historical-prices", "anchor_text": "S&P 500 Historical Prices"}, {"url": "https://en.wikipedia.org/wiki/Universal_approximation_theorem", "anchor_text": "Universal approximation theorem"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b5003a62d12a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b5003a62d12a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/xgboost?source=post_page-----b5003a62d12a---------------xgboost-----------------", "anchor_text": "Xgboost"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----b5003a62d12a---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----b5003a62d12a---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb5003a62d12a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&user=Amol+Mavuduru&userId=511816e5976d&source=-----b5003a62d12a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb5003a62d12a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&user=Amol+Mavuduru&userId=511816e5976d&source=-----b5003a62d12a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5003a62d12a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb5003a62d12a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b5003a62d12a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b5003a62d12a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b5003a62d12a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b5003a62d12a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b5003a62d12a--------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Amol Mavuduru"}, {"url": "https://amolmavuduru.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "565 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511816e5976d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&user=Amol+Mavuduru&userId=511816e5976d&source=post_page-511816e5976d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f3b67de8f9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-xgboost-cant-solve-all-your-problems-b5003a62d12a&newsletterV3=511816e5976d&newsletterV3Id=1f3b67de8f9c&user=Amol+Mavuduru&userId=511816e5976d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}