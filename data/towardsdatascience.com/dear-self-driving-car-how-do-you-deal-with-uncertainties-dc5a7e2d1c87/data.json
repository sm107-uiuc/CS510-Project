{"url": "https://towardsdatascience.com/dear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87", "time": 1683012880.738692, "path": "towardsdatascience.com/dear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87/", "webpage": {"metadata": {"title": "Self-driving car, how do you deal with uncertainties? | by Roman Liessner | Towards Data Science", "h1": "Self-driving car, how do you deal with uncertainties?", "description": "TL;DR: Controls for technical systems can be optimized in the simulation. In reality, however, numerous unknowns are waiting for us. In this post, we show how the addition of noise and sensor errors\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/do-you-want-to-train-a-simplified-self-driving-car-with-reinforcement-learning-be1263622e9e", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://www.researchgate.net/publication/342747549_LongiControl_A_Reinforcement_Learning_Environment_for_Longitudinal_Vehicle_Control", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://github.com/dynamik1703/gym_longicontrol", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://arxiv.org/abs/1606.01540", "anchor_text": "OpenAI Gym", "paragraph_index": 21}, {"url": "https://arxiv.org/pdf/1710.06537.pdf", "anchor_text": "Sim-to-Real Transfer of Robotic Control with Dynamics Randomization", "paragraph_index": 22}, {"url": "https://arxiv.org/pdf/1703.06907.pdf", "anchor_text": "Domain Randomization for Transferring Deep Neural Networks from Simulation to the Real World", "paragraph_index": 23}], "all_paragraphs": ["Here I present research with Lucas Vogt, Jan Dohmen and Christoph Friebel.", "TL;DR: Controls for technical systems can be optimized in the simulation. In reality, however, numerous unknowns are waiting for us. In this post, we show how the addition of noise and sensor errors affects the optimization result of a Reinforcement Learning agent.", "The most car drivers are following this idea because in the long run, it is more advantageous to sometimes obtain a suboptimal result than to push for an optimal result every time. For example, motorists seldom push the performance of their vehicle to the limit, preferring to minimize the possibility of misjudgment, which could lead to accidents, and accepting that they will reach their destination later than is theoretically possible. During the development towards autonomous driving, this observation raises the question of how control algorithms of autonomous vehicles behave under consideration of uncertainties, especially since uncertainties can lead to misjudgments and thus to misbehavior, which could end in accidents.", "As baseline for our study of the before mentioned question, we used the LongiControl environment for OpenAI\u2019s Gym [1], which offers an easily accessible possibility to train agents through Reinforcement Learning (RL). We will summarize the key facts about LongiControl in the following paragraph, but you can find further information in our first article here or the published paper here. Furthermore, you can try out LongiControl by yourself, the source code is available at GitHub here.", "Key Facts In the LongiControl environment, it is the aim that a vehicle completes a single-lane route in a given time as energy-efficient as possible without causing accidents. In summary, this corresponds to the minimization of the total energy E used in the interval from t\u2080 to T as a function of the power P:", "According to external requirements, such as other road users or speed limits, the following boundary conditions must be met at the same time:", "Where v is the velocity, a is the acceleration and a_dot is the jerk, with ()\u2097\u1d62\u2098,\u2098\u1d62\u2099 and ()\u2097\u1d62\u2098,\u2098\u2090\u2093 representing the lower and upper limits respectively. Therefore, the RL agent tries to meet all these criteria through his chosen actions, while minimizing the overall energy consumption of the vehicle.", "Not all influences occurring later in the real world application can be seen in advance. The future is not known, sensor errors occur suddenly and the smallest deviations can lead to undesired results:", "To bridge the gap between the agent behavior in the real world and autonomous driving in simulations, it is important to incorporate the non-deterministic nature of reality into your simulations. This field of research is usually known as \u201cSim to Real Transfer\u201d and if you want to learn more about it, further examples are given in [2] and [3]. A first step on this endeavor is the implementation of random noise and disturbances in the training environment of RL agents. As a result, the flowchart of the typical agent-environment interaction now looks different than usual. Both the agent\u2019s requested action and the new state of the environment are modified through randomly occurring disturbances.", "We chose to implement the following four different types of disturbances to create uncertainty in the agent\u2019s training process.", "Slip occurs in the real world through different effects, the most common are snowfall, rain and leaves on the road. In our scenario slip is important, because it influences the acceleration of the vehicle i. e. the action of the agent.", "Temporary failures of the velocity sensors are an unlikely, but possible, event usually triggered through errors in the data transmission between sensor and controller board. The environment\u2019s state vector contains the current velocity of the vehicle. Therefore, the agent\u2019s behavior is sensitive to velocity changes and needs to learn how to deal with the uncertainty regarding the current vehicle speed.", "Figure 4 shows the effect of the temporarily faulty speed signal in 3 positions. Thereby the speed value suddenly jumps to zero to afterwards display the correct one again. The vehicle continues driving at these points. Only the Reinforcement Learning Agent receives a temporarily faulty signal.", "Faulty traffic sign detection incorporates two different types of random disturbances. Firstly, the wrong detection of traffic signs, especially speed limits. A camera system could identify a given speed limit of 50 km/h as a 60 km/h. Those errors could lead an agent to wrong assumptions about his environment, which could result in an inappropriate behavior of the agent. As you can see in Figure 5, uncertainty about the upcoming speed limit leads to small alternating acceleration and deceleration phases. These are resulting from the desire to create a smooth transition between different speed zones, but the upcoming speed limit (the target value of the transition) is uncertain, therefore the transition process becomes uncertain i.e. shows random deviations.", "Secondly, the unprecise measurement of the distance until the next speed limit. The agent receives this distance through the state vector of the environment and chooses his action accordingly. The distance information is necessary to ensure a smooth transition between zones of different speed limits without overshooting the current speed limit. Through the uncertainties, the agent is not able to predict precisely how much time is left until the next speed limit becomes effective. Therefore he starts to accelerate the car to ensure a smooth transition to the next speed limit, but shortly after the acceleration the agent decides to decelerate the car to avoid a reward penalty for speeding. This cycle repeats a few times, because the agent is starting the acceleration processes to early based on uncertain (wrong) information.", "As expected the agents, which were trained in an environment with random disturbances, perform better in an uncertain environment than the standard agents, which have no experiences dealing with random events. You can see in Figure 7 and Figure 8 that the agent, which was trained with uncertainties, avoids the overshooting of the speed limits despite the noisy environment and the random deviations of is actions.", "Having an agent, which considers the effects of possible random deviations, does not mean that the agent always should act as there were disturbances. Therefore, the behavior in a certain environment without deviations is also an interesting indicator of the agent\u2019s capabilities. In Figure 9 and Figure 10, you can see the behavior of two agents in a deviation-free environment. It is obvious, that the uncertain agent is holding a safety distance to the speed limits. Through this behavior the agent gains a short time window to react, if an unexpected random deviation leads to a sudden acceleration of the car, which would otherwise result in an exceeding of the current speed limit.", "The implementation of uncertainties offers, additionally to the increased robustness of the trained agents, the possibility to change the agent\u2019s behavior without changing the structure of the reward calculation. In order to train an agent, whose behavior can be altered after the training process through the end user, it is necessary to vary the parameters of the implemented uncertainties (e. g. standard deviation or expected value) during the training. For example a larger standard deviation of the random disturbances results in a more defensive behavior, because the agent expects to counteract larger deviations. Therefore the end user changes the agent\u2019s expectations through choosing a different behavior mode. The chosen behavior mode alters a value in the environment state vector. This value influences the standard deviation and expected value of the distributions, which are used to calculate the random effects of the uncertainties. In the Figures 11, 12 and 13 you can see how the expectations of the agent are influencing the final behavior.", "At the end of this article we will summarize the most important points.", "In our first article we showed that in the proposed RL environment, which is adapted to the OpenAI Gym standardization, it is easy to prototype and implement state-of-art RL algorithms. Besides, the LongiControl environment is suitable for various examinations. In addition to the comparison of RL algorithms and the evaluation of safety algorithms, investigations in the area of Multi-Objective Reinforcement Learning are also possible. In this, our second, article we present the effects of uncertainty on the behavior of the trained agents. We show that uncertainties alone can be enough to implement an agent with varying behavior and that uncertainties can have a positive impact on the training speed of the agent. Future possible research objectives are the comparison with planning algorithms for known routes and the consideration of very long-term objectives like arriving at a specific time.", "LongiControl is designed to enable the community to leverage the latest strategies of reinforcement learning to address a real-world and high-impact problem in the field of autonomous driving.", "[1] G. Brockman and V. Cheung and L. Pettersson and J. Schneider and J. Schulman and J. Tang and W. Zaremba, OpenAI Gym (2016), CoRR", "[2] Xue BinPengu.a., Sim-to-Real Transfer of Robotic Control with Dynamics Randomization (2017), CoRR", "[3] JoshuaTobinu.a., Domain Randomization for Transferring Deep Neural Networks from Simulation to the Real World (2017), CoRR", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hi, I\u2019m Roman, an Engineer with a PhD in Automotive Engineering and a passion for Artificial Intelligence."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdc5a7e2d1c87&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://roman-liessner.medium.com/?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": ""}, {"url": "https://roman-liessner.medium.com/?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": "Roman Liessner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36baee7229dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&user=Roman+Liessner&userId=36baee7229dd&source=post_page-36baee7229dd----dc5a7e2d1c87---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc5a7e2d1c87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc5a7e2d1c87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kylejglenn?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Kyle Glenn"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/do-you-want-to-train-a-simplified-self-driving-car-with-reinforcement-learning-be1263622e9e", "anchor_text": "Do you want to train a simplified self-driving car with Reinforcement Learning?Just try our new LongiControl Environmenttowardsdatascience.com"}, {"url": "https://towardsdatascience.com/do-you-want-to-train-a-simplified-self-driving-car-with-reinforcement-learning-be1263622e9e", "anchor_text": "here"}, {"url": "https://www.researchgate.net/publication/342747549_LongiControl_A_Reinforcement_Learning_Environment_for_Longitudinal_Vehicle_Control", "anchor_text": "here"}, {"url": "https://github.com/dynamik1703/gym_longicontrol", "anchor_text": "here"}, {"url": "https://unsplash.com/@opticonor?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Conor Luddy"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@franki?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Franki Chamaki"}, {"url": "https://unsplash.com/s/photos/artificial-intelligence?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1606.01540", "anchor_text": "OpenAI Gym"}, {"url": "https://arxiv.org/pdf/1710.06537.pdf", "anchor_text": "Sim-to-Real Transfer of Robotic Control with Dynamics Randomization"}, {"url": "https://arxiv.org/pdf/1703.06907.pdf", "anchor_text": "Domain Randomization for Transferring Deep Neural Networks from Simulation to the Real World"}, {"url": "https://www.linkedin.com/in/roman-lie%C3%9Fner-56346113b/", "anchor_text": "Roman Lie\u00dfner - Dresden, Saxony, Germany | Professional Profile | LinkedInView Roman Lie\u00dfner's professional profile on LinkedIn. LinkedIn is the world's largest business network, helping\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----dc5a7e2d1c87---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/self-driving-cars?source=post_page-----dc5a7e2d1c87---------------self_driving_cars-----------------", "anchor_text": "Self Driving Cars"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----dc5a7e2d1c87---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/uncertainty?source=post_page-----dc5a7e2d1c87---------------uncertainty-----------------", "anchor_text": "Uncertainty"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dc5a7e2d1c87---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdc5a7e2d1c87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&user=Roman+Liessner&userId=36baee7229dd&source=-----dc5a7e2d1c87---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdc5a7e2d1c87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&user=Roman+Liessner&userId=36baee7229dd&source=-----dc5a7e2d1c87---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc5a7e2d1c87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdc5a7e2d1c87&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dc5a7e2d1c87---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dc5a7e2d1c87--------------------------------", "anchor_text": ""}, {"url": "https://roman-liessner.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://roman-liessner.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roman Liessner"}, {"url": "https://roman-liessner.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36baee7229dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&user=Roman+Liessner&userId=36baee7229dd&source=post_page-36baee7229dd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fae08f3ce6ed4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdear-self-driving-car-how-do-you-deal-with-uncertainties-dc5a7e2d1c87&newsletterV3=36baee7229dd&newsletterV3Id=ae08f3ce6ed4&user=Roman+Liessner&userId=36baee7229dd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}