{"url": "https://towardsdatascience.com/understanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b", "time": 1683002574.205122, "path": "towardsdatascience.com/understanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b/", "webpage": {"metadata": {"title": "Anomaly Detection in Python with Gaussian Mixture Models. | by Agasti Kishor Dukare | Towards Data Science", "h1": "Anomaly Detection in Python with Gaussian Mixture Models.", "description": "Firstly, we need to understand what counts as an anomaly in a dataset. The anomaly can be viewed as a rare or unusual observation in the dataset. For example in the case credit card transaction\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@agastidukare", "anchor_text": "Medium", "paragraph_index": 28}, {"url": "https://www.linkedin.com/in/agastidukare/", "anchor_text": "LinkedIn", "paragraph_index": 29}], "all_paragraphs": ["Firstly, we need to understand what counts as an anomaly in a dataset. The anomaly can be viewed as a rare or unusual observation in the dataset. For example in the case credit card transaction dataset, the fraudulent transactions are an anomaly as the number of fraud cases is very few as compared to normal transactions in a large dataset.", "In anomaly detection, we try to identify observations that are statistically different from the rest of the observations.", "Today we are going to look at the Gaussian Mixture Model which is the Unsupervised Clustering approach. In this approach, unlike K-Means we fit \u2018k\u2019 Gaussians to the data. Then we find the Gaussian distribution parameters like mean and Variance for each cluster and weight of a cluster. Finally, for each data point, we calculate the probabilities of belonging to each of the clusters.", "Mathematically, we can write the Gaussian model in 2 ways as follows:", "where \u03bck = mean & \u03c3k\u200b =variance for the kth component. \u03d5k= weight for the cluster \u2018k\u2019.", "where \u03bc\u200bk = mean & \u03a3k\u200b = covariance matrix for the kth component. \u03d5k= weight for the cluster \u2018k\u2019.", "Together, the equation describes a weighted average for the K Gaussian distribution.", "The algorithm train upon these K clusters. Thus given a new data point, the algorithm finds its distance from every distribution & hence the probability of that point belonging to each cluster. Therefore if for a particular cluster, if the probability is very low that\u2019s an indication of the data point being an anomaly.", "So let\u2019s get started with practical implementation.", "Firstly, we\u2019ll import all the necessary modules and create a dataset.", "Here we are using make_blobs from scikit-learn to generate Gaussian blobs for clustering. The full documentation of detailed parameters for the same can be found here:", "The output you get is a dataset with some points that are outliers from the main distribution.", "In the dataset above we can spot the outliers with our eyes but how should we make the machine do the same thing?", "This is where the Gaussian Estimator comes in the picture. As our dataset has only one center, we will be using a single Gaussian. As noted above, we will be using the first equation for which we need to calculate the mean & variance of our dataset. To do the same, I\u2019ve defined the function, which returns the mean & variance of the input distribution.", "After inputting our dataset in the above function we get,", "Now that we have our basic parameters, we will calculate for each point, the probability it being generated by our distribution. Thus the points that belong to the same cluster will have a high probability & the outliers will have low probability.", "For this, we have a function. The code I\u2019m using is the standard code. It is fairly easy to understand. We are using the Numpy linear-algebra module to implement the N(x\u2223\u03bci\u200b,\u03c3i\u200b) equation noted above.", "To visualize these probabilities, we can plot the same dataset with their probabilities as follows.", "We can see that points within the same cluster have a high probability & as we go outwards i.e. outliers, the probability tends to be near zero.", "Now we can select the threshold value for probability to mark them as the outliers. Here I\u2019m selecting it as 0.02 & plotting the data again. The value will vary depending upon the distribution & random state.", "That\u2019s great! our model performed pretty well on a single cluster. But can we use the same strategy for the multiple clusters? There\u2019s only one way to find out :)", "Here I\u2019m using the same code that I used to generate a single cluster as above. The only difference is that here instead of 1 cluster, we are generating 5.", "Now let\u2019s use the same approach that we used earlier and see how it performs. The code will be similar. Play around different values for threshold and see. Here I\u2019m going to use one fix value.", "We can see that our model performed terribly on multiple clusters. It fails to recognize the outliers. That\u2019s why now we will move to a Mixture of Gaussians. Here we have used sklearn.mixture.GaussianMixture. You can see the documentation here.", "If you follow the documentation you\u2019ll see the predict_proba() method. We will use the same method to find the probability of each point being part of any of the five clusters.", "We can see that the model classifies points into one of the K clusters & it help us to identify outlier points. We can do this by finding the points that no cluster wants to claim for itself.", "This formula returns the probability that the data point was produced at random by any of the Gaussians we fit. Hence, we would want to filter out any data point which has a low probability from the above formula.", "Give this article a clap if you find it useful, it would be of great help!!", "Follow me on Medium for more such tutorials & articles.", "If you would like to connect, add me on LinkedIn.", "If you have any queries or find any mistakes in code/concept please feel free to write in the comments. This is my first blog and attempts to share whatever I know in the realm of data science with the world!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Developer| University of Toronto"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe26e5d06094b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@agastidukare?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@agastidukare?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": "Agasti Kishor Dukare"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd09bb2f88017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=post_page-d09bb2f88017----e26e5d06094b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe26e5d06094b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe26e5d06094b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html", "anchor_text": "sklearn.datasets.make_blobs \u2014 scikit-learn 0.22 documentationscikit-learn: machine learning in Pythonscikit-learn.org"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.mixture.GaussianMixture.html#sklearn.mixture.GaussianMixture", "anchor_text": "sklearn.mixture.GaussianMixture \u2014 scikit-learn 0.22.1 documentationclass sklearn.mixture. GaussianMixture( n_components=1, covariance_type=\u2019full\u2019, tol=0.001, reg_covar=1e-06\u2026scikit-learn.org"}, {"url": "https://medium.com/@agastidukare", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/agastidukare/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e26e5d06094b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e26e5d06094b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python-for-data-science?source=post_page-----e26e5d06094b---------------python_for_data_science-----------------", "anchor_text": "Python For Data Science"}, {"url": "https://medium.com/tag/ai?source=post_page-----e26e5d06094b---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/gaussian-mixture-model?source=post_page-----e26e5d06094b---------------gaussian_mixture_model-----------------", "anchor_text": "Gaussian Mixture Model"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe26e5d06094b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=-----e26e5d06094b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe26e5d06094b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=-----e26e5d06094b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe26e5d06094b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe26e5d06094b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e26e5d06094b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e26e5d06094b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e26e5d06094b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e26e5d06094b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e26e5d06094b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@agastidukare?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@agastidukare?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Agasti Kishor Dukare"}, {"url": "https://medium.com/@agastidukare/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "111 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd09bb2f88017&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=post_page-d09bb2f88017--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb397032874c3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-anomaly-detection-in-python-using-gaussian-mixture-model-e26e5d06094b&newsletterV3=d09bb2f88017&newsletterV3Id=b397032874c3&user=Agasti+Kishor+Dukare&userId=d09bb2f88017&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}