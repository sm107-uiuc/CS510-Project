{"url": "https://towardsdatascience.com/how-to-build-a-warped-linear-regression-model-3e778e30a201", "time": 1683009060.728885, "path": "towardsdatascience.com/how-to-build-a-warped-linear-regression-model-3e778e30a201/", "webpage": {"metadata": {"title": "How to Build a Warped Linear Regression Model | by Ryan Burn | Towards Data Science", "h1": "How to Build a Warped Linear Regression Model", "description": "Ordinary Least Squares (OLS) fits a linear regression model to a dataset so as to maximize likelihood under the assumption that errors are normally distributed. Normality can come about naturally\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Ordinary_least_squares", "anchor_text": "Ordinary Least Squares", "paragraph_index": 0}, {"url": "https://github.com/rnburn/peak-engines", "anchor_text": "Peak-engines", "paragraph_index": 5}, {"url": "https://github.com/rnburn/peak-engines/blob/master/example/boston_housing.ipynb", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://papers.nips.cc/paper/2481-warped-gaussian-processes.pdf", "anchor_text": "Warped Gaussian Processes", "paragraph_index": 17}, {"url": "https://medium.com/p/what-to-do-when-your-model-has-a-non-normal-error-distribution-f7c3862e475f?source=email-f55ad0a8217--writer.postDistributed&sk=f3d494b5f5a8b593f404e7af19a2fb37", "anchor_text": "What to Do When Your Model Has a Non-Normal Error Distribution", "paragraph_index": 18}], "all_paragraphs": ["Ordinary Least Squares (OLS) fits a linear regression model to a dataset so as to maximize likelihood under the assumption that errors are normally distributed. Normality can come about naturally when error terms break down into sums of independent identically distributed components, but for many problems the assumption is unrealistic.", "Consider, for example, a regression dataset where the target values represent percentages. For a given feature vector, OLS might predict a distribution like this", "What\u2019s wrong here? The distribution shows target values could be greater than 100%. When a target space is bounded, normally distributed errors about predictions near the ends make no sense.", "If the normality assumption isn\u2019t met, we can sometimes fix the problem by transforming the target space. Suppose f is a monotonically increasing function. Let X and y denote the feature matrix and target vector. Put z = f(y). While OLS might not model the original dataset well, it\u2019s possible for it to fit X and z.", "How do we find such a function f? This is where warping helps us\u00b9. Warping starts with a family of parameterized monotonic functions. The family is general enough that it can approximate arbitrary transformations. If \u03c8 denotes the parameter vector for a warping function, then we use an optimizer to adjust \u03c8 to maximize likelihood on the training data\u00b2.", "Peak-engines is a python module for building such warped linear regression models. We\u2019ll use it to build a model for an example dataset and show how we can improve on OLS.", "The example we\u2019ll work with is the Boston Housing Dataset where the task is to predict the median value of homes from socioeconomic and geographic attributes. Like percentages, housing value is bounded (you won\u2019t find free homes) so there\u2019s reason to think the target space could benefit from warping.", "First, let\u2019s set up the dataset. Boston housing comes packaged with sklearn which make it easy to assemble.", "Before we can build the warped linear regression model, we\u2019ll need to install peak-engines", "We can then fit a warped linear regression model.", "Peak-engines searches through a space of warping functions to apply before OLS until it finds a transformation that maximizes likelihood. To visualize what the transformation looks like, we plot it across the range of target values.", "The warping function is steeper at lower housing values. It spreads points out at lower end of the target space and compresses points at the higher end.", "To compare warped linear regression to OLS, let\u2019s run a leave-one-out cross-validation. For each data point, we form a training dataset with the point removed and a test dataset including only the point. We fit both OLS and a warped linear regression model and measure performance on log likelihood.", "The results show the validation points are more likely with warped linear regression. We\u2019ll look at a few random prediction examples to get a better idea of why it does better.", "The warping function causes the probability density function to taper off at lower target values, allowing probability mass to be redistributed to areas where values are more likely.", "Code for the full example is available here.", "OLS is often the first model we reach for when faced with a regression problem, yet many datasets do not satisfy its strong assumption of normally distributed errors. Warped linear regression builds on top of OLS by introducing an additional transformation step where it warps the target space to correct for non-normality in errors. It retains much of the simplicity of OLS models but is more general and frequently leads to better performance.", "[1]: E Snelson, CE Rasmussen, Z Ghahramani. Warped Gaussian Processes. Advances in neural information processing systems 16, 337\u2013344", "[2]: What to Do When Your Model Has a Non-Normal Error Distribution", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3e778e30a201&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3e778e30a201--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3e778e30a201--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ryan.burn?source=post_page-----3e778e30a201--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.burn?source=post_page-----3e778e30a201--------------------------------", "anchor_text": "Ryan Burn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff55ad0a8217&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&user=Ryan+Burn&userId=f55ad0a8217&source=post_page-f55ad0a8217----3e778e30a201---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e778e30a201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e778e30a201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/optimization-and-ml", "anchor_text": "OPTIMIZATION AND MACHINE LEARNING"}, {"url": "https://github.com/rnburn/peak-engines", "anchor_text": "peak-engines"}, {"url": "https://en.wikipedia.org/wiki/Ordinary_least_squares", "anchor_text": "Ordinary Least Squares"}, {"url": "https://github.com/rnburn/peak-engines", "anchor_text": "Peak-engines"}, {"url": "https://github.com/rnburn/peak-engines/blob/master/example/boston_housing.ipynb", "anchor_text": "here"}, {"url": "https://papers.nips.cc/paper/2481-warped-gaussian-processes.pdf", "anchor_text": "Warped Gaussian Processes"}, {"url": "https://medium.com/p/what-to-do-when-your-model-has-a-non-normal-error-distribution-f7c3862e475f?source=email-f55ad0a8217--writer.postDistributed&sk=f3d494b5f5a8b593f404e7af19a2fb37", "anchor_text": "What to Do When Your Model Has a Non-Normal Error Distribution"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3e778e30a201---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----3e778e30a201---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/optimization-and-ml?source=post_page-----3e778e30a201---------------optimization_and_ml-----------------", "anchor_text": "Optimization And Ml"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3e778e30a201---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----3e778e30a201---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3e778e30a201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&user=Ryan+Burn&userId=f55ad0a8217&source=-----3e778e30a201---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3e778e30a201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&user=Ryan+Burn&userId=f55ad0a8217&source=-----3e778e30a201---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e778e30a201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3e778e30a201--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3e778e30a201&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3e778e30a201---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3e778e30a201--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3e778e30a201--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3e778e30a201--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3e778e30a201--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3e778e30a201--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3e778e30a201--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3e778e30a201--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3e778e30a201--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.burn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.burn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ryan Burn"}, {"url": "https://medium.com/@ryan.burn/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "94 Followers"}, {"url": "http://buildingblock.ai", "anchor_text": "buildingblock.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff55ad0a8217&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&user=Ryan+Burn&userId=f55ad0a8217&source=post_page-f55ad0a8217--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdc9aa2a87345&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-warped-linear-regression-model-3e778e30a201&newsletterV3=f55ad0a8217&newsletterV3Id=dc9aa2a87345&user=Ryan+Burn&userId=f55ad0a8217&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}