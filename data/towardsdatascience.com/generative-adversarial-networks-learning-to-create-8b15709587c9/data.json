{"url": "https://towardsdatascience.com/generative-adversarial-networks-learning-to-create-8b15709587c9", "time": 1682994803.515724, "path": "towardsdatascience.com/generative-adversarial-networks-learning-to-create-8b15709587c9/", "webpage": {"metadata": {"title": "Generative Adversarial Networks \u2014 Learning to Create | by Mahendran Venkatachalam | Towards Data Science", "h1": "Generative Adversarial Networks \u2014 Learning to Create", "description": "Let\u2019s say we have a dataset of images of bedrooms and an image classifier CNN that was trained on this dataset to tells us if a given input image is a bedroom or not. Let\u2019s say the images are of size\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "GAN paper", "paragraph_index": 2}, {"url": "https://arxiv.org/pdf/1511.06434.pdf", "anchor_text": "in this paper", "paragraph_index": 2}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "GAN paper", "paragraph_index": 11}, {"url": "https://arxiv.org/pdf/1511.06434.pdf", "anchor_text": "DCGAN paper", "paragraph_index": 17}], "all_paragraphs": ["Let\u2019s say we have a dataset of images of bedrooms and an image classifier CNN that was trained on this dataset to tells us if a given input image is a bedroom or not. Let\u2019s say the images are of size 16 * 16. Each pixel can have 256 possible values. So there is an infinitely large number of possible inputs (i.e. 256\u00b9\u2076*\u00b9\u2076 or ~10\u2076\u00b9\u2076 possible combinations). That really makes our classifier model a high dimensional probability distribution function that gives the probability of a given input from this large input space being a bedroom.", "So, if we can learn this high dimensional knowledge on data distribution of bedroom images for classification purposes, we should surely be able to leverage the same knowledge to even generate completely new bedroom images too? As it turns out, yes, we can.", "While there are multiple approaches for generative modeling, we will explore Generative Adversarial Networks in this post. The original GAN paper was published in 2014 and deep convolutional generative adversarial networks (DCGANs) was introduced in this paper and has been a popular reference since. This post is based on the study of these two papers and provides a good introduction to GANs.", "GAN is a network where two models, a generative model G and a discriminatory model D, are trained simultaneously. The generative model will be trained to produce new bedroom images by capturing the data distribution associated with the training dataset. The discriminatory model will be trained to correctly classify a given input image as real (i.e. coming from the training dataset images) or fake (i.e. synthetic image produced by the generative model). Simply put, the discriminatory model is a typical CNN image classifier model, or more specifically, a binary image classifier.", "The generative model is a bit different compared to the discriminatory model. Its goal is not classification but generation. While discriminative models spit out a vector of activations representing different classes as output given an input image, the generative model does the reverse.", "It can be thought of as a reverse CNN, in the sense that it will take a vector of random numbers as input and produce an image as output, while a normal CNN does the opposite taking an image as input and producing a vector of numbers or activations (corresponding to different classes) as output.", "But how do these different models work together? The image below gives an illustration of the network. First, we have random noise vector fed as input to the Generative model, which produces an image output. We\u2019ll call these generated images as fake images or synthetic image. Then we have the Discriminative model that takes both fake images and real images from a training data set as inputs and produces an output that classifies whether the image was a fake image or a real image.", "The training and optimization of the parameters of this network with the two models becomes a two player minimax game. The goal of the discriminative model is to maximize the correct classification of images as real vs fake. On the contrary, the goal of the generative model is to minimize the discriminator correctly classifying a fake image as fake.", "Back propagation is used to train the network parameters like a regular CNN, but the fact that there are two models with diverse goals involved makes the application of back propagation different. More specifically, the loss functions involved and the number of iterations performed on each model are two key areas where GANs differ.", "The loss function of the discriminative model will be nothing but a regular cross entropy loss function associated with a binary classifier. Depending on the input image, one or the other term in the loss function will be 0 and the result will be the negative log of the model predicted probability of the image being classified correctly. In other words, in our context, \u201cy\u201d will be \u201c1\u201d for real images and \u201c1\u2013y\u201d will be \u201c1\u201d for fake images. \u201cp\u201d is predicted probability that the image is a real image and \u201c1-p\u201d is predicted probability that the image is a fake image.", "\u201cp\u201d, the probability above, can be represented as D(x), i.e. probability as estimated by discriminator D that image \u201cx\u201d is a real image. Rewritten, it looks like below:", "Based on how we assigned context, the first part of the equation will be activated and the second part will be zero for real images. It will be vice versa for fake images. Keeping this in mind, the representation of image \u201cx\u201d in the second part can therefore be replaced by \u201cG(z)\u201d. In other words, the fake image is represented as output from model \u201cG\u201d given \u201cz\u201d as input. \u201cz\u201d is nothing but the random noise input vector to model \u201cG\u201d producing \u201cG(z)\u201d. Not worrying too much about the rest of the math notations, this is the same as the loss function for the discriminator D as presented in the GAN paper. The signs were confusing on first look, but the algorithm in the paper provided the clarity by updating the discriminator by \u201cascending\u201d its stochastic gradient, which is the same as minimizing the loss function as described above. Here\u2019s a snapshot of the function from the paper:", "Getting back to the generator G, the loss function for G would be to do the reverse, i.e. to maximize D\u2019s loss function. But the first part of the equation does not have any meaning to the generator, so what we are really saying is that the second part should be maximized. So the loss function of G will be the same as D\u2019s loss function with the sign flipped and first term ignored.", "Here\u2019s a snapshot of the generator loss function from the paper:", "I was also curious to know a bit more about the generative model\u2019s internals as it does something that\u2019s intuitively the reverse of a typical image classifying CNN. As was shown in the DCGAN paper, this is achieved through a combination of reshaping and transposed convolutions. Here\u2019s a representation of the generator from the paper:", "Transposed convolution is not the same as inverse of a convolution and does not recover the input given an output of original convolution, but rather only changes the shape. The bellow is an illustration of the math behind the Generator model above, particularly the CONV layers.", "There are some additional interesting points to note from the papers. One is the inner for loop in the algorithm proposed in the original paper. This implies, for k > 1, we are performing multiple training iterations for discriminator D for every iteration of G. This is to ensure that D\u2019s are sufficiently trained and learn more early on compared to G. We need a good D for the G to fool.", "The other relevant highlight is the issue of generator possibly memorizing input examples, which the DCGAN paper addresses by using a 3072-128-3072 de-noising dropout regularized RELU autoencoder, basically a reduce and reconstruct mechanism, to minimize memorization.", "DCGAN paper also highlights how the generator behaved when it was manipulated to forget certain objects within the bedroom image it was generating. They did so by dropping feature maps that correspond to a window from the second highest convolution layer feature set and showed how the network replaced the window space with other objects.", "Additional manipulations based on arithmetic performed on the noise vector \u201cZ\u201d given as input to the generator was also demonstrated. Like when a vector that produced a \u201cNeutral Woman\u201d was subtracted from the vector for \u201cSmiling Woman\u201d and the result added to a \u201cNeutral Man\u201d vector, the resultant vector generated a \u201cSmiling Man\u201d image, putting into perspective the relationship between the input and output spaces and the probability distribution mapping happening between the two.", "While there are other variants of the algorithms and loss functions seen above, this hopefully provided a reasonable introduction to this fascinating topic.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8b15709587c9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8b15709587c9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8b15709587c9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mahendran.venkatachalam?source=post_page-----8b15709587c9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mahendran.venkatachalam?source=post_page-----8b15709587c9--------------------------------", "anchor_text": "Mahendran Venkatachalam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4d2735a047ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&user=Mahendran+Venkatachalam&userId=4d2735a047ae&source=post_page-4d2735a047ae----8b15709587c9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b15709587c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b15709587c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "GAN paper"}, {"url": "https://arxiv.org/pdf/1511.06434.pdf", "anchor_text": "in this paper"}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "GAN paper"}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1511.06434.pdf", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1511.06434.pdf", "anchor_text": "DCGAN paper"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8b15709587c9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8b15709587c9---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/generative-model?source=post_page-----8b15709587c9---------------generative_model-----------------", "anchor_text": "Generative Model"}, {"url": "https://medium.com/tag/generative-adversarial?source=post_page-----8b15709587c9---------------generative_adversarial-----------------", "anchor_text": "Generative Adversarial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8b15709587c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&user=Mahendran+Venkatachalam&userId=4d2735a047ae&source=-----8b15709587c9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8b15709587c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&user=Mahendran+Venkatachalam&userId=4d2735a047ae&source=-----8b15709587c9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b15709587c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8b15709587c9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8b15709587c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8b15709587c9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8b15709587c9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8b15709587c9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8b15709587c9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8b15709587c9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8b15709587c9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8b15709587c9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8b15709587c9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8b15709587c9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mahendran.venkatachalam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mahendran.venkatachalam?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mahendran Venkatachalam"}, {"url": "https://medium.com/@mahendran.venkatachalam/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "296 Followers"}, {"url": "https://gotensor.com/", "anchor_text": "https://gotensor.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4d2735a047ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&user=Mahendran+Venkatachalam&userId=4d2735a047ae&source=post_page-4d2735a047ae--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb8b9125d53ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerative-adversarial-networks-learning-to-create-8b15709587c9&newsletterV3=4d2735a047ae&newsletterV3Id=b8b9125d53ec&user=Mahendran+Venkatachalam&userId=4d2735a047ae&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}