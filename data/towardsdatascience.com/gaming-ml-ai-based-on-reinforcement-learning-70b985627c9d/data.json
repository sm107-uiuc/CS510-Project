{"url": "https://towardsdatascience.com/gaming-ml-ai-based-on-reinforcement-learning-70b985627c9d", "time": 1683017584.737997, "path": "towardsdatascience.com/gaming-ml-ai-based-on-reinforcement-learning-70b985627c9d/", "webpage": {"metadata": {"title": "Gaming ML/AI-based on Reinforcement Learning | by GIOVANNI MARIOTTA | Towards Data Science", "h1": "Gaming ML/AI-based on Reinforcement Learning", "description": "Today you turn on your TV, you listen to the radio, you read a newspaper and, unbelievable\u2026 you most probably come across about machine learning and artificial intelligence. The Machine Learning\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Today you turn on your TV, you listen to the radio, you read a newspaper and, unbelievable\u2026 you most probably come across about machine learning and artificial intelligence.", "The Machine Learning approach helps humans by taking decisions to solve a problem into automatic flow identifying hidden patterns, and observing multiple state variables impossible to be detected easily by human beings.", "As it is for humans, school is the base for knowing and progressing, so the first thing that is involved in ML is training.", "Let\u2019s send ML to school and explore how these algorithms create their knowledge. ;)", "Machine Learning is a subcategory of AI. We can classify ML into three main algorithm types:", "When explaining something to someone, keep in mind one thing. It shall be funny, simple, and interesting for a child\u2026 a great challenge right? So, take a seat and enjoy what is coming because you will find cool how the reinforced learning approach is suitable to be explained by adding gamification to the topic. Yes, indeed, game!", "We explore the problem of training the behavior of a non-playable character (NPC) in a game. We simply want to create an \u201cadvanced AI ball\u201d, our agent, able to reach and touch a target surface on top of a box without leaving the game-board / floor. When the goal is achieved, the target is placed randomly on the game-board and the ball starts over its mission!", "Here the scene: a floor, a ball, and a target surface on top of the glassed box.", "In order to have a trained AI agent based on reinforcement training, it requires we go through two main phases:", "Clearly, we don\u2019t want to write any line of code to programmatically set the actions required to the ball for different use cases, which will be error-prone and, in a more complex use case, impossible to predict. Instead, we train the agent using reinforcement learning by using the Machine Learning Agents Toolkit package for Unity3D.", "As basics related to reinforcement training, we need to define three entities at every moment of the training (called environment).", "Observations \u2014 this is about what the agent perceives related to the environment. Observations can be numeric and/or visual. Numeric observations measure attributes of the environment from the point of view of the agent. Visual observations, on the other hand, are images generated from the cameras attached to the agent and represent what the agent is seeing at that point in time.", "In our use case, we observe the position (x,y,z) of the agent and the target box, together with the agent velocity vector (x,y,z component). Total of 12 variables.", "Actions \u2014 these are the actions the agent can take.", "In our case a force vector (controlSignal) is applied to the agent. One component of the force, against gravity (y-axis in Unity3D system reference), is applied only if the agent is close to the floor. This gives some constraints to AI when applies vertical forces, avoiding letting the agent fly against gravity law!", "The environment is now composed of Observed states and Actions.", "In the following snippet code, we apply the force (controlSignal) to the agent.", "Reward signals \u2014 a scalar value indicating how well the agent is doing.", "Our agent receives a large negative reward if goes outside the game-board (-1), positive if the agent touches the target (+1). Rewards are the basics for reinforcement learning, that generates the desired optimal behavior.", "Let\u2019s go more into detail about how the system, Unity3d, and Python environment, is set to perform the training phase. There are 3 main entities:", "Unity3D environment contains the view, the agent, and the environment which the agent explores acting its reinforcement learning (based on the observed state, actions, rewards).", "Python Environment contains the training framework based on Tensorflow/PyTorch. It analyses the exploration done by the agent, and generates a model, reflecting the state of the art of the learned behavior/policy..", "Communicator & PythonAPI are the links between the two systems. Data are transferred through these two entities.", "Once training concludes, the learned policy for the agent can be exported as a model file. Then during the so-called inference phase, the agent still continues to generate their observations, but instead of being sent to the Python API, they will be fed into their (internal, embedded) model to generate the optimal action for each agent to take at every point in time.", "The training phase learns the optimal policy through guided trials, and in the inference phase, the agent observes and tales actions in the wild using its learned policy.", "Now that the minimum background information is in place, let\u2019s put our hands-on training an agent. Let\u2019s begin the Training Phase.", "Our agent is a ball which by experience and exploration will gain a negative reward when touches outside the game-board, but the positive reward when goes on top of the target box. When the agent gains a positive or negative reward, the \u201cepisode\u201d ends, and the target is placed randomly on the floor. The new episode for the agent starts over.", "It is curious to take a look at how the exploration goes when the training starts. Here it is\u2026. we notice that the episodes are really short because the agent is still a \u201cnewbie\u201d. It goes very very often out of the game-board with very strong applied actions.", "As you can predict from this, it will take some time before to train well the agent and have a policy going towards the expected behavior. In order to speed up the training phase, we can create multiple game-board with independent agents. Their experience contributes to update and build up a global model, and define the behavior enforced by the rewarded system.", "This is the reason why can be extended to federated learning, duplicating the learning \u201cgame-board\u201d with independent agents.", "Using tensor dashboard we are able to read statistics about the progress done during the training.", "Cumulative Reward and Episode Length Charts: The Cumulative Reward chart starts with a negative reward due to the fact that the agents went out of the game-board, because of their inexperienced initial condition. Then they started hitting the target with long episode length, equivalent to have agents in the game-board / floor for a longer time and with lower applied forces, with more chance to discover what to touch to obtain the positive reward and learn the right behavior.", "After almost 6M of iterations, it reaches a \u201cgood\u201d positive average cumulative reward value. I let the agent free to behave as it learned, integrating with the agent itself the model generated from the Python environment. Now the training python environment is completely disconnected from the Unity3D environment. The agent has to show what he learned.", "The results were very good. Keeping the strategy to place randomly the target, the agent follows the target and jump into it to touch it. Follow the animation below.", "I was curious to investigate and take a look at another easier use case. I simplify the use case with just an agent following the target, without vertical forces. How fast will be the training process to converge to a high accumulative reward score?", "Let\u2019s consider as variations from the previous use case:", "The tensorboard results confirmed that, since the behavior is less complex than the previous case (less input and less number of components as actions), it reaches a stable and good cumulative reward in about 200k iterations. At that point the behavior continues to improve to reach faster the target, decreasing in a substantial way the episode length.", "Here is the inference step of this use case.", "This brings really to some thoughts that becomes crucial to identify correctly the observed states, and of course, the more input and actions we provide, the more the chances for new scenarios increase which requires an exponential increase in time for training.", "This is just one technique, and just some basics, to show how machine learning is powerful in the next future. Think about the coming car with an AI driver or about the space industry which applies this to satellite stabilization problems. The opportunities are incredibly huge but\u2026 don\u2019t forget one important fact\u2026", "Humans are the most intelligent species on planet earth. And the secret behind this powerful brain is Neocortex. Neocortex gives you the power to think, act, function, remember, make ideas, dream, etc.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sw Architect \u2014 Curious about new technologies! I don\u2019t like to only watch them\u2026 I need to touch them!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F70b985627c9d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----70b985627c9d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70b985627c9d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://giovanni-mariotta.medium.com/?source=post_page-----70b985627c9d--------------------------------", "anchor_text": ""}, {"url": "https://giovanni-mariotta.medium.com/?source=post_page-----70b985627c9d--------------------------------", "anchor_text": "GIOVANNI MARIOTTA"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff48ce24c83de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&user=GIOVANNI+MARIOTTA&userId=f48ce24c83de&source=post_page-f48ce24c83de----70b985627c9d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70b985627c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70b985627c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/making-sense-of-big-data", "anchor_text": "Making Sense of Big Data"}, {"url": "https://unsplash.com/@quinoal?utm_source=medium&utm_medium=referral", "anchor_text": "Quino Al"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unity3d.com/machine-learning", "anchor_text": "https://unity3d.com/machine-learning"}, {"url": "https://www.datacamp.com/community/tutorials/machine-deep-learning?utm_source=adwords_ppc&utm_campaignid=898687156&utm_adgroupid=48947256715&utm_device=c&utm_keyword=&utm_matchtype=b&utm_network=g&utm_adpostion=&utm_creative=332602034343&utm_targetid=aud-392016246653:dsa-429603003980&utm_loc_interest_ms=&utm_loc_physical_ms=9065240&gclid=CjwKCAiAiML-BRAAEiwAuWVggqS3S4X3ib3Lsj6qNqyj8T-ndvv7E4Bd7EBdDel6vfI9bl4HiwuS7hoCBOIQAvD_BwE", "anchor_text": "https://www.datacamp.com/community/tutorials/machine-deep-learning"}, {"url": "https://blogs.unity3d.com/2020/11/20/how-eidos-montreal-created-grid-sensors-to-improve-observations-for-training-agents/?_ga=2.247191619.697597485.1607346908-1357278975.1607346908", "anchor_text": "https://blogs.unity3d.com/2020/11/20/how-eidos-montreal-created-grid-sensors-to-improve-observations-for-training-agents/"}, {"url": "https://www.ecloudvalley.com/mlintroduction/", "anchor_text": "https://www.ecloudvalley.com/mlintroduction/"}, {"url": "https://medium.com/tag/machine-learning-ai?source=post_page-----70b985627c9d---------------machine_learning_ai-----------------", "anchor_text": "Machine Learning Ai"}, {"url": "https://medium.com/tag/ai?source=post_page-----70b985627c9d---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----70b985627c9d---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/federated-learning?source=post_page-----70b985627c9d---------------federated_learning-----------------", "anchor_text": "Federated Learning"}, {"url": "https://medium.com/tag/making-sense-of-big-data?source=post_page-----70b985627c9d---------------making_sense_of_big_data-----------------", "anchor_text": "Making Sense Of Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70b985627c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&user=GIOVANNI+MARIOTTA&userId=f48ce24c83de&source=-----70b985627c9d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70b985627c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&user=GIOVANNI+MARIOTTA&userId=f48ce24c83de&source=-----70b985627c9d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F70b985627c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70b985627c9d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F70b985627c9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----70b985627c9d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----70b985627c9d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----70b985627c9d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----70b985627c9d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----70b985627c9d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----70b985627c9d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----70b985627c9d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----70b985627c9d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----70b985627c9d--------------------------------", "anchor_text": ""}, {"url": "https://giovanni-mariotta.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://giovanni-mariotta.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "GIOVANNI MARIOTTA"}, {"url": "https://giovanni-mariotta.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "16 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff48ce24c83de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&user=GIOVANNI+MARIOTTA&userId=f48ce24c83de&source=post_page-f48ce24c83de--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb47ba8787c62&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgaming-ml-ai-based-on-reinforcement-learning-70b985627c9d&newsletterV3=f48ce24c83de&newsletterV3Id=b47ba8787c62&user=GIOVANNI+MARIOTTA&userId=f48ce24c83de&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}