{"url": "https://towardsdatascience.com/neural-networks-intuitions-6-east-5892f85a097", "time": 1683002355.20325, "path": "towardsdatascience.com/neural-networks-intuitions-6-east-5892f85a097/", "webpage": {"metadata": {"title": "Neural Networks Intuitions: 6. EAST: An Efficient and Accurate Scene Text Detector \u2014 Paper Explanation | by Raghul Asokan | Towards Data Science", "h1": "Neural Networks Intuitions: 6. EAST: An Efficient and Accurate Scene Text Detector \u2014 Paper Explanation", "description": "It has been a while since I published my last article. In this sixth installment of my series \u201cNeural Networks Intuitions\u201d, I will be talking about one of the most widely used scene text detector \u2014\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1704.03155", "anchor_text": "EAST(Efficient and Accurate Scene Text Detection)", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/neural-networks-intuitions-5-anchors-and-object-detection-fc9b12120830", "anchor_text": "Neural Networks Intuitions: 5. Anchors and Object Detection", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/neural-networks-intuitions-1-balanced-cross-entropy-331995cd5033", "anchor_text": "Neural Networks Intuitions: 1.Balanced Cross Entropy", "paragraph_index": 25}], "all_paragraphs": ["It has been a while since I published my last article. In this sixth installment of my series \u201cNeural Networks Intuitions\u201d, I will be talking about one of the most widely used scene text detector \u2014 EAST(Efficient and Accurate Scene Text Detection) and as the name suggests it is not just accurate but much more efficient in comparison with its text detector counterparts.", "Firstly, let us look at the problem of Scene Text Detection in general and then dive deep into the working of EAST :-)", "Problem: The problem as already mentioned above, is to detect text in natural scene images. Scene Text Detection is a special case of Object Detection where the object here boils down to a single entity \u2014 \u201ctext\u201d.", "But at what level are we detecting text?", "We can detect text either at character level or at word level. It all depends on how a text detection dataset has been annotated and how we want the network to learn. Generally, natural scene images are tagged at word level, thereby making the network learn to detect words(as well as spaces between them in order to differentiate between any two word instances).", "Solution: Since the problem here is object detection and now that we already know the fundamentals of object detection(Neural Networks Intuitions: 5. Anchors and Object Detection), we can simply use one of the existing object detectors available \u2014 say SSD, Faster-RCNN or RetinaNet. And they should pretty much do the job for us.", "But do we really need multiple anchor boxes per feature map cell? Or do we need to use the concept of anchors at all for a more specific & simpler task such as text detection?", "The reason I say text detection(or more specifically word detection) a simpler task is because:", "a. The pattern/feature of word is not that complex \u2014 especially when the language is fixed(eg. English), we have basically 26*2(lower and uppercase alphabets)+ 10(numbers).", "But we are not detecting at character level, are we? Then how is this task simple, given there can be very large number of combinations of words?", "Let us look at the next point to see the reason!", "b. If you have prior experience of working in text detection, you can see that text detectors learn to predict words of languages it is not trained on(even though not perfectly). Eg. English word detector detecting Japanese/Tamil words.", "This makes it pretty evident that the pattern learnt is not precisely the \u201clanguage words\u201d. So what is the network really learning? \u2014 It could be learning shapes occurring together in groups, separated by a defined amount of white space i.e say, a connected component.", "At least this is my intuition of what word detectors could be learning :-)", "If we pay attention to step 3, we can notice the usage of anchors, associated with a filter of size 1x1 and only one anchor box per feature map cell. This is key because it helps us to draw similarities with the traditional single-shot object detector.", "This is pretty much what EAST does \u2014 except instead of using some over-the-top logic to find text regions, it has another head \u2014 box head which will output the 4 distance values(every pixel in the feature map) to the nearest [minx, miny, maxx, maxy] boundary.", "a. Architecture: Every single shot object detector has 3 major stages involved:", "All variants of single shot detector differ in one of the above three stages. EAST as well follows the above same paradigm.", "3. The final feature volume will be then used to make score and box predictions \u2014 1x1 filter of depth=1 used to generate score map, another 1x1 filter of depth=5 is used to generate RBOX(rotated boxes) \u2014 four box offsets and rotation angle, and another 1x1 filter of depth=8 to generate QUAD(quadrangle with 8 offsets).", "Before jumping into loss functions, let us try to interpret the network output first.", "1. The class head output can be interpreted similar to the traditional detector\u2019s class output \u2014 except here there is only anchor box per feature map cell, hence the output will be of shape HxWx1 where 1 indicates the number of anchor boxes per cell.", "2. But in case of the box head, the output(of shape HxWx4) should be interpreted at a \u201cpixel\u201d level and there is no concept of anchor box. Every pixel has 4 numbers associated with it \u2014 distance to the nearest [minx, miny, maxx, maxy] box. Important thing to note here is that the final word level output is later derived from this per-pixel level output.", "We all are well aware of the class imbalance problem present in object detection datasets. The number of samples for background class is generally very high in number and now that we are treating every 1x1 box(basically every pixel) as output, the number of background samples becomes huge.", "In order to tackle this problem of class imbalance, EAST uses a modified version of cross entropy called Balanced/Weighted Cross Entropy.", "In BCE, the fraction of highly-represented class is generally multiplied with the under-represented class\u2019s loss term (and similarly for the highly-represented class\u2019s loss term) in order to control the contribution of high and under-represented classes. Note: background class:=highly-represented and foreground class:=under-represented.", "Check this blog for a detailed explanation of BCE (Neural Networks Intuitions: 1.Balanced Cross Entropy).", "c2. IOU Loss: IOU loss used here is different from the traditional bounding-box loss.", "Every pixel will have 4 numbers associated with it \u2014 distance to the nearest top, left, bottom, right box boundaries, from which IOU is computed and then negative log likelihood is used as the loss which penalizes when IOU is less than 1.", "It is pretty evident that the width and height of gt/pred box can be computed by simply summing their x and y-offsets, from which the gt and pred box area is obtained.", "To find width and height of the intersected rectangle,", "Now that we have area of gt box, area of predicted box and area of intersected box, we can compute IOU!", "The total loss is written as,", "In my upcoming post(edit to this same post), I will be explaining about EAST post processing on how bounding boxes are computed from the network\u2019s output for the sake of completeness.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Director of AI R&D at Infilect"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5892f85a097&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5892f85a097--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5892f85a097--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://raghul-719.medium.com/?source=post_page-----5892f85a097--------------------------------", "anchor_text": ""}, {"url": "https://raghul-719.medium.com/?source=post_page-----5892f85a097--------------------------------", "anchor_text": "Raghul Asokan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe3b61249ec9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&user=Raghul+Asokan&userId=e3b61249ec9&source=post_page-e3b61249ec9----5892f85a097---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5892f85a097&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5892f85a097&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1704.03155", "anchor_text": "EAST(Efficient and Accurate Scene Text Detection)"}, {"url": "https://towardsdatascience.com/neural-networks-intuitions-5-anchors-and-object-detection-fc9b12120830", "anchor_text": "Neural Networks Intuitions: 5. Anchors and Object Detection"}, {"url": "https://towardsdatascience.com/neural-networks-intuitions-1-balanced-cross-entropy-331995cd5033", "anchor_text": "Neural Networks Intuitions: 1.Balanced Cross Entropy"}, {"url": "https://arxiv.org/abs/1704.03155", "anchor_text": "https://arxiv.org/abs/1704.03155"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5892f85a097---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----5892f85a097---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/text-detection?source=post_page-----5892f85a097---------------text_detection-----------------", "anchor_text": "Text Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----5892f85a097---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----5892f85a097---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5892f85a097&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&user=Raghul+Asokan&userId=e3b61249ec9&source=-----5892f85a097---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5892f85a097&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&user=Raghul+Asokan&userId=e3b61249ec9&source=-----5892f85a097---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5892f85a097&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5892f85a097--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5892f85a097&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5892f85a097---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5892f85a097--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5892f85a097--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5892f85a097--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5892f85a097--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5892f85a097--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5892f85a097--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5892f85a097--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5892f85a097--------------------------------", "anchor_text": ""}, {"url": "https://raghul-719.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://raghul-719.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Raghul Asokan"}, {"url": "https://raghul-719.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "330 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe3b61249ec9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&user=Raghul+Asokan&userId=e3b61249ec9&source=post_page-e3b61249ec9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb225bcb64cc2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-networks-intuitions-6-east-5892f85a097&newsletterV3=e3b61249ec9&newsletterV3Id=b225bcb64cc2&user=Raghul+Asokan&userId=e3b61249ec9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}