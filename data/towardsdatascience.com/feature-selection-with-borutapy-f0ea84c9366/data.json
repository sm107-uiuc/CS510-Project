{"url": "https://towardsdatascience.com/feature-selection-with-borutapy-f0ea84c9366", "time": 1683010422.648522, "path": "towardsdatascience.com/feature-selection-with-borutapy-f0ea84c9366/", "webpage": {"metadata": {"title": "Feature Selection With BorutaPy. This post will serve as a tutorial on\u2026 | by Jason Wong | Towards Data Science", "h1": "Feature Selection With BorutaPy", "description": "This post will serve as a tutorial on how to implement BorutaPy when performing feature selection for a predictive classification model. I will go through some strengths as well as a few weaknesses\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.drivendata.org/competitions/7/data/", "anchor_text": "here", "paragraph_index": 4}], "all_paragraphs": ["This post will serve as a tutorial on how to implement BorutaPy when performing feature selection for a predictive classification model. I will go through some strengths as well as a few weaknesses when choosing to go with BorutaPy. I will be using the Tanzania well classification dataset to try and build a classification model to predict if a well is functional, functional but in need of repair, or not functional.", "Feature selection is one of the most important steps in machine learning. When inputting features into a model, the goal is to feed the model with features that are relevant for predicting a class. Including irrelevant features poses the problem of unnecessary noise in the data, resulting in lower model accuracy. Generally, we use statistical-based feature selection methods such as ANOVA or the Chi-squared test, evaluating the relationship between each predictor variable with the target variable.", "\u201cBoruta is an all relevant feature selection method, while most other are minimal optimal; this means it tries to find all features carrying information usable for prediction, rather than finding a possibly compact subset of features on which some classifier has a minimal error.\u201d -Miron B. Kursa", "With boruta, the features are curating down to the \u2018all relevant\u2019 stopping point and not the \u2018minimal optimal\u2019 stopping point. An all relevant variable being not redundant when used for prediction. Boruta is based on two ideas, shadow features and binomial distribution. When using boruta, the features are not evaluated with themselves but with a randomized version of them. For the binomial distribution idea, boruta takes a feature that we aren\u2019t aware of being useful or not and either refuses or accepts the feature based on three areas defined by selecting the tails of the distribution, 0.5 percent for an example.", "For an example, I will build a ternary classification model to be used with the Tanzanian Water Well Data. This classifier will predict the status of the water well, the dataset can be retrieved here. I will start by going through how I processed the data for the model.", "To install BorutaPy run the following code in your notebook or terminal. The dependencies for Boruta are numpy, scipy, and scikit-learn.", "Checking for any missing values in the dataset", "Around 69 percent of the values in the permit field are true and 31 percent are false. I also chose to fill in the missing values with the same ratio. I also need to convert the values to be numerical.", "The public meeting field holds 91 percent True and 9 percent False. I chose to fill the missing values with the same ratio. I also need to change the values to be numerical.", "The funder column shows who funded the well. There are 1,897 different outcomes but it looks like only the top 7 fields have values that occur more over a thousand times. I\u2019m going to divide this column into 7 different categories with these, the rest of the fields will be categorized as \u2018other\u2019.", "Binning the installer field into 7 categories", "Binning the scheme management field into 7 categories", "It looks like the construction year field will be pretty hard for our model to categorize since we have 55 different construction years in the dataset. I am going to try binning these years into decades.", "I chose to drop the fields that had values similar to another and the fields holding values that I could not find enough information relevant for the predictive model. The dropped features could hold important information, I\u2019d recommend taking a closer look into the data. I\u2019m going to move forward without them for the purpose of this example.", "I encoded the categorical features with one Sklearn\u2019s hot encoder and scaled the continuous features Sklearn\u2019s standard scaler.", "For this example, I chose to use random forest classifier, an ensemble tree-based learning algorithm. It is a set of decision trees created with a randomly selected subset of the training data. The random forest classifier then aggregates the votes from different decision trees to choose the final class of the test object. This first run with the random forest classifier will include all of the features then I will run BorutaPy.", "This resulted with a test score (mean accuracy) of 80% and a training score of 96%, now I will run the features through BorutaPy and see which ones are selected as relevant.", "By using these selected features and tuning the hyperparameter max_depth to 6, we get improved scores.", "This second run with only the selected features results in a testing score of 80 percent and a training score of 81 percent. Definitely an improvement from our first iteration with a testing score of 80 percent and a training score of 96 percent. We are minimizing the gap between the testing and training scores (model is becoming less overfit).", "Boruta is powerful feature selection algorithm which you can implement across most datasets. It can be super helpful in a time crunch as well as datasets containing a large amount of weakly correlated predictor variables. The main disadvantage is the computation time, while a lot of algorithms can be executed in seconds or milliseconds, boruta\u2019s execution time is measured in hours. This can make it extremely difficult to adjust the parameters as each tune will require significant additional time. Boruta may not be the best option for the dataset you\u2019re working with and I\u2019d recommend testing other algorithms as well and comparing the results.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist with a passion for statistical analysis and machine learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff0ea84c9366&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jwong853.medium.com/?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": ""}, {"url": "https://jwong853.medium.com/?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": "Jason Wong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe1240e6b56e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&user=Jason+Wong&userId=e1240e6b56e3&source=post_page-e1240e6b56e3----f0ea84c9366---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff0ea84c9366&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff0ea84c9366&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=945396", "anchor_text": "Free-Photos"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=945396", "anchor_text": "Pixabay"}, {"url": "https://www.drivendata.org/competitions/7/data/", "anchor_text": "here"}, {"url": "https://github.com/scikit-learn-contrib/boruta_py", "anchor_text": "here"}, {"url": "https://medium.com/@indreshbhattacharyya/feature-selection-categorical-feature-selection-boruta-light-gbm-chi-square-bf47e94e2558", "anchor_text": "https://medium.com/@indreshbhattacharyya/feature-selection-categorical-feature-selection-boruta-light-gbm-chi-square-bf47e94e2558"}, {"url": "http://danielhomola.com/2015/05/08/borutapy-an-all-relevant-feature-selection-method/", "anchor_text": "http://danielhomola.com/2015/05/08/borutapy-an-all-relevant-feature-selection-method/"}, {"url": "https://pypi.org/project/Boruta/", "anchor_text": "https://pypi.org/project/Boruta/"}, {"url": "https://medium.com/tag/feature-selection?source=post_page-----f0ea84c9366---------------feature_selection-----------------", "anchor_text": "Feature Selection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f0ea84c9366---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/boruta?source=post_page-----f0ea84c9366---------------boruta-----------------", "anchor_text": "Boruta"}, {"url": "https://medium.com/tag/classification-algorithms?source=post_page-----f0ea84c9366---------------classification_algorithms-----------------", "anchor_text": "Classification Algorithms"}, {"url": "https://medium.com/tag/multiclass-classification?source=post_page-----f0ea84c9366---------------multiclass_classification-----------------", "anchor_text": "Multiclass Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff0ea84c9366&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&user=Jason+Wong&userId=e1240e6b56e3&source=-----f0ea84c9366---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff0ea84c9366&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&user=Jason+Wong&userId=e1240e6b56e3&source=-----f0ea84c9366---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff0ea84c9366&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff0ea84c9366&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f0ea84c9366---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f0ea84c9366--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f0ea84c9366--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f0ea84c9366--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f0ea84c9366--------------------------------", "anchor_text": ""}, {"url": "https://jwong853.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jwong853.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jason Wong"}, {"url": "https://jwong853.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "199 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe1240e6b56e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&user=Jason+Wong&userId=e1240e6b56e3&source=post_page-e1240e6b56e3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdec1d5eb8281&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-selection-with-borutapy-f0ea84c9366&newsletterV3=e1240e6b56e3&newsletterV3Id=dec1d5eb8281&user=Jason+Wong&userId=e1240e6b56e3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}