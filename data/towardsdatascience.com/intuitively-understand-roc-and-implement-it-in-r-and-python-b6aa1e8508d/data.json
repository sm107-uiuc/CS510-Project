{"url": "https://towardsdatascience.com/intuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d", "time": 1683017518.204772, "path": "towardsdatascience.com/intuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d/", "webpage": {"metadata": {"title": "Intuitively understand ROC and implement it in R and Python | by Ahmar Shah, PhD (Oxford) | Towards Data Science", "h1": "Intuitively understand ROC and implement it in R and Python", "description": "The field of machine learning can broadly be categorised into supervised learning, unsupervised learning, and reinforcement learning. Supervised learning uses previous examples with known outputs to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://rviews.rstudio.com/2019/01/17/roc-curves/", "anchor_text": "ROC", "paragraph_index": 31}], "all_paragraphs": ["The field of machine learning can broadly be categorised into supervised learning, unsupervised learning, and reinforcement learning. Supervised learning uses previous examples with known outputs to determine an appropriate mathematical function to solve a classification or a regression problem. This post focusses on ROC (Receiver Operating Characteristics) curve that is widely used in the machine learning community to assess the performance of a classification algorithm. This post will help you intuitively understand what an ROC curve is and help you implement it in both R and Python. Specifically, the objectives of this post are:", "(i) To provide you with an intuitive sense of what an ROC curve means and how to interpret it", "(ii) To help you understand how to choose the threshold for ROC", "(iii) To help you understand related advanced topics (multiclass classification, ROC-associated terms such as precision, recall, accuracy etc.)", "(iv) To help you implement ROC curve analysis in R and Python", "This article is divided into four parts, each dealing with an objective stated above. I recommend reading in sequence (so if you are interested in understanding how to set the threshold, I would recommend reading Part 1 first so that you understand the terminology used).", "The scenario (a Covid-19 case study): To set the stage, let us think of a case study related to the current Covid-19 pandemic. A major challenge faced by countries around the world is testing people to check if they have Covid-19. The current testing method (PCR) is slow, expensive and it has been a challenge to scale it up for many countries due to capacity constraints. Imagine that you are the CEO of a new company who has invented a fast, portable, easy to use, and cheap device that can determine if a person has Covid-19. Before the device can be rolled out, you need to show how well the device will work in practice and how it compares with other potential competitors. ROC is a great tool that can help you assess how well your device is doing and how it would compare with other devices. Let us imagine that the device outputs a probability of someone getting seriously sick after getting Covid-19. Let\u2019s also suppose that you have 100 patients on whom you want to assess this device, 50 of them are Covid-19 positive (called the positive group henceforth) and 50 of them do not have the disease (called the negative group henceforth). If the device you built was perfect, then it would output a probability of 1 for anyone who was positive(1 means that you are certain of an event happening), and it would output a probability of 0 for anyone who was negative (in probability, 0 means that you are certain that the event did not happen). Graphically, it would look like shown in Figure 1.", "However, like most things in life, most cases would have a certain level of ambiguity and the device is likely to output a score which looks like a distribution below (Figure 2).", "Now where would you set the threshold to decide whether someone is Covid-19 positive or not? This is where ROC comes into play. A na\u00efve assumption might be to set the probability to 0.5 which will almost never be the case in real-life and you would instead carry out actual studies to determine the appropriate threshold. So how does thresholding work? You set a threshold, and anything below threshold is considered to not have disease (negative) and anything above threshold is considered to have the disease (positive). Let us start by thinking about two extreme examples:Put threshold to left-most extreme (that means you say that everyone is Covid-19 positive). If you do that, you will correctly identify all the 50 subjects in the positive group (correctly consider them to have the disease), but you will also incorrectly classify all those in the negative group (incorrectly consider them to have the disease). This situation is depicted graphically below (Figure 3).", "Let us think of the other extreme case, where you set the threshold at 1. Now, you will say that nobody is Covid-19 positive and hence you will correctly identify the 50 subjects in the negative group to not have the disease but simultaneously, incorrectly classify all the 50 with in the positive group as not having Covid-19. This situation is depicted graphically below (Figure 4).", "Let us define two terms before going further: Sensitivity and Specificity. Sensitivity refers to the proportion of people with disease (positive cases) that your model can correctly classify. Specificity refers to the proportion of people without the disease (negative cases) that your model can correctly classify as not having the disease. Knowing these terms, you can immediately visualize that as you increase your threshold (from 0 to 1), the sensitivity will decrease from 100% to 0%. Similarly, specificity will go from 100% to 0% as the threshold is increased.", "As you can see, there is a trade-off. If you increase sensitivity, it will decrease specificity and vice versa. ROC is a tool that combines the two graphs together where you typically plot sensitivity vs (1-specificity), and each point on the ROC refers to a different combination of sensitivity/specificity associated with a specific threshold. (You cannot see the threshold set in an ROC curve, but it is implicit that each point on the ROC refers to choosing a different threshold).", "How would you calculate sensitivity and specificity for a given threshold? It should be clear from the definition of the two terms but a good way to visualize this is through a \u201cconfusion matrix\u201d. A confusion matrix is a 2x2 grid with actual cases on one grid, and predicted cases on the other grid (see Figure 6 below).", "Of all the people in the healthy group (the negative class), the ones that are classified correctly are called the \u201cTrue Negative\u201d. And those that are incorrectly classified as \u201cpositive\u201d are called False Positive. Specificity is therefore (you do not need to ever memorize this, if you understand the concept, you will simply work it out):", "Similarly, of all the people in the disease group (the positive group), the ones that are classified correctly are called \u201cTrue Positive\u201d and those that are incorrectly classified as \u201cnegative\u201d are called \u201cFalse Negative\u201d. Sensitivity is therefore:", "An ideal test will give you the perfect separation between the scores associated with the negative cases and positive cases and the ROC will look like below (Figure 7).", "A test that is not good at all will have both distributions completely overlapping and the ROC will look like the following (Figure 8).", "For anything that is between the two extremes (and the most realistic scenario), the ROC will be somewhere between the two. It should be intuitively clear that the closer an ROC is to the ideal, the better the test (and similarly, the closer an ROC graph is to the random classifier, the worse the model). It should therefore also be clear that when you are comparing two classifiers, the one that is closer to the ideal scenario would be better. The way that we quantify this performance of any ROC is (very intuitively) the area under the curve. For a random classifier, it is just half of the total possible area (so it would be 0.5). For an ideal classifier, it is 1. And for any realistic classifier, it will be between 0.5 and 1.", "A valid question that is often asked and the answer is that it is context dependent. The na\u00efve approach is to select the threshold that corresponds to the point closest to the top left point on an ROC. Conceptually, that is assuming that the cost of making either kind of mistake (FN or FP) is equal. However, in real-life problems, the cost of making one mistake might be more profound than the other and it is context dependent. For example, imagine you have a classifier that assesses if a jet engine malfunctions (you really do not want to have a jet with a malfunctioning engine to fly, ever!). In this case, you would absolutely always want to have a 100% sensitivity so that you do not let a plane take off at the airport if there is a chance that the engine is malfunctioning. On the other hand, the cost of incorrectly classifying as engine malfunctioning means a needless inspection of airplane engine which is, again a cost but much less than letting a plane fly with malfunctioning engine.", "Imagine a different scenario where it is less crucial to have 100% sensitivity. Suppose you own a factory where your product is automatically packaged in a box and you have a computer vision system that inspects every box packaged on a conveyor belt to ensure that boxes are correctly packaged. Sometimes the automatic packaging system is not able to package the box correctly. In those cases, you want to move the boxes aside and repackage them manually. However, you can only manually re-package a limited number of boxes and most customers might still buy a box despite imperfections in the packaging. In this case, you might choose a different threshold on the ROC that balances both sensitivity and specificity.", "The bottom line is that choosing a threshold for an ROC is context dependent, and it is a decision that will be influenced by several factors, all dependent on the situation in which it is to be used.", "Before we go to code and show how to implement an ROC for a binary classifier, there are a few other topics that are worth clarifying.", "Multi-class ROC: ROC analysis is widely used for a two-class classification and historically it was used to detect signal from noise in radar applications (that is how it got its name). However, there are situations where we could have more than two classes. In such cases, one approach that could be used is a one-vs-all approach. In this case, you develop several classifiers (equal to the number of classes) where in each case, you label every other class except one as \u201cother\u201d and then assess how well your classifier is able to separate a given class compared to all the other classes. You can then subsequently repeat this procedure for the remaining classes until you have carried out this procedure for all the classes. In this case, you will get multiple ROC curves and as before, choosing a threshold would be context dependent. For AUC, a simple heuristic approach is to average the AUC across all the classifiers (but this judgement is, again, context dependent).", "Precision and Recall: In addition to sensitivity and specificity, there are additional terms when it comes to assessing the performance of an ROC curve that you may come across. Let us quickly go through them and relate it to sensitivity and specificity that you should now know very clearly.", "Both sensitivity and specificity look at the actual cases, those who are positive and those who are negative and then correct proportions of positive are summarized by sensitivity and correct proportions of negative cases are summarized by specificity.", "However, two other terms that are commonly used are precision and recall. Recall is the same as sensitivity but precision is focused on all those cases that the test has identified as positive. Of those that the test identifies as positive, how many are actually positive. Graphically, it will look like the following (Figure 12):", "Accuracy: As the name implies, this is the proportion of all cases that are correctly identified (positive or negative). Mathematically, this will be:", "Other terms: Sensitivity can also be called True positive rate, specificity as true negative rate, and precision as positive predictive value. (I think the terms should make their meaning clear)", "Implement ROC in R: Let us start by simulating test score points for both the Covid-19 positive and negative classes using the R built-in random number generator (rnorm)", "You can use ggplot2 package to plot the data points generated. For the data points generated (as shown above), I can use the following to visualise the distribution of the data points generated.", "Running the code above leads to the following figure, showing the distribution of both the positive and negative class.", "For getting the ROC, there are several R packages that you can use (check this if you are interested in exploring other packages that will help you plot ROC). In this post, we will use one of the most widely used package (ROCR) to plot the ROC.", "Implement ROC in Python: Like before, we will first generate data points corresponding to the positive and negative class using a well-known Python library (numpy). To start off, import the numpy library and set the parameters for the positive and negative classes, as shown below.", "Generate data points using the rand function from numpy now.", "Before we proceed to plot the ROC, let us visualise the distribution of the data points that we just generated. We will use the seaborn library to help us plot the distribution of the data in both the classes.", "If I execute the above, I end up getting the following figure for distribution.", "Before we proceed onto getting and plotting ROC, let us rearrange the data so that it can be used for getting the ROC. We will generate two arrays, one for labels and one for scores (see below), and use the concatenate function from numpy to help us join arrays.", "For getting the ROC, we will use the scikit-learn functions (roc_curve and auc) as shown below.", "Finally, for plotting our results, we will use matplotlib.", "Running the above results in the following ROC curve.", "Hopefully, you will now have an intuitive understanding of what an ROC curve is, how a threshold is set, the related jargon associated with ROC and how to implement it in R and Python.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Scientist (several research publications in prestigious journals such as The Lancet, Brain, Thorax, IEEE Transactions), love writing for meaning & impact\u2026"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb6aa1e8508d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ahmarshah.medium.com/?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": ""}, {"url": "https://ahmarshah.medium.com/?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": "Ahmar Shah, PhD (Oxford)"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F58425acb757a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&user=Ahmar+Shah%2C+PhD+%28Oxford%29&userId=58425acb757a&source=post_page-58425acb757a----b6aa1e8508d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6aa1e8508d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6aa1e8508d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://rviews.rstudio.com/2019/01/17/roc-curves/", "anchor_text": "ROC"}, {"url": "https://ahmarshah.medium.com/membership", "anchor_text": "Read every story from Ahmar Shah, PhD (Oxford) (and thousands of other writers on Medium)As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026ahmarshah.medium.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b6aa1e8508d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/model-evaluation?source=post_page-----b6aa1e8508d---------------model_evaluation-----------------", "anchor_text": "Model Evaluation"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----b6aa1e8508d---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----b6aa1e8508d---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b6aa1e8508d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb6aa1e8508d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&user=Ahmar+Shah%2C+PhD+%28Oxford%29&userId=58425acb757a&source=-----b6aa1e8508d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb6aa1e8508d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&user=Ahmar+Shah%2C+PhD+%28Oxford%29&userId=58425acb757a&source=-----b6aa1e8508d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb6aa1e8508d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb6aa1e8508d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b6aa1e8508d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b6aa1e8508d--------------------------------", "anchor_text": ""}, {"url": "https://ahmarshah.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ahmarshah.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ahmar Shah, PhD (Oxford)"}, {"url": "https://ahmarshah.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F58425acb757a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&user=Ahmar+Shah%2C+PhD+%28Oxford%29&userId=58425acb757a&source=post_page-58425acb757a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F36f265c8e0ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-understand-roc-and-implement-it-in-r-and-python-b6aa1e8508d&newsletterV3=58425acb757a&newsletterV3Id=36f265c8e0ed&user=Ahmar+Shah%2C+PhD+%28Oxford%29&userId=58425acb757a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}