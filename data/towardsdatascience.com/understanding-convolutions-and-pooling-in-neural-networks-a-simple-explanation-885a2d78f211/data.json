{"url": "https://towardsdatascience.com/understanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211", "time": 1683008056.0168908, "path": "towardsdatascience.com/understanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211/", "webpage": {"metadata": {"title": "Understanding Convolutions and Pooling in Neural Networks: a simple explanation | by Miguel Fern\u00e1ndez Zafra | Towards Data Science", "h1": "Understanding Convolutions and Pooling in Neural Networks: a simple explanation", "description": "Why convolutional networks work? What\u2019s the magic behind them that allows us to succeed in a broad range of applications such as image classification, object detection, face recognition, and others\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/miguelfzafra/Convolutional-Neural-Networks/blob/master/CNN_convolutions_and_pooling.ipynb", "anchor_text": "this notebook", "paragraph_index": 3}, {"url": "https://github.com/miguelfzafra/Convolutional-Neural-Networks/blob/master/CNN_convolutions_and_pooling.ipynb", "anchor_text": "here", "paragraph_index": 33}, {"url": "https://www.coursera.org/specializations/tensorflow-in-practice", "anchor_text": "TensorFlow in Practice", "paragraph_index": 36}], "all_paragraphs": ["Why convolutional networks work? What\u2019s the magic behind them that allows us to succeed in a broad range of applications such as image classification, object detection, face recognition, and others?", "It turns out that all of this is possible thanks to two astonishingly simple, yet powerful concepts: convolution and pooling.", "In this post, I will try to explain them in a really intuitive and visual way, leaving the math behind. I have found a lot of documentation in the internet with a strong mathematical foundation, but I think the core ideas are sometimes watered down through all the formulas and calculations.", "All the examples that we will cover in this post can be found in this notebook.", "The first key concept that we need to understand is the convolution operation. This is simple: we will apply a filter to an image to get a resulting image.", "As an example, let\u2019s suppose we have an input image and a filter:", "Remember that any image can be represented as a matrix of pixels, with each pixel representing a color intensity:", "What the convolution does is the following:", "This is, we are building another image by applying the filter to our input image. Note that depending on the filter we apply (its shape and values), we will get a different image.", "But, why would we want to do this? Seems that it doesn\u2019t make much sense!", "The truth is that it does makes a lot of sense. To understand why, let\u2019s get a simple image of a black and white grid.", "(Please note that this is no longer a matrix. It is in fact an image)", "And apply some filters to it:", "We can see that with that particular filter, the output image only contains the vertical edges. Let\u2019s try some more:", "In this case, we only get the horizontal lines in the output image. Another different filter allows us to emphasize the edges, regardless of the orientation:", "And, obviously, we can apply a filter that leaves the input image the same:", "This is the idea behind the filters, and now you may better understand why they are called like that: they allow us to retain some kind of information from a picture, and ignore the rest. And this is possible because of how the convolution operation works.", "But let\u2019s try with another image to see more interesting things about the filters:", "If you look closely at the result, you will see that the vertical lines are removed, but the horizontal ones are kept. But an interesting detail is that, since this image is in isometric perspective, there is not a single pure horizontal line.", "However, the convolution is able to handle the perspective and is showing the lines that are, in fact, horizontal, although the perspective doesn\u2019t show them like that.", "Finally, let\u2019s get a real world image and apply some filters to see what we get. For the sake of explanation, we will get a black and white photograph, but the intuition is almost the same for colored images.", "Let\u2019s apply some filters and see what happens:", "As we expected, we are extracting only the information we want from the image, depending on the filter we apply.", "Now that we understand how convolution works, let\u2019s introduce another idea that makes it even more powerful: pooling.", "The concept of pooling is simple:", "This is, we are going to take groups of pixels (for example, groups of 2x2 pixels) and perform an aggregation over them. One of the possible aggregations we can make is take the maximum value of the pixels in the group (this is known as Max Pooling). Another common aggregation is taking the average (Average Pooling).", "But, again, does this make sense? To answer the question, let\u2019s get one of the previous images and apply a 2x2 max pooling to it:", "This means we have been able to reduce the information the image contains (by keeping only half of the pixels), but still kept and intensified the useful features the filters show when convolving the image.", "To wrap up, I will provide an intuitive explanation on how these two ideas are built inside the convolutional neural networks. Again, I won\u2019t enter into mathematical detail, since it is out of the aim of this post.", "A basic convolutional neural network can be seen as a sequence of convolution layers and pooling layers. When the image goes through them, the important features are kept in the convolution layers, and thanks to the pooling layers, these features are intensified and kept over the network, while discarding all the information that doesn\u2019t make a difference for the task.", "These important features can go from single lines or edges (as we saw in the examples) to more complex things (such as, for example, the ears of a dog) while we are travelling through the neural network.", "And there is a slight, but crucial detail: when applying convolutions in the examples we have seen, we chose a filter and then observed the output. In practice, if, as an example, we are performing an image classification task, the network will learn which filters allow us to extract the most insightful features so as to distinguish between the classes in our training dataset.", "I have created a notebook so that you can try all these ideas for yourself. You can upload the image you want and try the effect of different filters and pools over it.", "The notebook can be found here.", "I recommend to run it on google colab so that you don\u2019t have to install all the necessary dependencies on your computer.", "After reading this post, I hope you learned the intuition on how convolutions and pooling work and why they are useful in CNNs. In the next post, we will cover in more detail how images travel through the layers of a CNN and how features are extracted in every step.", "Disclaimer: This post provides an intuition on how the convolutional neural networks work. In order to keep the explanation easy, I have omitted some concepts such as treating the different channels in color images, strides, padding, etc. These concepts are important to fully understand CNNs, so be sure to keep them in mind! In addition, this post was inspired by deeplearning.ai\u2019s TensorFlow in Practice specialization, which provides an excellent explanation on the intuition behind CNNs.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate about Finance and Data Science, and looking forward to combining these two worlds so as to take advantage of what technology can bring to us."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F885a2d78f211&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----885a2d78f211--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----885a2d78f211--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@miguelfzafra?source=post_page-----885a2d78f211--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@miguelfzafra?source=post_page-----885a2d78f211--------------------------------", "anchor_text": "Miguel Fern\u00e1ndez Zafra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32ed8c680957&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&user=Miguel+Fern%C3%A1ndez+Zafra&userId=32ed8c680957&source=post_page-32ed8c680957----885a2d78f211---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F885a2d78f211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F885a2d78f211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/Vrv_nZHaFTc", "anchor_text": "Unsplash"}, {"url": "https://github.com/miguelfzafra/Convolutional-Neural-Networks/blob/master/CNN_convolutions_and_pooling.ipynb", "anchor_text": "this notebook"}, {"url": "http://gsp.humboldt.edu/olm_2016/courses/GSP_216_Online/lesson3-1/raster-models.html", "anchor_text": "Source"}, {"url": "https://eg.bucknell.edu/~cld028/courses/379-FA19/NN/convTF-Walk-Thru.html", "anchor_text": "Source"}, {"url": "https://www.google.es/search?q=horse%20image&tbm=isch&safe=off&safe=off&tbs=rimg%3ACeQ0hnMRfGHsImAzZ9N83o2WSFHl-lelDd328rae2ZQRymNOExAeo-NQd6qSul8HLBR0ACqvZUsb_13fIuuAxnLdKJHLedLWh4TXDp-tv1KjF9eZLR71HGT7VTi22b-WQc6kQtRmnpZVHtnoqEgkzZ9N83o2WSBElI0VYG_1XfmioSCVHl-lelDd32ETQUcUW5IblYKhIJ8rae2ZQRymMRehU7EbL2BC4qEglOExAeo-NQdxGNGCMtyuORoCoSCaqSul8HLBR0ERZEIXI4CausKhIJACqvZUsb_13cRvLsLAWM1n3IqEgnIuuAxnLdKJBESqprupZwzkSoSCXLedLWh4TXDEThPVrXJ2gebKhIJp-tv1KjF9eYRyxV8Gk95JngqEglLR71HGT7VThH2bgk-WTs7uioSCS22b-WQc6kQEcXu9uBHiYfSKhIJtRmnpZVHtnoRNPgW-0vpp65hz6NI-w9E_1dg&hl=es&ved=0CB4QuIIBahcKEwiora2jgcvpAhUAAAAAHQAAAAAQDg&biw=1684&bih=826", "anchor_text": "Source"}, {"url": "https://github.com/miguelfzafra/Convolutional-Neural-Networks/blob/master/CNN_convolutions_and_pooling.ipynb", "anchor_text": "here"}, {"url": "https://www.coursera.org/specializations/tensorflow-in-practice", "anchor_text": "TensorFlow in Practice"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----885a2d78f211---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----885a2d78f211---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----885a2d78f211---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----885a2d78f211---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----885a2d78f211---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F885a2d78f211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&user=Miguel+Fern%C3%A1ndez+Zafra&userId=32ed8c680957&source=-----885a2d78f211---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F885a2d78f211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&user=Miguel+Fern%C3%A1ndez+Zafra&userId=32ed8c680957&source=-----885a2d78f211---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F885a2d78f211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----885a2d78f211--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F885a2d78f211&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----885a2d78f211---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----885a2d78f211--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----885a2d78f211--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----885a2d78f211--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----885a2d78f211--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----885a2d78f211--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----885a2d78f211--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----885a2d78f211--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----885a2d78f211--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@miguelfzafra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@miguelfzafra?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Miguel Fern\u00e1ndez Zafra"}, {"url": "https://medium.com/@miguelfzafra/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "673 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F32ed8c680957&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&user=Miguel+Fern%C3%A1ndez+Zafra&userId=32ed8c680957&source=post_page-32ed8c680957--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa032726296d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-convolutions-and-pooling-in-neural-networks-a-simple-explanation-885a2d78f211&newsletterV3=32ed8c680957&newsletterV3Id=a032726296d4&user=Miguel+Fern%C3%A1ndez+Zafra&userId=32ed8c680957&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}