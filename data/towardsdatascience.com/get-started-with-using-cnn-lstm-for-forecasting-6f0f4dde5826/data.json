{"url": "https://towardsdatascience.com/get-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826", "time": 1682995358.250082, "path": "towardsdatascience.com/get-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826/", "webpage": {"metadata": {"title": "Get Started with Using CNN+LSTM for Forecasting | by Yitong Ren | Towards Data Science", "h1": "Get Started with Using CNN+LSTM for Forecasting", "description": "Predicting the trend has been an ancient discipline yet it\u2019s never fallen from popularity. Whether it is stock price in financial market, power or energy consumption, or sales projection for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://machinelearningmastery.com/category/deep-learning-time-series/", "anchor_text": "deep learning for time series", "paragraph_index": 1}, {"url": "https://archive.ics.uci.edu/ml/machine-learning-databases/00235/", "anchor_text": "individual household electric power consumption data", "paragraph_index": 2}], "all_paragraphs": ["Predicting the trend has been an ancient discipline yet it\u2019s never fallen from popularity. Whether it is stock price in financial market, power or energy consumption, or sales projection for corporate planning, a series of time-based data points can be the representation of how the world is thinking in any given moment, which has always fascinated me. The capability to see and react ahead of time is an important factor to succeed in many aspects of life.", "Time Series model is very effective when there are clearly trend, seasonality or autocorrelation in the data. However, the real world situation is far more complex that is impacted by multiple factors including economic phenomena, media effects, competitors\u2019 behaviors, or even short-term fluctuations. These factors are manifest especially when forecasting reaches to the granular level such as hours, or minutes. LSTM (long short-term memory) is a recurrent neural network architecture that has been adopted for time series forecasting. I have been using stateful LSTM for my automated real-time prediction, as I need the model to transfer states between batches. Recently, I found adding convolutional layers to capture local, temporal pattern on top of LSTM layers can be immensely helpful in certain scenarios. In this post, I will use a simple example to demonstrate this architecture. I also strongly recommend Jason Brownlee\u2019s blog posts of deep learning for time series. I personally benefit a lot from this series.", "For this demonstration, I used the individual household electric power consumption data from UCI machine learning repository. I resampled the data over hours. In this post, I focus on the global active power attribute and disregard other variables. The data looks as below:", "In this problem, I want to use the 24 hours\u2019 power consumption from the previous day to generate the next day\u2019s 24 hours\u2019 number. The data is from 2006/12 to 2010/12. I used the first two years\u2019 data as training and the last two years\u2019 as validation. So essentially this is a sequence to sequence prediction problem.", "I used a 1D convolutional layer followed by a max pooling layer, the output is then flattened to feed into LSTM layers. The model has two hidden LSTM layers followed by a dense layer to provide the output.", "The data is first reshaped and rescaled to fit the three-dimensional input requirements of Keras sequential model. The input shape would be 24 time steps with 1 feature for a simple univariate model. Within the convolutional layer, I didn\u2019t further split the sequence into multiple subsequences but keep the timesteps to be 24 instead. And I chose the kernel size to be 3. The dense layer has 24 neurons to produce 24 output number. Below is a detailed model summary.", "As you can see, I used a batch input size of 24. This is because, in this problem, which is also the case of many real-world situations, I want to predict on a daily basis. The number of batch size needs to be divisible by 24. In the end, I fit the model for 20 epochs and output the loss. I used mean squared error loss function and Adam optimization (Adaptive Moment Estimation).", "Whether you should use RNN or CNN or hybrid models for time series forecasting really depends on the data and the problem you try to solve. I would go with a simple model if it serves the purpose and does not risk to overfit. This example aims to provide a simple guide to use CNN-LSTM structure. I believe this particular data can be fit better with a multivariate LSTM model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist, this is my notepad for math topics and a journey of self-growth, \u201cYou are not your past.\u201d"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6f0f4dde5826&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@yitong1105?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yitong1105?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": "Yitong Ren"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F634c4b3f413a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&user=Yitong+Ren&userId=634c4b3f413a&source=post_page-634c4b3f413a----6f0f4dde5826---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f0f4dde5826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f0f4dde5826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://machinelearningmastery.com/category/deep-learning-time-series/", "anchor_text": "deep learning for time series"}, {"url": "https://archive.ics.uci.edu/ml/machine-learning-databases/00235/", "anchor_text": "individual household electric power consumption data"}, {"url": "https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/", "anchor_text": "https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/"}, {"url": "https://www.business-science.io/business/2018/12/04/time-series-forecasting.html", "anchor_text": "https://www.business-science.io/business/2018/12/04/time-series-forecasting.html"}, {"url": "https://stackoverflow.com/questions/51344610/how-to-setup-1d-convolution-and-lstm-in-keras", "anchor_text": "https://stackoverflow.com/questions/51344610/how-to-setup-1d-convolution-and-lstm-in-keras"}, {"url": "https://jeddy92.github.io/JEddy92.github.io/ts_seq2seq_conv/", "anchor_text": "https://jeddy92.github.io/JEddy92.github.io/ts_seq2seq_conv/"}, {"url": "https://github.com/amirrezaeian/Individual-household-electric-power-consumption-Data-Set-/blob/master/data_e_power.ipynb", "anchor_text": "https://github.com/amirrezaeian/Individual-household-electric-power-consumption-Data-Set-/blob/master/data_e_power.ipynb"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6f0f4dde5826---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6f0f4dde5826---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----6f0f4dde5826---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/data?source=post_page-----6f0f4dde5826---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/predictions?source=post_page-----6f0f4dde5826---------------predictions-----------------", "anchor_text": "Predictions"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6f0f4dde5826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&user=Yitong+Ren&userId=634c4b3f413a&source=-----6f0f4dde5826---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6f0f4dde5826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&user=Yitong+Ren&userId=634c4b3f413a&source=-----6f0f4dde5826---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f0f4dde5826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6f0f4dde5826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6f0f4dde5826---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6f0f4dde5826--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yitong1105?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yitong1105?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yitong Ren"}, {"url": "https://medium.com/@yitong1105/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "343 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F634c4b3f413a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&user=Yitong+Ren&userId=634c4b3f413a&source=post_page-634c4b3f413a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8e28505d0c7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fget-started-with-using-cnn-lstm-for-forecasting-6f0f4dde5826&newsletterV3=634c4b3f413a&newsletterV3Id=8e28505d0c7f&user=Yitong+Ren&userId=634c4b3f413a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}