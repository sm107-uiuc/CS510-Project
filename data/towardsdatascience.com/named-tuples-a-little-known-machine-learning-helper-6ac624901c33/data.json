{"url": "https://towardsdatascience.com/named-tuples-a-little-known-machine-learning-helper-6ac624901c33", "time": 1683016927.51983, "path": "towardsdatascience.com/named-tuples-a-little-known-machine-learning-helper-6ac624901c33/", "webpage": {"metadata": {"title": "Named Tuples: A Little Known Machine Learning Helper | by Paul May | Towards Data Science", "h1": "Named Tuples: A Little Known Machine Learning Helper", "description": "Often you find that you need to store some information as you go through your machine learning pipeline. The most common ways of doing this are: Both of these have issues where a dictionary does not\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@meghamohan/mutable-and-immutable-side-of-python-c2145cf72747", "anchor_text": "mutable", "paragraph_index": 2}, {"url": "https://www.quora.com/Can-a-list-be-declared-inside-a-tuple-in-Python-if-so-what-is-the-result-of-the-same", "anchor_text": "internal list", "paragraph_index": 3}, {"url": "https://www.goodreads.com/quotes/835238-indeed-the-ratio-of-time-spent-reading-versus-writing-is#:~:text=%E2%80%9CIndeed%2C%20the%20ratio%20of%20time%20spent%20reading%20versus%20writing%20is,makes%20it%20easier%20to%20write.%E2%80%9D", "anchor_text": "with some quoting 10 times as much", "paragraph_index": 4}], "all_paragraphs": ["Often you find that you need to store some information as you go through your machine learning pipeline. The most common ways of doing this are:", "Both of these have issues where a dictionary does not store order and also you must get the keys right and for a list, you must know what index you need to access. So in these cases, both have issues with readability in that you need to know what goes where. True, you could assign all the keys to a dictionary when you create it, but often we add as we go, so for a reader starting earlier on you might not realise several more values are added later.", "They also suffer from being mutable. This means that you can change values as you go. You could use a tuple to make things immutable, but you end up with it being harder to understand as you access elements by their index like lists.", "This is where named tuples come in. They offer the ability to access items with a name or an index. They are also immutable so you can have peace of mind that as things travel along your pipeline they are not being ignored or modified. Well unless you assign an internal list (which means the tuple is storing the reference to the list so you can change the list), but let\u2019s not go there here.", "Oh and the part about using a dictionary and adding keys as you go? Well, you would need to define the whole structure here for a named tuple. But then again if you are adding to a data structure as it passes along a pipeline then you probably are not making your code that readable for others and should consider not doing that. Besides you can always use these named tuples to return data from functions in a nice easier to understand and usable way as well to increase readability. This is important as you will find that you are reading code more often than writing it (with some quoting 10 times as much) and in a large data science team there is nothing worse than inheriting someone else\u2019s code and having no idea why things are being passed around to functions.", "I will explain a bit more about named tuples later and include a machine learning example where I have used them, but let us look at some code to get a better idea of what we are dealing with here.", "We have now created our first name tuple. In the first part, we have called it \u201cmyfirsttuple\u201d. You will notice that this name matches the name of the variable we assign the result of \u201cnamedtuple\u201d to. This should match and is a common error people encounter when they change something, and these do not match which causes errors later.", "\u201cfirst second last\u201d defines the three values we want to store inside the named tuple alongside the names to give them. You can define these with whitespace separation (as I have done), or you can give it a list. Like this:", "Either way you decide to define your named tuple you can create an instance simply like this:", "The name \u201cinstance\u201d is completely arbitrary, but you will see that to create it we assigned values to each of the three names we defined earlier. We can assign whatever we like to these, can be float, integer, a list, dictionary, machine learning model etc.", "We can now access these values like you would with a normal tuple:", "We can also access it via name by using a \u201c.\u201d:", "Well I am glad you asked. As I mentioned earlier you could use a list, tuple, dictionary etc. to store your information in but a named tuple has several benefits that are useful:", "Some people argue they are also more elegant/beautiful/readable than other solutions too, but I leave that to you to decide.", "Simply put they allow you to provide a nice bit of code that allows anyone reading you code to see what data structures you are making and passing around. The naming convention is useful because you have to get the spelling right to use it as anyone who\u2019s written a typo in a dictionary has found out as it just creates a new misspelt key that is ignored by everything that is using the correct key name containing the old value. Or so I have heard\u2026", "The immutable part can also be very useful if you are passing variables around and you want to be secure in the knowledge no one\u2019s messing with them (though I would caveat you can work around this as you may have found if you\u2019ve ever altered elements of a list contained within a tuple).", "I suppose it might help to have an example really of it in action.", "For example, I was developing an algorithm using time series data. The performance depended on knowing past data, so I could not just ignore all the past entries whenever I needed to make an inference. However, I found that taking aggregations for the last few seconds worked better than creating custom lagged features.", "The problem was that I didn\u2019t know the correct aggregation to use until more data arrived for training, so I had to leave the training pipeline flexible to how much time aggregation to use, but also potentially in what features my models would use. Can you see the problem I had?", "I worked around this by using named tuples to pass these variables around as required. I also used named tuples with my models as I could access the model under the name \u201cmodel\u201d, I could look up the creation time, columns used, performance found in cross-validation during training, time aggregation etc. I had a compact portable way for anyone loading my model to see what I had created and how (and for my inference code running on deployment hardware to know this too). That is if you save it right.", "So, you can pickle a named tuple. The best way is to define your named tuple the same in both the code that contains the pickling and in the code that unpickles. But if you do not know what that will look like you can use the other key part that I mentioned earlier and just convert you named tuple to a dictionary and pickle that.", "As you can see, I have created a dummy model and saved the training data to it. While you might not want to do this, you might in an environment with changing data. For example, knowing the rows that a model was trained on identifies what rows are available for testing the performance, but also you can train models on the same rows to see if you are improving them and not just observing the variability of data on the accuracy.", "The other part I did was convert it to a dictionary. I wrapped it in dict() because if you run a type on the \u201cout_model\u201d it returns \u201cOrderedDict\u201d. By pushing it through dict() we will get a true dictionary (at least when we check type).", "To return our model we can run the following:", "We have now re-created a named tuple we can re-use. As I said before if we know the named tuple structure, we can just define it in our loading code and we return it without needing to convert to dictionary and back again:", "Voila! I have saved and retrieved a model that I have attached extra details to it. I could have done it purely with a dictionary (or load it alongside a csv file), but this way the details are attached and immutable.", "For my example, I could use this to load a model and have the inference system now how it needs to pre-treat data before we can make predictions with it (changing the settings as I tweak the models to improve performance).", "In this tutorial, I have talked a little about why named tuples can be helpful within data science and about how you can use them alongside some code.", "I have also shown that you can store them and carry them over to other code if you so desire.", "That is all for now and I hope to talk to you all soon!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, Astrophysics PhD, reliability engineer and part time writer. I love exploring the world of science and how it shapes the world we live in."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6ac624901c33&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6ac624901c33--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6ac624901c33--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Carnivalius?source=post_page-----6ac624901c33--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Carnivalius?source=post_page-----6ac624901c33--------------------------------", "anchor_text": "Paul May"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F554601a151c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&user=Paul+May&userId=554601a151c6&source=post_page-554601a151c6----6ac624901c33---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ac624901c33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ac624901c33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@glenncarstenspeters?utm_source=medium&utm_medium=referral", "anchor_text": "Glenn Carstens-Peters"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@meghamohan/mutable-and-immutable-side-of-python-c2145cf72747", "anchor_text": "mutable"}, {"url": "https://www.quora.com/Can-a-list-be-declared-inside-a-tuple-in-Python-if-so-what-is-the-result-of-the-same", "anchor_text": "internal list"}, {"url": "https://www.goodreads.com/quotes/835238-indeed-the-ratio-of-time-spent-reading-versus-writing-is#:~:text=%E2%80%9CIndeed%2C%20the%20ratio%20of%20time%20spent%20reading%20versus%20writing%20is,makes%20it%20easier%20to%20write.%E2%80%9D", "anchor_text": "with some quoting 10 times as much"}, {"url": "https://unsplash.com/@evan__bray?utm_source=medium&utm_medium=referral", "anchor_text": "Evan Dennis"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6ac624901c33---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6ac624901c33---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pipeline?source=post_page-----6ac624901c33---------------pipeline-----------------", "anchor_text": "Pipeline"}, {"url": "https://medium.com/tag/namedtuple?source=post_page-----6ac624901c33---------------namedtuple-----------------", "anchor_text": "Namedtuple"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6ac624901c33---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6ac624901c33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&user=Paul+May&userId=554601a151c6&source=-----6ac624901c33---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6ac624901c33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&user=Paul+May&userId=554601a151c6&source=-----6ac624901c33---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6ac624901c33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6ac624901c33--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6ac624901c33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6ac624901c33---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6ac624901c33--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6ac624901c33--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6ac624901c33--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6ac624901c33--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6ac624901c33--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6ac624901c33--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6ac624901c33--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6ac624901c33--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Carnivalius?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Carnivalius?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Paul May"}, {"url": "https://medium.com/@Carnivalius/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "252 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F554601a151c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&user=Paul+May&userId=554601a151c6&source=post_page-554601a151c6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F95eb90286fc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnamed-tuples-a-little-known-machine-learning-helper-6ac624901c33&newsletterV3=554601a151c6&newsletterV3Id=95eb90286fc0&user=Paul+May&userId=554601a151c6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}