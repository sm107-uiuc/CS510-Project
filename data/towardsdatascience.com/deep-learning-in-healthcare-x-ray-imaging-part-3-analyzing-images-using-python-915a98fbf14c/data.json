{"url": "https://towardsdatascience.com/deep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c", "time": 1683008831.364023, "path": "towardsdatascience.com/deep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c/", "webpage": {"metadata": {"title": "Deep Learning in Healthcare \u2014 X-Ray Imaging (Part 3-Analyzing images using Python) | by Arjun Sarkar | Towards Data Science", "h1": "Deep Learning in Healthcare \u2014 X-Ray Imaging (Part 3-Analyzing images using Python)", "description": "Now that we have seen how difficult it is for an untrained professional to interpret X-ray images, lets\u2019 look at a few techniques to view and analyze the images, their histograms, and a technique to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia/data", "anchor_text": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia/data", "paragraph_index": 1}, {"url": "https://www.linkedin.com/in/arjun-sarkar-9a051777/", "anchor_text": "https://www.linkedin.com/in/arjun-sarkar-9a051777/", "paragraph_index": 28}], "all_paragraphs": ["Now that we have seen how difficult it is for an untrained professional to interpret X-ray images, lets\u2019 look at a few techniques to view and analyze the images, their histograms, and a technique to add images and labels together, using Python programming.", "The image dataset (Chest X-Rays) was obtained from Kaggle. Dataset is available on the following link \u2014 https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia/data", "About the dataset \u2014 direct quote from the Kaggle challenge \u2014 The dataset is organized into 3 folders (train, test, val) and contains subfolders for each image category (Pneumonia/Normal). There are 5,863 X-Ray images (JPEG) and 2 categories (Pneumonia/Normal). Chest X-ray images (anterior-posterior) were selected from retrospective cohorts of pediatric patients of one to five years old from Guangzhou Women and Children\u2019s Medical Center, Guangzhou. All chest X-ray imaging was performed as part of patients\u2019 routine clinical care. For the analysis of chest x-ray images, all chest radiographs were initially screened for quality control by removing all low quality or unreadable scans. The diagnoses for the images were then graded by two expert physicians before being cleared for training the AI system. In order to account for any grading errors, the evaluation set was also checked by a third expert.", "As the content clearly states, there are a total of 5863 images available in the challenge, which have been split into 2 classes, Pneumonia and Normal, and further split into train/test and validation sets. To make the challenge even harder, we have split the data into three classes, Normal, Bacterial Pneumonia, and Viral Pneumonia. In this part, we will focus only on the images \u2014 loading them with python, analyzing various important aspects of the image from a medical imaging perspective, and loading the images and labels together. Let's dive straight into it.", "Numpy \u2014 Numpy is one of the most commonly used libraries in Python. It is used for operations on multi-dimensional arrays and matrices and doing high-level mathematical functions to operate on these arrays.", "Matplotlib \u2014 A library for creating static and animated visualizations in python.", "os \u2014A module that comes built-in with python. It provides functions for interacting with the operating system.", "cv2 \u2014 OpenCV (Open Source Computer Vision Library) \u2014 A very important library mainly used for computer vision. Other similar libraries are SimpleITK and Pillow (Python Imaging Library).", "random \u2014 A module that generates pseudo-random numbers.", "The images from the dataset have been split into three classes as mentioned previously. 1-Normal, 2-Bacteria (Bacterial Pneumonia), 3- Virus (Viral Pneumonia).", "The above code snippet is creating a function load_image, which will be used to load a single image from the training sets, Bacteria folder. os.listdir is used to list all the files present inside that directory. In this case, it can be used to access all the images present inside the folder Bacteria. Next, it will print the name of the image. Finally, the OpenCV library is used to read the image.", "Break- is necessary here, so that only the first image is accessed, otherwise the function will loop through all the images present inside the Bacteria folder.", "In this code snippet, first, the path of the images is defined. Then the first image from the folder is loaded into variable \u2018image\u2019 by calling the function load_image. The image is then viewed by using matplotlib.imshow. After this, the dimensions of the image, the maximum pixel value, and the minimum pixel value in the grayscale bar is printed. Also the mean and standard deviation of the image pixels are calculated.", "Next, we plot the histogram of all the pixels of the image. A histogram is a graphical display of data using bars of different heights.", "Matplotlib.hist is used to plot the histogram. As the image is mostly dark, we see a huge cluster of pixels on position zero of the grayscale bar.", "These are some basic functions that can be carried out on images using OpenCV and matplotlib. We will in later parts see more uses of OpenCV.", "The path of the training set is defined, and the directories under the path are saved in \u2018train\u2019. In this case, there are three folders, 1_Normal, 2_Bacteria, and 3_Virus.", "We create an empty list \u2014 folders. Then, iterate over the path, using os.listdir, and sort and store the folder names in the list \u2014 \u2018folders\u2019.", "The folder names are set as labels for the images, and the image size is selected to be 256*256. That is, all the images will be resized into 256*256. If we go through the dataset, we see all the images are of varying dimensions, and to feed images into a Convolutional Neural Network (CNN) it is necessary to resize the images into the same dimensions.", "Here we define a function to load in all the images according to the label names, resize them into 256*256 pixels, and return the image arrays.", "An empty list is created to save all the images. Then a \u2018for\u2019 loop is run to extract all the images from all the three folders. os.path.join is used to combine paths from directories. cv.IMREAD_GRAYSCALE converts all images to grayscale format. cv.resize is used to resize images to 256*256 pixels. \u2018.append\u2019 is used to append all the images into a list, which is finally converted to an array and returned using the return statement.", "The function \u2018load_train\u2019 is then called, and all the training images are saved as an array in train_images. The shape of training images is (5208,2)", "The images and labels need to be separated for training a neural network, and they are done so, by looping over the train_images, and by extracting the images and their corresponding labels.", "To check the number of images in each class, a for loop was run. The results are then plotted using matplotlib.bar which is used to create bar charts.", "From the data, it is clear, that there is a big difference in the number of images belonging to each label. If the network is trained with exactly these numbers of images, it might be biased towards the class with most labels. This is known as the Class Imbalance Problem. Hence it is necessary for each class to have a similar number of images, which we will talk about in the next part.", "Finally, we use the random module to generate nine random images from the training set and then used matplotlib to plot these images.", "This is the end of this part. As we see, for medical imaging analysis it is first very important to understand the dataset properly, in this case, X-ray images. In the next part, we will deal with the class imbalance problem and more operations using matplotlib and OpenCV.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D. student \u2014 Deep Learning on Biomedical Images at the Leibniz Institute-HKI, Germany. LinkedIn-https://www.linkedin.com/in/arjun-sarkar-9a051777/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F915a98fbf14c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arjun-sarkar786.medium.com/?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": ""}, {"url": "https://arjun-sarkar786.medium.com/?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": "Arjun Sarkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa31366b2eda&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&user=Arjun+Sarkar&userId=fa31366b2eda&source=post_page-fa31366b2eda----915a98fbf14c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F915a98fbf14c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F915a98fbf14c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia/data", "anchor_text": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia/data"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----915a98fbf14c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----915a98fbf14c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----915a98fbf14c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----915a98fbf14c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/medical-imaging?source=post_page-----915a98fbf14c---------------medical_imaging-----------------", "anchor_text": "Medical Imaging"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F915a98fbf14c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&user=Arjun+Sarkar&userId=fa31366b2eda&source=-----915a98fbf14c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F915a98fbf14c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&user=Arjun+Sarkar&userId=fa31366b2eda&source=-----915a98fbf14c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F915a98fbf14c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F915a98fbf14c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----915a98fbf14c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----915a98fbf14c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----915a98fbf14c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----915a98fbf14c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----915a98fbf14c--------------------------------", "anchor_text": ""}, {"url": "https://arjun-sarkar786.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arjun-sarkar786.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arjun Sarkar"}, {"url": "https://arjun-sarkar786.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "517 Followers"}, {"url": "https://www.linkedin.com/in/arjun-sarkar-9a051777/", "anchor_text": "https://www.linkedin.com/in/arjun-sarkar-9a051777/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa31366b2eda&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&user=Arjun+Sarkar&userId=fa31366b2eda&source=post_page-fa31366b2eda--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F25711c8db9ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-in-healthcare-x-ray-imaging-part-3-analyzing-images-using-python-915a98fbf14c&newsletterV3=fa31366b2eda&newsletterV3Id=25711c8db9ff&user=Arjun+Sarkar&userId=fa31366b2eda&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}