{"url": "https://towardsdatascience.com/lime-explain-machine-learning-predictions-af8f18189bfe", "time": 1683017939.0537229, "path": "towardsdatascience.com/lime-explain-machine-learning-predictions-af8f18189bfe/", "webpage": {"metadata": {"title": "LIME: explain Machine Learning predictions | by Giorgio Visani | Towards Data Science", "h1": "LIME: explain Machine Learning predictions", "description": "LIME stands for Local Interpretable Model-agnostic Explanations. It is a method for explaining predictions of Machine Learning models, developed by Marco Ribeiro in 2016 [3]. In the following, we are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://giorgio-visani.medium.com/explainable-machine-learning-9d1ca0547ae0#9860", "anchor_text": "\u260d", "paragraph_index": 2}, {"url": "https://giorgio-visani.medium.com/explainable-machine-learning-9d1ca0547ae0#6594", "anchor_text": "surrogate model", "paragraph_index": 9}, {"url": "https://jermwatt.github.io/machine_learning_refined/notes/3_First_order_methods/3_4_Tangent.html", "anchor_text": "this", "paragraph_index": 15}, {"url": "https://giorgio-visani.medium.com/explainable-machine-learning-9d1ca0547ae0", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://arxiv.org/pdf/1806.07498.pdf", "anchor_text": "Laugel and Renard\u2019s work", "paragraph_index": 20}, {"url": "https://arxiv.org/pdf/1805.10820.pdf", "anchor_text": "Guidotti\u2019s LORE", "paragraph_index": 20}, {"url": "https://arxiv.org/pdf/2006.05714.pdf", "anchor_text": "here", "paragraph_index": 24}, {"url": "https://github.com/giorgiovisani/lime_stability/tree/master/OptiLIME", "anchor_text": "Github", "paragraph_index": 24}, {"url": "https://arxiv.org/pdf/1805.10820.pdf", "anchor_text": "Local rule-based explanations of black box decision systems", "paragraph_index": 25}, {"url": "https://arxiv.org/pdf/2006.05714.pdf", "anchor_text": "OptiLIME: Optimized LIME Explanations for Diagnostic Computer Algorithms", "paragraph_index": 26}, {"url": "http://www.linkedin.com/in/giorgio-visani", "anchor_text": "www.linkedin.com/in/giorgio-visani", "paragraph_index": 28}], "all_paragraphs": ["LIME stands for Local Interpretable Model-agnostic Explanations. It is a method for explaining predictions of Machine Learning models, developed by Marco Ribeiro in 2016 [3].", "As the name says, this is:", "In the following, we are going to review the steps of LIME algorithm, to be on the same page when we will consider the intuition behind the method.In order to get the most out of it, be sure to have well in mind the Geometrical Perspective of ML models (\u260d).", "LIME explanation is valid only in the neighborhood of the reference individual (red dot).", "LIME generates n points x\u1d62\u2032 all over the \u211d\u1d56 space of the X variables, also in faraway regions from our red point. \u2014 x\u1d62\u2032 stands for the LIME generated points, while x\u1d62 are the observations of the original dataset \u2014 We generate only the X values for the n points x\u1d62\u2032, but we miss the Y value for the new units. So we plug each x\u1d62\u2032 into the ML model and we obtain its prediction for the new point: \u0177\u1d62\u2032. We actually generated a brand-new dataset.", "Because the Y is computed using the ML model, we are guaranteed that the new points perfectly lie on the ML surface! Basically, we have now a dataset representing our ML surface for some scattered points all over the \u211d\u1d56\u207a\u00b9 geometrical space.", "Since we are not interested in faraway points (LIME is a local method), we must ignore them. How to do it?LIME gives a weight to each generated point, using a Gaussian (RBF) Kernel.", "The Gaussian Kernel attributes a value in the range [0,1], the higher the closer to the reference point. The kernel width kw parameter decides how large is the circle of the meaningful weights around the red dot.", "Thanks to the weights, we understand if the points are far away or close to the red dot.", "LIME is now ready to use a surrogate model to approximate the ML model in the small region around our reference red dot, determined by the Kernel weight.", "We may choose any kind of explainable model for the approximation (Decision Trees, Logistic Regression, GLM, GAM, etc), although my preference is for Linear Regression (it can be viewed as the tangent to ML [\u260d]). \u2014 The default surrogate model in LIME\u2019s Python implementation is Ridge Regression, which belongs to the Linear Regression class of models \u2014 .", "The explainable model is usually exploited to understand which variables are the most important for the ML prediction for the specific individual (comparing the coefficients of the variables).", "But LIME models can also be used to test what-if scenarios ( eg. If I were to earn 500$ more a year, how many points would I gain on my credit score?).It is important to remember that the surrogate model is only valid locally: the scenario we test should be not too distant from our reference.", "Such what-if tool is available only for surrogate models: it cannot be done for other explainable methods such as the ones based on feature attribution, because they don\u2019t rely on prediction models.", "Since we have a complex and wiggly prediction curve f(x), obtained by the ML model, LIME's goal is to find its tangent at a precise point (the reference individual).", "From Taylor Theorem, we know that each function f can be approximated using a polynomial. The approximation error depends on the distance from the reference point and on the degree of the polynomial (higher degree ensures lower error).The tangent corresponds to the Taylor polynomial of degree 1, the simplest. Since it is the lowest polynomial degree, to obtain a good approximation we should consider a small region around the reference \u2014 the smaller the more accurate is the linear approximation of f(x) \u2014 .For more intuition about first-order Taylor approximation, check out this.", "So, all in all, it is just a tangent. Why LIME is not computing the tangent analytically? It would just require to calculate the derivative to the f(x) function. It would be simpler (allowing to get rid of the entire generation step) and less time-consuming.Unfortunately, as explained here, ML does not provide the formula of the prediction function f(x). Without the formula, it is impossible to calculate the derivative!!", "LIME basically reconstructs a part of the f(x) function, using the generation step, and approximates its derivative with Linear Regression.", "The generation step is an open issue!The current implementation generates points all over the \u211d\u1d56 space of the X variables, then gives importance only to the close ones, using the RBF Kernel with the proper kernel width kw value.", "This is a delicate subject: in principle, it would be better to consider only the points in the region of interest, although the proper size of the region is not fixed but depends on the reference point.In fact, the neighborhood should include all the linear area of the ML curve around the reference point, therefore it depends on the local curvature of f(x).In the Picture below you may see how different points have different proper size for the linear local region.", "There are some works on local generation techniques for LIME (in particular Laugel and Renard\u2019s work [2] and Guidotti\u2019s LORE [3] technique). Unfortunately, both of them still present issues. The first paper considers other factors in the method development, losing the important concept of the tangent. The second one, instead, does not guarantee to consider the entire linear area around the reference dot (it just finds a very small neighborhood, without checking if the ML function is linear also a little bit further). This is a big drawback because small neighborhoods cause LIME explanations to be unstable.", "This is considered the biggest issue, for some time the practitioners just tried out many different values and checked whether the explanations were reasonable.", "This is clearly a problem: we are not sure the trained ML model makes reasonable decisions. So, if the ML finds strange or unreasonable rules, we expect LIME to be unreasonable too (after all that is precisely why we use LIME: to understand ML behavior and potential ML issues). But if we choose the kw value based on meaningful explanations, we won\u2019t be able to spot any ML problem!!", "Moreover, we can see how bad choices of the kernel width distort the LIME line, making it very different from the tangent (as in the Picture below).", "Recently, OptiLIME has been developed: a new framework to find the best kernel width, so that LIME explanation is ensured to represent the tangent to the ML curve. The OptiLIME paper [4] is available here, and the open-source implementation can be found on Github.", "[1] Guidotti, R., Monreale, A., et al. , 2018. Local rule-based explanations of black box decision systems, ArXiv preprint", "[4] Visani, G., Bagli, E., Chesani, F., 2020. OptiLIME: Optimized LIME Explanations for Diagnostic Computer Algorithms. AIMLAI Workshop @ CIKM", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD Student on the topic \u201cExplainability of Machine learning\u201d. Machine Learning Specialist @ Crif S.p.A. LinkedIn: www.linkedin.com/in/giorgio-visani"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf8f18189bfe&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://giorgio-visani.medium.com/?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": ""}, {"url": "https://giorgio-visani.medium.com/?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": "Giorgio Visani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F25b7bff9726d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&user=Giorgio+Visani&userId=25b7bff9726d&source=post_page-25b7bff9726d----af8f18189bfe---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf8f18189bfe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf8f18189bfe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "http://www.linkedin.com/in/giorgio-visani", "anchor_text": "Giorgio Visani"}, {"url": "https://giorgio-visani.medium.com/explainable-machine-learning-9d1ca0547ae0", "anchor_text": "here"}, {"url": "https://giorgio-visani.medium.com/explainable-machine-learning-9d1ca0547ae0#9860", "anchor_text": "\u260d"}, {"url": "https://giorgio-visani.medium.com/explainable-machine-learning-9d1ca0547ae0#6594", "anchor_text": "surrogate model"}, {"url": "https://jermwatt.github.io/machine_learning_refined/notes/3_First_order_methods/3_4_Tangent.html", "anchor_text": "this"}, {"url": "https://giorgio-visani.medium.com/explainable-machine-learning-9d1ca0547ae0", "anchor_text": "here"}, {"url": "https://www.kdnuggets.com/2019/12/interpretability-part-3-lime-shap.html", "anchor_text": "Joseph"}, {"url": "https://arxiv.org/pdf/1806.07498.pdf", "anchor_text": "Laugel and Renard\u2019s work"}, {"url": "https://arxiv.org/pdf/1805.10820.pdf", "anchor_text": "Guidotti\u2019s LORE"}, {"url": "https://arxiv.org/pdf/2006.05714.pdf", "anchor_text": "here"}, {"url": "https://github.com/giorgiovisani/lime_stability/tree/master/OptiLIME", "anchor_text": "Github"}, {"url": "https://arxiv.org/pdf/1805.10820.pdf", "anchor_text": "Local rule-based explanations of black box decision systems"}, {"url": "https://arxiv.org/pdf/1806.07498.pdf", "anchor_text": "Defining locality for surrogates in post-hoc interpretablity."}, {"url": "https://dl.acm.org/doi/pdf/10.1145/2939672.2939778", "anchor_text": "\u201c Why should I trust you?\u201d Explaining the predictions of any classifier"}, {"url": "https://arxiv.org/pdf/2006.05714.pdf", "anchor_text": "OptiLIME: Optimized LIME Explanations for Diagnostic Computer Algorithms"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----af8f18189bfe---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/lime?source=post_page-----af8f18189bfe---------------lime-----------------", "anchor_text": "Lime"}, {"url": "https://medium.com/tag/interpretability?source=post_page-----af8f18189bfe---------------interpretability-----------------", "anchor_text": "Interpretability"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----af8f18189bfe---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----af8f18189bfe---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf8f18189bfe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&user=Giorgio+Visani&userId=25b7bff9726d&source=-----af8f18189bfe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf8f18189bfe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&user=Giorgio+Visani&userId=25b7bff9726d&source=-----af8f18189bfe---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf8f18189bfe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faf8f18189bfe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----af8f18189bfe---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----af8f18189bfe--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----af8f18189bfe--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----af8f18189bfe--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----af8f18189bfe--------------------------------", "anchor_text": ""}, {"url": "https://giorgio-visani.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://giorgio-visani.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Giorgio Visani"}, {"url": "https://giorgio-visani.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "35 Followers"}, {"url": "http://www.linkedin.com/in/giorgio-visani", "anchor_text": "www.linkedin.com/in/giorgio-visani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F25b7bff9726d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&user=Giorgio+Visani&userId=25b7bff9726d&source=post_page-25b7bff9726d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F25b7bff9726d%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-explain-machine-learning-predictions-af8f18189bfe&user=Giorgio+Visani&userId=25b7bff9726d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}