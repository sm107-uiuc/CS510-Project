{"url": "https://towardsdatascience.com/confusion-matrix-un-confused-1ba98dee0d7f", "time": 1683003968.4243991, "path": "towardsdatascience.com/confusion-matrix-un-confused-1ba98dee0d7f/", "webpage": {"metadata": {"title": "Confusion Matrix \u201cUn-confused\u201d. Breaking down the confusion matrix | by Kurtis Pykes | Towards Data Science", "h1": "Confusion Matrix \u201cUn-confused\u201d", "description": "The goal of applied machine learning in industry is to drive business value. Therefore being able to evaluate your machine learning algorithms performance is extremely important for deriving insights\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/7fe94d3af4e6?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Sarang Narkhede", "paragraph_index": 32}, {"url": "https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62", "anchor_text": "Click here to navigate there", "paragraph_index": 32}, {"url": "https://medium.com/u/71f58a3cb5e8?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Koo Ping Shung", "paragraph_index": 32}, {"url": "https://towardsdatascience.com/accuracy-precision-recall-or-f1-331fb37c5cb9", "anchor_text": "Click here for the link", "paragraph_index": 32}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "here", "paragraph_index": 32}], "all_paragraphs": ["The goal of applied machine learning in industry is to drive business value. Therefore being able to evaluate your machine learning algorithms performance is extremely important for deriving insights into your model.", "In this post, I aim to dive into the confusion matrix in a way that is accessible for those actively using them and for those who are just curious. With that being said, this article will be structured as follows:", "The confusion matrix is a useful tool used for classification tasks in machine learning with the primary objective of visualizing the performance of a machine learning model.", "In a binary classification setting where the negative class is 0 and the positive class is 1, the confusion matrix is constructed with a 2x2 grid table where the rows are the actual outputs of the data, and the columns are the predicted values from the model.", "I will explain why certain grids are one color whilst the others have another, for now, this is just a visual representation of what the confusion matrix is and what it would look like for a binary classification task.", "Note: Many sources structure the confusion matrix differently, for instance, the rows may be the predicted values and columns the actual values. If you are using a framework (i.e. Sci-kit learn) it is important to read the documentation for the confusion matrix to see what format the confusion matrix is in.", "No matter what patch of the grid that you land on in figure 1, it\u2019s adjacent grid would be highlighted with another color. This takes into account the different variations of a confusion matrix that you may see if you simply rotate the grid.", "Good! Now that you have become acquainted with the format of the confusion matrix for binary classification task, it is now important to know how to fill in a confusion matrix.", "Let\u2019s use the classical cats and dogs example. If our classification task has been trained to distinguish between a cat and dog, the confusion matrix will create a summary of results for the prediction model for further analysis.", "Of the 50 cats in figure 3, the model predicted that 15 were actually cats and 35 were dogs. In respect to the dogs, the model predicted that 40 were cats and 10 were dogs. All the correct predictions are allocated in the diagonal in the table (from top to left) \u2014 yep, you guessed it! That is why the boxes were colored as they were in figure 1.", "You\u2019ve now learnt how to plot your own confusion matrix. As Data Scientist we want to know why the model is not doing a good job so that we have better insight into our data that we can use to engineer new features for the next modelling phase.", "How to interpret a Confusion Matrix", "I will start by first describing some terminology, if you are able to work out where they would go then you are halfway there:", "True Positives: The model predicted positive and the label was actually positive.", "True Negatives: The model predicted negative and the label was actually negative.", "False Positives: The model predicted positive and the label was actually negative \u2014 I like to think of this as falsely classified as positive.", "False Negatives: The model predicted negative and the label was actually positive\u2014 I like to think of this as falsely classified as negative.", "If you were able to categorize the labels into these columns then that is fantastic, you now have a comprehensive grasp of the confusion matrix. Let\u2019s dig further!", "Our confusion matrix has two red patches on our grid, which infer to us the type of errors that our model is making. Type I error is when our model falsely classify something as positive when it is actually a negative (False positive) \u2014 so it can be thought of as a false alarm \u2014 for example predicting that someone has asthma when they actually do not. Type II error is when we falsely classify something as negative when it is actually positive (False Negative) \u2014 In our asthma case, this will be saying that somebody does not have asthma when in actual fact they do.", "I know the wordings can make this hard to grasp so if you feel like it has not sat well yet, return to figure 4 for a visual concept.", "You have now learnt that a confusion matrix is a tool used to evaluate the performance of a predictive model in classification tasks. In addition, you also know the terminology associated with each output of our predictive model in accordance with its actual label.", "We are tasked with building a classifier that predicts fraudulent or non fraudulent for different transactions. The data was handed to us by a major bank in the UK with very tight security \u2013 the personal details of all customers were encrypted for privacy concerns \u2013 so fraudulent transactions do not happen very often. In fact, the data that they had given us had 10,000 negative cases (non-fraudulent) and 1000 (fraud) cases. Figure 5 shows the results of our classifier.", "Accuracy refers to the closeness of a measured value to a standard or known value. After we have built a classifier and used it to make predictions, we quickly pulled up our confusion matrix to determine how accurate our model was and we was astound to see that our model had 92% accuracy. As we began dreaming about our bonus that was going to come from this, something tugged on our data science bone and told us to look more into our models predictions because we do not know why our model is so accurate and because accuracy can be a misleading metric when our target variable, in this case fraud or non-fraud, is imbalanced. We reviewed the confusion matrix (see figure 5) again to derive some more metrics to tell us about why our model is so accurate.", "Precision (also referred to as the positive predictive value) tells us that from the labels our classifier has labelled positive, the amount that is actually positive.", "On the other hand, Recall (also referred to as sensitivity or the true positive rate) tells us the number of actual positives that our model correctly identifies as such.", "Note: precision and recall are based on an understanding and measure of the positive label (relevance).", "We compute the formulas that we have just learnt for precision and recall:", "Yes!! This is fantastic, this means that the 83% of the labels that we labelled as positive are actually positive. This is phenomenal\u2026 or is it? Let\u2019s check the recall.", "Whoooppsie daisy\u2026 This is telling us that the number of positive labels our classifier is correctly identifying as such. In other words, fraud is going undetected 76% of the time! It does not take PhD to know that this is not good at all.", "For this problem we would want to optimize for recall, meaning that we would want to reduce the amount of false negatives (falsely classifying as negative when the actual label is positive) by predicting positive on more occasions. However, there are occasions where you may want to optimize for precision, for instance in a spam classifier, we wouldn\u2019t want important emails being classified as spam and sent to our junk mail. In the case of our fraud classifeir, we want to optimize for recall and in order to do this we must reduce the threshold of classifier for what it classifies as being the positive class. Take note that since our classifier is now predicting positive more, it reduces (our once great) precision of 83% because there is now a higher chance that our model will predict false positives giving off more false alarms, but we do not mind that in this instance.", "Precision and Recalls love hate relationship", "Very rarely are Precision and Recall discussed in isolation, and as we discovered above, there is often an inverse relationship between them \u2014 Increasing one metric reduces the other. When we need to strike a balance between precision and recall, a better known metric is the F1-score ( also know as the F measure). F1-score is a measure of accuracy that considers the precision and recall (the formula below will show you how it does that).", "In conclusion, there are further metrics that can be derived from our confusion matrix. Having a firm understanding of the terminologies from the confusion matrix is a solid foundation to progress on to understanding other metrics that can be derived . If you would like to push on, Sarang Narkhede has an amazing post about the confusion matrix on his profile (Click here to navigate there). Koo Ping Shung goes in to more detail about when you would use Accuracy, Precision, Recall and F1-score and is written in a friendly way so anybody can understand (Click here for the link). We also have the famous Wikipedia, which you can access by clicking here. I have attached a post below that extends on the confusion matrix, where we use it to plot a ROC curve, if you do not know what that is, or you are aware but don\u2019t quite understand it, then click on the link below to get a good grasp of it.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1ba98dee0d7f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kurtispykes.medium.com/?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877----1ba98dee0d7f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1ba98dee0d7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1ba98dee0d7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://computersciencesource.wordpress.com/2010/01/07/year-2-machine-learning-confusion-matrix/", "anchor_text": "Badgerati"}, {"url": "https://medium.com/u/7fe94d3af4e6?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Sarang Narkhede"}, {"url": "https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62", "anchor_text": "Click here to navigate there"}, {"url": "https://medium.com/u/71f58a3cb5e8?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Koo Ping Shung"}, {"url": "https://towardsdatascience.com/accuracy-precision-recall-or-f1-331fb37c5cb9", "anchor_text": "Click here for the link"}, {"url": "https://en.wikipedia.org/wiki/Confusion_matrix", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/comprehension-of-the-auc-roc-curve-e876191280f9", "anchor_text": "Comprehension of the AUC-ROC curveA deeper look into AUC-ROC\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1ba98dee0d7f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----1ba98dee0d7f---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/statistics?source=post_page-----1ba98dee0d7f---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1ba98dee0d7f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----1ba98dee0d7f---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1ba98dee0d7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&user=Kurtis+Pykes&userId=5ba760786877&source=-----1ba98dee0d7f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1ba98dee0d7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&user=Kurtis+Pykes&userId=5ba760786877&source=-----1ba98dee0d7f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1ba98dee0d7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1ba98dee0d7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1ba98dee0d7f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1ba98dee0d7f--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://kurtispykes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://www.fullstackfreelancershub.com/wisdom-wednesday", "anchor_text": "https://www.fullstackfreelancershub.com/wisdom-wednesday"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffde3d752d24c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconfusion-matrix-un-confused-1ba98dee0d7f&newsletterV3=5ba760786877&newsletterV3Id=fde3d752d24c&user=Kurtis+Pykes&userId=5ba760786877&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}