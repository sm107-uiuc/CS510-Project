{"url": "https://towardsdatascience.com/keeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6", "time": 1682997436.48318, "path": "towardsdatascience.com/keeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6/", "webpage": {"metadata": {"title": "Keeping an eye on confounds: a walk through for calculating a partial correlation matrix | by Alex daSilva | Towards Data Science", "h1": "Keeping an eye on confounds: a walk through for calculating a partial correlation matrix", "description": "One of the most common steps analysts perform following data munging/ pre-processing is to run a correlation analysis to check the pairwise associations among variables in a standardized way. It\u2019s a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/alex-w-dasil/", "anchor_text": "https://www.linkedin.com/in/alex-w-dasil/", "paragraph_index": 18}], "all_paragraphs": ["One of the most common steps analysts perform following data munging/ pre-processing is to run a correlation analysis to check the pairwise associations among variables in a standardized way. It\u2019s a quick and pretty effortless way to get a feel for your data. However, looking at the relationship between two variables in isolation can be misleading if there are other confounding variables lurking in your data set related to both variables of interest.", "Thus, calculating a matrix of partial correlations may be a better option in some circumstances. Such a matrix will allow one to quickly measure and view the association between 2 variables while controlling for all the other variables in the data set. Below, we\u2019ll go over 2 ways to calculate a partial correlation matrix from scratch and also illustrate how to do so using the \u201cppcor\u201d package.", "For this illustration, we\u2019ll use part of the air quality data set which contains information about daily air quality levels in New York during part of 1973.", "To start, we\u2019ll run a correlation analysis to check out the relationships between these quality measurements. To touch on a few of the results, we can see that higher levels of ozone are associated with increased temperatures while higher winds levels are associated with lower levels of ozone. Wind and solar radiation are nearly orthogonal to each other.", "We can make an improved visualization using the \u201ccorrplot\u201d package.", "Now that we\u2019ve looked at the correlation structure, lets move on to calculating a partial correlation matrix. The idea here is the same behind running multiple linear regression and attempting to \u201ccontrol\u201d for other confounding variables (say X2 and X3) while looking at the effect of a predictor variable of interest, X1 on your outcome variable, Y. The nice thing about a partial correlation matrix is that one can get all these associations in a standardized matrix for easy viewing.", "The first approach we\u2019ll cover for calculating a partial correlation matrix is to solve a series (equal to the number of variables in your data set) of 2 associated linear regression models. We take the residuals from these resulting models and calculate the correlation between them. To clarify, let\u2019s say we want to calculate the partial correlation between Ozone and Solar.R.", "And correlate the residuals to calculate the partial correlation which comes out to be 0.242.", "We\u2019ll generalize this to find partial correlations in a pairwise fashion in the airquality data set below.", "We can look at the correlation and partial correlation matrices side-by-side to see how the coefficients have changed. All coefficients experience a reduction in magnitude which is not surprising considering we are \u201ccontrolling\u201d for the other variables in the data set. This reduction is more pronounced in some cases. For example, the correlation between temp and wind is -.5. The partial correlation between temp and wind, accounting for solar.R and ozone, is only -.13.", "The second method we\u2019ll look at for calculating partial correlations uses matrix algebra and is a bit cleaner.", "Working from a correlation matrix R, we first need to find the anti-image covariance matrix, AICOV. To find AICOV, we need D, the inverses of the diagonal elements of the inverse of R. With D, we can calculate AICOV as follows: AICOV = DR\u207b\u00b9D.", "With the AICOV matrix, we can calculate anti-image correlation matrix, AICOR. Here, D is equal to the diagonal of AICOV, square-rooted and inversed. AICOR = D\u00b9/\u00b2 AICOV D\u00b9/\u00b2.", "On the off diagonal of AICOR are the negative partial correlation values. We can multiply a negative through the off-diagonal elements of AICOR to get the partial correlation matrix. Below is a function that can take in a data set or a correlation matrix and return a partial correlation matrix.", "Finally, to ensure that all of the prior calculations are correct, wecan use the \u201cppcor\u201d package and the \u201cpcor\u201d function to easily calculatepartial correlation coefficients and obtain metrics for significancetesting.", "In this demo, we looked at 2 different ways to calculate partial correlations from scratch and observed how drastic changes to coefficients (previously observed in correlations) can result when accounting for other variables in the data set.", "Hopefully this was useful and, if appropriate, you\u2019ll check out the partial correlations when taking a look at your data!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Social Science and Data Science Nerd | PhD Candidate in Psychological and Brain Sciences at Dartmouth College | https://www.linkedin.com/in/alex-w-dasil/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2ac6b831c5b6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@awdasilva21?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awdasilva21?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": "Alex daSilva"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff71073bbf3b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&user=Alex+daSilva&userId=f71073bbf3b3&source=post_page-f71073bbf3b3----2ac6b831c5b6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ac6b831c5b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ac6b831c5b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://commons.wikimedia.org/wiki/File:Partial_correlation.svg", "anchor_text": "Wikimedia Commons"}, {"url": "https://commons.wikimedia.org/wiki/File:Manhattan,_New_York,_1970,_view_from_Hudson_River_-_panoramio.jpg", "anchor_text": "Wikimedia Commons"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2ac6b831c5b6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----2ac6b831c5b6---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/r?source=post_page-----2ac6b831c5b6---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/analytics?source=post_page-----2ac6b831c5b6---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2ac6b831c5b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&user=Alex+daSilva&userId=f71073bbf3b3&source=-----2ac6b831c5b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2ac6b831c5b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&user=Alex+daSilva&userId=f71073bbf3b3&source=-----2ac6b831c5b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2ac6b831c5b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2ac6b831c5b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2ac6b831c5b6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2ac6b831c5b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awdasilva21?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@awdasilva21?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alex daSilva"}, {"url": "https://medium.com/@awdasilva21/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "82 Followers"}, {"url": "https://www.linkedin.com/in/alex-w-dasil/", "anchor_text": "https://www.linkedin.com/in/alex-w-dasil/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff71073bbf3b3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&user=Alex+daSilva&userId=f71073bbf3b3&source=post_page-f71073bbf3b3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ff71073bbf3b3%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fkeeping-an-eye-on-confounds-a-walk-through-for-calculating-a-partial-correlation-matrix-2ac6b831c5b6&user=Alex+daSilva&userId=f71073bbf3b3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}