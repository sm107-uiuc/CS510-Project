{"url": "https://towardsdatascience.com/deep-learning-for-reconstructing-continuous-processes-bcb7f94f2149", "time": 1683017859.986094, "path": "towardsdatascience.com/deep-learning-for-reconstructing-continuous-processes-bcb7f94f2149/", "webpage": {"metadata": {"title": "Deep Learning for Reconstructing Continuous Processes | by Aseem Kashyap | Towards Data Science", "h1": "Deep Learning for Reconstructing Continuous Processes", "description": "All cellular processes are essentially continuous and usually subdivided into different phases / stages. This categorisation however conceals two important features about such processes: first, that\u2026"}, "outgoing_paragraph_urls": [{"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "MINST", "paragraph_index": 2}, {"url": "http://www.image-net.org", "anchor_text": "Imagenet", "paragraph_index": 2}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Cytokinesis", "anchor_text": "cytokinesis", "paragraph_index": 3}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ResNet101", "paragraph_index": 6}, {"url": "https://distill.pub/2017/feature-visualization/", "anchor_text": "increasingly complex set of patterns", "paragraph_index": 7}, {"url": "https://pytorch.org/docs/stable/torchvision/models.html", "anchor_text": "the training data resolution to be atleast 224*224 pixels", "paragraph_index": 7}, {"url": "https://arxiv.org/abs/1610.02391", "anchor_text": "Gradient-weighted Class Activation Mapping (Grad-CAM)", "paragraph_index": 10}, {"url": "https://colab.research.google.com/drive/1PokCsdjtc9H-uWxXmWHQaGjaVhuVPaiI?usp=sharing", "anchor_text": "here", "paragraph_index": 26}, {"url": "https://colab.research.google.com/drive/1a1GLpIv6DZarLALDeDN6mr82STE1HiqV?usp=sharing", "anchor_text": "here", "paragraph_index": 26}, {"url": "https://drive.google.com/file/d/1uC2HgtxaHRQRnlZ7Sc0rQfbTfAD0OUZg/view?usp=sharing", "anchor_text": "here", "paragraph_index": 26}, {"url": "https://bbbc.broadinstitute.org/BBBC048", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://www.molbiolcell.org/doi/full/10.1091/mbc.E20-03-0187", "anchor_text": "here", "paragraph_index": 28}], "all_paragraphs": ["All cellular processes are essentially continuous and usually subdivided into different phases / stages. This categorisation however conceals two important features about such processes: first, that each such phase does not represent a homogeneous monolith and that there is in fact a great deal of heterogeneity within any particular phase. Second, that there are often significant overlaps between adjoining stages. A much more nuanced understanding is therefore needed to fully grasp such continuous cellular processes. This however is not possible using traditional imaging analysis alone.", "In the different phases of the cell cycle, the cells do not \u2018jump\u2019 from one state of being to another. Instead they gradually transition through a series of \u2018sub-phases\u2019 that together comprise a stage. Using deep learning combined with dimensionality reduction we can capture these \u2018sub-phases\u2019, thereby arriving at a much more fine-grained understanding of what is essentially a continuous process. This analysis shows how cells populations within a particular stage are not homogeneous and that there is a considerable overlap within the different phases.", "More often than not, Convolution Neural Networks (CNNs) are trained to classify image classes that differ significantly from each other in terms of physical features. Such deep learning models must therefore learn to recoganize physical features and shapes that are unique to a particular class of images. A CNN trained to distinguish between cat and dog images for instance, must learn to recognize differences in face, ears, body size, fur texture etc. Same applies to classification tasks involving other routinely used machine learning datasets like MINST, Imagenet, CIFAR etc.", "Cell Biology however presents us with a very different problem. The classes that we would like to categorize often vary not so much in shape but in size and other physical feature, making it difficult to distinguish between them manually. Take for instance the cell cycles shown below, a series of orchestrated steps during which a parent cell grows in size and ultimately divides into two identical daughter cells. With the exception of Anaphase and Telophase where the cell is undergoing cytokinesis (splitting into two), all other phases essentially have same circular shape but subtle variations in size as the cell must increase in size to prepare for division so as to ensure that the two daughter cells of size same as the original parent are formed.", "While it would be relatively easy to train a CNN to classify the four M-phase stages based on differences in shape, this article makes use of images from the three interphase stages namely G1, S and G2 to train a classifier.", "A CNN trained on these three classes must essentially learn to recoganize circular objects of three different size. The remaining of this article is composed of following sections :-", "In this section we train a ResNet101 model to classify cell images belonging to three interphase classes. The overall dataset consists of 31550 images (14333 in G1 phase, 8616 in S phase, and 8601 in G2 phase) of which 15% were set aside for validation. Images in the original dataset were 66*66 pixel in size, which were resized (tt.Resize) and cropped (tt.CenterCrop) to get 128*128 pixel images. The images were normalized (tt.Normalize) using the mean and standard deviation for each of the three channels. Check out the associated code for how the pixel mean and standard deviations were calculated.", "The pytorch pre-trained models are trained on the ImageNet dataset and each layer of such a model learns to recoganize an increasingly complex set of patterns in the training dataset. Our images however do not contain patterns quiet as complex as the ImageNet images. In fact, the entire dataset is made of a single shape \u2014 circular. What our model needs to learn though is to distinguish between different sizes. Also transfer learning in pytorch necessitate the training data resolution to be atleast 224*224 pixels. Transfer learning was therefore turned off (pretrained=False) in our predefined resnet101 model", "And while the task of distinguishing between different size of same shape might appear trivial, resnet models with fewer than 101 layers were not able to achieve the desired accuracy and would easily overfit.", "After 30 epochs, an overall training accuracy of 82.11% (training loss : 0.41) and validation accuracy of 80.47% (validation loss : 0.44) was achieved. As can be seen from the confusion matrix, the intermediate class S was often misclassified as G1 or G2 or vice-versa. Misclassification of G1 as G2 and vice-versa was minimal. Also after 17 epochs, the model tend to overfit slightly and the training could be stopped earlier when the model is fine tuned.", "Gradient-weighted Class Activation Mapping (Grad-CAM) can be a powerful tool to understand decision making in a trained neural net by visualizing pixels of input images that make the most contribution to the ultimate classification decision. The analysis clearly shows that the model is indeed capable of recoganizing objects of different size as the classification decisions are made based on the overall cell size. For brevity, the code is not included here but can be found in the google colab notebooks at the end of this article.", "So far we have successfully trained a deep learning model to classify images of interphase stages and this model can in turn be used to make predictions.", "Next we take these predictions to reconstruct the underlying process itself.", "Dynamic processes like the cell cycle are made up of a continuum of gradually varying stages. Precise demarcation of the beginning and end of these stages can be rather challenging, partly due to significant overlap between the stages. The cell images used for training the CNN however were categorised into three distinct stages \u2014 G1, S and G2. This however should not mislead us to assume that the images within a particular stage are homogeneous.", "In this section, we combine deep learning model predictions with dimensionality reduction techniques for a fine-grained understanding of classes by simultaneousely visualizing both the differences within a class and the relative ordering of classes.", "We do this by taking predictions from the trained model, reducing their dimensions and visualizing them in a two dimensional space.", "Let us focus our attention on the final layer of the ResNet101 model. The cells images in this layer are organized in a linearly separable manner with similar images closer to each other. The distance between different images in this imagenary hyperplane can be thought of as differences in the features extracted by the deep learning model i.e the outcome of the learning process. We could take these model prediction on the validation dataset i.e. the output of this final layer and feed them into a non-linear dimensionality reduction algorithm like t-SNE or UMAP to visualize the contained information in a 2D space.", "Principle Component Analysis (PCA) can detect linear relationships between features by transforming data into a new lower dimensional space, where each dimension is orthogonal to the other. The components arising from this analysis are sorted from the ones that explain the highest to lowest variance in data and only components with most interclass variance are used in the visualization. The underlying assumption that interclass variance is larger than the intraclass variance makes PCA inadequate for our data set as we are also interested in understanding differences within each class. Despite these limitations, PCA was able to capture the basic ordering of the interphase stages(see image above).", "While there are significant differences between t-SNE and UMAP with respect to their ability to preserve global structures, both algorithms do a reasonable good job of charting the progress of interphase stages from G1 to S and G1. Unlike PCA which merely separated the three classes, t-SNE and UMAP were successfully able to chart the variations within each class.", "This approach of coupling a deep learning model with dimensionality reduction provides a unique way of understanding classes in continuous system. As is evident from the above two visualizations, images of a particular class do not clutter together, instead they exist over a continuum of space that denotes gradual variations in shape. The images of a particular class merge into the subsequent class, thereby reconstructing the transition of cells from G1 to S and eventually to G2 phase. There is also a considerable variation in shapes of G1 stages a denoted by its significantly broader spread(in blue).", "At no point during the training process was the ordering of three interphase stages explicitly or implicitly specified. At no point did we say that S was the intermediate phase and that cells transition from G1 to G2 via S phase. The ability of the model to arrive at this ordering of stages by learning gradual variations in size is an immensely significant result for biological systems. Imagine not knowing the actual ordering of cell cycle stages and being able to reconstruct them simply by training a model.", "While cells exhibit dramatic structural rearrangements during the M-phase, the subcellular components undergo extensive re-organization in both interphase and during cell division. The S phase of the interphase entails DNA replication, resulting in a doubling of chromatin content and corresponding change in nuclear size. Other cell organelles like Golgi apparatus and endoplasmic reticulum too exhibit cell cycle dependent dynamics.", "It turns out we can also track changes in these subcellular components for classifying interphase stages. In this section I present results from training a simple resnet18 model to classify microscopic images of fluorescently labeled human cells into G1/S or G2 phases. Two different model are trained to classify DNA and golgi matrix protein (GMP) pattern in the interphase.", "For brevity the code for subcellular image classification has not been included in this article and can be found in the associated colab notebooks.", "While conventional machine learning based tools are routine used for statistical and quantitative analysis of microscopy data, recent advances in deep learning algorithms have made it possible to effectively learn representation of data with several levels of abstraction. These algorithms when applied to microscopy are capable of revolutionizing cellular image analysis by learning to track subtle changes in shape and size at both cellular and suncellular levels.", "Despite the promise, deep learning is yet to be widely adopted by microscopists. We are very likely at the beginning of a \u2018gold rush\u2019 as many conventional wet labs are either collaborating with or directly recruiting engineers to implement automated pipelines for cellular image classification, segmentation and object tracking.", "Complete code is available in the form of google co-lab notebooks. The code for Cellular Image Classification can be found here. Subcellular Image Classification code can be found here and here.", "I do not own rights to any of the data described in this article. The images used for cellular classification can be downloaded from here and the associated publication can be found here. The original paper groups all the three interphase classes together and the M-phase classes are taken to be distinct.", "The dataset used for subcellular image classification can be found here in the form of .npy arrays that have been described in a recently published paper which is to be found here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in Deep learning/Molecular Biology/Quantitative Cell Biology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbcb7f94f2149&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aseem-kash.medium.com/?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": ""}, {"url": "https://aseem-kash.medium.com/?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": "Aseem Kashyap"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd0d0126ce1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=post_page-fd0d0126ce1f----bcb7f94f2149---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbcb7f94f2149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbcb7f94f2149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/deep-learning-biology", "anchor_text": "DEEP LEARNING + BIOLOGY"}, {"url": "https://unsplash.com/s/photos/cell-biology", "anchor_text": "source"}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "MINST"}, {"url": "http://www.image-net.org", "anchor_text": "Imagenet"}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR"}, {"url": "https://en.wikipedia.org/wiki/Cytokinesis", "anchor_text": "cytokinesis"}, {"url": "https://bbbc.broadinstitute.org/BBBC048", "anchor_text": "Source of images"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ResNet101"}, {"url": "https://distill.pub/2017/feature-visualization/", "anchor_text": "increasingly complex set of patterns"}, {"url": "https://pytorch.org/docs/stable/torchvision/models.html", "anchor_text": "the training data resolution to be atleast 224*224 pixels"}, {"url": "https://arxiv.org/abs/1610.02391", "anchor_text": "Gradient-weighted Class Activation Mapping (Grad-CAM)"}, {"url": "https://colab.research.google.com/drive/1PokCsdjtc9H-uWxXmWHQaGjaVhuVPaiI?usp=sharing", "anchor_text": "here"}, {"url": "https://colab.research.google.com/drive/1a1GLpIv6DZarLALDeDN6mr82STE1HiqV?usp=sharing", "anchor_text": "here"}, {"url": "https://drive.google.com/file/d/1uC2HgtxaHRQRnlZ7Sc0rQfbTfAD0OUZg/view?usp=sharing", "anchor_text": "here"}, {"url": "https://bbbc.broadinstitute.org/BBBC048", "anchor_text": "here"}, {"url": "https://www.molbiolcell.org/doi/full/10.1091/mbc.E20-03-0187", "anchor_text": "here"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----bcb7f94f2149---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----bcb7f94f2149---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/cell-biology?source=post_page-----bcb7f94f2149---------------cell_biology-----------------", "anchor_text": "Cell Biology"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----bcb7f94f2149---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----bcb7f94f2149---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbcb7f94f2149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=-----bcb7f94f2149---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbcb7f94f2149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=-----bcb7f94f2149---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbcb7f94f2149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbcb7f94f2149&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bcb7f94f2149---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bcb7f94f2149--------------------------------", "anchor_text": ""}, {"url": "https://aseem-kash.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aseem-kash.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aseem Kashyap"}, {"url": "https://aseem-kash.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "124 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd0d0126ce1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=post_page-fd0d0126ce1f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9a364a98696f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-reconstructing-continuous-processes-bcb7f94f2149&newsletterV3=fd0d0126ce1f&newsletterV3Id=9a364a98696f&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}