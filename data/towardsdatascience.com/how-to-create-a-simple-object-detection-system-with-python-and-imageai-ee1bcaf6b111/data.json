{"url": "https://towardsdatascience.com/how-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111", "time": 1683017194.68145, "path": "towardsdatascience.com/how-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111/", "webpage": {"metadata": {"title": "How to Create a Simple Object Detection System with Python and ImageAI | by Ruben Winastwan | Towards Data Science", "h1": "How to Create a Simple Object Detection System with Python and ImageAI", "description": "We all can agree that object detection is one of the most popular topics in Computer Vision. The problem is, creating an object detection system from scratch requires deep technical knowledge in Deep\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/OlafenwaMoses/ImageAI/releases/tag/1.0/", "anchor_text": "here", "paragraph_index": 11}], "all_paragraphs": ["We all can agree that object detection is one of the most popular topics in Computer Vision. The problem is, creating an object detection system from scratch requires deep technical knowledge in Deep Learning and a huge amount of resources on your hardware.", "If you look at the common object detection models like ResNet, YOLO, NASNet, or RCNN, they all have a deep stack of layers. It requires technical knowledge and also a huge amount of time to make them work. All of these factors would be a challenge for people who just want to implement object detection algorithms to solve their problems.", "Fortunately, nowadays we can implement object detection algorithms in an easy way, even with just few lines of code. With ImageAI library, we can create our image or video object detection system in a quick and easy way. I\u2019ll show you how in this article.", "Below are the steps on what we\u2019re going to do in this article:", "So, let\u2019s get started right away.", "As previously mentioned, we\u2019re going to create an image and a video object detection system with the help of ImageAI. ImageAI is a Python library to enable ML practitioners to build an object detection system with only a few lines of code.", "Before we start, we need to install some of the dependencies that we will need to run ImageAI properly. These dependencies are:", "After installing all of those libraries, then we can start to install ImageAI library by typing the following command in your prompt:", "Next, we are ready to build our object detection system for image and for video.", "To start creating an image object detection system, first let\u2019s import the libraries that we\u2019re going to use and also set our current working directory.", "As we want to implement an object detection in an easy and quick way, we will use a pretrained model specific for object detection that has been trained on COCO dataset.", "There are three different pretrained models that you can choose with ImageAI: RetinaNet, YOLOv3, and tinyYOLOv3. You can download the model of your choice here.", "After you\u2019ve downloaded the model, place the h5 file in the same directory as your Python script. Your working directory should now has the following structure.", "Back to our Python script, we now can instantiate the ObjectDetection class that we have imported before. Depending on the model that you have downloaded before, we need to call a proper method from ObjectDetection class. Below is the code implementation for that.", "Next, we can start to load the model by first specifying the path to our model. Since our model is in the same directory as our Python script, here I show you how to load the RetinaNet model. If you use YOLOv3 or tinyYOLOv3, you need to change the file name of your h5 file accordingly.", "Finally, we can start to create an image object detection system. To do this, we need to specify two things: First, the directory and the filename of our input image and second, the directory and the filename of the output image.", "In the following code implementation, the input image will be an image called \u2018traffic.jpg\u2019 that is located in the same directory as the Python script. Meanwhile, the detection result will be saved in a file called \u2018traffic_detected.jpg\u2019 in the same directory.", "And that\u2019s the code that we need to instantiate our image object detection system. Below is the full code implementation of the steps that we have covered above:", "If you run the complete code above, you\u2019ll get more or less similar result on the image of your choice.", "If you use the default value that we have seen in the implementation above, you might think that somehow the result of the object detection is overcrowded, with several bounding boxes overlapping one another.", "In order to reduce the clutter in the prediction result, you can tune the object detector such that it only shows the object that really matters for you.", "Let\u2019s use the image above as an example. Let\u2019s say I want the object detector to predict only the people and the bicycle. To do this, we need to instantiate CustomObjects method. Then, we pass the name of the objects that we want the system to detect as the argument.", "Next, we can start to build the object detection system with detectCustomObjectsFromImage method. We pass our custom variable, the path and name of our input image, as well as the path and name of our output image.", "Moreover, we can also further remove the clutter by ignoring the predictions that have probability values below a certain threshold value. Let\u2019s say that you want to ignore the predictions with probability value below 70%. You can do that by adding the minimum_percentage_probability argument in the detectCustomObjectsFromImage method.", "Below is the complete code implementation when we want to detect only people and bicycle from our image, and we also only want to show the detection where the probability value is above 70%.", "If you run the code above, you\u2019ll get more or less the result like this:", "And that\u2019s it! With just a few lines of code now you can implement an object detection system for your own image. However, what if you want to detect objects in a video or even from your webcam instead of an image? Let\u2019s find out how to create a similar object detection for video with ImageAI in the next section.", "Believe it or not, the code to create a video object detection system with ImageAI is pretty much similar with the image object detection system we\u2019ve built before. All we need to do is changing 3 lines of code.", "The first one is the library that we should import. So instead of ObjectDetection , we need to import VideoObjectDetection .", "The second change that we should apply is the step where we instantiate object detection class. Instead of using ObjectDetection() , we should use VideoObjectDetection() .", "Next, the third or the final change that we should apply is when we create the object detection system. In our previous code, we use detectObjectsFromImage method. If we want to detect objects from a video, we need to use detectObjectsFromVideo instead.", "As you can see, the argument that we need to pass into this method is still the same as before. First, we need to specify the path to our video directory and the filename of our video. Second, we also need to specify the path and the filename of the output video.", "Below is the entire code implementation to create a video object detection system.", "Now if you run the code implementation above, you\u2019ll get more or less similar result as below.", "Note: if you somehow don\u2019t get the same color format in your output video, i.e you get the output video that is in BGR format instead of RGB format, you can use the code below to convert the output video back to RGB format.", "All you need to do is specifying the path and the filename of the video that you want to convert as well as the converted video.", "Same as our image object detection system, we can also fine tune our video object detection system a little bit. We have the option to pick which objects that we want to detect and to select the threshold for the probability value that should be displayed.", "Let\u2019s say we want to only detect people and bicycle for our video object detection system. Also, we only want to show the detections that have the probability value above 70%. We can do so by first instantiating a variable to store the objects that we want to observe.", "Next, we can create our video object detection system with our custom objects. To do so, we call the detectCustomObjectsFromVideo method. For the arguments of this method, we pass our custom variable, path and filename of our input and output video, frames per second, as well as the minimum threshold for probability value.", "Below is the complete code implementation if you want to only detect people and bicycle which has a probability value above 70%.", "Now what if you want to create an object detection system with your camera feeds as your input? Creating this system with ImageAI is also very straightforward. The code itself is very much similar with our video object detection system. You only need to add one line of code and also change one line of code to do this.", "First, we need to create a variable to instantiate the OpenCV library to capture the frame directly from our webcam.", "Finally, we need to change the argument in detectObjectsFromVideo method. Instead of specifying the input file path, we need to specify our camera input, which is the camera variable that we\u2019ve created above.", "Below is the complete code implementation to create an object detection system directly from your webcam.", "Again, if you somehow get the a different color format in your output video, you can use the aforementioned code to convert the output from BGR to RGB format.", "Now you already know how to create a quick and easy object detection system with ImageAI. As you have seen, ImageAI library enables us to build an object detection system without having to deal with the complexity behind object detection model like ResNet or YOLO.", "Note that with the pretrained model supported by ImageAI, the object detector can detect 80 different objects. These objects are:", "Now the question is, what if you want to create a custom object detection system with your own label that is not included in the list above?", "You can create your own custom object detection with ImageAI as well. I will show you how to do so in another post.", "That\u2019s all for now and I hope that this article is somehow useful for you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science || Machine Learning || Computer Vision || NLP"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fee1bcaf6b111&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcellusruben?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": "Ruben Winastwan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5dae9da73c9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&user=Ruben+Winastwan&userId=5dae9da73c9b&source=post_page-5dae9da73c9b----ee1bcaf6b111---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee1bcaf6b111&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee1bcaf6b111&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kyran12?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Kyran Aldworth"}, {"url": "https://unsplash.com/s/photos/focus?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/OlafenwaMoses/ImageAI/releases/tag/1.0/", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ee1bcaf6b111---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ee1bcaf6b111---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----ee1bcaf6b111---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----ee1bcaf6b111---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ee1bcaf6b111---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fee1bcaf6b111&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&user=Ruben+Winastwan&userId=5dae9da73c9b&source=-----ee1bcaf6b111---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fee1bcaf6b111&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&user=Ruben+Winastwan&userId=5dae9da73c9b&source=-----ee1bcaf6b111---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee1bcaf6b111&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fee1bcaf6b111&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ee1bcaf6b111---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ee1bcaf6b111--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ruben Winastwan"}, {"url": "https://medium.com/@marcellusruben/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "925 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5dae9da73c9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&user=Ruben+Winastwan&userId=5dae9da73c9b&source=post_page-5dae9da73c9b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F46c6747bd93b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-a-simple-object-detection-system-with-python-and-imageai-ee1bcaf6b111&newsletterV3=5dae9da73c9b&newsletterV3Id=46c6747bd93b&user=Ruben+Winastwan&userId=5dae9da73c9b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}