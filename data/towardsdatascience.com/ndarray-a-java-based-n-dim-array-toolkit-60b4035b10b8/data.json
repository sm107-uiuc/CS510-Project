{"url": "https://towardsdatascience.com/ndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8", "time": 1683012333.9209359, "path": "towardsdatascience.com/ndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8/", "webpage": {"metadata": {"title": "NDArray \u2014 \u2014 a Java based N-Dim array toolkit | by Qing Lan | Towards Data Science", "h1": "NDArray \u2014 \u2014 a Java based N-Dim array toolkit", "description": "Within many development languages, there is a popular paradigm of using N-Dimensional arrays. They allow you to write numerical code that would otherwise require many levels of nested loops in only a\u2026"}, "outgoing_paragraph_urls": [{"url": "http://djl.ai", "anchor_text": "Deep Java Library (DJL)", "paragraph_index": 0}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDArray.html", "anchor_text": "NDArray", "paragraph_index": 0}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDArray.html", "anchor_text": "NDArray", "paragraph_index": 0}, {"url": "https://aws-samples.github.io/djl-demo/web-demo/interactive-console/src/main/webapps/", "anchor_text": "", "paragraph_index": 1}, {"url": "https://djl.ai/website/demo.html#jshell", "anchor_text": "interactive online console", "paragraph_index": 1}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDManager.html", "anchor_text": "NDManager", "paragraph_index": 4}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDArray.html", "anchor_text": "NDArrays", "paragraph_index": 4}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDManager.html", "anchor_text": "20 NDArray creation methods", "paragraph_index": 8}, {"url": "https://en.wikipedia.org/wiki/Transpose", "anchor_text": "transpose", "paragraph_index": 9}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDArray.html", "anchor_text": "60 different NumPy math methods", "paragraph_index": 10}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/index/NDIndex.html", "anchor_text": "NDIndex", "paragraph_index": 13}, {"url": "https://djl.ai", "anchor_text": "Deep Java Library (DJL)", "paragraph_index": 22}, {"url": "https://github.com/awslabs/djl/tree/master/docs", "anchor_text": "GitHub", "paragraph_index": 22}, {"url": "https://github.com/aws-samples/djl-demo", "anchor_text": "demo repository", "paragraph_index": 22}, {"url": "https://join.slack.com/t/deepjavalibrary/shared_invite/zt-ar91gjkz-qbXhr1l~LFGEIEeGBibT7w", "anchor_text": "Slack channel", "paragraph_index": 22}, {"url": "https://twitter.com/deepjavalibrary", "anchor_text": "twitter", "paragraph_index": 22}, {"url": "https://github.com/lanking520", "anchor_text": "https://github.com/lanking520", "paragraph_index": 24}], "all_paragraphs": ["Within many development languages, there is a popular paradigm of using N-Dimensional arrays. They allow you to write numerical code that would otherwise require many levels of nested loops in only a few simple operations. Because of the ability to parallelize, it often runs even faster than the standard looping as well. This is now standard practice in many fields such as data science, graphics, and deep learning, but can be used in applications far beyond this.  In Python, the standard library for NDArrays is called NumPy. However, there is no equivalent standard library in Java. One offering for Java developers interested in working with NDArrays is AWS\u2019s Deep Java Library (DJL). Although it also contains Deep Learning, the core is a powerful NDArray system that can be used on its own to bring this paradigm into Java. With support for several Deep Learning Frameworks (PyTorch, TensorFlow, MXNet), DJL can allow the NDArray operations to run at a large-scale and across multiple platforms. No matter whether you are running on CPU or GPU, PC or Android, it simply works.   In this tutorial, we will walk through how you can leverage the NDArray from DJL to write your NumPy code in Java and apply NDArray into a real-world application.", "You can use the following configuration in a gradle project. Or, you can skip the setup and try it directly in our interactive online console.", "That\u2019s it, now we can start our implementation.", "Let\u2019s first create a try block to create a scope for our code (If you are using the interactive console, you can skip this step):", "NDManager helps manage the memory usage of the NDArrays. It creates them and helps clear them as well. Once you finish using an NDManager, it will clear all of the NDArrays that were created within it\u2019s scope as well. NDManager helps the overall system utilize memory efficiently by tracking the NDArray usage.  For comparison, let\u2019s see how the code looks in Python\u2019s NumPy as well. We will start by importing the NumPy library with the standard alias.", "In the following sections, we are going to compare the implementation and result between NumPy and DJL\u2019s NDArray.", "ones is an operation to generate N-dim array filled with 1. NumPy", "You can also try out random generation. For example, we will generate random uniform data from 0 to 1.  NumPy", "This is just a quick demo of some commonly used functions. The NDManager now offers more than 20 NDArray creation methods that cover most of the methods available in NumPy.", "We can also try some math operations using NDArrays. Assume we are trying to do a transpose and add a number to each element of the NDArray. We can achieve this by doing the following:  NumPy", "DJL now supports more than 60 different NumPy math methods covering most of the basic and advanced math functions.", "One of the most powerful features of NDArray is its flexible data indexing inspired by a similar feature in NumPy.  Let\u2019s assume we would like to filter all values in a matrix that are smaller than 10.  NumPy", "Now let\u2019s try to do something more complicated. Assume we have 3x3 matrix and we would like to multiply the second column by 2.  NumPy", "In the above example, we introduce a concept in Java called NDIndex. It mirrors most of the NDArray get/set functionalities that NumPy supports. By simply passing a String representation, developers can do all kinds of array manipulations seamlessly in Java.", "These operations are really helpful when we need to manipulate a huge dataset. Let\u2019s walk through a specific use case: Token Classification. In this case, developers were trying to do Sentiment Analysis on the text information they gathered from the users through applying a Deep Learning algorithm to it. NDArray operations were applied in the preprocessing and post-processing to encode and decode information.", "Before we feed the data into an NDArray, we tokenize the input text into numbers. The tokenizer in the code block below is a Map<String, Integer> that serves as a vocabulary to convert text into a corresponding vector.", "After that, we create an NDArray. To proceed further, we need to create a batch of tokens and apply some transformations to them.", "Then, we can send this data to a deep learning model. To achieve the same thing in pure Java would require far more work. If we are trying to implement the reshape function above, we need to create an N-dimensional array in Java that looks like: List<List<List<...List<Float>...>>> to cover all the different dimensions. We would then have to dynamically insert a new List<Float> containing the elements to build resulting data structure.", "With the previous walkthrough, you should have a basic experience using NDArray in Java. To summarize, here is the three key advantages using it:", "*Sparse currently only covers COO in PyTorch and CSR/Row_Sparse in MXNet.", "After trying NDArray creation and operation, you might wonder how DJL implement NDArray to achieve these behaviors. In this section, we will briefly walkthrough the architecture of NDArray.", "As shown above, there are three key layers to the NDArray.   The Interface layer contains NDArray, it is a Java Interface that defines what the NDArray should look like. We carefully evaluated it and made all functions\u2019 signature general enough and easy to use.  In the EngineProvider layer, there are different engine\u2019s implementation to the NDArray. This layer served as an interpretation layer that maps Engine specific behavior to NumPy behavior. As a result, all engines implementation are behaved the same way as NumPy have.   In the C++ Layer, we built JNI and JNA that expose C++ methods for Java to call. It would ensure we have enough methods to build the entire NDArray stack. Also it ensures the best performance by calling directly from Java to C++ since all Engines are implemented in C/C++.", "Deep Java Library (DJL) is a Deep Learning Framework written in Java, supporting both training and inference. DJL is built on top of modern Deep Learning frameworks (TenserFlow, PyTorch, MXNet, etc). You can easily use DJL to train your model or deploy your favorite models from a variety of engines without any additional conversion. It contains a powerful ModelZoo design that allows you to manage trained models and load them in a single line. The built-in ModelZoo currently supports more than 70 pre-trained and ready to use models from GluonCV, HuggingFace, TorchHub and Keras.  The addition of the NDArray makes DJL the best toolkit in Java to run your Deep Learning application. It can automatically identify the platform you are running on and figure out whether to leverage GPU to run your application.  From the most recent release, DJL 0.6.0 officially supports MXNet 1.7.0, PyTorch 1.5.0 and TensorFlow 2.2.0. We also have experimental support for PyTorch on Android.  Follow our GitHub, demo repository, Slack channel and twitter for more documentation and examples of DJL!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer @ Amazon AI https://github.com/lanking520"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F60b4035b10b8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ql2282?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ql2282?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": "Qing Lan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F48d262042d01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&user=Qing+Lan&userId=48d262042d01&source=post_page-48d262042d01----60b4035b10b8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60b4035b10b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60b4035b10b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/illustrations/analytics-information-innovation-3088958/", "anchor_text": "Source"}, {"url": "http://djl.ai", "anchor_text": "Deep Java Library (DJL)"}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDArray.html", "anchor_text": "NDArray"}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDArray.html", "anchor_text": "NDArray"}, {"url": "https://aws-samples.github.io/djl-demo/web-demo/interactive-console/src/main/webapps/", "anchor_text": ""}, {"url": "https://djl.ai/website/demo.html#jshell", "anchor_text": "interactive online console"}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDManager.html", "anchor_text": "NDManager"}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDArray.html", "anchor_text": "NDArrays"}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDManager.html", "anchor_text": "20 NDArray creation methods"}, {"url": "https://en.wikipedia.org/wiki/Transpose", "anchor_text": "transpose"}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/NDArray.html", "anchor_text": "60 different NumPy math methods"}, {"url": "https://javadoc.io/doc/ai.djl/api/latest/ai/djl/ndarray/index/NDIndex.html", "anchor_text": "NDIndex"}, {"url": "https://djl.ai", "anchor_text": "Deep Java Library (DJL)"}, {"url": "https://github.com/awslabs/djl/tree/master/docs", "anchor_text": "GitHub"}, {"url": "https://github.com/aws-samples/djl-demo", "anchor_text": "demo repository"}, {"url": "https://join.slack.com/t/deepjavalibrary/shared_invite/zt-ar91gjkz-qbXhr1l~LFGEIEeGBibT7w", "anchor_text": "Slack channel"}, {"url": "https://twitter.com/deepjavalibrary", "anchor_text": "twitter"}, {"url": "https://medium.com/tag/java?source=post_page-----60b4035b10b8---------------java-----------------", "anchor_text": "Java"}, {"url": "https://medium.com/tag/numpy?source=post_page-----60b4035b10b8---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----60b4035b10b8---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----60b4035b10b8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----60b4035b10b8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F60b4035b10b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&user=Qing+Lan&userId=48d262042d01&source=-----60b4035b10b8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F60b4035b10b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&user=Qing+Lan&userId=48d262042d01&source=-----60b4035b10b8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F60b4035b10b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F60b4035b10b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----60b4035b10b8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----60b4035b10b8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----60b4035b10b8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----60b4035b10b8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----60b4035b10b8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ql2282?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ql2282?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Qing Lan"}, {"url": "https://medium.com/@ql2282/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "https://github.com/lanking520", "anchor_text": "https://github.com/lanking520"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F48d262042d01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&user=Qing+Lan&userId=48d262042d01&source=post_page-48d262042d01--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F48d262042d01%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fndarray-a-java-based-n-dim-array-toolkit-60b4035b10b8&user=Qing+Lan&userId=48d262042d01&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}