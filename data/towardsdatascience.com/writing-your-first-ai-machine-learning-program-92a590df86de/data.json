{"url": "https://towardsdatascience.com/writing-your-first-ai-machine-learning-program-92a590df86de", "time": 1683011657.335247, "path": "towardsdatascience.com/writing-your-first-ai-machine-learning-program-92a590df86de/", "webpage": {"metadata": {"title": "Writing Your First AI/Machine Learning Program | by Tamoghno Bhattacharya | Towards Data Science", "h1": "Writing Your First AI/Machine Learning Program", "description": "You may have learnt a lot of theory regarding Artificial Intelligence and Machine Learning and found it interesting. But there\u2019s nothing like seeing the models and algorithms work on real data and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "https://archive.ics.uci.edu/ml/datasets/iris", "paragraph_index": 1}], "all_paragraphs": ["You may have learnt a lot of theory regarding Artificial Intelligence and Machine Learning and found it interesting. But there\u2019s nothing like seeing the models and algorithms work on real data and produce results, is there? There\u2019s a lot of material out there teaching you how to go about writing your first ML program and stuff, but what I found in most of the cases is that there\u2019s not much step-by-step guidance on how to go about approaching a particular problem. Well-written code is pretty much everywhere but methodology is lacking, which is equally important as learning how to write a program. So I decided to write on the well-known beginner\u2019s introduction to the AI world \u2014 Iris Flowers Classification Problem.", "The Iris flowers dataset basically contains 150 instances of flowers. Each flower has 4 attributes: sepal length, sepal width, petal length and petal width (each in cm) and 3 possible classes it might belong to: setosa, vermicolor, and virginica. For more information, refer to the site: https://archive.ics.uci.edu/ml/datasets/iris", "Our objective is to develop a classifier that can accurately classify a flower as one of the 3 classes based on the 4 features. There are a lot of algorithms which can do this, however since this your first AI program, let\u2019s stick to one of the simplest algorithms which can also be made to work relatively well on this dataset \u2014 Logistic Regression. In case if you have just begun Machine Learning and do not know what it is, check this set of lectures out from the popular Machine Learning course by Andrew NG. They\u2019re a perfect way to get started. Also check out the next series of lectures, i.e 7, if you aren\u2019t familiar with regularization.", "If you are well-versed in linear algebra, univariate and multivariate calculus, probability as well as statistics already, and would like a deeper mathematical understanding then check out this video from Stanford Online -", "Yeah, I\u2019m kind of a sucker for Andrew NG! Anyways, to summarize what Logistic Regression does, suppose we have the following dataset -", "Figure alongside shows admission scores of students in 2 exams, and whether or not they are admitted to the school/college based on their scores. What Logistic Regression does is it tries to find a linear decision boundary that separates the classes the best.", "As we can see, LR does a pretty nice job separating the two classes. But what if there are more than two classes, as in our case? In that situation, we train n classifiers for each of the n classes and have each classifier try to separate one class from the rest. This technique is rightly known as the \u2018one-vs-all classification\u2019. In the end, for prediction on an instance, we pick the classifier which detects it\u2019s class the strongest, and assign that class as the predicted class. The decision boundary here is a bit harder to visualize but here is an illustration from Sklearn -", "Alright, enough with the requisites, now let\u2019s get started with the code. We\u2019ll be using Python of course, along with the following modules: Numpy, Matplotlib, Seaborn and Sklearn. In case if like work locally on your computer like me, make sure you have these modules installed. To install them, simply fire up your Command Line/Terminal and enter the command \u201cpip install <module-name>\u201d. To check what modules are installed, enter \u201cpython\u201d then \u201chelp(\u2018modules\u2019)\u201d to generate list of all installed modules.", "First, we need to get an idea of the distribution of data in the dataset. Let\u2019s import the matplotlib and seaborn modules for this purpose and load the iris dataset contained in the seaborn module.", "This will load the dataset into the dataframe \u2018iris\u2019, which will make visualization much easier. Since the dataset has 4 features we can\u2019t visualize it directly but we can gain some intuition through seaborn\u2019s powerful pairplot. What pairplot does is it makes a scatter plot between each of the pairs of variables in the dataset, as well as the distribution of values of each variable (along the diagonal graphs). This can be used to analyze which features are a better separator of the data, which features are closely related, as well as data distribution.", "Another powerful tool in Seaborn is the heatmap of correlations. Correlation is a statistical measure of how much two variables are dependent on each other. If an increase in one variable causes a rough increase in another variable and vice versa, then they are said to be positively correlated. If an increase in a variable causes a decrease in another and vice versa, they are negatively correlated and if there is no such dependence between them, they have zero correlation. This is how we plot correlations using Seaborn -", "iris.corr() generates a 4*4 matrix with each entry (i,j) representing correlations between the i\u1d57\u02b0 and j\u1d57\u02b0 variables. Obviously the matrix is symmetric, since the dependence between i and j is same as that between j and i (wish this were true for humans too). And the diagonal elements are 1, since a variable is obviously completely dependent on itself. The annot parameter decides whether to display the correlation values on top of the heatmap and colormap is set to coolwarm, which means blue for low values and red for high values.", "Now that we have an intuition about the data, let\u2019s load the data into numpy arrays and preprocess it. Preprocessing is a crucial step and can enhance the performance of your algorithms by a huge margin. We import the required modules, load the dataset from sklearn\u2019s iris datasets class in the form of a dictionary, get the features and targets into numpy arrays X and Y, respectively and the names of the classes into names. Since the targets specified in the datasets are 0,1 and 2 representing the 3 classes of species, we would like a mapping from those integers to the name of the class they represent. To do this, we create a dictionary mapping from the integers 0,1,2 to the flower names.", "Let\u2019s move forward to the preprocessing step. We divide the data into train and test sets using train_test_split from sklearn using test set size of 25%, then use the StandardScaler class from sklearn. What StandardScaler does is it computes the mean and standard deviation of each of the features in our dataset, then subtracts off the mean and divides by the standard deviation each example in our dataset. This brings all of the features to having zero mean and unit standard deviation/variance. Bringing all of the features in the same range is also known as feature normalization, and it helps optimization algorithms like gradient descent to work properly and converge faster.", "It\u2019s time for the real deal. It is now that you feel really indebted to sklearn for making your life simple. We create an object of the LogisticRegression class named model, and fit our training dataset to it, all using 3 lines of code -", "Now, to make predictions we first normalize the test set using the Standard Scaler. Note that the transformation is the same as applied to the training set (to which we had fit the scaler to). This is important as we have to normalize our test set as per the mean and standard deviation of our training set, and not the test set. We then use the predict function to generate the 1D array of predictions both on the training and test set. There are many metrics available in the metrics class of sklearn but we\u2019ll use the 3 most relevant \u2014 accuracy, classification report and confusion matrix.", "The dataset is very small, and hence, you might very different results each time you train your model. This is the output I get -", "In case if you don\u2019t understand any of the metrics you see, feel free to search them they are pretty much basic and easy to understand. Training set accuracy is approx 95.5% and test set accuracy approx 94.7%. A weighted average of F1-score of all different classes in the test set is 0.95 and 2 examples from the test set are classified incorrectly. An accuracy of 94.7% on the training set at first go is really good, but we can do better.", "Let\u2019s introduce polynomial logistic regression. It turns out that we can build a better model by introducing polynomial features into the model, like x\u2081\u00b2, x\u2081x\u2082, x\u2082\u00b2 to produce a non-linear decision boundary to better separate the classes. This kind of model is more practical. For example, let us look at this dataset below -", "This dataset looks a little more practical, doesn\u2019t it? It shows scores achieved by tests on different microchips and the classes they belong to. There is clearly no linear decision boundary that can satisfactorily separate the data. Using polynomial logistic regression, we can get a decision boundary as shown below, which does a far better job.", "The lambda=1 in the figure refers to the regularization parameter. Regularization become pretty important when dealing with non-linear models since you don\u2019t want to overfit to your training set and have your model not perform well on new examples it hasn\u2019t seen.", "To add polynomial features into your dataset, we use the PolynomialFeatures class from sklearn. This will go into your preprocessing as an added step, similar to the feature normalization step. We add 5th power degree terms, you can try changing it and see the effect it has on your accuracy. It turns out the model starts overfitting for higher degree terms and we don\u2019t want that.", "Then continue the same steps as discussed above to fit the model. To make predictions, don\u2019t forget to transform the test set using poly first.", "Then evaluate the model, using the metrics discussed above. Again, the results will differ with each time the model is trained. Here is my output -", "Pretty good results! A training set accuracy of approx 98.2% and a test set accuracy of approx 97.4% are great using a simple algorithm like logistic regression. Weighted F1-score on test set has improved to 0.97 and the model incorrectly classifies only 1 example from the test set.", "It\u2019s time to use the model to generate predictions. We\u2019ll give it an array of 4 numbers \u2014 representing the 4 features of a flower, and it will tell us which species it thinks that it belongs to. We randomly pick 20 examples from the dataset, preprocess them and get the predicted classes.", "Note that Y_true represents the true class of the example and Y_pred is the predicted class. They are both integers as the model works with numeric data. We will now create 2 lists, storing the true names and predicted names of the species of each example, using the dictionary mapping we already created named target.", "This is the output I get -", "Due to the high accuracy of our model, all the 20 predictions generated are correct! Here is the complete code of the final model we created -", "Try to make some modifications to the model, see if you can improve it further to make more realistic predictions. You can try different models like KNN-Classifier, Support Vector Classifier, or even a small Neural Network though I would not prefer a NN for this task as the number of features and dataset both are small and a Machine Learning model will perform just as well.", "Hope this gives you some idea regarding how to go about building a simple AI, or specifically, Machine Learning model to solve a particular problem. There are basically 5 stages involved -", "There is a lot of trial-and-error involved when dealing with building Artificial Intelligence applications. Even if your first model doesn\u2019t work well, don\u2019t be disheartened. Most of the times, remarkable performance improvements can be made by tweaking it. Getting the right dataset is super crucial and is, I feel, the game-changer when it comes to real-world models. All said and done, try to keep learning new stuff as much as possible, and do AI for the fun of it!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An aspiring researcher, currently pursuing Bachelors in Computer Engineering, with special interest in Artificial Intelligence."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F92a590df86de&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----92a590df86de--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----92a590df86de--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tamoghnobhattacharya2001?source=post_page-----92a590df86de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tamoghnobhattacharya2001?source=post_page-----92a590df86de--------------------------------", "anchor_text": "Tamoghno Bhattacharya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F92a115f4e3b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&user=Tamoghno+Bhattacharya&userId=92a115f4e3b7&source=post_page-92a115f4e3b7----92a590df86de---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92a590df86de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92a590df86de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/work-typing-computer-notebook-731198/", "anchor_text": "https://pixabay.com/photos/work-typing-computer-notebook-731198/"}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "https://archive.ics.uci.edu/ml/datasets/iris"}, {"url": "https://scikit-learn.org/stable/auto_examples/linear_model/plot_iris_logistic.html", "anchor_text": "https://scikit-learn.org/stable/auto_examples/linear_model/plot_iris_logistic.html"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----92a590df86de---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----92a590df86de---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----92a590df86de---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----92a590df86de---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/regression?source=post_page-----92a590df86de---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F92a590df86de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&user=Tamoghno+Bhattacharya&userId=92a115f4e3b7&source=-----92a590df86de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F92a590df86de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&user=Tamoghno+Bhattacharya&userId=92a115f4e3b7&source=-----92a590df86de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92a590df86de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----92a590df86de--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F92a590df86de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----92a590df86de---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----92a590df86de--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----92a590df86de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----92a590df86de--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----92a590df86de--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----92a590df86de--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----92a590df86de--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----92a590df86de--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----92a590df86de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tamoghnobhattacharya2001?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tamoghnobhattacharya2001?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tamoghno Bhattacharya"}, {"url": "https://medium.com/@tamoghnobhattacharya2001/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "51 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F92a115f4e3b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&user=Tamoghno+Bhattacharya&userId=92a115f4e3b7&source=post_page-92a115f4e3b7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F68033984c2e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwriting-your-first-ai-machine-learning-program-92a590df86de&newsletterV3=92a115f4e3b7&newsletterV3Id=68033984c2e6&user=Tamoghno+Bhattacharya&userId=92a115f4e3b7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}