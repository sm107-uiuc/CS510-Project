{"url": "https://towardsdatascience.com/calculating-loss-of-yolo-v3-layer-8878bfaaf1ff", "time": 1683000409.135859, "path": "towardsdatascience.com/calculating-loss-of-yolo-v3-layer-8878bfaaf1ff/", "webpage": {"metadata": {"title": "Calculating Loss of Yolo (v3) Layer | by Hugegene | Towards Data Science", "h1": "Calculating Loss of Yolo (v3) Layer", "description": "Implementation of Yolo Layer in Yolo v3 Model"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b", "anchor_text": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b", "anchor_text": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b", "paragraph_index": 6}], "all_paragraphs": ["The Yolov3 is the state of the art object detection model, making it a fast and accurate real-time object detection model. Ever wondered where is the crux of Yolov3 model? The secret lies in the Yolo Layer of the Yolo Model.", "The Yolov3 model takes in a 416x416 image, process it with a trained Darknet-53 backbone and produces detections at three scales. At each scale, the output detections is of shape (batch_size x num_of_anchor_boxes x grid_size x grid_size x 85 dimensions).", "The architecture of Yolo v3 is very well depicted in Yolo v3 network Architecture diagram in https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b (please read this story to understand the Yolov3 architecture). Of all the components that are depicted by the diagram, there are 3 Detection Layers which are also Yolo Layers. Each of the 3 Yolo Layers is responsible for calculating the loss at three different scales. The losses at three different scales are then summed up for backpropagation. Each Yolo Layer makes use of 85 dimensions to calculate the loss. The first 4 dimensions correspond to the centreX, centreY, Width, Height of a bounding box. The next 1 dimension corresponds to the objectness score of the bounding box and the last 80 dimensions correspond to the one-hot encoded class prediction of the bounding box. The following 4 losses are calculated:", "2. BCE of objectness score of a bounding box", "3. BCE of no objectness score of a bounding box", "4. BCE of multi-class predictions of a bounding box", "The detailed implementation codes is by https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b. Explanations and tensor shapes are appended to help explain the codes below.", "The Yolo Layer takes in a convoluted feature of shape(batch_size x num_of_anchor_boxes x grid_size x grid_size x 85 dimensions) to calculate the 4 above losses. Firstly, based on labelled targets, it first creates Obj Mask of shape((batch_size x num_of_anchor_boxes x grid_size x grid_size x 85 dimensions) to indicate which bounding boxes should contain predictions and Noobj Mask of shape(batch_size x num_of_anchor_boxes x grid_size x grid_size x 85 dimensions) to indicate which bounding boxes should not contain predictions. With the masks, the targets can be successfully compared to the predictions in the same shape to calculate the four losses. See below for detailed implementation.", "A batch_size targets is picked up from the dataset set as follows:", "Based on the labelled targets, build_targets function below creates obj mask of shape(batch_size x num_of_anchorboxes x gridsize x gridsize) to indicate which bounding boxes should contain predictions and noobj mask of shape(batch_size x num_of_anchorboxes x gridsize x gridsize) to indicate which bounding boxes should not contain predictions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8878bfaaf1ff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://eugene-chian.medium.com/?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": ""}, {"url": "https://eugene-chian.medium.com/?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": "Hugegene"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2f6311f540e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&user=Hugegene&userId=2f6311f540e9&source=post_page-2f6311f540e9----8878bfaaf1ff---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8878bfaaf1ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8878bfaaf1ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b", "anchor_text": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b"}, {"url": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b", "anchor_text": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b"}, {"url": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b", "anchor_text": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b"}, {"url": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b", "anchor_text": "https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----8878bfaaf1ff---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----8878bfaaf1ff---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/yolov3?source=post_page-----8878bfaaf1ff---------------yolov3-----------------", "anchor_text": "Yolov3"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8878bfaaf1ff---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8878bfaaf1ff---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8878bfaaf1ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&user=Hugegene&userId=2f6311f540e9&source=-----8878bfaaf1ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8878bfaaf1ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&user=Hugegene&userId=2f6311f540e9&source=-----8878bfaaf1ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8878bfaaf1ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8878bfaaf1ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8878bfaaf1ff---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8878bfaaf1ff--------------------------------", "anchor_text": ""}, {"url": "https://eugene-chian.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://eugene-chian.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hugegene"}, {"url": "https://eugene-chian.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "https://www.linkedin.com/in/eugene-c-616768142/", "anchor_text": "https://www.linkedin.com/in/eugene-c-616768142/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2f6311f540e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&user=Hugegene&userId=2f6311f540e9&source=post_page-2f6311f540e9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcb798ef7a5f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcalculating-loss-of-yolo-v3-layer-8878bfaaf1ff&newsletterV3=2f6311f540e9&newsletterV3Id=cb798ef7a5f1&user=Hugegene&userId=2f6311f540e9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}