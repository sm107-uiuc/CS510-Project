{"url": "https://towardsdatascience.com/ds-in-the-real-world-5f77800aff78", "time": 1683004775.734978, "path": "towardsdatascience.com/ds-in-the-real-world-5f77800aff78/", "webpage": {"metadata": {"title": "Practical Estimation of Missing Values Using Conditional Expectation | by Young Li | Towards Data Science", "h1": "Practical Estimation of Missing Values Using Conditional Expectation", "description": "Handling missing values is a thorny problem in Data Science. There are various approaches, and some are listed below: Although we can choose to discard records containing missing features, it\u2019s often\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Handling missing values is a thorny problem in Data Science. There are various approaches, and some are listed below:", "Although we can choose to discard records containing missing features, it\u2019s often not desirable considering that non-missing features in those records can provide valuable information.", "Mean substitution can be considered a first-order approximation approach, taking into account the only first moment of distribution.", "Machine learning-based methodology, on the other hand, is usually computationally expensive and lacking intuitive explainability. It\u2019s a research frontier, and active researches are underway.", "In this post, I propose a simple method that exploits the second moment in addition to the first and show that it provides us with a much better estimator.", "Assume a k-dimensional random vector X follows a multivariate normal distribution,", "where \u03bc is the mean vector and \u03a3 the k*k covariance matrix. If X is partitioned into two sub-vectors X1 and X2 with sizes q*1 and (k-q)*1 respectively, then X1 conditional on X2=x2 follows a multivariate normal distribution with the following mean and covariance matrix:", "Assume that for a particular record, X1 is the vector of missing-value features and X2 the vector of valid-value features. Using the above equation for \u03bc(X1|x\u2082) we can estimate the values of X1, where \u03bc and \u03a3 are substituted with means and covariance matrix of samples excluding missing-value records. This can be considered (up to) a second-order approximation as it employs both first and second moments. Multiple missing features can be estimated at once.", "The conditional-expectation method described above doesn\u2019t apply to categorical features directly, but with a one-hot vector conversion, it can be used just as well. Steps are:", "Assume that a feature takes only positive values, but estimate given by equation (1) doesn\u2019t guarantee positiveness. However, using proper variable transformation we can enforce this constraint. Assume x is a positive valued feature. Let\u2019s log-transform x and replace it with the transformed feature u= log(x) in the data set. Since u can take either positive or negative values, we can then estimate u instead of x. Finally, we can back out x by exp(u), which is always positive.", "Assume a feature x is bounded in the range (a, b). We can introduce an unbounded variable u such that", "where 1/(1 + exp(-u)) is the Sigmoid function whose value is within (0, 1). u is expressed by x as u = -log( (b-a)/(x-a) -1). We can then replace x with u in a data set, estimate missing u\u2019s, and finally calculate missing x\u2019s.", "Assume a feature X\u2081 is always greater than another feature X\u2082, X\u2081 > X\u2082. To enforce such a constraint for estimates, we can use a transformed feature X\u2081\u2019 = log(X\u2081-X\u2082) to replace X\u2081 in the data set. After X\u2081\u2019 is estimated, we can then back out X\u2081,", "which guarantees that X\u2081 > X\u2082.", "To assess how well the conditional-expectation method performs in practice, the Appliances energy prediction data set on the UCI Machine Learning Repository [2] is used. It\u2019s an experimental data set intended for regression analysis of appliances energy use in a low energy building. It has 19,735 records and 29 features, including two random variables rv1 and rv2. Feature description is pasted below:", "Three features, T3, Windspeed, and rv1, are picked for evaluation. 10% of the records are randomly selected, and the three features are marked \u201cmissing\u201d for the selected records. The date feature is replaced with two categorical features Dayofweek and Month, which are then converted to one-hot vectors. These missing values are then estimated using the method described in section 1 and compared with their true values. The resultant root mean squared errors (RMSE) for three estimators are summarized below:", "To get a rough idea of how highly each feature is correlated with others, the average of absolute correlation coefficients of each feature with the others is calculated and shown in the following table:", "T3 is most highly correlated with other features whereas rv1 is the one with the lowest correlation. This explains the different levels of estimation RMSEs for the three features.", "Dayofweek, extracted from date feature, is picked for evaluation. 10% of the records are randomly selected, and Dayofweek is marked \u201cmissing\u201d. These missing values are then estimated using the procedure described in section 1.1. The estimation accuracy is 33%. This doesn\u2019t seem high, but if we pick the most frequent Dayofweek Tuesday as our estimate, then the accuracy is only 15%!", "It\u2019s true that few real-world features follow the multivariate normal distribution. The proposed conditional-expectation method is based on the normality assumption, but is it a reasonable assumption? It depends on the available information. It\u2019s known that the multivariate normal distribution is the maximum entropy distribution given the means and covariance matrix of random variables [3]. So when the only information known is the first and second moments, the multivariate normal distribution is a rational assumption in practice. My evaluation with the Appliances energy prediction data set suggests that the normality assumption can lead to a robust and intuitive estimator of real-world missing values.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5f77800aff78&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5f77800aff78--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5f77800aff78--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@yang.x.li.99?source=post_page-----5f77800aff78--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yang.x.li.99?source=post_page-----5f77800aff78--------------------------------", "anchor_text": "Young Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F70fac7802f2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&user=Young+Li&userId=70fac7802f2d&source=post_page-70fac7802f2d----5f77800aff78---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5f77800aff78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5f77800aff78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/tNALoIZhqVM", "anchor_text": "Mike Kenneally"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://archive.ics.uci.edu/ml/datasets/Appliances+energy+prediction", "anchor_text": "http://archive.ics.uci.edu/ml/datasets/Appliances+energy+prediction"}, {"url": "https://canvas.harvard.edu/files/3549960/download?download_frd=1", "anchor_text": "https://canvas.harvard.edu/files/3549960/download?download_frd=1"}, {"url": "https://medium.com/tag/ds-in-the-real-world?source=post_page-----5f77800aff78---------------ds_in_the_real_world-----------------", "anchor_text": "Ds In The Real World"}, {"url": "https://medium.com/tag/math?source=post_page-----5f77800aff78---------------math-----------------", "anchor_text": "Math"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5f77800aff78---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----5f77800aff78---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----5f77800aff78---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5f77800aff78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&user=Young+Li&userId=70fac7802f2d&source=-----5f77800aff78---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5f77800aff78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&user=Young+Li&userId=70fac7802f2d&source=-----5f77800aff78---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5f77800aff78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5f77800aff78--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5f77800aff78&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5f77800aff78---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5f77800aff78--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5f77800aff78--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5f77800aff78--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5f77800aff78--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5f77800aff78--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5f77800aff78--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5f77800aff78--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5f77800aff78--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yang.x.li.99?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yang.x.li.99?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Young Li"}, {"url": "https://medium.com/@yang.x.li.99/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F70fac7802f2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&user=Young+Li&userId=70fac7802f2d&source=post_page-70fac7802f2d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F70fac7802f2d%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fds-in-the-real-world-5f77800aff78&user=Young+Li&userId=70fac7802f2d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}