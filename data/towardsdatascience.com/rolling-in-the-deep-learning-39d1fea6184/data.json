{"url": "https://towardsdatascience.com/rolling-in-the-deep-learning-39d1fea6184", "time": 1683000216.6787462, "path": "towardsdatascience.com/rolling-in-the-deep-learning-39d1fea6184/", "webpage": {"metadata": {"title": "Rolling in the Deep Learning. Training AI on existing artists to\u2026 | by Tyler Freeman | Towards Data Science", "h1": "Rolling in the Deep Learning", "description": "I made this music video using several machine learning techniques. The music was generated by an AI trained on Adele\u2019s album \u201c21\u201d for two weeks. The visuals were generated by an AI that created\u2026"}, "outgoing_paragraph_urls": [{"url": "http://dadabots.com/", "anchor_text": "dadabots have used SampleRNN to make an endless death metal radio station.", "paragraph_index": 3}, {"url": "https://www.youtube.com/watch?v=exXUPJRZKZ0", "anchor_text": "\u201cDeep The Beatles\u201d album.", "paragraph_index": 3}, {"url": "https://cloud.google.com/deep-learning-vm/", "anchor_text": "Google Cloud Deep Learning VM image", "paragraph_index": 6}, {"url": "https://github.com/Unisound/SampleRNN", "anchor_text": "SampleRNN for Tensorflow code", "paragraph_index": 6}, {"url": "https://linuxize.com/post/how-to-use-linux-screen/", "anchor_text": "screen Linux utility", "paragraph_index": 7}, {"url": "https://www.youtube.com/watch?v=pM9u9xcM_cs", "anchor_text": "Yacht\u2019s techniques for working with machine learning", "paragraph_index": 14}, {"url": "https://youtu.be/LVtWunaTyZs", "anchor_text": "the music you heard in the beginning", "paragraph_index": 17}, {"url": "https://runwayml.com", "anchor_text": "Runway", "paragraph_index": 20}, {"url": "https://docs.runwayml.com/#/tutorials/tutorial_t2i", "anchor_text": "AttnGAN model", "paragraph_index": 21}, {"url": "https://p5js.org", "anchor_text": "P5.js", "paragraph_index": 22}, {"url": "http://odbol.com", "anchor_text": "http://odbol.com", "paragraph_index": 25}], "all_paragraphs": ["I made this music video using several machine learning techniques. The music was generated by an AI trained on Adele\u2019s album \u201c21\u201d for two weeks. The visuals were generated by an AI that created images from each line of the lyrics of her song \u201cRolling in the Deep\u201d. Together they create an interesting and perhaps unsettling view of machine-assisted creation.", "It all started with an event/game my friends and I play called Cover Me Badd. It\u2019s kind of like take-home karaoke, or DIYMTV. Every quarter, you form a band, then choose a cover song. But you don\u2019t get to cover that song. We throw all the songs into a hat (well, a virtual hat), mix them up, and dole them out to each band randomly, so you have to cover a song that someone else submitted. Then you record the song and make a music video, and we get together at the end for a big party and watch all the videos.", "This quarter I was given Adele\u2019s \u201cRolling in the Deep\u201d to cover. I knew there was no way I could do the song justice as I have a terrible singing voice. So I trained a robot to sing for me.", "I had recently found out about SampleRNN, which is a machine learning algorithm that can learn from audio samples and then spit out similar sounds as output. The group dadabots have used SampleRNN to make an endless death metal radio station. They also trained a model on The Beatles to create the \u201cDeep The Beatles\u201d album.", "The concept is somewhat simple: you take a source of music (as PCM .wav files), chop it up into little segments, then randomly pick from those segments and feed them into a Recurrent Neural Network. Each time you feed it some segments, the model becomes better at emulating that sound. The first 500\u20131000 iterations will be noise and static, but after a while its output will start to take shape and sound similar to what you feed it. It can emulate voice, guitar, piano, drums\u2014even all at once if that\u2019s what your training data is.", "Now, if you were to train this model on your home computer, it could take months to get anything useful. What you need is an incredibly powerful GPU built specifically for machine learning. At the time of this writing the best is the NVidia Tesla P100, which costs around $10,000 if you want your own. Luckily, we can simply rent one from the cloud instead (which still turns out to be a significant cost, but much less that investing in your own hardware).", "There are several companies who will let you use their fancy GPUs in the cloud. Since I work at Google, I decided to use Google Cloud Platform\u2019s Compute Engine. They have a pre-built VM image with all the NVidia CUDA drivers and machine learning software like Tensorflow already installed and ready for use in their Google Cloud Deep Learning VM image. You basically just click the button, it provisions a VM with a Tesla GPU for you, and then you log in and copy over your music files and the SampleRNN for Tensorflow code, and start training right away.", "Tip: make sure to run the screen Linux utility before you run the training command, so it won\u2019t get killed when you log out.", "Then you wait. I trained my model for about 4500 iterations which took about two weeks straight. (At the 50 cents an hour it costs for the Tesla VM, that\u2019s about $170. So yeah, creating your own singing robot is not exactly cheap.)", "I would log in every day and check the latest samples to make sure they were good. A couple times, the code crashed because of out-of-bounds infinite values. That\u2019s ok, you can just delete the last few snapshots and restart the training from there and it usually works out.", "Once I was satisfied with the progress (at about iteration 3500), I stopped the training, and bumped up the sample output duration from generating 3-second clips every 10 iterations (good for tests since they slow down the training process), to generating 8-second clips every single iteration. I let that run for another couple days to generate a good corpus of material I could draw from.", "I then downloaded all the samples I had generated from the cloud to my computer, and started the long, laborious process of categorizing them. There is a lot of hidden human labor behind AI creations, all the way from collecting data from human-created content, to using digital laborers in developing countries (e.g. Mechanical Turk) to label training data, to aggregating and sorting the output of the model and fine-tuning parameters.", "I experienced the latter first-hand. My categorization system was based on macOS\u2019s Finder color labels:", "Since I was categorizing nearly 1500 clips (only iterations 3000 to 4500 were listenable), and there were 10 clips per iteration, I would sample a couple clips from each iteration. If something was truly promising I would listen to more from the same iteration, but otherwise I tried to get through them as quickly as possible.", "Once I finished labeling the best samples, I had to arrange them into some kind of \u201csong\u201d, with a beginning, middle, and climatic ending, to hopefully craft a sort of journey instead of just random bits concatenated together. I was really inspired by the band Yacht\u2019s techniques for working with machine learning, and tried to adapt the \u201crules\u201d they imposed upon their creative process when working with AI:", "As some of you might know, using machine learning to make a song with structure, with a beginning, middle, and end, with a verse, chorus, verse, is a little bit, still, out of our reach. But that\u2019s a good thing because the melody was the model\u2019s job, but the arrangement and the performance was entirely our job.", "So for us we decided that every single song that we\u2019re going to create with this process had to be interpolated from existing melodies from our back catalog\u2026 We decided also that we could not add any notes. We could not add any harmonies. We could not jam or improvise or otherwise interpret or, essentially, be creative in any way. There was no additive alteration, only subtractive or transpositional changes\u2026 And we could structure and cut up and collage as much as we wanted.", "Now, the rules they came up with were for working with pure MIDI notes generated by an AI, not actual audio samples, so they had a bit more freedom, but I liked their tenacity and decided to work with their same constraints. Eventually I came up with the music you heard in the beginning.", "If I were to do it again, I think I would loosen the constraints somewhat and try to layer the samples generated by the AI over some more coherent beats, to at least keep a steady rhythm, since the AI samples are very arhythmic and chaotic. Or I would splice out certain sounds from the generated samples and use them in a sampler to compose my own melodies.", "I also have a hypothesis that might improve the model\u2019s sense of rhythm. Instead of cutting up the training input randomly at fixed 3-second intervals and throwing it into the model, instead timewarp all the songs to be the same tempo. Then cut them up into samples that are the duration of a bar or some other fixed number of beats according to the tempo, and feed that to the neural net. If you can feed it training data that all has the same regular tempo, it might pick up on more rhythmic queues and learn to make more steady drumbeats. Something to try for the next time.", "Since Cover Me Badd requires a music video, I needed some visuals. I had just heard about this new app called Runway, which is pretty brilliant especially for artists looking to get started with ML. It opens up access to dozens of different machine learning models, pre-trained and ready to use at the click of a button. You can just type or drag-and-drop your input (text, images, video, etc), and it will run it through the model either on your local machine or in their cloud and give you the result. It has a great API too that can accept input and produce output via MIDI, OSC, or HTTP/JSON, so you can interface it into many different musical instruments/apps, or your own code.", "I decided to use the AttnGAN model in Runway, which accepts text as input and generates an image as output. I wired it up to some Javascript I wrote to feed it the lyrics of Adele\u2019s \u201cRolling in the Deep\u201d, line-by-line, one image per line. I really love the abstract yet chillingly recognizable images it generates.", "I first wanted to scroll all the images by along with the lyrics that generated them, however that turned out to be way too much to look at at once. So I removed the lyrics, and wrote a small algorithm using P5.js to \u201cmelt\u201d the images into one another as they scrolled by. Threw them all together and viola! I sucessfully avoided playing any music for my Cover Me Badd submission!", "One memorable remark from my friend at the listening party was, \u201cThis robot needs to learn to make music better!\u201d Well, yes, but for $200 that\u2019s the best it\u2019s gonna learn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Wearables engineer, New Media artist, VJ, cybertechnician pursuing new styles of interfaces through the body and mind to the computer. http://odbol.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F39d1fea6184&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----39d1fea6184--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----39d1fea6184--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@odbol?source=post_page-----39d1fea6184--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@odbol?source=post_page-----39d1fea6184--------------------------------", "anchor_text": "Tyler Freeman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F344ff6d684ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&user=Tyler+Freeman&userId=344ff6d684ab&source=post_page-344ff6d684ab----39d1fea6184---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39d1fea6184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39d1fea6184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://dadabots.com/", "anchor_text": "dadabots have used SampleRNN to make an endless death metal radio station."}, {"url": "https://www.youtube.com/watch?v=exXUPJRZKZ0", "anchor_text": "\u201cDeep The Beatles\u201d album."}, {"url": "https://cloud.google.com/deep-learning-vm/", "anchor_text": "Google Cloud Deep Learning VM image"}, {"url": "https://github.com/Unisound/SampleRNN", "anchor_text": "SampleRNN for Tensorflow code"}, {"url": "https://linuxize.com/post/how-to-use-linux-screen/", "anchor_text": "screen Linux utility"}, {"url": "https://www.youtube.com/watch?v=pM9u9xcM_cs", "anchor_text": "Yacht\u2019s techniques for working with machine learning"}, {"url": "https://youtu.be/LVtWunaTyZs", "anchor_text": "the music you heard in the beginning"}, {"url": "https://runwayml.com", "anchor_text": "Runway"}, {"url": "https://docs.runwayml.com/#/tutorials/tutorial_t2i", "anchor_text": "AttnGAN model"}, {"url": "https://p5js.org", "anchor_text": "P5.js"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----39d1fea6184---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----39d1fea6184---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/music?source=post_page-----39d1fea6184---------------music-----------------", "anchor_text": "Music"}, {"url": "https://medium.com/tag/ai?source=post_page-----39d1fea6184---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/music-video?source=post_page-----39d1fea6184---------------music_video-----------------", "anchor_text": "Music Video"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F39d1fea6184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&user=Tyler+Freeman&userId=344ff6d684ab&source=-----39d1fea6184---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F39d1fea6184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&user=Tyler+Freeman&userId=344ff6d684ab&source=-----39d1fea6184---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39d1fea6184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----39d1fea6184--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F39d1fea6184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----39d1fea6184---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----39d1fea6184--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----39d1fea6184--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----39d1fea6184--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----39d1fea6184--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----39d1fea6184--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----39d1fea6184--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----39d1fea6184--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----39d1fea6184--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@odbol?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@odbol?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tyler Freeman"}, {"url": "https://medium.com/@odbol/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "347 Followers"}, {"url": "http://odbol.com", "anchor_text": "http://odbol.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F344ff6d684ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&user=Tyler+Freeman&userId=344ff6d684ab&source=post_page-344ff6d684ab--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6e7c3342e7bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frolling-in-the-deep-learning-39d1fea6184&newsletterV3=344ff6d684ab&newsletterV3Id=6e7c3342e7bc&user=Tyler+Freeman&userId=344ff6d684ab&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}