{"url": "https://towardsdatascience.com/functions-in-power-bi-56e9e11e4669", "time": 1683013927.049319, "path": "towardsdatascience.com/functions-in-power-bi-56e9e11e4669/", "webpage": {"metadata": {"title": "power query functions, power query functions list,power query functions table, power bi functions, power query functions custom, functions apply | Towards Data Science", "h1": "Functions in Power BI", "description": "Article is about using functions in Power Query"}, "outgoing_paragraph_urls": [{"url": "https://youtu.be/Ar_fV_oXSNs", "anchor_text": "functions", "paragraph_index": 36}], "all_paragraphs": ["Cleaning, wrangling and summarizing. I don\u2019t know about you but I enjoy this process of data analysis. Power Query is the main tool I use for this. I\u2019ll be writing more about Power Query in the future.", "I clean because the data is dirty. I clean because I want good data for analysis. I wrangle to get the right \u201cshape\u201d for joins to work. It\u2019s dreadful if you have to clean data manually and it\u2019s prone to cleaning errors. Imagine error on top of errors? What will you really be analyzing?", "Don\u2019t worry. Functions \u2014 much like those cute little robots on top can come to the rescue.", "What exactly is a function anyways? A quick google search gives this definition.", "\u201cA function is a block of organized, reusable code that is used to perform a single, related action. \u2026 Different programming languages name them differently, for example, functions, methods, sub-routines, procedures, etc.\u201d", "The keyword here is reusable. It has to be reusable for it to be a function. That means you can use this code and apply it to not just one file but other files as well. I think of a function as something that takes inputs, performs a custom set of procedures, and gives an output.", "A lot of what you use today, for example, the sum function in Power BI to the joins are functions.", "For example\u200a\u2014\u200atake a look at this function in M (Power Query Language)", "The problem is\u2026sometimes we don\u2019t have functions that are available to us that quite meet our needs. We want to apply a custom set of procedures to various files. This is why and when we have to use it.", "Let\u2019s go through how to create functions in Power BI in Power Query. With all the cleaning and wrangling in life, I\u2019m sure this will be very useful to us.", "As the stick figure mentioned, We have several different files across the years. we need to perform these same actions across all the files.", "We don\u2019t want to do this procedure to each one of the files but we want the function to do this for us.", "To get started, let\u2019s load in all our files in a folder.", "After you\u2019ve loaded all your files, you should see them displayed as below.", "Let\u2019s start by creating a \u201cDuplicate\u201d of the main file \u2014 we want to build a function from this duplicate.", "Now that there is a duplicate, we keep only the first row to build the function.", "Power BI keeps only the first row. Nice.", "Here is a neat and important trick \u2014 you can type in [Content] which refers to the column and {0} which refers to the actual \u201ccell\u201d itself. If you have more of a technical understanding, I am referring to the column and returning a list, then referring to the list value 0 to return the binary file.", "If you don\u2019t like typing, you can also click on \u201cdrill down\u201d on the binary file itself.", "Power BI neatly loads the file without those automatic transformations.", "Now let\u2019s do our quick summary using group by. You can find \u201cGroup By\u201d under the Transform Ribbon on the top of the pane.", "Here is our result for one of the files.", "This is exactly what we need.", "Not done yet, let\u2019s make it into an actual function.", "You can do this by going to the Advance Editor option under the Transform Ribbon.", "Power BI records all the steps and turns it into an M script for us. If you are familiar with Excel, it\u2019s like a recorded macro. we just need to change the reference so that it can be applied to other files.", "You don\u2019t need to know how to type out all the M code below. The beauty of Power BI is that it records all these steps for you. I will be writing a bit more about how to read M scripts in the near future.", "Don\u2019t let this overwhelm you, the only thing we care about is the Csv.Document part.", "Let\u2019s remove everything above the Csv.Document part and declare our variable. I chose (X as binary) because we want this function to have a binary input.", "Remember all those csv files on the folder? They are binary files.", "Now let\u2019s apply this to our files. Let\u2019s \u201cinvoke\u201d our custom function. You can find \u201cinvoke\u201d under the \u201cadd column\u201d\u00a0ribbon.", "Sounds like something out of Harry Potter right?", "Let\u2019s hit expand for our final table.", "Male and Female by average salary by year.", "Now, this is a simple data set but you can also build in joins and other much more complex transformations into a function and apply it to all the files.", "TL:DR? I built this for you.", "If you\u2019d like to watch a video instead \u2014 Curbal is a channel that has really taught me a lot about functions and of course Power BI.", "Stay safe and hope this helps you with your journey with data!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about Power BI, Power Automate and other cool Microsoft power tools. Microsoft certified data analyst. Constant learner and an aspiring writer. \ud83d\udc4d"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F56e9e11e4669&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://peter-hui.medium.com/?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": ""}, {"url": "https://peter-hui.medium.com/?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": "Peter Hui"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F62a43e57781b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&user=Peter+Hui&userId=62a43e57781b&source=post_page-62a43e57781b----56e9e11e4669---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56e9e11e4669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56e9e11e4669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ekrull?utm_source=medium&utm_medium=referral", "anchor_text": "Eric Krull"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://youtu.be/Ar_fV_oXSNs", "anchor_text": "functions"}, {"url": "https://medium.com/tag/data-science?source=post_page-----56e9e11e4669---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----56e9e11e4669---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/power-bi?source=post_page-----56e9e11e4669---------------power_bi-----------------", "anchor_text": "Power Bi"}, {"url": "https://medium.com/tag/programming?source=post_page-----56e9e11e4669---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----56e9e11e4669---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56e9e11e4669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&user=Peter+Hui&userId=62a43e57781b&source=-----56e9e11e4669---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F56e9e11e4669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&user=Peter+Hui&userId=62a43e57781b&source=-----56e9e11e4669---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F56e9e11e4669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F56e9e11e4669&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----56e9e11e4669---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----56e9e11e4669--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----56e9e11e4669--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----56e9e11e4669--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----56e9e11e4669--------------------------------", "anchor_text": ""}, {"url": "https://peter-hui.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://peter-hui.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Peter Hui"}, {"url": "https://peter-hui.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "592 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F62a43e57781b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&user=Peter+Hui&userId=62a43e57781b&source=post_page-62a43e57781b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd0268e337bf9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffunctions-in-power-bi-56e9e11e4669&newsletterV3=62a43e57781b&newsletterV3Id=d0268e337bf9&user=Peter+Hui&userId=62a43e57781b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}