{"url": "https://towardsdatascience.com/the-battle-of-speed-vs-23b61eb4225d", "time": 1683004599.532959, "path": "towardsdatascience.com/the-battle-of-speed-vs-23b61eb4225d/", "webpage": {"metadata": {"title": "The Battle of Speed vs. Accuracy: Single-Shot vs. Two-Shot Detection Meta-Architectures \u2014 Allegro AI | by Dan Malowany | Towards Data Science", "h1": "The Battle of Speed vs. Accuracy: Single-Shot vs. Two-Shot Detection Meta-Architectures \u2014 Allegro AI", "description": "Deep neural networks for object detection tasks is a mature research field. That said, making the correct tradeoff between speed and accuracy when building a given model for a target use-case is an\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/gal-hyams-2146a662/", "anchor_text": "Gal Hyams", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/dan-malowany-78b2b21/", "anchor_text": "Dan Malowany", "paragraph_index": 0}, {"url": "https://medium.com/u/7743e9a45144?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "Allegro AI Team", "paragraph_index": 0}, {"url": "http://papers.nips.cc/paper/5638-faster-r-cnn-towards-real-time-object-detection-with-region-proposal-networks", "anchor_text": "Faster-RCNN", "paragraph_index": 4}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2016/html/Redmon_You_Only_Look_CVPR_2016_paper.html", "anchor_text": "YOLO", "paragraph_index": 4}, {"url": "http://papers.nips.cc/paper/6465-r-fcn-object-detection-via-region-based-fully-convolutional-networks.pdf", "anchor_text": "R-FCN (Region-Based Fully Convolutional Networks)", "paragraph_index": 5}, {"url": "http://openaccess.thecvf.com/content_iccv_2017/html/Lin_Focal_Loss_for_ICCV_2017_paper.html", "anchor_text": "Focal Loss", "paragraph_index": 16}], "all_paragraphs": ["Written by Gal Hyams and Dan MalowanyAllegro AI Team", "Deep neural networks for object detection tasks is a mature research field. That said, making the correct tradeoff between speed and accuracy when building a given model for a target use-case is an ongoing decision that teams need to address with every new implementation. Although many object detection models have been researched over the years, the single-shot approach is considered to be in the sweet spot of the speed vs. accuracy trade-off. In this post (part IIA), we explain the key differences between the single-shot (SSD) and two-shot approach. Since its release, many improvements have been constructed on the original SSD. However, we have focused on the original SSD meta-architecture for clarity and simplicity. In the following post (part IIB), we will show you how to harness pre-trained Torchvision feature-extractor networks to build your own SSD model.", "In object detection tasks, the model aims to sketch tight bounding boxes around desired classes in the image, alongside each object labeling. See Figure 1 below.", "There are two common meta-approaches to capture objects: two-shot and single-shot detection.", "The two-shot detection model has two stages: region proposal and then classification of those regions and refinement of the location prediction. Single-shot detection skips the region proposal stage and yields final localization and content prediction at once. Faster-RCNN variants are the popular choice of usage for two-shot models, while single-shot multibox detector (SSD) and YOLO are the popular single-shot approach. YOLO architecture, though faster than SSD, is less accurate.", "R-FCN (Region-Based Fully Convolutional Networks) is another popular two-shot meta-architecture, inspired by Faster-RCNN. In this approach, a Region Proposal Network (RPN) proposes candidate RoIs (region of interest), which are then applied on score maps. All learnable layers are convolutional and computed on the entire image. There, almost all of the different proposed regions\u2019 computation is shared. The per-RoI computational cost is negligible compared with Fast-RCNN. R-FCN is a sort of hybrid between the single-shot and two-shot approach. When you really look into it, you see that it actually is a two-shot approach with some of the single-shot advantages and disadvantages.", "While two-shot detection models achieve better performance, single-shot detection is in the sweet spot of performance and speed/resources. In addition, SSD trains faster and has swifter inference than a two-shot detector. Faster training allows the researcher to efficiently prototype & experiment without consuming considerable expenses for cloud computing. More importantly, the fast inference property is typically a requirement when it comes to real-time applications. As it involves less computation, it, therefore, consumes much less energy per prediction. This time and energy efficiency opens new doors for a wide range of usages, especially on end-devices and positions SSD as the preferred object detection approach for many usages.", "Lately, hierarchical deconvolution approaches, such as deconvolutional-SSD (DSSD) and feature pyramid network (FPN), have become a necessity for any object detection architecture. The hierarchical deconvolution suffix on top of the original architecture enables the model to reach superior generalization performance across different object sizes which significantly improves small object detection. As our aim here is to detail the differences between one and two-shot detectors and how to easily build your own SSD, we decided to use the classic SSD and FasterRCNN.", "Faster R-CNN detection happens in two stages. The first stage is called region proposal . Images are processed by a feature extractor, such as ResNet50, up to a selected intermediate network layer. Then, a small fully connected network slides over the feature layer to predict class-agnostic box proposals, with respect to a grid of anchors tiled in space, scale and aspect ratio (figure 3).", "In the second stage, these box proposals are used to crop features from the intermediate feature map which was already computed in the first stage. The proposed boxes are fed to the remainder of the feature extractor adorned with prediction and regression heads, where class and class-specific box refinement are calculated for each proposal.", "Although Faster-RCNN avoids duplicate computation by sharing the feature-map computation between the proposal stage and the classification stage, there is a computation that must be run once per region. Thus, Faster-RCNN running time depends on the number of regions proposed by the RPN .", "The SSD meta-architecture computes the localization in a single, consecutive network pass. Similar to Fast-RCNN, the SSD algorithm sets a grid of anchors upon the image, tiled in space, scale, and aspect ratio boxes (figure 4). As opposed to two-shot methods, the model yields a vector of predictions for each of the boxes in a consecutive network pass. This vector holds both a per-class confidence-score, localization offset, and resizing.", "The class confidence score indicates the presence of each class instance in this box, while the offset and resizing state the transformation that this box should undergo in order to best catch the object it allegedly covers. To get a decent detection performance across different object sizes, the predictions are computed across several feature maps\u2019 resolutions. Each feature map is extracted from the higher resolution predecessor\u2019s feature map, as illustrated in figure 5 below.", "The multi-scale computation lets SSD detect objects in a higher resolution feature map compared to FasterRCNN. FasterRCNN detects over a single feature map and is sensitive to the trade-off between feature-map resolution and feature maturity. SSD can enjoy both worlds. On a 512\u00d7512 image size, the FasterRCNN detection is typically performed over a 32\u00d732 pixel feature map (conv5_3) while SSD prediction starts from a 64\u00d764 one (conv4_3) and continues on 32\u00d732, 16\u00d716 all the way to 1\u00d71 to a total of 7 feature maps (when using the VGG-16 feature extractor).", "The separated classifiers for each feature map lead to an unfortunate SSD tendency of missing small objects. Usually, the model does not see enough small instances of each class during training. Zoom augmentation, which shrinks or enlarges the training images, helps with this generalization problem. On the other hand, SSD tends to predict large objects more accurately than FasterRCNN. Figure 4 illustrates the anchor predictions across different feature maps. Why SSD is faster than Faster-RCNN?", "As can be seen in figure 6 below , the single-shot architecture is faster than the two-shot architecture with comparable accuracy. There are two reasons why the single-shot approach achieves its superior efficiency:", "The Focal Loss paper investigates the reason for the inferior single-shot performances. After all, it is hard to put a finger on why two-shot methods effortlessly hold the \u201cstate-of-the-art throne\u201d. The paper suggests that the difference lies in foreground/background imbalance during training.", "Two-stage detectors easily handle this imbalance. The RPN narrows down the number of candidate object-locations, filtering out most background instances. On top of this, sampling heuristics, such as online hard example mining, feeds the second-stage detector of the two-stage model with balanced foreground/background samples. In contrast, the detection layer of a one-stage model is exposed to a much larger set of candidate object-locations, most of which are background instances that densely cover spatial positions, scales, and aspect ratios during training. While two-shot classifier sample heuristics may also be applied, they are inefficient for a single-shot model training as the training procedure is still dominated by easily classified background examples. The Focal Loss approach concentrates the training loss on difficult instances, which tend to be foreground examples. In doing so, it works to balance the unbalanced background/foreground ratio and leads the single-shot detector into the hall of fame of object detection model accuracy.", "It\u2019s clear that single-shot detectors, with SSD as their representative, are more cost-effective compared to the two-shot detectors. They achieve better performance in a limited resources use case. Moreover, when both meta-architectures harness a fast lightweight feature-extractor, SSD outperforms the two-shot models. On the other hand, when computing resources are less of an issue, two-shot detectors fully leverage the heavy feature extractors and provide more reliable results. The main hypothesis regarding this issue is that the difference in accuracy lies in foreground/background imbalance during training. Leveraging techniques such as focal loss can help handle this imbalance and lead the single-shot detector to be your choice of meta-architecture even from an accuracy point of view.", "The next post of this series, part IIB, is a tutorial-code where we put to use the knowledge gained here and demonstrate how to implement SSD meta-architecture on top of a Torchvision model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F23b61eb4225d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dan_41998?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dan_41998?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "Dan Malowany"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F679430f47f06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&user=Dan+Malowany&userId=679430f47f06&source=post_page-679430f47f06----23b61eb4225d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F23b61eb4225d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F23b61eb4225d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/data-science-in-the-real-world/home", "anchor_text": "DATA SCIENCE IN THE REAL WORLD"}, {"url": "https://www.linkedin.com/in/gal-hyams-2146a662/", "anchor_text": "Gal Hyams"}, {"url": "https://www.linkedin.com/in/dan-malowany-78b2b21/", "anchor_text": "Dan Malowany"}, {"url": "https://medium.com/u/7743e9a45144?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "Allegro AI Team"}, {"url": "http://host.robots.ox.ac.uk/pascal/VOC/voc2012/", "anchor_text": "dataset"}, {"url": "http://papers.nips.cc/paper/5638-faster-r-cnn-towards-real-time-object-detection-with-region-proposal-networks", "anchor_text": "Faster-RCNN"}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2016/html/Redmon_You_Only_Look_CVPR_2016_paper.html", "anchor_text": "YOLO"}, {"url": "http://papers.nips.cc/paper/6465-r-fcn-object-detection-via-region-based-fully-convolutional-networks.pdf", "anchor_text": "R-FCN (Region-Based Fully Convolutional Networks)"}, {"url": "https://arxiv.org/pdf/1611.10012.pdf", "anchor_text": "source"}, {"url": "http://papers.nips.cc/paper/5638-faster-r-cnn-towards-real-time-object-detection-with-region-proposal-networks", "anchor_text": "source"}, {"url": "https://link.springer.com/chapter/10.1007/978-3-319-46448-0_2", "anchor_text": "source]."}, {"url": "https://link.springer.com/chapter/10.1007/978-3-319-46448-0_2", "anchor_text": "source"}, {"url": "https://arxiv.org/pdf/1611.10012.pdf", "anchor_text": "source"}, {"url": "http://openaccess.thecvf.com/content_iccv_2017/html/Lin_Focal_Loss_for_ICCV_2017_paper.html", "anchor_text": "Focal Loss"}, {"url": "https://allegro.ai/blog/the-battle-of-speed-accuracy-single-shot-vs-two-shot-detection/", "anchor_text": "https://allegro.ai"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----23b61eb4225d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----23b61eb4225d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----23b61eb4225d---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/ds-in-the-real-world?source=post_page-----23b61eb4225d---------------ds_in_the_real_world-----------------", "anchor_text": "Ds In The Real World"}, {"url": "https://medium.com/tag/deep-learning-codebase?source=post_page-----23b61eb4225d---------------deep_learning_codebase-----------------", "anchor_text": "Deep Learning Codebase"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F23b61eb4225d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&user=Dan+Malowany&userId=679430f47f06&source=-----23b61eb4225d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F23b61eb4225d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&user=Dan+Malowany&userId=679430f47f06&source=-----23b61eb4225d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F23b61eb4225d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F23b61eb4225d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----23b61eb4225d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----23b61eb4225d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----23b61eb4225d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----23b61eb4225d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dan_41998?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dan_41998?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dan Malowany"}, {"url": "https://medium.com/@dan_41998/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "54 Followers"}, {"url": "https://il.linkedin.com/in/dan-malowany-78b2b21", "anchor_text": "https://il.linkedin.com/in/dan-malowany-78b2b21"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F679430f47f06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&user=Dan+Malowany&userId=679430f47f06&source=post_page-679430f47f06--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fee078f7a2215&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-battle-of-speed-vs-23b61eb4225d&newsletterV3=679430f47f06&newsletterV3Id=ee078f7a2215&user=Dan+Malowany&userId=679430f47f06&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}