{"url": "https://towardsdatascience.com/understanding-the-roc-curve-and-auc-dd4f9a192ecb", "time": 1683013794.727922, "path": "towardsdatascience.com/understanding-the-roc-curve-and-auc-dd4f9a192ecb/", "webpage": {"metadata": {"title": "Understanding the ROC Curve and AUC | by Doug Steen | Towards Data Science", "h1": "Understanding the ROC Curve and AUC", "description": "The receiver operating characteristic (ROC) curve is frequently used for evaluating the performance of binary classification algorithms. It provides a graphical representation of a classifier\u2019s\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "Heart Disease UCI", "paragraph_index": 15}, {"url": "https://www.linkedin.com/in/doug-steen/", "anchor_text": "https://www.linkedin.com/in/doug-steen/", "paragraph_index": 29}], "all_paragraphs": ["The receiver operating characteristic (ROC) curve is frequently used for evaluating the performance of binary classification algorithms. It provides a graphical representation of a classifier\u2019s performance, rather than a single value like most other metrics.", "First, let\u2019s establish that in binary classification, there are four possible outcomes for a test prediction: true positive, false positive, true negative, and false negative.", "The ROC curve is produced by calculating and plotting the true positive rate against the false positive rate for a single classifier at a variety of thresholds. For example, in logistic regression, the threshold would be the predicted probability of an observation belonging to the positive class. Normally in logistic regression, if an observation is predicted to be positive at > 0.5 probability, it is labeled as positive. However, we could really choose any threshold between 0 and 1 (0.1, 0.3, 0.6, 0.99, etc.) \u2014 and ROC curves help us visualize how these choices affect classifier performance.", "The true positive rate, or sensitivity, can be represented as:", "where TP is the number of true positives and FN is the number of false negatives. The true positive rate is a measure of the probability that an actual positive instance will be classified as positive.", "The false positive rate, or 1 \u2014 specificity, can be written as:", "where FP is the number of false positives and TN is the number of true negatives. The false positive rate is essentially a measure of how often a \u201cfalse alarm\u201d will occur \u2014 or, how often an actual negative instance will be classified as positive.", "Figure 1 demonstrates how some theoretical classifiers would plot on an ROC curve. The gray dotted line represents a classifier that is no better than random guessing \u2014 this will plot as a diagonal line. The purple line represents a perfect classifier \u2014 one with a true positive rate of 100% and a false positive rate of 0%. Nearly all real-world examples will fall somewhere between these two lines \u2014 not perfect, but providing more predictive power than random guessing. Typically, what we\u2019re looking for is a classifier that maintains a high true positive rate while also having a low false positive rate \u2014 this ideal classifier would \u201chug\u201d the upper left corner of Figure 1, much like the purple line.", "While it is useful to visualize a classifier\u2019s ROC curve, in many cases we can boil this information down to a single metric \u2014 the AUC.", "AUC stands for area under the (ROC) curve. Generally, the higher the AUC score, the better a classifier performs for the given task.", "Figure 2 shows that for a classifier with no predictive power (i.e., random guessing), AUC = 0.5, and for a perfect classifier, AUC = 1.0. Most classifiers will fall between 0.5 and 1.0, with the rare exception being a classifier performs worse than random guessing (AUC < 0.5).", "One advantage presented by ROC curves is that they aid us in finding a classification threshold that suits our specific problem.", "For example, if we were evaluating an email spam classifier, we would want the false positive rate to be really, really low. We wouldn\u2019t want someone to lose an important email to the spam filter just because our algorithm was too aggressive. We would probably even allow a fair amount of actual spam emails (true positives) through the filter just to make sure that no important emails were lost.", "On the other hand, if our classifier is predicting whether someone has a terminal illness, we might be ok with a higher number of false positives (incorrectly diagnosing the illness), just to make sure that we don\u2019t miss any true positives (people who actually have the illness).", "Additionally, ROC curves and AUC scores also allow us to compare the performance of different classifiers for the same problem.", "To demonstrate how the ROC curve is constructed in practice, I\u2019m going to work with the Heart Disease UCI data set in Python. The data set has 14 attributes, 303 observations, and is typically used to predict whether a patient has heart disease based on the other 13 attributes, which include age, sex, cholesterol level, and other measurements.", "Before I write a function to calculate false positive and true positive rate, I\u2019ll fit a vanilla Logistic Regression classifier on the training data, and make predictions on the test set.", "Calculating True Positive Rate and False Positive Rate", "Now that I have test predictions, I can write a function to calculate the true positive rate and false positive rate. This is a critical step, as these are the two variables needed to produce the ROC curve.", "The test shows that the function appears to be working \u2014 a true positive rate of 69% and a false positive rate of 19% are perfectly reasonable results.", "To obtain the ROC curve, I need more than one pair of true positive/false positive rates. I need to vary the threshold probability that the Logistic Regression classifier uses to predict whether a patient has heart disease (target=1) or doesn\u2019t (target=0). Remember, while Logistic Regression is used to assign a class label, what it\u2019s actually doing is determining the probability that an observation belongs to a specific class. In a typical binary classification problem, an observation must have a probability of > 0.5 to be assigned to the positive class. However, in this case, I will vary that threshold probability value incrementally from 0 to 1. This will result in the ranges of true positive rates and false positive rates that allow me to build the ROC curve.", "In the code blocks below, I obtain these true positive rates and false positive rates across a range of threshold probability values. For comparison, I use logistic regression with (1) no regularization and (2) L2 regularization.", "Both versions of the logistic regression classifier seem to do a pretty good job, but the L2 regularized version appears to perform slightly better.", "sklearn has an auc() function, which I\u2019ll make use of here to calculate the AUC scores for both versions of the classifier. auc() takes in the true positive and false positive rates we previously calculated, and returns the AUC score.", "As expected, the classifiers both have similar AUC scores, with the L2 regularized version performing slightly better.", "Now that we\u2019ve had fun plotting these ROC curves from scratch, you\u2019ll be relieved to know that there is a much, much easier way. sklearn\u2019s plot_roc_curve() function can efficiently plot ROC curves using only a fitted classifier and test data as input. These plots conveniently include the AUC score as well.", "If you\u2019ve made it this far, thanks for reading! I found it a valuable exercise to inefficiently create my own ROC curves in Python, and I hope you gained something from following along.", "Some helpful references on ROC and AUC:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analyst | Geologist | Data Science & ML Enthusiast | https://www.linkedin.com/in/doug-steen/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdd4f9a192ecb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@douglaspsteen?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@douglaspsteen?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": "Doug Steen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F803b3bd0d3bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&user=Doug+Steen&userId=803b3bd0d3bb&source=post_page-803b3bd0d3bb----dd4f9a192ecb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd4f9a192ecb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd4f9a192ecb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mpere?utm_source=medium&utm_medium=referral", "anchor_text": "Madeline Pere"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "Heart Disease UCI"}, {"url": "https://machinelearningmastery.com/assessing-comparing-classifier-performance-roc-curves-2/", "anchor_text": "Assessing and Comparing Classifier Performance with ROC Curves - Machine Learning MasteryThe most commonly reported measure of classifier performance is accuracy: the percent of correct classifications\u2026machinelearningmastery.com"}, {"url": "http://faculty.marshall.usc.edu/gareth-james/ISL/", "anchor_text": "Introduction to Statistical Learningwith Applications in R Gareth James, Daniela Witten, Trevor Hastie and Robert Tibshirani Home Download the book PDF\u2026faculty.marshall.usc.edu"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dd4f9a192ecb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----dd4f9a192ecb---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/model-evaluation?source=post_page-----dd4f9a192ecb---------------model_evaluation-----------------", "anchor_text": "Model Evaluation"}, {"url": "https://medium.com/tag/python?source=post_page-----dd4f9a192ecb---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----dd4f9a192ecb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd4f9a192ecb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&user=Doug+Steen&userId=803b3bd0d3bb&source=-----dd4f9a192ecb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd4f9a192ecb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&user=Doug+Steen&userId=803b3bd0d3bb&source=-----dd4f9a192ecb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd4f9a192ecb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdd4f9a192ecb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dd4f9a192ecb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dd4f9a192ecb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@douglaspsteen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@douglaspsteen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Doug Steen"}, {"url": "https://medium.com/@douglaspsteen/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "146 Followers"}, {"url": "https://www.linkedin.com/in/doug-steen/", "anchor_text": "https://www.linkedin.com/in/doug-steen/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F803b3bd0d3bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&user=Doug+Steen&userId=803b3bd0d3bb&source=post_page-803b3bd0d3bb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa2b35ecb3516&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-roc-curve-and-auc-dd4f9a192ecb&newsletterV3=803b3bd0d3bb&newsletterV3Id=a2b35ecb3516&user=Doug+Steen&userId=803b3bd0d3bb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}