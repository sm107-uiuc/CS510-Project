{"url": "https://towardsdatascience.com/big-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792", "time": 1683014406.534444, "path": "towardsdatascience.com/big-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792/", "webpage": {"metadata": {"title": "Big Data Transformations with Complex and Nested Data Types | by Garrett R Peternel | Towards Data Science", "h1": "Big Data Transformations with Complex and Nested Data Types", "description": "Apache Spark is a distributed computing big data analytics framework designed to transform, engineer, and process massive amounts of data (think terabytes and petabytes) across a cluster of machines\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Apache Spark is a distributed computing big data analytics framework designed to transform, engineer, and process massive amounts of data (think terabytes and petabytes) across a cluster of machines. Often working with diverse datasets, you will come across complex data types and formats that require expensive compute and transformations (think IoT devices). Extremely complicated and specialized, under the hood, Apache Spark is a master of its craft when it comes to scaling big data engineering efforts. In this blog using the native Scala API I will walk you through examples of 1.) how to flatten and normalize semi-structured JSON data with nested schema (array and struct), 2.) how to pivot your data, and 3.) how to save the data to storage as parquet schema for downstream analytics. To note, the same exercises can be achieved using the Python API and Spark SQL.", "1a.) Let\u2019s view our beautiful multi-line JSON schema (dummy data from my favorite video game).", "1b.) Next, to improve performance I will map and construct our schema as a new StructType() to avoid triggering an unnecessary Spark job when reading the JSON data.", "1c.) Now we can print our schema and examine the data, which you can see is a crazy bundle of joy because of the data types involved. There are 12 total rows with 5 columns in this dataset however we are seeing 2 rows with 2 columns in the native schema.", "1d.) It is time to normalize this dataset using built-in Spark DataFrame API functions including explode , which turn elements in array data types to individual rows and dots *, which unpack subfields in struct data types. Since the subclass and super columns have a 1 to 1 element pair mapping the slick arrays_zip function will also be used with dot selection to avoid creating extra row combinations during the exploding.", "1e.) It is time to check out the transformed dataset and its schema. As expected, it returns 12 rows with 5 columns.", "2a.) This next exercise will take our flattened dataset and apply pivot functions, which trigger a wide transformation where distinct values for a specific column are transposed into individual columns. Pivots can be performed with or without aggregation. Without aggregation is often a required schema for data science use cases using many columns a.k.a features as input to learning algorithms. An efficient performance tip is to specify your unique values in the pivot function input so Spark does not have to trigger an additional job.", "3a.) The final exercise will simply write out our data to storage. Parquet format will be used because it is a splittable file format, highly compressed for space efficiency, and optimized for columnar storage hence making it fabulous for downstream big data analytics.", "These exercises just scratch the surface of what Apache Spark is capable of for big data engineering and advanced analytics use cases. Thank you for reading this blog.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineering | Machine Learning | Solutions Architecture"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc1b9c45ca792&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@garrett.r.peternel?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@garrett.r.peternel?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": "Garrett R Peternel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6abb8b9bd26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&user=Garrett+R+Peternel&userId=6abb8b9bd26&source=post_page-6abb8b9bd26----c1b9c45ca792---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1b9c45ca792&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1b9c45ca792&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@viazavier?utm_source=medium&utm_medium=referral", "anchor_text": "Laura Ockel"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/spark?source=post_page-----c1b9c45ca792---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/scala?source=post_page-----c1b9c45ca792---------------scala-----------------", "anchor_text": "Scala"}, {"url": "https://medium.com/tag/big-data?source=post_page-----c1b9c45ca792---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----c1b9c45ca792---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c1b9c45ca792---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc1b9c45ca792&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&user=Garrett+R+Peternel&userId=6abb8b9bd26&source=-----c1b9c45ca792---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc1b9c45ca792&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&user=Garrett+R+Peternel&userId=6abb8b9bd26&source=-----c1b9c45ca792---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc1b9c45ca792&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc1b9c45ca792&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c1b9c45ca792---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c1b9c45ca792--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@garrett.r.peternel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@garrett.r.peternel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Garrett R Peternel"}, {"url": "https://medium.com/@garrett.r.peternel/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "96 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6abb8b9bd26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&user=Garrett+R+Peternel&userId=6abb8b9bd26&source=post_page-6abb8b9bd26--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce17f72c880b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbig-data-transformations-with-complex-and-nested-data-types-c1b9c45ca792&newsletterV3=6abb8b9bd26&newsletterV3Id=ce17f72c880b&user=Garrett+R+Peternel&userId=6abb8b9bd26&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}