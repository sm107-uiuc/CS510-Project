{"url": "https://towardsdatascience.com/tuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b", "time": 1683003944.620497, "path": "towardsdatascience.com/tuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b/", "webpage": {"metadata": {"title": "Tuning a Model\u2019s Hyperparameters and Aiming for a Specific Metric in Accordance with the Business Scenario | by Jonathan Cabreira | Towards Data Science", "h1": "Tuning a Model\u2019s Hyperparameters and Aiming for a Specific Metric in Accordance with the Business Scenario", "description": "Do you know how to choose the right error metric according to specific product demands and goals? Evaluating a classification problem may seem a bit tricky but it is extremely important due to the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.udacity.com/course/machine-learning-engineer-nanodegree--nd009t", "anchor_text": "Udacity\u2019s", "paragraph_index": 2}, {"url": "https://github.com/jmcabreira/Data-Science-Coursework-Projects/blob/master/ML-Eng-Program_SageMaker/Binary_Classification-LinearLearner/README.md", "anchor_text": "GitHub webpage.", "paragraph_index": 2}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/ll_hyperparameters.html", "anchor_text": "hyperparameter", "paragraph_index": 19}, {"url": "https://sagemaker.readthedocs.io/en/stable/linear_learner.html#sagemaker.LinearLearner", "anchor_text": "hyperparameter", "paragraph_index": 21}, {"url": "http://linkedin.com/in/cabreirajm", "anchor_text": "linkedin.com/in/cabreirajm", "paragraph_index": 31}], "all_paragraphs": ["Do you know how to choose the right error metric according to specific product demands and goals? Evaluating a classification problem may seem a bit tricky but it is extremely important due to the high influence that business decisions have on it. Besides the way you approach a model tuning may vary in different scenarios.", "In this post, we will go over the model tuning of a credit card fraud detection classification model in two different scenarios. We will decide whether we should choose Recall or Precision as the metric and see the impact of this .", "It is important to mention that this post will be based on a project I completed for the Udacity\u2019s Machine Learning Engineer program and you are encouraged to check it out on my GitHub webpage.", "In order to understand the metrics and consequently choose the right one for each of our business scenarios, we have to know how to interpret a confusion matrix and its terminology.", "Confusion matrix is a table used to measure the performance of classification models. It contains columns with the actual classification and rows representing the predictions (or vice-versa) as shown bellow:", "I think that looking at the picture below you might have a better understanding of confusion matrix.", "Given the two scenarios presented to you, how would you evaluate your model ? Do you know how to proceed ? In order to decide the metric we should go for, we have to have a deep understanding of the metrics. So let\u2019s jump right into to the explanations with examples and scenarios!", "Accuracy is a straightforward metric. It is basically the ratio of the correct predictions to the total of predictions. You can see the formula below:", "where TP = true positive, TN = true negative, FP = false positive and FN = false negative represent the predictions.", "Now, let\u2019s suppose that your first model gives you an accuracy of 99% such as the LinearLearner model ( a SaeMaker\u2019s buil-in model) below. That means that your fraud detection model is doing a great job of flagging either fraudulent and valid transactions, right ?", "Well, actually the answer to that question is : it depends ! Let\u2019s do a closer analysis of the positive and negative classifications to have a better understanding of the model performance.", "The model above flagged more than 30 FN (incorrectly labelled, fraudulent transactions ) and a little over 30 FP transactions(incorrectly labelled, valid transaction). Taking into account the perspective of the user, we could state that they do not want any valid transactions to be classified as fraudulent. In this case, we have to be aware of the fact that our model should have as few false positives ( incorrectly labelled, fraudulent transactions) as possible. That way , we are not able to tune the model to accomplish the business demand based only on its accuracy. To do that efficiently, we have to do a model tuning analyzing one metric that can helps us decrease the number of FP , which is not the case of the accuracy.", "Taking into account our fraud detection project, we could say that Recall is the ratio of the total number of correctly flagged frauds to the total number of examples of fraud ( fraud flagged as fraud and fraud flagged as valid transaction). A high recall indicates that our class is correctly recognized ( high number of TP and small number of FN).", "The way we can think of recall is as followings:", "Out of the positive samples, how many has my model predicted correctly?", "Precision is the third metric we have to cover so that we can solve our business scenarios problem. It is basically the number of classes correctly classified divided by the total of time that these classes have been predicted. In our case, the precision is the number of the fraudulent transactions correctly classified as fraudulent, divided by the number of the fraudulent transactions correctly classified as fraudulent, plus the number of valid transaction flagged as fraudulent.", "The whey we can think of precision is the following:", "Out of the total predictions that my model has flagged as positive, how many of them are in fact positive ?", "whenever we want to do a model tuning, we have to bare in mind that unbalanced data might bias the model towards predicting classes that has more data points. Because of that, we have to account for class unbalance training of our binary classifier.", "In the case of this project, I used one hyperparameter that the LinearLearner model offers to deal with unbalanced dataset . This hyperparameter (positive_example_weight_mult) is basically a weight assigned to the positive class (1, fraudulent) when training a binary classifier. The weight of the valid transactions is fixed at 1.", "Let\u2019s now think about our business case. According to what the manager demands, we can say that we have to build a model that has as many true positives and as few false negatives as possible. This means that we have to choose the Recall metric to tune our fraud detection model.", "So, in order to aim for a specific value of recall, I used the binary_classifier_model_selection_criteria hyperparameter, which is the model evaluation criteria for the training dataset. By using this metric, we are able to specify the exact value we want to aim for to our parameters.", "Assuming that the performance on the training set will be within about 5% of the performance on the test set, we should aim for a recall of 90%.", "This way we end up with the following metrics:", "Even though we aimed for a recall of 90% ,we can see that the model gives us a recall of about 91% . This value may vary when applied to the test data. We should also see that we have fewer false negatives which is exactly what we want.", "In this case, the business demand is that the model flags only 15% of valid transactions as fraudulent. This means that we want to have as few false positives (0 classified as 1) as possible. So we can use the precision to do our model tuning.", "Based on that requirement, we can calculate an approximate value for the precision that we want: 85/(85+15). Again, let\u2019s assume that we will have a 5% higher performance on the training compared to the test. So we will aim for 80\u201385% precision on the test set.", "It\u2019s important to mention that the model trains for a fixed precision of 90% and also tries to get as high a recall as possible. With that that in mind, we can see the metrics as result of our tuned model.", "We can see that the model still misclassified 26 of the valid transactions and because of that we may want to go back and up our aims-for precision. We can also notice that the recall and accuracy are ok, if we consider the precision trade off.", "In real world projects, the success of a product is often associated with tuning a specific metric. It\u2019s important to understand which metric you will choose in order to achieve a business demand. I hope this article gives you a better understanding as to how to tune your model based on business decisions and demands.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "\u2022 Electrical Engineer turned Data Scientist \u2022 LinkedIn : linkedin.com/in/cabreirajm"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3c47d534ed3b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cabreirajm?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cabreirajm?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": "Jonathan Cabreira"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5044f2be32e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&user=Jonathan+Cabreira&userId=a5044f2be32e&source=post_page-a5044f2be32e----3c47d534ed3b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c47d534ed3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c47d534ed3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.dqindia.com/fico-conductor-partner-boost-card-fraud-protection-cx-brazil/", "anchor_text": "www.dqindia.com"}, {"url": "https://www.udacity.com/course/machine-learning-engineer-nanodegree--nd009t", "anchor_text": "Udacity\u2019s"}, {"url": "https://github.com/jmcabreira/Data-Science-Coursework-Projects/blob/master/ML-Eng-Program_SageMaker/Binary_Classification-LinearLearner/README.md", "anchor_text": "GitHub webpage."}, {"url": "https://towardsdatascience.com/beyond-accuracy-precision-and-recall-3da06bea9f6c", "anchor_text": "towardsdatascience"}, {"url": "https://medium.com/@neeraj.kumar.iitg/statistical-performance-measures-12bad66694b7", "anchor_text": "@neeraj.kumar.iitg"}, {"url": "https://towardsdatascience.com/precision-vs-recall-386cf9f89488", "anchor_text": "towardsdatascience"}, {"url": "https://towardsdatascience.com/precision-vs-recall-386cf9f89488", "anchor_text": "towardsdatascience.com"}, {"url": "https://towardsdatascience.com/precision-vs-recall-386cf9f89488", "anchor_text": "towardsdatascience.com"}, {"url": "https://towardsdatascience.com/precision-vs-recall-386cf9f89488", "anchor_text": "owardsdatascience.com"}, {"url": "https://docs.aws.amazon.com/sagemaker/latest/dg/ll_hyperparameters.html", "anchor_text": "hyperparameter"}, {"url": "https://towardsdatascience.com/precision-vs-recall-386cf9f89488", "anchor_text": "towardsdatascience.com"}, {"url": "https://sagemaker.readthedocs.io/en/stable/linear_learner.html#sagemaker.LinearLearner", "anchor_text": "hyperparameter"}, {"url": "https://towardsdatascience.com/precision-vs-recall-386cf9f89488", "anchor_text": "towardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3c47d534ed3b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----3c47d534ed3b---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3c47d534ed3b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data?source=post_page-----3c47d534ed3b---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/fraud-detection?source=post_page-----3c47d534ed3b---------------fraud_detection-----------------", "anchor_text": "Fraud Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3c47d534ed3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&user=Jonathan+Cabreira&userId=a5044f2be32e&source=-----3c47d534ed3b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3c47d534ed3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&user=Jonathan+Cabreira&userId=a5044f2be32e&source=-----3c47d534ed3b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c47d534ed3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3c47d534ed3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3c47d534ed3b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3c47d534ed3b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cabreirajm?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cabreirajm?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jonathan Cabreira"}, {"url": "https://medium.com/@cabreirajm/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "138 Followers"}, {"url": "http://linkedin.com/in/cabreirajm", "anchor_text": "linkedin.com/in/cabreirajm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5044f2be32e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&user=Jonathan+Cabreira&userId=a5044f2be32e&source=post_page-a5044f2be32e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff22c720b7fc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftuning-a-models-hyperparameters-and-aiming-for-a-specific-metric-in-accordance-with-the-business-3c47d534ed3b&newsletterV3=a5044f2be32e&newsletterV3Id=f22c720b7fc8&user=Jonathan+Cabreira&userId=a5044f2be32e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}