{"url": "https://towardsdatascience.com/yolo2-walkthrough-with-examples-e40452ca265f", "time": 1683010466.1975381, "path": "towardsdatascience.com/yolo2-walkthrough-with-examples-e40452ca265f/", "webpage": {"metadata": {"title": "Yolo 2 Explained. Raw Output to Bounding Boxes | by Zixuan Zhang | Towards Data Science", "h1": "Yolo 2 Explained", "description": "Yolo is one of the most sucessful object detection algorithm in the field, known for its lightening speed and decent accuracy. Comparing to other regional proposal frameworks that detect objects\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/zzxvictor/YOLO_Explained", "anchor_text": "repo", "paragraph_index": 18}], "all_paragraphs": ["Yolo is one of the most sucessful object detection algorithm in the field, known for its lightening speed and decent accuracy. Comparing to other regional proposal frameworks that detect objects region by region, which requires many times of feature extraction, the input images are processed once in Yolo. In this tutorial, we are going to take a peek into the code of Yolo2.", "For those who want to run the code step by step instead of reading comments, check out my complementary repo on GitHub! The repo has several tutorials covering all aspects of Yolo as well as a ready-to-use library for you to play with!", "To understand how Yolo2 works, it is critical to understand what Yolo architecture look like. Yolo2 uses a VGG-style CNN called the DarkNet as feature extractors. Please note that DarkNet is an umbrella of various networks, and people use different variants to increase speed or accuracy.", "As you can see, yolo\u2019s output is nothing like what we\u2019ve seen before. There are 416 x 416 pixels in the image but the output is 13 x 13. How on earth do we interprate the results?", "Let\u2019s put Yolo aside for a moment and think about how would we do object detection in one path? Here\u2019s my naive solution:", "Yolo is engineered to be fast and accurate. Therefore, it is not ideal to predict one box per pixel (two adjecent pixel may belong to one object). The geeks who invented YOLO went to work and came up with a better idea", "Instead of predicting one box per pixel, we divide an image into S x S grids and predict several boxes per grid.", "Yolo also introduces an object score in addition to classification probabilities. The object score is an estimation of whether an object appears in the predicted box (It doesn\u2019t care what object, that\u2019s the job of class probailities). If a prediction has low object score, it will be discarded in post-processing. With that being said, the bounding boxe should like like this", "Instead of predicting the absolute size of boxes w.r.t the entire image, Yolo introduces what is known as Anchor Box, a list of predefined boxes that best match the desired objects (Given ground truths, run K mean clustering). The predicted box is scaled w.r.t the anchors. More specifically:", "Now you know YOLO predicts several bounding boxes per grid instead of just one. The output shape would be something like 13 x 13 x NUM_ANCHOR X (BOX INFO), where the last dimension looks just like an upgraded version of the naive approache.", "Now we understand the format of Yolo 2. The next step is how to extract the boxes from the raw tensor. Sure we can\u2019t use all 13 x 13 x 5 boxes right? In this section, we are going to see how to extract information from the raw output tensor.", "Let\u2019s take a look at the information", "We need to convert relative coordinates tx, ty into image scale coordinates bx, by and the same thing for tw and th. Here\u2019s how to do it in tensorflow 2", "Now we have the coordinates of the predicted box on grid scale and its size, it\u2019s very easy to calculate the coordinates of its corners(purple and green dots in figure 8). We do this step because it is standard to represent a box by its corners rather than its center and width/height", "To get the coordinates of the green and purple dots, we need to:", "After this, we multiply the coordinates with (32,32) so that the bounding boxes are now in image scale. For instance, (0,0) means the top left corner, (1,1) means the bottom right corner, (0.5,0.5) means image center", "For every grid and every anchor box, yolo predicts a bounding box. In our case, this means 13 * 13 * 5 boxes are predicted. As you can imagine, not all boxes are accurate. Some of them might be false positives(no obj), some of them are predicting the same object (too much overlap). To obtain the final result, we need to:", "That\u2019s it! Those are the only scripts you need to decode the yolo output. Let\u2019s check out the results:", "Reading scripts can be very confusing, which is I strongly recommend you to check out the repo and run it on Google Colab or your local computer.", "Thank you so much for reading! In future tutorials, I\u2019m going to talk about loading training data and transfer learnings!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "New grad SDE at some random company. Student at Columbia & USC. I know how hard learning CS outside the classroom can be, so I hope my blog can help!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe40452ca265f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e40452ca265f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e40452ca265f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zixuan-zhang.medium.com/?source=post_page-----e40452ca265f--------------------------------", "anchor_text": ""}, {"url": "https://zixuan-zhang.medium.com/?source=post_page-----e40452ca265f--------------------------------", "anchor_text": "Zixuan Zhang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6bee41715a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&user=Zixuan+Zhang&userId=6bee41715a0e&source=post_page-6bee41715a0e----e40452ca265f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe40452ca265f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe40452ca265f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1311.2524.pdf", "anchor_text": "RCNN network"}, {"url": "https://github.com/zzxvictor/YOLO_Explained", "anchor_text": "zzxvictor/YOLO_ExplainedYolo is a fully convolutional model that, unlike many other scanning detection algorithms, generates bounding boxes in\u2026github.com"}, {"url": "https://arxiv.org/pdf/1506.02640.pdf", "anchor_text": "Yolo"}, {"url": "https://arxiv.org/abs/1612.08242", "anchor_text": "Yolo2"}, {"url": "https://github.com/zzxvictor/YOLO_Explained", "anchor_text": "repo"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----e40452ca265f---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e40452ca265f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e40452ca265f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e40452ca265f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----e40452ca265f---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe40452ca265f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&user=Zixuan+Zhang&userId=6bee41715a0e&source=-----e40452ca265f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe40452ca265f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&user=Zixuan+Zhang&userId=6bee41715a0e&source=-----e40452ca265f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe40452ca265f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e40452ca265f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe40452ca265f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e40452ca265f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e40452ca265f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e40452ca265f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e40452ca265f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e40452ca265f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e40452ca265f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e40452ca265f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e40452ca265f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e40452ca265f--------------------------------", "anchor_text": ""}, {"url": "https://zixuan-zhang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zixuan-zhang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Zixuan Zhang"}, {"url": "https://zixuan-zhang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6bee41715a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&user=Zixuan+Zhang&userId=6bee41715a0e&source=post_page-6bee41715a0e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8eaa96f63522&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolo2-walkthrough-with-examples-e40452ca265f&newsletterV3=6bee41715a0e&newsletterV3Id=8eaa96f63522&user=Zixuan+Zhang&userId=6bee41715a0e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}