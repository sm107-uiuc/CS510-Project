{"url": "https://towardsdatascience.com/what-does-your-classification-metric-tell-about-your-data-4a8f35408a8b", "time": 1683002381.387236, "path": "towardsdatascience.com/what-does-your-classification-metric-tell-about-your-data-4a8f35408a8b/", "webpage": {"metadata": {"title": "What does your classification metric tell about your data? | by Aayush Bajaj | Towards Data Science", "h1": "What does your classification metric tell about your data?", "description": "Ever wondered why there exists a lot of performance metrics that tell you about your classification skills. Well, it's true they evaluate a model's performance and tell you how good or bad the classification is but every one of them evaluates it in a different way."}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+(Diagnostic)", "anchor_text": "UCI Breast cancer", "paragraph_index": 4}, {"url": "http://ftp.cs.wisc.edu/machine-learning/shavlik-group/davis.icml06.pdf", "anchor_text": "here", "paragraph_index": 31}], "all_paragraphs": ["Ever wondered why there exists a lot of performance metrics that tell you about your classification skills. Well, it\u2019s true they evaluate a model\u2019s performance and tell you how good or bad the classification is but every one of them evaluates it in a different way.", "Think of it as your high school teachers, some may give you high scores despite your answer\u2019s being shit because you are a sycophant and some may give you low scores despite your answer being apt.Also using accuracy as your primary metric in classification is a crime!", "Nevertheless, this blog isn\u2019t about making you familiarize yourself with metrics but how to use them in an efficient way.", "I will cover the following metrics in this blog pertaining to their importance in online data science competitions:", "Note: I am taking UCI Breast cancer dataset for representing different values. For that, I deliberately shifted hyperparameters to signify certain conditions and outcomes.", "Python helper functions to calculate confusion matrix values:", "I have made a classification model with two sets of hyperparameters of Logistic Regression. This is done to test the model prediction in two different scenarios.", "Precision is the ratio of True positives and Total positives predicted.", "0<P<1Precision metric focuses on Type-I error (FP). A Type-I error occurs when we reject a true null Hypothesis(H\u2070). So, in this case, Type-I error is Incorrectly labeling cancer patients as non-cancerous. A precision score towards 1 will signify that your model didn't miss any True Positives and is able to classify well between correctly and incorrectly labeling of cancer patients. What it cannot measure is the existence of Type-II error which is False negatives i.e the cases when a non-cancerous patient is identified as cancerous.", "A low precision score (<0.5) means your classifier has a high number of False positives which can be an outcome of imbalanced class or untuned model hyperparameters. In an imbalanced class problem, you have to prepare your data beforehand with Over/Under-Sampling or Focal Loss in order to curb FP/FN.", "As you would have guessed by looking at the confusion matrix values that FP\u2019s are 0 so the condition is perfect for a 100% precise model on a given hyperparameter setting. In this setting, no Type-I error is reported i.e model has done a great job to curb incorrectly labeling cancer patients as non-cancerous.", "Since only Type-I error remains in this setting, the precision rate goes down despite the fact that Type-II error is 0.We can deduce from our example that only precision cannot tell you about your model performance on various grounds.", "A Recall is essentially the ratio of True Positives to all the Positives in Ground Truth", "0<R<1Recall metric focussed on Type-II errors(FN). A Type-II error occurs when we accept a false null Hypothesis(H\u2070). So, in this case, Type-II error is incorrectly labeling non-cancerous patients as cancerous. Recall score towards 1 will signify that your model didn\u2019t miss any True Positives and is able to classify well between correctly and incorrectly labeling of cancer patients. What it cannot measure is the existence of Type-I error which is False positives i.e the cases when a cancerous patient is identified as non-cancerous.", "A low recall score (<0.5) means your classifier has a high number of False negatives which can be an outcome of imbalanced class or untuned model hyperparameters. In an imbalanced class problem, you have to prepare your data beforehand with Over/Under-Sampling or Focal Loss in order to curb FP/FN.", "From the above Confusion matrix values, there is 0 possibility of Type-I errors and an abundance of Type-II errors. That\u2019s the reason behind the low recall score. It only focuses on Type-II errors.", "The only error that\u2019s persistent in this set is Type-I errors and no Type-II errors are reported. This means that this model has done a great job to curb incorrectly labeling non-cancerous patients as cancerous.", "The major highlight of the above two metrics is that both can only be used in specific scenarios since both of them identifies only one set of errors.", "To improve your model you can either improve precision or recall but not both. If you try to reduce cases of non-cancerous patients being labeled as cancerous (FN/Type-II), no direct effect will take place on cancerous patients being labeled as non-cancerous.", "Here\u2019s a plot depicting the same tradeoff.", "This tradeoff highly impacts real-world scenarios so it can be implied that precision and recall alone aren't very good metrics to rely on and work upon. That\u2019s the reason you see many corporate reports and online competitions urge the submission metric to be a combination of precision and recall.", "The F1-score metric uses a combination of precision and recall. In fact, F1-score is the harmonic mean of the two. The formula of the two essentially is:", "Now, a high F1-score symbolizes a high precision as well as high recall. It presents a good balance between precision and recall and gives good results on imbalanced classification problems.", "A low F1 score tells you (almost) nothing \u2014 it only tells you about performance at a threshold. Low recall means we didn\u2019t try to do well on very much of the entire test set. Low precision means, of the cases, we identified as positive cases, we didn\u2019t get many of them right. But low F1 doesn\u2019t say which. High F1 likely means we likely have high precision and recall on a large portion of the decision (which is informative). With low F1 it is unclear what the problem is (low precision or low recall?), whether the model suffers from Type-I or Type-II error.", "So, F1 is a gimmick? Not really, it has been used widely and is considered a fine metric to converge onto a decision(business) but not without some tweaks. Using FPR(False positive rates) along with F1 will help curb Type-I errors and you\u2019ll get an idea about the villain behind your low F1-score.", "If you recall our scores in set-I parameters were, P=1 and R=0.49. Thus, by employing both of the metrics we get a score of 0.66 which doesn\u2019t give you information about what type of error is significant but is still useful in deducing the performance of the model.", "for set-II parameters were, P=0.35 and R=1. So again F1 score sort sums up the break between P and R. But again low f1 doesn\u2019t tell you which error is present.", "Better known as AUC-ROC score/curves. It makes use of True Positive Rates(TPR) and False Positive Rates(FPR).", "To combine the FPR and the TPR into one single metric, we first compute the two former metrics with many different thresholds for the logistic regression, then plot them on a single graph. The resulting curve is called the ROC curve, and the metric we consider is the AUC of this curve, which we call AUROC.", "A no-skill classifier is one that cannot discriminate between the classes and would predict a random class or a constant class in all cases. The no-skill line changes based on the distribution of the positive to negative classes. It is a horizontal line with the value of the ratio of positive cases in the dataset. For a balanced dataset, this is 0.5.", "The area equals the probability that a randomly chosen positive example ranks above (is deemed to have a higher probability of being positive than negative) a randomly chosen negative example.So, High ROC simply means the probability of a randomly chosen positive example is indeed positive. High ROC also means your algorithm does a good job at ranking the test data, with most negative cases at one end of a scale and positive cases at the other.", "ROC curves aren\u2019t a good choice when your problem has a huge class imbalance. The reason for this is not straightforward but can be intuitively seen using the formulas, you can read more about it here. You can still use them in that scenario after processing an imbalance set or using focal loss techniques.", "AUROC metric doesn\u2019t find a place other than academic research and comparison of different classifiers.", "As you must have guessed till now, both have have different evaluation strategies. For a particular ROC, you can have a range of F1 scores (depending on threshold parameters).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Engineer who writes about how machines will take over the world."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4a8f35408a8b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@theAayushbajaj?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@theAayushbajaj?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": "Aayush Bajaj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fe2e9ea371d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=post_page-1fe2e9ea371d----4a8f35408a8b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a8f35408a8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a8f35408a8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@m_b_m?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "M. B. M."}, {"url": "https://unsplash.com/s/photos/statistics?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+(Diagnostic)", "anchor_text": "UCI Breast cancer"}, {"url": "http://ftp.cs.wisc.edu/machine-learning/shavlik-group/davis.icml06.pdf", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4a8f35408a8b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4a8f35408a8b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----4a8f35408a8b---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/python?source=post_page-----4a8f35408a8b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4a8f35408a8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=-----4a8f35408a8b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4a8f35408a8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=-----4a8f35408a8b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a8f35408a8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4a8f35408a8b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4a8f35408a8b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4a8f35408a8b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@theAayushbajaj?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@theAayushbajaj?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aayush Bajaj"}, {"url": "https://medium.com/@theAayushbajaj/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "53 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fe2e9ea371d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=post_page-1fe2e9ea371d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4b4b4603f627&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-does-your-classification-metric-tell-about-your-data-4a8f35408a8b&newsletterV3=1fe2e9ea371d&newsletterV3Id=4b4b4603f627&user=Aayush+Bajaj&userId=1fe2e9ea371d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}