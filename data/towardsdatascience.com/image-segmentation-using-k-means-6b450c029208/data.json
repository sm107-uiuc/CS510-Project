{"url": "https://towardsdatascience.com/image-segmentation-using-k-means-6b450c029208", "time": 1683014451.22657, "path": "towardsdatascience.com/image-segmentation-using-k-means-6b450c029208/", "webpage": {"metadata": {"title": "Image Segmentation using K-means. Image Segmentation from scratch using\u2026 | by Kartik Narula | Towards Data Science", "h1": "Image Segmentation using K-means", "description": "While pre-existing libraries(such as OpenCV) save time and effort, implementing the basic algorithms from scratch is another delight. In this post, I will show the step by step implementation of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://groups.csail.mit.edu/vision/SUN/", "anchor_text": "SUN database", "paragraph_index": 1}], "all_paragraphs": ["While pre-existing libraries(such as OpenCV) save time and effort, implementing the basic algorithms from scratch is another delight.", "In this post, I will show the step by step implementation of image segmentation using k-means in python. We train the pipeline on 1100 images across 8 categories sampled from the SUN database. Image segmentation is the grouping of pixels of similar types together. The pipeline can be further extended to classify an image. An image of a park, for instance, will have a greater number of green-colored pixels, for example than an image of a highway. We will talk about classification in a later post.", "We established that an image of a park will have a greater number of green-colored pixels. While color is a good way of differentiating pixels, it can create issues at times(water and sky have the same color, for instance). Hence, we need other ways to characterize pixels. In other words, we need to extract useful features from the image. Deep learning algorithms, such as CNN\u2019s find useful features automatically for us but\u2019s that\u2019s outside the scope of this article.", "For extracting features, we will use four kinds of image filters with multiple scales- gaussian, derivative of gaussian in the x-direction, derivative of gaussian in the y-direction and the Laplacian of gaussian. Each filter extracts different sets of features from the image. Smaller scales pick up narrower features and larger scales pick up broader features(Think of forest and the trees). We will call the set of filters with different scales as a \u2018filter bank\u2019.", "Each row in the above figure represents one particular scale and each column represents a different type of filter. Gaussian filter(first column) blurs the image and omits the higher frequencies. Derivative of Gaussian in X direction(second column) picks up the vertical edges. The derivative of gaussian in Y direction(third column) picks up the horizontal edges. The laplacian of gaussian (fourth column) detects regions of rapid intensity changes.", "We run the filter bank over an image(which is an array of size H*W*3, where H and W are the height and width of the image, respectively and 3 is the number of channels). We output an array of size(H*W*3F), where F is the size of the filter bank. If we use 4 filters at 5 different scales, F is 4*5=20", "From T training images, we get a filter response vector of size T*H*W*3F. To save computation resources, we select alpha random filter responses from each image. Thus, the final size of the filter response vector is alpha* T * F.", "We will use this vector of filter responses as the input to our k-means algorithm. It will output K(a hyperparameter) cluster centers. Each pixel of the test image will then be mapped to the nearest cluster center and painted with a corresponding color to form a \u2018visual map\u2019. The resulting \u2018visual map\u2019 would have similar pixels grouped together and would be the final output of our \u2018image segmentation\u2019 algorithm.", "Bravo, let\u2019s see the whole pipeline in action. We will start by defining the values of the hyperparameters, which can be tuned later to enhance performance.", "We now define the function extract_fiter_responses which returns a vector of size H*W*3F for an image of size H*W*3 and filter bank size F. We use the inbuilt functions in scipy for generating filter_responses.", "The next function will extract alpha random filter responses from the vector returned by extract_filter_responses", "The next function pools the alpha responses from each image into a single vector and applies the k-means function from scipy. The function takes the training files path as an argument.", "Cool. So now we have K cluster centers. For a test image, we need to map each pixel of the image with the nearest cluster center and plot the resulting visualization. We use the scipy.spatial.distance.cdist to find the index of the closest cluster center. This is illustrated in the get_visual_maps() function below", "We will now use these functions to create a pipeline that runs k-means on a training set of 1177 images and check the performance on a test image.", "Here are a few sample visualizations of the algorithm. I used Filter scales=[1,1.5, 2], K=25 and alpha=10. We are able to identify different regions of the image. In the first image(of a kitchen) we can identify different regions, the table, stove, etc, and so on. Feel free to tune these parameters and see if you can get even better results!", "In the next post, we will extend the pipeline that classifies an image by its type(The first is an image of a kitchen, second is an image of a highway, and so on..)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6b450c029208&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b450c029208--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b450c029208--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@narulakartik7?source=post_page-----6b450c029208--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@narulakartik7?source=post_page-----6b450c029208--------------------------------", "anchor_text": "Kartik Narula"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7c4541915cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&user=Kartik+Narula&userId=7c4541915cb9&source=post_page-7c4541915cb9----6b450c029208---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b450c029208&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b450c029208&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://groups.csail.mit.edu/vision/SUN/", "anchor_text": "SUN database"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b450c029208&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&user=Kartik+Narula&userId=7c4541915cb9&source=-----6b450c029208---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b450c029208&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&user=Kartik+Narula&userId=7c4541915cb9&source=-----6b450c029208---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b450c029208&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b450c029208--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6b450c029208&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6b450c029208---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b450c029208--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6b450c029208--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6b450c029208--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6b450c029208--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6b450c029208--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6b450c029208--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6b450c029208--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6b450c029208--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@narulakartik7?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@narulakartik7?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kartik Narula"}, {"url": "https://medium.com/@narulakartik7/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1 Follower"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7c4541915cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&user=Kartik+Narula&userId=7c4541915cb9&source=post_page-7c4541915cb9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F7c4541915cb9%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-segmentation-using-k-means-6b450c029208&user=Kartik+Narula&userId=7c4541915cb9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}