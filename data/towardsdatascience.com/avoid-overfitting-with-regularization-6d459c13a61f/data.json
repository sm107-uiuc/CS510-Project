{"url": "https://towardsdatascience.com/avoid-overfitting-with-regularization-6d459c13a61f", "time": 1683018333.086895, "path": "towardsdatascience.com/avoid-overfitting-with-regularization-6d459c13a61f/", "webpage": {"metadata": {"title": "Avoid Overfitting with Regularization | by Mahbubul Alam | Towards Data Science", "h1": "Avoid Overfitting with Regularization", "description": "You are not alone if you had a hard time understanding what exactly Regularization is and how it works. Regularization can be a very confusing term and I\u2019m attempting to clear up some of that in this\u2026"}, "outgoing_paragraph_urls": [{"url": "https://mab-datasc.medium.com/", "anchor_text": "Medium", "paragraph_index": 30}, {"url": "https://twitter.com/DataEnthus", "anchor_text": "Twitter", "paragraph_index": 30}, {"url": "https://www.linkedin.com/in/mab-alam/", "anchor_text": "LinkedIn", "paragraph_index": 30}], "all_paragraphs": ["You are not alone if you had a hard time understanding what exactly Regularization is and how it works. Regularization can be a very confusing term and I\u2019m attempting to clear up some of that in this article.", "In this article I\u2019ll do three things: (a) define the problem that we want to tackle with regularization; then (b) examine how exactly regularization helps; and finally (c) explain how regularization works in action.", "Data scientists take great care during the modeling process to make sure their models work well and they are neither under- nor overfit.", "Let\u2019s say you want to predict house prices based on some features. You start with one feature, floor area, and you build your first regression model.", "But you know very well that floor space is just one criteria, there are many other factors \u2014 such as the number of bedrooms, garage condition, neighborhood characteristics, school district and many more\u2014 that a buyer potentially considers before making a purchasing decision. So your first model is clearly an underfit.", "At the other extreme, you could end up selecting 200 different features that can potentially impact house prices. So you built a really complex model and tested it on the training data and found that it performed great! However, when it comes to making predictions on unseen/test data the model does poorly. Why is that? One reason is \u2014 the complex model that you just built \u201clearned\u201d every bit of noise but missed the signal in the training data.", "So how to find the sweet spot where a model is NOT too complex but complex enough to pick up the signal and performs relatively well in out-of-sample data?", "Ideally, if we had a large number of features, we\u2019d add in features one by one and in different combinations to see their impacts on model performance and choose the best model based on the performance metric.", "Do you see the problem here? If we did feature selection that way, we\u2019d end up running thousands of models with different feature combinations and parameter values.", "It works differently in machine learning. We choose an algorithm, then select all the features at once, run the model and evaluate model performance at the very end. But aren\u2019t we overfitting with lots of features that we actually want to avoid?", "That\u2019s where regularization comes in handy. Even if we have redundant features, regularization controls their effects and makes them less sensitive and sometimes lets them go. It is done by shrinking model coefficients towards zero.", "Let\u2019s start with the cost function (a.k.a objective function) that we want to optimize in regression.", "You know what a cost function is, right?", "The difference between a predicted and an actual value is called the error. Every data point in a dataset creates such errors, and the role of a cost function is to quantify these errors. And in linear regression, the objective is to minimize those errors to find the best fit model.", "There are several cost functions out there such as Mean Squared Error (MSE), Mean Absolute Error (MAE), Root Mean Squared Error (RMSE) etc. but they all do the same thing \u2014 quantifying errors.", "As an example, this is how MSE works:", "It is the value of MSE that we want to minimize to find the best model.", "So if our regression model is \u0176 = \u03b1 + \u03b8i Xi (where \u03b8 is the coefficient of X), then the cost function following MSE formulation above is:", "So the purpose of regularization is to add a small bias in the error function:", "There are two kinds of regularization terms \u2014 L1 and L2. Depending on which term is used, a normal multiple regression is called by different names.", "We call a normal regression the \u201cRidge regression\u201d when it uses L2 Regularization. The purpose of L2 is to shrink feature coefficients to close to zero, but not exactly zero (can you guess what if coefficients are zero? The answer comes next).", "So the cost function we want to minimize with Ridge regression is:", "LASSO regression goes a bit extreme. It sets some feature coefficients to zero through L1 Regularization. This process essentially eliminates those features from the model instead of minimizing their impacts.", "Hyperparameter \u03bb: So in both L1 and L2 regularization, we have a parameter \u03bb, which is called a hyperparameter in machine learning lingo. This is the only parameter responsible for penalizing the features.", "So the question is \u2014 what values does \u03bb take and how to find the perfect value? One thing to remember \u2014 \u03bb adds bias to our model, so we don\u2019t want to add a too large value. Instead, we want to get away with a small bias as possible while achieving our main goal \u2014 reducing feature sensitivity.", "There are several ways to find the \u03bb value. How each method works is a discussion for another day for today, but know that two popular methods are: gradient descent and cross-validation.", "Now that we know why and how regularization works, one final question remains \u2014 how to choose between L1 and L2?", "The answer is of course cliche \u2014 \u201cit depends\u201d on data scientists\u2019 judgments. One principle is to choose L1 if we want fewer variables (as a reminder, L1 can eliminate variables) and choose L2 when the sample size is small (in this case we don\u2019t want to eliminate features, rather reduce their sensitivity).", "There is another easy getaway \u2014 using both L1 and L2 regularization in the same regression. When we use both regularization terms in the model, it is called ElasticNet Regression.", "To summarise, in this article we\u2019ve focused on three things:", "I hope this article was useful. If you have comments feel free to write them down below. You can also connect with me on Medium, Twitter or LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6d459c13a61f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mab-datasc.medium.com/?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": ""}, {"url": "https://mab-datasc.medium.com/?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": "Mahbubul Alam"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F401531abcd36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&user=Mahbubul+Alam&userId=401531abcd36&source=post_page-401531abcd36----6d459c13a61f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d459c13a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d459c13a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@casapan?utm_source=medium&utm_medium=referral", "anchor_text": "Carolina S\u00e1nchez"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://mab-datasc.medium.com/", "anchor_text": "Medium"}, {"url": "https://twitter.com/DataEnthus", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/mab-alam/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6d459c13a61f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6d459c13a61f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6d459c13a61f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/regression?source=post_page-----6d459c13a61f---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/regularization?source=post_page-----6d459c13a61f---------------regularization-----------------", "anchor_text": "Regularization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d459c13a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&user=Mahbubul+Alam&userId=401531abcd36&source=-----6d459c13a61f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d459c13a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&user=Mahbubul+Alam&userId=401531abcd36&source=-----6d459c13a61f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d459c13a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6d459c13a61f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6d459c13a61f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6d459c13a61f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6d459c13a61f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6d459c13a61f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6d459c13a61f--------------------------------", "anchor_text": ""}, {"url": "https://mab-datasc.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mab-datasc.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mahbubul Alam"}, {"url": "https://mab-datasc.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "http://www.linkedin.com/in/mab-alam/", "anchor_text": "www.linkedin.com/in/mab-alam/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F401531abcd36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&user=Mahbubul+Alam&userId=401531abcd36&source=post_page-401531abcd36--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc2e6ab93a2dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-overfitting-with-regularization-6d459c13a61f&newsletterV3=401531abcd36&newsletterV3Id=c2e6ab93a2dd&user=Mahbubul+Alam&userId=401531abcd36&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}