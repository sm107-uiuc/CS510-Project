{"url": "https://towardsdatascience.com/basic-curve-fitting-of-scientific-data-with-python-9592244a2509", "time": 1683005714.1543522, "path": "towardsdatascience.com/basic-curve-fitting-of-scientific-data-with-python-9592244a2509/", "webpage": {"metadata": {"title": "Basic Curve Fitting of Scientific Data with Python | by Naveen Venkatesan | Towards Data Science", "h1": "Basic Curve Fitting of Scientific Data with Python", "description": "In addition to plotting data points from our experiments, we must often fit them to a theoretical model to extract important parameters. This short article will serve as a guide on how to fit a set\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/an-introduction-to-making-scientific-publication-plots-with-python-ea19dfa7f51e", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/an-introduction-to-making-scientific-publication-plots-with-python-ea19dfa7f51e", "anchor_text": "previous article", "paragraph_index": 13}, {"url": "https://github.com/venkatesannaveen/python-science-tutorial", "anchor_text": "Github repository", "paragraph_index": 40}], "all_paragraphs": ["In addition to plotting data points from our experiments, we must often fit them to a theoretical model to extract important parameters. This short article will serve as a guide on how to fit a set of points to a known model equation, which we will do using the scipy.optimize.curve_fit function. The basics of plotting data in Python for scientific publications can be found in my previous article here. I will go through three types of common non-linear fittings: (1) exponential, (2) power-law, and (3) a Gaussian peak.", "To use the curve_fit function we use the following import statement:", "In this case, we are only using one specific function from the scipy package, so we can directly import just curve_fit .", "Let\u2019s say we have a general exponential function of the following form, and we know this expression fits our data (where a and b are constants we will fit):", "First, we must define the exponential function as shown above so curve_fit can use it to do the fitting.", "We will start by generating a \u201cdummy\u201d dataset to fit with this function. To generate a set of points for our x values that are evenly distributed over a specified interval, we can use the np.linspace function.", "start \u2014 starting value of our sequence", "stop \u2014 ending value of our sequence (will include this value unless you provide the extra argument endpoint=False )", "num \u2014 the number of points to split the interval up into (default is 50 )", "Note that you do not need to explicitly write out the input names \u2014 np.linspace(-5, 5, 100) is equally valid, but for the purposes of this article, it makes things easier to follow.", "For our dummy data set, we will set both the values of a and b to 0.5.", "To make sure that our dataset is not perfect, we will introduce some noise into our data using np.random.normal , which draws a random number from a normal (Gaussian) distribution. We will then multiply this random value by a scalar factor (in this case 5) to increase the amount of noise:", "size \u2014 the shape of the output array of random numbers (in this case the same as the size of y_dummy)", "Now let\u2019s plot our dummy dataset to inspect what it looks like. Since we have a collection of noisy data points, we will make a scatter plot, which we can easily do using the ax.scatter function. I will skip over a lot of the plot aesthetic modifications, which are discussed in detail in my previous article. To assign the color of the points, I am directly using the hexadecimal code.", "s \u2014 the marker size in units of (points)\u00b2, so the marker size is doubled when this value is increased four-fold", "An often more-useful method of visualizing exponential data is with a semi-logarithmic plot since it linearizes the data. To set the scale of the y-axis from linear to logarithmic, we add the following line:", "We must also now set the lower y-axis limit to be greater than zero because of the asymptote in the logarithm function. Additionally, for the tick marks, we now will use the LogLocator function:", "base \u2014 the base to use for the major ticks of the logarithmic axis", "We can now fit our data to the general exponential function to extract the a and b parameters, and superimpose the fit on the data. Note that although we have presented a semi-log plot above, we have not actually changed the y-data \u2014 we have only changed the scale of the y-axis. So, we are still fitting the non-linear data, which is typically better as linearizing the data before fitting can change the residuals and variances of the fit.", "f \u2014 function used for fitting (in this case exponential)", "xdata \u2014 array of x-data for fitting", "ydata \u2014 array of y-data for fitting", "p0 \u2014 array of initial guesses for the fitting parameters (both a and b as 0)", "bounds \u2014 bounds for the parameters (-\u221e to \u221e)", "pars \u2014 array of parameters from fit (in this case [a, b])", "cov \u2014 the estimated covariance of pars which can be used to determine the standard deviations of the fitting parameters (square roots of the diagonals)", "We can extract the parameters and their standard deviations from the curve_fit outputs, and calculate the residuals by subtracting the calculated value (from our fit) from the actual observed values (our dummy data)", "*pars \u2014 allows us to unroll the pars array, i.e. [a, b] gets inputted as a, b", "We see that both fit parameters are very close to our input values of a = 0.5 and b = 0.5 so the curve_fit function converged to the correct values. Now we can overlay the fit on top of the scatter data, and also plot the residuals, which should be randomly distributed and close to 0, confirming that we have a good fit.", "linestyle \u2014 the line style of the plotted line ( -- for a dashed line)", "Another commonly-used fitting function is a power law, of which a general formula can be:", "Similar to how we did the previous fitting, we first define the function:", "We then again can create a dummy dataset, add noise, and plot our power-law function.", "Similar to the exponential fitting case, data in the form of a power-law function can be linearized by plotting on a logarithmic plot \u2014 this time, both the x and y-axes are scaled.", "Now we can follow the same fitting steps as we did for the exponential data:", "Peak fitting with a Gaussian, Lorentzian, or combination of both functions is very commonly used in experiments such as X-ray diffraction and photoluminescence in order to determine line widths and other properties. In this example we will deal with the fitting of a Gaussian peak, with the general formula below:", "Just like in the exponential and power-law fits, we will try to do the Gaussian fit with initial guesses of 0 for each parameter.", "However, when we do this, we get the following result:", "It appears that our initial guesses did not allow the fit parameters to converge, so we can run the fit again with a more realistic initial guess. You can do this by examining the peak you are trying to fit, and choosing reasonable initial values.", "This time, our fit succeeds, and we are left with the following fit parameters and residuals:", "Hopefully, following the lead of the previous examples, you should now be able to fit your experimental data to any non-linear function! I hope you enjoyed this tutorial and all the examples presented here can be found at this Github repository.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist \u2022 Materials Scientist \u2022 Musician \u2022 Golfer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9592244a2509&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9592244a2509--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9592244a2509--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://naveenvenkatesan.medium.com/?source=post_page-----9592244a2509--------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=post_page-----9592244a2509--------------------------------", "anchor_text": "Naveen Venkatesan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7779ee5bf58d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=post_page-7779ee5bf58d----9592244a2509---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9592244a2509&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9592244a2509&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/python-science-plotting", "anchor_text": "Python Science Plotting"}, {"url": "https://unsplash.com/@chrisliverani?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Chris Liverani"}, {"url": "https://unsplash.com/s/photos/statistics?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/an-introduction-to-making-scientific-publication-plots-with-python-ea19dfa7f51e", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/an-introduction-to-making-scientific-publication-plots-with-python-ea19dfa7f51e", "anchor_text": "previous article"}, {"url": "https://github.com/venkatesannaveen/python-science-tutorial", "anchor_text": "Github repository"}, {"url": "https://medium.com/tag/python?source=post_page-----9592244a2509---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/matplotlib?source=post_page-----9592244a2509---------------matplotlib-----------------", "anchor_text": "Matplotlib"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----9592244a2509---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9592244a2509---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python-science-plotting?source=post_page-----9592244a2509---------------python_science_plotting-----------------", "anchor_text": "Python Science Plotting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9592244a2509&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=-----9592244a2509---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9592244a2509&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=-----9592244a2509---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9592244a2509&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9592244a2509--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9592244a2509&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9592244a2509---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9592244a2509--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9592244a2509--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9592244a2509--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9592244a2509--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9592244a2509--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9592244a2509--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9592244a2509--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9592244a2509--------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://naveenvenkatesan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Naveen Venkatesan"}, {"url": "https://naveenvenkatesan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "487 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7779ee5bf58d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=post_page-7779ee5bf58d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe736f4929535&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbasic-curve-fitting-of-scientific-data-with-python-9592244a2509&newsletterV3=7779ee5bf58d&newsletterV3Id=e736f4929535&user=Naveen+Venkatesan&userId=7779ee5bf58d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}