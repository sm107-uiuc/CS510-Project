{"url": "https://towardsdatascience.com/unsupervised-learning-to-market-behavior-forecasting-ee8f78650415", "time": 1683000343.1980228, "path": "towardsdatascience.com/unsupervised-learning-to-market-behavior-forecasting-ee8f78650415/", "webpage": {"metadata": {"title": "Unsupervised Learning to Market Behavior Forecasting | by Sergey Malchevskiy | Towards Data Science", "h1": "Unsupervised Learning to Market Behavior Forecasting", "description": "This practice-oriented article describes the technique that forecasts the market behavior. The second part demonstrates the application of the approach in a trading strategy."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/introduction-to-hidden-markov-models-cd2c93e6b781", "anchor_text": "this", "paragraph_index": 7}, {"url": "https://medium.com/u/d520265687a?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "Tomer Amit", "paragraph_index": 7}, {"url": "https://enigma.co/catalyst/", "anchor_text": "Catalyst", "paragraph_index": 27}, {"url": "https://medium.com/@sermal/adaptive-trend-following-trading-strategy-based-on-renko-9248bf83554", "anchor_text": "post", "paragraph_index": 27}, {"url": "https://medium.com/@sermal/how-to-develop-a-stock-market-analytical-tool-using-shiny-and-r-c2385e0d2f89", "anchor_text": "post", "paragraph_index": 32}, {"url": "https://medium.datadriveninvestor.com/event-based-portfolio-rebalance-approach-754b4aa06f64", "anchor_text": "article", "paragraph_index": 35}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 36}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 36}, {"url": "http://malchevskiy.pro", "anchor_text": "http://malchevskiy.pro", "paragraph_index": 38}], "all_paragraphs": ["The market data is a sequence called time series. Usually, researchers use only price data (or asset returns) to create a model that forecasts the next price value, movement direction, or other output. I think the better way is to use more data for that. The idea is try to combine versatile market conditions (volatility, volumes, price changes, and etc.)", "The first type of potential features are the various derivatives of price data. The second type is the set of the volume derivatives.", "These features will describe the current market condition more complex than raw market data or simple returns.", "You will see these features in the next part of the article. As for the modeling, we will use Hidden Markov Model.", "Hidden Markov Model (HMM) is a statistical Markov model in which the system being modeled is assumed to be a Markov process with unobserved (i.e. hidden) states. Observed data is our market features, hidden states are our market behavior.", "Our goal is to interpret the hidden state after the modeling, and create the trading strategy based on this knowledge.", "The basic figure of Hidden Markov Model looks like this", "This article is practice-oriented. For more information you read the introduction to Hidden Markov Model in this article by Tomer Amit. Also, I recommend to start with this video", "I think combing of code and explanation is a good approach to dive into the research. Let\u2019s start coding.", "This code downloads data for BTC/USD from Quandl", "Then we can to plot the price and volume data", "After that we are getting this figure", "Now we are ready for coding the feature engineering and modeling functions.", "Let\u2019s split off the train period as a period before 01/01/2018. The next code runs the feature engineering and visualizes it.", "After that, we are getting the five new time series and the trained model.", "In the code above, we also created the future_return column that shifted by one lag for last_return. This is the first key to understand the hidden states. Let\u2019s plot this value as a cumulative sum by each state.", "As we see, state #0 has the tendency to downside direction. State #1 doesn\u2019t have a clear tendency. The last state #2 has a strong tendency to upside direction. This simple trick with a cumulative sum future_return allows us to understand how each state corresponds to the next price movement.", "The second key is to research each state by features. After that, we can relate these two events (future movement and current condition). Let\u2019s code simulation and visualization for features of each state.", "Now you can see how each state describes the current state. E.g., states #0 and #2 have a high volume deviation, it means that these states often presented on high volume, and state #1 on low one. Also, states #0 and #2 often presented on high volatility.", "The interesting fact is state #0 has the low values for last_return and ma_ratio. Probably, the state #0 corresponds to downside current condition (at the present). The backward situation is for state #2.", "The interpretation of that two conclusions is", "If the market has the current state #0 we have mostly downside market condition (second key) at the current situation, and this tendency will go on (first key).", "If the market has the current state #1 we have the uncertainty for the tendency.", "If the market has the current state #2 we have mostly upside market condition (second key) at the current situation, and this tendency will go on (first key).", "The next line of code saves the trained model into the file.", "Let\u2019s try to create the trading strategy based on this knowledge. The strategy we should test since 01/01/2018, because this period out of the sample.", "The logic is simple: short when state #0, no position when state #1, long when state #2.", "Our strategy will be implemented using Catalyst framework. In this post, I demonstrated a quick introduction to Catalyst. The strategy will be contained in separated py-file. Let\u2019s code basic functions and include the libraries", "The main parameters, model loading are contained in the initialize function", "The basic logic contained in handle_data function. This function runs every minute. The main activities are getting data, feature creating, market behavior estimating, and position management.", "The last function is additional. We plot the figures and print the result.", "As we see, the suggested algorithm straight beats the benchmark. It seems the strategy tries to catch the trend and following it. The bad condition for the strategy is no trend period.", "Alpha is positive, beta is very close to 0 (see this post for the definition of these criteria). The drawdown is too high, but it much lower than drawdown of the benchmark.", "The ways how to improve the achieved result:", "These improvements can help to get more sophisticated strategy result: reduce the drawdown to 15\u201320%, increase the alpha and sortino, increase the capacity.", "If you like this sort of applications you can read this my article based on similar approach.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI solutions for business || Algorithmic trading http://malchevskiy.pro"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fee8f78650415&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ee8f78650415--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sermal.medium.com/?source=post_page-----ee8f78650415--------------------------------", "anchor_text": ""}, {"url": "https://sermal.medium.com/?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "Sergey Malchevskiy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F28673ed8bcf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&user=Sergey+Malchevskiy&userId=28673ed8bcf3&source=post_page-28673ed8bcf3----ee8f78650415---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee8f78650415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee8f78650415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/introduction-to-hidden-markov-models-cd2c93e6b781", "anchor_text": "this"}, {"url": "https://medium.com/u/d520265687a?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "Tomer Amit"}, {"url": "https://enigma.co/catalyst/", "anchor_text": "Catalyst"}, {"url": "https://medium.com/@sermal/adaptive-trend-following-trading-strategy-based-on-renko-9248bf83554", "anchor_text": "post"}, {"url": "https://medium.com/@sermal/how-to-develop-a-stock-market-analytical-tool-using-shiny-and-r-c2385e0d2f89", "anchor_text": "post"}, {"url": "https://github.com/lamres/hmm_market_behavior/tree/master", "anchor_text": "lamres/hmm_market_behaviorYou can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or\u2026github.com"}, {"url": "https://medium.datadriveninvestor.com/event-based-portfolio-rebalance-approach-754b4aa06f64", "anchor_text": "article"}, {"url": "http://malchevskiy.pro/", "anchor_text": "Sergey"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----ee8f78650415---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ee8f78650415---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----ee8f78650415---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ee8f78650415---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----ee8f78650415---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fee8f78650415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&user=Sergey+Malchevskiy&userId=28673ed8bcf3&source=-----ee8f78650415---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fee8f78650415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&user=Sergey+Malchevskiy&userId=28673ed8bcf3&source=-----ee8f78650415---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee8f78650415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fee8f78650415&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ee8f78650415---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ee8f78650415--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ee8f78650415--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ee8f78650415--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ee8f78650415--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ee8f78650415--------------------------------", "anchor_text": ""}, {"url": "https://sermal.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sermal.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sergey Malchevskiy"}, {"url": "https://sermal.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "http://malchevskiy.pro", "anchor_text": "http://malchevskiy.pro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F28673ed8bcf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&user=Sergey+Malchevskiy&userId=28673ed8bcf3&source=post_page-28673ed8bcf3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F84466b43e832&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-to-market-behavior-forecasting-ee8f78650415&newsletterV3=28673ed8bcf3&newsletterV3Id=84466b43e832&user=Sergey+Malchevskiy&userId=28673ed8bcf3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}