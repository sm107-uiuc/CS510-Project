{"url": "https://towardsdatascience.com/training-a-model-on-google-ai-platform-84ceff87b5f3", "time": 1683013283.7457888, "path": "towardsdatascience.com/training-a-model-on-google-ai-platform-84ceff87b5f3/", "webpage": {"metadata": {"title": "Training a model on Google\u2019s AI Platform | by Matteo Felici | Towards Data Science", "h1": "Training a model on Google\u2019s AI Platform", "description": "Welcome to the first article in this series about doing Machine Learning stuff on the Google Cloud Platform! We will take a look at the AI Platform. It is a subset of tools strictly related to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cloud.google.com/ai-platform/docs", "anchor_text": "AI Platform", "paragraph_index": 1}, {"url": "https://console.cloud.google.com/storage/", "anchor_text": "Google Storage console", "paragraph_index": 5}, {"url": "https://github.com/MatteoFelici/medium/blob/master/ai-platform-training/src/train.py", "anchor_text": "Github", "paragraph_index": 10}, {"url": "https://github.com/MatteoFelici/medium/blob/master/ai-platform-training/cloud_train.sh", "anchor_text": "cloud_train", "paragraph_index": 21}, {"url": "https://console.cloud.google.com/ai-platform/jobs", "anchor_text": "Google AI Platform Jobs console", "paragraph_index": 24}, {"url": "https://towardsdatascience.com/tuning-a-model-with-bayesian-optimization-on-google-ai-platform-d9fe63b78576", "anchor_text": "tuning the hyperparameters", "paragraph_index": 31}, {"url": "http://Facile.it", "anchor_text": "Facile.it", "paragraph_index": 34}], "all_paragraphs": ["Welcome to the first article in this series about doing Machine Learning stuff on the Google Cloud Platform!", "We will take a look at the AI Platform. It is a subset of tools strictly related to Machine Learning, among which:", "DISCLAIMER: I am not affiliated with Google in any way, I simply decided towrite these articles to share the knowledge I acquired using these tools in mydaily job.", "For this first article, I\u2019ll focus on AI Platform Training, a product to runtraining jobs on the Cloud with custom code and customizable machines. I think the main advantages of using the AI Platform to train your models are:", "In this tutorial, we will write the actual Python application with the definition of the training, run a local test, and execute the training job on the Cloud Platform.", "After you downloaded the dataset on your local machine, go to the Google Storage console of your GCP project. Create a new bucket (I\u2019ve called it bank-marketing-model) and load the dataset in it. Now your bucket should look like this:", "Alternatively, in a more geeky way, you can use gsutil from the command line. Go into the local directory containing the dataset and run", "If you\u2019re reading this, chances are that you already know how to write an end-to-end Python program to train a Machine Learning model. Anyway, since we\u2019re planning to train the model on the Cloud, there are a few steps that are someway different than the usual Kaggle-ish code.", "The first thing to bear in mind, you can use only scikit-learn, XGBoost or Tensorflow to train your model (Pytorch is in beta, and there is a way to use a custom Python environment, but we\u2019ll see it in another article).", "So, the basics of the Python application are:", "You can find the whole code on Github. N.B.: at the top of the code there are a few parameters that you can tune.", "Before submitting the training process on the Cloud Platform, it is better to test the code locally. For both local and cloud training, we will use gcloud; the command to run is quite similar, but there are a few differences.", "First, to train the model locally with the AI Platform, we can write a command that \"revert\" this logic: gcloud ai-platform (with the AI Platform) local (locally) train (train the model). We add a bunch of parameters, some of which are specific to the training process, others are defined in our custom Python application.", "After you go into the main directory, with the src directory, the complete command goes like this:", "Let\u2019s take a look at the parameters:", "Since this is a test run, we specify a low number of trees for the Random Forest.", "Keep in mind that, even if this is a local test run, it will create all the artifacts and save them to your Storage Bucket. If everything runs without errors, we can switch to the actual training on the Cloud!", "Now that we have written the application and tested it, we can finally train our model on the Platform. For example, we can instantiate a multi-core machine type and parallelize the training of the Forest.", "As said before, the bash code is quite similar, but we have to invoke another group of commands. Instead of local train we use jobs submit training:", "Once again, let\u2019s take a look at the new parameters:", "BONUS TIP: if you want to install a package that is not available in the runtime list, add a \u201cpip\u201d command at the top of your application, like", "N.B. the $JOB_NAME in the code above is not a valid name, but it\u2019s a reference to a bash variable defined before. It is very important to specify each time a different job name. For example, as you can see in the cloud_train script, we can specify", "so the suffix will change every time with the actual day and time.", "If it\u2019s the first time you use this tool, it will probably ask you to enable a specific Google API (like ml.googleapis.com): accept to enable it and continue. If everything is ok, the command should return something like this", "and in your Google AI Platform Jobs console you should see the new job running", "Now, you can monitor the training job in two ways:", "Hooray! The job ended correctly. Let\u2019s take a look at our Storage bucket:", "We have the model.joblib object, the results.csv file with the model performance and a folder automatically created by the job to storage the Python application.", "Let\u2019s take a look at the model performances\u2026 We can download the results file, or type the command", "to see the file directly on the command line.", "For my trained model, I got these results:", "These are quite good results, but we can do better by tuning the hyperparameters of the model. In the next article, we will see how to slightly change the training application to make the AI Platform search the best hyperparameters with a Bayesian optimization process!", "Thanks for reading, and I hope you will find this useful!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist \u2014 Machine Learning Engineer @ Facile.it | Passionate about tech \ud83d\udcbb. football \u26bd\ufe0f. sci-fi \ud83d\udcda. cats \ud83d\ude3c"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F84ceff87b5f3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@matteofelici87?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matteofelici87?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": "Matteo Felici"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe05a801eafa4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&user=Matteo+Felici&userId=e05a801eafa4&source=post_page-e05a801eafa4----84ceff87b5f3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84ceff87b5f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84ceff87b5f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@beautyoftechnology?utm_source=medium&utm_medium=referral", "anchor_text": "Nikolay Tarashchenko"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://cloud.google.com/ai-platform/docs", "anchor_text": "AI Platform"}, {"url": "https://cloud.google.com/", "anchor_text": "homepage"}, {"url": "https://cloud.google.com/sdk/docs", "anchor_text": "gcloud"}, {"url": "https://cloud.google.com/storage/docs/gsutil_install", "anchor_text": "gsutil"}, {"url": "https://archive.ics.uci.edu/ml/machine-learning-databases/00222/bank-additional.zip", "anchor_text": "dataset used for the tutorial"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Bank+Marketing", "anchor_text": "Here"}, {"url": "https://console.cloud.google.com/storage/", "anchor_text": "Google Storage console"}, {"url": "https://github.com/MatteoFelici/medium/blob/master/ai-platform-training/src/train.py", "anchor_text": "Github"}, {"url": "https://cloud.google.com/compute/docs/regions-zones", "anchor_text": "here"}, {"url": "https://cloud.google.com/ai-platform/training/docs/machine-types#compare-machine-types", "anchor_text": "here"}, {"url": "https://cloud.google.com/ai-platform/training/docs/runtime-version-list", "anchor_text": "here"}, {"url": "https://github.com/MatteoFelici/medium/blob/master/ai-platform-training/cloud_train.sh", "anchor_text": "cloud_train"}, {"url": "https://console.cloud.google.com/ai-platform/jobs", "anchor_text": "Google AI Platform Jobs console"}, {"url": "https://towardsdatascience.com/tuning-a-model-with-bayesian-optimization-on-google-ai-platform-d9fe63b78576", "anchor_text": "tuning the hyperparameters"}, {"url": "https://medium.com/tag/google?source=post_page-----84ceff87b5f3---------------google-----------------", "anchor_text": "Google"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----84ceff87b5f3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----84ceff87b5f3---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----84ceff87b5f3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/google-ml-tutorials?source=post_page-----84ceff87b5f3---------------google_ml_tutorials-----------------", "anchor_text": "Google Ml Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F84ceff87b5f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&user=Matteo+Felici&userId=e05a801eafa4&source=-----84ceff87b5f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F84ceff87b5f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&user=Matteo+Felici&userId=e05a801eafa4&source=-----84ceff87b5f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84ceff87b5f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F84ceff87b5f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----84ceff87b5f3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----84ceff87b5f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matteofelici87?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matteofelici87?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matteo Felici"}, {"url": "https://medium.com/@matteofelici87/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "31 Followers"}, {"url": "http://Facile.it", "anchor_text": "Facile.it"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe05a801eafa4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&user=Matteo+Felici&userId=e05a801eafa4&source=post_page-e05a801eafa4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe4838f65316b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-model-on-google-ai-platform-84ceff87b5f3&newsletterV3=e05a801eafa4&newsletterV3Id=e4838f65316b&user=Matteo+Felici&userId=e05a801eafa4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}