{"url": "https://towardsdatascience.com/10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1", "time": 1683007551.492383, "path": "towardsdatascience.com/10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1/", "webpage": {"metadata": {"title": "10 TensorFlow Tricks Every ML Practitioner Must Know | by Rohan Jagtap | Towards Data Science", "h1": "10 TensorFlow Tricks Every ML Practitioner Must Know", "description": "TensorFlow 2.x offers a lot of simplicity in building models and in overall TensorFlow usage. So what\u2019s new in TF2? In this article, we will explore 10 features of TF 2.0, that make working with\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/datasets/catalog/overview", "anchor_text": "Datasets page of the documentation", "paragraph_index": 13}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/applications", "anchor_text": "docs page", "paragraph_index": 18}, {"url": "https://www.tensorflow.org/api_docs/python/tf/estimator", "anchor_text": "TensorFlow docs", "paragraph_index": 22}, {"url": "https://www.tensorflow.org/tutorials/customization/custom_layers", "anchor_text": "documentation", "paragraph_index": 24}, {"url": "https://www.tensorflow.org/tutorials/distribute/custom_training", "anchor_text": "docs", "paragraph_index": 39}, {"url": "https://www.tensorflow.org/tutorials/distribute/keras", "anchor_text": "documentation", "paragraph_index": 40}, {"url": "https://github.com/rojagtap/tensorflow_tutorials", "anchor_text": "Here", "paragraph_index": 42}], "all_paragraphs": ["TensorFlow 2.x offers a lot of simplicity in building models and in overall TensorFlow usage. So what\u2019s new in TF2?", "In this article, we will explore 10 features of TF 2.0, that make working with TensorFlow smoother, reduces lines of code and increases efficiency as these functions/classes belong to the TensorFlow API.", "The tf.data API offers functions for data pipelining and related operations. We can build pipelines, map preprocessing functions, shuffle or batch a dataset and much more.", "This is one of the best features of the tensorflow.keras API (in my opinion). The ImageDataGenerator is capable of generating dataset slices while batching and preprocessing along with data augmentation in real-time.", "The Generator allows data flow directly from directories or from dataframes.", "A misconception about data augmentation in ImageDataGenerator is that, it adds more data to the existing dataset. Although that is the actual definition of data augmentation, in ImageDataGenerator, the images in the dataset are transformed dynamically at different steps in training so that the model can be trained on noisy data it hasn\u2019t seen.", "Here, the rescaling is done on all the samples (for normalizing), while the other parameters are for augmentation.", "We specify the directory for the real-time data flow. This can be done using dataframes as well.", "The x_col parameter defines the full path of the image whereas the y_col parameter defines the label column for classification.", "The model can be directly fed with the generator. Although the steps_per_epoch parameter needs to be specified which is essentially number_of_samples // batch_size.", "Data augmentation is necessary. In case of insufficient data, making changes in the data and treating it as a separate datapoint is a very effective way of training under less data.", "The tf.image API has tools for transforming images which can be later used for data augmentation with tf.data API discussed earlier.", "This is a very useful library as it is a single go-to point for a dump of very well-known datasets from various domains collected by TensorFlow.", "A detailed list of the datasets available in tensorflow-datasets can be found on the Datasets page of the documentation.", "Audio, Image, Image classification, Object Detection, Structured, Summarization, Text, Translate, Video are the genres offered by tfds.", "Transfer Learning is the new cool in Machine Learning and it is as important as it sounds. It is infeasible and impractical to train a benchmark model which is already trained by someone else and under generous resources (for eg. multiple expensive GPUs that one may not afford). Transfer Learning, addresses this issue. A pretrained model can be reused for a given use case or can be extended for a different use case.", "TensorFlow offers benchmark pretrained models that can be extended easily for the desired use case.", "This base_model can be easily extended with additional layers or with different models. For eg:", "For a detailed list of other models and/or modules under tf.keras.applications, refer the docs page.", "An Estimator is TensorFlow\u2019s high-level representation of a complete model, and it has been designed for easy scaling and asynchronous training", "Premade estimators offer a very high level abstraction of a model, so you can directly focus on training the model without worrying about the lower level intricacies. For example:", "This shows how easy it is to build and train an estimator using tf.estimator. Estimators can also be customised.", "TensorFlow has many premade estimators including LinearRegressor, BoostedTreesClassifier, etc. A complete, detailed list of estimators can be found at the TensorFlow docs.", "Neural Nets are known for many layer deep networks wherein the layers can be of different types. TensorFlow contains many predefined layers (like Dense, LSTM, etc.). But for more complex architectures, the logic of a layer is much more complex than a primary layer. For such instances, TensorFlow allows building custom layers. This can be done by subclassing the tf.keras.layers.Layer class.", "As stated in the documentation, The best way to implement your own layer is extending the tf.keras.Layer class and implementing:", "Although the kernel initialization can be done in __init__ itself, it is considered better to be initialized in build as otherwise, you would have to explicitly specify the input_shape on every instance of a new layer creation.", "The tf.keras Sequential and the Model API makes training models easier. However, most of the time while training complex models, custom loss functions are used. Moreover, the model training can also differ from the default (for eg. applying gradients separately to different model components).", "TensorFlow\u2019s automatic differentiation helps calculating gradients in an efficient way. These primitives are used in defining custom training loops.", "This loop can be repeated for multiple epochs and with a more customised setting as per the use case.", "Saving a TensorFlow model can be of two types:", "Checkpoints capture the exact values of all the parameters used by a model. Models built with the Sequential API or the Model API can simply be saved in the SavedModel format.", "However, for custom models, checkpoints are required.", "Checkpoints do not contain any description of the computation defined by the model and thus are typically only useful when source code that will use the saved parameter values is available.", "TensorFlow matches variables to checkpointed values by traversing a directed graph with named edges, starting from the object being loaded.", "This is a fairly new feature in TensorFlow.", "Hyper-parameter tuning or Hypertuning is the process of cherrypicking parameters that define the configuration of a ML model. These factors are the deciding factors for the performance of a model in the aftermath of feature engineering and preprocessing.", "Along with HyperBand, BayesianOptimization and RandomSearch are also available for tuning.", "Further, we train the model using the optimal hyper-parameters:", "If you have multiple GPUs and wish to optimize training by dispersing the training loop over multiple GPUs, TensorFlow\u2019s various distributed training strategies are capable of optimizing the GPU usage and manipulate training over the GPUs for you.", "tf.distribute.MirroredStrategy is the most common strategy used. How does it work anyway? The docs state:", "For other strategies and custom training loops, refer the documentation.", "TensorFlow is sufficient for building almost all the components of a ML pipeline. The takeaway from this tutorial is an introduction to the various APIs provided by TensorFlow and a quick guide on how to use them.", "Here is a link to the GitHub repository of the code. Feel free to fork it.", "The code used in this guide is referred from the following official TensorFlow Documentation:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Immensely interested in AI Research | I read papers and post my notes on Medium"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F96b860e53c1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----96b860e53c1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----96b860e53c1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rojagtap.medium.com/?source=post_page-----96b860e53c1--------------------------------", "anchor_text": ""}, {"url": "https://rojagtap.medium.com/?source=post_page-----96b860e53c1--------------------------------", "anchor_text": "Rohan Jagtap"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39646f947a4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&user=Rohan+Jagtap&userId=39646f947a4c&source=post_page-39646f947a4c----96b860e53c1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96b860e53c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96b860e53c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://www.tensorflow.org/datasets/catalog/overview", "anchor_text": "Datasets page of the documentation"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/applications", "anchor_text": "docs page"}, {"url": "https://www.tensorflow.org/tutorials/estimator/premade", "anchor_text": "TensorFlow Docs"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/estimator", "anchor_text": "TensorFlow docs"}, {"url": "https://www.tensorflow.org/tutorials/customization/custom_layers", "anchor_text": "documentation"}, {"url": "https://www.tensorflow.org/guide/checkpoint", "anchor_text": "Docs"}, {"url": "https://www.tensorflow.org/tutorials/distribute/custom_training", "anchor_text": "docs"}, {"url": "https://www.tensorflow.org/tutorials/distribute/keras", "anchor_text": "documentation"}, {"url": "https://github.com/rojagtap/tensorflow_tutorials", "anchor_text": "Here"}, {"url": "https://www.tensorflow.org/tutorials", "anchor_text": "Tutorials | TensorFlow CoreComplete, end-to-end examples to learn how to use TensorFlow for ML beginners and experts. Try tutorials in Google\u2026www.tensorflow.org"}, {"url": "https://www.tensorflow.org/tutorials", "anchor_text": "Tutorials | TensorFlow CoreComplete, end-to-end examples to learn how to use TensorFlow for ML beginners and experts. Try tutorials in Google\u2026www.tensorflow.org"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----96b860e53c1---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----96b860e53c1---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----96b860e53c1---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----96b860e53c1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----96b860e53c1---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F96b860e53c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&user=Rohan+Jagtap&userId=39646f947a4c&source=-----96b860e53c1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F96b860e53c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&user=Rohan+Jagtap&userId=39646f947a4c&source=-----96b860e53c1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96b860e53c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----96b860e53c1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F96b860e53c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----96b860e53c1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----96b860e53c1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----96b860e53c1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----96b860e53c1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----96b860e53c1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----96b860e53c1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----96b860e53c1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----96b860e53c1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----96b860e53c1--------------------------------", "anchor_text": ""}, {"url": "https://rojagtap.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rojagtap.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rohan Jagtap"}, {"url": "https://rojagtap.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "465 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39646f947a4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&user=Rohan+Jagtap&userId=39646f947a4c&source=post_page-39646f947a4c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe51e2b6202c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-tensorflow-tricks-every-ml-practitioner-must-know-96b860e53c1&newsletterV3=39646f947a4c&newsletterV3Id=e51e2b6202c5&user=Rohan+Jagtap&userId=39646f947a4c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}