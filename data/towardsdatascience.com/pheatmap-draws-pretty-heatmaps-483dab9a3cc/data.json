{"url": "https://towardsdatascience.com/pheatmap-draws-pretty-heatmaps-483dab9a3cc", "time": 1683005566.021931, "path": "towardsdatascience.com/pheatmap-draws-pretty-heatmaps-483dab9a3cc/", "webpage": {"metadata": {"title": "Pheatmap Draws Pretty Heatmaps. A tutorial of how to generate pretty\u2026 | by Yufeng | Towards Data Science", "h1": "Pheatmap Draws Pretty Heatmaps", "description": "In R, there are many packages to generate heatmaps, such as heatmap(), heatmap.2(), and heatmaply(). However, my favorite one is pheatmap(). I am very positive that you will agree with my choice\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/heatmap", "anchor_text": "heatmap", "paragraph_index": 1}, {"url": "https://www.rdocumentation.org/packages/gplots/versions/3.0.3/topics/heatmap.2", "anchor_text": "heatmap.2", "paragraph_index": 1}, {"url": "https://cran.r-project.org/web/packages/heatmaply/vignettes/heatmaply.html", "anchor_text": "heatmaply", "paragraph_index": 1}, {"url": "https://www.rdocumentation.org/packages/pheatmap/versions/1.0.12/topics/pheatmap", "anchor_text": "pheatmap", "paragraph_index": 1}, {"url": "https://www.basketball-reference.com/leagues/NBA_2020_per_game.html", "anchor_text": "the basketball reference", "paragraph_index": 3}, {"url": "https://www.basketball-reference.com/leagues/NBA_2020_per_game.html", "anchor_text": "one of my previous posts", "paragraph_index": 3}, {"url": "https://cran.r-project.org/web/packages/pheatmap/pheatmap.pdf", "anchor_text": "function manual", "paragraph_index": 31}, {"url": "https://jianan-lin.medium.com/membership", "anchor_text": "https://jianan-lin.medium.com/membership", "paragraph_index": 34}], "all_paragraphs": ["Heatmap is one of the must-have data visualization toolkits for data scientists.", "In R, there are many packages to generate heatmaps, such as heatmap(), heatmap.2(), and heatmaply(). However, my favorite one is pheatmap(). I am very positive that you will agree with my choice after reading this post.", "In this post, I will go over this powerful data visualization package, pheatmap, by applying it to the NBA players\u2019 basic stats in the 2019\u20132020 season.", "The raw data is from the basketball reference. You can either download the dataset manually or scrape the data by following one of my previous posts.", "Above is the head of the data frame we are working on. It\u2019s okay that you don\u2019t understand what the column names are because they are all stats of basketball. It doesn\u2019t affect our exploration of heatmap plotting.", "Data cleaning: filter out players who played less than 30 minutes per game, remove duplicates of players who got traded during the season and fill NA values with 0.", "First, pheatmap only takes the numeric matrix object as input. So, we need to transfer the numeric part of the data frame to a matrix by removing the first 5 columns of categorical data.", "Since the row names of the matrix are the default row labels in the heatmap, we\u2019d better make them meaningful by avoiding numeric index.", "The different columns of the players\u2019 data have a large variation in the range, so we need to scale them to keep the heatmap from being dominated by the large values.", "The scale function in R performs standard scaling to the columns of the input data, which first subtracts the column means from the columns (center step) and then divides the centered columns by the column standard deviations (scale step). This function is to scale the data to a distribution with mean as 0 and standard deviation as 1.", "Its equation can be shown as below, where x is the data, u is the column means and s is the column standard deviations.", "You can turn off the center step or the scale step in R by setting center = FALSE or scale = FALSE, respectively. Let\u2019s visualize the effect of scaling by plotting out the density of players\u2019 points per game before and after scaling.", "After scaling the data is ready to be fed into the function.", "Let\u2019s look at the default pheatmap.", "The default behavior of the function includes the hierarchical clustering of both rows and columns, in which we can observe similar players and stats types in close positions.", "For example, there\u2019s a super warm area in the middle part of the heatmap. It corresponds to a bunch of superstars, which includes James Harden, Luka Doncic, LeBron James, and Damian Lillard.", "If you want to turn off the clustering, you can set either cluster_cols or cluster_rows to False. The code below cancels the column clustering.", "Actually, the function itself can do both row and column scaling in the heatmap. It mainly serves as a visualization purpose for the comparison across rows or columns. The following code shows the row scaling heatmap.", "The annotation function is one of the most powerful features of pheatmap. Specifically, you can input an independent data frame with annotations to the rows or columns of the heatmap matrix.", "For example, I annotated each player with their position, made it a data frame object and input it to the pheatmap function. One thing to note, the row names of the annotation data frame have to match the row names or column names of the heatmap matrix depending on your annotation target.", "You can see from the heatmap that there is another column of colors that indicate the position of the players.", "We see the players are not clustered by their positions, which suggests the relationship between the players\u2019 positions and their playing types are becoming vague with the evolution of basketball.", "Also, we can add the column annotation as well. I named the stats with their categories that include Offence, Defence, and others.", "Then, I plot the heatmap with column annotation only. This time I only turn on the column clustering.", "We can see from the heatmap that the offense-related stats tend to be clustered together.", "The last feature I would like to introduce is the heatmap cutting feature. Sometimes, it will give a clearer visualization if we cut the heatmap by the clustering.", "By cutting a heatmap apart, the stand-alone blocks will represent its own population. Let\u2019s see the row-wise cutting in the following example.", "In the code, I input cutree_rows = 4 , which means cut the heatmap row-wise to 4 clusters.", "The aforementioned group of superstars is present in the third block in the cut heatmap.", "We can do a similar thing to the columns as below.", "In this way, similar stats are shown close to each other.", "Up until now, I have gone through all the major features of pheatmap. Of course, there are a lot more details in the package, such as the color palette, clustering distance metrics, and so on. For those who are interested, please refer to the function manual.", "I hope this tutorial can help you strengthen your visualization toolkit. If you have enjoyed reading this post, you can also find interesting stuff in my other posts.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D., Data Scientist and Bioinformatician. Support my writing by becoming one of my referred members: https://jianan-lin.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F483dab9a3cc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jianan-lin.medium.com/?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": "Yufeng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cda0369fb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&user=Yufeng&userId=9cda0369fb2&source=post_page-9cda0369fb2----483dab9a3cc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F483dab9a3cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F483dab9a3cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@danielcgold?utm_source=medium&utm_medium=referral", "anchor_text": "Dan Gold"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/heatmap", "anchor_text": "heatmap"}, {"url": "https://www.rdocumentation.org/packages/gplots/versions/3.0.3/topics/heatmap.2", "anchor_text": "heatmap.2"}, {"url": "https://cran.r-project.org/web/packages/heatmaply/vignettes/heatmaply.html", "anchor_text": "heatmaply"}, {"url": "https://www.rdocumentation.org/packages/pheatmap/versions/1.0.12/topics/pheatmap", "anchor_text": "pheatmap"}, {"url": "https://www.basketball-reference.com/leagues/NBA_2020_per_game.html", "anchor_text": "the basketball reference"}, {"url": "https://www.basketball-reference.com/leagues/NBA_2020_per_game.html", "anchor_text": "one of my previous posts"}, {"url": "https://www.r-project.org/", "anchor_text": "R"}, {"url": "https://www.rdocumentation.org/packages/pheatmap/versions/1.0.12/topics/pheatmap", "anchor_text": "pheatmap"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://medium.com/@jianan.jay.lin", "anchor_text": "Yufeng"}, {"url": "https://cran.r-project.org/web/packages/pheatmap/pheatmap.pdf", "anchor_text": "function manual"}, {"url": "https://towardsdatascience.com/hands-on-guidance-of-data-visualization-in-r-package-ggplot2-of-nba-players-stats-d812ed272d66", "anchor_text": "Hands-on Guidance of Data Visualization in R Package \u201cggplot2\u201d of NBA Players\u2019 StatsA 6-minute tour of R data visualization tool, \u201cggplot2\u201d, applied to NBA data.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/present-the-feature-importance-of-the-random-forest-classifier-99bb042be4cc", "anchor_text": "Present The Feature Importance of The Random Forest ClassifierHow to build a random forest classifier, extract the feature importance, and present them beautifully.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/whos-the-mvp-of-nba-this-season-3e347c66a40a", "anchor_text": "Who\u2019s The MVP of NBA This Season?A case study to show what a machine learning project looks like from the beginning to the end.towardsdatascience.com"}, {"url": "https://unsplash.com/@morgansessions?utm_source=medium&utm_medium=referral", "anchor_text": "Morgan Sessions"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----483dab9a3cc---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/data?source=post_page-----483dab9a3cc---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/r-programming?source=post_page-----483dab9a3cc---------------r_programming-----------------", "anchor_text": "R Programming"}, {"url": "https://medium.com/tag/heatmap?source=post_page-----483dab9a3cc---------------heatmap-----------------", "anchor_text": "Heatmap"}, {"url": "https://medium.com/tag/nba?source=post_page-----483dab9a3cc---------------nba-----------------", "anchor_text": "NBA"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F483dab9a3cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&user=Yufeng&userId=9cda0369fb2&source=-----483dab9a3cc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F483dab9a3cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&user=Yufeng&userId=9cda0369fb2&source=-----483dab9a3cc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F483dab9a3cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F483dab9a3cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----483dab9a3cc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----483dab9a3cc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----483dab9a3cc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----483dab9a3cc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----483dab9a3cc--------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jianan-lin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yufeng"}, {"url": "https://jianan-lin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "728 Followers"}, {"url": "https://jianan-lin.medium.com/membership", "anchor_text": "https://jianan-lin.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9cda0369fb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&user=Yufeng&userId=9cda0369fb2&source=post_page-9cda0369fb2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff12c76e2ba88&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpheatmap-draws-pretty-heatmaps-483dab9a3cc&newsletterV3=9cda0369fb2&newsletterV3Id=f12c76e2ba88&user=Yufeng&userId=9cda0369fb2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}