{"url": "https://towardsdatascience.com/predicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359", "time": 1682994876.480119, "path": "towardsdatascience.com/predicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359/", "webpage": {"metadata": {"title": "Predicting Rich Attributes in Real Estate Images Using Fastai | by Dave Samuel | Towards Data Science", "h1": "Predicting Rich Attributes in Real Estate Images Using Fastai", "description": "Visual attribute search can greatly improve the user experience, and SEO for home listing and travel websites. Although Zillow, Redfin, Airbnb and TripAdvisor have some metadata already about the\u2026"}, "outgoing_paragraph_urls": [{"url": "http://platform.ai", "anchor_text": "platform.ai", "paragraph_index": 2}, {"url": "http://fast.ai", "anchor_text": "fastai\u2019s", "paragraph_index": 5}, {"url": "http://platform.ai", "anchor_text": "platform.ai", "paragraph_index": 12}], "all_paragraphs": ["Visual attribute search can greatly improve the user experience, and SEO for home listing and travel websites. Although Zillow, Redfin, Airbnb and TripAdvisor have some metadata already about the amenities of a property, they can expand searchable attributes by analyzing the property images with vision models.", "In this post, we share our initial approach towards a few-shot model for predicting property attributes like view, kitchen island, pool, high ceilings, hardwood floors, fireplace, etc. Since these attributes are often room and context dependent, we begin with an accurate classification model to group our images into interior and exterior settings of the property.", "In the process of training our initial room-type model, we notice that some of these rich attributes are easily separable in platform.ai.", "Previous work has focused on using images to improve price estimation [1] however the incremental gain of adding image features to pricing models has been minimal; 2.3% improvement over using a handful of conventional attributes like location and property size. While pricing data for building these models has been readily available, there is a scarcity of datasets for predicting rich attributes like view, kitchen island, pool, high ceilings, hardwood floors, fireplace, etc.", "Our initial dataset, previously used in price estimation [1], consists of 146,791 images and seven classes: living room, dining room, bedroom, bathroom, kitchen, interior and exterior.", "Bathroom is the most underrepresented class, with nearly half the amount of images than any other class. We addressed this class imbalance using fastai\u2019s vision.transform method [4] to oversample the data using the default image augmentations.", "The images were pre-processed using fast.ai\u2019s built-in transforms. Data was split randomly into 60% train, 20% validation and 20% test.", "The model was initialized with ImageNet-ResNet34 weights. The network\u2019s custom head was trained for 3 epochs, followed by unfreezing the entire network and fine tuning for another 10 epochs using discriminative learning rates. Fine tuning improved the model fit, achieving an overall test set accuracy: 97%.", "By increasing the network capacity to a ResNet50, 98% final accuracy was achieved \u2014 a significant improvement over the 91% accuracy of the previous results [1].", "We constructed a rich attribute dataset by crawling property listing websites. The crawler captured both images, and the attributes of interest. In total 18,790 listings were obtained along with 350,000 images.", "Our web scraper captured unstructured html, and extracted the rich attributes contained in the listings\u2019 details table.", "The final data set consists of 18,790 individual listings that each hold an average of 21 images. We have identified several features visible in the photos like pools, patios, kitchen islands, and fireplaces. Nearly half of the listings in our data set have a pool or a patio, and only about 25 listings have wine cellars. Furthermore, the appearance of the attribute can be seen in different spaces; modern wine cellars tend to be above ground.", "We uploaded our model, and a sample of 20,000 images from our dataset to platform.ai in order to compare its performance against the pre-built ImageNet model. Our model forms neat clusters, easily separable by eye, of similar attributes of interest like fireplaces, pools, and kitchen islands. In comparison, ImageNet tends to form wider clusters with dissimilar attributes.", "Using the projections as visual aids, clusters of interest were highlighted, and selectively filtered using platform.ai. The zoomed in views of our model projection show three rich features which we have identified through our model: fireplace, kitchen island, and pool. When compared with ImageNet, we can see more numerous clusters bound closely to rich attributes vs. labeled room class features.", "After downloading our projections, we were able to evaluate a clustering solution comparing our model\u2019s silhouette score against ImageNet. The results show that our silhouette score is significantly greater than ImageNet per t-test results on k=5 K-means clusters Silhouette score. Thus, our model produces similar clusters more consistently than ImageNet-ResNet.", "Applying modern machine learning practices, we have developed a computer vision model that not only predicts room classes, but also the deeper attributes present in the homes that we live in. It performed better than ImageNet by clustering our nested attributes closer together, allowing visually separable groups to be extracted and labeled. Development of an accurate attribute search model could be implemented as an essential search tool in finding the right home or rental.", "We plan on developing our model further using the limited labeled data from our dataset, and a Relation Network (RN) [2] to classify multiple attributes in images.", "We\u2019d like to thank Arshak Navruzyan for his mentor support and guidance during this project. We would also like to thank fastai team for a convenient deep learning library.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6d9ab248f359&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@davesamuel?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davesamuel?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": "Dave Samuel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a6823913c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&user=Dave+Samuel&userId=2a6823913c1&source=post_page-2a6823913c1----6d9ab248f359---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d9ab248f359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d9ab248f359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://platform.ai", "anchor_text": "platform.ai"}, {"url": "http://fast.ai", "anchor_text": "fastai\u2019s"}, {"url": "http://platform.ai", "anchor_text": "platform.ai"}, {"url": "https://omidpoursaeed.github.io/publication/vision-based-real-estate-price-estimation/", "anchor_text": "Vision-based real estate price estimation"}, {"url": "https://arxiv.org/abs/1706.01427", "anchor_text": "A simple neural network module for relational reasoning"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "Deep Residual Learning for Image Recognition"}, {"url": "https://docs.fast.ai/", "anchor_text": "fastai"}, {"url": "https://platform.ai/blog/page/1/optimizing-hyperparams-for-image-datasets-in-fastai/", "anchor_text": "Optimizing hyperparams for image datasets in fastai"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6d9ab248f359---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----6d9ab248f359---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6d9ab248f359---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----6d9ab248f359---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/fastai?source=post_page-----6d9ab248f359---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d9ab248f359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&user=Dave+Samuel&userId=2a6823913c1&source=-----6d9ab248f359---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6d9ab248f359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&user=Dave+Samuel&userId=2a6823913c1&source=-----6d9ab248f359---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6d9ab248f359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6d9ab248f359&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6d9ab248f359---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6d9ab248f359--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6d9ab248f359--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6d9ab248f359--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6d9ab248f359--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davesamuel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@davesamuel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dave Samuel"}, {"url": "https://medium.com/@davesamuel/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "91 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a6823913c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&user=Dave+Samuel&userId=2a6823913c1&source=post_page-2a6823913c1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbf9fa08f7f65&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-rich-attributes-in-real-estate-images-using-fastai-6d9ab248f359&newsletterV3=2a6823913c1&newsletterV3Id=bf9fa08f7f65&user=Dave+Samuel&userId=2a6823913c1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}