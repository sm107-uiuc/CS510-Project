{"url": "https://towardsdatascience.com/boosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c", "time": 1683003619.251482, "path": "towardsdatascience.com/boosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c/", "webpage": {"metadata": {"title": "XGBoost and Imbalanced Classes: Predicting Hotel Cancellations | by Michael Grogan | Towards Data Science", "h1": "XGBoost and Imbalanced Classes: Predicting Hotel Cancellations", "description": "In this example, boosting techniques are used to determine whether a customer will cancel their hotel booking or not. Hotel cancellations represent the response (or dependent) variable, where 1 =\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.michael-grogan.com/articles/boosting-python-hotel-cancellations", "anchor_text": "here", "paragraph_index": 33}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 36}], "all_paragraphs": ["For this reason, boosting is referred to as an ensemble method.", "In this example, boosting techniques are used to determine whether a customer will cancel their hotel booking or not.", "The training data is imported from an AWS S3 bucket as follows:", "Hotel cancellations represent the response (or dependent) variable, where 1 = cancel, 0 = follow through with booking.", "The features for analysis are as follows.", "The identified features to be included in the analysis using both the ExtraTreesClassifier and forward and backward feature selection methods are as follows:", "XGBoost is a boosting technique that has become renowned for its execution speed and model performance, and is increasingly being relied upon as a default boosting method \u2014 this method implements the gradient boosting decision tree algorithm which works in a similar manner to adaptive boosting, but instance weights are no longer tweaked at every iteration as in the case of AdaBoost. Instead, an attempt is made to fit the new predictor to the residual errors that the previous predictor made.", "When comparing the accuracy scores, we see that numerous readings are provided in each confusion matrix.", "However, a particularly important distinction exists between precision and recall.", "The two readings are often at odds with each other, i.e. it is often not possible to increase precision without reducing recall, and vice versa.", "An assessment as to the ideal metric to use depends in large part on the specific data under analysis. For example, cancer detection screenings that have false negatives (i.e. indicating patients do not have cancer when in fact they do), is a big no-no. Under this scenario, recall is the ideal metric.", "However, for emails \u2014 one might prefer to avoid false positives, i.e. sending an important email to the spam folder when in fact it is legitimate.", "The f1-score takes both precision and recall into account when devising a more general score.", "Which would be more important for predicting hotel cancellations?", "Well, from the point of view of a hotel \u2014 they would likely wish to identify customers who are ultimately going to cancel their booking with greater accuracy \u2014 this allows the hotel to better allocate rooms and resources. Identifying customers who are not going to cancel their bookings may not necessarily add value to the hotel\u2019s analysis, as the hotel knows that a significant proportion of customers will ultimately follow through with their bookings in any case.", "The data is firstly split into training and validation data for the H1 dataset, with the H2 dataset being used as the test set for comparing the XGBoost predictions with actual cancellation incidences.", "Here is an implementation of the XGBoost algorithm:", "Note that the scale_pos_weight parameter in this instance is set to 5. The reason for this is to impose greater penalties for errors on the minor class, in this case any incidences of 1 in the response variable, i.e. hotel cancellations. The higher the weight, the greater penalty is imposed on errors on the minor class. The reason for doing this is because there are more 0s than 1s in the dataset \u2014 i.e. more customers follow through on their bookings than cancel.", "Therefore, in order to have an unbiased model, errors on the minor class need to be penalised more severely.", "Here is the accuracy on the training and validation set:", "Here is a confusion matrix comparing the predicted vs. actual cancellations on the validation set:", "Note that while the accuracy in terms of the f1-score (41%) is quite low \u2014 the recall score for class 1 (cancellations) is 100%. This means that the model is generating many false positives which reduces the overall accuracy \u2014 but this has had the effect of increasing recall to 100%, i.e. the model is 100% successful at identifying all the customers who will cancel their booking, even if this results in some false positives.", "As previously, the test set is also imported from the relevant S3 bucket:", "Here is the subsequent classification performance of the XGBoost model on H2, which is the test set in this instance.", "The accuracy as indicated by the f1-score is slightly higher at 44%, but the recall accuracy for class 1 is at 100% once again.", "In this instance, it is observed that using a scale_pos_weight of 5 resulted in a 100% recall while lowering the f1-score accuracy very significantly to 44%.", "However, a recall of 100% can also be unreliable. For instance, suppose that the scale_pos_weight was set even higher \u2014 which meant that almost all of the predictions indicated a response of 1, i.e. all customers were predicted to cancel their booking.", "This model has no inherent value if all the customers are predicted to cancel, since there is no longer any way of identifying the unique attributes of customers who are likely to cancel their booking versus those who do not.", "In this regard, a more balanced solution is to have a high recall while also ensuring that the overall accuracy does not fall excessively low.", "Here are the confusion matrix results for when respective weights of 2, 3, 4, and 5 are used.", "When the scale_pos_weight is set to 3, recall comes in at 94% while accuracy is at 55%. When the scale_pos_weight parameter is set to 5, recall is at 100% while the f1-score accuracy falls to 44%. Additionally, note that increasing the parameter from 4 to 5 does not result in any change in either recall or overall accuracy.", "In this regard, using a weight of 3 allows for a high recall, while still allowing overall classification accuracy to remain above 50% and allows the hotel a baseline to differentiate between the attributes of customers who cancel their booking and those who do not.", "In this example, you have seen the use of various boosting methods to predict hotel cancellations. As mentioned, the boosting method in this instance was set to impose greater penalties on the minor class, which had the result of lowering the overall accuracy as measure by the f1-score since there were more false positives present. However, the recall score increased vastly as a result \u2014 if it is assumed that false positives are more tolerable than false negatives in this situation \u2014 then one could argue that the model has performed quite well on this basis. For reference, an SVM model run on the same dataset demonstrated an overall accuracy of 63%, while recall on class 1 decreased to 75%.", "You can find the original article here, which includes a link to the GitHub repository containing the relevant notebooks and datasets pertaining to the above examples.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F62b7a76ffa6c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----62b7a76ffa6c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62b7a76ffa6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62b7a76ffa6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.michael-grogan.com/articles/boosting-python-hotel-cancellations", "anchor_text": "here"}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "Antonio, Almedia and Nunes (2019). Hotel Booking Demand Datasets"}, {"url": "https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall", "anchor_text": "Classification: Precision and Recall"}, {"url": "https://machinelearningmastery.com/gentle-introduction-xgboost-applied-machine-learning/", "anchor_text": "Machine Learning Mastery: A Gentle Introduction to XGBoost for Applied Machine Learning"}, {"url": "https://medium.com/@pushkarmandot/https-medium-com-pushkarmandot-what-is-lightgbm-how-to-implement-it-how-to-fine-tune-the-parameters-60347819b7fc", "anchor_text": "What is LightGBM, How to implement it? How to fine tune the parameters?"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----62b7a76ffa6c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----62b7a76ffa6c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----62b7a76ffa6c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/classification-algorithms?source=post_page-----62b7a76ffa6c---------------classification_algorithms-----------------", "anchor_text": "Classification Algorithms"}, {"url": "https://medium.com/tag/boosting?source=post_page-----62b7a76ffa6c---------------boosting-----------------", "anchor_text": "Boosting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62b7a76ffa6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&user=Michael+Grogan&userId=eec017a8b178&source=-----62b7a76ffa6c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62b7a76ffa6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&user=Michael+Grogan&userId=eec017a8b178&source=-----62b7a76ffa6c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62b7a76ffa6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F62b7a76ffa6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----62b7a76ffa6c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----62b7a76ffa6c--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboosting-techniques-in-python-predicting-hotel-cancellations-62b7a76ffa6c&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}