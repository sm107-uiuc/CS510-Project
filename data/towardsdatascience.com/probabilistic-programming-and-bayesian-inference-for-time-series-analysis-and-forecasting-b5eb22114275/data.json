{"url": "https://towardsdatascience.com/probabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275", "time": 1683010261.3783731, "path": "towardsdatascience.com/probabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275/", "webpage": {"metadata": {"title": "Probabilistic Programming and Bayesian Inference for Time Series Analysis and Forecasting in Python | by Yuefeng Zhang, PhD | Towards Data Science", "h1": "Probabilistic Programming and Bayesian Inference for Time Series Analysis and Forecasting in Python", "description": "As described in [1][2], time series data includes many kinds of real experimental data taken from various domains such as finance, medicine, scientific research (e.g., global warming, speech\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "time series", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Bayes%27_theorem", "anchor_text": "Bayes\u2019 theorem", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Evidence", "anchor_text": "evidence", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Information", "anchor_text": "information", "paragraph_index": 2}, {"url": "https://www.kaggle.com/djokester/sales-of-shampoo-over-a-three-year-period", "anchor_text": "Sales of Shampoo", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo", "anchor_text": "MCMC", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Algorithm", "anchor_text": "algorithms", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Probability_distribution", "anchor_text": "probability distribution", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm", "anchor_text": "Metropolis\u2013Hastings algorithm", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Slope", "anchor_text": "slope", "paragraph_index": 17}, {"url": "http://www.columbia.edu/itc/sipa/math/intercepts.html", "anchor_text": "intercept", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Linear_regression", "anchor_text": "linear regression", "paragraph_index": 19}, {"url": "https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm", "anchor_text": "Metropolis\u2013Hastings algorithm", "paragraph_index": 25}, {"url": "https://www.kaggle.com/djokester/sales-of-shampoo-over-a-three-year-period", "anchor_text": "Sales of Shampoo", "paragraph_index": 39}, {"url": "https://github.com/tensorflow/probability", "anchor_text": "Tensorflow probability", "paragraph_index": 40}], "all_paragraphs": ["As described in [1][2], time series data includes many kinds of real experimental data taken from various domains such as finance, medicine, scientific research (e.g., global warming, speech analysis, earthquakes), etc. Time series forecasting has many real applications in various areas such as forecasting of business (e.g., sales, stock), weather, decease, and others [2]. Statistical modeling and inference (e.g., ARIMA model) [1][2] is one of the popular methods for time series analysis and forecasting.", "There are two statistical inference methods:", "The philosophy of Bayesian inference is to consider probability as a measure of believability in an event [3][4][5] and use Bayes\u2019 theorem to update the probability as more evidence or information becomes available, while the philosophy of frequentist inference considers probability as the long-run frequency of events [3].", "Generally speaking, we can use the Frequentist inference only when a large number of data samples are available. In contrast, the Bayesian inference can be applied to both large and small datasets.", "In this article, I use a small (only 36 data samples) Sales of Shampoo time series dataset from Kaggle [6] to demonstrate how to use probabilistic programming to implement Bayesian analysis and inference for time series analysis and forecasting.", "The rest of the article is arranged as follows:", "Let H be the hypothesis that an event will occur, D be new observed data (i.e., evidence), and p be the probability, the Bayes\u2019 theorem can be described as follows [5]:", "MCMC consists of a class of algorithms for sampling from a probability distribution. One of the widely used algorithm is the Metropolis\u2013Hastings algorithm. The essential idea is to randomly generate a large number of representative samples to approximate the continuous distribution over a multidimensional continuous parameter space [4].", "A high-level description of the Metropolis algorithm can be expressed as follows [3]:", "The foundation of MCMC is Bayes\u2019 theorem. Starting with a given prior distribution of the hypothesis and the data, each iteration of the Metropolis process above accumulates new data and uses it to update hypothesis for selecting next step in a random walking manner [4]. The accepted steps are samples of the posterior distribution of the hypothesis.", "There are multiple Python libraries that can be used to program Bayesian analysis and inference [3][5][7][8]. Such type of programming is called probabilistic programming [3][8] and the corresponding library is called probabilistic programming language. PyMC [3][7] and Tensorflow probability [8] are two examples.", "In this article, I use PyMC [3][7] as the probabilistic programming language to analyze and forecast the sales of Shampoo [6] for demonstration purpose.", "This section describes how to use PyMC [7] to program Bayesian analysis and inference for time series forecasting.", "Once the dataset of three-year sales of shampoo in Kaggle [6] has been downloaded onto a local machine, the dataset csv file can be loaded into a Pandas DataFrame as follows:", "The column of sales in the DataFrame can be extracted as a time series dataset:", "The following plot shows the sales of shampoo in three years (36 months):", "A good start to Bayesian modeling [3] is to think about how a given dataset might have been generated. Taking the sales of shampoo time series data in Figure 1 as an example, we can start by thinking:", "We know that a linear function is determined by two parameters: slope beta and intercept alpha:", "sales = beta x t + alpha + error", "To estimate what the linear function of time might be, we can fit a linear regression machine learning model into the given dataset to find the slope and intercept:", "The above code plots the regression line in red over the sales curves in blue:", "The slope and intercept of the regression line are just estimations based on limited data. To take care of uncertainty, we can represent them as normal random variables with the identified slope and intercept as mean values. This is achieved in PyMC [7] as below:", "Similarly, to handle uncertainty, we can use PyMC to represent the standard deviation of errors as a uniform random variable in the range of [0, 100]:", "With the random variables of std, beta, and alpha, the regression line with uncertainty can be represented in PyMC [7]:", "With the regression line with uncertainty, the prior distribution of the sales of shampoo time series data can be programmed in PyMC:", "Using the above prior distribution as the start position in the parameters (i.e., alpha, beta, std) space, we can perform MCMC using the Metropolis\u2013Hastings algorithm in PyMC:", "There are 100,000 accepted steps, called trace, in total. We ignore the first 20,000 accepted steps to avoid the burn-in period before convergence [3][4]. In other words, we only use the accepted steps after the burn-in period for Bayesian inference.", "The following code plots the traces of std, alpha, and beta after the burn-in period:", "The posterior distributions of std, alpha, and beta can be plotted as follows:", "The individual traces of std, alpha, and beta can be extracted for analysis:", "We can zoom into the details of the trace of std with any specified number of steps (e.g., 1,000):", "Similarly we can zoom into the details of the traces of alpha and beta respectively:", "Figures 5, 6, and 7 show that the posterior distributions of std, alpha, and beta have well mixed frequencies and thus low autocorrelations, which indicate MCMC convergence [3].", "The mean values of the posterior distributions of std, alpha, and beta can be calculated:", "The forecasting of the sales of shampoo can be modeled as follows:", "Sale(t) = beta_mean x t + alpha_mean + error", "where error follows normal distribution with mean of 0 and standard deviation of std_mean.", "Using the model above, given any number of time steps (e.g., 72), we can generate a time series of sales:", "Given 36 months of data, the code below plots the forecasting of sales in the next 36 months (from Month 37 to Moth 72).", "In this article, I used the small Sales of Shampoo [6] time series dataset from Kaggle [6] to show how to use PyMC [3][7] as a Python probabilistic programming language to implement Bayesian analysis and inference for time series forecasting.", "The other alternative of probabilistic programming language is the Tensorflow probability [8]. I chose PyMC in this article for two reasons. One is that PyMC is easier to understand compared with Tensorflow probability. The other reason is that Tensorflow probability is in the process of migrating from Tensorflow 1.x to Tensorflow 2.x, and the documentation of Tensorflow probability for Tensorflow 2.x is lacking.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist at Wavicle Data Solutions, He was a Senior Data Scientist at SMS Assist, a Senior Data Engineer at Capital One, and a DMTS at Motorola"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb5eb22114275&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b5eb22114275--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b5eb22114275--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zhangyuefeng1?source=post_page-----b5eb22114275--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=post_page-----b5eb22114275--------------------------------", "anchor_text": "Yuefeng Zhang, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80e8f2faf4bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=post_page-80e8f2faf4bc----b5eb22114275---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5eb22114275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5eb22114275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "time series"}, {"url": "https://en.wikipedia.org/wiki/Bayesian_inference", "anchor_text": "Bayesian inference"}, {"url": "https://en.wikipedia.org/wiki/Frequentist_inference", "anchor_text": "Frequentist inference"}, {"url": "https://en.wikipedia.org/wiki/Bayes%27_theorem", "anchor_text": "Bayes\u2019 theorem"}, {"url": "https://en.wikipedia.org/wiki/Evidence", "anchor_text": "evidence"}, {"url": "https://en.wikipedia.org/wiki/Information", "anchor_text": "information"}, {"url": "https://www.kaggle.com/djokester/sales-of-shampoo-over-a-three-year-period", "anchor_text": "Sales of Shampoo"}, {"url": "https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo", "anchor_text": "MCMC"}, {"url": "https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo", "anchor_text": "MCMC"}, {"url": "https://en.wikipedia.org/wiki/Algorithm", "anchor_text": "algorithms"}, {"url": "https://en.wikipedia.org/wiki/Probability_distribution", "anchor_text": "probability distribution"}, {"url": "https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm", "anchor_text": "Metropolis\u2013Hastings algorithm"}, {"url": "https://en.wikipedia.org/wiki/Slope", "anchor_text": "slope"}, {"url": "http://www.columbia.edu/itc/sipa/math/intercepts.html", "anchor_text": "intercept"}, {"url": "https://en.wikipedia.org/wiki/Linear_regression", "anchor_text": "linear regression"}, {"url": "https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm", "anchor_text": "Metropolis\u2013Hastings algorithm"}, {"url": "https://www.kaggle.com/djokester/sales-of-shampoo-over-a-three-year-period", "anchor_text": "Sales of Shampoo"}, {"url": "https://github.com/tensorflow/probability", "anchor_text": "Tensorflow probability"}, {"url": "https://medium.com/p/common-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8?source=email-80e8f2faf4bc--writer.postDistributed&sk=24961c5af213777f4e8dcdd00b290004", "anchor_text": "Common Time Series Data Analysis Methods and Forecasting Models in Python"}, {"url": "https://www.kaggle.com/djokester/sales-of-shampoo-over-a-three-year-period", "anchor_text": "Sales of Shampoo Over a Three Year Period"}, {"url": "https://docs.pymc.io/", "anchor_text": "PyMC3"}, {"url": "https://github.com/tensorflow/probability", "anchor_text": "Tensorflow Probability"}, {"url": "https://github.com/yzzhang/machine-learning/tree/master/probabilistic_programming", "anchor_text": "Github"}, {"url": "https://medium.com/tag/bayesian-inference?source=post_page-----b5eb22114275---------------bayesian_inference-----------------", "anchor_text": "Bayesian Inference"}, {"url": "https://medium.com/tag/probabilistic-programming?source=post_page-----b5eb22114275---------------probabilistic_programming-----------------", "anchor_text": "Probabilistic Programming"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----b5eb22114275---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----b5eb22114275---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b5eb22114275---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb5eb22114275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=-----b5eb22114275---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb5eb22114275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=-----b5eb22114275---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5eb22114275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b5eb22114275--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb5eb22114275&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b5eb22114275---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b5eb22114275--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b5eb22114275--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b5eb22114275--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b5eb22114275--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b5eb22114275--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b5eb22114275--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b5eb22114275--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b5eb22114275--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yuefeng Zhang, PhD"}, {"url": "https://medium.com/@zhangyuefeng1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "293 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80e8f2faf4bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=post_page-80e8f2faf4bc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F84632d34eae6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprobabilistic-programming-and-bayesian-inference-for-time-series-analysis-and-forecasting-b5eb22114275&newsletterV3=80e8f2faf4bc&newsletterV3Id=84632d34eae6&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}