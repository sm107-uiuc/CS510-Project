{"url": "https://towardsdatascience.com/detecting-constructiveness-in-online-article-comments-477bf4b4bd8", "time": 1683008200.086733, "path": "towardsdatascience.com/detecting-constructiveness-in-online-article-comments-477bf4b4bd8/", "webpage": {"metadata": {"title": "Detecting Constructiveness in Online Article Comments | by Ugo Loobuyck | Towards Data Science", "h1": "Detecting Constructiveness in Online Article Comments", "description": "Promoting constructiveness in online comment sections is an essential step to make the internet a more productive place. Instead of giving feedback by simply pointing out mistakes or attempting to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://huggingface.co/", "anchor_text": "HuggingFace", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/ktrain-a-lightweight-wrapper-for-keras-to-help-train-neural-networks-82851ba889c", "anchor_text": "this tutorial", "paragraph_index": 1}, {"url": "https://github.com/amaiya/ktrain", "anchor_text": "official doc", "paragraph_index": 1}, {"url": "https://www.kaggle.com/mtaboada/c3-constructive-comments-corpus/kernels?sortBy=hotness&group=everyone&pageSize=20&datasetId=581971", "anchor_text": "Kaggle", "paragraph_index": 2}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "arXiv preprint arXiv:1810.04805", "paragraph_index": 21}], "all_paragraphs": ["Promoting constructiveness in online comment sections is an essential step to make the internet a more productive place. Instead of giving feedback by simply pointing out mistakes or attempting to hurt, constructiveness can be used through argumentation and respectful discourse techniques in order to capitalize on these past mistakes for future improvements.", "Similarly to sentiment analysis or toxicity detection, it is possible to use deep learning techniques to model constructiveness and classify article comments. Current state-of-the-art models use the transformer architecture, which is more efficient than usual recurrent cells (LSTM, GRU\u2026) at processing input sequences in parallel. In this post, we will be using Distilbert (Sanh et al., 2019), created by HuggingFace. This model is a distilled version of BERT (Devlin et al., 2018), which essentially means a much lighter model that nearly reaches similar performance. We will use the ktrain Python library (Maiya, 2020), which allows very easy implementation of state-of-the-art models in Tensorflow Keras. For more information about ktrain implementation, this tutorial and the official doc can help you!", "The amount of labeled data is rather limited for constructiveness, so we will use the biggest and most recent one, the Constructiveness Comments Corpus (C3), available on Kaggle, and detailed in Kolhatkar et al (2020). The dataset is composed of 12000 news article comments and contains several tags for constructiveness and toxicity, but the only one we will use is constructive_binary.", "As usual, the first step is to import all the libraries we need for the project. You will need to install ktrain, which can be tricky depending on your setup, and then import it. We also import the basic trio pandas, numpy and matplotlib, as well as some metric and splitting tools from scikit-learn.", "Let\u2019s start by reading the dataset file in a pandas DataFrame. We should also take a look at the columns that interest us, comment_text and constructive_binary.", "We will soon need to know what maximum input length we want to allow, so it is useful to get some insight on comments length. Run the code below to display a description of the DataFrame comment column.", "The results show a length mean of 71 tokens, and that the 90th and 99th percentiles correspond to 157 and 362 tokens, respectively, so setting the MAXLEN between 150 to 200 tokens seems like like a good idea. Let\u2019s say 150 to save some memory space.", "Next, we should define a few global variables, including the max input length, the path to the dataset and the path to where you will save your trained model, the target label names and the HuggingFace model we want to use, in our case bert-base-uncased, which only uses lowercased inputs.", "Now let\u2019s take a look at the output class distribution to check if the dataset is balanced or not:", "There are more constructive comments than non-constructive comments, so the dataset is slightly imbalanced. During the validation and testing steps, we want to keep a good representativeness of the output classes, meaning that we want the target class distribution to be the same in all train/val/test sets. For that, we will use stratified splitting implemented with scikit-learn. Let\u2019s start by splitting training (that we call intermediate set) and test sets by setting 20% of the full set aside. The index of the DataFrames can be reset afterwards for more convenience.", "It is good practice to set another 10 to 20% of the training data for validation purpose, moreover using a validation set is possible in ktrain, so we again use stratified splitting and set 10% aside. Once again, reset the indexes for each DataFrame.", "Perfect! We now have our three datasets ready for use, so let\u2019s split inputs and outputs to feed our machine learning model. You can read the input column (X) into a numpy array, and cast the output (y) as a small int.", "It is now time to initialize the ktrain module by loading a Transformer object which takes the MODEL_NAME, MAXLEN and LABELS defined earlier. State-of-the-art architectures do not necessarily require special preprocessing such as stopword removal, punctuation removal, etc. Instead, they use a special unsupervised tokenization methods that optimizes the amount of out-of-vocabulary (OOV) called WordPiece. Thanks to this, and because our data set is not very noisy, we simply use the ktrain preprocessor. Finally, you can get a classifier object, and then a learner object that takes a batch_size hyperparameter. This hyperparameter is logically tunable to your convenience (just like MAXLEN), but watch out for memory issues when increasing it.", "The following code does all of that for you:", "Right before training the model, you can choose to easily optimize the learning rate tuning process by using a learning rate finder (Smith, 2018), which basically trains the model for a short time while exponentially increasing the learning rate:", "A good learning rate value to select is located on the first significant decreasing slope, a bit before the first flat area, where the red arrow points at. In this case, a decent value is 0.00001. Let\u2019s now finally train the model. We use a cycle training policy (Smith, 2017) to successively increase and decrease the learning rate, but other policies are available to you if you want to change! 4 epochs is definitely enough for the model to converge, but this is also tunable to you convenience (training such large models takes a lot of time and resources!).", "Once training is over, you can validate with the learner object\u2019s validate method, but we\u2019ll skip this part to keep it short.", "The predictor object from ktrain allows to make predictions on new data. Running the following code preprocesses and classifies the whole test set. It also prints several usual metrics to help you interpret the results.", "We reach 0.94 weighted F1 and 0.94 accuracy, which is pretty good, great job! Your Distilbert model is now fit to detect constructive news article comments. You can save the model with the following line of code, but beware, it\u2019s rather heavy (~300MB).", "It is now up to you to tune the hyperparameters, use even more advanced machine learning methods or heavier models (BERT, XLNet, etc.) to try and achieve better results!", "Thanks for reading! I hope this was as informative for you as it was fun for me :)", "Devlin, Jacob, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova (2018). \u201cBERT:Pre-training of deep bidirectional transformers for language understanding\u201d. arXiv preprint arXiv:1810.04805.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writing about interesting things you can do with machine learning, NLP and AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F477bf4b4bd8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ugoloobuyck?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ugoloobuyck?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": "Ugo Loobuyck"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6cecb3bf5c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&user=Ugo+Loobuyck&userId=6cecb3bf5c6b&source=post_page-6cecb3bf5c6b----477bf4b4bd8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F477bf4b4bd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F477bf4b4bd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@cadop?utm_source=medium&utm_medium=referral", "anchor_text": "Mathew Schwartz"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://huggingface.co/", "anchor_text": "HuggingFace"}, {"url": "https://towardsdatascience.com/ktrain-a-lightweight-wrapper-for-keras-to-help-train-neural-networks-82851ba889c", "anchor_text": "this tutorial"}, {"url": "https://github.com/amaiya/ktrain", "anchor_text": "official doc"}, {"url": "https://www.kaggle.com/mtaboada/c3-constructive-comments-corpus/kernels?sortBy=hotness&group=everyone&pageSize=20&datasetId=581971", "anchor_text": "Kaggle"}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "arXiv preprint arXiv:1810.04805"}, {"url": "https://doi.org/10.25314/ea49062a-5cf6-4403-9918-539e15fd7b52", "anchor_text": "10.25314/ea49062a-5cf6\u20134403\u20139918\u2013539e15fd7b52"}, {"url": "https://arxiv.org/abs/2004.10703", "anchor_text": "arXiv preprint arXiv:2004.10703"}, {"url": "https://ieeexplore.ieee.org/abstract/document/7926641/", "anchor_text": "IEEE, pp. 464\u2013472"}, {"url": "https://arxiv.org/abs/1803.09820", "anchor_text": "arXiv preprint arXiv:1803.09820"}, {"url": "https://medium.com/tag/classification?source=post_page-----477bf4b4bd8---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/constructive-feedback?source=post_page-----477bf4b4bd8---------------constructive_feedback-----------------", "anchor_text": "Constructive Feedback"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----477bf4b4bd8---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----477bf4b4bd8---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/transformers?source=post_page-----477bf4b4bd8---------------transformers-----------------", "anchor_text": "Transformers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F477bf4b4bd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&user=Ugo+Loobuyck&userId=6cecb3bf5c6b&source=-----477bf4b4bd8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F477bf4b4bd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&user=Ugo+Loobuyck&userId=6cecb3bf5c6b&source=-----477bf4b4bd8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F477bf4b4bd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F477bf4b4bd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----477bf4b4bd8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----477bf4b4bd8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ugoloobuyck?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ugoloobuyck?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ugo Loobuyck"}, {"url": "https://medium.com/@ugoloobuyck/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "98 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6cecb3bf5c6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&user=Ugo+Loobuyck&userId=6cecb3bf5c6b&source=post_page-6cecb3bf5c6b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb4916e78377a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-constructiveness-in-online-article-comments-477bf4b4bd8&newsletterV3=6cecb3bf5c6b&newsletterV3Id=b4916e78377a&user=Ugo+Loobuyck&userId=6cecb3bf5c6b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}