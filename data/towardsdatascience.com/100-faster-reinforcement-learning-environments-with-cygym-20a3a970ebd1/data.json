{"url": "https://towardsdatascience.com/100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1", "time": 1683005556.530018, "path": "towardsdatascience.com/100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1/", "webpage": {"metadata": {"title": "100% Faster Reinforcement Learning Environments with Cygym | by Jacob Gursky | Towards Data Science", "h1": "100% Faster Reinforcement Learning Environments with Cygym", "description": "Anyone who at least dabbles in reinforcement learning will likely tell you they have used OpenAI\u2019s Gym package (linked below), and for good reason! It is an easy-to-use, extensible, and\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Anyone who at least dabbles in reinforcement learning will likely tell you they have used OpenAI\u2019s Gym package (linked below), and for good reason! It is an easy-to-use, extensible, and well-supported package that reduces much of the overhead in setting up a RL project.", "However, when conducting a large-scale project with minimal resources, its essential that every drop of performance be squeezed out of code that is run many times. While working on an RL project, I took a look through the source code of the classic control environments that are often used for benchmarking RL agents to see if we could get some cheap speed gains.", "I noticed that all of the gym code is written in pure Python, so the production-code part of my brain immediately went: \u201cWhat about cythonizing these environments for a speed boost?\u201d", "Cython is a superset of Python that enables compilation of interpreted Python code into extremely fast C extensions. What\u2019s nice about this is that we don\u2019t actually have to write any C code, only some minor modifications to our Python script! Depending on the use-case, sometimes you can see 1000x+ speed increases over Python code. The .step() method of gym environments seemed like a good candidate for this, as it is called once for every frame of a game, which can occur millions of times in training an RL agent.", "I recently released a public repository containing a Python package called cygym, which contains cythonized versions of the classic control environments from the original gym package. All credit for the original environment code goes to the authors of those scripts, but I did introduce some minor optimizations, as well as leveraging some Cython magic to get up to a 100% speed boost over the original implementations. Hopefully, this number will only go up as we expand our code base and get more contributors.", "Installation and setup of cygym are quite easy, simply clone the public package repository and install using pip!", "Pip should handle all of the setup needed for the package, but in the event that you have issues with installation that way, you can manually build the package yourself and install in an alternative way using setuptools:", "If you are still running into issues, please feel free to open an issue or contact me directly!", "Cygym is nearly a complete drop-in for OpenAI gym, all you have to do is import the environment classes and get started!", "Cygym should also be compatible with any and all OpenAI gym wrappers. One feature we are working on right now is getting the cythonized classes compatible with the OpenAI gym registry, but for Cython reasons this is not super straightforward.", "One of the first speed tests we can perform is comparing how long each of the two most common gym methods, .reset() and .step() , take to run in both gym and cygym for our classic control problems.", ".reset() is called when we initialize an environment, while .step() is called to apply an action and get the next frame. Most of the run time in interacting with an environment is spent in .step(), so we will place more weight on that comparison:", "Unfortunately, it seems that cythonizing only brings a moderate speed boost to initializing environments using .reset(), and sometimes even slows it down! But fear not, this method is only called once per episode, so these results are secondary to our next comparison:", "Wow! We can see up to a six times speed boost in iterating our environments using our cythonized variants! Note that most of our environment interaction time is here, meaning our overall model training time should be less dependent on the environment!", "Testing two common methods with random actions is all well and good, but how does cygym do in actually training agents? Let\u2019s take a look\u2026", "Stable baselines is an excellent fork of the original OpenAI baselines package that contains implementations of numerous RL algorithms such as Deep-Q, TRPO, SAC, PPO, and many more. I won\u2019t dive too deep into this package, but we will be utilizing the vectorized environments available in Stable-Baseslines with our gym and cygym environments to train actual RL agents, and see how long it takes to train our models for 100k frames:", "Now we are going to run a similar comparison as the previous sections, looking at all of our classic control environments to see what kind of speed up we can expect using cygym:", "Again, wow! It looks like cygym was always faster than gym, with up to a 50% reduction in train time! This can be a massive difference when trying to prototype new model architectures or doing hyperparameter searches.", "In the future we plan to look at further compatibility with OpenAI gym, such as using gym.make() with our cythonized environments, and possibly fast rendering (which currently isn\u2019t supported).", "We also plan to take a look at cythonizing more complex tasks such as those in the box2d and algorithms modules of the original gym package.", "We have shown that simple cythonization with cygym can lead to huge decreases in RL agent train time, meaning less time waiting and more time analyzing results! We are actively looking for contributors and maintainers for cygym, so if you have experience in Cython package development and optimization, please get in touch!", "Cygym: Fast gym-compatible classic control RL environments", "OpenAI Gym: A versatile package for reinforcement learning environments", "Cython: A compiled superset of the Python language", "Stable-Baselines: A fork of OpenAI baselines", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist/ML Engineer working at Seagate Technology. My interests include Natural Language Generation and Changepoint Detection."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F20a3a970ebd1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gurskyjacob?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gurskyjacob?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": "Jacob Gursky"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F13efc0f9bee7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&user=Jacob+Gursky&userId=13efc0f9bee7&source=post_page-13efc0f9bee7----20a3a970ebd1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F20a3a970ebd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F20a3a970ebd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/dDp-6pXrYik", "anchor_text": "Image Source"}, {"url": "https://github.com/gursky1/cygym", "anchor_text": "gursky1/cygymThis repository contains cythonized versions of the OpenAI Gym classic control environments. Note that is this package\u2026github.com"}, {"url": "https://github.com/openai/gym", "anchor_text": "openai/gymStatus: Maintenance (expect bug fixes and minor updates) OpenAI Gym is a toolkit for developing and comparing\u2026github.com"}, {"url": "https://cython.org/", "anchor_text": "Cython: C-Extensions for PythonCython is an optimising static compiler for both the programming language and the extended Cython programming language\u2026cython.org"}, {"url": "https://github.com/hill-a/stable-baselines", "anchor_text": "hill-a/stable-baselinesStable Baselines is a set of improved implementations of reinforcement learning algorithms based on OpenAI Baselines\u2026github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----20a3a970ebd1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----20a3a970ebd1---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----20a3a970ebd1---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/openai-gym?source=post_page-----20a3a970ebd1---------------openai_gym-----------------", "anchor_text": "Openai Gym"}, {"url": "https://medium.com/tag/data-science?source=post_page-----20a3a970ebd1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F20a3a970ebd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&user=Jacob+Gursky&userId=13efc0f9bee7&source=-----20a3a970ebd1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F20a3a970ebd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&user=Jacob+Gursky&userId=13efc0f9bee7&source=-----20a3a970ebd1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F20a3a970ebd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F20a3a970ebd1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----20a3a970ebd1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----20a3a970ebd1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gurskyjacob?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gurskyjacob?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jacob Gursky"}, {"url": "https://medium.com/@gurskyjacob/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "95 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F13efc0f9bee7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&user=Jacob+Gursky&userId=13efc0f9bee7&source=post_page-13efc0f9bee7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb84943f5e164&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F100-faster-reinforcement-learning-environments-with-cygym-20a3a970ebd1&newsletterV3=13efc0f9bee7&newsletterV3Id=b84943f5e164&user=Jacob+Gursky&userId=13efc0f9bee7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}