{"url": "https://towardsdatascience.com/lets-make-a-knn-classifier-from-scratch-e73c43da346d", "time": 1683002621.951091, "path": "towardsdatascience.com/lets-make-a-knn-classifier-from-scratch-e73c43da346d/", "webpage": {"metadata": {"title": "Let\u2019s Make a KNN Classifier from Scratch | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Let\u2019s Make a KNN Classifier from Scratch", "description": "Coding out the entire machine algorithms from scratch can be a tedious process. That\u2019s why we have libraries. The other reason is, our own implementation most likely cannot compete with out of the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/daradecic/K-Nearest_Neighbors/blob/master/K-Nearest_Neighbors.ipynb", "anchor_text": "GitHub repo", "paragraph_index": 3}, {"url": "https://github.com/daradecic/K-Nearest_Neighbors/blob/master/K-Nearest_Neighbors.ipynb", "anchor_text": "GitHub repo", "paragraph_index": 32}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 33}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 35}], "all_paragraphs": ["Coding out the entire machine algorithms from scratch can be a tedious process. That\u2019s why we have libraries. The other reason is, our own implementation most likely cannot compete with out of the box solutions like the one from Scikit-Learn, that is if we don\u2019t put enough time and effort into it.", "That, however, doesn\u2019t mean that you shouldn\u2019t code out the algorithms from scratch. Here are some benefits of doing so:", "Today I want to show you how easy it is to code a simple K Nearest Neighbors algorithm just with the NumPy library. Sure, it won\u2019t be state of the art and there will be a lot of things to optimize, but it\u2019s a good start. By the end of this article, I want you to feel like you could have invented it.", "In a case you\u2019re not eager to write the code yourself, here\u2019s the GitHub repo.", "Without further ado, let\u2019s get started. The only library you\u2019ll need is Numpy (for now) so make sure to import it.", "KNN stands for K-Nearest Neighbors. It\u2019s basically a classification algorithm that will make a prediction of a class of a target variable based on a defined number of nearest neighbors. It will calculate distance from the instance you want to classify to every instance of the training dataset, and then classify your instance based on the majority classes of k nearest instances.", "If you\u2019re reading this for the first time it might sound confusing, but it\u2019s actually a very simple algorithm.", "As there are tons of theoretical explanations out there, I decided not to dive any deeper into it, and instead focus my time on the implementation side. If you, however, lack the theoretical background, feel free to refer to this article (or any others you find online):", "You can think of the rows, the Xs in your dataset as vectors. With having this idea in mind, you probably know that there are ways of measuring distances between vectors. Some of the ideas that pop into my head are:", "In this article, I\u2019ll focus my attention on the first one, and we\u2019ll code it out from scratch. In a nutshell, Euclidean distance is just a straight-line distance between two data points in Euclidean space[1]. It can be calculated as follows:", "It really is a simple formula and you don\u2019t have to know the number of dimensions beforehand. Let\u2019s code it out in Python:", "And that\u2019s all there is to it!", "Let\u2019s now make two quick checks:", "Okay, the previous part is clearly working and it\u2019s now time to code out the heart of the algorithm. I\u2019ll declare a function predict() which will take in 3 parameters:", "As I\u2019ve said, the algorithm is very simple and shouldn\u2019t be a problem to code out. Just for the sake of it, I\u2019ve commented every line of the code so there\u2019s no way for you to get lost:", "That was quite a bit of code to write, I know, but it will be worth it.", "Now, there\u2019s no point in implementing the algorithm if we can\u2019t evaluate it somehow. That\u2019s why I\u2019ve decided to implement a basic accuracy reporting function, which will report back how well the algorithm performed on a test set:", "If you ask me, I think that everything looks way messier than it should be. That\u2019s mainly because we have functions all over the place. So let\u2019s fix that by throwing all of those functions inside a class called, you\u2019ve guessed it, KNearestNeighbors. There are some slight modifications you\u2019ll need to make, but as those are trivial I decided not to comment on them.", "The time has come to evaluate our algorithm. For simplicity, I\u2019ve decided to use the famous Iris dataset which can be loaded from Scikit-Learn.", "Here\u2019s the code to get you going:", "And here\u2019s how everything should look like:", "If you\u2019re wondering what Bamboolib is, check out this article:", "Now, we\u2019ll need to split the dataset into training and testing part somehow. That\u2019s easy to do, here\u2019s the code:", "Let\u2019s now make an instance of theKNearestNeighborsclass and set kto 3. Then we can train the model and evaluate it\u2019s performance easily:", "K = 3 seems to be a reasonable choice. Just like that, we\u2019ve got an accuracy of 94.6%, which is amazing.", "But how do we know if that\u2019s the optimal value for K?", "Well, we don\u2019t, we\u2019ll need to verify it manually. All it boils down to is surrounding the code from above in a loop:", "If you\u2019re wondering why I\u2019ve decided to use only odd numbers, that\u2019s because this way it\u2019s impossible to get ties when the algorithm is making a classification.", "The values 3 and 5 for K seem to yield the same accuracy, and we can set K = 13 to get an even better model. The accuracy scores might be different for you, that\u2019s because the train and test sets are sampled randomly \u2014 but there shouldn\u2019t be any drastic differences.", "This was a rather simple implementation of the K-Nearest Neighbors algorithm. It works well, but there are still some things you could do, like:", "The latter is actually pretty much essential for KNN to work properly because your inputs might not be in the same unit. Think about it like this \u2014 2.5 meters and 250 centimeters is the same to you, but the algorithm would think that the latter is more important due to the larger scale.", "Iris dataset doesn\u2019t suffer from that problem, so I decided to skip that part. On a real-world dataset, you probably shouldn\u2019t.", "Thanks for reading, I hope everything is working on your machine. If not, just download the code from my GitHub repo.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe73c43da346d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e73c43da346d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e73c43da346d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----e73c43da346d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----e73c43da346d--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----e73c43da346d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe73c43da346d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe73c43da346d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@englr?utm_source=medium&utm_medium=referral", "anchor_text": "Alvin Engler"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/daradecic/K-Nearest_Neighbors/blob/master/K-Nearest_Neighbors.ipynb", "anchor_text": "GitHub repo"}, {"url": "https://blog.usejournal.com/a-quick-introduction-to-k-nearest-neighbors-algorithm-62214cea29c7", "anchor_text": "A Quick Introduction to K-Nearest Neighbors AlgorithmHi everyone! Today I would like to talk about the K-Nearest Neighbors algorithm (or KNN). KNN algorithm is one of the\u2026blog.usejournal.com"}, {"url": "https://towardsdatascience.com/introducing-bamboolib-a-gui-for-pandas-4f6c091089e3", "anchor_text": "Introducing Bamboolib \u2014 a GUI for PandasLearning Pandas and Data Analysis was never so easytowardsdatascience.com"}, {"url": "https://github.com/daradecic/K-Nearest_Neighbors/blob/master/K-Nearest_Neighbors.ipynb", "anchor_text": "GitHub repo"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "https://en.wikipedia.org/wiki/Euclidean_distance"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e73c43da346d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e73c43da346d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e73c43da346d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----e73c43da346d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----e73c43da346d---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe73c43da346d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----e73c43da346d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe73c43da346d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----e73c43da346d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe73c43da346d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e73c43da346d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe73c43da346d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e73c43da346d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e73c43da346d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e73c43da346d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e73c43da346d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e73c43da346d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e73c43da346d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e73c43da346d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e73c43da346d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e73c43da346d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-a-knn-classifier-from-scratch-e73c43da346d&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}