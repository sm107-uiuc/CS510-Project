{"url": "https://towardsdatascience.com/k-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738", "time": 1683014808.953707, "path": "towardsdatascience.com/k-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738/", "webpage": {"metadata": {"title": "K-Nearest Neighbours (kNN) Algorithm: Common Questions and Python Implementation | by Ching (Chingis) | Towards Data Science", "h1": "K-Nearest Neighbours (kNN) Algorithm: Common Questions and Python Implementation", "description": "K-Nearest Neighbours is considered to be one of the most intuitive machine learning algorithms since it is simple to understand and explain. Additionally, it is quite convenient to demonstrate how\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/analytics-vidhya/why-is-scaling-required-in-knn-and-k-means-8129e4d88ed7", "anchor_text": "Why is scaling required in KNN and K-Means?", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/3-text-distances-that-every-data-scientist-should-know-7fcdf850e510", "anchor_text": "3 text distances that every data scientist should know", "paragraph_index": 12}, {"url": "https://github.com/chingisooinar/KNN-python-implementation/blob/main/k_nearest_neighbors_from_scratch.ipynb", "anchor_text": "Github", "paragraph_index": 25}, {"url": "https://github.com/chingisooinar/KNN-python-implementation", "anchor_text": "Github", "paragraph_index": 29}], "all_paragraphs": ["K-Nearest Neighbours is considered to be one of the most intuitive machine learning algorithms since it is simple to understand and explain. Additionally, it is quite convenient to demonstrate how everything goes visually. However, the kNN algorithm is still a common and very useful algorithm to use for a large variety of classification problems. If you are new to machine learning, make sure you test yourself on an understanding of this simple yet wonderful algorithm. There are a lot of useful sources on what it is and how it works, hence I want to go through 5 common or interesting questions you should know in my personal opinion.", "The k-NN algorithm does more computation on test time rather than train time.", "That is absolutely true. The idea of the kNN algorithm is to find a k-long list of samples that are close to a sample we want to classify. Therefore, the training phase is basically storing a training set, whereas while the prediction stage the algorithm looks for k-neighbours using that stored data.", "Why do you need to scale your data for the k-NN algorithm?", "Imagine a dataset having m number of \u201cexamples\u201d and n number of \u201cfeatures\u201d. There is one feature dimension having values exactly between 0 and 1. Meanwhile, there is also a feature dimension that varies from -99999 to 99999. Considering the formula of Euclidean Distance, this will affect the performance by giving higher weightage to variables having a higher magnitude.", "Read more: Why is scaling required in KNN and K-Means?", "The k-NN algorithm can be used for imputing the missing value of both categorical and continuous variables.", "That is true. k-NN can be used as one of many techniques when it comes to handling missing values. A new sample is imputed by determining the samples in the training set \u201cnearest\u201d to it and averages these nearby points to impute. A scikit learn library provides a quick and convenient way to use this technique.", "Note: NaNs are omitted while distances are calculated.", "Thus, missing values will be replaced by the mean value of its \u201cneighbours\u201d.", "Is Euclidean Distance always the case?", "Although Euclidean Distance is the most common method used and taught, it is not always the optimal decision. In fact, it is hard to come up with the right metric just by looking at data, so I would suggest trying a set of them. However, there are some special cases. For instance, hamming distance is used in case of a categorical variable.", "Read more: 3 text distances that every data scientist should know", "Why should we not use the KNN algorithm for large datasets?", "Here is an overview of the data flow that occurs in the KNN algorithm:", "Imagine you have a very large dataset. Therefore, it is not only a bad decision to store a large amount of data but it is also computationally costly to keep calculating and sorting all the values.", "I will break down the implementation into the following stages:", "Calculate the distances to all vectors in a training set and store them", "It is important to note that there is a large variety of options to choose as a metric; however, I want to use Euclidean Distance as an example. It is the most common metric used to calculate distances among vectors since it is straightforward and easy to explain. The general formula is as follows:", "Thus, let\u2019s summarize it with the following Python code. Note: Don\u2019t forget to import sqrt() from \u201cmath\u201d module.", "Firstly, we need to calculate all the distances between a single test sample and all the samples in our training set. As distances are obtained, we should sort the list of distances and pick the \u201cnearest\u201d k vectors from our training set by looking at how far they are from a test sample.", "Calculate the most frequent class displayed by K nearest vectors and make a prediction", "Finally, in order to make a prediction, we should get our k \u201cnearest\u201d neighbours by calling our function I attached above. Thus, the only thing that is left is to count the number of occurrences of each label and pick the most frequent one.", "Let\u2019s summarize everything by combining all the function into a separate class object. Here is a more generalized version of the code, please take time to look through it.", "Let\u2019s compare our implementation with the one provided by scikit learn. I am going to use a simple toy dataset that contains two predictors, which are age and salary. Thus, we want to predict if a customer is willing to purchase our product.", "I am going to skip preprocessing since it is not what I want to focus on; however, I used a train-test split technique and applied a StandardScaler afterwards. Anyways, if you are interested, I will provide the source code on Github.", "Finally, I will define both models and fit our data. Please refer to the KNN implementation provided above. I am selecting 5 as our default k value. Note that for the latter model the default metric is minkowski, and with p=2 is equivalent to the standard Euclidean metric.", "The figure attached above shows that both models demonstrated identical performance. The accuracy turned out to be 0.93, which is a pretty good result. The figure attached below is a visualization of our test set results. I am providing a single figure since both models are identical. However, I personally suggest using implementations that are provided already since our implementation is simple and inefficient. Moreover, it is just more convenient not to keep writing the exact same code every time.", "To sum up, K-Nearest Neighbours is considered to be one of the most intuitive machine learning algorithms since it is simple to understand and explain. Additionally, it is quite convenient to demonstrate how everything goes visually. In this article we answered the following questions:", "Moreover, I provided a python implementation of the KNN algorithm in order to strengthen your understanding of what happens inside. The full implementation can be found on my Github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a passionate student. I enjoy studying and sharing my knowledge. Follow me/Connect with me and join my journey."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F14377e45b738&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@chingisoinar", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----14377e45b738--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----14377e45b738--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://chingisoinar.medium.com/?source=post_page-----14377e45b738--------------------------------", "anchor_text": ""}, {"url": "https://chingisoinar.medium.com/?source=post_page-----14377e45b738--------------------------------", "anchor_text": "Ching (Chingis)"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fda1c4d3b154f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&user=Ching+%28Chingis%29&userId=da1c4d3b154f&source=post_page-da1c4d3b154f----14377e45b738---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F14377e45b738&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F14377e45b738&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ninastrehl", "anchor_text": "Nina Strehl"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/analytics-vidhya/why-is-scaling-required-in-knn-and-k-means-8129e4d88ed7", "anchor_text": "Why is scaling required in KNN and K-Means?"}, {"url": "https://towardsdatascience.com/3-text-distances-that-every-data-scientist-should-know-7fcdf850e510", "anchor_text": "3 text distances that every data scientist should know"}, {"url": "https://github.com/chingisooinar/KNN-python-implementation/blob/main/k_nearest_neighbors_from_scratch.ipynb", "anchor_text": "Github"}, {"url": "https://github.com/chingisooinar/KNN-python-implementation", "anchor_text": "Github"}, {"url": "https://medium.com/analytics-vidhya/why-is-scaling-required-in-knn-and-k-means-8129e4d88ed7", "anchor_text": "Why is scaling required in KNN and K-Means?KNN and K-Means are one of the most commonly and widely used machine learning algorithms. KNN is a supervised learning\u2026medium.com"}, {"url": "https://towardsdatascience.com/3-text-distances-that-every-data-scientist-should-know-7fcdf850e510", "anchor_text": "3 text distances that every data scientist should knowWhether you\u2019re just starting with data science or you\u2019ve been in the field for ages, you need to know these 3 text\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/machine-learning-basics-with-the-k-nearest-neighbors-algorithm-6a6e71d01761", "anchor_text": "Machine Learning Basics with the K-Nearest Neighbors AlgorithmThe k-nearest neighbors (KNN) algorithm is a simple, easy-to-implement supervised machine learning algorithm that can\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----14377e45b738---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----14377e45b738---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/k-nearest-neighbours?source=post_page-----14377e45b738---------------k_nearest_neighbours-----------------", "anchor_text": "K Nearest Neighbours"}, {"url": "https://medium.com/tag/ai?source=post_page-----14377e45b738---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F14377e45b738&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&user=Ching+%28Chingis%29&userId=da1c4d3b154f&source=-----14377e45b738---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F14377e45b738&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&user=Ching+%28Chingis%29&userId=da1c4d3b154f&source=-----14377e45b738---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F14377e45b738&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----14377e45b738--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F14377e45b738&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----14377e45b738---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----14377e45b738--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----14377e45b738--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----14377e45b738--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----14377e45b738--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----14377e45b738--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----14377e45b738--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----14377e45b738--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----14377e45b738--------------------------------", "anchor_text": ""}, {"url": "https://chingisoinar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://chingisoinar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ching (Chingis)"}, {"url": "https://chingisoinar.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "999 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fda1c4d3b154f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&user=Ching+%28Chingis%29&userId=da1c4d3b154f&source=post_page-da1c4d3b154f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbd1fec39b699&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fk-nearest-neighbours-knn-algorithm-common-questions-and-python-implementation-14377e45b738&newsletterV3=da1c4d3b154f&newsletterV3Id=bd1fec39b699&user=Ching+%28Chingis%29&userId=da1c4d3b154f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}