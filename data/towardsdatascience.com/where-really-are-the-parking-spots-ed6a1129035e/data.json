{"url": "https://towardsdatascience.com/where-really-are-the-parking-spots-ed6a1129035e", "time": 1683006543.070822, "path": "towardsdatascience.com/where-really-are-the-parking-spots-ed6a1129035e/", "webpage": {"metadata": {"title": "Where really are the parking spots? | by Tom Drabas | Towards Data Science", "h1": "Where really are the parking spots?", "description": "In the previous story, we explored the cuSpatial and cuGraph libraries from NVIDIA RAPIDS package and used them to find the walking distance to nearest parking points near Seattle\u2019s Space Needle\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/where-should-i-walk-e66b26735de5", "anchor_text": "previous story", "paragraph_index": 0}, {"url": "https://medium.com/rapids-ai/releasing-cuspatial-to-accelerate-geospatial-and-spatiotemporal-processing-b686d8b32a9", "anchor_text": "cuSpatial", "paragraph_index": 0}, {"url": "https://medium.com/rapids-ai/status-of-rapids-cugraph-refactoring-code-and-rethinking-graphs-efe9956d5528", "anchor_text": "cuGraph", "paragraph_index": 0}, {"url": "https://fusiondatascience.com/", "anchor_text": "Fusion Data Science", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/where-should-i-park-29e8da95265a", "anchor_text": "Where should I park?", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/where-should-i-walk-e66b26735de5", "anchor_text": "Where should I walk?", "paragraph_index": 14}, {"url": "https://www.nvidia.com/en-us/titan/titan-rtx/", "anchor_text": "NVIDIA Titan RTX", "paragraph_index": 22}, {"url": "https://towardsdatascience.com/where-should-i-walk-e66b26735de5", "anchor_text": "previous story", "paragraph_index": 23}], "all_paragraphs": ["In the previous story, we explored the cuSpatial and cuGraph libraries from NVIDIA RAPIDS package and used them to find the walking distance to nearest parking points near Seattle\u2019s Space Needle. This was only possible with great help from John Murray of Fusion Data Science who kindly provided a graph of King County roads in a form of a list of intersections (with geo coordinates) and list of edges linking the intersections with calculated length (in yards).", "However, a quick look at the map above quickly reveals a problem with our relatively simple approach presented before: the distance from the nearest road intersection to the parking spot is a straight line (as-crow-flies yet again). In this story, we\u2019ll look at how we can fix this.", "How can we fix the above debacle? Well, an approach that would get us closer to the true walking distance would be to find a spot on a map (for each parking spot) where the location of the parking spot is perpendicular to the road itself as presented in the below graphic.", "The blue lines show the current solution. As you can see, we are flying over (or thru) the buildings and intersections and that is something that normal people usually cannot do. The orange lines, however, show a more realistic approach where a person would walk along the roads to reach the chosen parking location.", "Thus, we need to add more nodes and edges to our graph: one for each parking location such that the distance to the nearest road is minimized i.e. the node that lays on the line connecting two nodes and, when connected to the location of the parking meter, such line is perpendicular.", "Finding an intersection point of two lines given 3 points is a simple problem from elementary school so the below is just a quick refresher.", "Given two points on a plane we can quickly find the slope a of the black line connecting the two nodes (road intersections) by taking the difference in latitudes between these two points and dividing it by their difference in longitudes:", "The slope of the perpendicular line is simply the negative inverse of a:", "Equally simple is finding the constant b of the black line now that we know the slope:", "We could, of course, use the other point with the same result. Given the slope of the perpendicular line and the location of the parking spot \u2014 we can now quickly do the same to find b_perpendicular.", "Since the point at the intersection will have the same latitude no matter what equation we use (it is an intersection after all) we can set these equations equal to each other to find the longitude of the intersection point:", "Quick algebraic transformations and we can clearly see the lon_intersection point:", "Finding the latitude is now trivial since we can use either of the equations to get it.", "Now that we have the method, let\u2019s transform it into a RAPIDS kernel.", "The points x and y in the above kernel are the two points depicting road, the _REF point is the parking spot. Note: if you are not familiar with defining RAPIDS kernels I covered that in my two previous stories: Where should I park? and Where should I walk? so I won\u2019t be discussing it here.", "In our calculations above we did not solve for two special cases: when the road is either perfectly aligned along the north-south or east-west lines. In the former situation (north-south aligned) the longitude of the projected point is the longitude of either of the points and the latitude will be the latitude of the parking location. In the latter situation (east-west alignment) the solution will be the inverse: we take the latitude of either of the points and the longitude will be that of the parking spot.", "We can now iterate over all the parking locations. First, we need to append the longitudes and latitudes to the road_graph_data DataFrame; as a refresher, this DataFrame contains only pair of nodes and the distance between them. We will get these from the road_nodes DataFrame.", "There\u2019s no point in calculating the distances between a parking location and all the points in the road_graph_data so we subset the list of nodes to those that are within ~2000 ft from the parking node being processed.", "Now we can find the intersection point.", "Since we are processing nodes that are within 2000 ft we need to check if the point lays between the two nodes. We do this by checking the sum of the haversine distance to each point from the intersection is less than or equal to the actual length between these two nodes.", "To find the best fit we select the point with the smallest distance from the parking spot and add the node to the list of nodes.", "Finally, we also add the edge that links the parking location and the found intersection point.", "Processing ~1500 parking meter locations took only 3 minutes and 20 seconds (there are more than 127,000 road nodes in King County!) on the NVIDIA Titan RTX.", "Using the same cuGraph approach as we presented in the previous story, we can now find much more reliable way of traversing our graph and finding the nearest parking locations near Space Needle!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist, math lover, computer geek, tube-amps designer and builder, die-hard TOOL fan. Working for Blazing SQL. Ex Microsoft."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fed6a1129035e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tomekdrabas.medium.com/?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": ""}, {"url": "https://tomekdrabas.medium.com/?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": "Tom Drabas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44003e7498c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&user=Tom+Drabas&userId=44003e7498c6&source=post_page-44003e7498c6----ed6a1129035e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed6a1129035e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed6a1129035e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/where-should-i-walk-e66b26735de5", "anchor_text": "previous story"}, {"url": "https://medium.com/rapids-ai/releasing-cuspatial-to-accelerate-geospatial-and-spatiotemporal-processing-b686d8b32a9", "anchor_text": "cuSpatial"}, {"url": "https://medium.com/rapids-ai/status-of-rapids-cugraph-refactoring-code-and-rethinking-graphs-efe9956d5528", "anchor_text": "cuGraph"}, {"url": "https://fusiondatascience.com/", "anchor_text": "Fusion Data Science"}, {"url": "https://towardsdatascience.com/where-should-i-park-29e8da95265a", "anchor_text": "Where should I park?"}, {"url": "https://towardsdatascience.com/where-should-i-walk-e66b26735de5", "anchor_text": "Where should I walk?"}, {"url": "https://www.nvidia.com/en-us/titan/titan-rtx/", "anchor_text": "NVIDIA Titan RTX"}, {"url": "https://towardsdatascience.com/where-should-i-walk-e66b26735de5", "anchor_text": "previous story"}, {"url": "https://medium.com/tag/rapids-ai?source=post_page-----ed6a1129035e---------------rapids_ai-----------------", "anchor_text": "Rapids Ai"}, {"url": "https://medium.com/tag/graph?source=post_page-----ed6a1129035e---------------graph-----------------", "anchor_text": "Graph"}, {"url": "https://medium.com/tag/spatial-analysis?source=post_page-----ed6a1129035e---------------spatial_analysis-----------------", "anchor_text": "Spatial Analysis"}, {"url": "https://medium.com/tag/python?source=post_page-----ed6a1129035e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ed6a1129035e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed6a1129035e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&user=Tom+Drabas&userId=44003e7498c6&source=-----ed6a1129035e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fed6a1129035e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&user=Tom+Drabas&userId=44003e7498c6&source=-----ed6a1129035e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fed6a1129035e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fed6a1129035e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ed6a1129035e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ed6a1129035e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ed6a1129035e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ed6a1129035e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ed6a1129035e--------------------------------", "anchor_text": ""}, {"url": "https://tomekdrabas.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tomekdrabas.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tom Drabas"}, {"url": "https://tomekdrabas.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "84 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44003e7498c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&user=Tom+Drabas&userId=44003e7498c6&source=post_page-44003e7498c6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F44003e7498c6%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhere-really-are-the-parking-spots-ed6a1129035e&user=Tom+Drabas&userId=44003e7498c6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}