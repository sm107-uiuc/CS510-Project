{"url": "https://towardsdatascience.com/transfer-learning-with-pytorch-95dd5dca82a", "time": 1683009048.946723, "path": "towardsdatascience.com/transfer-learning-with-pytorch-95dd5dca82a/", "webpage": {"metadata": {"title": "Transfer Learning with PyTorch. And why you shouldn't write CNN\u2026 | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Transfer Learning with PyTorch", "description": "Training deep learning models, especially image-recognition-related ones, is a pretty straightforward task nowadays. There are many reasons why you shouldn\u2019t stress too much about the architecture\u2026"}, "outgoing_paragraph_urls": [{"url": "http://files.fast.ai/data/dogscats.zip", "anchor_text": "Dog or Cat", "paragraph_index": 8}, {"url": "https://colab.research.google.com/drive/1ItUWnucWWg4Enxz6Xjz4Eb52Kpj1f3HA?usp=sharing", "anchor_text": "source code,", "paragraph_index": 18}, {"url": "https://en.wikipedia.org/wiki/Residual_neural_network", "anchor_text": "ResNet101", "paragraph_index": 23}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 34}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 36}], "all_paragraphs": ["Training deep learning models, especially image-recognition-related ones, is a pretty straightforward task nowadays. There are many reasons why you shouldn\u2019t stress too much about the architecture, the main being that someone already did that step for you. For the rest, you\u2019ll have to read further.", "Nowadays, the only thing on which you as an engineer should focus is data preparation \u2014 and in the world of deep learning that term summarizes the process of data gathering, loading, normalization, and augmentation.", "Today\u2019s agenda is simple \u2014 explain what transfer learning is and how it can be used, followed by practical examples of model training with and without pre-trained architectures.", "Sounds simple, so let\u2019s dive straight in!", "Let\u2019s start with imports. Here we have the usual suspects like Numpy, Pandas, and Matplotlib, but also our favorite deep learning library \u2014 Pytorch \u2014 followed by everything it has to offer.", "We\u2019re writing this code in Colab, or Colab Pro to be more precise, so we\u2019ll utilize the power of GPUs for training. If you don\u2019t know what Colab is, or wondering is it worth it to upgrade to the Pro version, feel free to check these articles:", "Because we\u2019re training on the GPU and that might not be the case for you, we need a robust way for handling this. Here\u2019s a standard approach:", "It should say something like type=\u2019cpu\u2019 if you are training on the CPU, but as Colab is free there's no need to ever do so.", "Now onto the dataset. We\u2019ll be using Dog or Cat dataset for this purpose. It has a plethora of images of various sizes, something which we'll handle down the road. Right now we need to download and unzip it. Here\u2019s how:", "After a minute or so, depending on your internet speed, the dataset is ready to use. Now we can declare it as a data directory \u2014 not required but will save us a bit time down the road.", "The first part of the first part is now done. Next, we have to apply some transformations to training and validation subsets, and then load the transformed data with DataLoaders. Here are the transformations we applied:", "Now we load the data with DataLoaders. This step is also straightforward and something you are probably familiar with:", "If we were now to inverse-normalize a single batch and visualize it, we\u2019d get this:", "A quick look at the image above indicates our transformation work as expected.", "The data preparation part is now done and in the next section, we\u2019ll declare a custom CNN architecture, train it, and evaluate the performance.", "For this part, we want to do something utterly simple \u2014 3 convolution layers, each followed by max-pooling and ReLU, and then a single fully connected layer and an output layer.", "Here\u2019s the code for this architecture:", "From here we can define an optimizer and criterion and we\u2019re ready to train:", "Since you have access to the source code, and the train_model function is stupidly long, we\u2019ve decided not to put it here. So please refer back to the source code if you are following along. We\u2019ll train the model for 10 epochs:", "After some time here are the obtained results:", "Not terrible results by any means, but how can we do better? Transfer learning to the rescue.", "You can easily look for formal definitions online. For us, transfer learning means downloading a pre-made architecture, which was trained on 1M+ images, and tweaking the output layers so it classifies as many classes as you need.", "As we only have cats and dogs here, we\u2019ll need to modify this number to two.", "For now, we\u2019ll download the pre-trained version of the ResNet101 architecture and make it\u2019s params not trainable \u2014 because the network is trained already:", "Great! Let\u2019s check how does the output layer look like:", "So the architecture by default has 1000 possible classes, but we need only two \u2014 one for cats and one for dogs. Here\u2019s how to tweak it:", "And that\u2019s all we have to do.", "Well, we still have to define and optimizer and a criterion, but you know how to do that:", "The training process is the same as with the custom architecture, but we won't need so many epochs, because, well, we already know the correct values for weights and biases.", "After some time here are the results obtained:", "How amazing is that? Not only did the accuracy improve, but we\u2019ve also saved a lot of time by not training for too many epochs.", "Now you know what transfer learning can do, and also how and why to use it. Let\u2019s wrap things up in the next section.", "And there you have it \u2014 the most simple transfer learning guide for PyTorch. Sure, the results of a custom model could be better if the network was deeper, but that\u2019s not the point. The point is, there\u2019s no need to stress about how many layers are enough, and what the optimal hyperparameter values are. At least for most cases.", "Make sure to try out different architectures and feel free to inform us about the results down below in the comment section.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F95dd5dca82a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----95dd5dca82a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95dd5dca82a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95dd5dca82a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@drmakete?utm_source=medium&utm_medium=referral", "anchor_text": "drmakete lab"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://colab.research.google.com/drive/1ItUWnucWWg4Enxz6Xjz4Eb52Kpj1f3HA?usp=sharing", "anchor_text": "Colab Notebook"}, {"url": "https://towardsdatascience.com/google-colab-how-does-it-compare-to-a-gpu-enabled-laptop-851c1e0a2ca9", "anchor_text": "Google Colab: How does it compare to a GPU-enabled laptop?Introduction to Colab, Runtimes, Performance Comparisons\u2026 and Gotchastowardsdatascience.com"}, {"url": "https://towardsdatascience.com/colab-pro-is-it-worth-the-money-32a1744f42a8", "anchor_text": "Colab Pro: Is it Worth the Money?How much difference does $10 make? We did the tests. You do the reading.towardsdatascience.com"}, {"url": "http://files.fast.ai/data/dogscats.zip", "anchor_text": "Dog or Cat"}, {"url": "http://files.fast.ai/data/dogscats.zip", "anchor_text": "http://files.fast.ai/data/dogscats.zip"}, {"url": "https://colab.research.google.com/drive/1ItUWnucWWg4Enxz6Xjz4Eb52Kpj1f3HA?usp=sharing", "anchor_text": "source code,"}, {"url": "https://en.wikipedia.org/wiki/Residual_neural_network", "anchor_text": "ResNet101"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----95dd5dca82a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----95dd5dca82a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----95dd5dca82a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----95dd5dca82a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----95dd5dca82a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95dd5dca82a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----95dd5dca82a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95dd5dca82a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----95dd5dca82a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95dd5dca82a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F95dd5dca82a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----95dd5dca82a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----95dd5dca82a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----95dd5dca82a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----95dd5dca82a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----95dd5dca82a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-with-pytorch-95dd5dca82a&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}