{"url": "https://towardsdatascience.com/transfer-learning-for-time-series-forecasting-51f023bc159c", "time": 1683017638.838942, "path": "towardsdatascience.com/transfer-learning-for-time-series-forecasting-51f023bc159c/", "webpage": {"metadata": {"title": "Transfer learning for time series forecasting and classification | by Isaac Godfried | Towards Data Science", "h1": "Transfer learning for time series forecasting and classification", "description": "A brief history: ImageNet was first published in 2009 and over the next four years would go on to form the bedrock of most computer vision models. To this day whether you are training a model to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1811.01533.pdf", "anchor_text": "Fawaz el. al.", "paragraph_index": 3}, {"url": "https://papers.nips.cc/paper/2019/file/eb1e78328c46506b46a4ac4a1e378b91-Paper.pdf", "anchor_text": "diagnosis", "paragraph_index": 7}, {"url": "https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0236621", "anchor_text": "staging", "paragraph_index": 7}, {"url": "https://milets18.github.io/papers/milets18_paper_2.pdf", "anchor_text": "\u201cReconstruction and Regression Loss for Time-Series Transfer Learning\u201d", "paragraph_index": 9}, {"url": "https://github.com/AIStream-Peelout/flow-forecast", "anchor_text": "flow forecast", "paragraph_index": 11}, {"url": "https://colab.research.google.com/drive/169NO9B_il-E34Kdos1hxunuDFuD6rjuW#scrollTo=dx-tmLRain2Z", "anchor_text": "See this notebook for a real world example.", "paragraph_index": 13}, {"url": "https://colab.research.google.com/drive/1PIo4u9VBE8V1_-HMifdqOYP-q7pW_UBJ", "anchor_text": "(see full example here)", "paragraph_index": 14}], "all_paragraphs": ["A brief history: ImageNet was first published in 2009 and over the next four years would go on to form the bedrock of most computer vision models. To this day whether you are training a model to detect pneumonia or classify models of cars you will probably start with a model pre-trained on ImageNet or some other large (and general image) dataset.", "More recently papers like ELMO and BERT (2018) leveraged transfer learning to effectively improve performance on several NLP tasks. These models create effective context dependent representations of words. These representations can then be leveraged for a variety of tasks such as question answering, named entity recognition, and much more.", "Moreover, at a macro level transfer learning has paved the way for progress in areas with limited data across the board. It has helped to democratize deep learning by helping research groups and companies with limited data leverage it effectively. Therefore being able to leverage transfer learning in the time series domain (where there are many events with a limited temporal history) is crucial.", "Currently, there is no model nor place to go for transfer learning for time series. Moreover, research on the topic is relatively sparse. A paper by Fawaz el. al. discussed transfer learning for time series classification. They concluded:", "These experiments revealed that transfer learning can improve or degrade the models predictions depending on the dataset used for transfer.", "From this, we learn the for time series that the similarity between the source and target dataset is in many ways more important than in CV or NLP. The authors then choose to develop a technique, which forms time series representations to find the most similar time series to use for transfer. Although this paper is an interesting initial exploration it still leaves many unanswered questions. What about the multivariate time series case (authors only look at the single variate)? Would a different architecture help facilitate transfer even among dissimilar time series? Likewise, a few other articles explore limited cases where transfer can be effective in the time series area, however none purpose a general framework for transfer learning particularly in the multivariate case.", "How transfer learning works in other domains", "Before diving into the challenges of transfer learning with respect to time series forecasting lets look into how it works in other domains. In computer vision transfer learning generally works as the model learns in a hierarchical fashion; specifically the \u201cearlier\u201d layers in the model learn more general patterns (e.g. shapes, outlines, edges) whereas the later layers learn the more task specific features (whiskers on a cat or shape of a car\u2019s headlights). This ability has led to success even using transfer learning to help with medical diagnosis and staging when pre-trained on ImageNet.", "This has generally held true in NLP as well, however, it required a different architecture. Specifically, models like BERT and ELMO paved the way for transfer learning in the sequence to sequence domain. The transformer architecture in particular functioned well for transfer learning. It reasons the same would likely hold true to sequence problems such as time series.", "There are several core challenges that are specific to time series forecasting. The biggest one is that with time series it is harder to find a useful hierarchy or set of intermediate representations that generalize across to different problems. We do have certain components that people traditionally decompose time series into such as seasonality, trend and remainder. However, developing a model that effectively learns intermediate decoupled representations of these remains elusive. The authors of \u201cReconstruction and Regression Loss for Time-Series Transfer Learning\u201d explore creating a specialized loss function that helps to facilitate positive transfer through a decoupling process. They propose using an initial model to extract general features in (conjunction with the reconstruction loss), before using a time series specific model for forecasting. This technique seems to help improve performance, though the paper is limited to the single variate time series forecasting use case.", "A second challenge with multivariate time series forecasting is that many times the problems have a different number of feature time series. For example, with respect to COVID-19 we might have mobility data (3 features), new infections (1 feature), weather (3 features) for a total of 7 features. However, for something like flu forecasting we might only have new infections and weather data for a total of four features (e.g. mobility data was not collected for the flu). In our experiments we have generally found using a model specific initial \u201cembedding_layer\u201d helpful then having transferable middle layers.", "How to use flow forecast for transfer learning", "To facilitate transfer learning for time series forecasting, flow forecast has several features that make it easy to pre-train and leverage pre-trained time series models. In the model parameters section you can utilize a parameter called excluded_layers. This means that when you load a pre-trained model that the weights for these layers won\u2019t be loaded and instead instantiated fresh (if they even exist in the new model).", "This makes it easy to leverage weights from models where several layers might not be present or might not match the shape. See this notebook for a real world example.", "Secondly with flow-forecast we have easy tracking of prior pre-training datasets. This means you can easily keep track of the complete history of what other time series data your model was trained on. This can facilitate finding the best pre-training datasets. To include this in your config would typically just include a running list as a parameter (see full example here)", "Finally, we are working on adding additional features like making it easy to employ different learning rates and selective freezing to different layers as well as designing auto-encoder modules to find the most similar temporal datasets. We consider easy transfer learning a first class feature in our framework that we highly prioritize.", "What we have found in our research and using flow-forecast", "So far we have found generalized transfer learning useful for small datasets like our COVID-19 forecasts. We haven\u2019t tested it extensively enough on large datasets to make conclusions at this point. We also believe transfer learning can be very effective when comes to incorporating meta-data into forecasts. For example, models need to see many different types of meta-data (more on this in another article) and temporal data to learn how to merge them effectively. We also designed a sort of transfer learning protocol where we initially sweep to find the best static hyper-parameters. Then we take these parameters and pre-train the model with similar parameters (e.g. forecast-length, number of layers) before running a final hyper-parameter sweep on the non-static parameters (e.g. batch size, learning rate, etc).", "Transfer learning for time series has seen some limited progress, however, it has not been widely used. This is likely due to problems regarding number of features, usefulness of intermediate representations, and differences in seasonality (e.g. more negative transfer). With flow forecast we aim to provide more easy-to-use modules so that it is simple to leverage transfer learning successfully in the temporal domain. We believe transfer learning will come to play a larger role in time series.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, ex-Data Engineer, Maintainer of Flow Forecast"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F51f023bc159c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----51f023bc159c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51f023bc159c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://igodfried.medium.com/?source=post_page-----51f023bc159c--------------------------------", "anchor_text": ""}, {"url": "https://igodfried.medium.com/?source=post_page-----51f023bc159c--------------------------------", "anchor_text": "Isaac Godfried"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bebc59e793b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&user=Isaac+Godfried&userId=5bebc59e793b&source=post_page-5bebc59e793b----51f023bc159c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51f023bc159c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51f023bc159c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/alaska-wilderness-mountain-forest-67164/", "anchor_text": "Source"}, {"url": "https://arxiv.org/pdf/1811.01533.pdf", "anchor_text": "Fawaz el. al."}, {"url": "https://papers.nips.cc/paper/2019/file/eb1e78328c46506b46a4ac4a1e378b91-Paper.pdf", "anchor_text": "diagnosis"}, {"url": "https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0236621", "anchor_text": "staging"}, {"url": "https://milets18.github.io/papers/milets18_paper_2.pdf", "anchor_text": "\u201cReconstruction and Regression Loss for Time-Series Transfer Learning\u201d"}, {"url": "https://wandb.ai/covid/covid_forecast/reports/Transferring-Knowledge-on-Time-Series-with-the-Transformer--VmlldzoxNDEzOTk", "anchor_text": "Weights and Biases report."}, {"url": "https://github.com/AIStream-Peelout/flow-forecast", "anchor_text": "flow forecast"}, {"url": "https://colab.research.google.com/drive/169NO9B_il-E34Kdos1hxunuDFuD6rjuW#scrollTo=dx-tmLRain2Z", "anchor_text": "See this notebook for a real world example."}, {"url": "https://colab.research.google.com/drive/1PIo4u9VBE8V1_-HMifdqOYP-q7pW_UBJ", "anchor_text": "(see full example here)"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----51f023bc159c---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----51f023bc159c---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----51f023bc159c---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----51f023bc159c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----51f023bc159c---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51f023bc159c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&user=Isaac+Godfried&userId=5bebc59e793b&source=-----51f023bc159c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51f023bc159c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&user=Isaac+Godfried&userId=5bebc59e793b&source=-----51f023bc159c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51f023bc159c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51f023bc159c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F51f023bc159c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----51f023bc159c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----51f023bc159c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----51f023bc159c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----51f023bc159c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----51f023bc159c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----51f023bc159c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----51f023bc159c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----51f023bc159c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----51f023bc159c--------------------------------", "anchor_text": ""}, {"url": "https://igodfried.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://igodfried.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Isaac Godfried"}, {"url": "https://igodfried.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bebc59e793b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&user=Isaac+Godfried&userId=5bebc59e793b&source=post_page-5bebc59e793b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc5f7444d643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftransfer-learning-for-time-series-forecasting-51f023bc159c&newsletterV3=5bebc59e793b&newsletterV3Id=c5f7444d643&user=Isaac+Godfried&userId=5bebc59e793b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}