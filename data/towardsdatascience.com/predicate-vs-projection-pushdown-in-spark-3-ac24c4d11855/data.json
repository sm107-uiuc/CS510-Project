{"url": "https://towardsdatascience.com/predicate-vs-projection-pushdown-in-spark-3-ac24c4d11855", "time": 1683016041.903475, "path": "towardsdatascience.com/predicate-vs-projection-pushdown-in-spark-3-ac24c4d11855/", "webpage": {"metadata": {"title": "Predicate vs Projection Pushdown in Spark 3 | by P\u0131nar Ersoy | Towards Data Science", "h1": "Predicate vs Projection Pushdown in Spark 3", "description": "Working with big data comes with the challenges of high amounts of processing costs and spending a lot of time scaling them. It is required to be aware of the adequate big data filtering techniques\u2026"}, "outgoing_paragraph_urls": [{"url": "https://spark.apache.org/", "anchor_text": "Apache Spark", "paragraph_index": 0}, {"url": "https://spark.apache.org/releases/spark-release-3-0-0.html", "anchor_text": "Spark 3", "paragraph_index": 2}, {"url": "https://www.linkedin.com/in/pinarersoy/", "anchor_text": "https://www.linkedin.com/in/pinarersoy/", "paragraph_index": 20}], "all_paragraphs": ["Working with big data comes with the challenges of high amounts of processing costs and spending a lot of time scaling them. It is required to be aware of the adequate big data filtering techniques in order to get benefit from them. This article is essential for data scientists and data engineers looking to use the newest enhancements of Apache Spark in the sub-area of filtering especially on nested structured data.", "With Spark 2.x, files with a maximum 2-level nested structure with .json and .parquet extensions could be read.", "With Spark 3, it is now possible to read files with both parquet and .snappy parquet extensions in 2+ level nested structure without any need for schema flattening operations.", "While creating a spark session, the following configurations shall be enabled to use pushdown features of the Spark 3. The setting values \u200b\u200blinked to Pushdown Filtering activities are activated by default.", "There are two kinds of pushdown filtering techniques as Predicate Pushdown and Projection Pushdown in Spark with the following differing features as described in the following sections of the article.", "Predicate Pushdown points to the where or filter clause which affects the number of rows returned. It basically relates to which rows will be filtered, not which columns. For this reason, while applying the filter on a nested column as \u2018library.books\u2019 to merely return records with the values that are not null, the predicate pushdown function will make parquet read blocks that contain no null values for the specified column.", "The partition elimination technique allows optimizing performance when reading folders from the corresponding file system so that the desired files in the specified partition can be read. It will address shifting the filtering of data as close to the source as possible to prevent keeping unnecessary data into memory with the aim of reducing disk I/O.", "Below, it can be observed that the filter of partition of the action of push down, which is \u2018library.books.title\u2019 = \u2018THE HOST\u2019 filter is pushed down into the parquet file scan. This operation enables the minimization of the files and scanning of data.", "For a more detailed output including Parsed Logical Plan, Analyzed Logical Plan, Optimized Logical Plan, Physical Plan, the \u2018extended\u2019 parameter can be added in the explain() function as follows.", "It can also reduce the amount of data passed back to the Spark Engine for the average operation in the aggregation function on the \u2018price\u2019 column.", "Parquet formatted files keep some different statistical metrics for each column including the minimum and maximum of their values. Predicate Pushdown helps to skip irrelevant data and deals with the required data.", "Projection Pushdown stands for the selected column(s) with the select clause which affects the number of columns returned. It stores data in columns, so when your projection limits the query to specified columns, specifically those columns will be returned.", "This means that the scanning of the \u2018library.books.title\u2019, \u2018library.books.author\u2019columns meaning that the scanning will occur in the file system/database before sending back the data to the Spark engine.", "For both the Projection and Predicate Pushdown, there are some crucial points to highlight. Pushdown Filtering works on partitioned columns which are calculated by the nature of parquet formatted files. To be able to get the most benefit from them, the partition columns shall be carrying smaller-sized values with adequate matching data to scatter the correct files in the directories.", "Prevent too many small-sized files causes to make scans less efficient with excessive parallelism. Also, preventing accepting too few big-sized files may damage parallelism.", "The Projection Pushdown feature allows the minimization of data transfer between the file system/database and the Spark engine by eliminating unnecessary fields from the table scanning process. It is primarily useful when a dataset contains too many columns.", "On the other hand, the Predicate Pushdown boosts performance by scaling down the amount of data passed between the file system/database and the Spark engine when filtering data.", "Projection Pushdown is distinguished by column-based and Predicate Pushdown by row-based filtering.", "Questions and comments are highly appreciated!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Lead Data Scientist @Dataroid, BSc Software & Industrial Engineer, MSc Software Engineer https://www.linkedin.com/in/pinarersoy/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac24c4d11855&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@pinarersoy?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pinarersoy?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": "P\u0131nar Ersoy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5411ba755d50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&user=P%C4%B1nar+Ersoy&userId=5411ba755d50&source=post_page-5411ba755d50----ac24c4d11855---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac24c4d11855&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac24c4d11855&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/LqKhnDzSF-8", "anchor_text": "Source"}, {"url": "https://spark.apache.org/", "anchor_text": "Apache Spark"}, {"url": "https://spark.apache.org/releases/spark-release-3-0-0.html", "anchor_text": "Spark 3"}, {"url": "https://spark.apache.org/releases/spark-release-3-0-0.html", "anchor_text": "Spark Release 3.0.0"}, {"url": "https://issues.apache.org/jira/browse/SPARK-27699", "anchor_text": "Pushdown of disjunctive predicates"}, {"url": "https://issues.apache.org/jira/browse/SPARK-25603", "anchor_text": "Generalize Nested Column Pruning"}, {"url": "https://issues.apache.org/jira/browse/SPARK-17636", "anchor_text": "Parquet predicate pushdown for nested fields"}, {"url": "https://medium.com/tag/spark?source=post_page-----ac24c4d11855---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ac24c4d11855---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/ai?source=post_page-----ac24c4d11855---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ac24c4d11855---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/big-data?source=post_page-----ac24c4d11855---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac24c4d11855&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&user=P%C4%B1nar+Ersoy&userId=5411ba755d50&source=-----ac24c4d11855---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fac24c4d11855&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&user=P%C4%B1nar+Ersoy&userId=5411ba755d50&source=-----ac24c4d11855---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac24c4d11855&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fac24c4d11855&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ac24c4d11855---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ac24c4d11855--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac24c4d11855--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ac24c4d11855--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ac24c4d11855--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pinarersoy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@pinarersoy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "P\u0131nar Ersoy"}, {"url": "https://medium.com/@pinarersoy/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "586 Followers"}, {"url": "https://www.linkedin.com/in/pinarersoy/", "anchor_text": "https://www.linkedin.com/in/pinarersoy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5411ba755d50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&user=P%C4%B1nar+Ersoy&userId=5411ba755d50&source=post_page-5411ba755d50--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd8be348d5069&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicate-vs-projection-pushdown-in-spark-3-ac24c4d11855&newsletterV3=5411ba755d50&newsletterV3Id=d8be348d5069&user=P%C4%B1nar+Ersoy&userId=5411ba755d50&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}