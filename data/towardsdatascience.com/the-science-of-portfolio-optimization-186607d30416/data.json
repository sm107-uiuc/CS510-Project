{"url": "https://towardsdatascience.com/the-science-of-portfolio-optimization-186607d30416", "time": 1683014274.702975, "path": "towardsdatascience.com/the-science-of-portfolio-optimization-186607d30416/", "webpage": {"metadata": {"title": "The Science of Portfolio Optimization | by Victor Silva, M. Sc. | Towards Data Science", "h1": "The Science of Portfolio Optimization", "description": "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://ocw.mit.edu/courses/sloan-school-of-management/15-401-finance-theory-i-fall-2008/", "anchor_text": "Finance Theory I", "paragraph_index": 1}, {"url": "https://ocw.mit.edu/courses/mathematics/18-s096-topics-in-mathematics-with-applications-in-finance-fall-2013/", "anchor_text": "Topics in Mathematics with Applications to Finance", "paragraph_index": 1}, {"url": "https://github.com/robertmartin8/PyPortfolioOpt", "anchor_text": "PyPortfolioOpt", "paragraph_index": 3}, {"url": "https://github.com/tradytics/eiten", "anchor_text": "Eiten", "paragraph_index": 3}, {"url": "https://www.investopedia.com/articles/basics/10/guide-to-calculating-roi.asp", "anchor_text": "sample return", "paragraph_index": 10}, {"url": "https://www.investopedia.com/terms/c/capm.asp", "anchor_text": "CAPM", "paragraph_index": 10}, {"url": "https://srome.github.io/Eigenvesting-III-Random-Matrix-Filtering-In-Finance/", "anchor_text": "this blog post by Scott Rome", "paragraph_index": 14}, {"url": "https://www.investopedia.com/terms/s/sharperatio.asp", "anchor_text": "Sharpe Ratio", "paragraph_index": 15}, {"url": "https://www.investopedia.com/ask/answers/100314/whats-difference-between-long-and-short-position-market.asp", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://www.cnbc.com/2019/03/15/active-fund-managers-trail-the-sp-500-for-the-ninth-year-in-a-row-in-triumph-for-indexing.html", "anchor_text": "majority of the fund managers cannot outperform benchmarks", "paragraph_index": 23}, {"url": "https://github.com/silvavn/eiten", "anchor_text": "GitHub", "paragraph_index": 25}, {"url": "https://www.linkedin.com/in/nascimentovictor/", "anchor_text": "LinkedIn", "paragraph_index": 25}, {"url": "https://webdocs.cs.ualberta.ca/~vsilva/", "anchor_text": "my website", "paragraph_index": 25}, {"url": "https://medium.com/analytics-vidhya/the-science-of-future-price-prediction-5a488334f2c7", "anchor_text": "Check out my newest article about stock price prediction", "paragraph_index": 25}, {"url": "http://M.Sc", "anchor_text": "M.Sc", "paragraph_index": 27}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "A short while ago I watched two excellent courses while looking for inspiration for my PhD Thesis, namely Finance Theory I and Topics in Mathematics with Applications to Finance, both available for free on MIT Open Courseware. These courses helped me to think about what \u201cchange\u201d (the topic of my PhD) means in time series data. I wanted to make sure that I had learned the content of those two courses. Thus, I decided to implement some products, including pricing estimators, algorithmic traders and the idea that I will present in this post: a portfolio optimizer.", "All this started with the idea of optimizing trading bots. More specifically, I was looking for bots that detected change in the time series and could react to different types of cryptocurrency markets. I came up with the idea of creating a bot portfolio that would study the changes in the market and allocate a bot that was appropriate.", "While doing research on the trading bots, and implementing my own idea, I found someone that was implementing similar software for stock markets. In a later conversation, I found that this person had coincidentally done the exact same courses as me. This idea is, of course, presented by both courses to quantitatively estimate better asset portfolios. Notice that a similar software do exist, such as PyPortfolioOpt. I build my idea over the initial release of Eiten, an early-stage Open Source project. Here\u2019s my take on portfolio optimization.", "Note that this post does not constitute financial advice. If you would like to invest your money, please consult a professional. Above all, do your own research.", "Firstly, selecting a collection of assets to invest is not the same as optimizing it. When selecting a collection of assets, one seeks to diversify their investments while selecting companies they trust. In terms of optimization, one analyzes its selected portfolio managing the amount of money that is invested in each asset. For instance, one can invest 5%, 30% and 0% into three distinct assets. It is a matter of allocating resources trying to minimize risk and/or maximizing returns.", "I made a selection of assets based on stocks that other people have selected before and my own judgement that I will use to exemplify my pipeline. These stocks are: Microsoft (MSFT), Amazon (AMZN), Nordic American Tanker (NAT), Bank of America Corp (BAC), Domino\u2019s Pizza (DPZ), Disney (DIS), Coca-Cola (KO), KO, McDonalds (MCD), Costco (COST) and, Starbucks (SBUX). Lets start by looking at the price graph of my selection.", "These stocks seem to have done well over time. Looking at prices, however, does not give me a clear picture of how much money would I make. What I really want to know is how much have these assets returned during the studied period. To find that out, I calculated the percentage returns of each stock over time. I show this calculation in the graph below.", "Had I only looked at prices, I would say that it looks like Amazon did much better than other investments. When I analyzed the returns I could better understand that MSFT and DPZ followed closely.", "We would like our assets to perform well in the future. The challenge is: We do not know what the future looks like, so we need to estimate. We first split our data into two sets: historical and future. Notice that, since we are not applying Machine Learning Algorithms, we do not split into training, validation and, test.", "To estimate future returns we can use several methods, such as sample return, CAPM, among others. Different methods will give us different price valuations of each asset. Using the estimators, we can analyze the estimated return of each of our assets. For example, in the image below we can explore how four different methods have estimated the past returns of the selected assets.", "Notice that when we use an estimator based on percentage gain (aka get_price_deltas) we value all assets positively. Using more sophisticated methods, such as a logarithmic scaled estimator (aka get_log_returns), we we capture the negative returns that NAT showed through the period. We can then compare the valuation in the historical data to that of the future data and compute the returns, allowing us to evaluate each method and choose one to produce a portfolio weighting. We computed the error between past and future and show it in the plot below.", "In the analysis above, the best estimator was the exponentially weighted estimator (aka get_predicted_returns). Its Mean Absolute Error (MAE) between past and future data is less than 0.1%. We will, therefore, select this estimator to predict our portfolio weights.", "With the returns in hand, we can now estimate the relatedness of the selected assets. We will use the covariance calculation to check what assets have similar returns. This will allow us to diversify our investments, making sure we invest in assets that can grow when our other assets are not doing so well.", "Again, the market is dynamic, and things change all the time. Assets that were related in the past might not be related in the future! We need to find a covariance matrix that generalizes well for future data, so we compare several covariance calculation methods. We show a sample below, but we support methods such as OAS [1], Ledoit-Wolf [2]. We also support a covariance matrix cleaning method based on random matrix theory. I will not go into detail on that, you can read more in this blog post by Scott Rome or in the excellent lecture notes by Edelman and Rao [3].", "With the covariance matrix and the weights, we can now apply a strategy to generate portfolio. A strategy optimizes towards an objective function. For instance, we can optimize for the Sharpe Ratio, where we want to find a balance between risk and reward. Using the returns and covariance matrix, this strategy will output a weight for each asset. These weights can be either positive or negative. Positive weights mean that the strategy suggests a long position, while a negative weight means that the strategy suggests a short position. A long position means that the asset is bought, and we expect that the returns will be positive (price will increase over time). Similarly, a short position means that the asset is sold, and we expect that the returns will be negative (price will decrease over time). You can read more about long and short positions here.", "In the figure above we can see the weighting that each strategy attributes to each asset. We can then use these weights to output a portfolio, by computing a ratio of the invested money with respect to the weight.", "The big question now is, how well will our portfolio perform if we invest using the outputs of a given strategy? We can do that by running our learned strategy into the data. People that do Machine Learning (like me), probably will cringe at this, but fear nothing, we have part of the data set apart. Think about this as a validation test.", "In the image above we can see that all the proposed portfolios beat the S&P500 (SPY) benchmark. Notoriously, the Genetic Algorithms has outperformed the benchmark by more the two times the returns.", "We will perform two different evaluations to answer that question. First, we will do a Monte-Carlo Simulation [4] of future prices. In short, this is a stochastic method where we use the past prices to find a distribution and randomly generate future prices.", "We see that the computed portfolios continue to perform well if the prices follow the Monte-Carlo prices. In special, the Maximum Sharpe Portfolio (MSR) predicts just over 0.8% in three months.", "We have also set apart 90 days worth of data to test if the portfolio can really generalize. Given the portfolio weights, we get the following performance.", "We can see that the generated portfolios perform close to the benchmark, slightly underperforming in short term. The MSR portfolio outperforms the benchmark at times but suffer with variance. We can learn something from this last analysis: diversification is important. The benchmark has just about 500 different companies from various sectors, while the proposed portfolios have 10. This makes the portfolios much more vulnerable to changes that are specific to a sector or an asset. Selecting good stocks is even more important than optimizing them!", "Portfolio optimization is a hard task and should be done carefully. On one hand, several outlets report that the majority of the fund managers cannot outperform benchmarks, like the S&P500. On the other, funds like Renaissance have continuously beat benchmarks over the years.", "Finally, portfolio building is even more important than portfolio optimization! Optimizing is hard, but it will be even harder if we try to optimize poorly performing stocks. Remember to do your own research, pick assets wisely and leave your clap below. If you liked what you read, do not forget to follow me for more future content.", "The software used in this post is Open Source and publicly available in my GitHub. Feel free to connect with me on LinkedIn! Curious about me? Here\u2019s my website. Check out my newest article about stock price prediction.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science | Finance | Machine Learning | Ethics| I hold two M.Sc. in Computer Science and I\u2019m a PhD Researcher at the University of Alberta."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F186607d30416&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----186607d30416--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----186607d30416--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vnasilva.medium.com/?source=post_page-----186607d30416--------------------------------", "anchor_text": ""}, {"url": "https://vnasilva.medium.com/?source=post_page-----186607d30416--------------------------------", "anchor_text": "Victor Silva, M. Sc."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b93ba4ac53e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&user=Victor+Silva%2C+M.+Sc.&userId=2b93ba4ac53e&source=post_page-2b93ba4ac53e----186607d30416---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F186607d30416&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F186607d30416&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@bash__profile?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "NICHOLAS CAPPELLO"}, {"url": "https://unsplash.com/s/photos/stock-market?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://ocw.mit.edu/courses/sloan-school-of-management/15-401-finance-theory-i-fall-2008/", "anchor_text": "Finance Theory I"}, {"url": "https://ocw.mit.edu/courses/mathematics/18-s096-topics-in-mathematics-with-applications-in-finance-fall-2013/", "anchor_text": "Topics in Mathematics with Applications to Finance"}, {"url": "https://github.com/robertmartin8/PyPortfolioOpt", "anchor_text": "PyPortfolioOpt"}, {"url": "https://github.com/tradytics/eiten", "anchor_text": "Eiten"}, {"url": "https://www.investopedia.com/articles/basics/10/guide-to-calculating-roi.asp", "anchor_text": "sample return"}, {"url": "https://www.investopedia.com/terms/c/capm.asp", "anchor_text": "CAPM"}, {"url": "https://srome.github.io/Eigenvesting-III-Random-Matrix-Filtering-In-Finance/", "anchor_text": "this blog post by Scott Rome"}, {"url": "https://www.investopedia.com/terms/s/sharperatio.asp", "anchor_text": "Sharpe Ratio"}, {"url": "https://www.investopedia.com/ask/answers/100314/whats-difference-between-long-and-short-position-market.asp", "anchor_text": "here"}, {"url": "https://www.cnbc.com/2019/03/15/active-fund-managers-trail-the-sp-500-for-the-ninth-year-in-a-row-in-triumph-for-indexing.html", "anchor_text": "majority of the fund managers cannot outperform benchmarks"}, {"url": "https://github.com/silvavn/eiten", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/nascimentovictor/", "anchor_text": "LinkedIn"}, {"url": "https://webdocs.cs.ualberta.ca/~vsilva/", "anchor_text": "my website"}, {"url": "https://medium.com/analytics-vidhya/the-science-of-future-price-prediction-5a488334f2c7", "anchor_text": "Check out my newest article about stock price prediction"}, {"url": "https://medium.com/tag/investing?source=post_page-----186607d30416---------------investing-----------------", "anchor_text": "Investing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----186607d30416---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----186607d30416---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/tag/money?source=post_page-----186607d30416---------------money-----------------", "anchor_text": "Money"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----186607d30416---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F186607d30416&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&user=Victor+Silva%2C+M.+Sc.&userId=2b93ba4ac53e&source=-----186607d30416---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F186607d30416&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&user=Victor+Silva%2C+M.+Sc.&userId=2b93ba4ac53e&source=-----186607d30416---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F186607d30416&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----186607d30416--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F186607d30416&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----186607d30416---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----186607d30416--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----186607d30416--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----186607d30416--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----186607d30416--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----186607d30416--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----186607d30416--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----186607d30416--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----186607d30416--------------------------------", "anchor_text": ""}, {"url": "https://vnasilva.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vnasilva.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Victor Silva, M. Sc."}, {"url": "https://vnasilva.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "http://M.Sc", "anchor_text": "M.Sc"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b93ba4ac53e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&user=Victor+Silva%2C+M.+Sc.&userId=2b93ba4ac53e&source=post_page-2b93ba4ac53e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F211e5035ce7b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-science-of-portfolio-optimization-186607d30416&newsletterV3=2b93ba4ac53e&newsletterV3Id=211e5035ce7b&user=Victor+Silva%2C+M.+Sc.&userId=2b93ba4ac53e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}