{"url": "https://towardsdatascience.com/variational-autoencoder-in-finance-53ee5eb9ed98", "time": 1682995793.2347488, "path": "towardsdatascience.com/variational-autoencoder-in-finance-53ee5eb9ed98/", "webpage": {"metadata": {"title": "Variational Autoencoder In Finance | by Marie Imokoyende | Towards Data Science", "h1": "Variational Autoencoder In Finance", "description": "This article explores the use of a variational autoencoder to reduce the dimensions of financial time series with Keras and Python. We will further detect similarities between financial instruments\u2026"}, "outgoing_paragraph_urls": [{"url": "https://learn.utoronto.ca/programs-courses/courses/3546-deep-learning", "anchor_text": "Deep Learning course", "paragraph_index": 1}, {"url": "https://www.linkedin.com/in/humbertors", "anchor_text": "Humberto Ribeiro de Souza", "paragraph_index": 1}, {"url": "https://github.com/MarieImokoyende/vae-dimRedFinance/blob/master/3546%20Deep%20Learning%20Project%20-%20Data%20Treatment.ipynb", "anchor_text": "data treatment notebook", "paragraph_index": 7}, {"url": "https://blog.keras.io/building-autoencoders-in-keras.html", "anchor_text": "Keras Blog", "paragraph_index": 23}, {"url": "https://arxiv.org/abs/1312.6114", "anchor_text": "Auto-Encoding Variational Bayes paper", "paragraph_index": 23}, {"url": "https://blog.keras.io/building-autoencoders-in-keras.html", "anchor_text": "Keras blog", "paragraph_index": 24}, {"url": "https://github.com/keras-team/keras/blob/master/examples/variational_autoencoder.py", "anchor_text": "variational_autoencoder.py", "paragraph_index": 25}, {"url": "https://en.wikipedia.org/wiki/Price_index#Paasche_and_Laspeyres_price_indices", "anchor_text": "Laspeyres index", "paragraph_index": 42}], "all_paragraphs": ["This article explores the use of a variational autoencoder to reduce the dimensions of financial time series with Keras and Python. We will further detect similarities between financial instruments in different markets and will use the results obtained to construct a custom index.", "Disclaimer: The research presented in this article comes from our Winter 2019 Term Project for the Deep Learning course at the University of Toronto School of Continuing Studies. It was done in collaboration with Humberto Ribeiro de Souza. The concepts and ideas are our own. We are in no way representing our current or previous employers.", "In this section, we will discuss:", "Creating The Geometric Moving Average Dataset", "In order to compare time series of various price ranges, we have chosen to compute geometric moving average time series of returns defined as:", "We chose d=5, as it represents a typical trading week of 5 business days.", "The dataset used in this article contains 423 geometric moving average time series for a period going from January 4th, 2016 to March 1st, 2019.", "Readers can follow the steps described in the data treatment notebook to build their own dataset. It should be similar to this one:", "Results can be verified by plotting some sample stock price time series and their geometric moving average curves:", "Then, the dataframe just built can be divided in two time periods of equal length, transposing the one for the first period only. Period 1 goes from January 12th, 2016 to August 4th, 2017. Period 2, goes from August 7th, 2017 to March 1st, 2019.", "We will only use the period 1 data to obtain predictions.", "We transpose the dataframe so that each row will represent a time series for a given stock:", "Augmenting the data with stochastic simulation", "We will use stochastic simulation to generate synthetic geometric moving average curves. The objective is not to precisely model returns but to obtain curves with a behavior similar to real data. By training the model with only simulated curves we can keep the real data to obtain the predictions.", "The synthetic curves are generated using Geometric Brownian Motion. We followed the steps below:", "Here is a sample of a simulated curve and a real curve:", "We have expanded a dataset of 423 time series to 100*100 = 10,000 new time series similar (but not equal) to the stock dataset.", "This will allow us to keep the actual stock dataset universe for predictions and not even have to use it for the validation.", "Before building the VAE model, create the training and test sets (using a 80%-20% ratio):", "Readers should also note that there is no need to remove the seasonality and trend of the time series before training the model.", "Building the Variational Autoencoder (VAE) Model", "We will use a variational autoencoder to reduce the dimensions of a time series vector with 388 items to a two-dimensional point.", "Autoencoders are unsupervised algorithms used to compress data. They are built with an encoder, a decoder and a loss function to measure the information loss between the compressed and decompressed data representations.", "Our goal is not to write yet another autoencoder article. Readers who are not familiar with autoencoders can read more on the Keras Blog and the Auto-Encoding Variational Bayes paper by Diederik Kingma and Max Welling.", "We will use a simple VAE architecture similar to the one described in the Keras blog.", "The code below is adapted from variational_autoencoder.py on the Keras team Github. It is used to build and train the VAE model.", "After training, we plot the training and validation loss curves:", "We will only use the encoder to obtain the predictions. We will use a matrix of real values including both the stock dataset and one or multiple time series of interest.", "In our project, we tested a stock dataset against a front month futures contract listed in another country and in a different currency.", "Before plotting the results, we have to:", "We can now plot the results obtained to visualize the closest 50 stocks:", "We\u2019ve done our analysis for a futures contract listed in another country. However it is possible to follow the same steps in Part 1 for stocks from the same exchange.", "Let\u2019s use the results obtained in Part 1 to create an index.", "Due to the randomness of the VAE model, we will not obtain the same exact list of top 50 stocks on each run. To get a fair representation of the closest 50 points, we will run the VAE model 10 times (re-initializing and retraining it on each run). Then we will take the 50 closest points found on each run to create a dataframe closest_points_df dataframe of length 500.", "Once the closest_points_df dataframe is built:", "After dropping the duplicates, we will only keep the 50 closest points.", "Compute the weights of each stock", "In index construction, stock weights are calculated by using different methodologies such as market capitalization or stock prices.", "Instead, we will calculate the weight of each stock such that the points closest to the futures contract point will get a higher weight than the ones further from it.", "With non-anonymized stock data, it is important to filter the results obtained before computing the stock weights. Outliers should be removed and the market capitalization range should be refined.", "Compute the number of shares of each stock", "After computing the weights, we calculate the number of shares of each stock in our custom index. We need to:", "To build the index, we will use the Laspeyres index computed as:", "We plot the custom index obtained:", "Compare our custom index with the futures time series", "We have to scale the futures price data in order to plot it in the same graph as our custom index. To do so we have to:", "We now plot both curves in the same graph:", "Our index has mostly the same trend as the reference futures time series except for the second half of 2018. Because we use anonymized data, we did not filter the stocks for outliers and market capitalization limits. Furthermore there was no re-balancing throughout the two time periods observed and we ignored distributions.", "It is absolutely possible for the custom index to beat the futures index if tickers are identified and outliers are removed.", "We encourage our readers to take advantage of the free GPU instances available online to create their own indices. It was a fun experiment for us and we discovered some interesting stock patterns.", "Feel free to download the two notebooks available on GitHub:", "The use of variational autoencoders can speed up the development of new indices in foreign stock markets, even if analysts are unfamiliar with them. Furthermore, niche indices or portfolios could be created to match customers interests.", "While this method can be used to create ETFs, we believe that it can also create new investment possibilities for Direct Indexing and Robo Advisors firms worldwide.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F53ee5eb9ed98&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marie.imokoyende?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marie.imokoyende?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": "Marie Imokoyende"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79dc1431a34c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&user=Marie+Imokoyende&userId=79dc1431a34c&source=post_page-79dc1431a34c----53ee5eb9ed98---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53ee5eb9ed98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53ee5eb9ed98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://learn.utoronto.ca/programs-courses/courses/3546-deep-learning", "anchor_text": "Deep Learning course"}, {"url": "https://www.linkedin.com/in/humbertors", "anchor_text": "Humberto Ribeiro de Souza"}, {"url": "https://github.com/MarieImokoyende/vae-dimRedFinance/blob/master/3546%20Deep%20Learning%20Project%20-%20Data%20Treatment.ipynb", "anchor_text": "data treatment notebook"}, {"url": "https://blog.keras.io/building-autoencoders-in-keras.html", "anchor_text": "Keras Blog"}, {"url": "https://arxiv.org/abs/1312.6114", "anchor_text": "Auto-Encoding Variational Bayes paper"}, {"url": "https://blog.keras.io/building-autoencoders-in-keras.html", "anchor_text": "Keras blog"}, {"url": "https://github.com/keras-team/keras/blob/master/examples/variational_autoencoder.py", "anchor_text": "variational_autoencoder.py"}, {"url": "https://en.wikipedia.org/wiki/Price_index#Paasche_and_Laspeyres_price_indices", "anchor_text": "Laspeyres index"}, {"url": "https://github.com/MarieImokoyende/vae-dimRedFinance/blob/master/3546%20Deep%20Learning%20Project%20-%20Data%20Treatment.ipynb", "anchor_text": "3546 Deep Learning Project \u2014 Data Treatment.ipynb"}, {"url": "https://github.com/MarieImokoyende/vae-dimRedFinance/blob/master/3546%20Deep%20Learning%20Project%20-%20VAE%20_%20Index%20Construction.ipynb", "anchor_text": "3546 Deep Learning Project \u2014 VAE & Index Construction.ipynb"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----53ee5eb9ed98---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/variational-autoencoder?source=post_page-----53ee5eb9ed98---------------variational_autoencoder-----------------", "anchor_text": "Variational Autoencoder"}, {"url": "https://medium.com/tag/index?source=post_page-----53ee5eb9ed98---------------index-----------------", "anchor_text": "Index"}, {"url": "https://medium.com/tag/exchange-traded-funds?source=post_page-----53ee5eb9ed98---------------exchange_traded_funds-----------------", "anchor_text": "Exchange Traded Funds"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----53ee5eb9ed98---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F53ee5eb9ed98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&user=Marie+Imokoyende&userId=79dc1431a34c&source=-----53ee5eb9ed98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F53ee5eb9ed98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&user=Marie+Imokoyende&userId=79dc1431a34c&source=-----53ee5eb9ed98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53ee5eb9ed98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F53ee5eb9ed98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----53ee5eb9ed98---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----53ee5eb9ed98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marie.imokoyende?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marie.imokoyende?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marie Imokoyende"}, {"url": "https://medium.com/@marie.imokoyende/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "54 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79dc1431a34c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&user=Marie+Imokoyende&userId=79dc1431a34c&source=post_page-79dc1431a34c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F43ae99062d53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvariational-autoencoder-in-finance-53ee5eb9ed98&newsletterV3=79dc1431a34c&newsletterV3Id=43ae99062d53&user=Marie+Imokoyende&userId=79dc1431a34c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}