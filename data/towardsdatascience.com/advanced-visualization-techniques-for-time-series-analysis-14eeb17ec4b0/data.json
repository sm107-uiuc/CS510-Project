{"url": "https://towardsdatascience.com/advanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0", "time": 1683017873.875807, "path": "towardsdatascience.com/advanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0/", "webpage": {"metadata": {"title": "Advanced visualization techniques for time series analysis | by Micha\u00ebl HOARAU | Towards Data Science", "h1": "Advanced visualization techniques for time series analysis", "description": "Markov transition fields (MTF) is a visualization technique to highlight behavior of time series. This blog post dives into how we build and interpret these fields. We will then further build on top\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/michaelhoarau/mtf-deep-dive/blob/main/mtf-deep-dive.ipynb", "anchor_text": "companion Jupyter notebook", "paragraph_index": 0}, {"url": "https://github.com/johannfaouzi/pyts", "anchor_text": "pyts", "paragraph_index": 2}, {"url": "https://github.com/michaelhoarau/mtf-deep-dive/blob/main/mtf-deep-dive.ipynb", "anchor_text": "notebook", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Louvain_method", "anchor_text": "Louvain method", "paragraph_index": 27}, {"url": "https://python-louvain.readthedocs.io/en/latest/", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://pypi.org/project/tsia/", "anchor_text": "tsia", "paragraph_index": 27}, {"url": "https://michoara.medium.com/membership", "anchor_text": "https://michoara.medium.com/membership", "paragraph_index": 37}], "all_paragraphs": ["Markov transition fields (MTF) is a visualization technique to highlight behavior of time series. This blog post dives into how we build and interpret these fields. We will then further build on top of Markov transition fields by exploring network graphs interpretation. Feel free to follow along by browsing to GitHub to grab this companion Jupyter notebook.", "In the GitHub repository mentioned above, you will also find 7 signals captured on industrial equipment. Each signal contains one year of data with a one-hour sampling rate and they sports different behavior that we are going to try to characterize. Let\u2019s plot the first one:", "The pyts package includes some time series imaging capabilities out of the box, including the MTF: passed through this transformation, the previous signal can be represented by the following matrix:", "Let\u2019s now decompose the process that leads to this visual representation. In the following sections, we are going to decompose the way a Markov transition fields is built to better understand its properties and how it can be used to build our understanding of time series behavior:", "We use once again the pyts package (abstracted by the tsia package built by yours truly) to discretize our signal:", "After this, each value x[i] of the timeseries is associated to one of the bin (quantile) we just computed. The first and the last bin edges respectively correspond to the lowest and highest value taken by the signal. The intermediate bin edges are computed by the discretizer. For the signal loaded earlier, this quantization process bins the different values taken by this signal in the following bins:", "Let\u2019s plot these bins over the time series to visualize how the values are discretized:", "Once our signal is quantized, we can build a Markov transition matrix:", "Last but not least, the diagonal captures the frequency at which a quantile transitions to itself (self-transition frequency).", "We will now normalize each bin. This matrix contains now the transition probability on the magnitude axis:", "The first column correspond to the probabilities that a given value (part of a given bin) transitions to bin 0. The second column are probabilities that a given value transitions to bin 1, etc. For instance, if a given value X[i] is equal to 130.0, it is between 118.42 and 137.42 and it's binned in bin 1. Given the matrix above, there is:", "The idea of the transition field is to represent the Markov transition probabilities sequentially to preserve the information in the time domain. The MTF generation process aligns each probability along the temporal order to build the MTF for the whole signal:", "How to read the Markov transition field? MTF[i,j] denotes the transition probability from the quantile q[i] to the quantile q[j]. Let's have a look at a couple values in the second row of this field:", "What does this mean? Well, the transition that occurs between timestep x[1] and timestamp x[2] has an 68.8% chance from happening when looking at the whole signal.", "The transition that happens between timestep x[1] and x[6] has a 10.7% chance of happening when looking at the whole signal.", "Let\u2019s now plot the transition field we just computed:", "To make the image size manageable and computation more efficient (the above MTF is a matrix of dimension 4116 x 4116), we reduce the MTF size by averaging the pixels in each non-overlapping m x m patch with the blurring kernel 1/m\u00b2. m is the image size and we set it, arbitrarily, to 48. That is, we aggregate the transition probabilities in each subsequence of length m = 48 together. Let's compute an aggregated MTF accordingly: if the signal length can be divided by the chosen image size (48), which is the case here, we can just compute the aggregate MTF with this simple function:", "Otherwise, we need to compute a piecewise aggregate approximation, but don\u2019t worry, this is fully implemented and taken care for you in the pyts package! The image obtained is exactly the same than the one shown at the top of this article:", "The diagonal of the MTF contains probabilities for the self-transitions:", "One way we can map back these probabilities on the original signal, is to take the transition probabilities shown on the diagonal of the MTF:", "Let\u2019s have a look at a coarse MTF (image_size=8 will make it quite coarse) to better understand what we can extract from this Markov field:", "What is the interpretation we can give to this plot?", "The blue section is closer to the normal behavior of this signal whereas the yellow section is diverging more from it.", "Before moving to the next section, have a look at the notebook, if you\u2019d like to check how the behavior of very different signals can be mapped to different MTF plots and metrics!", "From the MTF, we can generate a graph G = (V, E): we have a direct mapping between vertex V and the time index i. From there, there is two possible encoding of interest:", "In the following sections, we are going to decompose the way a network graph is built to better understand its properties and how it can be used to build our understanding of time series behavior:", "We extract the graph from the MTF and plot a vanilla network graph from there:", "The above network graph does not give us a lot of new insights. We will search for the communities in this network graph with the Louvain method: modularity is a scale value between \u22120.5 (non-modular clustering) and 1 (fully modular clustering) that measures the relative density of edges inside communities with respect to edges outside communities. Optimizing this value theoretically results in the best possible grouping of the nodes of a given network, however going through all possible iterations of the nodes into groups is impractical so heuristic algorithms are used. In the Louvain Method of community detection, first small communities are found by optimizing modularity locally on all nodes, then each small community is grouped into one node and the first step is repeated. This method is implemented in the community package (documented here) and we use it in the tsia package to encode our network graph:", "On top of modularity and number of communities (or partitions), there are other statistics of interest we can compute from a network graph:", "We can now encode these information in the network graph to make it more colorful, and hopefully, more useful:", "What is the interpretation we can give to this plot? The modularity metric and the Louvain methods uncovers 4 communities in this signal. At this stage, it is difficult to understand how we can leverage this knowledge though\u2026", "Each community detected in the network graphs has its own shapelet in the original time series:", "You can refer to the notebook to further build your intuition by drawing the same plot for the other signals available in the repository. Here are a few examples:", "These mapping looks less valuable than the one obtained from the MTF. However, the features that that can be extracted from these network graphs look promising for classifying signals depending on their behavior. Here is an example on the 7 signals provided in the repository referenced earlier:", "Mapping Markov transition fields transition probabilities back onto the time series signal appears like a great tool to provide some understanding about a given signal. On the other hand, mapping network graphs communities back to original time series does not seem to bring much values: however, the features extracted from these networks graphs (see table above) look interesting to provide high quality features to a neural network. As one of the future area of investigation, we are interested into investigating how these tools could be applied to multivariate timeseries (especially highly dimensional ones as we can find in industrial settings with hundreds if not thousands of sensors per industrial equipment).", "These Markov transition fields and network graphs could be potentially used:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Industrial AI solution architect at AWS. Time series lover. Willing to support more stories? https://michoara.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F14eeb17ec4b0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://michalhoarau.medium.com/?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": ""}, {"url": "https://michalhoarau.medium.com/?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": "Micha\u00ebl HOARAU"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F397bc5293f03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&user=Micha%C3%ABl+HOARAU&userId=397bc5293f03&source=post_page-397bc5293f03----14eeb17ec4b0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F14eeb17ec4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F14eeb17ec4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://unsplash.com/@fabrizioverrecchia?utm_source=medium&utm_medium=referral", "anchor_text": "Fabrizio Verrecchia"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/michaelhoarau/mtf-deep-dive/blob/main/mtf-deep-dive.ipynb", "anchor_text": "companion Jupyter notebook"}, {"url": "https://github.com/johannfaouzi/pyts", "anchor_text": "pyts"}, {"url": "https://github.com/michaelhoarau/mtf-deep-dive/blob/main/mtf-deep-dive.ipynb", "anchor_text": "notebook"}, {"url": "https://en.wikipedia.org/wiki/Louvain_method", "anchor_text": "Louvain method"}, {"url": "https://python-louvain.readthedocs.io/en/latest/", "anchor_text": "here"}, {"url": "https://pypi.org/project/tsia/", "anchor_text": "tsia"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----14eeb17ec4b0---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/visualization-techniques?source=post_page-----14eeb17ec4b0---------------visualization_techniques-----------------", "anchor_text": "Visualization Techniques"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----14eeb17ec4b0---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----14eeb17ec4b0---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----14eeb17ec4b0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F14eeb17ec4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&user=Micha%C3%ABl+HOARAU&userId=397bc5293f03&source=-----14eeb17ec4b0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F14eeb17ec4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&user=Micha%C3%ABl+HOARAU&userId=397bc5293f03&source=-----14eeb17ec4b0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F14eeb17ec4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F14eeb17ec4b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----14eeb17ec4b0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----14eeb17ec4b0--------------------------------", "anchor_text": ""}, {"url": "https://michalhoarau.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://michalhoarau.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Micha\u00ebl HOARAU"}, {"url": "https://michalhoarau.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "241 Followers"}, {"url": "https://michoara.medium.com/membership", "anchor_text": "https://michoara.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F397bc5293f03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&user=Micha%C3%ABl+HOARAU&userId=397bc5293f03&source=post_page-397bc5293f03--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4158b9020338&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-visualization-techniques-for-time-series-analysis-14eeb17ec4b0&newsletterV3=397bc5293f03&newsletterV3Id=4158b9020338&user=Micha%C3%ABl+HOARAU&userId=397bc5293f03&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}