{"url": "https://towardsdatascience.com/model-validation-in-python-95e2f041f78c", "time": 1683013688.833015, "path": "towardsdatascience.com/model-validation-in-python-95e2f041f78c/", "webpage": {"metadata": {"title": "Model Validation in Python. Applying Train/Test Split, KFolds, and\u2026 | by Sadrach Pierre, Ph.D. | Towards Data Science", "h1": "Model Validation in Python", "description": "Scikit-learn is an open source machine learning library that provides tools for building, training and testing models. The model selection module has many functions that are useful for model testing\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/predicting-missing-values-with-python-41e581511117", "anchor_text": "Predicting Missing Values with Python", "paragraph_index": 5}, {"url": "https://github.com/spierre91/medium_code/blob/master/machine_learning/model_selection_python.py", "anchor_text": "GitHub", "paragraph_index": 21}], "all_paragraphs": ["Scikit-learn is an open source machine learning library that provides tools for building, training and testing models. The model selection module has many functions that are useful for model testing and validation. In this post, we will discuss some of the important model selection functions in scikit-learn.", "For our purposes, we will be working with The Wines Reviews data set, which can be found here.", "To start, let\u2019s read our data into a Pandas data frame:", "Next, let\u2019s print the first five rows of data:", "Let\u2019s consider the task of predicting whether wine price is more expensive than $50 based on the variety, winery, country and review points. We can build a random forest classifier to perform this task. First, let\u2019sconvert the categorical features into categorical codes that can be handled by random forests:", "Let\u2019s also impute missing values. We won\u2019t do any fancy imputing here but check out Predicting Missing Values with Python for a more reliable method of imputation. Here, let\u2019s replace missing values with 0:", "Next let\u2019s assign binary labels to price values based on whether they are greater than or equal to $50. Wines more than $50 have a label of \u20181\u2019, otherwise \u20180':", "Now, let\u2019s define our features and targets:", "The first function we\u2019ll discuss is the \u2018train_test_split()\u2019 method. This function split arrays or matrices into random train and test subsets. Let\u2019s import this function from scikit-learn:", "To split our function for training and testing we do the following:", "The default test size is 0.25. You can also change the size of the train/test split. For example, to change the test size to 0.3 we do the following:", "Next, we can train and test our random forest model:", "Let\u2019 evaluate the area under the receiver operating characteristic curve (AUROC):", "We can also look at the precision/recall curve and the average precision:", "Next let\u2019s discuss the \u2018KFold\u2019 method. This function provides train and test indices to split data into train and test sets. It splits the data into K folds either randomly or consecutively (default), and each fold is used once for validation while the remaining k-1 folds make up the training set. We\u2019ll use the default value for the number of folds, which is 5. Let\u2019s initialize a \u2018KFold\u2019 object, get the data splits, and initialize arrays for the predicted target values and true target values:", "If we want to change the number of folds from 5 to 10 we do:", "Next, let\u2019s train and test our model in a for-loop and append the results:", "Next we plot the ROC curve:", "Finally, let\u2019s discuss it the \u2018LeaveOneOut\u2019 method. This function provides train/test indices to split data for training and testing. Each sample is used once as a singleton test while the remaining samples are used for training. Here we initialize the \u2018LeaveOneOut\u2019 object and get the data splits as before:", "And we loop over the indices and append the results. Code is truncated for clarity:", "I\u2019ll stop here but I encourage you to play around with the functions yourself.", "To summarize, in this post we discussed how to use functions in the model selection module to validate models. First we discussed the train/test split function which randomly selects data for training and testing. We then discussed the \u2018K-Fold\u2019 function, which splits data into either consecutive or random folds for training and testing. Finally, we went over the \u2018LeaveOneOut\u2019 function which uses a singleton sample for testing and the remaining data for training for each sample in the data. I hope you found this post useful/interesting. The code in this post is available on GitHub. Thank you for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer for Built In & Towards Data Science. Cornell University Ph. D. in Chemical Physics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F95e2f041f78c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://spierre91.medium.com/?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681----95e2f041f78c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95e2f041f78c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95e2f041f78c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@pixabay", "anchor_text": "Pixabay"}, {"url": "https://www.pexels.com/photo/architecture-black-and-white-challenge-chance-277593/", "anchor_text": "Pexels"}, {"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/predicting-missing-values-with-python-41e581511117", "anchor_text": "Predicting Missing Values with Python"}, {"url": "https://github.com/spierre91/medium_code/blob/master/machine_learning/model_selection_python.py", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/data-science?source=post_page-----95e2f041f78c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----95e2f041f78c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----95e2f041f78c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----95e2f041f78c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/software-development?source=post_page-----95e2f041f78c---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95e2f041f78c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----95e2f041f78c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95e2f041f78c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=-----95e2f041f78c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95e2f041f78c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F95e2f041f78c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----95e2f041f78c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----95e2f041f78c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----95e2f041f78c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----95e2f041f78c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----95e2f041f78c--------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://spierre91.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sadrach Pierre, Ph.D."}, {"url": "https://spierre91.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F120b86134681&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=post_page-120b86134681--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4efebd4f21b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-validation-in-python-95e2f041f78c&newsletterV3=120b86134681&newsletterV3Id=4efebd4f21b7&user=Sadrach+Pierre%2C+Ph.D.&userId=120b86134681&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}