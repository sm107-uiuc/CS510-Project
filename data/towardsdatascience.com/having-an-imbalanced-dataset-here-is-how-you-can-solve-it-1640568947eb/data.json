{"url": "https://towardsdatascience.com/having-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb", "time": 1682995130.7823648, "path": "towardsdatascience.com/having-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb/", "webpage": {"metadata": {"title": "Having an Imbalanced Dataset? Here Is How You Can Fix It. | by Will Badr | Towards Data Science", "h1": "Having an Imbalanced Dataset? Here Is How You Can Fix It.", "description": "Classification is one of the most common machine learning problems. The best way to approach any classification problem is to start by analyzing and exploring the dataset in what we call Exploratory\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://github.com/wmlba/Fraud_Detection_Techniques/", "anchor_text": "HERE", "paragraph_index": 4}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/index.html", "anchor_text": "imbalanced-learn", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/why-feature-correlation-matters-a-lot-847e8ba439c4", "anchor_text": "the feature correlation really matters", "paragraph_index": 11}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.ensemble.BalancedBaggingClassifier.html#imblearn.ensemble.BalancedBaggingClassifier", "anchor_text": "BalancedBaggingClassifier", "paragraph_index": 13}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.ensemble.BalancedBaggingClassifier.html#imblearn.ensemble.BalancedBaggingClassifier", "anchor_text": "BalancedBaggingClassifier", "paragraph_index": 13}], "all_paragraphs": ["Classification is one of the most common machine learning problems. The best way to approach any classification problem is to start by analyzing and exploring the dataset in what we call Exploratory Data Analysis (EDA). The sole purpose of this exercise is to generate as many insights and information about the data as possible. It is also used to find any problems that might exist in the dataset. One of the common issues found in datasets that are used for classification is imbalanced classes issue.", "Data imbalance usually reflects an unequal distribution of classes within a dataset. For example, in a credit card fraud detection dataset, most of the credit card transactions are not fraud and a very few classes are fraud transactions. This leaves us with something like 50:1 ratio between the fraud and non-fraud classes. In this article, I will use the credit card fraud transactions dataset from Kaggle which can be downloaded from here.", "First, let\u2019s plot the class distribution to see the imbalance.", "As you can see, the non-fraud transactions far outweigh the fraud transactions. If we train a binary classification model without fixing this problem, the model will be completely biased. It also impacts the correlations between features and I will show you how and why later on.", "Now, let\u2019s cover a few techniques to solve the class imbalance problem. A notebook with the complete code can be found HERE", "This is as intuitive as it sounds. Undersampling is the process where you randomly delete some of the observations from the majority class in order to match the numbers with the minority class. An easy way to do that is shown in the code below:", "After undersampling the dataset, I plot it again and it shows an equal number of classes:", "The second resampling technique is called, Oversampling. This process is a little more complicated than undersampling. It is the process of generating synthetic data that tries to randomly generate a sample of the attributes from observations in the minority class. There are a number of methods used to oversample a dataset for a typical classification problem. The most common technique is called SMOTE (Synthetic Minority Over-sampling Technique). In simple terms, it looks at the feature space for the minority class data points and considers its k nearest neighbours.", "To code this in python, I use a library called imbalanced-learn or imblearn. The code below shows how to implement SMOTE.", "Remember when I said how imbalanced data would affect the feature correlation? Let me show you the correlation before and after treating the imbalanced class.", "The code below plots the correlation matrix between all the features.", "Notice that the feature correlation is much more obvious now. Before fixing the imbalance problem, most of the features did not show any correlation which would definitely have impacted the performance of the model. Since the feature correlation really matters to the overall model\u2019s performance, it is important to fix the imbalance as it will also impact the ML model performance.", "In Machine Learning, ensemble methods use multiple learning algorithms and techniques to obtain better performance than what could be obtained from any of the constituent learning algorithms alone. (Yes, just like a democratic voting system). When using ensemble classifiers, bagging methods become popular and it works by building multiple estimators on a different randomly selected subset of data. In the scikit-learn library, there is an ensemble classifier namedBaggingClassifier. However, this classifier does not allow to balance each subset of data. Therefore, when training on imbalanced data set, this classifier will favour the majority classes and create a biased model.", "In order to fix this, we can use BalancedBaggingClassifier from imblearn library. It allows the resampling of each subset of the dataset before training each estimator of the ensemble. Therefore, BalancedBaggingClassifier takes the same parameters as the scikit-learn BaggingClassifierin addition to two other parameters, sampling_strategy and replacement which control the behaviour of the random sampler. Here is some code that shows how to do this:", "That way, you can train a classifier that will handle the imbalance without having to undersample or oversample manually before training.", "In Conclusion, everyone should know that the overall performance of ML models built on imbalanced datasets, will be constrained by its ability to predict rare and minority points. Identifying and resolving the imbalance of those points is crucial to the quality and performance of the generated models.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Principal AI/ML Specialist @ Amazon Web Service"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1640568947eb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1640568947eb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1640568947eb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@will.badr?source=post_page-----1640568947eb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@will.badr?source=post_page-----1640568947eb--------------------------------", "anchor_text": "Will Badr"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F551ba3f6b67d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&user=Will+Badr&userId=551ba3f6b67d&source=post_page-551ba3f6b67d----1640568947eb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1640568947eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1640568947eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "here"}, {"url": "https://github.com/wmlba/Fraud_Detection_Techniques/", "anchor_text": "HERE"}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/over_sampling.html", "anchor_text": "https://imbalanced-learn.readthedocs.io/en/stable/over_sampling.html"}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/index.html", "anchor_text": "imbalanced-learn"}, {"url": "https://towardsdatascience.com/why-feature-correlation-matters-a-lot-847e8ba439c4", "anchor_text": "the feature correlation really matters"}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.ensemble.BalancedBaggingClassifier.html#imblearn.ensemble.BalancedBaggingClassifier", "anchor_text": "BalancedBaggingClassifier"}, {"url": "https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.ensemble.BalancedBaggingClassifier.html#imblearn.ensemble.BalancedBaggingClassifier", "anchor_text": "BalancedBaggingClassifier"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1640568947eb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1640568947eb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----1640568947eb---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----1640568947eb---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/analytics?source=post_page-----1640568947eb---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1640568947eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&user=Will+Badr&userId=551ba3f6b67d&source=-----1640568947eb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1640568947eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&user=Will+Badr&userId=551ba3f6b67d&source=-----1640568947eb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1640568947eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1640568947eb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1640568947eb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1640568947eb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1640568947eb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1640568947eb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1640568947eb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1640568947eb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1640568947eb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1640568947eb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1640568947eb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1640568947eb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@will.badr?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@will.badr?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Will Badr"}, {"url": "https://medium.com/@will.badr/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F551ba3f6b67d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&user=Will+Badr&userId=551ba3f6b67d&source=post_page-551ba3f6b67d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F811aaedd70bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhaving-an-imbalanced-dataset-here-is-how-you-can-solve-it-1640568947eb&newsletterV3=551ba3f6b67d&newsletterV3Id=811aaedd70bd&user=Will+Badr&userId=551ba3f6b67d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}