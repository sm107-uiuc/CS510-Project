{"url": "https://towardsdatascience.com/how-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802", "time": 1683018184.585846, "path": "towardsdatascience.com/how-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802/", "webpage": {"metadata": {"title": "Building recommender systems with Surprise. | Towards Data Science", "h1": "How you can build simple recommender systems with Surprise.", "description": "Surprise is an easy-to-use Python library that allows us to quickly build rating-based recommender systems without reinventing the wheel."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/zygmunt/goodbooks-10k", "anchor_text": "goodbooks-10k", "paragraph_index": 1}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "CC BY-SA 4.0", "paragraph_index": 1}, {"url": "https://github.com/AmolMavuduru/SurprisePythonExamples", "anchor_text": "GitHub", "paragraph_index": 5}, {"url": "http://snap.stanford.edu/class/cs246-2015/handouts.html", "anchor_text": "Stanford CS 246 lecture notes", "paragraph_index": 14}, {"url": "https://datapane.com/", "anchor_text": "Datapane", "paragraph_index": 29}, {"url": "https://github.com/AmolMavuduru/SurprisePythonExamples", "anchor_text": "GitHub", "paragraph_index": 32}, {"url": "https://mailchi.mp/e8dd82679724/amols-data-science-blog", "anchor_text": "mailing list", "paragraph_index": 34}, {"url": "https://mailchi.mp/e8dd82679724/amols-data-science-blog", "anchor_text": "sign up", "paragraph_index": 34}], "all_paragraphs": ["If you\u2019ve ever worked on a data science project, you probably have a default library that you use for standard tasks. Most people will probably use Pandas for data manipulation, Scikit-learn for general-purpose machine learning applications, and TensorFlow or PyTorch for deep learning. But what would you use to build a recommender system? This is where Surprise comes into play.", "Surprise is an open-source Python library that makes it easy for developers to build recommender systems with explicit rating data. In this article, I will show you how you can use Surprise to build a book recommendation system using the goodbooks-10k dataset available on Kaggle under the CC BY-SA 4.0 license.", "You can install Surprise with pip using the following command.", "If you would prefer to use Anaconda for package management, you can use the following command to install Surprise with Anaconda.", "If you want to install the latest version of the library directly from GitHub, you should use the following commands (you will need Numpy and Cython).", "You can find the entire code for this practical example on GitHub.", "To get started, I just imported some basic libraries for data manipulation and visualization.", "I used two CSV files from the goodbooks-10k dataset available on Kaggle. The first one contains rating data for 10,000 books rated by over 53,000 users. The second file contains the metadata (title, author, ISBN, etc.) for each of the 10,000 books.", "In order to train recommender systems with Surprise, we need to create a Dataset object. A Surprise Dataset object is a dataset that contains the following fields in this order:", "We can train and cross-validate a model that performs SVD (singular value decomposition) in order to build a recommendation system in just a few lines of code. SVD is a popular matrix factorization algorithm that can be used for recommender systems.", "Recommender systems that use matrix factorization generally follow a pattern where a matrix of ratings is factored into a product of matrices representing latent factors for the items (in this case books) and the users.", "Considering the figure above, notice how the rating matrix, R, has missing values in some places. The matrix factorization algorithm uses a procedure such as gradient descent to minimize the error when predicting existing ratings using the matrix factors. Thus, an algorithm like SVD builds a recommendation system by allowing us to \u201cfill in the gaps\u201d in the rating matrix, predicting the ratings that each user would assign to each item in the dataset.", "Starting with an input matrix A, SVD actually factorizes the original matrix into three matrices as demonstrated in the equation below.", "We can map these new matrices to the rating matrix R and the item and user factors Q and P as follows:", "In the case of our book recommendation system, the SVD algorithm will represent the rating matrix as a product of matrices representing the book factors and user factors respectively. Of course, this is a very brief explanation of the SVD algorithm without all of the mathematical details but if you want a more detailed explanation of this algorithm, you should check out the Stanford CS 246 lecture notes.", "In the code below, I cross-validated an SVD model using three-fold cross-validation.", "Running the code above produced the following output.", "We can also train the model on the entire dataset using the fit method after converting the dataset for cross-validation into a Surprise Trainset object using the build_full_trainset method.", "Now that we have a trained SVD model, we can use it to predict the rating a user would assign to a book given an ID for the user (UID) and an ID for the item/book (IID). The code below demonstrates how to do this with the predict method.", "The predict method returns the Prediction shown below, which contains a field called est that indicates the estimated book rating for this specific user.", "Based on the output above, we can see that the model predicted that this specific user would give a four-star rating (roughly) to the book corresponding to an IID of 100. The model doesn\u2019t directly recommend books, but we can use this rating prediction utility to identify what books a user would likely enjoy, which allows us to justify recommending them to a user.", "Using this rating prediction utility, I defined the following utility functions below for generating book recommendations.", "The generate_recommendation function generates a book recommendation for a user by iterating through the shuffled list of book titles and predicting the user ratings for each title until it finds a book with a rating at or above the specified threshold that qualifies it for being recommended to a user. Shuffling the book titles at the beginning adds some randomness to the book recommendation.", "Running the function as demonstrated above produced the output below (note that due to the randomness of the function, you may get a different recommendation).", "Based on the output above, we can see that the function returns a dictionary with metadata about the book that was recommended. Running this function multiple times will produce multiple book recommendations. After a user reviews a book, we can add that data to the rating data and retrain the model to produce an even better recommender system.", "We can take this project a step further and actually visualize the similarity between books based on the book factor matrix, referred to as Q in the previous diagram used to explain matrix factorization models.", "This 10,000 x 100 matrix has a 100-dimensional vector for each book, which is too many dimensions for us to visualize intuitively, but we can use a dimensionality reduction technique to represent each book as a two-dimensional point in space. In the code below, I used a technique called t-SNE (t-Distributed Stochastic Neighbors Embedding) to represent each book as a two-dimensional point and stored the results in a data frame.", "After creating this data frame with two-dimensional points for each book, I used Plotly to create a visualization with each point corresponding to a book in the original dataset.", "Based on the plot produced above by the Plotly code, we can see that the points representing the 10,000 books seem to follow a two-dimensional normal distribution. We can explain this distribution with the following theories about the books in the dataset:", "To actually look at the book titles associated with each point, I defined a specific function for plotting a list of books given their titles. Note that I used Datapane to display the visualizations embedded in this article. In the code below, I added a function argument for publishing the resulting plot as a Datapane report.", "Using the code below, I plotted the points associated with the first 30 books in the dataset.", "This visualization allows us to see the similarities between different books. Books located closer to each other tend to perform similarly when it comes to ratings provided by similar users. For example, we can see that Catching Fire and Divergent, two novels from the Hunger Games and Divergent series respectively, were popular among similar users.", "As mentioned earlier, I have included the code for all of the examples in this article on GitHub.", "Do you want to get better at data science and machine learning? Do you want to stay up to date with the latest libraries, developments, and research in the data science and machine learning community?", "Join my mailing list to get updates on my data science content. You\u2019ll also get my free Step-By-Step Guide to Solving Machine Learning Problems when you sign up!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb0d32a8e4802&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://amolmavuduru.medium.com/?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": "Amol Mavuduru"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511816e5976d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&user=Amol+Mavuduru&userId=511816e5976d&source=post_page-511816e5976d----b0d32a8e4802---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0d32a8e4802&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0d32a8e4802&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@2hrrc?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Hugo Ruiz"}, {"url": "https://unsplash.com/s/photos/confetti?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/zygmunt/goodbooks-10k", "anchor_text": "goodbooks-10k"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "CC BY-SA 4.0"}, {"url": "https://github.com/AmolMavuduru/SurprisePythonExamples", "anchor_text": "GitHub"}, {"url": "http://snap.stanford.edu/class/cs246-2015/handouts.html", "anchor_text": "Stanford CS 246 lecture notes"}, {"url": "https://datapane.com/", "anchor_text": "Datapane"}, {"url": "https://github.com/AmolMavuduru/SurprisePythonExamples", "anchor_text": "GitHub"}, {"url": "https://mailchi.mp/e8dd82679724/amols-data-science-blog", "anchor_text": "mailing list"}, {"url": "https://mailchi.mp/e8dd82679724/amols-data-science-blog", "anchor_text": "sign up"}, {"url": "https://www.kaggle.com/zygmunt/goodbooks-10k", "anchor_text": "Goodbooks-10k dataset"}, {"url": "http://snap.stanford.edu/class/cs246-2015/handouts.html", "anchor_text": "Stanford CS 246 Mining Massive Datasets Lecture Notes"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b0d32a8e4802---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b0d32a8e4802---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/statistics?source=post_page-----b0d32a8e4802---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/open-source?source=post_page-----b0d32a8e4802---------------open_source-----------------", "anchor_text": "Open Source"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0d32a8e4802&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&user=Amol+Mavuduru&userId=511816e5976d&source=-----b0d32a8e4802---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0d32a8e4802&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&user=Amol+Mavuduru&userId=511816e5976d&source=-----b0d32a8e4802---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0d32a8e4802&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb0d32a8e4802&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b0d32a8e4802---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b0d32a8e4802--------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Amol Mavuduru"}, {"url": "https://amolmavuduru.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "565 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511816e5976d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&user=Amol+Mavuduru&userId=511816e5976d&source=post_page-511816e5976d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f3b67de8f9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-you-can-build-simple-recommender-systems-with-surprise-b0d32a8e4802&newsletterV3=511816e5976d&newsletterV3Id=1f3b67de8f9c&user=Amol+Mavuduru&userId=511816e5976d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}