{"url": "https://towardsdatascience.com/tune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31", "time": 1683014325.738164, "path": "towardsdatascience.com/tune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31/", "webpage": {"metadata": {"title": "Tune the hyperparameters of your deep learning networks in Python using Keras and Talos | by Yefeng Xia | Towards Data Science", "h1": "Tune the hyperparameters of your deep learning networks in Python using Keras and Talos", "description": "With the development of Deep Learning frameworks, it\u2019s more convenient and easy for many people to design the architecture for an artificial neural network. The 3 most popular frameworks, Tensorflow\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pypi.org/project/talos/", "anchor_text": "Talos", "paragraph_index": 10}, {"url": "https://www.kaggle.com/tongpython/cat-and-dog", "anchor_text": "Kaggle", "paragraph_index": 12}], "all_paragraphs": ["With the development of Deep Learning frameworks, it\u2019s more convenient and easy for many people to design the architecture for an artificial neural network. The 3 most popular frameworks, Tensorflow, Keras, and Pytorch, are used more frequently. To improve the performance of our neural networks, there are many approaches, e.g. improve the data quality, using data augmentation. However, data quality is the source of data science. To get better data quality is usually extra expensive, time- and human resource-consuming. Therewith, we prefer to handle the hyperparameters/parameters of a model\ud83c\udfc4\ud83c\udffc.", "A model parameter is a configuration variable that is internal to the model. It\u2019s dependent on the model\u2019s training data. The parameter of a model can be estimated by fitting the given data to the model.", "A model hyperparameter is a configuration that is external to the model. The hyperparameters are to help us find model parameters, which are not dependent on training data.", "On the contrary, we find the model\u2019s parameter by setting a series of hyperparameters properly, which optimize the training process and make the best use of data. It means that we can manually give hyperparameters values and they can\u2019t be updated during the training. But parameters are something instinct of the model, which updates continuously during the training.", "An inappropriate analogy, if we regard a student as a model, his knowledge, characters, skills are more like the model\u2019s parameter. The way we train him to get these abilities and features can be treated as hyperparameters.", "Since Hyperparameters are the key to the model\u2019s parameters, we should pay a lot of attention to them. How to select the model\u2019s hyperparameters? To deal with the question requires enough knowledge and patience.", "There are typically 5 different optimization techniques:", "In our work, we used often grid search. Grid search suffers from high dimensional spaces, but often can easily be parallelized, since the hyperparameter values that the algorithm works with are usually independent of each other. Besides, we write the code on the platform Colab, which allows us to write and execute Python in your browser:", "If you want to quickly build and test a neural network with minimal lines of code, then Keras is what you need. Keras is an open-source neural network library written in Python that is an API designed for human beings, not machines. Since Tensorflow 2 comes up with a tight integration of Keras and an intuitive high-level API tf. keras, there are 2 ways to use Keras, either directly import Keras or from tf import Keras.", "Talos was released on May 11, 2018 and has since been upgraded seven times. When running the code with Talos in the scan-command, all possible combinations are tested in an experiment.", "Important: Talos radically changes the ordinary Keras workflow by fully automating hyperparameter tuning and model evaluation. Talos exposes Keras functionality entirely and there is no new syntax or templates to learn.", "we can install talos with one line of command:", "To make our result visible and intuitive, we take a simple case to classify whether images contain either a dog or a cat with CNN, the ancient problem in Computer Vision\ud83d\ude06. I downloaded the image dataset from Kaggle. The dataset is in the ZIP file format after you download it from the link.", "We can use a few lines of code to unzip the file directly in Google Colab.", "Here we use LeNet-5, which is the 22-year-old neural network, usually as a teaching sample.", "Now we start our code for building LeNet-5 with Keras. To get reproducible results in Keras, setting the random seeds is necessary.", "Then we can focus on the image data. We need to read them with keras.preprocessing.image into train and validation array, which flow in CNN later for training and validation. There must be a uniform size for all pictures, e.g. (100,100,3). Although images of dogs or cats in the dataset are different with size, some big and some small, we can make them with equal-size by resizing.", "with the above code, all \u201cdogs\u201d and \u201ccats\u201d are in Array, either train set or validation set. Additionally, we label dogs with digit 1 and cats with digit 0.", "Next, we encode categorical integer features 0 and 1 using a one-hot-encoding.", "The data must be normalized so that the model can be converged faster.", "Here we trained the model for 10 epochs and defined batch_size 200.", "After a long time waiting, we can get a training/validation diagram.", "The above diagram shows that the model improves not much after 5 epochs. But it hasn\u2019t overfitted. Therefore we can still use the obtained model.", "We want to make more efforts to train a better LeNet-5 model for our dog-cat classifier, so we focus on the model\u2019s hyperparameters to improve the model\ud83c\udf91.", "Here we define a new function that has the same structure as LeNet-5, but some hyperparameters in the model are variable. We save these variable hyperparameters in the dictionary \u201cp\u201d.", "To reduce the computer calculation and program running time, in the dictionary we have only set \u2018opt\u2019 and \u2018dropout\u2019 variable, optimizer with 2 options (Adam or sgd) and dropout with 2 possible values. There is a total of 4 combinations.", "With the help of the Scan command (talos.Scan), we start configuring the experiment. It will last a longer time than training the last basic LeNet-5 model.", "The experiment reports are saved in csv. file format. we can read the csv. file to show the results in the table.", "By plotting the validation_accuracy (top) and validation_loss (bottom), we can conclude that the trained models of the zeroth and third experiments are much better than those of the second and fourth experiments. Comparing the experimental parameter information, we found the models with adam have a better performance. The dropout method played a little roll in training LeNet-5.", "All things considered, the model 0 has the best performance, which uses Adam but doesn\u2019t have a dropout.", "In this story, we introduced how to use talos to tune hyperparameters of a with Keras built CNN. In the beginning, there is some basic knowledge for parameters and hyperparameters, and a review of usual methods to optimize hyperparameters. In the rest of the story, we built a LeNet-5 based cat-dog classifier and scanned all hyperparameter combinations of interest. by observing the metric of validation, we can know which hyperparameter has the most influence and which combination gives the best result\ud83c\udfc1.", "The code is available in my GitHub\ud83d\ude2c", "Van Rijn, J. N., & Hutter, F. (2018, July). Hyperparameter importance across datasets. In Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining (pp. 2367\u20132376).", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2a2a38c5ac31&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yefengxia.medium.com/?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": ""}, {"url": "https://yefengxia.medium.com/?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": "Yefeng Xia"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b9554572002&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&user=Yefeng+Xia&userId=2b9554572002&source=post_page-2b9554572002----2a2a38c5ac31---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a2a38c5ac31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a2a38c5ac31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mariogogh", "anchor_text": "Mario Gogh"}, {"url": "https://pypi.org/project/talos/", "anchor_text": "Talos"}, {"url": "https://www.kaggle.com/tongpython/cat-and-dog", "anchor_text": "Kaggle"}, {"url": "https://unsplash.com/@hanialistek?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Hanna Listek"}, {"url": "https://unsplash.com/s/photos/cat-and-dog?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "http://vision.stanford.edu/cs598_spring07/papers/Lecun98.pdf", "anchor_text": "LeNet-5 Architecture"}, {"url": "https://github.com/Kopfgeldjaeger/Medium_blogs_code/tree/master/2_talos_grid_search", "anchor_text": "https://github.com/Kopfgeldjaeger/Medium_blogs_code/tree/master/2_talos_grid_search"}, {"url": "https://autonomio.github.io/docs_talos", "anchor_text": "Talos User ManualWelcome to Talos! You can use Talos for hyperparameter optimization with Keras models. Talos allows you to use Keras\u2026autonomio.github.io"}, {"url": "https://keras.io/", "anchor_text": "Keras: the Python deep learning APIKeras is an API designed for human beings, not machines. Keras follows best practices for reducing cognitive load: it\u2026keras.io"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2a2a38c5ac31---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----2a2a38c5ac31---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----2a2a38c5ac31---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/programming?source=post_page-----2a2a38c5ac31---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----2a2a38c5ac31---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2a2a38c5ac31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&user=Yefeng+Xia&userId=2b9554572002&source=-----2a2a38c5ac31---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2a2a38c5ac31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&user=Yefeng+Xia&userId=2b9554572002&source=-----2a2a38c5ac31---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2a2a38c5ac31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2a2a38c5ac31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2a2a38c5ac31---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2a2a38c5ac31--------------------------------", "anchor_text": ""}, {"url": "https://yefengxia.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yefengxia.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yefeng Xia"}, {"url": "https://yefengxia.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "59 Followers"}, {"url": "http://linkedin.com/in/yefeng-xia-1993dec/", "anchor_text": "linkedin.com/in/yefeng-xia-1993dec/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2b9554572002&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&user=Yefeng+Xia&userId=2b9554572002&source=post_page-2b9554572002--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fec627c5a6505&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftune-the-hyperparameters-of-your-deep-learning-networks-in-python-using-keras-and-talos-2a2a38c5ac31&newsletterV3=2b9554572002&newsletterV3Id=ec627c5a6505&user=Yefeng+Xia&userId=2b9554572002&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}