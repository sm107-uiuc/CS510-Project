{"url": "https://towardsdatascience.com/10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977", "time": 1683009606.984373, "path": "towardsdatascience.com/10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977/", "webpage": {"metadata": {"title": "10 Minutes to Building a Machine Learning Pipeline with Apache Airflow | by Binh Phan | Towards Data Science", "h1": "10 Minutes to Building a Machine Learning Pipeline with Apache Airflow", "description": "Learn how to easily build a simple ML pipeline using Apache AirFlow. This is meant for beginners who want an introduction to ML pipelines and AirFlow."}, "outgoing_paragraph_urls": [{"url": "https://papers.nips.cc/paper/5656-hidden-technical-debt-in-machine-learning-systems", "anchor_text": "reduce the technical debt of a machine learning system", "paragraph_index": 2}, {"url": "https://cloud.google.com/solutions/machine-learning/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning", "anchor_text": "MLOps", "paragraph_index": 2}, {"url": "https://github.com/fastai/fastai", "anchor_text": "FastAI", "paragraph_index": 3}, {"url": "https://www.starlette.io/", "anchor_text": "Starlette", "paragraph_index": 3}, {"url": "https://airflow.apache.org/", "anchor_text": "Apache AirFlow", "paragraph_index": 3}, {"url": "https://github.com/spotify/luigi", "anchor_text": "Luigi", "paragraph_index": 3}, {"url": "https://mlflow.org/", "anchor_text": "MLFlow", "paragraph_index": 3}, {"url": "https://www.kubeflow.org/", "anchor_text": "KubeFlow", "paragraph_index": 3}, {"url": "http://cloud.google.com/", "anchor_text": "Google Cloud Platform", "paragraph_index": 6}, {"url": "https://cloud.google.com/compute/docs/instances/create-start-instance", "anchor_text": "Compute Engine and create an instance", "paragraph_index": 7}, {"url": "http://docker.com/", "anchor_text": "Docker", "paragraph_index": 15}, {"url": "https://docs.docker.com/engine/install/ubuntu/", "anchor_text": "here", "paragraph_index": 15}, {"url": "http://nginx.org/", "anchor_text": "nginx", "paragraph_index": 16}, {"url": "https://towardsdatascience.com/10-minutes-to-deploying-a-deep-learning-model-on-google-cloud-platform-13fa56a266ee?source=friends_link&sk=a863a2489ef040af125526669097d57d", "anchor_text": "tutorial", "paragraph_index": 24}], "all_paragraphs": ["Often, when you think about Machine Learning, you tend to think about the great models that you can now create. If you want to take these amazing models and make them available to the world, you will have to move beyond just training the model and incorporating data collection, feature engineering, training, evaluating, and serving.", "On top of all that, you will also have to remember that you\u2019re putting a software application into production. That means you\u2019ll have all the requirements that any production software has, including scalability, consistency, modularity, testability, and security.", "A ML pipeline allows you to automatically run the steps of a Machine Learning system, from data collection to model serving (as shown in the photo above). It will also reduce the technical debt of a machine learning system, as this linked paper describes. This segues into the fields of MLOps, a fast-growing field that, similar to DevOps, (aims to automate and monitor all steps of the ML System.", "This tutorial will show you how to build a simple ML pipeline that automates the workflow of a deep learning image classifier for dandelions and grass built using FastAI, and then served as a web app using Starlette. We\u2019ll use Apache AirFlow, out of the many workflow tools like Luigi, MLFlow, and KubeFlow, because it provides an extensive set of features and a beautiful UI. AirFlow is open-source software that allows you to programmatically author and schedule your workflows using a directed acyclic graph (DAG) and monitor them via the built-in Airflow user interface. At the end of the tutorial, I\u2019ll show you further steps you can take to make your pipeline production-ready.", "Requirements: Since you will run this tutorial on a VM instance, all you will need is a computer running any OS, and a Google account.", "This tutorial will be broken down into the following steps:", "If you haven\u2019t already, sign up for Google Cloud Platform through your Google account. You\u2019ll have to enter your credit card, but you won\u2019t be charged anything upon signing up. You\u2019ll also get $300 worth of free credits that last for 12 months! If you\u2019ve run out of credits, don\u2019t worry \u2014 running this tutorial will cost pennies, provided you stop your VM instance afterward!", "Once you\u2019re in the console, go to Compute Engine and create an instance. Then:", "When your instance has been created and is running, SSH into your instance by clicking on the SSH button located on the right side of the screen.", "Let\u2019s pull the tutorial contents from Github. Clone the repo from Github by typing this into the VM instance:", "Let\u2019s explore the contents of this Git repository. First, let\u2019s explore the AirFlow configuration file, /config/airflow.cfg. It sets all of the configuration options for your AirFlow pipeline, including the location of your airflow pipelines (in this case, we set this folder to be /dags/, and where we connect to our metadata database, sql_alchemy_conn. AirFlow uses a database to store metadata about DAGs, their runs, and other Airflow configurations like users, roles, and connections. Think of it like saving your progress in a video game.", "Next, let\u2019s explore the ML pipeline, which is defined in /dags/ml_pipeline.py.", "What this Python script does is define our directed acyclic graph structure as code, including the tasks that we want to execute and their ordering.", "Let\u2019s break down the code in ml_pipeline.py:", "I encourage you to take a look at the python scripts for each of the tasks!", "Docker allows you to run software in containers, which is virtual environments running their own OS, making it easy to bundle software and their required packages reliably and easily. That\u2019s exactly why we\u2019re going to run our tutorial using Docker. First, let\u2019s install Docker on our VM by running a Bash script from the Docker website (or you can manually install Docker here):", "Then, you\u2019ll need to set up virtual hosts using nginx, an open-source web server software. Since I\u2019m planning on using two ports in the Docker container, one for the AirFlow UI, and one for the final web app, and only have 1 public IP address (the external address of our compute instance), you will use nginx to route HTTP requests to our external IP address. Route from AirFlow on port 8080 to our default port 80 using this script:", "Now, let\u2019s build the Docker container using the following command:", "This will run the Dockerfile in our directory and download and install the necessary libraries for our container.", "Be patient \u2014 this will take around 10 minutes.", "After a few seconds, visit the external IP address of your machine, which you can find on Compute Engine in the GCP console. Make sure when you enter it in your browser, to prefix the IP address with http:// like this: http://34.68.160.231/", "You should now see the AirFlow user interface:", "Now, click the Off switch, and click the left-most button, Trigger DAG. The pipeline will now be running, and when you click ml_pipeline and go to the Tree section, you\u2019ll see the directed acyclic graph and also the status of the pipeline:", "After a few minutes, the last task, serve, will be running. Your ML pipeline has been successfully executed! Now, let\u2019s have nginx route our app from port 8008 to our external IP address:", "You will now see the final web app, greenr, running! If you are interested in learning how to build and deploy greenr, check out my tutorial on deploying a deep learning model on Google Cloud Platform!", "In this tutorial, you learned how to build a simple Machine Learning pipeline in Apache AirFlow consisting of three tasks: download images, train, and serve. Certainly, this can be improved to be more production-ready and scalable. Here are some suggestions on how to take your pipeline further:", "I hope this gives you a gentle introduction to building ML pipelines on Apache AirFlow and that this can serve as a template for your work!", "Don\u2019t forget to turn off your compute instance to ensure that you don\u2019t get charged for usage by Google Cloud!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Engineer, prev @ Apple, MSEE @ USC, relentless optimist"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F53cd09268977&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----53cd09268977--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----53cd09268977--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@btphan95?source=post_page-----53cd09268977--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@btphan95?source=post_page-----53cd09268977--------------------------------", "anchor_text": "Binh Phan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fba6bd545bb5c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&user=Binh+Phan&userId=ba6bd545bb5c&source=post_page-ba6bd545bb5c----53cd09268977---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53cd09268977&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53cd09268977&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jaimiephillips?utm_source=medium&utm_medium=referral", "anchor_text": "Jaimie Phillips"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://papers.nips.cc/paper/5656-hidden-technical-debt-in-machine-learning-systems", "anchor_text": "reduce the technical debt of a machine learning system"}, {"url": "https://cloud.google.com/solutions/machine-learning/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning", "anchor_text": "MLOps"}, {"url": "https://github.com/fastai/fastai", "anchor_text": "FastAI"}, {"url": "https://www.starlette.io/", "anchor_text": "Starlette"}, {"url": "https://airflow.apache.org/", "anchor_text": "Apache AirFlow"}, {"url": "https://github.com/spotify/luigi", "anchor_text": "Luigi"}, {"url": "https://mlflow.org/", "anchor_text": "MLFlow"}, {"url": "https://www.kubeflow.org/", "anchor_text": "KubeFlow"}, {"url": "http://cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://cloud.google.com/compute/docs/instances/create-start-instance", "anchor_text": "Compute Engine and create an instance"}, {"url": "https://github.com/btphan95/greenr-tutorial", "anchor_text": "https://github.com/btphan95/greenr-"}, {"url": "https://github.com/btphan95/greenr-tutorial", "anchor_text": "greenr-"}, {"url": "http://docker.com/", "anchor_text": "Docker"}, {"url": "https://docs.docker.com/engine/install/ubuntu/", "anchor_text": "here"}, {"url": "https://get.docker.com/", "anchor_text": "https://get.docker.com/"}, {"url": "http://nginx.org/", "anchor_text": "nginx"}, {"url": "https://towardsdatascience.com/10-minutes-to-deploying-a-deep-learning-model-on-google-cloud-platform-13fa56a266ee?source=friends_link&sk=a863a2489ef040af125526669097d57d", "anchor_text": "tutorial"}, {"url": "https://airflow.apache.org/docs/stable/kubernetes.html", "anchor_text": "KubernetesOperator"}, {"url": "https://airflow.apache.org/docs/stable/executor/celery.html", "anchor_text": "CeleryExecutor"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----53cd09268977---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/devops?source=post_page-----53cd09268977---------------devops-----------------", "anchor_text": "DevOps"}, {"url": "https://medium.com/tag/mlops?source=post_page-----53cd09268977---------------mlops-----------------", "anchor_text": "Mlops"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----53cd09268977---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/tag/pipeline?source=post_page-----53cd09268977---------------pipeline-----------------", "anchor_text": "Pipeline"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F53cd09268977&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&user=Binh+Phan&userId=ba6bd545bb5c&source=-----53cd09268977---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F53cd09268977&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&user=Binh+Phan&userId=ba6bd545bb5c&source=-----53cd09268977---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53cd09268977&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----53cd09268977--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F53cd09268977&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----53cd09268977---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----53cd09268977--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----53cd09268977--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----53cd09268977--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----53cd09268977--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----53cd09268977--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----53cd09268977--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----53cd09268977--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----53cd09268977--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@btphan95?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@btphan95?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Binh Phan"}, {"url": "https://medium.com/@btphan95/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "183 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fba6bd545bb5c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&user=Binh+Phan&userId=ba6bd545bb5c&source=post_page-ba6bd545bb5c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F46a91ac59486&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F10-minutes-to-building-a-machine-learning-pipeline-with-apache-airflow-53cd09268977&newsletterV3=ba6bd545bb5c&newsletterV3Id=46a91ac59486&user=Binh+Phan&userId=ba6bd545bb5c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}