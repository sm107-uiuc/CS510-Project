{"url": "https://towardsdatascience.com/proper-validation-of-a-time-series-model-5c1b54f43e60", "time": 1683013096.592194, "path": "towardsdatascience.com/proper-validation-of-a-time-series-model-5c1b54f43e60/", "webpage": {"metadata": {"title": "Proper validation of a Time-Series model | by Agnis Liukis | Towards Data Science", "h1": "Proper validation of a Time-Series model", "description": "In this article, I\u2019ll go through several set-ups on how to evaluate machine learning model performance on time-series data. There are several ways how to do it correctly. But there are also many ways\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/approaching-time-series-with-a-tree-based-model-87c6d1fb6603", "anchor_text": "Approaching time-series with a tree-based model", "paragraph_index": 0}, {"url": "https://www.kaggle.com/alijs1", "anchor_text": "https://www.kaggle.com/alijs1", "paragraph_index": 25}], "all_paragraphs": ["In this article, I\u2019ll go through several set-ups on how to evaluate machine learning model performance on time-series data. There are several ways how to do it correctly. But there are also many ways how to do it wrong. I\u2019ll give some examples of both. For all the examples here I\u2019ll be using time-series and model described in my previous article about Approaching time-series with a tree-based model, but approaches described here are general and work as well for other models.", "So we have a model for time-series predictions and now want to see, how good it is performing. The common approach to this is to use a validation set. This set is not used for training, just for assessing the quality of predictions, that way providing a trustful way to evaluate model performance on unseen future data.", "For simple tabular data, a typical way is to choose validation holdout set randomly or to use cross-validation with several folds. However, doing this for time-series might not be what we want. The reason is that by selecting random data points for validation, we might end up having training data more recent than validation. Basically, we would train on the future data and predict the past. Which is not exactly what we are expecting from our model to do in practice.", "Therefore a more typical approach for time-series is to make a selection by time, taking the most recent data as a validation set, as seen in the visualization below.", "So far everything seems simple and straight forward, however, let\u2019s look closer at the validation part.", "We have one month for validation data in a given example. Everything is clear for the first day of the validation period. We have full continuous historical data of previous data points, can calculate all the features the same way as for training data. But now let\u2019s take a look at the second day in the validation period. If we would like to predict the value two days ahead, this means we are missing the truth value for one day. See the visualization below for better understanding of the problem.", "Training data were continuous but now in validation set, we have a gap. And in real/test data we will have this gap as well, if we want to predict value 2 or more steps ahead. For validation data we actually know the real value for that data point, but is it a good idea to use it if we can\u2019t do the same for real future data? For the model to be accurate, and for validation to be trustworthy, we need to make training, validation, and real/test data to be as similar as possible.", "There are basically 3 possible solutions to this:", "Let\u2019s go through all of these.", "This means we are using part of validation data (data points prior to the current point being predicted) for generating features. Which in turn means that we assume that we know these truth values at the time of predictions. For real future data, this is possible only if we make a prediction just one step ahead.", "If we are using historical validation set data points for calculating features, this simulates a situation when our model is always predicting value only one step ahead.", "Either this approach is valid or not, that in reality is dictated by the business. If our real model will predict values only one step ahead (e.g. each day predicts only the number of visitors for tomorrow), then such validation set-up is perfectly fine.", "But if in reality, we want to get predictions for the next full month, such validation scheme will overfit, and estimated model accuracy will be too optimistic.", "In this case, we are doing predictions in a loop. First, we predict the value for the first day of the validation set. Then we predict the value for the second day, using our first prediction as a real value to fill the gap. And in a similar way we go through all the validation set, predicting days one by one, using previous predictions from previous days as real values.", "The good news is that we can do exactly the same for real/test data. So validation score will be representative of the real model performance.", "However, there is one obvious issue \u2014 by using previous predictions as real values we make a model believe they are correct. But they absolutely for sure won\u2019t be perfect. So in this way we are introducing a difference in validation data vs training data. In training data all the historical values were the truth, but in validation data part of historical values are actually not the truth, but just predictions with some error.", "Using predictions from previous data points when predicting further values can result in errors for predictions being accumulated, resulting in very poor performance for later validation days.", "This approach could be acceptable as a validation method in case if we are using the same approach for making predictions for real future data. In this case, validation score will match real model performance and from a validation perspective, this will be acceptable. But we must be aware, that predictions accuracy can decrease significantly for farther future predictions.", "This means we are using different model and features for each day prediction. For predicting the first day of validation set we are using a model trained on full training data. For predicting the second day of the validation set, we train a model on features, calculated with one day skipped from training data. And for each of the following days, we use a model trained on features with a corresponding number of skipped days in training.", "In this schema, the data model is trained on, is consistent with the data for making predictions. Also, validation score will be representative for unseen future data predictions. The main drawback of this approach is many models needed, which require more time needed for preparing multiple feature-sets and training multiple models.", "Using different model and feature-set for each validation day predictions may be the most convenient approach, but also the most costly in terms of computational resources.", "At last, I would like to give the list of typical mistakes and things you should be aware of and avoid when doing time-series validation:", "There are several schemes for how to do time-series validation. Each of them has some specifics and in each case the best choice may depend on the problem itself and business specifics/requirements.", "Thanks for reading and hopefully this article gave you some better intuition about time-series models validation and how to avoid some typical mistakes.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Architect, Data Scientist, Kaggle Grandmaster (https://www.kaggle.com/alijs1). Sometimes I write about Python, Data Science and Machine Learning\u2026"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5c1b54f43e60&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://agnis-liukis.medium.com/?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": ""}, {"url": "https://agnis-liukis.medium.com/?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": "Agnis Liukis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fce835d44241e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&user=Agnis+Liukis&userId=ce835d44241e&source=post_page-ce835d44241e----5c1b54f43e60---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c1b54f43e60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c1b54f43e60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/approaching-time-series-with-a-tree-based-model-87c6d1fb6603", "anchor_text": "Approaching time-series with a tree-based model"}, {"url": "https://unsplash.com/@sernarial?utm_source=medium&utm_medium=referral", "anchor_text": "patricia serna"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5c1b54f43e60---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5c1b54f43e60---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----5c1b54f43e60---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/validation?source=post_page-----5c1b54f43e60---------------validation-----------------", "anchor_text": "Validation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c1b54f43e60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&user=Agnis+Liukis&userId=ce835d44241e&source=-----5c1b54f43e60---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c1b54f43e60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&user=Agnis+Liukis&userId=ce835d44241e&source=-----5c1b54f43e60---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c1b54f43e60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5c1b54f43e60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5c1b54f43e60---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5c1b54f43e60--------------------------------", "anchor_text": ""}, {"url": "https://agnis-liukis.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://agnis-liukis.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Agnis Liukis"}, {"url": "https://agnis-liukis.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "205 Followers"}, {"url": "https://www.kaggle.com/alijs1", "anchor_text": "https://www.kaggle.com/alijs1"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fce835d44241e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&user=Agnis+Liukis&userId=ce835d44241e&source=post_page-ce835d44241e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7a6d1b0d1a83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproper-validation-of-a-time-series-model-5c1b54f43e60&newsletterV3=ce835d44241e&newsletterV3Id=7a6d1b0d1a83&user=Agnis+Liukis&userId=ce835d44241e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}