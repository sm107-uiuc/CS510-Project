{"url": "https://towardsdatascience.com/global-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1", "time": 1683005873.717538, "path": "towardsdatascience.com/global-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1/", "webpage": {"metadata": {"title": "Global Covid-19 Forecasting | Towards Data Science", "h1": "Global Covid-19 Forecasting", "description": "In this notebook we will analyze the globally spreading and development of Covid-19 which was first discovered in December 2019 in Wuhan. As of 13 April 2020, more than 2 million cases have been\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/covid19-global-forecasting-week-4/overview", "anchor_text": "Kaggle competition", "paragraph_index": 0}, {"url": "https://bd317.github.io/covid-005/", "anchor_text": "animation", "paragraph_index": 11}, {"url": "https://www.kaggle.com/c/covid19-global-forecasting-week-4/overview/evaluation", "anchor_text": "rules", "paragraph_index": 16}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "here", "paragraph_index": 20}, {"url": "https://www.kaggle.com/saga21/covid-global-forecast-sir-model-ml-regressions", "anchor_text": "this", "paragraph_index": 24}, {"url": "https://www.kaggle.com/hossein2015/covid-19-week-3-sarima-x-approach", "anchor_text": "this", "paragraph_index": 33}, {"url": "https://medium.com/@droste.benedikt/membership", "anchor_text": "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community.", "paragraph_index": 37}, {"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science", "paragraph_index": 38}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here", "paragraph_index": 38}, {"url": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "anchor_text": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "paragraph_index": 40}], "all_paragraphs": ["In this notebook we will analyze the globally spreading and development of Covid-19 which was first discovered in December 2019 in Wuhan. As of 13 April 2020, more than 2 million cases have been reported in 210 countries. We will try to forecast the development from 15 April 2020 to 15 May 2020 which is part of an ongoing Kaggle competition. I think it is very important to clarify the idea behind this challenge, which I think the Kaggle Team has summed up very well:", "We understand this is a serious situation, and in no way want to trivialize the human impact this crisis is causing by predicting fatalities. Our goal is to provide better methods for estimates that can assist medical and governmental institutions to prepare and adjust as pandemics unfold.", "In the first part of the notebook, we will explore the data in terms of information and quality. After we will clean the data and go on with feature engineering. In the third section we will have a look at different prediction methods, namely linear regression and ARIMA. At the end, we will have a short stop and a look back before we create our submission file for the competition itself. Even though it is a very serious topic, I hope we learn something together. Stay healthy!", "Before we start, let\u2019s take a quick look at the data structure. We have two data sets. The training data set contains six columns:", "There are no missings in the dataset except in the \u201cProvince_state\u201d column. There is also an overlapping date interval in early April. We will fix these issues and take a first look at the distribution.", "The most Covid-19 cases are by far in the United States. It is followed by the four largest EU member states and China, the country where the first Covid-19 cases were registered.", "In the diagram above we plotted the amount of confirmed cases of top 10 countries and additional the global development line. An interesting observation is that these 10 countries account for a large part of global development (see global trend line). At first glance it looks as if the curve is flattening, which is an indication that we are leaving the phase of exponential growth.", "We created two new variables: difference and increase quota. The first variable contains the difference in absolute cases from t0 and t-1. The second variable, increase quota, is the quotient of the difference t0 and t-1. As we can see, both developments flatten out over time. This can have two reasons:", "To get a better picture, we now examine the number of fatalities.", "Basically the picture is the same as for the confirmed cases. On April 13, 2020 there are more than 119,000 reported fatalities. The majority of the fatalities come from the 10 states that we have seen before in the confirmed cases diagram. At first sight the curve looks a bit steeper than in the confirmed cases, so we will compare them.", "Our impression was correct: The curve of the confirmed cases is recently flatter than that of the fatalities, but the difference is not enormous. If the growth of confirmed cases really does slow down, this development is plausible, since people do not die directly from corona, but later.", "The animation shows the spread of Covid-19 in the period from 01.01.2020 to 12.04.2020. Until 20.02. there were only single, smaller spots besides China, after that there was rapid growth first in Europe, then in the USA and finally in Africa. At present, almost every region in the world is affected by Covid 19.", "Let us briefly summarize the key findings:", "However, experts assume that the number of unreported cases is significantly higher and only a fraction of the cases are recorded. Therefore, our observation may also be due to the fact that testing capacities in many countries are exhausted. We cannot answer this question with the available data material. For further investigations we have to assume that the available figures reflect the actual development.", "In this chapter we will try out different methods and techniques for time series analysis. If you are interested in the final forecasts, you can go directly to chapter 4.3 ARIMA.", "In this chapter we will prepare the data in such a way that we can then make forecasts using various statistical methods. For this purpose we will clean up the data and create features. Feature engineering is an very interesting factor in time series analysis. If we assume that we want to forecast the confirmed cases and fatalities, we will only have the states, provinces and the date as inputs for our models. This seems a little too little to extrapolate the data points in a meaningful way, but more on this later in this chapter. Let us first take a look at the training and test data set.", "As we have already seen in the first chapter, there is an overlapping period of time. The rules for this competition state that only data prior to 2020\u201304\u201301 may be used for the public leaderboard. For this reason we delete the data from the training data. Later we will use all available data to make the best possible prediction.", "We have already noticed that we do not have many features available. Let\u2019s first make the date meaningful. Algorithms cannot read anything from the date, so we extract various features from it, such as the day and week. From the combination you could for example read weekly trends. In Germany I noticed that on Thursday and Friday on average more cases are reported and on Saturday and Sunday significantly less. This may have something to do with the reporting process: On Saturday and Sunday there are fewer people working in the relevant offices and not all cases are reported reliably.Additionally we use SciKit\u00b4s LabelEncoder() for states and provinces, because most algorithms can\u2019t do anything with strings. The Label Encoder assigns a number to each different case in the respective column.", "If we want to predict a data point in the future, currently only Country, State and the date are known. We have no information about the number of confirmed cases or fatalities in the future. However, we do have information about the number of cases in the past and we should use this information. In time series analysis we speak of lags when the previous development of the target (e.g. Confirmed Cases) is recorded as features in the data set.", "In addition, trends can be recorded, i.e. the short-term development. This can be described for a trend between two consecutive data points as (t0 -t1)/ t1.", "Now we have all necessary functions and the data is prepared accordingly. We will try two different approaches: 1) linear regressions and 2) ARIMA. We will start with the linear regression. You can find more information about the implementation and parameters of linear regression in SkyCit here.", "Unlike other machine learning projects, we can\u2019t just draw random samples via train-test-split function, because the data points are chronologically dependent on each other. Therefore we write our own function. In the training-dataset we have data available until 31.03.2020. This is the 69th day since 22.01.2020 (the first day in our data set). We will train our data until 31.03.2020 and then we will see how close our prediction is to the actual development. We will vary in the following:", "A few notes on our linear regression function:", "Note: The use of lags creates a new problem. These are only available for our training data. So we have only logs available for the first prediction. After that we have to write this prediction back into the training data set, recalculate the lag and make a new prediction. This process must be repeated for each data point.", "Credits: Most of the code for the implementation comes from this great notebook. I can also generally recommend reading it for theoretical assumptions about the further process.", "I will not show the results for all the different parameters now. You can test them yourself in the linked notebook. In the following we will have a look at the results for the following parameters:", "The Confirmed Cases are on the left Y-axis and the Fatalities on the right Y-axis.", "For Germany and Spain, the forecast initially looks good, but it can be seen that the gap between the actual figures and the forecast is widening. We have also looked at Algeria, as a country with few cases so far. Here too, the forecast and actual figures are drifting apart. I chose Andorra because there are no cases here so far. The prognosis is completely absurd and would ruin the whole score for us at Kaggle. We could intercept this phenomenon by hard-coding that countries without confirmed cases will continue to be predicted at zero. Instead, we will continue with the ARIMA method.", "ARIMA stands for AutoRegressive (AR) Integrated (I) Moving Average (MA). The provided data as input must be an univariate series, since ARIMA calculates future datapoints from the past. That is exactly what we were trying to do with linear regression as well. ARIMA basically has three important parameters:", "p: The autoregressive part of the model. Simplified one can say that the model assumes that if there were many confirmed cases yesterday and the day before, there will be many confirmed cases today and tomorrow.", "d -> The integrated part of the model that describes the amount of differentiation. If the available data are not stationary and contain trends, ARIMA can extract this seasonality.", "q -> The moving average part of the model. By forming moving averages, random effects can be smoothed.", "An important note: ARIMA is not able to take any external factors into account. The data points are only extrapolated based on historical data. If there are bans of going out imposed overnight in a state, our model will not provide good forecasts.", "Credits: Most of the code for the implementation comes from this great notebook.", "The Confirmed Cases are on the left Y-axis and the Fatalities on the right Y-axis.", "The forecasts for the individual countries look much more plausible over time. Data points for countries with more confirmed cases and a longer history such as Germany can be extrapolated well. If the figures are reported erratically, as in Shanghai, our algorithm will not be able to make good predictions.The implementation process compared to linear regression was also much easier. The first test submission to Kaggle had an RMLSE of about 0.4. The competition for week 4 ends today and the evaluation phase begins. I will add the final results.", "First we looked at the developments around Covid-19, cleaned up the data and prepared it accordingly. We then tried out two different methods for predicting time series: 1) linear regression and 2) ARIMA. The results of the linear regression were very volatile and the predictions did not seem particularly accurate. With ARIMA, we achieved significantly better and more plausible results. A final evaluation of the results is possible on 15.05.2020. However, the submission for the test period achieved a good score.I hope that despite the seriousness of the topic you were able to take something with you. Stay at home and healthy!", "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community.", "Note from the editors: Towards Data Science is a Medium publication primarily based on the study of data science and machine learning. We are not health professionals or epidemiologists, and the opinions of this article should not be interpreted as professional advice. To learn more about the coronavirus pandemic, you can click here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analyst in a management consultancy | Interested in data science, web scraping & storytelling | https://www.linkedin.com/in/benedikt-droste-893b1b189/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc154c163acc1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c154c163acc1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c154c163acc1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@droste.benedikt?source=post_page-----c154c163acc1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=post_page-----c154c163acc1--------------------------------", "anchor_text": "Benedikt Droste"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F93813b47e030&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&user=Benedikt+Droste&userId=93813b47e030&source=post_page-93813b47e030----c154c163acc1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc154c163acc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc154c163acc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/covid19-global-forecasting-week-4/overview", "anchor_text": "Kaggle competition"}, {"url": "https://bd317.github.io/covid-005/", "anchor_text": "animation"}, {"url": "https://www.kaggle.com/c/covid19-global-forecasting-week-4/overview/evaluation", "anchor_text": "rules"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "here"}, {"url": "https://www.kaggle.com/saga21/covid-global-forecast-sir-model-ml-regressions", "anchor_text": "this"}, {"url": "https://www.kaggle.com/hossein2015/covid-19-week-3-sarima-x-approach", "anchor_text": "this"}, {"url": "https://medium.com/@droste.benedikt/membership", "anchor_text": "If you enjoy Medium and Towards Data Science and didn\u2019t sign up yet, feel free to use my referral link to join the community."}, {"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science"}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c154c163acc1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c154c163acc1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/covid-19?source=post_page-----c154c163acc1---------------covid_19-----------------", "anchor_text": "Covid-19"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc154c163acc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&user=Benedikt+Droste&userId=93813b47e030&source=-----c154c163acc1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc154c163acc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&user=Benedikt+Droste&userId=93813b47e030&source=-----c154c163acc1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc154c163acc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c154c163acc1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc154c163acc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c154c163acc1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c154c163acc1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c154c163acc1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c154c163acc1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c154c163acc1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c154c163acc1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c154c163acc1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c154c163acc1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c154c163acc1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@droste.benedikt?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Benedikt Droste"}, {"url": "https://medium.com/@droste.benedikt/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "971 Followers"}, {"url": "https://www.linkedin.com/in/benedikt-droste-893b1b189/", "anchor_text": "https://www.linkedin.com/in/benedikt-droste-893b1b189/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F93813b47e030&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&user=Benedikt+Droste&userId=93813b47e030&source=post_page-93813b47e030--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe545585931c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglobal-covid-19-forecasting-with-linear-regression-and-arima-c154c163acc1&newsletterV3=93813b47e030&newsletterV3Id=e545585931c&user=Benedikt+Droste&userId=93813b47e030&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}