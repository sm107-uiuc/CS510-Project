{"url": "https://towardsdatascience.com/handling-imbalanced-data-4fb691e23fe9", "time": 1683000138.950609, "path": "towardsdatascience.com/handling-imbalanced-data-4fb691e23fe9/", "webpage": {"metadata": {"title": "Handling imbalanced data:. Predicting customers canceling phone\u2026 | by Levi Raichik | Towards Data Science", "h1": "Handling imbalanced data:", "description": "In this project I am trying to predict customers that are cancelling phone service in order to do something to retain those customers. The data-set I am using for this came from openml.org, and you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.openml.org", "anchor_text": "openml.org", "paragraph_index": 0}, {"url": "https://www.openml.org/d/40701", "anchor_text": "click here", "paragraph_index": 0}, {"url": "https://github.com/lraichik/dsc-mod-5-project-online-ds-ft-051319", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://www.linkedin.com/in/levi-raichik/", "anchor_text": "https://www.linkedin.com/in/levi-raichik/", "paragraph_index": 19}], "all_paragraphs": ["In this project I am trying to predict customers that are cancelling phone service in order to do something to retain those customers.The data-set I am using for this came from openml.org, and you can click here for the direct link to this data-set.", "This dataset was imbalanced which brought some challenges to it. First lets take a look at the imbalance:", "To deal with this, I used the SMOTE method of up-sampling data. I tried using ADYSN as well, however it did not preform as well. This is probably due to ADYSN also making random noise, which for this problem, just lessened how well the models were able to predict the outcome.", "Due to how the data-set is, I decided to optimize for recall, while still taking into account accuracy to a certain extent. This was due to wanting to correctly predict as many customers leaving as possible, while still holding the false positives as low as possible.", "I used cost-benefit analysis to grade the models. The calculation for that was as follows: From the information I had, the average monthly bill was $60. I then calculated that over the length of a 24 month contract, which came out to be $1,440. I then decided on a promotion amount of $500, just for calculation purposes.Any True Negatives, or customers that are correctly predicted as staying, do not add or subtract anything.Any False Negatives, or customers that would be canceling but are predicted as staying are a loss of $1,440 each.Any True Positives, or customer that would be canceling and are predicted as canceling, would be offered a promotion so the gain would be $1,440 - $500 = $940.Any False Positives, or customers that are predicted as leaving but are not, would be offered the promotion and therefore would be a loss of $500.", "Another thing I noticed at the beginning was about the correlation of the features:", "Not a lot of correlation to the target, which was the \u2018class\u2019 feature, a few at about .2, also minutes and charge are correlated almost %100. That made sense, as at the time this data was made minutes were the most important part of a bill.", "When I was contemplating the amount of features and the correlation issue, on one hand having a lot of correlation between charges and minutes but on the other hand not many dominant features. I therefore thought that random forest would work best with this type of data due to how it randomizes the features and data for each tree, then makes predictions off the entire forest. I tested a few different methods with their basic default hyper-parameters and random forest did preform the best. The results I got for my test data, after optimizing it a few times, was this:", "The cost \u2014 benefit of this was $71,320 or for the actual gain to retain the customers that would be leaving would be $589 per customer that would actually have previously left, if all 121 customers that we predicted to be leaving would then stay.After doing 5 fold cross validation the average cost-benefit for the test set was $51,152.", "Just a note on cross validation when dealing with imbalanced data. As you should only smote training data and then predict on the real test data, that limits how you can do cross validation. The regular cross validation methods would not work with this. In order to combat that, I used Stratified K-Folds, which takes the same amount from each category so you end up with similar splits for each fold.Then I got each split and applied SMOTE to the training data, trained the model on that. Saved the scores for each fold then averaged them.", "After having a good model to work with I was then able to look at the feature importance to see what I could figure out from it with regards to bettering the interpret-ability of the model to then be able to use that for future business decisions.", "I did some feature engineering to combine all the minutes and all the charges into 2 features. As those 2 features are highly correlated, I dropped the minutes column. I also dropped all call number columns, as well as the state and account_length columns as they were close to 0 on feature importance.I also dropped number_vmail_messages as it was highly correlated with having a voice mail plan.I ended up with 4 features, here they are with the corresponding importance:", "Running the model with only these features, with 5 fold cross validation brought the cost-benefit to $56,964.This showed me that the model got better by combining and dropping features based on the feature importance.", "Analysis of Features based on importance", "After looking into features relationships, the most significant thing that jumped out at me was that anyone with a bill over $72 was much more likely to leave. That can be seen in this visual:", "Considering that in the general data there is a 85% staying to 15% leaving rate, to have more people leaving at the higher rate then staying is very important.This also was consistent in checking how customers with bills over $72 crossed over with the other features. If we would offer a $500 promo to everyone with a average bill over $72 then per customer staying we would be gaining $547, which is similar to what we would get over the entire data-set.I would suggest looking into this more to see how best to handle customers with higher bills to retain more of them.", "My final recommendations would be to offer some sort of promo to customers. To figure out how much should be offered and what sort of promos would be most successful in retaining customers.To research more how to retain customers with higher bills.", "Please leave feedback if you have thoughts on this and if you would like to see the code used for it, that can be seen here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist and machine learning engineer with a passion for turning raw data into useful, actionable insights. https://www.linkedin.com/in/levi-raichik/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4fb691e23fe9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lraichik?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lraichik?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": "Levi Raichik"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6e784abd9f38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&user=Levi+Raichik&userId=6e784abd9f38&source=post_page-6e784abd9f38----4fb691e23fe9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fb691e23fe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fb691e23fe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.openml.org", "anchor_text": "openml.org"}, {"url": "https://www.openml.org/d/40701", "anchor_text": "click here"}, {"url": "https://github.com/lraichik/dsc-mod-5-project-online-ds-ft-051319", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4fb691e23fe9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4fb691e23fe9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----4fb691e23fe9---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/imbalanced-data?source=post_page-----4fb691e23fe9---------------imbalanced_data-----------------", "anchor_text": "Imbalanced Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4fb691e23fe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&user=Levi+Raichik&userId=6e784abd9f38&source=-----4fb691e23fe9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4fb691e23fe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&user=Levi+Raichik&userId=6e784abd9f38&source=-----4fb691e23fe9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4fb691e23fe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4fb691e23fe9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4fb691e23fe9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4fb691e23fe9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lraichik?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lraichik?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Levi Raichik"}, {"url": "https://medium.com/@lraichik/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "38 Followers"}, {"url": "https://www.linkedin.com/in/levi-raichik/", "anchor_text": "https://www.linkedin.com/in/levi-raichik/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6e784abd9f38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&user=Levi+Raichik&userId=6e784abd9f38&source=post_page-6e784abd9f38--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe044de01afee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhandling-imbalanced-data-4fb691e23fe9&newsletterV3=6e784abd9f38&newsletterV3Id=e044de01afee&user=Levi+Raichik&userId=6e784abd9f38&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}