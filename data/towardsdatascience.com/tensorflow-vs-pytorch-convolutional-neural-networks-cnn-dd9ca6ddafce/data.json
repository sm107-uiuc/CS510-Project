{"url": "https://towardsdatascience.com/tensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce", "time": 1683011731.511161, "path": "towardsdatascience.com/tensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce/", "webpage": {"metadata": {"title": "TensorFlow vs PyTorch \u2014 Convolutional Neural Networks (CNN) | by Gurucharan M K | Towards Data Science", "h1": "TensorFlow vs PyTorch \u2014 Convolutional Neural Networks (CNN)", "description": "In my previous article, I had given the implementation of a Simple Linear Regression in both TensorFlow and PyTorch frameworks and compared their results. In this article, we shall go through the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/tensorflow-vs-pytorch-linear-regression-e07781a83525", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://github.com/zalandoresearch/fashion-mnist", "anchor_text": "Fashion-MNIST", "paragraph_index": 4}], "all_paragraphs": ["In my previous article, I had given the implementation of a Simple Linear Regression in both TensorFlow and PyTorch frameworks and compared their results. In this article, we shall go through the application of a Convolutional Neural Network (CNN) on a very famous Fashion MNIST dataset using both the frameworks and compare the results.", "Let us get a brief idea on both the frameworks and their history. Firstly, PyTorch is an open source machine learning library based on the Torch library. PyTorch was primarily developed by Facebook\u2019s AI Research lab (FAIR). It is free and open-source software.", "On the other hand, TensorFlow was developed by the Google Brain team for internal Google research purpose. It is widely used for machine learning applications such as neural networks. It is also free and open-source software.", "In order to see which framework is more efficient and simpler to use, we shall build a ConvNet using both the frameworks and compare them. For the TensorFlow, we shall be using the Keras library.", "For comparison of both the frameworks, we will use the famous Fashion-MNIST dataset. It is a dataset of Zalando\u2019s article images consisting of a training set of 60,000 examples and a test set of 10,000 examples. Each example is a 28\u00d728 grayscale image, associated with a label from 10 classes such as shirt, bag, sandal, coat, sneaker etc. We will build a CNN network with a common architecture of LeNet with both the frameworks and compare their results.", "In the first step, we will be importing the required libraries for both the TensorFlow and PyTorch frameworks.", "In the next step, we will get the Fashion MNIST dataset. As it is a very common dataset, both the frameworks have preloaded functions that enable us to download the dataset and use it.", "In PyTorch, the built-in module is used to load the dataset. As we need the data in the form of tensors,the data is converted into tensors by using thetorchvision.transforms.ToTensor()and assigning it to the variable transforms. The data is then downloaded with torchvision.datasets. The data is correspondingly split into the train_dataset and the test_dataset.", "On the other hand, getting the data from the keras library using TensorFlow is more simpler compared to the PyTorch version. The dataset is loaded from keras.datasets and it is split into the train_images and test_images accordingly.", "In this step, we shall load the data into the training set and test set. Additionally, we shall also view how the image is stored in both the frameworks.", "In PyTorch, the images are stored in the ranges 0\u20131 and hence the images are displayed in B/W. The images are loaded into the train_loader and the test_loader using the DataLoaderfunction. Additionally, the label of the image is also printed.", "On the other hand, TensorFlow stores the images in the range 0\u2013255 and hence there is a color gradient in the same image. TensorFlow is more simple in its approach of loading the data.", "In this step, we shall build the CNN Model. For this, we will build the standard LeNet-5 Architecture which is a very simple Architecture that was built in the year 1998. Given below is the architecture of LeNet-5.", "In this, we build the LeNet-5 Architecture using the PyTorch framework. It has 2 Convolutional layers each followed by a Average Pooling Layer, 2 Fully connected layers and a final output classifier layer with 10 classes as the final output has 10 categories of fashion items.", "In this, the model is built by creating a special class \u2018NeuralNet\u2019 where we have to define each layer of the network/model using the __init__ method. It is important to call this function \u2018forward\u2019 as this will override the base forward function in nn.Module and allow all the nn.Module functionality to work correctly.", "On the other hand, building the same model in TensorFlow doesn\u2019t require creating a class even though we use the Sequential() method. We find that building the same model with TensorFlow framework is much more simpler and explicit than building the same model in a PyTorch framework first hand.", "In this step, we shall compile the model built in the previous step and set the optimizer and the loss functions. For this, in both the frameworks, we will use the Adam optimizer and the Categorical Cross Entropy loss function as there are more than 2 classes in the dataset.", "In PyTotch, we first create an instance of the \u2018NeuralNet\u2019 model built in the last step as modelpy. We then assign the optimizer and the loss function to the corresponding variables. Then we visualize the model by printing the modelpy.", "On the other hand, in the TensorFlow framework, we use the compile() function in which we will define the optimizer and the loss function as defined above. Then we use the summary() to see the layers of the LeNet-5 Architecture built above.", "It is in this step that we deploy the models built for training on the data in the training set. For both the frameworks, we will train the model for 30 epochs and see the results.", "For PyTorch, we have to individually compute all the steps including the loss function, optimizer, back-propagation and update each step in a for loop.", "In TensorFlow, the Fashion MNIST is an array with two dimensions, we have to reshape our training dataset to a tensor and convert the labels from integers to binary class matrix. The model is trained using the fit() function which consists of the defined number of epochs.", "In this final step, we shall compare the results of both the models built using the frameworks on the test set with the accuracy.", "In PyTorch, the output prediction is predicted by outputs = modelpy(images). The accuracy of the test set is then calculated and displayed.", "In TensorFlow, the predict() function is used to predict the classes of the images in the test dataset and the accuracy is calculated and displayed.", "The Test Set consists of 1000 images and the models built on both the PyTorch and the TensorFlow frameworks are used to predict the classes of the test set images.", "From the results, we see that the test set accuracy of the TensorFlow model is 91.34% which is a little higher than that of the PyTorch model with 89%.", "From the above comparison, we were able to get an understanding of building a CNN model using two of the most popular frameworks used in Deep Learning today.", "In my opinion, if you are a beginner and are totally confused as to which framework to use, I\u2019d suggest you start with the TensorFlow framework as it is simpler and easy to understand. On the other hand, PyTorch is more fast and dynamic but needs a bit of understanding of Python API.", "I have attached my GitHub repository where you can find the entire code of this comparison.", "Do check out my previous article where I had given a comparison of both the frameworks in building a Simple Linear Regression model.", "I do hope that I was able to give a good comparison of the two most popular frameworks that are used in Deep Learning today. Meet you all in my next article. Till then, Happy Machine Learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Biomedical Engineer | Image Processing | Deep Learning Enthusiast"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdd9ca6ddafce&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mk.gurucharan?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mk.gurucharan?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": "Gurucharan M K"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F81c33072e21d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&user=Gurucharan+M+K&userId=81c33072e21d&source=post_page-81c33072e21d----dd9ca6ddafce---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd9ca6ddafce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd9ca6ddafce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tensorflow-vs-pytorch-linear-regression-e07781a83525", "anchor_text": "article"}, {"url": "https://github.com/zalandoresearch/fashion-mnist", "anchor_text": "Fashion-MNIST"}, {"url": "https://engmrk.com/lenet-5-a-classic-cnn-architecture/", "anchor_text": "Source"}, {"url": "https://github.com/mk-gurucharan/TensorFlow-vs-PyTorch-CNN", "anchor_text": "mk-gurucharan/TensorFlow-vs-PyTorch-CNNGitHub is home to over 50 million developers working together to host and review code, manage projects, and build\u2026github.com"}, {"url": "https://towardsdatascience.com/tensorflow-vs-pytorch-linear-regression-e07781a83525", "anchor_text": "TensorFlow vs PyTorch \u2014 Linear RegressionImplementation of Linear Regression in both TensorFlow and PyTorch frameworks and comparison of their resultstowardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dd9ca6ddafce---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----dd9ca6ddafce---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----dd9ca6ddafce---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/ml?source=post_page-----dd9ca6ddafce---------------ml-----------------", "anchor_text": "ML"}, {"url": "https://medium.com/tag/data-science?source=post_page-----dd9ca6ddafce---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd9ca6ddafce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&user=Gurucharan+M+K&userId=81c33072e21d&source=-----dd9ca6ddafce---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdd9ca6ddafce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&user=Gurucharan+M+K&userId=81c33072e21d&source=-----dd9ca6ddafce---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdd9ca6ddafce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdd9ca6ddafce&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dd9ca6ddafce---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dd9ca6ddafce--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mk.gurucharan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mk.gurucharan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gurucharan M K"}, {"url": "https://medium.com/@mk.gurucharan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "346 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F81c33072e21d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&user=Gurucharan+M+K&userId=81c33072e21d&source=post_page-81c33072e21d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33a57d881743&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-vs-pytorch-convolutional-neural-networks-cnn-dd9ca6ddafce&newsletterV3=81c33072e21d&newsletterV3Id=33a57d881743&user=Gurucharan+M+K&userId=81c33072e21d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}