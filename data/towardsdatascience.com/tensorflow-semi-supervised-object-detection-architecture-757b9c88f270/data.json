{"url": "https://towardsdatascience.com/tensorflow-semi-supervised-object-detection-architecture-757b9c88f270", "time": 1683011510.1833448, "path": "towardsdatascience.com/tensorflow-semi-supervised-object-detection-architecture-757b9c88f270/", "webpage": {"metadata": {"title": "TensorFlow Semi-Supervised Object Detection Architecture | by Alvaro Leandro Cavalcante Carneiro | Towards Data Science", "h1": "TensorFlow Semi-Supervised Object Detection Architecture", "description": "Object detection is one of the most popular and used computer vision methods nowadays, where the intention is not only to determine whether the object is found or not in the image in the same way as\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/alvarole/asirra-cats-vs-dogs-object-detection-dataset", "anchor_text": "on Kaggle", "paragraph_index": 12}, {"url": "https://arxiv.org/pdf/1512.02325.pdf", "anchor_text": "original paper", "paragraph_index": 13}, {"url": "https://github.com/AlvaroCavalcante/tf-models", "anchor_text": "repository", "paragraph_index": 20}, {"url": "https://drive.google.com/file/d/1srnHOXFv779IGT0lKKGbTn8J-5dGSAX_/view?usp=sharing", "anchor_text": "original Colab Notebook", "paragraph_index": 26}, {"url": "https://medium.com/@jonathan_hui/map-mean-average-precision-for-object-detection-45c121a31173", "anchor_text": "check out this", "paragraph_index": 36}, {"url": "https://www.researchgate.net/publication/343167804_Semi-supervised_approach_to_auto-label_images_in_object_detection", "anchor_text": "preprint", "paragraph_index": 51}], "all_paragraphs": ["Object detection is one of the most popular and used computer vision methods nowadays, where the intention is not only to determine whether the object is found or not in the image in the same way as most common classification problems but also point the location of these objects of interest, being the necessary approach for situations where multiple objects may appear simultaneously in the image.", "One of the challenges of this method is to create the dataset, once it\u2019s necessary to manually set the positions of all objects in the image, spending a lot of time to do so in a large number of observations.", "This process is inefficient, expensive, and time-consuming, mainly in some problems that are required to label dozens of objects in each image or demand specialized knowledge.", "Based on this, I created a TensorFlow Semi-supervised Object Detection Architecture (TSODA) to interactively train an object detection model, and use it to automatically label new images based on a confidence threshold level, aggregating them to the later training process.", "In this article, I\u2019ll show you the necessary steps to reproduce this approach in your object detection project. With this, you\u2019ll be able to create labels in your images automatically while measuring the model performance!", "The working is similar to any other semi-supervised method, where the training is done with labeled and unlabeled data, unlike the most common supervised approach.", "An initial model is trained using strongly labeled data done by hand, learns some features from these data, and then create inferences in the unlabeled data to aggregate these new labeled images to a new training process.", "The whole idea can be illustrated by the following image:", "This operation is done until the stop criterion is reached, either the number of executions or no remaining unlabeled data.", "As we saw in the schema, a confidence threshold of 80% was initially configured. This is an important parameter once the new images will be used to a new training process and if incorrectly labeled could create undesirable noise, undermining the model performance.", "The propose of TSODA is to introduce a simple and fast way to use semi-supervised learning in your object detection project.", "To exemplify the approach and test if everything is working properly, a random sample of 1,100 images of the Asirra dataset was done in a proportion of 50% per class.", "The images were labeled manually to a later comparison, you can download the same data on Kaggle.", "I used Single Shot Multibox Detector (SSD) as the object detection architecture and Inception as the base network instead of VGG 16 like in the original paper.", "SSD and Inception have a good trade-off between training speed and accuracy, so I think it\u2019s a great start point, mainly because in each iteration the TSODA needs to save a checkpoint of the trained model, infer new images and load the model to train it again, so a faster training is good to iterate more and aggregate these images to the learning.", "To test TSODA performance just 100 labeled images of each class were provided to split into training and test while 900 were let as unlabeled, simulating a situation where just a little time was spent creating the labeled dataset. the obtained results were compared to a model trained with all the manually labeled images.", "The data were randomly split into 80% of images for training and 20% for testing.", "As the name suggests, the whole architecture is done using the TensorFlow environment, in version 2.x.", "This new TF version is not yet fully compatible with object detection, and some parts were difficult to adapt, but in the next months this will be the default and more used version of TF in all projects, that\u2019s why I think it\u2019s important to adapt the code to use it.", "To create TSODA, new scripts and folders were added in a fork of TF Model Garden repository, so you can easily clone and with just small modifications run your semi-supervised project, besides be a familiar structure for those who work with TF.", "You can clone my repository to easily follow these steps or adapt your TF model repository.", "The work was done inside models/research/object_detection, where you will find the following folders and files:", "Inside utils folder we also have some things:", "That\u2019s it, this is all you need to have in your repository!", "To run this project you will need nothing!?", "The training process is in a Google Colab Notebook, so it\u2019s fast and simple to train your model, you will literally just need to replace my images by yours and choose another base model if you and.", "Make a copy of the original Colab Notebook to your Google Drive and execute it.", "If you really want to run TSODA in your machine, at the beginning of the Jupiter notebook you\u2019ll see the installation requirements, just follow it but don\u2019t forget to also install TF 2.x. I recommend creating a virtual environment.", "The inference_from_model.py was responsible to load the saved_model.pb that was created in the training and use it to make new inferences in the unlabeled images. Most of the code was got from the object_detection_tutorial.ipynb found in the colab_tutorials folder.", "If you don\u2019t want to use Colab for training you\u2019ll need to replace the paths at the beginning of the file.", "Another important method in this file is the partition_data which is responsible to split the inferred images (that will be in the labeled_images folder) into training and test to keep the same ratio.", "A change that you may want to do is in the split ratio, in my case, I chose an 80/20 proportion, but if you want something different, you can set it in the method parameter.", "The visualization_utils.py is where the bounding boxes are drawn into the image, so we use this to get the boxes\u2019 positions, class name, file name, and pass it into our XML generator. The following code shows the most of the process:", "The XML is generated if a box is detected into the image with a higher confidence level than specified.", "All the information arrives in the generate_xml.py and the XML is created using ElementTree.", "Inside the code, there are comments that will help you to understand how everything is working.", "To evaluate the model performance was used the mean Average Precision (mAP), if you have some doubt about how it works, check out this.", "The first test was done training a model by 4,000 epochs, using all the images strongly labeled.", "The training took about twenty-one minutes and the results are shown in Table 1.", "As expected, the model got a high mAP, mainly in a lower UoI rate.", "The second test was done using the same configurations but with TSODA considering just 100 labeled images. In each iteration, the model was trained by 1,000 epochs and then used to infer and create new labeled images. The results are shown in Figure 2.", "The whole training process took thirty-eight minutes, about seventeen minutes more than the previous one, and the model reached a worse final mAP, as shown in Table 2:", "As Table 3 reveals, most images were successfully annotated in the first iteration, being aggregated in the training. This could mean that the minimum confidence threshold isn\u2019t high enough, as in the first thousand iterations the model doesn\u2019t converge properly yet, possibly creating wrong annotations.", "TSODA requires more time and epochs to improve model performance and get close to the original method. This happens because the addition of new images in the training set leads to a loss in mAP once the model needs to learn how to generalize new patterns as proved in figure 2, where the mAP decreases as new images are included before starting increasing again when model learns new features.", "In Figure 3 there are some examples of images automatically annotated. Notably, some labels are not so well marked, but it\u2019s enough to guarantee more information to the model.", "Some new experiments were performed considering a different epoch increment behavior as well as a higher confidence threshold. The result is present in Table 4:", "Setting a confidence threshold to 90% ensures a higher chance of a correct label in predictions, being an important factor for model convergence. Although the training was done for 2,500 epochs in the initial iteration instead of just 1,000 once the first iteration is where most images are labeled, being necessary to the model learn more features and be able to beat the higher confidence. After the first iteration, the subsequent ones increment one 1,500 epochs until a limit of 8,500. These new configurations improved the final results.", "TSODA may perform differently based on the kind of object of interest and it\u2019s complexity. The results could be improved if trained by more epochs or set a higher confidence threshold with the drawback to increasing the training time. Also, the epochs increment by iteration must change depending on the problem, to control the model convergence based on the number of unlabeled images and threshold.", "Nevertheless, this is a good alternative, once training time is cheaper than the manually labeling time that requires a human, and the TSODA was constructed in a manner that with just a few modifications it\u2019s possible to train a completely new large-scale model from scratch.", "The auto-created labels could also be manually adjusted in some images, which can improve the overall performance and is faster than creating all the labels manually.", "The proposed TSODA can achieve satisfactory results in creating new labels to unlabeled images, reaching similar results to a strongly-labeled training approach, but with considerably less human effort. The solution also is adaptable for any other CNN detector architecture and is easy and fast to implement, helping the dataset creation process while measuring the overall object detector performance.", "For more details and context about this semi-supervised project, see my preprint.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "MSc in computer science focused on artificial intelligence and pattern recognition and Data Engineer in a financial company."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F757b9c88f270&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----757b9c88f270--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----757b9c88f270--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://alvaroleandrocavalcante.medium.com/?source=post_page-----757b9c88f270--------------------------------", "anchor_text": ""}, {"url": "https://alvaroleandrocavalcante.medium.com/?source=post_page-----757b9c88f270--------------------------------", "anchor_text": "Alvaro Leandro Cavalcante Carneiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F948868831251&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&user=Alvaro+Leandro+Cavalcante+Carneiro&userId=948868831251&source=post_page-948868831251----757b9c88f270---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F757b9c88f270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F757b9c88f270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tokeller?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Tobias Keller"}, {"url": "https://unsplash.com/s/photos/architecture?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/alvarole/asirra-cats-vs-dogs-object-detection-dataset", "anchor_text": "on Kaggle"}, {"url": "https://arxiv.org/pdf/1512.02325.pdf", "anchor_text": "original paper"}, {"url": "https://github.com/AlvaroCavalcante/tf-models", "anchor_text": "repository"}, {"url": "https://github.com/datitran/raccoon_dataset", "anchor_text": "raccoon dataset"}, {"url": "https://drive.google.com/file/d/1srnHOXFv779IGT0lKKGbTn8J-5dGSAX_/view?usp=sharing", "anchor_text": "original Colab Notebook"}, {"url": "https://medium.com/@jonathan_hui/map-mean-average-precision-for-object-detection-45c121a31173", "anchor_text": "check out this"}, {"url": "https://www.researchgate.net/publication/343167804_Semi-supervised_approach_to_auto-label_images_in_object_detection", "anchor_text": "preprint"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----757b9c88f270---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----757b9c88f270---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----757b9c88f270---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----757b9c88f270---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/semi-supervised-learning?source=post_page-----757b9c88f270---------------semi_supervised_learning-----------------", "anchor_text": "Semi Supervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F757b9c88f270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&user=Alvaro+Leandro+Cavalcante+Carneiro&userId=948868831251&source=-----757b9c88f270---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F757b9c88f270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&user=Alvaro+Leandro+Cavalcante+Carneiro&userId=948868831251&source=-----757b9c88f270---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F757b9c88f270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----757b9c88f270--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F757b9c88f270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----757b9c88f270---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----757b9c88f270--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----757b9c88f270--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----757b9c88f270--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----757b9c88f270--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----757b9c88f270--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----757b9c88f270--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----757b9c88f270--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----757b9c88f270--------------------------------", "anchor_text": ""}, {"url": "https://alvaroleandrocavalcante.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://alvaroleandrocavalcante.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alvaro Leandro Cavalcante Carneiro"}, {"url": "https://alvaroleandrocavalcante.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "114 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F948868831251&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&user=Alvaro+Leandro+Cavalcante+Carneiro&userId=948868831251&source=post_page-948868831251--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffacac1f4771c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-semi-supervised-object-detection-architecture-757b9c88f270&newsletterV3=948868831251&newsletterV3Id=facac1f4771c&user=Alvaro+Leandro+Cavalcante+Carneiro&userId=948868831251&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}