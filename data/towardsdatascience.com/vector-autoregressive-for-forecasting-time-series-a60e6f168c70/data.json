{"url": "https://towardsdatascience.com/vector-autoregressive-for-forecasting-time-series-a60e6f168c70", "time": 1683009484.068353, "path": "towardsdatascience.com/vector-autoregressive-for-forecasting-time-series-a60e6f168c70/", "webpage": {"metadata": {"title": "Vector Autoregressive for Forecasting Time Series | by Sarit Maitra | Towards Data Science", "h1": "Vector Autoregressive for Forecasting Time Series", "description": "Vector auto-regression (VAR) time series model has wide application in econometric forecasting model; VAR can capture the evolution and the inter-dependencies between multiple time-series. All the\u2026"}, "outgoing_paragraph_urls": [{"url": "http://The P value was never meant to be used the way it's used today.", "anchor_text": "article", "paragraph_index": 19}], "all_paragraphs": ["Vector auto-regression (VAR) time series model has wide application in econometric forecasting model; VAR can capture the evolution and the inter-dependencies between multiple time-series. All the variables in a VAR are treated symmetrically by including for each variable an equation explaining its evolution based on its own lags and the lags of all the other variables in the model. We may call this as scientific method for trading strategy.", "Advantage of using the scientific method for trading strategy design is that if the strategy fails after a prior period of profitability, it is possible to revisit the initial hypothesis and re-evaluate it, potentially leading to a new hypothesis that leads to regained profitability for a strategy.", "We have four time series here for Brent crude; USA & Europe price, West Texas crude price and OPEC crude price. We will develop a regression model and shall try to predict Brent Crude Oil, USA price given all the series in our model.", "We can see here, all the series follow a stochastic trend, showing stronger inter-temporal variation with larger drops; more so, all of the series seem to be related in some way. Neither series looks stationary in its levels. They appear to have a common trend, an indication that they may be co-integrated.", "We can see one small outlier in the data, which can be ignored.", "VAR model describe the dynamic interrelationship among stationary variables. So, the first step in time-series analysis should be unit root test to determine whether the series are stationary.", "Though correlations are often used in all multivariate financial time-series use cases, however, correlations could be quite unstable. Moreover, ADF or Hurst Exponent helps us to statistically confirm whether this series is mean-reverting. However, we cannot determine the hedging ratio needed to form the linear combination from these tests, they will only tell us whether, for a particular , the linear combination is stationary. The alternate arrangements is cointegration which is probably a more robust measure of linkage between two financial series.", "ADF test says that, if a price series possesses mean reversion, then the next price level will be proportional to the current price level. Mathematically, the ADF is based on the idea of testing for the presence of a unit root in an autoregressive time series sample.", "None of the statistic even close to being significant at the 5% level. So, we can confidently say that the series are non-stationary in level. Their co-integration is explored and in each case (p-values > 0.05), the null hypothesis of non-stationarity cannot be rejected at any reasonable level of significance.", "The steps in the cointegration test procedure:", "If we find that the time series as a unit root, then we move on to the cointegration process. There are three main methods for testing for cointegration: Johansen, Engle-Granger, and Phillips-Ouliaris. We will use the Engle-Granger test. By employing co-integration test we will examine if there is a cointegrated, long-run relationship between wti price index and br_crude price index. Mathematically, we will consider the cointegrated relationship:", "Engle & Granger\u2019s two-step residual-based testing procedure first estimates a cross-sectional regression, and then tests the residuals from this regression using an ADF distribution with modified critical values.", "Here a vector of observations is recorded at each time point. In such cases, there may be some linear combinations of the vectors that form stationary time-series and other linear combinations that are non-stationary.", "From above model residual plot it appears that mean is 0, it might have a trend in it.", "The estimated co-integrating vector is very close to [+1, \u22121], indicating a simple no-arbitrage relationship. Let us rerun the test with both a constant and a time trend (\u201cct\u201d). Our test statistic of -4.231< critical values at the 5% (-3.79) and 10% ( 3.50) level; p-values < 0.05 and we can reject the null hypothesis of no co-integration.", "The residuals are clearly mean zero but show evidence of a structural break around current year (2020).", "Likewise, we have tested the other possible combination of pairs to obtain the similar output.", "Although the Engle-Granger approach is quite easy to use, one of its major drawbacks is that it can estimate only up to one co-integrating relationship between the variables.", "Here, we have more than 1 variables, there can potentially be more than one linearly independent co-integrating relationship.", "There is an ongoing debate on p-value in real-life business case. p-value may look good on published articles, but it was never meant to be used the way it\u2019s used today. For more details please read this interesting article. Traditionally, p-value <0.05 is the criterion for significance.", "Now, we will fit a regression between time series using OLS and visualize the residuals plot. If residuals are stationary, we can safely assume that, the given series are really cointegrated.", "The levels of the residuals (red line), which looks like a stationary series than the original series (blue line). Here, we can see that, the actual and fitted lines are indistinguishable.", "Let us now perform an ADF test on the residual series. We have used DFGLS test and specify 12 lags as the maximum lag order for DFGLS regressions.", "The number of lags suggests an optimal lag length of 7. Our test statistic (\u20137.059) < Critical Values at 1%, 5% & 10% and null hypothesis of no cointegration can be rejected.", "BD is more general than DW and allows us to test for higher order auto-correlation.", "The distribution of the residuals looks like a bell-shape although there are some outliers which might lead to skewness.", "\u03c72 two-tailed p-value for the test equals zero means we accept the null hypothesis of residuals are overall normally distributed, i.e., both the kurtosis and the skewness are those of a normal distribution.", "VAR method models the next step in each time series using an AR model. The notation for the model involves specifying the order for the AR(p) model as parameters to a VAR function {VAR(p)}.", "Let us take the first differences of the series and try ADF again. Usually, if the levels time series are not stationary, the first differences will be. Data differencing is, more or less, calculating the amount the time series changes from one value to the next.", "Creating a training and test set for time series problems is tricky considering the time component. Any wrong move at this stage will disrupt the pattern in the series. The test set should be created considering the date and time values.", "Now we repeat all of the above steps for the First-Difference of data frame.", "Here, we see all the series are stationary after first difference.", "What we really want to focus on in the model summary is the equation for br_crude, where br_crude estimates the other prices based on lagged values of itself and lagged prices of other variables. Higher the t-statistic value, the more likely that we can reject the H0 and more likely there is a correlation between the two variables. p-values are also used to reject the null hypothesis. The lower the p-value, the stronger the evidence against the null hypothesis.", "Estimating the equations of a VAR does not really need strong assumptions; however, calculating impulse response functions (IRFs) or variance decompositions do require identifying restrictions. A typical restriction takes the form of an assumption about the dynamic relationship between a pair of variables, for example, that x affects y only with a lag, or that x does not affect y in the long run", "Let us visualize the impact of changes in one variable on the others at different horizons using impulse responses plot.", "Given the parameter estimates and the Engle Granger test results, the linkages between the series are established here. It can be seen that, the responses to the shocks are captured here, and they die down to almost after 10th lag.", "The effect that a shock to the br_crude price has on the other prices and other values of themselves are shown in the first row of the FEVD plot. The % of the errors attributable to own shocks is 100% in the case of the br_crude price (dark black bar), for wti series explains around 40% of the variation in returns; for opec around 60% and for the euro series explains around 70% of the variation.", "Note: Concept of above tests procedures have been taken from Brooks (2019); see the reference section.", "Now the model is built, let us generate and compare the predictions to actual data in the test/validation set.", "Once we have a model for our data, it\u2019s important to analyze how we can evaluate its quality. The first option is to use the residuals. Residuals basically the squared difference between the predicted values and actual values. This could be a simple option to judge the accuracy of our model.", "Residuals are proportional to the amount of data that we use to create the model. Therefore, it is not advisable to use the sum of all the residuals. One option could be to divide the residual by the number of time instants multiplied by the number of dependent variables.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics & Data Science Practice Lead"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa60e6f168c70&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8----a60e6f168c70---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa60e6f168c70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa60e6f168c70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://sarit-maitra.medium.com/membership", "anchor_text": "https://sarit-maitra.medium.com/membership"}, {"url": "http://The P value was never meant to be used the way it's used today.", "anchor_text": "article"}, {"url": "https://www.linkedin.com/in/saritmaitra/", "anchor_text": "here"}, {"url": "https://medium.com/tag/vector-auto-regression?source=post_page-----a60e6f168c70---------------vector_auto_regression-----------------", "anchor_text": "Vector Auto Regression"}, {"url": "https://medium.com/tag/econometrics?source=post_page-----a60e6f168c70---------------econometrics-----------------", "anchor_text": "Econometrics"}, {"url": "https://medium.com/tag/analytics?source=post_page-----a60e6f168c70---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----a60e6f168c70---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa60e6f168c70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&user=Sarit+Maitra&userId=c611876588a8&source=-----a60e6f168c70---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa60e6f168c70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&user=Sarit+Maitra&userId=c611876588a8&source=-----a60e6f168c70---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa60e6f168c70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa60e6f168c70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a60e6f168c70---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a60e6f168c70--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a60e6f168c70--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a60e6f168c70--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a60e6f168c70--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://sarit-maitra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba440ad8d04d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressive-for-forecasting-time-series-a60e6f168c70&newsletterV3=c611876588a8&newsletterV3Id=ba440ad8d04d&user=Sarit+Maitra&userId=c611876588a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}