{"url": "https://towardsdatascience.com/linear-regression-in-python-the-bordeaux-equation-d0e414dc5065", "time": 1683004470.5432792, "path": "towardsdatascience.com/linear-regression-in-python-the-bordeaux-equation-d0e414dc5065/", "webpage": {"metadata": {"title": "Linear Regression in Python \u2014 The Bordeaux Equation | by Shivangi Sareen | Towards Data Science", "h1": "Linear Regression in Python \u2014 The Bordeaux Equation", "description": "Red Bordeaux wines are popular world wide. The Bordeaux case study is very famously used to explain and implement linear regression with one and multiple variables using R. This is the Python twist\u2026"}, "outgoing_paragraph_urls": [{"url": "https://bookdown.org/egarpor/SSS2-UC3M/multlin-examps.html", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://rstudio-pubs-static.s3.amazonaws.com/326428_e7b3416aa30140e79f57b8ed70ca64e4.html", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/introducing-linear-regression-least-squares-the-easy-way-3a8b38565560", "anchor_text": "here", "paragraph_index": 2}], "all_paragraphs": ["Red Bordeaux wines are popular world wide. The Bordeaux case study is very famously used to explain and implement linear regression with one and multiple variables using R. This is the Python twist.", "More information on the case study can be found here. The data is available here.", "Linear regression finds the smallest sum of squared residuals that is possible for the dataset. Get yourself up to speed with linear regression basics from here.", "This post talks about the steps to create a linear regression model with one and more than one variables. Then we go on to score the model based on R-squared. Discussing the limitations of R-squared, we explore adjusted-R-squared as a better score for assessing the model. We come across correlation and multi-collinearity between independent variables and what to do when such cases arise. Finally, we predict values using the model that fits the best.", "We want to predict the price of Bordeaux wines based on certain factors like weather conditions. The price essentially will quantify the quality of the wine.", "Below you\u2019ll see the implementation in Python using a combination of libraries: Pandas, Numpy, Scikit-learn, Matplotlib.", "wine.shape tells us we\u2019re dealing with 25 rows and 7 columns.", "Year: year in which grapes were harvested to make wine;Price: logarithm of the average market price for Bordeaux vintages according to 1990\u20131991 auctions; WinterRain: winter rainfall (in mm); AGST: Average Growing Season Temperature (in Celsius degrees); HarvestRain: harvest rainfall (in mm); Age: age of the wine measured as the number of years stored in a cask; FrancePop: population of France at Year (in thousands).", "Price is our dependent variable and the rest are independent variables we'll use to predict Price. Price quantifies the quality of wine.", "Now we create a one variable linear regression model to predict Price based on AGST.", "The x input array needs to be 2D, more precisely, to have as many number of rows and one column. Hence we have to reshape the array. reshape((-1,1)) : The \u2018-1\u2019 as the first argument lets numpy determine for you the unknown number of rows in the resulting matrix. The \u20181\u2019 specifies one column. The output is a 1 dimensional columnar array.", "Note: the unknown can be either columns or rows, not both.", "Next, we fit the linear regression model, model1, with the x and y values.", "With .fit(), the optimal values of the straight line y = mx+c are calculated, using the given input and output (x and y) as the arguments. It returns self, which is the variable model itself.", "The attributes of the calculated regression line, i.e., the model intercept and the slope are extracted as follows:", "y = slope * x + intercept", "You\u2019ll note that the intercept is scalar and the slope is an array.", "model1.score(AGST, Price) outputs the R-squared value of the model. R-squared is the measure of how close the given data is to the calculated regression line.", "Given our model (regression line) is of the form y=mx+c, R-squared is the sum of squared errors (the difference in the values between the actual data point y for a particular point x and the calculated value of y at that value of x according to the regression line).", "There is another \u201cvalue\u201d that can help us in predicting the quality of the model. This is the adjusted-R-squared.", "R-squared will always increase when we add more independent variables. So, R-squared is not an ideal way to measure whether another variable should be included in the model or not. But adjusted-R-squared (R-squared corrected according to the number of input variables) will decrease if it does not help the model. So, we should compute adjusted R-squared for every model that we create for comparisons.", "In our case, we replace y with Price and X with AGST.", "Let\u2019s add another independent variable \u2192 HarvestRain.", "Our y-value remains as it is. Again we have to reshape our input variables. Once reshaped, we combine the two independent variables into one matrix using np.concatenate. The axis = 1 specifies that they be concatenated along the column axis.", "The R-squared value, as expected, increased. But look at the adjusted-R-squared value \u2014 0.68 from a previous 0.41. This shows that adding the variable HarvestRain to model2 gave us a much better fitting model to predict Price!", "We can keep adding independent variables and comparing the adjusted-R-squared value to check if the model is getting better or worse. However, before going through the long process of creating a new model every time we add a new variable, we can figure out what variables need not be included using correlation.", "Correlation \u201crefers to the degree to which a pair of variables are linearly related\u201d. It ranges from -1 to +1. +1 means a perfect positive linear relationship; a correlation of -1 means a perfect negative linear relationship and correlation of 0, means that there is no linear relationship between the two variables.", "Let\u2019s find out the correlation between every variable with each other.", "Note that having a high correlation value between an independent variable and the dependent variable (Price) is a good thing. The issue arises when there is high correlation between two independent variables. This is called multi-collinearity.", "Note: \u2018high correlation\u2019 talks about the absolute value of correlation and hence includes both positives and negatives.", "Notice that Year and Age are absolutely negatively correlated (-1 correlation coefficient). This makes sense since the older the year the grapes were harvested, the older the age of the wine.", "Two other pairs of highly correlated independent variables is Year & FrancePop and Age & FrancePop.", "Again these correlations make sense because of the above reasoning. The population of France, FrancePop, increases with each Year. And again the Age of wine decreases with increase in Year.", "Because of multi-collinearity, we must remove the insignificant variables.", "If A is correlated with B, then we cannot interpret the coefficients of neither A nor B. To see why, imagine the extreme case when A=B (perfect correlation). Then, the model y=100A+50B is the same as the model y=5A+10B or y=-2000A+4000B.", "No optimal solution exists. We have to avoid these cases at all costs.", "We have to remove some independent variables out of Year, FrancePop and Age. Year is correlated to both FrancePop and Age and essentially is giving the same information as Age.", "After removing Year, we are still faced with the multi-collinearity issue between Age and FrancePop. FrancePop has nothing to do with the quality of wine. And so, we keep Age, which makes sense intuitively for our model, since older wines are typically more expensive.", "Note that doing away with all three- Year , Age and FrancePop will have lead us to creating a model with a very important feature missing \u2014 Age.", "The adjusted-R-squared for model3 is a jump from model2 going from 0.68 to 0.79! Looking great!", "You can most definitely try creating models without bothAge and FrancePop and one without Age and with FrancePop and see the difference in their scores.", "Finally what we\u2019ve all been waiting for. Great work for reaching here and thank you for taking out the time to go through this!", "We\u2019re happy with model3 and now we want to make predictions using this model.", "Read the test file into wine_test.", "wine_test.shape : 2 rows X 7 columns", "Let\u2019s first get the predicted response of model3:", "y_pred = model3.predict(X). We get an array of the predicted response. This was using the given values of AGST, HarvestRain, WinterRain and Age, with which we created model3.", "Let\u2019s now use new data in wine_test.", "y_pred_test gives us an array with values 6.7689 and 6.6849 for the first and second test points respectively.", "Looking at the given Price of the test points, we see that the actual price was 6.9541 and 6.4979 for the two test points respectively. This shows that our predictions are pretty good!", "Our test set is really small and so we should increase the size of the test set to be more confident about our model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer @Apple | Reader | Writer | The Sustainable Edit"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd0e414dc5065&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shivangisareen?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shivangisareen?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": "Shivangi Sareen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3dedb13989c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&user=Shivangi+Sareen&userId=3dedb13989c6&source=post_page-3dedb13989c6----d0e414dc5065---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0e414dc5065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0e414dc5065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kymellis?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Kym Ellis"}, {"url": "https://unsplash.com/s/photos/wine?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://bookdown.org/egarpor/SSS2-UC3M/multlin-examps.html", "anchor_text": "here"}, {"url": "https://rstudio-pubs-static.s3.amazonaws.com/326428_e7b3416aa30140e79f57b8ed70ca64e4.html", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/introducing-linear-regression-least-squares-the-easy-way-3a8b38565560", "anchor_text": "here"}, {"url": "https://datascience.stackexchange.com/questions/36404/when-to-remove-correlated-variables", "anchor_text": "source"}, {"url": "https://realpython.com/linear-regression-in-python/", "anchor_text": "Linear Regression in Python"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "sklearn.linear_model.LinearRegression"}, {"url": "https://medium.com/tag/python?source=post_page-----d0e414dc5065---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----d0e414dc5065---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/statistics?source=post_page-----d0e414dc5065---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/regression?source=post_page-----d0e414dc5065---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d0e414dc5065---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0e414dc5065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&user=Shivangi+Sareen&userId=3dedb13989c6&source=-----d0e414dc5065---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd0e414dc5065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&user=Shivangi+Sareen&userId=3dedb13989c6&source=-----d0e414dc5065---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd0e414dc5065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd0e414dc5065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d0e414dc5065---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d0e414dc5065--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d0e414dc5065--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d0e414dc5065--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d0e414dc5065--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shivangisareen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shivangisareen?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shivangi Sareen"}, {"url": "https://medium.com/@shivangisareen/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "668 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3dedb13989c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&user=Shivangi+Sareen&userId=3dedb13989c6&source=post_page-3dedb13989c6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5aef5c3fb45e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-in-python-the-bordeaux-equation-d0e414dc5065&newsletterV3=3dedb13989c6&newsletterV3Id=5aef5c3fb45e&user=Shivangi+Sareen&userId=3dedb13989c6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}