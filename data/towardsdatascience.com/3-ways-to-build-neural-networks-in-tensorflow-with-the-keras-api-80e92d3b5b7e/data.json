{"url": "https://towardsdatascience.com/3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e", "time": 1683014427.07341, "path": "towardsdatascience.com/3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e/", "webpage": {"metadata": {"title": "3 Ways to Build Neural Networks in TensorFlow with the Keras API | by Orhan Gazi Yal\u00e7\u0131n | Medium | Towards Data Science", "h1": "3 Ways to Build Neural Networks in TensorFlow with the Keras API", "description": "Building Deep Learning models with Keras in TensorFlow 2.x is possible with the Sequential API, the Functional API, and Model Subclassing"}, "outgoing_paragraph_urls": [{"url": "https://blog.tensorflow.org/2019/01/whats-coming-in-tensorflow-2-0.html", "anchor_text": "announced", "paragraph_index": 3}, {"url": "https://www.tensorflow.org/guide/estimator", "anchor_text": "Estimator API", "paragraph_index": 3}, {"url": "https://www.reddit.com/r/tensorflow/comments/czr0ms/tf2_keras_vs_estimators/", "anchor_text": "most of these advantages of the Estimator API", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/image-classification-in-10-minutes-with-mnist-dataset-54c35b77a38d", "anchor_text": "Image Classification", "paragraph_index": 9}, {"url": "http://Vizio.ai", "anchor_text": "Vizio.ai", "paragraph_index": 27}], "all_paragraphs": ["If you are going around, checking out different tutorials, doing Google searches, spending a lot of time on Stack Overflow about TensorFlow, you might have realized that there are a ton of different ways to build neural network models. This has been an issue for TensorFlow for a long time. It is almost like TensorFlow is trying to find its path towards a bright deep learning environment. Well if you think about it, this is exactly what is happening and this is pretty normal for a library in its version 2.x. Since TensorFlow is so far the most mature deep learning library on the market, this is basically the best you can get.", "TensorFlow\u2019s evolution into a deep learning platform did not happen overnight. Initially, TensorFlow marketed itself as a symbolic math library for dataflow programming across a range of tasks. Therefore, the value proposition that TensorFlow initially offered was not a pure machine learning library. The goal was to create an efficient math library so that custom machine learning algorithms that are built on top of this efficient structure would train in a short amount of time with high accuracy.", "However, building models from scratch with low-level APIs repetitively was not very ideal. So, Fran\u00e7ois Chollet, a Google engineer, developed Keras, as a separate high-level deep learning library. Although Keras has been capable of running on top of different libraries such as TensorFlow, Microsoft Cognitive Toolkit, Theano, or PlaidML, TensorFlow was and still is the most common library that people use Keras with.", "After seeing the messiness around the model-building process, the TensorFlow team announced that Keras is going to be the central high-level API used to build and train models in TensorFlow 2.0. The alternative high-level API, the Estimator API, has started to lose its already-diminishing popularity after this announcement.", "Now, let\u2019s go back to the problem: There are a lot of different methods that people build their models using TensorFlow. The main reason for this problem is TensorFlow\u2019s failure to adopt a single Model API.", "In version 1.x, for the production-level projects, the go-to model-building API was the Estimator API. But, with the recent changes, the Keras API has almost caught up with the Estimator API. Initially, the Estimator API was more scaleable, allowed multi-distribution, and had a convenient cross-platform functionality. Yet, most of these advantages of the Estimator API are now eliminated, and therefore, soon the Keras API will probably become the single standard API to build TensorFlow models.", "So, in this post, we will only focus on the Keras API methods to build models in TensorFlow and there are three of them:", "I will make their comparison directly with their corresponding model building codes so that you can actually test them yourself. Let\u2019s dive into coding.", "To test these three Keras methods, we need to select a deep learning problem. Image Classification with MNIST is a very straightforward task. What we are trying to achieve is training a model to recognize handwritten digits, using the famous MNIST dataset.", "MNIST dataset, which stands for Modified National Institute of Standards and Technology database, is a large database of handwritten digits that is commonly used for training various image processing systems. The MNIST database contains 60,000 training images and 10,000 testing images taken from American Census Bureau employees and American high school students. You can find my separate tutorial about Image Classification if you would like to follow the full tutorial.", "With the code below, we will import all layers and models so that it would not bother us in the upcoming parts. We also download the MNIST dataset and preprocess it so that it can be used in all models we will build with these three different methods. Just run the code below:", "Now, this part is out of the way, let\u2019s focus on the three methods to build TensorFlow models.", "There are three methods to build a Keras model in TensorFlow:", "Let\u2019s see how these methods are implemented. We will build a basic feedforward neural network with a single Flatten layer to convert 2-dimensional image arrays to 1-dimensional arrays and two Dense layers.", "In the Sequential API, we need to create a Sequential object from tf.keras.Models module. We can simply pass all the layers as a single argument in the list format as shown below. As you can see that it is very simple.", "With Functional API, we need to define our input separately. Then, we need to create an output object by also creating all the layers which are tied to one another and to the output. Finally, we create a Model object which would accept inputs and outputs as arguments. The code is still very clean, but we have much more flexibility in the Functional API.", "Let\u2019s move on to model subclassing. In model subclassing, we start with creating a class extending tf.keras.Model class. There are two crucial functions in Model subclassing:", "To build the same model with Model Subclassing, we need to write much more code, as shown below:", "Now that you can create the same model with three different methods, you can choose any single one of them, build the model, and run the code below.", "The lines above take care of model configuration, training, and evaluation. When we compare the performances of these three methods, we see that they are pretty close but slightly different.", "Our more complex Model Subclassing method outperforms the Sequential API and the Functional API. This shows that there are slight differences in the design of these methods in the low-end as well. However, these differences are negligible.", "By now, you have an idea about the similarities and differences between these three Keras methods. But, let\u2019s summarize them all in a table:", "In summary, if you are just starting out, stick with the Sequential API. As you dive into more complex models, try out the Functional API. If you are doing a Ph.D. or just enjoy conducting independent research , try out Model Subclassing. If you are a professional, stick with the Functional API. It will probably satisfy your needs.", "Let me know your favorite method to build Keras models in the comments.", "If you would like to have access to full code on Google Colab and have access to my latest content, subscribe to the mailing list: \u2709\ufe0f", "If you like this article, consider checking out my other similar articles:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about AI and data apps here building them at Vizio.ai with my team. Feel free to get in touch!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F80e92d3b5b7e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://blog.orhangaziyalcin.com/?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": ""}, {"url": "https://blog.orhangaziyalcin.com/?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": "Orhan G. Yal\u00e7\u0131n"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff47ab81282a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=post_page-ff47ab81282a----80e92d3b5b7e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F80e92d3b5b7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F80e92d3b5b7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://blog.tensorflow.org/2019/01/whats-coming-in-tensorflow-2-0.html", "anchor_text": "announced"}, {"url": "https://www.tensorflow.org/guide/estimator", "anchor_text": "Estimator API"}, {"url": "https://www.reddit.com/r/tensorflow/comments/czr0ms/tf2_keras_vs_estimators/", "anchor_text": "most of these advantages of the Estimator API"}, {"url": "https://towardsdatascience.com/image-classification-in-10-minutes-with-mnist-dataset-54c35b77a38d", "anchor_text": "Image Classification"}, {"url": "https://towardsdatascience.com/image-classification-in-10-minutes-with-mnist-dataset-54c35b77a38d", "anchor_text": "Image Classification in 10 Minutes with MNIST DatasetUsing Convolutional Neural Networks to Classify Handwritten Digits with TensorFlow and Keras | Supervised Deep Learningtowardsdatascience.com"}, {"url": "https://unsplash.com/@jon_chng?utm_source=medium&utm_medium=referral", "anchor_text": "Jonathan Chng"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://eepurl.com/hd6Xfv", "anchor_text": "Subscribe Now"}, {"url": "https://towardsdatascience.com/4-pre-trained-cnn-models-to-use-for-computer-vision-with-transfer-learning-885cb1b2dfc", "anchor_text": "4 Pre-Trained CNN Models to Use for Computer Vision with Transfer LearningUsing State-of-the-Art Pre-trained Neural Network Models to Tackle Computer Vision Problems with Transfer Learningtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/fast-neural-style-transfer-in-5-minutes-with-tensorflow-hub-magenta-110b60431dcc", "anchor_text": "Fast Neural Style Transfer in 5 Minutes with TensorFlow Hub & MagentaTransferring the van Gogh\u2019s Unique Style to Photos with Magenta\u2019s Arbitrary Image Stylization Network and Deep Learningtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/image-classification-in-10-minutes-with-mnist-dataset-54c35b77a38d", "anchor_text": "Image Classification in 10 Minutes with MNIST DatasetUsing Convolutional Neural Networks to Classify Handwritten Digits with TensorFlow and Keras | Supervised Deep Learningtowardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----80e92d3b5b7e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----80e92d3b5b7e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----80e92d3b5b7e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----80e92d3b5b7e---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----80e92d3b5b7e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F80e92d3b5b7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=-----80e92d3b5b7e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F80e92d3b5b7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=-----80e92d3b5b7e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F80e92d3b5b7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F80e92d3b5b7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----80e92d3b5b7e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----80e92d3b5b7e--------------------------------", "anchor_text": ""}, {"url": "https://blog.orhangaziyalcin.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://blog.orhangaziyalcin.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Orhan G. Yal\u00e7\u0131n"}, {"url": "https://blog.orhangaziyalcin.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "http://Vizio.ai", "anchor_text": "Vizio.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fff47ab81282a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=post_page-ff47ab81282a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6340e0deb03&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-ways-to-build-neural-networks-in-tensorflow-with-the-keras-api-80e92d3b5b7e&newsletterV3=ff47ab81282a&newsletterV3Id=6340e0deb03&user=Orhan+G.+Yal%C3%A7%C4%B1n&userId=ff47ab81282a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}