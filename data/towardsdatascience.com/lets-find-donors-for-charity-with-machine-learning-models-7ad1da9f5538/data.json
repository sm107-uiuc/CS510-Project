{"url": "https://towardsdatascience.com/lets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538", "time": 1682994400.471382, "path": "towardsdatascience.com/lets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538/", "webpage": {"metadata": {"title": "Let\u2019s Find Donors For Charity With Machine Learning Models | by Andrei G | Towards Data Science", "h1": "Let\u2019s Find Donors For Charity With Machine Learning Models", "description": "Welcome to my second medium post about Data Science. I will write here about a project I\u2019ve done using Machine Learning algorithms. I will explain what I did without relying heavily on technical\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/andreigalanciuc/MACHINE-LEARNING-FINDING-DONORS/blob/master/finding_donors_final.ipynb", "anchor_text": "github", "paragraph_index": 24}], "all_paragraphs": ["Welcome to my second medium post about Data Science. I will write here about a project I\u2019ve done using Machine Learning algorithms. I will explain what I did without relying heavily on technical language, but I will show snippets of my code. Code matters :)", "The project is a hypothetical case study where I had to identify potential donors to a charity that offers funding to people willing to study machine learning in Silicon Valley. This charity, named CharitML found that every donor was making more than $50,000 annually. My task was to use machine learning algorithms to help this charity identify potential donors in the entire region of California.", "For the purposes of this project, I used supervised machine learning. Supervised learning is where you have input variables (X) and an output variable (Y ) and you use an algorithm to learn the mapping function from the input to the output. I will describe the steps I took to get from a messy data set to a good working model.", "It\u2019s always good to start with exploring the data. Basically, look for the total number of observations, total number of features, missing values, which features should be encoded etc. And most importantly, look for the characteristics specific to the problem you are solving. In this case I was interested in how many people make more and less than $50,000 annually.", "A data set may sometimes contain at least one feature whose values tend to lie near a single number, but will also have a non-trivial number of vastly larger or smaller values than that single number. Algorithms can be sensitive to such distributions of values and can under perform if the range is not properly normalized. With our data set two features fit this description: \u2018capital-gain' and 'capital-loss'.", "It is often good practice to perform some type of scaling on numerical features. Applying a scaling to the data does not change the shape of each feature\u2019s distribution (such as 'capital-gain' or 'capital-loss' above); however, normalization ensures that each feature is treated equally when applying supervised learners. The features will range between the values of 0 and 1.", "Typically, learning algorithms expect inputs to be numeric, which requires that non-numeric features (called categorical variables) be converted. One popular way to convert categorical variables is by using the one-hot encoding scheme. One-hot encoding creates a \u201cdummy\u201d variable for each possible category of each non-numeric feature.", "Now all categorical variables have been converted into numerical features, and all numerical features have been normalized. As always, we will now split the data (both features and their labels) into training and test sets. 80% of the data will be used for training and 20% for testing.", "Before I get into the different models I tested for this project, I will elaborate on how we judge the quality of a model. What do we look at when deciding which model to choose? There is always going to be a trade-off between how well we want the model to predict and how computationally expensive it is; or how long it takes to train it.", "The three main metrics of model performance are: accuracy, precision and recall.", "Accuracy measures how often the classifier makes the correct prediction. It\u2019s the ratio of the number of correct predictions to the total number of predictions (the number of test data points).", "Precision tells us what proportion of messages we classified as spam, actually were spam. It is a ratio of true positives(words classified as spam, and which are actually spam) to all positives(all words classified as spam, irrespective of whether that was the correct classification).", "Recall(sensitivity) tells us what proportion of messages that actually were spam were classified by us as spam. It is a ratio of true positives(words classified as spam, and which are actually spam) to all the words that were actually spam.", "The different measures matter in varying degrees in different problems. Hence we should know which metric matters for us more. For instance identifying someone that does not make more than $50,000 as someone who does would be detrimental to CharityML, since they are looking to find individuals willing to donate. Therefore, a model\u2019s ability to precisely predict those that make more than $50,000 is more important than the model\u2019s ability to recall those individuals.", "We can use F-beta score as a metric that considers both precision and recall:", "If we chose a model that always predicted an individual made more than $50,000, what would that model\u2019s accuracy and F-score be on this data set? We want to know how a model without training would look like.", "Out of these options, I tried and tested three of them: SVM, ADABOOST and Random Forrest.", "The Adaboost model is best suitable for our problem. The F score on the testing data set is the highest for Adaboost. Besides that, there is not a big difference in F-scores between the training and testing sets like with RandomForest. This matters because we do not want our model to overfit on the training set and return us an inflated F score. The accuracy score and F score are highest for Adaboost at all training set sizes. The training and testing times are very low, which means that the model is computationally fast. The iterative aspect of the model makes it handle well a high number of attributes like in our case. Hence it is a good choice.", "Adaboost, short for adaptive boosting is an ensemble algorithm. The Adaboost algorithm uses iterative training to give an accurate model. It starts with a weak learner which is the initial classification of the data. Namely, the classification is done with decision stumps. This means that the classification is done just with a line that separates the data. It is called \u2018weak\u2019 because the data is not classified very well yet. But due to the further iterations, the model makes the learners focus on the misclassified points. To be more precise, in the first step the weak learner separates the data and all the points are weighted equally. If there are misclassified points, in the second iteration the weak learner tries to capture most of these previous errors and it assigns them higher weights. The essence is that the model focuses on the errors by weighing them more. This iterative process continues as long as we assign it to do it. As a result, with every iteration, the model captures better and better the data. The weak learners are combined and they are assigned weights respective to their performance. Predictions are made by calculating the weighted average of the weak classifiers. The final learner is a strong learner combined from the weak ones.", "We can improve the chosen model further by using Grid Search. The idea is to use different values for some parameters like number of estimators or learning rate, in order to achieve better performance metrics.", "We can see that the optimized model performed better than the unoptimized model. The accuracy score increased from 0.8576 to 0.8651, and the F-score increased from 0.7246 to 0.7396. Remember that the Naive Predictor gave us an accuracy score of 0.2478 and F-score of 0.2917, which is not surprising because the naive model doesn\u2019t do any training on the data.", "Out of the 13 features in this data set, I was curious to see which ones have the highest predictive power. And what would happen if we used only those in our model?", "In the reduced model both the accuracy and F-score decreased. Less features in this case made the model generalize a bit worse, compared to the full model. However the reduction in scores is not high. In return training time is faster because the model contains less features. Hence, if training time was a factor, this trade off would make sense because we would not lose much in terms of performance.", "So what did we do? We got a data set and we set a target to classify people that make more than $50,000 annually. We cleaned the data, normalized and converted the necessary variables into numerical features so that we can use them in our models. We shuffled and split our data into training and testing sets. We set a baseline predictor and built three other models. We chose the ADABOOST model as the best choice. We tuned it further and made it slightly better. We tried to use the model with only the five main features but it performed slightly worse.", "This was it :) If you made it through here, I want to say a big thank you. I hope this was a good and clear application of supervised machine learning. It is a powerful tool in data science; something that I am currently studying and want to master. Feel free to comment below if you have questions and you can always have a look at this project, including many others on my github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Improvising entrepreneur. Building an app that helps students complete their school work."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7ad1da9f5538&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@andreigalanchuk?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreigalanchuk?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": "Andrei G"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe340d8809fcd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&user=Andrei+G&userId=e340d8809fcd&source=post_page-e340d8809fcd----7ad1da9f5538---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ad1da9f5538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ad1da9f5538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/andreigalanciuc/MACHINE-LEARNING-FINDING-DONORS/blob/master/finding_donors_final.ipynb", "anchor_text": "github"}, {"url": "https://www.linkedin.com/in/andreigalanchuk/", "anchor_text": "https://www.linkedin.com/in/andreigalanchuk/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7ad1da9f5538---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7ad1da9f5538---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----7ad1da9f5538---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7ad1da9f5538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&user=Andrei+G&userId=e340d8809fcd&source=-----7ad1da9f5538---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7ad1da9f5538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&user=Andrei+G&userId=e340d8809fcd&source=-----7ad1da9f5538---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ad1da9f5538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7ad1da9f5538&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7ad1da9f5538---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7ad1da9f5538--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreigalanchuk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreigalanchuk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrei G"}, {"url": "https://medium.com/@andreigalanchuk/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "142 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe340d8809fcd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&user=Andrei+G&userId=e340d8809fcd&source=post_page-e340d8809fcd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe340d8809fcd%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-find-donors-for-charity-with-machine-learning-models-7ad1da9f5538&user=Andrei+G&userId=e340d8809fcd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}