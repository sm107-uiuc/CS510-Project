{"url": "https://towardsdatascience.com/classifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb", "time": 1683005347.830821, "path": "towardsdatascience.com/classifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb/", "webpage": {"metadata": {"title": "How to Classify Cat Pics with a Logistic Regression Model | by Bryan Tan | Towards Data Science", "h1": "How to Classify Cat Pics with a Logistic Regression Model", "description": "Be it when I\u2019m preoccupied with semester exams or house chores, I would always find myself gravitating towards an orbit of cat videos. And, crucially, the happiness induced by the cats undertaking\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/TheClub4/Cat_Classification", "anchor_text": "here", "paragraph_index": 2}, {"url": "http://localhost:8888/notebooks/Documents/Cat_Classification/Cat_classification.ipynb#", "anchor_text": "Github repository", "paragraph_index": 11}, {"url": "https://github.com/TheClub4/Cat_Classification", "anchor_text": "https://github.com/TheClub4/Cat_Classification", "paragraph_index": 27}], "all_paragraphs": ["Be it when I\u2019m preoccupied with semester exams or house chores, I would always find myself gravitating towards an orbit of cat videos. And, crucially, the happiness induced by the cats undertaking half-witted deeds with their adorable paws outweighs the guilt of procrastination. I thought to myself, why not incorporate two of my greatest interests \u2014 cats and machine learning \u2014 for the greater good of technological betterment. Hence, an impromptu Cat image classification with a 2-layer neural network (it is essentially a Logistic Regression model).", "This tutorial focuses on designing a simple Logistic Regression algorithm, with a Neural Network mindset, to distinguish cat images from non-cat images.", "This article merely concerns the abstract concept of the tutorial; for an in-depth look into the code, please refer to the Github repository here. The repository also features an L-layer deep neural network which outperforms the 2-layer model.", "For convenience, we should reshape the images\u2019 shapes (num_px, num_px, 3) into a numpy-array of shape (num_px \u2217 num_px \u2217 3, 1). After this, our training and test dataset will converted to a numpy-array where each column represents a flattened image. There should be m_train, and respectively m_test, columns.", "To represent color images, the red, green and blue channels (RGB) must be specified for each pixel; hence, the each pixel value is actually a vector of three numbers ranging from 0 to 255.", "One common preprocessing step in machine learning is to center and standardize your dataset, meaning that we subtract the mean of the whole numpy array from each example, and then divide each example by the standard deviation of the whole numpy array. Though, for picture datasets, it is simpler and more convenient to just divide every row of the dataset by 255 (the maximum value of a pixel channel).", "The flattened input matrices will be passed through parameters of weighted matrices, W[i], and bias vectors, b[i]. The value of Yhat will then be predicted by passing the parameters through a sigmoid activation function. From the values of the parameters and their corresponding Yhat values , we can minimize the cost by computing the cost function; then learn the parameters for modeling.", "The main steps for building a Neural Network are:", "We often implement the functions/steps 1\u20133 separately then integrating them into a single function we call model().", "We will first implement the sigmoid function using the mathematical expression:", "We have to initialize W and b as vectors of zeros.", "Note: Conventionally, in deeper neural networks (with more layers and neurons), we usually initialize the vector W randomly. This is because each neuron in the first hidden layer will perform the same computation. So even after multiple iterations of gradient descent each neuron in the layer will be computing the same thing as other neurons. Refer to Github repository for more info.", "Now that our parameters are initialized, we can initiate the \u201cforward\u201d and \u201cbackward\u201d propagation steps for learning the parameters.", "Now that we have initialized our parameters and computed a cost function and its gradient, we will proceed to update our parameters using gradient descent.", "The goal is to learn parameters w and b by minimizing the cost function J. For a parameter \u03b8, the update rule is \u03b8 = \u03b8 \u2212 \u03b1d\u03b8, where \u03b1 is the learning rate.", "The previous function will output the learned w and b; hence, we are able to use w and b to predict the labels for a dataset X by implementing the predict()function. There are two steps to computing predictions:", "We will now see how the overall model is structured by putting together all the building blocks (functions implemented in the previous parts) together, in the right order.", "The training accuracy is close to 100%. This is a good sanity check: our model works and has a high enough capacity to fit the training data. On the other hand, the test accuracy is 70%.It is actually not bad for this simple model, given the small dataset we used and that logistic regression is a linear classifier.", "Interpretation: You can see the cost decreasing. This shows that the parameters are being learned. However, you see that you could train the model even more on the training set. Try to increase the number of iterations in the cell above and rerun the cells. You might see that the training set accuracy goes up, but the test set accuracy goes down. This is called overfitting.", "In order for Gradient Descent to work, you must choose the learning rate wisely. The learning rate \u03b1 determines how rapidly we update the parameters. If the learning rate is too large, we may \u201covershoot\u201d the optimal value. Similarly, if it is too small, we will need an exceeding number of iterations to converge to the best values. That\u2019s why it is crucial to use a well-tuned learning rate.", "Let\u2019s compare the learning curve of our model with several choices of learning rates. Feel free also to try different values than the three we have initialized the learning_rates variable to contain, and see what happens.", "In Deep Learning, it is usually recommended that you choose the learning rate that best minimizes the cost function. If your model overfits, use other techniques to reduce overfitting, e.g., hyperparameter tuning.", "Let\u2019s take a look at some images the model labeled incorrectly. This will show a few mislabeled images.", "A few types of images the model tends to do poorly on include:", "Here\u2019s a sample kitten image I found on Unsplash and decided to test it on the model:", "Guess what was the model output:", "Hurray! Although this was derived from a simple Logistic Regression model, it was rewarding nonetheless\u200a\u2014\u200acats are always a win. Head to the Github repository for an in-depth look into classifying cat images using a 2-layer neural network and an L-layer deep neural network.", "[1] Github repository for 2-layer and L-layer deep neural network classification: https://github.com/TheClub4/Cat_Classification", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "19, Data Science Intern. I write maths & ai."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe35dfb9159bb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bryantanjw?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bryantanjw?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": "Bryan Tan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cdfc2e9a731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&user=Bryan+Tan&userId=7cdfc2e9a731&source=post_page-7cdfc2e9a731----e35dfb9159bb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe35dfb9159bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe35dfb9159bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/TheClub4/Cat_Classification", "anchor_text": "here"}, {"url": "http://localhost:8888/notebooks/Documents/Cat_Classification/Cat_classification.ipynb#", "anchor_text": "Github repository"}, {"url": "https://unsplash.com/photos/bmGy-eqrl1k", "anchor_text": "Unsplash"}, {"url": "https://www.deeplearning.ai", "anchor_text": "deeplearning.ai"}, {"url": "https://github.com/TheClub4/Cat_Classification", "anchor_text": "https://github.com/TheClub4/Cat_Classification"}, {"url": "http://stackoverflow.com/questions/1907993/autoreload-of-modules-in-ipython", "anchor_text": "http://stackoverflow.com/questions/1907993/autoreload-of-modules-in-ipython"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e35dfb9159bb---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/logistics?source=post_page-----e35dfb9159bb---------------logistics-----------------", "anchor_text": "Logistics"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----e35dfb9159bb---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e35dfb9159bb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----e35dfb9159bb---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe35dfb9159bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&user=Bryan+Tan&userId=7cdfc2e9a731&source=-----e35dfb9159bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe35dfb9159bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&user=Bryan+Tan&userId=7cdfc2e9a731&source=-----e35dfb9159bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe35dfb9159bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe35dfb9159bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e35dfb9159bb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e35dfb9159bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bryantanjw?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bryantanjw?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bryan Tan"}, {"url": "https://medium.com/@bryantanjw/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "306 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cdfc2e9a731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&user=Bryan+Tan&userId=7cdfc2e9a731&source=post_page-7cdfc2e9a731--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F32dd6de2739d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-cat-pics-with-a-logistic-regression-model-e35dfb9159bb&newsletterV3=7cdfc2e9a731&newsletterV3Id=32dd6de2739d&user=Bryan+Tan&userId=7cdfc2e9a731&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}