{"url": "https://towardsdatascience.com/how-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1", "time": 1683006271.149415, "path": "towardsdatascience.com/how-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1/", "webpage": {"metadata": {"title": "How to Efficiently Fine-Tune your Machine Learning Models | by Khuyen Tran | Towards Data Science", "h1": "How to Efficiently Fine-Tune your Machine Learning Models", "description": "Have you ever wanted to experiment with different parameters for your model but find it really time-consuming to do so? Let\u2019s say you want to use support vector machines (SVM) to train and predict\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "sklearn.pipeline.Pipeline", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/compose.html", "anchor_text": "sklearn.model_selection.GridSearchCV", "paragraph_index": 9}, {"url": "https://mlflow.org/docs/latest/index.html", "anchor_text": "MLflow", "paragraph_index": 15}, {"url": "http://127.0.0.1:5000", "anchor_text": "http://localhost:5000", "paragraph_index": 21}, {"url": "https://github.com/khuyentran1401/Machine-learning-pipeline", "anchor_text": "here", "paragraph_index": 23}, {"url": "https://www.linkedin.com/in/khuyen-tran-1401/", "anchor_text": "LinkedIn", "paragraph_index": 24}, {"url": "https://twitter.com/KhuyenTran16", "anchor_text": "Twitter", "paragraph_index": 24}, {"url": "https://github.com/khuyentran1401/Data-science", "anchor_text": "this repo", "paragraph_index": 25}], "all_paragraphs": ["Have you ever wanted to experiment with different parameters for your model but find it really time-consuming to do so? Let\u2019s say you want to use support vector machines (SVM) to train and predict the model.", "You debate what could be the best value for C so you keep experimenting with different values of C manually and hopefully get good results. That is time-consuming but still not so bad.", "But what if you want to first use sklearn.feature_extraction.text.TfidfVectorizer to extract important texts, then use sklearn.feature_selection.SelectKBest to find the best features, and finally use sklearn.SVM.LinearSVCto train and predict the model? There would be so many parameters to tune in. Plus you need to find a way to record the results for comparison. So your notebook can look like a mess!", "Is there a better way to select the parameters, shorten the code, as well as save the results for comparison? Yes, of course! Our method will be like a delicious cake with three simple ingredients:", "Have all the ingredients you need? Awesome! Now we are ready to put them together.", "What is pipeline? sklearn.pipeline.Pipeline allows us to combine a list of transforms and a final estimator into a chain.", "For example, to predict whether a tweet is aggressive or not, after processing the text, we usetfidf_vectorizer, and SelectKBest as the transformers and svm.LinearSVC as a final estimator.", "The codes above could be combined into a pipeline with a list of steps represented as tuples. In each tuple, the first parameter is the name of the class, and the second parameter is the class.", "Much shorter and organized! We could easily switch any of the steps to another transformer or estimator. Make sure the classes in the pipeline are from sklearn. If they are not, you could easily create customized sklearn classes with def __init__, def fit(), and def transform() like this.", "So we got the pipeline ready to transform and predict our data. But how about parameter tuning? We could easily find the best parameters for transformers and estimator in our pipeline with sklearn.model_selection.GridSearchCV.", "Let\u2019s say we want to find the best value of k for SelectKBest, the best value of C for svm.LinearSVC, best values of analyzer, ngram_range, and binary for TfidfVectorizer. We could give our grid several parameters to search for. The parameters are represented as lists nested inside a dictionary.", "To set the parameters of a particular class, we use class_name__parameter = [para_1, para_2, para_3]. Make sure to have two underscores between class\u2019s name and parameter.", "grid_search.fit(X_train, y_train) creates several runs using different parameters with specified transformations, and estimator. The combination of parameters yielding the best result will be chosen for the transformation step.", "We could also create other pipelines with different transformers and estimators and again use GridSearchCV to find the best parameters! But how could we save the results of all the runs we perform?", "It is possible to observe the results by scrolling up and down the screen or taking photos of the results. But that is time-consuming, not taking into account that we might want to look at the results later for future projects. Is there a better way to track our results? That is when we need a tracking tool like MLflow", "MLflow is a tool for managing the end-to-end machine learning lifecycle including tracking experiments, packaging ML code in a reproducible form for sharing, and deployment. We will utilize this tool to keep the log of our results.", "Installation of MLflow can be just simple as this", "Let\u2019s combine what we have done so far and MLflow tracking tool", "In this code, we just add three elements to log the results:", "Save the file above as train.py. The last step is to run the file", "After the code finish running, we could find the log of MLflow by running", "Access to the link http://localhost:5000 and we should see this", "As we can see from above, the metrics and the parameters of the experiments are logged! We could create several experiments and log the results of those experiments for easy and efficient comparison.", "Congratulations! You have learned how to tune parameters for your machine learning models efficiently with Pipeline, GridSearchCV, and MLflow. You could find similar example codes for this article here. I encourage you to try out these methods with your existing machine learning projects. Just a little change in your coding approach can make a big difference in the long run. Experimenting and tracking the results efficiently will not only save you time but also make it much easier to find the best parameters and learn from your experiments.", "I like to write about basic data science concepts and play with different algorithms and data science tools. You could connect with me on LinkedIn and Twitter.", "Star this repo if you want to check out the codes for all of the articles I have written. Follow me on Medium to stay informed with my latest data science articles like these:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8ca62d1217b1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://khuyentran1476.medium.com/?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": ""}, {"url": "https://khuyentran1476.medium.com/?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": "Khuyen Tran"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84a02493194a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&user=Khuyen+Tran&userId=84a02493194a&source=post_page-84a02493194a----8ca62d1217b1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ca62d1217b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ca62d1217b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@drewpatrickmiller?utm_source=medium&utm_medium=referral", "anchor_text": "Drew Patrick Miller"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html", "anchor_text": "sklearn.pipeline.Pipeline"}, {"url": "https://github.com/khuyentran1401/Speed-Dating/blob/master/preprocessors.py", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/compose.html", "anchor_text": "sklearn.model_selection.GridSearchCV"}, {"url": "https://mlflow.org/docs/latest/index.html", "anchor_text": "MLflow"}, {"url": "http://127.0.0.1:5000", "anchor_text": "http://localhost:5000"}, {"url": "https://github.com/khuyentran1401/Machine-learning-pipeline", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/khuyen-tran-1401/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/KhuyenTran16", "anchor_text": "Twitter"}, {"url": "https://github.com/khuyentran1401/Data-science", "anchor_text": "this repo"}, {"url": "https://towardsdatascience.com/how-to-organize-your-data-science-articles-with-github-b5b9427dad37", "anchor_text": "How to Organize your Data Science Articles with GithubOverwhelmed by New Information? Now you can Keep Track and Create Customized Notes for your Articles with Easetowardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-to-create-a-drop-down-menu-and-a-slide-bar-for-your-favorite-visualization-tool-3a50b7c9ea01", "anchor_text": "How to Create a Drop-Down Menu and a Slide Bar for your Favorite Visualization ToolWith Python Widget, you can Upgrade your Visualization in 3 Lines of Codestowardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-to-share-your-jupyter-notebook-in-3-lines-of-code-with-ngrok-bfe1495a9c0c", "anchor_text": "How to Share your Jupyter Notebook in 3 Lines of Code with NgrokImagine having your Friends Working with your Local Jupyter Notebook in a Remote Machinetowardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-to-monitor-and-log-your-machine-learning-experiment-remotely-with-hyperdash-aa7106b15509", "anchor_text": "How to Monitor And Log your Machine Learning Experiment Remotely with HyperDashThe Training Takes a Long Time to Finish, but You Need a Bathroom Break\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/cython-a-speed-up-tool-for-your-python-function-9bab64364bfd", "anchor_text": "Cython-A Speed-Up Tool for your Python FunctionWhen tweaking your algorithm gives small improvements, you may want to get an additional speed up with Cython, a\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/python?source=post_page-----8ca62d1217b1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8ca62d1217b1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8ca62d1217b1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----8ca62d1217b1---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/pipeline?source=post_page-----8ca62d1217b1---------------pipeline-----------------", "anchor_text": "Pipeline"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ca62d1217b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&user=Khuyen+Tran&userId=84a02493194a&source=-----8ca62d1217b1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8ca62d1217b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&user=Khuyen+Tran&userId=84a02493194a&source=-----8ca62d1217b1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8ca62d1217b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8ca62d1217b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8ca62d1217b1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8ca62d1217b1--------------------------------", "anchor_text": ""}, {"url": "https://khuyentran1476.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://khuyentran1476.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Khuyen Tran"}, {"url": "https://khuyentran1476.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "34K Followers"}, {"url": "https://mathdatasimplified.com", "anchor_text": "https://mathdatasimplified.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84a02493194a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&user=Khuyen+Tran&userId=84a02493194a&source=post_page-84a02493194a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fde46523b7a77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1&newsletterV3=84a02493194a&newsletterV3Id=de46523b7a77&user=Khuyen+Tran&userId=84a02493194a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}