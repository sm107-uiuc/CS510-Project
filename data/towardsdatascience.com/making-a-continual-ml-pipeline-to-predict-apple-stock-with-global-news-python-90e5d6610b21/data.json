{"url": "https://towardsdatascience.com/making-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21", "time": 1683003870.6239202, "path": "towardsdatascience.com/making-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21/", "webpage": {"metadata": {"title": "Outstanding results predicting Apple Stock with Continual ML using Global News (with Python) | by Federico Riveroll | Towards Data Science", "h1": "Outstanding results predicting Apple Stock with Continual ML using Global News (with Python)", "description": "In this tutorial we\u2019ll make a Machine Learning Pipeline that inputs Business News and generates predictions for Apple Stock Price re-training through time. Note: To get a token you need have to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.openblender.io/#/dataset/explore/5d4c39d09516290b01c8307b/or/32", "anchor_text": "Apple Stock Price", "paragraph_index": 0}, {"url": "https://www.openblender.io/#/dataset/explore/5d4c39d09516290b01c8307b/or/32", "anchor_text": "Apple Stock dataset", "paragraph_index": 2}, {"url": "https://www.openblender.io/#/welcome/or/32", "anchor_text": "openblender.io", "paragraph_index": 5}, {"url": "https://www.openblender.io/#/dataset/explore/5e2ef74e9516294390e810a9/or/32", "anchor_text": "Wall Street Journal News", "paragraph_index": 16}, {"url": "https://www.openblender.io/#/dataset/explore/5e32fd289516291e346c1726/or/32", "anchor_text": "USA Today", "paragraph_index": 17}], "all_paragraphs": ["In this tutorial we\u2019ll make a Machine Learning Pipeline that inputs Business News and generates predictions for Apple Stock Price re-training through time.", "We\u2019ll also measure how profitable it is in real life.", "We\u2019ll use this daily Apple Stock dataset", "It has the daily high, low, open and close prices and the percentual change during that day.", "So let\u2019s pull the data through the OpenBlender API. Open a python script and run the following code:", "Note: To get a token you need have to create an account on openblender.io (free ), you\u2019ll find it in the \u2018Account\u2019 tab on your profile icon.", "Now let\u2019s look at the data:", "Let\u2019s plot the price and Change :", "Now, what we want is to detect if the price is going to increase or decrease on the next day so we can buy or short.", "The \u2018change\u2019 is the percentual increase or decrease that happened between the opening and closing price, so it works for us.", "Let\u2019s define our target variable as an increase larger than 0.5% (so that it\u2019s wortwile to make a purchase):", "Positive POC: Where \u2018change\u2019 increased more than 0.5%", "This means all the observations to the right side of the green line would be our \u2018success\u2019 scenarios.", "This is very simple to execute, but let\u2019s try and understand what\u2019s happening in the background.", "So let\u2019s look for time overlapped business news datasets:", "We can see the time overlapped (intersection) datasets with some of their attributes and even a url to see the interface.", "So let\u2019s pick this Wall Street Journal News dataset:", "And This USA Today Twitter news.", "We can blend new columns to our dataset by searching terms on news aggregated by time. For instance, we could create an \u2018apple\u2019 feature with the number of news from the \u2018Wall Street\u2019 dataset which match our self made ngrams:", "The parameters for the timeBlend function:", "The output are 2 new columns, the \u2018COUNT\u2019 of our \u2018apple\u2019 feature and a list of the actual news in case one wants to iterate through each one.", "Now let\u2019s create a text vectorizer, which is a model on OpenBlender from which you can then pull thousands of computarized ngrams as features:", "From above, we specified the following:", "Now, if we go to our dashboard at OpenBlender, we can see the vectorizer:", "It generated 4999 n-grams which are binary features of tokens of max 2 words which are \u201c1\u201d if the n-gram was mentioned and \u201c0\u201d if else.", "Now we want the vectorized data compressed in 24 hour time lags and aligned with the Apple stock price from the next day.", "You need to add your vectorizer\u2019s id (it was printed when you created it or you can get it in OpenBlender.", "Now we have 1068 observations and 4887 features. Our original dataset plus the vectorized and aggregated news from the previous 24 hours.", "There isn\u2019t much more wrangling or cleansing to do, we just need to create our target features positive POC and negative POC (We\u2019ll use \u2018positive POC\u2019 for our purpose as defined earlier).", "Now we have the \u2018target\u2019 feature which simply aligns the \u2018change\u2019 values with the \u201cprevious day data\u201d which is exactly what we need. The most recent observation (the last) is NaN because that\u2019s what we would want to predict for \u2018tomorrow\u2019.", "Now, let\u2019s try some ML to learn and predict the target.", "Now let\u2019s train the model and predict:", "This is pretty amazing if I do say so myself.", "This means that from all the times this model predicted that the following day the price change would increase 0.5% or more, it was correct 72% of the times. I don\u2019t know of any real life model that even compares to this.", "If we ran the model at the end of one day, we could buy/short the following day in the morning expecting the result by the end of the day.", "*Side note: If any of you run this into production for auto trading (or manual trading) at least send me a gift.", "Now, we want a methodology in which the data is trained and tested throgh time to see if the results are consistent.", "So let\u2019s run what we just did but breaking data in thime in a loop.", "We can see the metrics increasing and stabilizing trough time!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An attempt to separate signal from noise. | MSDS"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F90e5d6610b21&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://federicoriveroll.medium.com/?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": "Federico Riveroll"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6be3377832b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&user=Federico+Riveroll&userId=b6be3377832b&source=post_page-b6be3377832b----90e5d6610b21---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90e5d6610b21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90e5d6610b21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.openblender.io/#/dataset/explore/5d4c39d09516290b01c8307b/or/32", "anchor_text": "Apple Stock Price"}, {"url": "https://www.openblender.io/#/dataset/explore/5d4c39d09516290b01c8307b/or/32", "anchor_text": "Apple Stock dataset"}, {"url": "https://www.openblender.io/#/welcome/or/32", "anchor_text": "openblender.io"}, {"url": "https://www.openblender.io/#/dataset/explore/5e2ef74e9516294390e810a9/or/32", "anchor_text": "Wall Street Journal News"}, {"url": "https://www.openblender.io/#/dataset/explore/5e32fd289516291e346c1726/or/32", "anchor_text": "USA Today"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----90e5d6610b21---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----90e5d6610b21---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/python?source=post_page-----90e5d6610b21---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----90e5d6610b21---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----90e5d6610b21---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F90e5d6610b21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&user=Federico+Riveroll&userId=b6be3377832b&source=-----90e5d6610b21---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F90e5d6610b21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&user=Federico+Riveroll&userId=b6be3377832b&source=-----90e5d6610b21---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F90e5d6610b21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F90e5d6610b21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----90e5d6610b21---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----90e5d6610b21--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----90e5d6610b21--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----90e5d6610b21--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----90e5d6610b21--------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://federicoriveroll.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Federico Riveroll"}, {"url": "https://federicoriveroll.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6be3377832b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&user=Federico+Riveroll&userId=b6be3377832b&source=post_page-b6be3377832b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb9c3878e20f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-a-continual-ml-pipeline-to-predict-apple-stock-with-global-news-python-90e5d6610b21&newsletterV3=b6be3377832b&newsletterV3Id=b9c3878e20f9&user=Federico+Riveroll&userId=b6be3377832b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}