{"url": "https://towardsdatascience.com/anomaly-detection-in-images-777534980aeb", "time": 1682997115.547372, "path": "towardsdatascience.com/anomaly-detection-in-images-777534980aeb/", "webpage": {"metadata": {"title": "Anomaly Detection in Images. Classify and Individuate anomalies with\u2026 | by Marco Cerliani | Towards Data Science", "h1": "Anomaly Detection in Images", "description": "In Machine Learning is normal to deal with Anomaly Detection tasks. Data Scientists frequently are engaged in problems where they have to show, explain and predict anomalies. I also made a post about\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/anomaly-detection-with-lstm-in-keras-8d8d7e50ab1b", "anchor_text": "Anomaly Detection with Time Series", "paragraph_index": 1}, {"url": "https://www.kaggle.com/arunrk7/surface-crack-detection", "anchor_text": "The crack dataset", "paragraph_index": 3}, {"url": "https://arxiv.org/pdf/1312.4400.pdf", "anchor_text": "avoiding overfitting", "paragraph_index": 9}, {"url": "https://alexisbcook.github.io/2017/global-average-pooling-layers-for-object-localization/", "anchor_text": "heat map representation", "paragraph_index": 12}], "all_paragraphs": ["In Machine Learning is normal to deal with Anomaly Detection tasks. Data Scientists frequently are engaged in problems where they have to show, explain and predict anomalies.", "I also made a post about Anomaly Detection with Time Series, where I studied internal system behaviors and I provided anomaly forecasts in the future.", "In this post, I try to solve a different challenge. I change the domain of interest: swapping from Time Series to Images. Given an image, we want to achieve a dual purpose: predict the presence of anomalies and individuate them, giving a colorful representation of the results.", "I got the data from the internet: The crack dataset contains images of wall cracks. Half of the images show new and uncorrupted pieces of the wall; the remaining part shows cracks of various dimensions and types.", "As you can see from the samples below, our data are present different types of wall cracks, some of them aren\u2019t so easy to identify also for me.", "We want to build a machine learning model which is able to classify wall images and detect at the same time where anomalies are located. To achieve this dual purpose, the most efficient method consists in building a strong classifier. It will be able to read and classify our input images as \u2018damaged\u2019 or \u2018not damaged\u2019. At the last step, we\u2019ll make use of knowledge learned by our classifier to extract useful information which will help us to detect also where are anomalies.", "But let\u2019s proceed with order and start to assemble our Neural Net\u2026", "For this kind of task, I\u2019ve chosen a silver bullet of computer vision, the loyalty VGG16. We load and remake the train of VGG16. This is very easy to do in Keras with only a few lines of code.", "In detail, we imported the VGG architecture allowing training of the last two convolutional blocks. This will permit our model to specialize in our classification task. For this purpose, we\u2019ve also excluded the top layers of the original model replacing them with another structure.", "At the classification stage, the GlobalAveragePooling layer reduces the size of the preceding layer by taking the average of each feature map. This choice, plus the omitted usage of intermediate dense layer, permits avoiding overfitting.", "The training is simple and easy if you have at disposal a GPU. COLAB or Kaggle gave us the weapons we needed to speed up this process. We also used a simple data generator provided by Keras for image augmentation.", "In the end, we were able to achieve an overall accuracy of 0.90, not bad!", "Now, with our model trained, we play with it in order to extract all the useful information which permits us to show cracks in our wall images. We try to make this process easy and nice to see at the end with heat map representation.", "The useful information we need is located at the top. Particularly we access to:", "With these compressed objects in our hands, we have all the knowledge to localize cracks. We want to \u2018paint\u2019 them on an original image in order to make the results easy to understand and nice to see. \u2018Unzip\u2019 this information is easy in python: we only have to make bilinear upsampling to resize each activation map and compute a dot product.", "This magic is accessible executing a simple function:", "I display the results in the image below, where I\u2019ve plotted the crack heat maps on test images classified as crack. We can see that the heat map is able to generalize well and point pieces of wall containing cracks.", "In this post, we produce a machine learning solution for anomaly identifications and localizations. All these functionalities are accessible by implementing a single classification model. During training our Neural Network acquires all the relevant information which permits it to operate classification. After this phase, we\u2019ve assembled the final pieces which have told us where the crack is in the image, without additional work!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F777534980aeb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----777534980aeb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----777534980aeb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----777534980aeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----777534980aeb--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----777534980aeb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F777534980aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F777534980aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@dissii?utm_source=medium&utm_medium=referral", "anchor_text": "mahdis mousavi"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/anomaly-detection-with-lstm-in-keras-8d8d7e50ab1b", "anchor_text": "Anomaly Detection with Time Series"}, {"url": "https://www.kaggle.com/arunrk7/surface-crack-detection", "anchor_text": "The crack dataset"}, {"url": "https://arxiv.org/pdf/1312.4400.pdf", "anchor_text": "avoiding overfitting"}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html", "anchor_text": "sklearn documentation"}, {"url": "https://alexisbcook.github.io/2017/global-average-pooling-layers-for-object-localization/", "anchor_text": "heat map representation"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----777534980aeb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----777534980aeb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----777534980aeb---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----777534980aeb---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F777534980aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&user=Marco+Cerliani&userId=c843902314c7&source=-----777534980aeb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F777534980aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&user=Marco+Cerliani&userId=c843902314c7&source=-----777534980aeb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F777534980aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----777534980aeb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F777534980aeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----777534980aeb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----777534980aeb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----777534980aeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----777534980aeb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----777534980aeb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----777534980aeb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----777534980aeb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----777534980aeb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----777534980aeb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanomaly-detection-in-images-777534980aeb&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}