{"url": "https://towardsdatascience.com/implementing-point-pillars-in-tensorflow-c38d10e9286", "time": 1683012638.638489, "path": "towardsdatascience.com/implementing-point-pillars-in-tensorflow-c38d10e9286/", "webpage": {"metadata": {"title": "Implementing Point Pillars in TensorFlow | by Anjul Tyagi | Towards Data Science", "h1": "Implementing Point Pillars in TensorFlow", "description": "If you want to get started on 3D Object Detection and more specifically on Point Pillars, I have a series of posts written on it just for that purpose. Here\u2019s the link. Also, going through the Point\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@a_tyagi/3d-point-clouds-bounding-box-detection-and-tracking-pointnet-pointnet-lasernet-point-pillars-9439af14dfba", "anchor_text": "link", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/1812.05784.pdf", "anchor_text": "Point Pillars paper", "paragraph_index": 0}, {"url": "https://github.com/tyagi-iiitv/PointPillars", "anchor_text": "https://github.com/tyagi-iiitv/PointPillars", "paragraph_index": 1}, {"url": "https://github.com/fferroni/PointPillars", "anchor_text": "Francesco Ferroni", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/non-maximum-suppression-nms-93ce178e177c", "anchor_text": "post", "paragraph_index": 14}, {"url": "https://github.com/tyagi-iiitv/PointPillars", "anchor_text": "Github repo", "paragraph_index": 15}], "all_paragraphs": ["If you want to get started on 3D Object Detection and more specifically on Point Pillars, I have a series of posts written on it just for that purpose. Here\u2019s the link. Also, going through the Point Pillars paper directly will be really helpful to understand this post better, however, it\u2019s not a prerequisite.", "Github Repo for this tutorial: https://github.com/tyagi-iiitv/PointPillars. Thanks to Francesco Ferroni for the initial code.", "We define initial configurations that include the limits for x,y,z dimensions. These limits define the region of interest in which we will be predicting the bounding boxes. Since the range of LiDARs is generally very high, we focus on a smaller region in this space which is defined by these limits. Other configurations include the maximum number of Pillars, maximum points per pillar, etc.", "These configurations are generally used to transfer the point cloud from 3D coordinates to Pillar coordinates in the Point Pillars detection pipeline as discussed in the next section. For now, just remember that all the configurations are defined in this file.", "The overall architecture of Point Pillars contains three components: A pillar feature net, A Backbone 2D CNN, and a Detection Head. We will discuss these three components individually.", "This is a practically simple layer with input being the pillar features encoded in an x-y grid, as described in the previous section. This grid is treated as an image and is transformed into different scales with features extracted at those scales and finally concatenated. We are trying to capture features from different scales of the point cloud and concatenate them into a single tensor.", "In this part, we are predicting the regression targets for the anchor boxes as described below. All of these predictions are for each grid cell in the x-y coordinates (252 X 252). The bounding boxes are not directly predicted in this case, but the initial anchor boxes are resized to generate the predicted bounding box. The initial anchor boxes are provided inside the config.py file.", "Note that the Detection head predicts 4 bounding boxes per grid cell, and each bounding box has the properties listed above.", "Once we have decided on the network architecture, we create the loss functions to complete the training process definitions. As you can see in the loss.py file, we are calculating the loss values for each of our regression targets and adding them with weights assigned to each error. So, the final loss value will be a weighted sum of each loss value.", "We have designed a class to read the files in the Kitti Dataset and extract the 3D bounding box dimensions from the label (txt) files. Every row in the labels file contain the following information:", "After defining loss functions, configurations, and data generators for each data point in the Kitti dataset, the SimpleDataGenerator in the processor.py file, generates the training examples. The main steps in this process are:", "The helper functions for these two tasks are provided inside the src/point_pillars.cpp file which is included with the current python code using Pybind.", "If the IoU value is above a certain threshold, then the targets (delta - x, y, z, length, width height, yaw, etc.) are stored for that bounding box. Otherwise, if no anchor passed the threshold, the best anchor based on IoU scores is chosen for that grid cell and is stored. These values are then used to calculate the loss values as described above.", "The last part of this codebase is the point_pillars_prediction.py file used for inferencing. After we have trained the network based on the loss functions described before, during the inference stage, the output of the network is the regression targets, occupancy index, and the classification confidence value for each prediction. You can verify that for each grid cell, the network outputs 4 bounding boxes with their respective parameters.", "We can remove most of the predicted boxes based on the occupancy index since we only want the boxes with occupancy 1, which means that the network has actually predicted a bounding box on that grid cell. Still, there can be many bounding boxes that are predicted by the network for the same object. To filter these, we can use Non-Maximum Suppression and come up with final bounding box predictions. Non-Maximum Suppression ranks the bounding boxes on the basis of IoU and their classification confidence values and selects the one with the best value as the final bounding box. Refer to this post to read more on Non-Maximum Suppression.", "This post covered the details of Point Pillars implementation on Tensorflow. All the code details including configuration files, model implementation, data generators, training, and inference are explained with code examples. The code is available in this Github repo and can be used to experiment with the details given in this article. As the next steps, we are working on generating inference results on the Kitti data which will be posted on the Github repo.", "If you are interested in contributing to this project, please check out the issues on the GitHub repo.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D. student \u2014 Computer Vision | Self-driving cars| Data Visualization"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc38d10e9286&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c38d10e9286--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c38d10e9286--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@a_tyagi?source=post_page-----c38d10e9286--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a_tyagi?source=post_page-----c38d10e9286--------------------------------", "anchor_text": "Anjul Tyagi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a88e7a3e42a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&user=Anjul+Tyagi&userId=5a88e7a3e42a&source=post_page-5a88e7a3e42a----c38d10e9286---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc38d10e9286&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc38d10e9286&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@a_tyagi/3d-point-clouds-bounding-box-detection-and-tracking-pointnet-pointnet-lasernet-point-pillars-9439af14dfba", "anchor_text": "link"}, {"url": "https://arxiv.org/pdf/1812.05784.pdf", "anchor_text": "Point Pillars paper"}, {"url": "https://github.com/tyagi-iiitv/PointPillars", "anchor_text": "https://github.com/tyagi-iiitv/PointPillars"}, {"url": "https://github.com/fferroni/PointPillars", "anchor_text": "Francesco Ferroni"}, {"url": "https://arxiv.org/pdf/1812.05784.pdf", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/non-maximum-suppression-nms-93ce178e177c", "anchor_text": "post"}, {"url": "https://github.com/tyagi-iiitv/PointPillars", "anchor_text": "Github repo"}, {"url": "https://medium.com/tag/self-driving-cars?source=post_page-----c38d10e9286---------------self_driving_cars-----------------", "anchor_text": "Self Driving Cars"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c38d10e9286---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c38d10e9286---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----c38d10e9286---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c38d10e9286---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc38d10e9286&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&user=Anjul+Tyagi&userId=5a88e7a3e42a&source=-----c38d10e9286---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc38d10e9286&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&user=Anjul+Tyagi&userId=5a88e7a3e42a&source=-----c38d10e9286---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc38d10e9286&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c38d10e9286--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc38d10e9286&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c38d10e9286---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c38d10e9286--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c38d10e9286--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c38d10e9286--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c38d10e9286--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c38d10e9286--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c38d10e9286--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c38d10e9286--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c38d10e9286--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a_tyagi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@a_tyagi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anjul Tyagi"}, {"url": "https://medium.com/@a_tyagi/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "218 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a88e7a3e42a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&user=Anjul+Tyagi&userId=5a88e7a3e42a&source=post_page-5a88e7a3e42a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9316902425a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimplementing-point-pillars-in-tensorflow-c38d10e9286&newsletterV3=5a88e7a3e42a&newsletterV3Id=9316902425a9&user=Anjul+Tyagi&userId=5a88e7a3e42a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}