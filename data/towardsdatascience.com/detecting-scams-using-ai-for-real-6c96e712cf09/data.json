{"url": "https://towardsdatascience.com/detecting-scams-using-ai-for-real-6c96e712cf09", "time": 1682997368.859464, "path": "towardsdatascience.com/detecting-scams-using-ai-for-real-6c96e712cf09/", "webpage": {"metadata": {"title": "Detecting scams using AI, for real | by Massimo Belloni | Towards Data Science", "h1": "Detecting scams using AI, for real", "description": "According to a study published in March 2019 \u2014 that I specifically looked for just to find a cool introduction for this post \u2014 40% of the self-defined AI startups in Europe don\u2019t actually use AI. I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.theverge.com/2019/3/5/18251326/ai-startups-europe-fake-40-percent-mmc-report", "anchor_text": "study published in March 2019", "paragraph_index": 0}, {"url": "https://medium.com/data-science-housinganywhere/how-ai-helped-housinganywhere-create-the-first-scammer-free-booking-platform-3153e1f358e3", "anchor_text": "an extensive post", "paragraph_index": 0}, {"url": "https://housinganywhere.com/", "anchor_text": "HousingAnywhere", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/random-thoughts-on-my-first-ml-deployment-8e8c89df047f", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://medium.com/data-science-housinganywhere/how-to-do-data-science-on-an-evolving-website-5fdec1c995da", "anchor_text": "evolutionary nature of the platform", "paragraph_index": 8}, {"url": "https://github.com/microsoft/LightGBM", "anchor_text": "LightGBMs", "paragraph_index": 8}], "all_paragraphs": ["According to a study published in March 2019 \u2014 that I specifically looked for just to find a cool introduction for this post \u2014 40% of the self-defined AI startups in Europe don\u2019t actually use AI. I see what they are doing there, exploiting the rarely existing familiarity that average people (and investors) have about this field to position themselves on the market as cool black-magic experts. I don\u2019t work for an AI-startup (I mean, we are not selling directly any AI-powered service), but a couple of days ago we finally published an extensive post that introduces to the public our first ML-driven product. I thought that it would have been rather interesting to share all the steps that we have gone through to actually deploy it and why we decided to do it the way that we did.", "Without getting repetitive, but just as an introductory glossary: Penelope is our internal tool for detecting scams. Each new listing published on our platform (HousingAnywhere, an accommodation marketplace with listings in 400+ cities around the world) is classified as scam or not scam and in some cases is marked for a manual check by our Customer Solutions (CS) department. It has been trained with data collected in the last three years and it is implemented as an ensemble where each model, independently, focuses on different features or on a different chronological subset of the dataset.", "HousingAnywhere wasn\u2019t born with Penelope, and providing trust and a safe marketplace has always been a paramount objective of the company. For years the fraud prevention system has performed well without any AI (incredible, isn\u2019t it?) and it was almost entirely relying on a trigger system composed by some static SQL rules. Some of the queried data structures and the queries themselves weren\u2019t trivial at all, but often a simple system when well designed and maintained, can outperform very complex solutions. The problem there is that it wasn\u2019t entirely the case. When a company starts to scale fast and has to solve problems in a quick way it can overlook some good practices.", "The original system was composed of ~50 rules, lacking of proper documentation and with overlapping scopes. We weren\u2019t collecting any statistics about their performances and we didn\u2019t know why the original designers created those rules in the first place. We had the feeling that some triggers hadn\u2019t been leading to any detection for months, causing just a lot of time wasted in useless checks, but we didn\u2019t have any metric to prove the hypothesis and we finished in not removing anything, adding new rules on top of the existing ones because the system was working \u2014 not a single scammer ever succeeded in 3 years! \u2014 and we were quite scared to touch anything. Designing new rules was also tricky by itself. Sometimes it isn\u2019t easy to describe a suspicious behavior, and something that might be trivial to get for an human might need hundreds of SQL lines, joining together tables that might possibly be stored in different locations. It was at that point that we started thinking about using machine learning for replacing the rules system: stop defining explicitly all the rules and let an algorithm to learn them directly from our data. It was quite an ambitious goal, and it took us more than 6 months to get there, but already at that point we had a very specific use-case in mind with a well-defined flow. We didn\u2019t simply start throwing random data to learning algorithms to see what would happen. Also, having the goal to replace an existing product (kinda) that was already successfully used by people allowed us to have a real world framework to reliably test our alternative (I\u2019ve already written about this here). But how to define the success of something if we cannot measure the performances of what we had in place?", "We didn\u2019t simply start throwing random data to learning algorithms to see what would happen.", "A lot of the effort we spent on the Penelope project has been put, at the beginning, in rationalising and improving the previous rules system, right before killing it forever. We designed and implemented a monitoring infrastructure able to track the performances of each trigger (precision, mainly) and we also started collecting some metrics for the Customer Solutions department, to check where our bottlenecks were and if we needed to improve also our internal processes on top of the technical infrastructure. We ended up in doing both: there is no point in improving a technical infrastructure used by people if the process those people follow is not efficient in the first place. Artificial Intelligence is a tool for improving something, but it\u2019s just a single piece of the puzzle. Its usefulness is not in using it by itself but in using it to improve entire processes. Implementing machine learning isn\u2019t the easiest thing and \u2014 above all \u2014 it\u2019s an effort with very unpredictable results. Start from simple things first.", "There is no point in improving a technical infrastructure used by people if the process those people follow is not efficient in the first place.", "As soon as we had in place a solid fraud prevention infrastructure (a month of work, more or less) we started building an alternative to get rid of it. From the very beginning we never considered to fully replace human moderators and we never chased academic-papers-like performances. We have always looked at precision not as a number but as the amount of useless work that CS would have wasted for checking flagged listings, and recall as the number of scam listings left in the wild. The rules system has been also helpful in providing us an initial set of features to work on. On top of those, we investigated some others, mainly thanks to the input from the people dealing with scammers everyday. We didn\u2019t waste time though, in investigating features that wouldn\u2019t have been available in the first 5 minutes a listing is created and again, having a product vision in mind from the early stages has been very helpful in this.", "The real challenge we faced in training the model was in the evolutionary nature of the platform that has generated data. We ended up in ensembling 5 LightGBMs (comparable performances but shorter training time than XGBoost), each one trained with a different dataset either in vertical (number of samples) or horizontal (number of feature) sizes. Each model is weighted to have the highest performances on new data (90\u201310 validation, ordering samples in chronological order; bayesian optimisation to explore the weights\u2019 space). The final model has then been deployed as a web API (Flask) feeding a Celery instance that schedules asynchronously the prediction tasks. The outcome of each job is sent on different channels and the deployment is not aware of the clients that are using it. Each new listing published on the platform (with the only exception of the ones created by trusted advertisers) is sent to Penelope for a check. And is either accepted, marked as scam or sent for manual moderation. Each prediction job lasts 3-4 seconds but a fraction of this time is required to collect some data via third parties sources.", "After the first successful deployment (January 2019, more or less) we had to decide how to deal with the retraining process of the system and with the evolutionary nature of our data. We ran some offline simulations and compared different retraining scenarios discovering that for our specific domain, retraining Penelope every 2 weeks would have lead to significant increase in performances (more scammers, basically). Not surprisingly the importance of the model trained with all the recent features in the ensemble is every time more relevant for classifying new listings. In the future we are expecting to get rid of some of the models and to possibly add new ones. At this stage we are quite confident in doing it and we have a solid pipeline to discover new shifting features to train our models on.", "Before Penelope, CS department was spending 80 hours per week in manual moderation of suspicious listings, currently it is something in the range of 15 (80% improvement). The majority of the rules themselves didn\u2019t have immediate effect, and needed from 1 to 6 hours to identify a fraudulent behavior. This limitation was putting visitors at risk, being the listing available to be contacted for some hours. The ability of Penelope to classify listings as soon as they are published reduced this window almost to 0, and actually gives to CS a very handy metric to assess their performances. The quality of our fraud prevention system (as a company) is now strongly related to the responsiveness that Customer Solutions department has in checking the listings flagged by Penelope. Mes2Det is our internal metric to measure this, and it is computed as the hours needed to report a scammer after it has been notified on our systems. How it can be easily noticed, Mes2Det improved a lot since Penelope went live (from 10 hours to 2) and it is stable for a couple of months now.", "Currently we are continuously iterating on Penelope trying to improve it as much as we can. Some lessons that we already learnt are that the direction of research to pursue is reducing the scope of the models, possibly ensembling simpler components trained with smaller datasets than trying to build a bigger architecture with hundreds of complex features. In June we already deployed a second version of Penelope, that increased precision of ~10% even if it is trained with a dataset that is almost half of the size of the original one.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6c96e712cf09&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://massibelloni.medium.com/?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": ""}, {"url": "https://massibelloni.medium.com/?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": "Massimo Belloni"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4e623cf1c796&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&user=Massimo+Belloni&userId=4e623cf1c796&source=post_page-4e623cf1c796----6c96e712cf09---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c96e712cf09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c96e712cf09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@poying?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Po-Ying Chen"}, {"url": "https://unsplash.com/photos/FbrIh1-AITk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.theverge.com/2019/3/5/18251326/ai-startups-europe-fake-40-percent-mmc-report", "anchor_text": "study published in March 2019"}, {"url": "https://medium.com/data-science-housinganywhere/how-ai-helped-housinganywhere-create-the-first-scammer-free-booking-platform-3153e1f358e3", "anchor_text": "an extensive post"}, {"url": "https://housinganywhere.com/", "anchor_text": "HousingAnywhere"}, {"url": "https://towardsdatascience.com/random-thoughts-on-my-first-ml-deployment-8e8c89df047f", "anchor_text": "here"}, {"url": "https://medium.com/data-science-housinganywhere/how-to-do-data-science-on-an-evolving-website-5fdec1c995da", "anchor_text": "evolutionary nature of the platform"}, {"url": "https://github.com/microsoft/LightGBM", "anchor_text": "LightGBMs"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6c96e712cf09---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/fraud?source=post_page-----6c96e712cf09---------------fraud-----------------", "anchor_text": "Fraud"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6c96e712cf09---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6c96e712cf09---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6c96e712cf09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&user=Massimo+Belloni&userId=4e623cf1c796&source=-----6c96e712cf09---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6c96e712cf09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&user=Massimo+Belloni&userId=4e623cf1c796&source=-----6c96e712cf09---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6c96e712cf09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6c96e712cf09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6c96e712cf09---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6c96e712cf09--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6c96e712cf09--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6c96e712cf09--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6c96e712cf09--------------------------------", "anchor_text": ""}, {"url": "https://massibelloni.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://massibelloni.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Massimo Belloni"}, {"url": "https://massibelloni.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "443 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4e623cf1c796&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&user=Massimo+Belloni&userId=4e623cf1c796&source=post_page-4e623cf1c796--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd607a9e5bd7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-scams-using-ai-for-real-6c96e712cf09&newsletterV3=4e623cf1c796&newsletterV3Id=d607a9e5bd7d&user=Massimo+Belloni&userId=4e623cf1c796&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}