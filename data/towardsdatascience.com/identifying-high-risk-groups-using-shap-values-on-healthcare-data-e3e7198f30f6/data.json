{"url": "https://towardsdatascience.com/identifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6", "time": 1683003711.3738391, "path": "towardsdatascience.com/identifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6/", "webpage": {"metadata": {"title": "Identifying High-Risk Groups Using SHAP Values on Healthcare Data. | by Saad Ahmed | Towards Data Science", "h1": "Identifying High-Risk Groups Using SHAP Values on Healthcare Data.", "description": "Machine learning has made quite a lot of progress over the past few years and that is mainly down to the vast amount of data that is available to us and the complex algorithms that can extract some\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@gabrieltseng/interpreting-complex-models-with-shap-values-1c187db6ec83", "anchor_text": "https://medium.com/@gabrieltseng/interpreting-complex-models-with-shap-values-1c187db6ec83", "paragraph_index": 3}, {"url": "https://archive.ics.uci.edu/ml/datasets/Heart+Disease", "anchor_text": "data set", "paragraph_index": 8}, {"url": "https://www.researchgate.net/post/How_can_we_say_that_a_clustering_quality_measure_is_good", "anchor_text": "https://www.researchgate.net/post/How_can_we_say_that_a_clustering_quality_measure_is_good", "paragraph_index": 23}], "all_paragraphs": ["Machine learning has made quite a lot of progress over the past few years and that is mainly down to the vast amount of data that is available to us and the complex algorithms that can extract some structure and meaning out of the data. These complex models, on one hand, provide state of the art results but on the other hand, they are a kind of a mystery to understand and interpret. Model interpretability is very important both legally as well as from the health care perspective as it can increase trust and adoption of AI in healthcare.", "For instance, in the healthcare industry predicting when a patient will die can be of use but more importantly, understanding our model output can help us identify those sets of clusters (patients with similar attributes) that are at high risk of any bad outcome. This eventually will lead to better and appropriate interventions at an early stage.", "There are quite a lot of methods available that help us understand the result of our models. However, I will discuss about SHAP values and how they can be used to explain the out of a model at a global as well as at a local level.", "Shap values basically give us how much each feature contributed to our final prediction on average. It helps us analyze and interpret our models more intuitively. To get a better understanding of what shap values are and how they are calculated this article has some very nice content https://medium.com/@gabrieltseng/interpreting-complex-models-with-shap-values-1c187db6ec83.", "Through shap values we can understand what our model is doing at the micro-level that is for each prediction it can help us identify which features have contributed how much to our final prediction.", "Here we will use shap values to create clusters and see if they can be useful in identifying patients who are at a higher risk of heart disease.", "As you can see from the above pipeline that the purpose of this post is first to fit a complex model like XGboost to the data and then use SHAP library to get SHAP values for each example in the data and then cluster them to find patterns that can lead to early interventions or better treatment of patients. The data set for this example consists of a number of features to predict whether or not a patient has heart disease or not.", "The advantage of using shap values for clustering is that shap values for all features are on the same scale (log odds for binary xgboost). This helps us generating meaningful clusters. The goal here to cluster those shap values that have the same predicted heart disease risk.", "Let's import the data set and split it into train and test set.", "Next, we train an Xgboost model for classification. Here the focus is not on getting a highly accurate model instead I want to show you how shap values can be used for clustering.", "Okay so we have our model trained and we can now use the SHAP library to get shap values of our model. The code block below first creates an explainer object using the Tree Explainer method on the trained model. The explainer object is then used to get the shap values for the testing data.", "Using the elbow method to decide how many clusters are a good fit for our data.", "I chose 6 as the number of desired clusters here. Next we again fit the K-Means model to our shap values for the testing set with 6 as the number of clusters.", "Now we map for each patient (data point) which cluster was assigned to it based on its training.", "Based on the learning of the xgboost model which we trained previously we will now generate predictions for the remaining test data and evaluate them.", "Grouping clusters with their respective patient ids (indexes) to identify clusters with higher percentage of disease detection.", "From the image, we can see that we have a difference in the disease percentages in our clusters. Note: Clusters with no diseases are not shown here.", "So let's try to reason if we can get to something from the clusters we have generated. The chart below contains the percentage of heart disease detection along with the mean value of each feature for each cluster. I have rounded off the values for brevity.", "cp = chest paint \u2014 It is evident from the table above that a higher cp indicates more chances of a heart disease", "restecg = resting electrocardiographic results \u2014 clusters with a higher heart disease rate tend to have higher mean values for restecg", "Clusters having a higher mean value for thalach have a higher percentage of heart disease detection.", "The reasoning that we have done has helped us identify patterns in our data and we can now look for possible interventions or solutions to help prevent heart disease.", "Well so far the approach is described in this notebook is somewhat naive. For instance, selecting the number of clusters just from the elbow method isn't a very good idea we also need to look at some other measures that explain how well the algorithm has clustered our data. Silhouette score is one such measure that can help in defining how well we have clustered our data.", "The fact still remains that there are many clustering metrics that can help us understand the goodness of fit of our clusters but it's all relative to what we consider a good metric. This is further explained here https://www.researchgate.net/post/How_can_we_say_that_a_clustering_quality_measure_is_good", "\u201cThe thing is, we can\u2019t really say what clustering quality measure is good or not. The very notion of \u201cgood clustering\u201d is relative, and is a question of point of view. The same applies to the quality measures. It depends on what you want to evaluate.\u201d", "So the takeaway from here is that we need to test different clusters and decide which metric can be a good fit for our problem and explain efficiently the clusters we have.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3e7198f30f6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@saadahmed387?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@saadahmed387?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": "Saad Ahmed"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4c310b1992e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&user=Saad+Ahmed&userId=4c310b1992e3&source=post_page-4c310b1992e3----e3e7198f30f6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3e7198f30f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3e7198f30f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@gabrieltseng/interpreting-complex-models-with-shap-values-1c187db6ec83", "anchor_text": "https://medium.com/@gabrieltseng/interpreting-complex-models-with-shap-values-1c187db6ec83"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Heart+Disease", "anchor_text": "data set"}, {"url": "https://www.researchgate.net/post/How_can_we_say_that_a_clustering_quality_measure_is_good", "anchor_text": "https://www.researchgate.net/post/How_can_we_say_that_a_clustering_quality_measure_is_good"}, {"url": "https://shap.readthedocs.io/en/latest/", "anchor_text": "https://shap.readthedocs.io/en/latest/"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "https://github.com/slundberg/shap"}, {"url": "https://www.youtube.com/watch?v=vA_czRcCpvQ", "anchor_text": "https://www.youtube.com/watch?v=vA_czRcCpvQ"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Heart+Disease", "anchor_text": "https://archive.ics.uci.edu/ml/datasets/Heart+Disease"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----e3e7198f30f6---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/tag/clustering?source=post_page-----e3e7198f30f6---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/explainer?source=post_page-----e3e7198f30f6---------------explainer-----------------", "anchor_text": "Explainer"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e3e7198f30f6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/interpretability?source=post_page-----e3e7198f30f6---------------interpretability-----------------", "anchor_text": "Interpretability"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3e7198f30f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&user=Saad+Ahmed&userId=4c310b1992e3&source=-----e3e7198f30f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3e7198f30f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&user=Saad+Ahmed&userId=4c310b1992e3&source=-----e3e7198f30f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3e7198f30f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe3e7198f30f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e3e7198f30f6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e3e7198f30f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@saadahmed387?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@saadahmed387?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saad Ahmed"}, {"url": "https://medium.com/@saadahmed387/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "91 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4c310b1992e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&user=Saad+Ahmed&userId=4c310b1992e3&source=post_page-4c310b1992e3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fee3f39e8677c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fidentifying-high-risk-groups-using-shap-values-on-healthcare-data-e3e7198f30f6&newsletterV3=4c310b1992e3&newsletterV3Id=ee3f39e8677c&user=Saad+Ahmed&userId=4c310b1992e3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}