{"url": "https://towardsdatascience.com/maximum-likelihood-estimation-in-r-b21f68f1eba4", "time": 1683011162.92128, "path": "towardsdatascience.com/maximum-likelihood-estimation-in-r-b21f68f1eba4/", "webpage": {"metadata": {"title": "Maximum Likelihood Estimation in R | by Andrew Hetherington | Towards Data Science", "h1": "Maximum Likelihood Estimation in R", "description": "Often, you\u2019ll have some level of intuition \u2014 or perhaps concrete evidence \u2014 to suggest that a set of observations has been generated by a particular statistical distribution. Similar phenomena to the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Method_of_moments_(statistics)", "anchor_text": "one not without its disadvantages", "paragraph_index": 1}, {"url": "https://github.com/andrewhetherington/python-projects/blob/master/Blog%E2%80%94Maximum%20Likelihood%20Estimation%20in%20R/Maximum%20Likelihood%20Estimation%20in%20R.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 7}, {"url": "https://unsplash.com/@purzlbaum?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "\ud83c\udde8\ud83c\udded Claudio Schwarz | @purzlbaum", "paragraph_index": 23}, {"url": "https://unsplash.com/s/photos/coin?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash", "paragraph_index": 23}], "all_paragraphs": ["Often, you\u2019ll have some level of intuition \u2014 or perhaps concrete evidence \u2014 to suggest that a set of observations has been generated by a particular statistical distribution. Similar phenomena to the one you are modelling may have been shown to be explained well by a certain distribution. The setup of the situation or problem you are investigating may naturally suggest a family of distributions to try. Or maybe you just want to have a bit of fun by fitting your data to some obscure model just to see what happens (if you are challenged on this, tell people you\u2019re doing Exploratory Data Analysis and that you don\u2019t like to be disturbed when you\u2019re in your zone).", "Now, there are many ways of estimating the parameters of your chosen model from the data you have. The simplest of these is the method of moments \u2014 an effective tool, but one not without its disadvantages (notably, these estimates are often biased).", "Another method you may want to consider is Maximum Likelihood Estimation (MLE), which tends to produce better (ie more unbiased) estimates for model parameters. It\u2019s a little more technical, but nothing that we can\u2019t handle. Let\u2019s see how it works.", "The likelihood \u2014 more precisely, the likelihood function \u2014 is a function that represents how likely it is to obtain a certain set of observations from a given model. We\u2019re considering the set of observations as fixed \u2014 they\u2019ve happened, they\u2019re in the past \u2014 and now we\u2019re considering under which set of model parameters we would be most likely to observe them.", "Consider an example. Let\u2019s say we flipped a coin 100 times and observed 52 heads and 48 tails. We want to come up with a model that will predict the number of heads we\u2019ll get if we kept flipping another 100 times.", "Formalising the problem a bit, let\u2019s think about the number of heads obtained from 100 coin flips. Given that:", "we might reasonably suggest that the situation could be modelled using a binomial distribution.", "We can use R to set up the problem as follows (check out the Jupyter notebook used for this article for more detail):", "(For the purposes of generating the data, we\u2019ve used a 50/50 chance of getting a heads/tails, although we are going to pretend that we don\u2019t know this for the time being. For almost all real world problems we don\u2019t have access to this kind of information on the processes that generate the data we\u2019re looking at \u2014 which is entirely why we are motivated to estimate these parameters!)", "Under our formulation of the heads/tails process as a binomial one, we are supposing that there is a probability p of obtaining a heads for each coin flip. Extending this, the probability of obtaining 52 heads after 100 flips is given by:", "This probability is our likelihood function \u2014 it allows us to calculate the probability, ie how likely it is, of that our set of data being observed given a probability of heads p. You may be able to guess the next step, given the name of this technique \u2014 we must find the value of p that maximises this likelihood function.", "We can easily calculate this probability in two different ways in R:", "Back to our problem \u2014 we want to know the value of p that our data implies. For simple situations like the one under consideration, it\u2019s possible to differentiate the likelihood function with respect to the parameter being estimated and equate the resulting expression to zero in order to solve for the MLE estimate of p. However, for more complicated (and realistic) processes, you will probably have to resort to doing it numerically.", "Luckily, this is a breeze with R as well! Our approach will be as follows:", "And now considering the second step. There are many different ways of optimising (ie maximising or minimising) functions in R \u2014 the one we\u2019ll consider here makes use of the nlm function, which stands for non-linear minimisation. If you give nlm a function and indicate which parameter you want it to vary, it will follow an algorithm and work iteratively until it finds the value of that parameter which minimises the function\u2019s value.", "You may be concerned that I\u2019ve introduced a tool to minimise a function\u2019s value when we really are looking to maximise \u2014 this is maximum likelihood estimation, after all! Fortunately, maximising a function is equivalent to minimising the function multiplied by minus one. If we create a new function that simply produces the likelihood multiplied by minus one, then the parameter that minimises the value of this new function will be exactly the same as the parameter that maximises our original likelihood.", "As such, a small adjustment to our function from before is in order:", "Excellent \u2014 we\u2019re now ready to find our MLE value for p.", "The nlm function has returned some information about its quest to find the MLE estimate of p.", "This information is all nice to know \u2014 but what we really care about is that it\u2019s telling us that our MLE estimate of p is 0.52. We can intuitively tell that this is correct \u2014 what coin would be more likely to give us 52 heads out of 100 flips than one that lands on heads 52% of the time?", "In this rather trivial example we\u2019ve looked at today, it may seems like we\u2019ve put ourselves through a lot of hassle to arrive at a fairly obvious conclusion. But consider a problem where you have a more complicated distribution and multiple parameters to optimise \u2014 the problem of maximum likelihood estimation becomes exponentially more difficult \u2014 fortunately, the process that we\u2019ve explored today scales up well to these more complicated problems.", "Ultimately, you better have a good grasp of MLE estimation if you want to build robust models \u2014 and in my estimation, you\u2019ve just taken another step towards maximising your chances of success \u2014 or would you prefer to think of it as minimising your probability of failure?", "Andrew Hetherington is an actuary-in-training and data enthusiast based in London, UK.", "Coin photo by \ud83c\udde8\ud83c\udded Claudio Schwarz | @purzlbaum on Unsplash.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Actuary-in-training and data enthusiast based in London, UK."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb21f68f1eba4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andrew-m-hetherington.medium.com/?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": ""}, {"url": "https://andrew-m-hetherington.medium.com/?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": "Andrew Hetherington"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff1c776b81964&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&user=Andrew+Hetherington&userId=f1c776b81964&source=post_page-f1c776b81964----b21f68f1eba4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb21f68f1eba4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb21f68f1eba4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@purzlbaum?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "\ud83c\udde8\ud83c\udded Claudio Schwarz | @purzlbaum"}, {"url": "https://unsplash.com/s/photos/coin?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Method_of_moments_(statistics)", "anchor_text": "one not without its disadvantages"}, {"url": "https://github.com/andrewhetherington/python-projects/blob/master/Blog%E2%80%94Maximum%20Likelihood%20Estimation%20in%20R/Maximum%20Likelihood%20Estimation%20in%20R.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://www.andrewhetherington.com/", "anchor_text": "website"}, {"url": "https://www.linkedin.com/in/andrewmhetherington/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/andrewhetherington/python-projects", "anchor_text": "GitHub"}, {"url": "https://github.com/andrewhetherington/python-projects/blob/master/Blog%E2%80%94Maximum%20Likelihood%20Estimation%20in%20R/Maximum%20Likelihood%20Estimation%20in%20R.ipynb", "anchor_text": "here"}, {"url": "https://unsplash.com/@purzlbaum?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "\ud83c\udde8\ud83c\udded Claudio Schwarz | @purzlbaum"}, {"url": "https://unsplash.com/s/photos/coin?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b21f68f1eba4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data?source=post_page-----b21f68f1eba4---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/r?source=post_page-----b21f68f1eba4---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b21f68f1eba4---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----b21f68f1eba4---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb21f68f1eba4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&user=Andrew+Hetherington&userId=f1c776b81964&source=-----b21f68f1eba4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb21f68f1eba4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&user=Andrew+Hetherington&userId=f1c776b81964&source=-----b21f68f1eba4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb21f68f1eba4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb21f68f1eba4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b21f68f1eba4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b21f68f1eba4--------------------------------", "anchor_text": ""}, {"url": "https://andrew-m-hetherington.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andrew-m-hetherington.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrew Hetherington"}, {"url": "https://andrew-m-hetherington.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "47 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff1c776b81964&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&user=Andrew+Hetherington&userId=f1c776b81964&source=post_page-f1c776b81964--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F464e8b563032&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaximum-likelihood-estimation-in-r-b21f68f1eba4&newsletterV3=f1c776b81964&newsletterV3Id=464e8b563032&user=Andrew+Hetherington&userId=f1c776b81964&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}