{"url": "https://towardsdatascience.com/how-convolution-neural-networks-interpret-images-1f99913070b2", "time": 1683013155.333478, "path": "towardsdatascience.com/how-convolution-neural-networks-interpret-images-1f99913070b2/", "webpage": {"metadata": {"title": "How Convolution Neural Networks interpret images | by Aseem Kashyap | Towards Data Science", "h1": "How Convolution Neural Networks interpret images", "description": "Aim of this article is to provide an intuitive understanding of the key layers in a convolution neural network. The idea is to go beyond simply stating the facts and exploring how image manipulation\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=YgtModJ-4cw", "anchor_text": "this", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/complete-guide-of-activation-functions-34076e95d044", "anchor_text": "excellent article", "paragraph_index": 11}, {"url": "https://www.kaggle.com/chetankv/dogs-cats-images", "anchor_text": "publicly available", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/understanding-your-convolution-network-with-visualizations-a4883441533b", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/feature-visualization-on-convolutional-neural-networks-keras-5561a116d1af", "anchor_text": "here", "paragraph_index": 19}], "all_paragraphs": ["Aim of this article is to provide an intuitive understanding of the key layers in a convolution neural network. The idea is to go beyond simply stating the facts and exploring how image manipulation actually works.", "Suppose our aim is to train a deep learning network to successfully distinguish between cat and dog images like those shown below", "Let us start by thinking about what challenges such an algorithm must overcome. To begin with, it must be able to detect cats and dogs of different color, size, shape, and breed. It must also work when only a certain portion and not the entire dog/cat is visible. The algorithm must be sensitive to the presence of more than one dog/cat in the image and most importantly, it must be spatially invariant \u2014 it must not expect the dog/cat to be in a certain part of the image. In the following sections, we explore how different components of a CNN architecture result in all these capabilities.", "Images are composed of pixels with values that depict brightness and range from 0\u2013255. 0 means black, 255 is white and everything else is some shade of grey. More the pixels, better the image quality.", "While a greyscale image is made of a single channel (i.e. a single 2D array of pixels), colored images in the RBG format are composed of three different layers, stacked on top of each other.", "Conventional neural networks are not suitable for deep learning applications like image classification. The contents of each pixel are fed into the perceptron separately in the input layer. For a RGB image of dimensions 600*377*3, the total number of parameters to be learned for the input layer alone will be (600*377*3*2 (two parameters per neuron, weight and bias)) ~1.5 million. This number will scale linearly with the number of layers. This, however, is not the only challenge with MLPs. MLPs have no inbuilt mechanism for being spatially invariant. If a MLP has been trained to detect dogs in the top right corner of the image, it will fail when dogs are located in other locations.", "A convolution neural network aims to ameliorate these drawbacks using a built-in mechanism for (1) extracting different high level features (2) introducing spatial invariance (3) improving networks learning ability.", "Convolution (discrete convolution to be specific) is based on use to linear transformations to extract key features from images while preserving the ordering of information. The input is convolved with a kernel to generate the output, similar to the response generated by a network of neurons in the human visual cortex.", "The kernel (also known as a filter or a feature detector) samples the input image matrix with a pre-determined step size (known as stride) in both horizontal and vertical directions. As the kernel slides over the input image, the element-wise product between each element of the kernel and overlapping elements of the input image is calculated to obtain to the output for the current location.", "When the input image is composed of multiple channels (which is almost always the case), the kernel has the same depth as the number of channels in the input image. The dot product in such cases is added to achieve the final feature map composed of a single channel. If you are new to matrix multiplication, check out this youtube video for a detailed explanation.", "Each convolution layer is composed of many different filters, each of which extracts different features. And while a CNN made of a single convolution layer will only extract/learn low level features, adding successive convolution layers significantly improves the ability to learn high level features.", "To introduce non-linearity into the system and improve the learning capacity, the output from the convolution operation is passed through a non-saturating activation function like sigmoid or rectified linear unit (ReLU). Check out this excellent article about these and several other commonly used activation functions. The most commonly used activation function ReLU essentially preserves positive values and replaces negative values with a zero.", "The feature map resulting from convolution is smaller in size compared to the input image. For an input image of I*I that is convolved with a kernel of size K*K with a stride S, the output will be [(I-F)/S + 1]* [(I-F)/S + 1]. This can result in a substantial reduction in image size in CovNets made of several convolution layers. A zero padding of [(F-1)/2] all around the output image can be used to preserve the convolution output.", "For the most general case where an input image of size I*I is convolved with a filter of size K*K with a stride S and padding P, the output will have the dimension [(I+2P-K)/S +1]*[(I+2P-K)/S +1].", "The convolution output is pooled so as to introduce spatial invariance i.e the ability to detect the same feature in different images. The idea here is to retain key information corresponding to important features that the CNN must learn and at the same time reduce image size by getting rid of insignificant information. While there are several variations, max pooling is the most commonly used strategy. The convolution product is split into non-overlapping patches of size K*K and only the maximum value of each patch is recorded in the output.", "Other less frequently used pooling strategies include average pooling, \u2018mixed\u2019 max-average pooling, stochastic pooling, and spatial pyramid pooling.", "The two key elements of CNN discussed so far: the convolution layer (defined by kernels, stride, activation function) and the pooling layer are combined in predetermined patterns to define the CNN architecture. While I won\u2019t get into the architectural details, in the next section we discuss some general features of image processing by these neural networks.", "I used a publicly available dataset of labelled cat & dog images and trained a binary classifier (inceptionv3). Using this trained network we can get a feel of how a CNN actually processes an image.", "First, we take a sample image and pass it through this trained network. The output of 3 convolution and associated activation layers (I used ReLU)are visualized below. What is immediately evident is that as we move down the network, the output becomes increasingly incomprehensible. By the time we are in layer 25, it is difficult to tell if the image fed into the network was a dog or a cat. It is worth noting that the overall architecture of this network is rather complex (and not included here) and layer 25 is not even half way down the network. So what are these layers actually learning? It is not obvious by merely looking at the image below.", "The image above merely visualizes the output of each layer for an input image. What we need is to visualize the different kernels of each convolution layer. This will tell us what each of these filters is detecting. We start with an image made of random noise and optimize it for every kernel in a layer. In other words, we take a bunch of filters in a trained network and ask \u201c what kind of input image will activate this particular kernel\u2019. Knowing this image will tell us more about what that particular filter is detecting. A more detailed explanation of this logic and associated code can be found here and here.", "Visualized above are some of the filter activation patterns for the same layers as above. Different layers are activated by different parts of the image. Layer 1 is essentially an edge detector that is activated by horizontal and vertical edges. As we go deeper into the network, patterns recognized by convolution kernels become complex and sparse as more abstract image features are extracted in these stages.", "In this article, I have attempted to explain the design and inner workings of different convolution layers. Please do leave a comment or write to me at aseem.kash@gmail.com if you have any suggestions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in Deep learning/Molecular Biology/Quantitative Cell Biology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1f99913070b2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f99913070b2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f99913070b2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://aseem-kash.medium.com/?source=post_page-----1f99913070b2--------------------------------", "anchor_text": ""}, {"url": "https://aseem-kash.medium.com/?source=post_page-----1f99913070b2--------------------------------", "anchor_text": "Aseem Kashyap"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd0d0126ce1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=post_page-fd0d0126ce1f----1f99913070b2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f99913070b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f99913070b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/deep-learning-biology", "anchor_text": "DEEP LEARNING + BIOLOGY"}, {"url": "https://unsplash.com/photos/xYamknRmK04", "anchor_text": "source"}, {"url": "https://unsplash.com/photos/XGZZrXODE3k", "anchor_text": "Source"}, {"url": "https://github.com/PetarV-/TikZ/tree/master/2D%20Convolution", "anchor_text": "Source"}, {"url": "https://www.youtube.com/watch?v=YgtModJ-4cw", "anchor_text": "this"}, {"url": "https://github.com/aqeelanwar/conv_layers_animation", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/complete-guide-of-activation-functions-34076e95d044", "anchor_text": "excellent article"}, {"url": "https://github.com/aqeelanwar/conv_layers_animation", "anchor_text": "Source"}, {"url": "https://computersciencewiki.org/index.php/Max-pooling_/_Pooling", "anchor_text": "Source"}, {"url": "https://www.kaggle.com/chetankv/dogs-cats-images", "anchor_text": "publicly available"}, {"url": "https://towardsdatascience.com/understanding-your-convolution-network-with-visualizations-a4883441533b", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/feature-visualization-on-convolutional-neural-networks-keras-5561a116d1af", "anchor_text": "here"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----1f99913070b2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----1f99913070b2---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----1f99913070b2---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1f99913070b2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----1f99913070b2---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f99913070b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=-----1f99913070b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1f99913070b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=-----1f99913070b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1f99913070b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1f99913070b2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1f99913070b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1f99913070b2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1f99913070b2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1f99913070b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1f99913070b2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1f99913070b2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1f99913070b2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1f99913070b2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1f99913070b2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1f99913070b2--------------------------------", "anchor_text": ""}, {"url": "https://aseem-kash.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://aseem-kash.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aseem Kashyap"}, {"url": "https://aseem-kash.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "124 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd0d0126ce1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=post_page-fd0d0126ce1f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9a364a98696f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-convolution-neural-networks-interpret-images-1f99913070b2&newsletterV3=fd0d0126ce1f&newsletterV3Id=9a364a98696f&user=Aseem+Kashyap&userId=fd0d0126ce1f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}