{"url": "https://towardsdatascience.com/face-landmarks-detection-with-pytorch-4b4852f5e9c4", "time": 1683010956.152962, "path": "towardsdatascience.com/face-landmarks-detection-with-pytorch-4b4852f5e9c4/", "webpage": {"metadata": {"title": "Face Landmarks Detection With PyTorch | by Abdur Rahman Kalim | Towards Data Science", "h1": "Face Landmarks Detection With PyTorch", "description": "Can computers really understand the human face?"}, "outgoing_paragraph_urls": [{"url": "http://dlib.net/files/data/ibug_300W_large_face_landmark_dataset.tar.gz", "anchor_text": "DLib Dataset", "paragraph_index": 2}, {"url": "https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml", "anchor_text": "pre-trained classifier XML file", "paragraph_index": 12}, {"url": "http://arkalim.github.io/", "anchor_text": "website", "paragraph_index": 20}], "all_paragraphs": ["Ever wondered how Instagram applies stunning filters to your face? The software detects key points on your face and projects a mask on top. This tutorial will guide you on how to build one such software using Pytorch.", "The complete code can be found in the interactive Colab Notebook below.", "In this tutorial, we will use the official DLib Dataset which contains 6666 images of varying dimensions. Additionally, labels_ibug_300W_train.xml (comes with the dataset) contains the coordinates of 68 landmarks for each face. The script below will download the dataset and unzip it in Colab Notebook.", "Here is a sample image from the dataset. We can see that the face occupies a very small fraction of the entire image. If we feed the full image to the neural network, it will also process the background (irrelevant information), making it difficult for the model to learn. Therefore, we need to crop the image and feed only the face portion.", "To prevent the neural network from overfitting the training dataset, we need to randomly transform the dataset. We will apply the following operations to the training and validation dataset:", "Now that we have our transformations ready, let\u2019s write our dataset class. The labels_ibug_300W_train.xml contains the image path, landmarks and coordinates for the bounding box (for cropping the face). We will store these values in lists to access them easily during training. In this tutorial, the neural network will be trained on grayscale images.", "Note: landmarks = landmarks - 0.5 is done to zero-centre the landmarks as zero-centred outputs are easier for the neural network to learn.", "The output of the dataset after preprocessing will look something like this (landmarks have been plotted on the image).", "We will use the ResNet18 as the basic framework. We need to modify the first and last layers to suit our purpose. In the first layer, we will make the input channel count as 1 for the neural network to accept grayscale images. Similarly, in the final layer, the output channel count should equal 68 * 2 = 136 for the model to predict the (x, y) coordinates of the 68 landmarks for each face.", "We will use the Mean Squared Error between the predicted landmarks and the true landmarks as the loss function. Keep in mind that the learning rate should be kept low to avoid exploding gradients. The network weights will be saved whenever the validation loss reaches a new minimum value. Train for at least 20 epochs to get the best performance.", "Use the code snippet below to predict landmarks in unseen images.", "The above code snippet will not work in Colab Notebook as some functionality of the OpenCV is not supported in Colab yet. To run the above cell, use your local machine.", "OpenCV Harr Cascade Classifier is used to detect faces in an image. Object detection using Haar Cascades is a machine learning-based approach where a cascade function is trained with a set of input data. OpenCV already contains many pre-trained classifiers for face, eyes, pedestrians, and many more. In our case, we will be using the face classifier for which you need to download the pre-trained classifier XML file and save it to your working directory.", "Detected faces in the input image are then cropped, resized to (224, 224) and fed to our trained neural network to predict landmarks in them.", "The predicted landmarks in the cropped faces are then overlayed on top of the original image. The result is the image shown below. Pretty impressive, right!", "Similarly, landmarks detection on multiple faces:", "Here, you can see that the OpenCV Harr Cascade Classifier has detected multiple faces including a false positive (a fist is predicted as a face). So, the network has plotted some landmarks on that.", "If you made it till here, hats off to you! You just trained your very own neural network to detect face landmarks in any image. Try predicting face landmarks on your webcam feed!!", "If you have any suggestions, please leave a comment. I write articles regularly so you should consider following me to get more such articles in your feed.", "If you liked this article, you might as well love these:", "Visit my website to learn more about me and my work.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Education | Technology | Productivity | Artificial Intelligence | Data Science | Deep Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4b4852f5e9c4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://abdur-rahman-kalim.medium.com/?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": ""}, {"url": "https://abdur-rahman-kalim.medium.com/?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": "Abdur Rahman Kalim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79cf1f77d930&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=post_page-79cf1f77d930----4b4852f5e9c4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b4852f5e9c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b4852f5e9c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@armedshutter?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ayo Ogunseinde"}, {"url": "https://unsplash.com/s/photos/girls?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://colab.research.google.com/drive/1TOw7W_WU4oltoGZfZ_0krpxmhdFR2gmb", "anchor_text": "Face Landmark Detectioncolab.research.google.com"}, {"url": "http://dlib.net/files/data/ibug_300W_large_face_landmark_dataset.tar.gz", "anchor_text": "DLib Dataset"}, {"url": "https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml", "anchor_text": "pre-trained classifier XML file"}, {"url": "https://towardsdatascience.com/machine-learning-visualized-11965ecc645c", "anchor_text": "Machine Learning - VisualizedA visual approach to understand machine learningtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/principal-component-analysis-visualized-17701e18f2fa", "anchor_text": "Principal Component Analysis - VisualizedData compression using Principal Component Analysis (PCA)towardsdatascience.com"}, {"url": "http://arkalim.github.io/", "anchor_text": "website"}, {"url": "https://medium.com/tag/face-detection?source=post_page-----4b4852f5e9c4---------------face_detection-----------------", "anchor_text": "Face Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4b4852f5e9c4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----4b4852f5e9c4---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----4b4852f5e9c4---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/landmark-detection?source=post_page-----4b4852f5e9c4---------------landmark_detection-----------------", "anchor_text": "Landmark Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b4852f5e9c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=-----4b4852f5e9c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b4852f5e9c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=-----4b4852f5e9c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b4852f5e9c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4b4852f5e9c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4b4852f5e9c4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4b4852f5e9c4--------------------------------", "anchor_text": ""}, {"url": "https://abdur-rahman-kalim.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://abdur-rahman-kalim.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abdur Rahman Kalim"}, {"url": "https://abdur-rahman-kalim.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "129 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79cf1f77d930&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=post_page-79cf1f77d930--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7fa3b489e8e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmarks-detection-with-pytorch-4b4852f5e9c4&newsletterV3=79cf1f77d930&newsletterV3Id=7fa3b489e8e7&user=Abdur+Rahman+Kalim&userId=79cf1f77d930&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}