{"url": "https://towardsdatascience.com/metrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2", "time": 1682997628.1204748, "path": "towardsdatascience.com/metrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2/", "webpage": {"metadata": {"title": "Metrics to Evaluate your Semantic Segmentation Model | by Ekin Tiu | Towards Data Science", "h1": "Metrics to Evaluate your Semantic Segmentation Model", "description": "Semantic segmentation. My absolute favorite task. I would make a deep learning model, have it all nice and trained\u2026 but wait. How do I know my model is performing well? In other words, what are the\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Semantic segmentation. My absolute favorite task. I would make a deep learning model, have it all nice and trained\u2026 but wait. How do I know my model is performing well? In other words, what are the most common metrics for semantic segmentation? Here\u2019s a clear cut guide to the essential metrics that you need to know to ensure your model performs well. I have also included Keras implementations below.", "If you want to learn more about Semantic Segmentation with Deep Learning, check out this Medium article by George Seif.", "Pixel accuracy is perhaps the easiest to understand conceptually. It is the percent of pixels in your image that are classified correctly.", "While it is easy to understand, it is in no way the best metric.", "At first glance, it might be difficult to see the issue with this metric. To expose this metric for what it really is, here\u2019s a scenario: Let\u2019s say you ran the following image(Left)through your segmentation model. The image on the right is the ground truth, or annotation (what the model is supposed to segment). In this case, our model is trying to segment ships in a satellite image.", "You see that your segmentation accuracy is 95%. That\u2019s awesome! Let\u2019s see how your segmentation looks like!", "Not exactly what you were hoping for, huh. Is there something wrong with our calculation? Nope. It\u2019s exactly right. It\u2019s just that one class was 95% of the original image. So if the model classifies all pixels as that class, 95% of pixels are classified accurately while the other 5% are not. As a result, although your accuracy is a whopping 95%, your model is returning a completely useless prediction. This is meant to illustrate that high pixel accuracy doesn\u2019t always imply superior segmentation ability.", "This issue is called class imbalance. When our classes are extremely imbalanced, it means that a class or some classes dominate the image, while some other classes make up only a small portion of the image. Unfortunately, class imbalance is prevalent in many real world data sets, so it can\u2019t be ignored. Therefore, I present to you two alternative metrics that are better at dealing with this issue:", "The Intersection-Over-Union (IoU), also known as the Jaccard Index, is one of the most commonly used metrics in semantic segmentation\u2026 and for good reason. The IoU is a very straightforward metric that\u2019s extremely effective.", "Before reading the following statement, take a look at the image to the left. Simply put, the IoU is the area of overlap between the predicted segmentation and the ground truth divided by the area of union between the predicted segmentation and the ground truth, as shown on the image to the left. This metric ranges from 0\u20131 (0\u2013100%) with 0 signifying no overlap and 1 signifying perfectly overlapping segmentation.", "For binary (two classes) or multi-class segmentation, the mean IoU of the image is calculated by taking the IoU of each class and averaging them. (It\u2019s implemented slightly differently in code).", "Now let\u2019s try to understand why this metric is better than pixel accuracy by using the same scenario as section 1. For the sake of simplicity, let\u2019s assume all the ships (colored boxes) are part of the same class.", "But wait, what exactly is overlap and union in our context? The image above shows a pretty clear picture, but I found it a bit difficult to understand in the context of predicted vs. ground truth because they aren\u2019t necessarily overlapping like the image depicts above. Let\u2019s take a look at the predicted segmentation and the ground truth side-by-side.", "Let\u2019s calculate the ship IoU first. We assume the total area of the image is 100 (100 pixels). First, let\u2019s think about the ships\u2019 overlap. We can pretend that we move the predicted segmentation (left) directly above the ground truth (right), and see if there are any ship pixels that overlap. Since there are no pixels that are classified as ships by the model, there are 0 overlapping ship pixels.", "Union consists of all of the pixels classified as ships from both images, minus the overlap/intersection. In this case, there are 5 pixels (this is an arbitrary number choice) that are classified as ships total. Subtract the overlap/intersection which is 0 to get 5 as the area of union. After doing the calculations, we learn that the IoU is merely 47.5%! See the calculation below.", "Area of Overlap/Area of Union = 0%", "Now for the black background, we do the same thing.", "Area of Overlap/Area of Union =95%", "Wow. That\u2019s a lot lower than the 95% pixel accuracy we calculated. It is obvious that 47.5 is a much better indication of the success of our segmentation, or more appropriately, the lack thereof.", "Here is a great Keras implementation that I used in my own projects:", "Both y_true and y_pred are m x r x c x n where m is the number of images, r is the number of rows, c is the number of columns, and n is the number of classes.", "Simply put, the Dice Coefficient is 2 * the Area of Overlap divided by the total number of pixels in both images. (See explanation of area of union in section 2).", "So for the same scenario used in 1 and 2, we would perform the following calculations:", "Total Number of Pixels for both images combined = 200", "Ships: Area of Overlap = 0", "Background: Area of Overlap = 95", "In this case, we got the same value as the IoU, but this will not always be the case.", "The Dice coefficient is very similar to the IoU. They are positively correlated, meaning if one says model A is better than model B at segmenting an image, then the other will say the same. Like the IoU, they both range from 0 to 1, with 1 signifying the greatest similarity between predicted and truth.", "To better understand the differences between them, I recommend reading the following Stack Exchange answer:", "Here\u2019s an implementation for the Dice Coefficient with the same input conditions specified in section 2:", "In conclusion, the most commonly used metrics for semantic segmentation are the IoU and the Dice Coefficient. I have included code implementations in Keras, and will explain them in greater depth in an upcoming article.", "As some of you may have noticed, I have purposely excluded discussions and explanations regarding true positives, true negatives, false positives and false negatives. Though important, I believe they obfuscate the clear conceptual understanding of these metrics that I tried to emphasize in this article.", "I hope this article imparts a greater insight about each metric so that you may have a deeper understanding during implementation or when reading literature.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CS @ Stanford University | Stanford ML Group"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6bcb99639aa2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ekintiu.medium.com/?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": ""}, {"url": "https://ekintiu.medium.com/?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": "Ekin Tiu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F684d91ee6205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&user=Ekin+Tiu&userId=684d91ee6205&source=post_page-684d91ee6205----6bcb99639aa2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6bcb99639aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6bcb99639aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/semantic-segmentation-with-deep-learning-a-guide-and-code-e52fc8958823", "anchor_text": "Semantic Segmentation with Deep LearningA guide and codetowardsdatascience.com"}, {"url": "https://towardsdatascience.com/@aion.stu?source=post_page-----9a41cb8924f0----------------------", "anchor_text": "Vlad Shmyhlo"}, {"url": "https://stats.stackexchange.com/a/276144", "anchor_text": "F1/Dice-Score vs IoUbegingroup$ You're on the right track. So a few things right off the bat. From the definition of the two metrics, we\u2026stats.stackexchange.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6bcb99639aa2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/segmentation?source=post_page-----6bcb99639aa2---------------segmentation-----------------", "anchor_text": "Segmentation"}, {"url": "https://medium.com/tag/metrics?source=post_page-----6bcb99639aa2---------------metrics-----------------", "anchor_text": "Metrics"}, {"url": "https://medium.com/tag/evaluation?source=post_page-----6bcb99639aa2---------------evaluation-----------------", "anchor_text": "Evaluation"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6bcb99639aa2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6bcb99639aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&user=Ekin+Tiu&userId=684d91ee6205&source=-----6bcb99639aa2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6bcb99639aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&user=Ekin+Tiu&userId=684d91ee6205&source=-----6bcb99639aa2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6bcb99639aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6bcb99639aa2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6bcb99639aa2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6bcb99639aa2--------------------------------", "anchor_text": ""}, {"url": "https://ekintiu.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ekintiu.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ekin Tiu"}, {"url": "https://ekintiu.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F684d91ee6205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&user=Ekin+Tiu&userId=684d91ee6205&source=post_page-684d91ee6205--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F70d9799552f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmetrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2&newsletterV3=684d91ee6205&newsletterV3Id=70d9799552f&user=Ekin+Tiu&userId=684d91ee6205&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}