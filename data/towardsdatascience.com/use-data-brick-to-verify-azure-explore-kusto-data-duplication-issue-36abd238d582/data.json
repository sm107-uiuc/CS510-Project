{"url": "https://towardsdatascience.com/use-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582", "time": 1683012367.696932, "path": "towardsdatascience.com/use-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582/", "webpage": {"metadata": {"title": "Python to find Kusto table with data duplication issue | by Binlong Li | Towards Data Science", "h1": "Python to find Kusto table with data duplication issue", "description": "Azure Data Explorer (Kusto), is one of the most dedicated relational databases in the market. The whole system is running in SSD and memory, to offer fast and responsive data analysis. It could be a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.microsoft.com/en-us/azure/data-explorer/kusto/api/python/kusto-python-client-library", "anchor_text": "Azure Data Explorer Python SDK", "paragraph_index": 5}], "all_paragraphs": ["Azure Data Explorer (Kusto), is one of the most dedicated relational databases in the market. The whole system is running in SSD and memory, to offer fast and responsive data analysis. It could be a good option to serve as warm-path data storage.", "Due to various reasons, such as mal-function client, imperfect data pipeline, etc. data could be ingested into Kusto multiple times. It leads to data duplication issue. This problem could be even more severe if the ingested data is summary data, such as overall revenue for a group of stores, etc.", "Data duplication could mess-up all the following data analysis, People may make the wrong decision based on that. Therefore, data cleaning/deduplication is necessary. Before that, we need to first confirm, whether the current Kusto table having a duplication issue.", "The confirmation step is the main focus of this article.", "The main idea contains the following steps:", "Python has packages to connect to Kusto: Azure Data Explorer Python SDK. Here, we use package: azure-kusto-data.", "The following code snippet would allow us to create the KustoClient. It is used to query Kusto Cluster. Before we connect to Kusto, we need to create the AppId and register it with the Kusto Cluster.", "getschema will return the table schema. KustoClient will return the table schema as our familiar Pandas DataFrame. It is easy for us to do further processing.", "Assume, the table is a summary table. There are no sub-set of columns that could uniquely identify the row. Therefore, we will use all the columns in the schema to create the identification. The identification would be the concatenation of all the column values.", "Therefore, we will convert all the non-string data to a string, by using the tostring() operator. That is the purpose for schema.apply( axis = 1), where axis =1 will go over the table row by row.", "At last, the strcat() from Kusto will concatenate all the columns based the operations defined with hashOp.", "If for another table, we know a subset of columns could uniquely identify the row, such as a combination of user_id and order_id. In that case, we could use the second hashKusto case.", "Notice the hashKusto value we created above, is used as extensions in Kusto query. That will create an additional column, hash, in the KustoTable. We later use summarize to get the count for each identification hash.", "At last, the duplicated records are the ones with recordsCount > 1.", "By using Python, we establish a simple and straight forward way to verify and identify duplicated rows within a Kusto table. This would offer a solid ground for all the following data analysis.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m a software engineer manager, and a MBA student in UIUC. Talk about business, management, career development and technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F36abd238d582&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----36abd238d582--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----36abd238d582--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@herbert19lee?source=post_page-----36abd238d582--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herbert19lee?source=post_page-----36abd238d582--------------------------------", "anchor_text": "Binlong Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c30b96d9ba1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&user=Binlong+Li&userId=3c30b96d9ba1&source=post_page-3c30b96d9ba1----36abd238d582---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F36abd238d582&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F36abd238d582&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mistrjosh?utm_source=medium&utm_medium=referral", "anchor_text": "Joshua Michaels"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://docs.microsoft.com/en-us/azure/data-explorer/kusto/api/python/kusto-python-client-library", "anchor_text": "Azure Data Explorer Python SDK"}, {"url": "https://medium.com/tag/data-science?source=post_page-----36abd238d582---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/database?source=post_page-----36abd238d582---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/tag/data?source=post_page-----36abd238d582---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/kusto?source=post_page-----36abd238d582---------------kusto-----------------", "anchor_text": "Kusto"}, {"url": "https://medium.com/tag/python?source=post_page-----36abd238d582---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F36abd238d582&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&user=Binlong+Li&userId=3c30b96d9ba1&source=-----36abd238d582---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F36abd238d582&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&user=Binlong+Li&userId=3c30b96d9ba1&source=-----36abd238d582---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F36abd238d582&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----36abd238d582--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F36abd238d582&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----36abd238d582---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----36abd238d582--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----36abd238d582--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----36abd238d582--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----36abd238d582--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----36abd238d582--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----36abd238d582--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----36abd238d582--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----36abd238d582--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herbert19lee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@herbert19lee?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Binlong Li"}, {"url": "https://medium.com/@herbert19lee/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "51 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c30b96d9ba1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&user=Binlong+Li&userId=3c30b96d9ba1&source=post_page-3c30b96d9ba1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe190e0c5837d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-data-brick-to-verify-azure-explore-kusto-data-duplication-issue-36abd238d582&newsletterV3=3c30b96d9ba1&newsletterV3Id=e190e0c5837d&user=Binlong+Li&userId=3c30b96d9ba1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}