{"url": "https://towardsdatascience.com/you-must-know-least-squares-a900f63e0bf0", "time": 1682997589.878612, "path": "towardsdatascience.com/you-must-know-least-squares-a900f63e0bf0/", "webpage": {"metadata": {"title": "You must know least squares. Let\u2019s get away from the neural network\u2026 | by Marin Vlastelica | Towards Data Science", "h1": "You must know least squares", "description": "Machine learning is a really hot topic, everybody wants to do it or use it somehow in a product, or to reduce business operating costs. Machine learning seems to be the answer to the prayers of the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/kernel-secrets-in-machine-learning-2aab4c8a295f", "anchor_text": "this article", "paragraph_index": 9}, {"url": "https://jimimvp.github.io/", "anchor_text": "https://jimimvp.github.io/", "paragraph_index": 20}, {"url": "https://www.linkedin.com/in/mvlastelica/", "anchor_text": "https://www.linkedin.com/in/mvlastelica/", "paragraph_index": 20}], "all_paragraphs": ["Machine learning is a really hot topic, everybody wants to do it or use it somehow in a product, or to reduce business operating costs. Machine learning seems to be the answer to the prayers of the business world. Yet, it can be pretty astonishing how people jump into machine learning. Yes, I know, neural networks are the \u201cthing\u201d, but jumping into neural networks is misguided in my opinion.", "All of machine learning does not revolve about neural networks", "Yes, they can do cool stuff, with a lot, really a lot of compute. But there was a time when machine learning solutions were elegant, efficient and quick. In this article, we\u2019ll get down to the basics, and talk about least squares regression. Why should we talk about that? Because, believe it or not, this simple method is still used in statistical analysis, where there is a lot of data to analyze. In Kaggle competitions it is constantly used to observe trends in data, or variance and so on. Least squares is a thing, and not enough people know the math behind it although it is dead easy. So, let\u2019s get cracking.", "If you have ever taken a simple class in linear algebra, you know what is a matrix and you have most probably seen this kind of equation:", "If we want to get the solution to this equation, we need the inverse of matrix A (we are just going to consider the case where A is invertible, and the equation is not overdetermined). So the solution looks as simple as this:", "So now, we know how we get a solution to this simple equation, or better to say set of equations, since we can look at each row of matrix A as a linear equation by itself. The matrix formulation is a simple compact form to describe a set of linear equations.", "But this is not what we actually want to do in the end. We want to learn something, we want to do machine learning! So where is the learning in this\u2026 It is just a bunch of linear equations, so boring. Well, what do we do in machine learning exactly? We have a certain function that we want to fit, we call it function f which gives us a value y for some data x. Written down simply:", "As simple as that. So we want to learn f, in our case we suppose that f is a linear function (not going into problems of generalization and so on, just to keep it as simple as possible). I admit the notation is a bit tedious at this point. Previously used x as a point that has to satisfy a set of equations. In this case, we want to find the coefficients of a linear equation that describes the data. We can write this in our matrix form:", "This expression comes naturally when you think about it since each row in X is a data point and then we take basically the dot-product of the data point with w. Now, we need to define our learning algorithm, that is actually going to take only one step, closed-form solution. For that, we are going to need a bit of calculus. Firstly, we need to look at the following never-aging objective function in machine learning, the mean squared error:", "The || brackets are there because when we talk about vectors, we talk about their norms rather, in this case, it is shorthand for the sum of errors on each data point. If you want to know how important are norms and dot-products in ML, take a look at this article. The above error term has some nice properties, one of which is that it is quadratic. In optimization, we like quadratic functions. They are relatively easy to optimize because they are convex, they have one minimum that is global. And how do we find the solution to this, i.e. how do we minimize this function? Quite standard practice in calculus, we take the derivative and search for a solution where it is equal to 0.", "Which is basically saying that the gradient is equal to 0:", "And the gradient of MSE by taking the chain rule is equal to:", "Now, with a bit of matrix multiplication and set the gradient to 0, we can write out the solution in good old closed form:", "If you are doubting that it is that simple\u2026 Yes it is, you are actually doing machine learning with this small piece of math, or put another way rather, optimization.", "Note that this solution is the solution to the case where y is one-dimensional, extending to a multi-dimensional case is trivial and can be left as an exercise! This small piece of math can be implemented with a few lines of code, actually, the least squares part takes only 2 lines of code!", "This leads to the following figure, notice how it finds the best fitting line to the data (minimizes the square error).", "We can see that the plane goes through the middle of the data cluster where it minimizes the squared error.", "Obviously, we cannot fit all of the data with a straight line, or a plane, but with powerful feature extractors, we may be able to reduce our problem to a much simpler one. To put it into perspective, this is what neural networks do effectively, the only difference being that we use some nonlinearity as the activation function in the last layer. If we would remove this, we could look at the last layer of the neural network as a least squares problem, i.e. fitting a plane on the data (activations from previous layers).", "So, that was a short, painless introduction to least squares, if you are interested in some other machine learning articles:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD @ Max Planck Institute for Intelligent Systems | All things ML/AI | Gutar | https://jimimvp.github.io/ | https://www.linkedin.com/in/mvlastelica/ |"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa900f63e0bf0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://marinvp.medium.com/?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": ""}, {"url": "https://marinvp.medium.com/?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": "Marin Vlastelica"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8f3ed874afef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&user=Marin+Vlastelica&userId=8f3ed874afef&source=post_page-8f3ed874afef----a900f63e0bf0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa900f63e0bf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa900f63e0bf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/kernel-secrets-in-machine-learning-2aab4c8a295f", "anchor_text": "this article"}, {"url": "https://towardsdatascience.com/causal-vs-statistical-inference-3f2c3e617220", "anchor_text": "Causal vs. Statistical Inference"}, {"url": "https://towardsdatascience.com/kernel-secrets-in-machine-learning-2aab4c8a295f", "anchor_text": "Kernel Secrets in Machine Learning"}, {"url": "https://towardsdatascience.com/the-central-limit-theorem-and-its-implications-4a7adac9d6de", "anchor_text": "The Central Limit Theorem and its Implications"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a900f63e0bf0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a900f63e0bf0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a900f63e0bf0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a900f63e0bf0---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa900f63e0bf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&user=Marin+Vlastelica&userId=8f3ed874afef&source=-----a900f63e0bf0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa900f63e0bf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&user=Marin+Vlastelica&userId=8f3ed874afef&source=-----a900f63e0bf0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa900f63e0bf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa900f63e0bf0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a900f63e0bf0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a900f63e0bf0--------------------------------", "anchor_text": ""}, {"url": "https://marinvp.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://marinvp.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marin Vlastelica"}, {"url": "https://marinvp.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://jimimvp.github.io/", "anchor_text": "https://jimimvp.github.io/"}, {"url": "https://www.linkedin.com/in/mvlastelica/", "anchor_text": "https://www.linkedin.com/in/mvlastelica/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8f3ed874afef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&user=Marin+Vlastelica&userId=8f3ed874afef&source=post_page-8f3ed874afef--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9131bca7a450&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyou-must-know-least-squares-a900f63e0bf0&newsletterV3=8f3ed874afef&newsletterV3Id=9131bca7a450&user=Marin+Vlastelica&userId=8f3ed874afef&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}