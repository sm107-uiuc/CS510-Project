{"url": "https://towardsdatascience.com/algorithms-from-scratch-linear-regression-c654353d1e7c", "time": 1683010556.047916, "path": "towardsdatascience.com/algorithms-from-scratch-linear-regression-c654353d1e7c/", "webpage": {"metadata": {"title": "Algorithms From Scratch: Linear Regression | by Kurtis Pykes | Towards Data Science", "h1": "Algorithms From Scratch: Linear Regression", "description": "Linear Regression is a popular linear Machine Learning algorithm for regression-based problems. It is usually one of the first algorithms that is learnt when first learning Machine Learning, due to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Linear_regression#:~:text=In%20statistics%2C%20linear%20regression%20is,is%20called%20simple%20linear%20regression.", "anchor_text": "Linear Regression", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Loss_function", "anchor_text": "cost function", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "RMSE", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Mean_squared_error", "anchor_text": "MSE", "paragraph_index": 3}, {"url": "https://medium.com/u/c831f584bf94?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "John Sullivan", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/6-steps-to-write-any-machine-learning-algorithm-from-scratch-perceptron-case-study-335f638a70f3", "anchor_text": "6 Steps To Write Any Machine Learning Algorithm From Scratch: Perceptron Case Study", "paragraph_index": 4}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_regression.html", "anchor_text": "Documentation", "paragraph_index": 6}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html", "anchor_text": "Documentation", "paragraph_index": 6}, {"url": "https://matplotlib.org/tutorials/introductory/pyplot.html", "anchor_text": "Documentation", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent", "anchor_text": "Gradient Descent", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "RMSE", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Object-oriented_programming", "anchor_text": "Object oriented Programming (OOP)", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Linearity", "anchor_text": "Linearity", "paragraph_index": 21}, {"url": "https://en.wikipedia.org/wiki/Multicollinearity#:~:text=Multicollinearity%20refers%20to%20a%20situation,equal%20to%201%20or%20%E2%88%921.", "anchor_text": "Multicollinearity", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/Homoscedasticity", "anchor_text": "Homoscedasticity", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Normal Distribution", "paragraph_index": 24}, {"url": "https://en.wikipedia.org/wiki/Generalized_linear_model", "anchor_text": "Generalized Linear Models (GLM)", "paragraph_index": 24}, {"url": "https://en.wikipedia.org/wiki/Autocorrelation#:~:text=Autocorrelation%2C%20also%20known%20as%20serial,the%20time%20lag%20between%20them.", "anchor_text": "Autocorrelation", "paragraph_index": 25}], "all_paragraphs": ["Linear Regression is a popular linear Machine Learning algorithm for regression-based problems. It is usually one of the first algorithms that is learnt when first learning Machine Learning, due to its simplicity and how it builds into other algorithms like Logistic Regression and Neural Networks. In this story we are going to implement it from scratch so that we can build our intuition about what is going on within a Linear Regression model.", "Note: There are many frameworks with highly optimized code such as Scikit-Learn, Tensorflow and PyTorch, therefore it is usually unnecessary to build your own algorithm from scratch. However, it serves a good purpose to our intuition of what is happening within the model when we build it from scratch and this helps when we attempt to improve our models performance.", "A linear model is an algorithm that makes a prediction by simply computing a weighted sum of the input features plus a bias term (also referred to as the intercept term). Taking that into perspective, what we are doing when we use a linear regression model is we hope to explain the relationship between a dependent variable (i.e house price) and one or more independent variables (i.e. location, bedrooms, area, etc).", "When we train a model we are attempting to set the parameters to get a line that best fits the training data. Therefore, when we train a Linear Regression model we are trying to find the value of theta that best minimizes the cost function. The most common cost function of a regression models is the RMSE, however, it is much easier to minimize the MSE as it leads to the same result.", "If you have never written a Machine Learning algorithm from scratch, I greatly encourage you to do so. John Sullivan wrote a very useful story titled 6 Steps To Write Any Machine Learning Algorithm From Scratch: Perceptron Case Study which is the best advice I have managed to find on the internet about writing algorithms from scratch.", "For this section, I will be leveraging 3 Python packages. NumPy for Linear algebra, Scikit-Learn which is a popular Machine Learning framework and Matplotlib to visualize our data.", "First, we need a dataset. To do this I will sklearn.datasets.make_regression which allows you to generate a random regression problem \u2014 see Documentation. Next, I will split my data into training and test sets with sklearn.model_selection.train_test_split \u2014 Documentation.", "Lets use matplotlib.pyplot to see how our data looks \u2014 Documentation.", "Now we can begin our implementation of Linear Regression. The first step of our chunk is to randomly initialize parameters for our hypothesis function.", "Excellent. Next we want to calculate the partial derivatives and update our parameters. We do this using a very important Machine Learning algorithm called Gradient Descent. Ergo, we can implement steps 2\u20134 with Gradient Descent.", "Using these functions we can train our Linear Regression model on our training data to obtain model parameters that we will require for inference.", "Now, when we run this function we would obtain the optimized weights from our training data that we will use for inference on our test data. Next, we need to create a predict function for our inference that uses our stored weights.", "Great! Let\u2019s run these functions and plot them to see what happens\u2026", "Our line of best fit seems to be pretty decent. To be entirely sure of our implementation we are fortunate enough to have many Machine Learning libraries, with optimized code, to compare our implementation to. To compare, I am simply going to check the RMSE of our implementation vs Scikit-learn.", "Note: It may also be worthwhile to plot their implementation on the same plot and if their line of best fit covers yours then you are on the right tracks.", "For this implementation we used procedural programming which can become quite complex and cumbersome to maintain and does not maximize the potential of Python which is an Object oriented Programming (OOP) language. On that note, here is an OOP implementation of our Linear Regression model.", "Let\u2019s call this class and make it make a prediction on our test data\u2026", "As a sanity check we will test if the predictions are the same as our procedural implementation (since we know this is similar to the scikit-learn implementation already).", "Note: The problem we used as an example is simple linear regression problem (Univariate Linear Regression), y = WX + b, where W is the weight and b is the bias.", "Before deciding that we want to use Linear Regression it is important to understand the assumptions that the model makes of our data so that we can perform the necessary feature engineering to align with our model.", "For more on feature engineering, see my previous story on this topic\u2026", "Linearity \u2014 Linear regression assumes a linear relationship between the features and the target that we want to predict. We can check the validity of this by plotting scatter graphs of the features in relation to the target variable.", "Multicollinearity\u2014 Refers to a situation in which two or more explanatory variables in a multiple regression model are highly related (Source: Wikipedia). When we implement Linear Regression we are assuming that there is little to no multicollinearity since when present it weakens the statistical power of the regression model. To identify whether multicollinearity is present in our data we can use a correlation matrix to see which features are highly correlated and remove one of the highly correlated features.", "Homoscedasticity \u2014 In statistics, a sequence (or a vector) of random variables is homoscedastic if all its random variables have the same finite variance (Source: Wikipedia). Linear Regression assumes that the noise is the same (may also be referred to as error term or random disturbance) across all observations and does not depend on the values of the independent variables. We may use a scatter plot of the residual values against the predicted values to check for homoscedasticity. We should expect no patterns in the distribution because if there is a pattern then the data is heteroscedastic.", "Normality of Error Distribution \u2014 Data points are normally distributed around the regression line. In other words, we assume the residuals follow the Normal Distribution. We can check this using a Histogram or a QQ-plot \u2014 We can overcome this by using Generalized Linear Models (GLM).", "Autocorrelation \u2014The correlation of a signal with a delayed copy of itself as a function of delay \u2014 Informally, it is the similarity between observations as a function of the time lag between them (Source: Wikipedia). To put it simply Autocorrelation occurs when the residuals are not independent from each other. We may use a scatter plot to visually check for autocorrelation or the Durbin-Watsons\u2019s test which test the null hypothesis that the residuals are not linearly autocorrelated.", "For more about Linear Regression you can read the Wikipedia page.", "Linear Regression is one of the easiest Machine Learning models and most likely the first you would learn or should learn. It is a very useful tool to analyze the relationship between variables, but due to the many assumptions of the model and simplification of real-world problems, it is not recommended for most practical applications.", "Thank you for taking the time to go through this story. If there is anything that I have missed or you\u2019d like me to clarify, leave a response in the comments. Additionally, If you\u2019d like to get in contact with me, I am most accessible on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc654353d1e7c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kurtispykes.medium.com/?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877----c654353d1e7c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc654353d1e7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc654353d1e7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/algorithms-from-scratch", "anchor_text": "Algorithms From Scratch"}, {"url": "https://unsplash.com/@isaacmsmith?utm_source=medium&utm_medium=referral", "anchor_text": "Isaac Smith"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Linear_regression#:~:text=In%20statistics%2C%20linear%20regression%20is,is%20called%20simple%20linear%20regression.", "anchor_text": "Linear Regression"}, {"url": "https://github.com/kurtispykes/ml-from-scratch/blob/master/linear_regression.ipynb", "anchor_text": "kurtispykes/ml-from-scratchPermalink Dismiss GitHub is home to over 50 million developers working together to host and review code, manage\u2026github.com"}, {"url": "https://en.wikipedia.org/wiki/Loss_function", "anchor_text": "cost function"}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "RMSE"}, {"url": "https://en.wikipedia.org/wiki/Mean_squared_error", "anchor_text": "MSE"}, {"url": "https://medium.com/u/c831f584bf94?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "John Sullivan"}, {"url": "https://towardsdatascience.com/6-steps-to-write-any-machine-learning-algorithm-from-scratch-perceptron-case-study-335f638a70f3", "anchor_text": "6 Steps To Write Any Machine Learning Algorithm From Scratch: Perceptron Case Study"}, {"url": "https://math.stackexchange.com/questions/3152235/partial-derivative-of-mse-cost-function-in-linear-regression", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_regression.html", "anchor_text": "Documentation"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html", "anchor_text": "Documentation"}, {"url": "https://matplotlib.org/tutorials/introductory/pyplot.html", "anchor_text": "Documentation"}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent", "anchor_text": "Gradient Descent"}, {"url": "https://en.wikipedia.org/wiki/Root-mean-square_deviation", "anchor_text": "RMSE"}, {"url": "https://en.wikipedia.org/wiki/Object-oriented_programming", "anchor_text": "Object oriented Programming (OOP)"}, {"url": "https://towardsdatascience.com/feature-engineering-for-numerical-data-e20167ec18", "anchor_text": "Feature Engineering for Numerical DataTips \u2019n\u2019 Tricks for engineering numerical valuestowardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Linearity", "anchor_text": "Linearity"}, {"url": "https://en.wikipedia.org/wiki/Multicollinearity#:~:text=Multicollinearity%20refers%20to%20a%20situation,equal%20to%201%20or%20%E2%88%921.", "anchor_text": "Multicollinearity"}, {"url": "https://en.wikipedia.org/wiki/Homoscedasticity", "anchor_text": "Homoscedasticity"}, {"url": "https://en.wikipedia.org/wiki/Normal_distribution", "anchor_text": "Normal Distribution"}, {"url": "https://en.wikipedia.org/wiki/Generalized_linear_model", "anchor_text": "Generalized Linear Models (GLM)"}, {"url": "https://en.wikipedia.org/wiki/Autocorrelation#:~:text=Autocorrelation%2C%20also%20known%20as%20serial,the%20time%20lag%20between%20them.", "anchor_text": "Autocorrelation"}, {"url": "https://en.wikipedia.org/wiki/Linear_regression#:~:text=In%20statistics%2C%20linear%20regression%20is,is%20called%20simple%20linear%20regression.", "anchor_text": "Linear regressionIn statistics, linear regression is a linear approach to modeling the relationship between a scalar response (or\u2026en.wikipedia.org"}, {"url": "https://www.linkedin.com/in/kurtispykes/", "anchor_text": "Kurtis Pykes - AI Writer - Towards Data Science | LinkedInView Kurtis Pykes' profile on LinkedIn, the world's largest professional community. Kurtis has 1 job listed on their\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c654353d1e7c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c654353d1e7c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c654353d1e7c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/algorithms-from-scratch?source=post_page-----c654353d1e7c---------------algorithms_from_scratch-----------------", "anchor_text": "Algorithms From Scratch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc654353d1e7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&user=Kurtis+Pykes&userId=5ba760786877&source=-----c654353d1e7c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc654353d1e7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&user=Kurtis+Pykes&userId=5ba760786877&source=-----c654353d1e7c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc654353d1e7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc654353d1e7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c654353d1e7c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c654353d1e7c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c654353d1e7c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c654353d1e7c--------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kurtispykes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kurtis Pykes"}, {"url": "https://kurtispykes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://www.fullstackfreelancershub.com/wisdom-wednesday", "anchor_text": "https://www.fullstackfreelancershub.com/wisdom-wednesday"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ba760786877&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&user=Kurtis+Pykes&userId=5ba760786877&source=post_page-5ba760786877--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffde3d752d24c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Falgorithms-from-scratch-linear-regression-c654353d1e7c&newsletterV3=5ba760786877&newsletterV3Id=fde3d752d24c&user=Kurtis+Pykes&userId=5ba760786877&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}