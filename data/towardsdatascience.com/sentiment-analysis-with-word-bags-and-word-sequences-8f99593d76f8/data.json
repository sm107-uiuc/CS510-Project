{"url": "https://towardsdatascience.com/sentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8", "time": 1682994818.4302, "path": "towardsdatascience.com/sentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8/", "webpage": {"metadata": {"title": "Sentiment Analysis with Word Bags and Word Sequences | by Ashok Chilakapati | Towards Data Science", "h1": "Sentiment Analysis with Word Bags and Word Sequences", "description": "The bag-of-words approach to turning documents into numerical vectors ignores the sequence of words in the documents. Classifiers that work off of such vectors are then expected to pay the price for\u2026"}, "outgoing_paragraph_urls": [{"url": "http://xplordat.com/2019/01/13/word-bags-vs-word-sequences-for-text-classification/", "anchor_text": "previous article", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html", "anchor_text": "SciKit", "paragraph_index": 1}, {"url": "https://keras.io/layers/recurrent/", "anchor_text": "Keras", "paragraph_index": 1}, {"url": "https://github.com/ashokc/Sentiment-Analysis-with-Word-Bags-and-Sequences", "anchor_text": "github", "paragraph_index": 1}, {"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "large movie reviews", "paragraph_index": 2}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html", "anchor_text": "Tf-Idf Vectorizer", "paragraph_index": 4}, {"url": "https://keras.io/preprocessing/text/", "anchor_text": "processor", "paragraph_index": 5}, {"url": "https://keras.io/layers/recurrent/", "anchor_text": "LSTM", "paragraph_index": 6}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html#sklearn.svm.LinearSVC", "anchor_text": "SVM", "paragraph_index": 6}, {"url": "https://github.com/ashokc/Sentiment-Analysis-with-Word-Bags-and-Sequences", "anchor_text": "github", "paragraph_index": 12}, {"url": "http://xplordat.com/2019/01/13/word-bags-vs-word-sequences-for-text-classification/", "anchor_text": "previous article", "paragraph_index": 12}, {"url": "http://xplordat.com/2018/09/27/word-embeddings-and-document-vectors-part-1-similarity/", "anchor_text": "xplordat.com", "paragraph_index": 17}], "all_paragraphs": ["The bag-of-words approach to turning documents into numerical vectors ignores the sequence of words in the documents. Classifiers that work off of such vectors are then expected to pay the price for not accounting for the difference a specific sequence of words makes to the meaning and the implied target class thereof. Makes sense. That is the argument anyways in considering the newer deep learning approaches such as LSTM (Long Short-Term Memory) neural nets that can work with sequences. In the previous article we have indeed shown that the naive bayes classifier using word bag vectors (tf-idf to be specific) took a drubbing in the hands of LSTM (0.23 for naive-bayes/tf-idf vs 0.91 with LSTM for the F1-score) when the sequence of words was the deciding the factor for classification.", "But that text corpus was artificial. It was constructed to bring out the best in sequence respecting models such as LSTM and the worst in others that ignored the said sequence at their peril. Does this out performance on the part of LSTM extend to a real life text corpus where the sequence of words may not be the deciding factor for classification? That is the question we explore here. We start with a simpler binary classification task in this post and consider a multilabel classification task in a later post. We use Support Vector Machines (SVM) with tf-idf vectors as the proxy for bag-of-words approach and LSTM for the sequence respecting approach. SVM is implemented via SciKit and LSTM is implemented via Keras. While we go through some code snippets here, the full code for reproducing the results can be downloaded from github.", "The text corpus, large movie reviews from Stanford is often used for binary sentiment classification \u2014 i.e. is the movie good or bad based on the reviews. The positive and negative reviews are downloaded to disk in separate directories. Here is the code snippet to \u2018clean\u2019 the documents and tokenize them for analysis.", "LSTM works with word sequences as input while the traditional classifiers work with word bags such as tf-idf vectors. Having each document in hand as a list of tokens we are ready for either.", "We use Scikit\u2019s Tf-Idf Vectorizer to build the vocabulary and the document vectors from the tokens.", "The text processor in Keras turns each document into a sequence/string of integers, where the integer value indicates the actual word as per the {word:index} dictionary that the same processing generates. We use 200-long sequences as the stats on the tokens show that over 86% of the documents have less than 200 words. In Line # 8 in the code below, the documents with fewer than 200 words will be \u2018post\u2019 padded with the index value 0 that is ignored by the embedding layer (mask_zero=True is set for in the definition of embedding layer in Section 3).", "LSTM is implemented via Keras while SVM is implemented via SciKit. Both work with the same train/test split so a comparison would be fair. Twenty percent of the overall corpus (i.e 10,000 documents) are set aside for test while training on the remaining 40,000 documents.", "As in the earlier article, we use the simplest possible LSTM model, with an embedding layer, one LSTM layer and the output layer.", "The embedding layer in Figure 1 reduces the number of features from 98089 (the number of unique words in the corpus) to 300. The LSTM layer outputs a 150-long vector that is fed to the output layer for classification. The model itself is defined quite simply below.", "Training is done with early stopping to prevent over training in Line #6 in the code below. The final output layer yields a vector that is as long as the number of labels, and the argmax of that vector is the predicted class label.", "The model for SVM is much less involved as there are far fewer moving parts and parameters to decide upon. That is always a good thing of course.", "The confusion matrix and the F1-scores obtained are what we are interested in. With the predicted labels in hand from either approach we use SciKit\u2019s API to compute them.", "While we have gone through some snippets in different order, the complete code for lstm_movies.py for running LSTM and svm_movies.py for running SVM is on github. As indicated in the previous article, various random seeds are initialized for repeatability.", "yields about 0.87 as the F1-score converging in 6 epochs due to early stopping.", "Clearly, both SVM at 0.90 as the F1-score and LSTM at 0.87 have done very well for binary classification. The confusion matrices show excellent diagonal dominance as expected.", "While they are equal on the quality side, LSTM does take much longer \u2014 2hrs as opposed to less than a second. That is too big a difference to be ignored.", "With that we conclude this post. In the next post we go over the results for a multilabel classification exercise and the impact of external word-embeddings such as fasttext.", "Originally published at xplordat.com on January 28, 2019.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8f99593d76f8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ashok.chilakapati?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ashok.chilakapati?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": "Ashok Chilakapati"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcc37b40eae29&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&user=Ashok+Chilakapati&userId=cc37b40eae29&source=post_page-cc37b40eae29----8f99593d76f8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f99593d76f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f99593d76f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://xplordat.com/2019/01/13/word-bags-vs-word-sequences-for-text-classification/", "anchor_text": "previous article"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html", "anchor_text": "SciKit"}, {"url": "https://keras.io/layers/recurrent/", "anchor_text": "Keras"}, {"url": "https://github.com/ashokc/Sentiment-Analysis-with-Word-Bags-and-Sequences", "anchor_text": "github"}, {"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "large movie reviews"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html", "anchor_text": "Tf-Idf Vectorizer"}, {"url": "https://keras.io/preprocessing/text/", "anchor_text": "processor"}, {"url": "https://keras.io/layers/recurrent/", "anchor_text": "LSTM"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html#sklearn.svm.LinearSVC", "anchor_text": "SVM"}, {"url": "https://github.com/ashokc/Sentiment-Analysis-with-Word-Bags-and-Sequences", "anchor_text": "github"}, {"url": "http://xplordat.com/2019/01/13/word-bags-vs-word-sequences-for-text-classification/", "anchor_text": "previous article"}, {"url": "http://xplordat.com/2018/09/27/word-embeddings-and-document-vectors-part-1-similarity/", "anchor_text": "xplordat.com"}, {"url": "https://medium.com/tag/svm?source=post_page-----8f99593d76f8---------------svm-----------------", "anchor_text": "Svm"}, {"url": "https://medium.com/tag/text-classification?source=post_page-----8f99593d76f8---------------text_classification-----------------", "anchor_text": "Text Classification"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8f99593d76f8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/keras?source=post_page-----8f99593d76f8---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/lstm?source=post_page-----8f99593d76f8---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8f99593d76f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&user=Ashok+Chilakapati&userId=cc37b40eae29&source=-----8f99593d76f8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8f99593d76f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&user=Ashok+Chilakapati&userId=cc37b40eae29&source=-----8f99593d76f8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f99593d76f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8f99593d76f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8f99593d76f8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8f99593d76f8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8f99593d76f8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8f99593d76f8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8f99593d76f8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ashok.chilakapati?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ashok.chilakapati?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ashok Chilakapati"}, {"url": "https://medium.com/@ashok.chilakapati/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "244 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcc37b40eae29&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&user=Ashok+Chilakapati&userId=cc37b40eae29&source=post_page-cc37b40eae29--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5ab4b71672c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-with-word-bags-and-word-sequences-8f99593d76f8&newsletterV3=cc37b40eae29&newsletterV3Id=5ab4b71672c9&user=Ashok+Chilakapati&userId=cc37b40eae29&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}