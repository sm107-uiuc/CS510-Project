{"url": "https://towardsdatascience.com/feature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c", "time": 1683000351.540448, "path": "towardsdatascience.com/feature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c/", "webpage": {"metadata": {"title": "Feature Engineering- Translating the dataset to a machine ready format | by Pritha Saha | Towards Data Science", "h1": "Feature Engineering- Translating the dataset to a machine ready format", "description": "This step makes your data ready to be finally trained. The approach to feature engineering is based on a good understanding of the data, as mentioned in my earlier article on EDA. I\u2019ll continue with\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/exploratory-data-analysis-unravelling-a-story-with-data-b01d70069035", "anchor_text": "EDA", "paragraph_index": 0}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFECV.html", "anchor_text": "RFECV", "paragraph_index": 23}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-unravelling-a-story-with-data-b01d70069035", "anchor_text": "EDA", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-unravelling-a-story-with-data-b01d70069035", "anchor_text": "EDA", "paragraph_index": 29}], "all_paragraphs": ["This step makes your data ready to be finally trained. The approach to feature engineering is based on a good understanding of the data, as mentioned in my earlier article on EDA. I\u2019ll continue with the Housing Dataset on Kaggle (used to explain EDA in the previous article), to illustrate how I feature engineered it.", "Both test and train datasets are merged to start with feature engineering. I followed the below steps to derive the final dataset:", "In the last article, I illustrated how outliers can be identified. The first step would be to remove all the indexes with outliers, because outliers tend to convey skewed information about the dataset to a machine.", "Secondly, categorical variables need to be converted to numerical ones, because most machine learning algorithms can only read numerical values.", "Note that some of the categorical variables like Alley, GarageQual, BsmtQual have some values missing and others populated by values like \u201cPo\u201d, \u201cGd\u201d, \u201dTA\u201d and so on. The data description file helps to decipher the meanings of these variables. In this case a missing data just means that the house probably does not have an alley, garage or basement. Hence I used the below code to impute missing values as well as turn existing values to numerical ones:", "This is possible only because the values assigned are like rank variables, for example \u201cFa\u201d is better than \u201cPo\u201d and \u201cTA\u201d is better than \u201cFa\u201d.", "But for those categorical variables where the values do not indicate rank, get_dummies function of pandas transforms the rows to columns.", "But before that it is important to impute missing values of all the categorical variables. For instance, MiscFeature and MasVnrType have missing values, which probably indicate that they are not present. There\u2019s an easy way to cross check this. If MiscVal and MasVnrArea are zero corresponding to the missing values, the assumption is correct and can be imputed as follows:", "For other features like KitchenQual or SaleType, it is safer to impute them with mode of the values.", "Missing values among numerical features can be imputed by putting a zero, depending on the feature. For example missing value in GarageCars column might indicate there is no garage at all, hence zero is the most suitable value.", "GarageYrBlt also has missing values, which I imputed with zero since its not possible to guess the missing year!", "There are 5 time variables in the dataset. Converting them to age variables seem more meaningful, as they offer more information about the longevity of the feature. It is analogous to the fact that, the statement \u201cMr. X died at the age of 66 years\u201d holds more information for us than the statement \u201cMr. X died in the year 2019\u201d. Hence three age features are introduced:", "The \u2018AgeGarage\u2019 column seems to have few values which are around 2000! This is because missing values of GarageYrBlt were imputed with zero as mentioned in the earlier section. All these anomalous values are replaced with the max possible value below a certain threshold as per the below code:", "Negative values, if any, should be replaced with zero and original time features can now be dropped.", "The categorical features can now be converted into dummy columns with the sample code:", "The prefix argument helps to identify the columns later. We need to keep only k-1 columns out of the k columns, hence drop_first is set to True. To understand more about the arguments read here.", "The dummies dataset is concatenated with the original dataset and the actual column is dropped.", "The dataset is almost built, but just not yet.", "The complete dataset now has 209 columns! It is too much data for a machine to digest. More number of features leads to more noise and could eventually lead to overfitting.", "The question is how does one decide which feature to drop? Luckily XGBoost has an answer.", "The combined dataset is sliced to get the training set and xgboost object is fitted on the same.", "Then the feature importances are calculated and sorted:", "The result is something like this:", "There are a lot of features with zero importance. To ascertain how many features should be kept exactly, I used a function called RFECV.", "RFECV tells us exactly how many and which features should be retained. It has a scoring argument, for which I used RMSE(root mean squared error), since the Kaggle exercise will also evaluate on the same terms. The following function defines rmse and also makes it a scorer:", "Since the objective is to reduce RMSE, the \u201cgreater_is_better\u201d argument is set to False. Finally RFECV is fitted on the X and y datasets and gives us the optimal number of features as 67!", "Plotting features vs cross validation scores gives us the below graph:", "After, about 67 features, there\u2019s almost no improvement in the cross validation score. The next step here is to check which columns are suggested by the function.", "There are some features here, which should not have been here as per our analysis in EDA. For instance, we had deduced that Pool Area is not a significant feature for predicting Sale Price.", "Secondly, there are some variables correlated with each other. Hence it would make sense to keep only one of them. On running the command (refer to last article on EDA):", "Hence GarageArea, 1stFlrSF can probably be dropped and we are down to 64 features.", "The conclusion here is that one should not go blindly by the results of any function. We should be asking ourselves every moment, if this makes sense. Hence it is said that achieving a high accuracy with machine learning is not just a science, it\u2019s an art. Feature engineering is often an iterative process and one might want to modify the dataset further to achieve a higher accuracy while implementing the model.", "I went ahead with this dataset and trained with different algorithms, which I will cover in my next blog.", "Suggestions to further improve on feature engineering are always welcome!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I love working with data and have been recently indulging myself in the field of data science."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf4788d15d6c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@prithasaha_62327?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prithasaha_62327?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": "Pritha Saha"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F17eb7a22d9d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&user=Pritha+Saha&userId=17eb7a22d9d7&source=post_page-17eb7a22d9d7----af4788d15d6c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf4788d15d6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf4788d15d6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-unravelling-a-story-with-data-b01d70069035", "anchor_text": "EDA"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFECV.html", "anchor_text": "RFECV"}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-unravelling-a-story-with-data-b01d70069035", "anchor_text": "EDA"}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-unravelling-a-story-with-data-b01d70069035", "anchor_text": "EDA"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----af4788d15d6c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----af4788d15d6c---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/data-science?source=post_page-----af4788d15d6c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/housing-prices?source=post_page-----af4788d15d6c---------------housing_prices-----------------", "anchor_text": "Housing Prices"}, {"url": "https://medium.com/tag/features?source=post_page-----af4788d15d6c---------------features-----------------", "anchor_text": "Features"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf4788d15d6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&user=Pritha+Saha&userId=17eb7a22d9d7&source=-----af4788d15d6c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf4788d15d6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&user=Pritha+Saha&userId=17eb7a22d9d7&source=-----af4788d15d6c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf4788d15d6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faf4788d15d6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----af4788d15d6c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----af4788d15d6c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----af4788d15d6c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----af4788d15d6c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----af4788d15d6c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prithasaha_62327?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prithasaha_62327?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pritha Saha"}, {"url": "https://medium.com/@prithasaha_62327/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "194 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F17eb7a22d9d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&user=Pritha+Saha&userId=17eb7a22d9d7&source=post_page-17eb7a22d9d7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdf6be7020fc4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-engineering-translating-the-dataset-to-a-machine-ready-format-af4788d15d6c&newsletterV3=17eb7a22d9d7&newsletterV3Id=df6be7020fc4&user=Pritha+Saha&userId=17eb7a22d9d7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}