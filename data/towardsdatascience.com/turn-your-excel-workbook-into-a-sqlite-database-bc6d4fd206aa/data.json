{"url": "https://towardsdatascience.com/turn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa", "time": 1683007593.8568242, "path": "towardsdatascience.com/turn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa/", "webpage": {"metadata": {"title": "Turn Your Excel Workbook Into a SQLite Database | by Scott A. Adams | Towards Data Science", "h1": "Turn Your Excel Workbook Into a SQLite Database", "description": "A relational database is a collection of data tables \u2014 sets of rows and columns that store individual pieces of data \u2014 that can be connected to each other. In this way, a relational database is not\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Relational_database", "anchor_text": "relational database", "paragraph_index": 0}, {"url": "https://data.world/scottadams26/superstoresalesexample", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.sqlite.org/index.html", "anchor_text": "SQLite", "paragraph_index": 7}, {"url": "https://docs.python.org/2/library/sqlite3.html#cursor-objects", "anchor_text": "cursor", "paragraph_index": 8}, {"url": "https://www.sqlite.org/datatype3.html", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://www.w3schools.com/sql/sql_join.asp", "anchor_text": "joined", "paragraph_index": 15}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_sql.html", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://sqlite.org/cli.html", "anchor_text": "SQLite command line shell", "paragraph_index": 19}, {"url": "https://www.dbvis.com/", "anchor_text": "DbVisualizer", "paragraph_index": 19}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_sql.html", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://en.wikipedia.org/wiki/Database_normalization", "anchor_text": "normalization", "paragraph_index": 22}, {"url": "https://www.linkedin.com/in/scott-adams-phd/", "anchor_text": "https://www.linkedin.com/in/scott-adams-phd/", "paragraph_index": 25}], "all_paragraphs": ["A relational database is a collection of data tables \u2014 sets of rows and columns that store individual pieces of data \u2014 that can be connected to each other. In this way, a relational database is not totally dissimilar from an Excel workbook with related datasets stored across multiple worksheets. With that thought in mind, this post moves through an example using Python to transform an Excel spreadsheet into a database that can be queried using Structured Query Language (SQL).", "The example in this post uses data from the Superstore-Sales dataset, which can be found here. This dataset is stored as an Excel workbook and contains example sales transaction data stored across the following four sheets: sales, orders, customers, and products.", "First, if you have not installed the xlrd package using condaor pip, do so before starting a Python session, or else you will encounter the following error when trying to read in the Excel file (even with pandas installed).", "Now let\u2019s start a Python session and import pandas and sqlite3 using import pandas and import sqlite3. We will read the data from each Excel spreadsheet into a separate pandas data frame using read_excel, as shown in the code below.", "In each code chunk, the first parameter in read_excel identifies the name of the file to be processed. If necessary, include the path in which the file resides. For example, when I ran this code my data was stored in the data directory, but my working directory was one directory up. The second parameter, sheet_name = , specifies the name of the spreadsheet in the workbook to be processed. The last parameter, header=0, tells Python that the first row in the spreadsheet being read contains the column headers. Remember that Python is zero-indexed, which is why we use0 and not 1 to identify the first row. By explicitly identifying the header row, the values in the first row of each spreadsheet will be treated as the column names for its respective data frame.", "Let\u2019s take a look at the first few rows of each data frame just to make sure everything looks correct.", "Great! Now let\u2019s make that database.", "There are multiple relational database products available and the specific product we will use here is SQLite. This is a lightweight SQL database engine that can be used to create databases stored as files on one\u2019s personal computer. We can initiate a new SQLite database connection object and assign this object to a variable. Below, I named this variable db_conn.", "When this code above is executed, a new file named superstore.db will be created in the data directory (assuming superstore.db does not already exist in this directory). The newly created superstore.db file is an empty SQLite database at this point (i.e., it has no tables).db_conn is also pointing to the superstore.db database and can be thought of as an interface for working with this database. Cool! But wait\u2026how do we actually run the SQL code that will create the data tables? Glad you asked. We now need to establish a cursor object, which is a tool that executes SQL code against the database of interest. Here, the cursor is assigned to a variable I named c.", "The next step is to create the tables that will be included in the database, though it is important to emphasize that this next step of creating the tables will result in empty tables. Later on, we will populate our tables with the data from the four previously-created data frames. Before we move further, however, let\u2019s take a look at the actual SQL code that will be used to create the sales table to better understand the table creation process.", "Line #1 in the code above provides a command to create a table named sales and lines #2\u20138 create 7 new columns in sales: SalesID, OrderID, ProductID, Sales, Quantity, Discount, and Profit. The data type for each column is specified to the right of the respective column name. More information on SQLite datatypes can be found here. Note that the order the columns matches the order of the columns from the associated data frame.", "The ordering of the columns in the CREATE TABLE statement is intentional as this ensures that the appropriate values from the data frame go to the intended column in the database table. For example, had I made OrderID the first column and SalesID the second, SalesID values would be written to the OrderID column in the sales table and the SalesID column in this table would contain OrderID values.", "Line #9 establishes the table\u2019s primary key, which is a column that contains values that uniquely identify each row. In the sales table, SalesID satisfies the requirements for a primary key because no two rows have the same SalesID value.", "Line #10 in the previous set of code establishes the first of two foreign keys for sales. A foreign key is a column in one table that is the primary key in another table. For instance, notice that different rows can share the same OrderID value in the sales table, which disqualifies OrderID from being the primary key in this table. However, in the orders table each row does contain a unique OrderID value. As such, OrderID can serve as the primary key for orders.", "Let\u2019s return to the actual code in line #10 in the previous CREATE TABLE statement. The first part of this code,FOREIGN KEY(OrderID), establishes that the OrderID column in sales is a foreign key. The second part, REFERENCE orders(OrderID) then specifies the table and primary key to which OrderID refers. Line #11 from the CREATE TABLE statement follows the same logic for the ProductID column.", "By specifying the primary and foreign keys, we are able to create a \u201cmap\u201d that shows how the tables in the database relate to each other. For example, someone who is familiar with SQL concepts but unfamiliar with this particular data could take a look at the CREATE TABLE statement that creates the sales table and recognize that data from the sales and orders tables can be brought together, or joined, by matching on values in the OrderID columns from both tables. To briefly illustrate how joining works, consider how we can add OrderDate to the sales table by \u201cjoining\u201d on OrderID, as illustrated below.", "With a basic overview of the table creation process established, let\u2019s create all the database tables. This is where we get to put the cursor, c to work. We can run c.execute() and include the desired SQL code as a string in the parentheses to run said SQL code against the database to which we are currently connected (i.e., data/superstore.db).", "It is now time to populate the tables in the database with the relevant data from the four data frames we previously created. Fortunately, this step can be accomplished with ease using pandas\u2019 to_sql on each data frame (see more details on to_sql here). The code in the block below transfers the data from each of the four data frames into the appropriate tables in the database.", "The first parameter in each line of code above identifies the name of the database table to which the values from the data frame will be written and the following parameter specifies the actual database connection. Next, if_exists='append' tells to_sql that if the table already exists, which it does in this case, then the values from the data frame should be inserted into the table. Lastly, with index=False we tell to_sql not to include the index as an additional column in the table.", "Now we have a SQLite database that is ready to go! You can query the superstore.db database file with the SQLite command line shell or other database software that supports SQLite, such as DbVisualizer. You can also run queries on the database using read_sql from pandas (see more information here). For instance, if we want to see the first five rows from sales we could run the code shown below in our Python shell or notebook.", "When you are finished working on this database in Python you can close the connection by running db_conn.close(). If you want to work with this database again after closing, just reestablish the database connection", "and run queries using read_sql. No need to establish a new cursor if you are not writing data to the database.", "One parting word of clarification before we close. At the start of this post, I mentioned that the structure of an Excel workbook is similar to a SQL database in that both can be comprised of multiple related tables. To that end, this exercise is intended to demonstrate how an Excel workbook can easily be turned into a SQLite database file. Nonetheless, we just scratched the surface of database design and I want to stress that a well-designed database is more than just a collection of tables. Indeed, the process of normalization, which aims to remove data redundancies and promote data integrity, is very important in relational database design. Be aware that the database that we created could be normalized further. If you are interested in learning more about relational databases and the rationale behind storing data across multiple tables I do recommend reading more about normalization.", "Alright, that will do it for this post. Thanks for reading and please reach out if you have any questions and/or constructive feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data sense-maker, friend of cats, fan of corny jokes. https://www.linkedin.com/in/scott-adams-phd/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbc6d4fd206aa&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://scottadams26.medium.com/?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": ""}, {"url": "https://scottadams26.medium.com/?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": "Scott A. Adams"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd8312f4f39d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&user=Scott+A.+Adams&userId=d8312f4f39d7&source=post_page-d8312f4f39d7----bc6d4fd206aa---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbc6d4fd206aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbc6d4fd206aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jankolar?utm_source=medium&utm_medium=referral", "anchor_text": "Twitter: @jankolario"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Relational_database", "anchor_text": "relational database"}, {"url": "https://data.world/scottadams26/superstoresalesexample", "anchor_text": "here"}, {"url": "https://www.sqlite.org/index.html", "anchor_text": "SQLite"}, {"url": "https://docs.python.org/2/library/sqlite3.html#cursor-objects", "anchor_text": "cursor"}, {"url": "https://www.sqlite.org/datatype3.html", "anchor_text": "here"}, {"url": "https://www.w3schools.com/sql/sql_join.asp", "anchor_text": "joined"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_sql.html", "anchor_text": "here"}, {"url": "https://sqlite.org/cli.html", "anchor_text": "SQLite command line shell"}, {"url": "https://www.dbvis.com/", "anchor_text": "DbVisualizer"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_sql.html", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Database_normalization", "anchor_text": "normalization"}, {"url": "https://medium.com/tag/sqlite?source=post_page-----bc6d4fd206aa---------------sqlite-----------------", "anchor_text": "Sqlite"}, {"url": "https://medium.com/tag/python?source=post_page-----bc6d4fd206aa---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/database?source=post_page-----bc6d4fd206aa---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/tag/pandas?source=post_page-----bc6d4fd206aa---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/excel?source=post_page-----bc6d4fd206aa---------------excel-----------------", "anchor_text": "Excel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbc6d4fd206aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&user=Scott+A.+Adams&userId=d8312f4f39d7&source=-----bc6d4fd206aa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbc6d4fd206aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&user=Scott+A.+Adams&userId=d8312f4f39d7&source=-----bc6d4fd206aa---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbc6d4fd206aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbc6d4fd206aa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bc6d4fd206aa---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bc6d4fd206aa--------------------------------", "anchor_text": ""}, {"url": "https://scottadams26.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://scottadams26.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Scott A. Adams"}, {"url": "https://scottadams26.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "100 Followers"}, {"url": "https://www.linkedin.com/in/scott-adams-phd/", "anchor_text": "https://www.linkedin.com/in/scott-adams-phd/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd8312f4f39d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&user=Scott+A.+Adams&userId=d8312f4f39d7&source=post_page-d8312f4f39d7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff254a9f5cfd7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fturn-your-excel-workbook-into-a-sqlite-database-bc6d4fd206aa&newsletterV3=d8312f4f39d7&newsletterV3Id=f254a9f5cfd7&user=Scott+A.+Adams&userId=d8312f4f39d7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}