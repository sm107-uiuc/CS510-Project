{"url": "https://towardsdatascience.com/creating-a-japanese-handwriting-recognizer-70be12732889", "time": 1683012710.8072379, "path": "towardsdatascience.com/creating-a-japanese-handwriting-recognizer-70be12732889/", "webpage": {"metadata": {"title": "Creating a Japanese Handwriting Recognizer | by Aiyu Kamate | Towards Data Science", "h1": "Creating a Japanese Handwriting Recognizer", "description": "Find out how I created a handwriting recognition from scratch! Explore Machine learning, Tensorflow, Keras, and Image Recognition of Japanese Characters."}, "outgoing_paragraph_urls": [{"url": "https://github.com/Nippon2019/Handwritten-Japanese-Recognition/blob/master/Katakana/katakanajapanese.py", "anchor_text": "here", "paragraph_index": 26}, {"url": "http://etlcdb.db.aist.go.jp/", "anchor_text": "ETL Character Database", "paragraph_index": 37}, {"url": "https://github.com/rois-codh/kmnist", "anchor_text": "KMNIST", "paragraph_index": 38}], "all_paragraphs": ["This summer, I worked on a machine learning project to create an App that recognizes Japanese characters, using python\u2019s tensorflow library.", "Before we get started, here\u2019s the final result!", "We will need to install a couple libraries. Here are the versions I used:", "If you don\u2019t know how to install the libraries, type this in your terminal:", "Note that if tensorflow doesn\u2019t work after installation, try running the following command in terminal:", "Change the 3.7 to the python version you\u2019re using if you are using a different version.", "There are two main machine learning problems: Classification problem, and Regression problem. The main difference between the two is that a Classification problem have categorical answers, while a Regression problem has continuous values as its answers. An example of a classification problem would be predicting whether an image is a cat or a dog, while an example of a regression problem would be predicting prices of houses.", "Handwriting Recognition is a Classification problem.", "Here\u2019s what you should do to create a machine learning model that can recognize handwriting, or any other Classification Problems in general:", "I used the ETL Character Database, which had over ten thousands of Japanese characters written by different people, and the KMNIST database, which had old Japanese characters. Here are the 5 types of machine learning models I created:", "To explain briefly, Kanji are Chinese characters that were adopted in Japanese, while Hiragana and Katakana are the syllabic scripts (essentially the Japanese alphabets); Hiragana is the main alphabet, and each Hiragana has a corresponding Katakana, but Katakana are used for foreign words. Kuzushiji is the old Japanese Hiragana, but much more complex.", "After downloading the ETL 1 and 8 dataset, I had to extract the data to fit my tensorflow model. Here\u2019s how exactly I manipulated the Katakana dataset:", "After this, I reshaped each image size to 48*48 pixels, created the labels for each characters, and split the images and labels to train images, train labels, test images, and test labels. Here\u2019s my code:", "I did the same thing for Hiragana and Kanji with some minor changes (e.g. number of characters and writers, image sizes, the way the read the original file, the duplicate characters are slightly different), so I won\u2019t go into detail here. Check out my github page to see the exact code!", "KMNIST already provided each of training images, training labels, testing images, and testing labels, so no extra steps are necessary here.", "A very helpful tool to visualize your data is matplotlib.pyplot; this helps a lot with debugging, because you can see if all the data were extracted/formatted correctly. Here\u2019s an example:", "Finally, the fun part: training the model!", "We will be using a Convolutional Neural Network (CNN). CNN consists of the process of convolution and pooling, and essentially keeps the important parts of an image so that the model can make a better prediction.", "We will also be using ImageDataGenerator in tensorflow.keras, which is a technique of image data augmentation that creates modified versions of images, such as rotated, zoomed, and flipped versions, to train so that the model doesn\u2019t overfit (recognizes training examples well but doesn\u2019t understand different kind of outside data).", "After adding/removing layers and tweaking the exact numbers in each layers, I was able to create a pretty good model for all characters. To be exact,", "Here are the exact CNN model I used for each Japanese Characters:", "To show an example, I\u2019ll show the exact code for my Katakana model. The model I created for the other characters can be seen in my github page.", "Once you have your h5 file, you can load it by keras.models.load_model(\"your_model_name.h5\"), see your model by model.summary() , and test the accuracy on test data by model.evaluate(test_images,test_labels).", "Before creating the app, we need use coremltools to convert the .h5 format to .mlmodel format to be able to use the models in the app. Here, we need to downgrade keras 2.4.3 to 2.2.4, because coremltools only supports keras 2.2.4 or older versions.", "keras 2.2.4 also have some issues with tensorflow 2, so I had to run the following command to upgrade a keras file:", "I also had to go into the optimizers.py file within keras and manually change this in line 75:", "The katakanajapanese file can be found here.", "input_names=\"image\" changes the input from an array to an image. Very important step because on XCode, handling image is much easier.", "As always, the code for the other Japanese characters can be seen here:", "Finally, let\u2019s get into actually making the app for iOS!", "The exact implementation can be seen here:", "The code here makes the most basic app for recognizing handwritten Japanese!", "You can add features by providing second and third choice characters and enabling switching modes between Hiragana, Katakana, and Kanji, for example.", "Though the codes of the models themselves are actually short, creating the best models was definitely the most time consuming part of the project.", "The results were rewarding; about 98~99% accuracy for all characters, especially for Kanji, is good!", "In future machine learning projects, I\u2019d like to work on larger and more complicated dataset and achieve higher accuracy, and also try Regression problems.", "Perhaps I could try to predict the number of gold medals Japan would win at Tokyo Olympics next year!", "[1] Electrotechnical Laboratory, Japanese Technical Committee for Optical Character Recognition, ETL Character Database, 1973\u20131984.", "[2] Tarin Clanuwat and Mikel Bober-Irizar and Asanobu Kitamoto and Alex Lamb and Kazuaki Yamamoto and David Ha, Deep Learning for Classical Japanese Literature, KMNIST, 2018/12/3", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F70be12732889&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----70be12732889--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70be12732889--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aiyukamate?source=post_page-----70be12732889--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aiyukamate?source=post_page-----70be12732889--------------------------------", "anchor_text": "Aiyu Kamate"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7c00c8ee00a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&user=Aiyu+Kamate&userId=b7c00c8ee00a&source=post_page-b7c00c8ee00a----70be12732889---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://unsplash.com/@clemhlrdt?utm_source=medium&utm_medium=referral", "anchor_text": "Cl\u00e9ment H"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://tensorflow.org", "anchor_text": "TensorFlow"}, {"url": "https://unsplash.com/@glenncarstenspeters?utm_source=medium&utm_medium=referral", "anchor_text": "Glenn Carstens-Peters"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/Nippon2019/Handwritten-Japanese-Recognition", "anchor_text": "Nippon2019/Handwritten-Japanese-RecognitionCreate a model that recognizing handwritten Japanese characters, including Hiragana, Katakana, Kanji, and Kuzushiji\u2026github.com"}, {"url": "https://github.com/rois-codh/kmnist", "anchor_text": "KMNIST Dataset"}, {"url": "https://github.com/Nippon2019/Handwritten-Japanese-Recognition", "anchor_text": "Nippon2019/Handwritten-Japanese-RecognitionCreate a model that recognizing handwritten Japanese characters, including Hiragana, Katakana, Kanji, and Kuzushiji\u2026github.com"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://github.com/Nippon2019/Handwritten-Japanese-Recognition/blob/master/Katakana/katakanajapanese.py", "anchor_text": "here"}, {"url": "https://github.com/Nippon2019/Handwritten-Japanese-Recognition", "anchor_text": "Nippon2019/Handwritten-Japanese-RecognitionCreate a model that recognizing handwritten Japanese characters, including Hiragana, Katakana, Kanji, and Kuzushiji\u2026github.com"}, {"url": "https://unsplash.com/@iamdavid_10?utm_source=medium&utm_medium=referral", "anchor_text": "David \u0160vihovec"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@bt_optics?utm_source=medium&utm_medium=referral", "anchor_text": "Bryan Turner"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://etlcdb.db.aist.go.jp/", "anchor_text": "ETL Character Database"}, {"url": "https://github.com/rois-codh/kmnist", "anchor_text": "KMNIST"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----70be12732889---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----70be12732889---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/image-recognition?source=post_page-----70be12732889---------------image_recognition-----------------", "anchor_text": "Image Recognition"}, {"url": "https://medium.com/tag/swift-programming?source=post_page-----70be12732889---------------swift_programming-----------------", "anchor_text": "Swift Programming"}, {"url": "https://medium.com/tag/handwriting-recognition?source=post_page-----70be12732889---------------handwriting_recognition-----------------", "anchor_text": "Handwriting Recognition"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70be12732889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&user=Aiyu+Kamate&userId=b7c00c8ee00a&source=-----70be12732889---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F70be12732889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&user=Aiyu+Kamate&userId=b7c00c8ee00a&source=-----70be12732889---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----70be12732889--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F70be12732889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----70be12732889---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----70be12732889--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----70be12732889--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----70be12732889--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----70be12732889--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----70be12732889--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----70be12732889--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----70be12732889--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----70be12732889--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aiyukamate?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aiyukamate?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aiyu Kamate"}, {"url": "https://medium.com/@aiyukamate/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "10 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7c00c8ee00a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&user=Aiyu+Kamate&userId=b7c00c8ee00a&source=post_page-b7c00c8ee00a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd957b3f78bbb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-japanese-handwriting-recognizer-70be12732889&newsletterV3=b7c00c8ee00a&newsletterV3Id=d957b3f78bbb&user=Aiyu+Kamate&userId=b7c00c8ee00a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}