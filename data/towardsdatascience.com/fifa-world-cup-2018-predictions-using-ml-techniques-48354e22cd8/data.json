{"url": "https://towardsdatascience.com/fifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8", "time": 1682993512.084975, "path": "towardsdatascience.com/fifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8/", "webpage": {"metadata": {"title": "FIFA World Cup 2018 Predictions using ML techniques | by Tan Hao Hao | Towards Data Science", "h1": "FIFA World Cup 2018 Predictions using ML techniques", "description": "But it seems like a lot of my friends, including both my linear regressor and neural network model, favours Brazil. I am in the midst of self-learning machine learning models for the summer holidays\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/abecklas/fifa-world-cup", "anchor_text": "Kaggle\u2019s dataset", "paragraph_index": 4}, {"url": "https://www.kaggle.com/martj42/international-football-results-from-1872-to-2017/data", "anchor_text": "this dataset", "paragraph_index": 5}, {"url": "https://blog.goodaudience.com/predicting-fifa-world-cup-2018-using-machine-learning-dc07ad8dd576", "anchor_text": "this Medium article", "paragraph_index": 5}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas", "paragraph_index": 16}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-results-preprocess.py", "anchor_text": "fifa-results-preprocess.py", "paragraph_index": 16}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-ml.py", "anchor_text": "fifa-ml.py", "paragraph_index": 21}, {"url": "http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelBinarizer.html", "anchor_text": "LabelBinarizer", "paragraph_index": 23}, {"url": "https://keras.io/utils/#to_categorical", "anchor_text": "to_categorical()", "paragraph_index": 23}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/results_predict_output_final.csv", "anchor_text": "results_predict_output_final.csv", "paragraph_index": 26}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-ml-nn.py", "anchor_text": "fifa-ml-nn.py", "paragraph_index": 27}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/results_predict_output_nn_final.csv", "anchor_text": "results_predict_output_nn_final.csv", "paragraph_index": 31}, {"url": "https://www.linkedin.com/feed/update/urn:li:activity:6417784109510254592/", "anchor_text": "this LinkedIn post", "paragraph_index": 33}, {"url": "https://arxiv.org/pdf/1806.03208.pdf", "anchor_text": "this paper", "paragraph_index": 33}], "all_paragraphs": ["My predictions? Belgium will be the champion.", "But it seems like a lot of my friends, including both my linear regressor and neural network model, favours Brazil.", "I am in the midst of self-learning machine learning models for the summer holidays, and FIFA World Cup is right under our foot now! So I am thinking: why not do a small hands-on project on predicting the world cup results using ML models?", "And my 3-day-long journey for the prediction task begins!", "The dataset that actually sparked my interest on starting up this project is actually this Kaggle\u2019s dataset (well, it just appeared in my email if you subscribed to Kaggle). This dataset contains all matches, players and titles won for FIFA World Cup since 1930. I even got inspired to build a model with an attribute on which player is playing for the match, since the players contribute significantly to the victory of the game, and we have access to this piece of information in this dataset.", "But in the end, I personally feel that this dataset is too messy and it was packed with too much unnecessary data. Then I came across this dataset which has information on all international football matches. It was referred in this Medium article that also talks about ML result predictions, though, the model in the article used a logistic regressor. I personally prefer this dataset, because:", "Basically, the dataset contains the year and the date of a match, name of two teams, both teams\u2019 scoring, tournament type, city, country, and neutrality of the match (whether the match is held in either one team\u2019s own location). So I would say this dataset is relatively cleaner, concise, and straight-to-the-point.", "One big lesson that I learnt from this part is that data would always be messy and dirty. I come out with an analogy that compares data science to cooking \u2014 first things first, data is like your meat and vegetables. Pick the ones that are fresh, clean, and suits you the most.", "And just like a chef that doesn\u2019t really need to use cool techniques to smoke-grill or liquid nitrogen his food, as his main goal is to serve good food to his eaters even using simple ways. It is similar for a data scientist \u2014 we don\u2019t really need to build a very fancy, complicated ML model (unless required for complicated tasks), but the main aim is to be able to tell things from the data you picked.", "The key is how you tell things \u2014 in this case, which attributes are you choosing.", "So these are the attributes that I come up with, which are pretty basic and easy-to-understand:", "During prediction, we should take the ranking of the team in the year the match is held. If data is not available, my way to deal with it is to put a large number (I used 200, since there are less than 200 teams) as the rank.", "The mean of winning and drawing matches of a team in all her international appearances. Losing counts are not needed since it is just the complement of the two.", "The goal difference mean of a team in all her international appearances. eg. if team A and team B played a match with score 5\u20130, then the goal difference for team A is 5, and for team B is -5. This measures not just winning, but to what extend the team can win a game.", "Basically the match history for the two teams in the match. Note that we should beware of the date of the match, and only take the match history data in the past into account.", "To see if one team is playing in its own country.", "This is also a chance for me to practise on pandas, a very convenient library on data manipulation. So the first script I write is fifa-results-preprocess.py, mainly to generate the attributes that I want from raw data in results.csv.", "One thing to share is that \u2014 the script runs for around 18 minutes! The reason is that for each row of match data, we have to compute the match history for the two teams. For that computation, we need to traverse all rows before that particular row since our data is arranged in chronological order. This obviously takes O(n\u00b2).", "The pre-process generates results_processed.csv, which I drop some columns manually to get results_processed_dev.csv.", "With your garlic and onions chopped, and your beef sliced, you are ready to cook your dish chef!", "So basically, this prediction task can be framed as a classification task. Given the attributes, we are classifying if the home team shall lose (class 0), win (class 1), or draw (class 2).", "I first tried feeding my data into several types of classifiers using my script fifa-ml.py. And shockingly, all classifiers return both training and testing accuracies at around 55%, and no single classifier outperforms the other.", "So, I rather use a linear regressor in the end, since it makes not much difference. The linear regressor can be thought as a 1-layer neural network, taking in n features and eventually returning the probability for each logits. In this case, it returns the winning, losing and drawing probability for the home team in the match. You can also use a logistic regressor, just that in my opinion in this particular task, both does the same thing.", "Beware that for linear regressor, all Y examples need to be one-hot-encoded. In sklearn, I do it by using a LabelBinarizer; in Keras, I do it by to_categorical().", "And I did it! I attached the predictions for the knockout rounds here:", "So the top 4 teams are: Brazil, Spain, Argentina, Germany.", "For full results (including group stage results and probabilities), check it out here: results_predict_output_final.csv.", "Then I am wondering: since classic classifiers can\u2019t do a good job, will neural networks perform better? And so I came up with a neural network script using Keras: fifa-ml-nn.py.", "Even for large networks with a lot of hidden units, it seems like the accuracy just slowly converges to, similarly, around 55% (sometimes slightly higher, and NN is my only model that hits test accuracy of 59%, which is highest for now). But I am having dense layers with 300, 500, and even 1024 units but to only spike up the performance by less than 5%. It is not worth it.", "Still, there are slight difference between NN\u2019s prediction and LR\u2019s prediction. Let me attach the knockout stage predictions by NN here:", "So the top 4 teams this time are: Brazil, Spain, Germany, Portugal.", "For full results (including group stage results and probabilities), check it out here: results_predict_output_nn_final.csv.", "This is quite a good introductory data science mini-project, I would say, to go through the whole process on data un-wrangling, coming up with classification attributes, and implementing a classification model.", "My conclusion will be that football matches stays unpredictable, and I totally agree with this LinkedIn post when I read about it. The post even attached this paper for prediction using random forest and incorporating large number of attributes, but still unable to make accurate prediction.", "Not everything can be predicted using ML. It has its limitations.", "For my model, I can only say that teams like Brazil, Spain and Germany are in favour of the attributes that I have set, which mainly takes in account of the winning statistics of a team. But we all know that winning history can\u2019t really tell much \u2014 after all, when I am writing this blog post, Germany had been eliminated by the mighty South Korea with a 2\u20130.", "All in all, predictions are not the main priority here. The most important thing is to learn skills in handling data, telling stories from it, and last but not least\u2026support Belgium to the max!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Music enthusiast, seeking music tech solutions with AI / ML."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F48354e22cd8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----48354e22cd8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----48354e22cd8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@helloharry66?source=post_page-----48354e22cd8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@helloharry66?source=post_page-----48354e22cd8--------------------------------", "anchor_text": "Tan Hao Hao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2688ae6ed5f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=post_page-2688ae6ed5f4----48354e22cd8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48354e22cd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48354e22cd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/abecklas/fifa-world-cup", "anchor_text": "Kaggle\u2019s dataset"}, {"url": "https://www.kaggle.com/martj42/international-football-results-from-1872-to-2017/data", "anchor_text": "this dataset"}, {"url": "https://blog.goodaudience.com/predicting-fifa-world-cup-2018-using-machine-learning-dc07ad8dd576", "anchor_text": "this Medium article"}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas"}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-results-preprocess.py", "anchor_text": "fifa-results-preprocess.py"}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-ml.py", "anchor_text": "fifa-ml.py"}, {"url": "http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelBinarizer.html", "anchor_text": "LabelBinarizer"}, {"url": "https://keras.io/utils/#to_categorical", "anchor_text": "to_categorical()"}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/results_predict_output_final.csv", "anchor_text": "results_predict_output_final.csv"}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-ml-nn.py", "anchor_text": "fifa-ml-nn.py"}, {"url": "https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/results_predict_output_nn_final.csv", "anchor_text": "results_predict_output_nn_final.csv"}, {"url": "https://www.linkedin.com/feed/update/urn:li:activity:6417784109510254592/", "anchor_text": "this LinkedIn post"}, {"url": "https://arxiv.org/pdf/1806.03208.pdf", "anchor_text": "this paper"}, {"url": "https://gudgud96.github.io/projects/fifa-18.html", "anchor_text": "gudgud96.github.io"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----48354e22cd8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----48354e22cd8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----48354e22cd8---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/fifa?source=post_page-----48354e22cd8---------------fifa-----------------", "anchor_text": "FIFA"}, {"url": "https://medium.com/tag/data-science?source=post_page-----48354e22cd8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F48354e22cd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=-----48354e22cd8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F48354e22cd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=-----48354e22cd8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48354e22cd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----48354e22cd8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F48354e22cd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----48354e22cd8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----48354e22cd8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----48354e22cd8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----48354e22cd8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----48354e22cd8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----48354e22cd8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----48354e22cd8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----48354e22cd8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----48354e22cd8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@helloharry66?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@helloharry66?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tan Hao Hao"}, {"url": "https://medium.com/@helloharry66/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "22 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2688ae6ed5f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=post_page-2688ae6ed5f4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4773228b6731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8&newsletterV3=2688ae6ed5f4&newsletterV3Id=4773228b6731&user=Tan+Hao+Hao&userId=2688ae6ed5f4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}