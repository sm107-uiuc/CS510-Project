{"url": "https://towardsdatascience.com/linear-regression-model-with-numpy-7d270feaca63", "time": 1683008238.063941, "path": "towardsdatascience.com/linear-regression-model-with-numpy-7d270feaca63/", "webpage": {"metadata": {"title": "ML from Scratch: Linear Regression Model with NumPy | by Aman Sharma | Towards Data Science", "h1": "ML from Scratch: Linear Regression Model with NumPy", "description": "In this project, we will see how to create a machine learning model that uses the Multiple Linear Regression algorithm. The main focus of this project is to explain how linear regression works, and\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In this project, we will see how to create a machine learning model that uses the Multiple Linear Regression algorithm.", "The main focus of this project is to explain how linear regression works, and how you can code a linear regression model from scratch using the awesome NumPy module.", "Of course, you can create a linear regression model using the scikit-learn with just 3\u20134 lines of code, but really, coding your own model from scratch is far more awesome than relying on a library that does everything for you while you sit and watch.", "Not only that, coding a custom model means you have full control over what the model does and how that model deals with the data that you will be feeding it. This allows for more flexibility during the training process, and you can actually tweak the model to make it more robust and responsive to the real world data as required in the future during re-training or in the production.", "In this project, our model will be used to predict the CO\u2082 emissions of a vehicle based on its features such as its engine size, fuel consumption etc.", "Let\u2019s start working on the project.", "First, we will import the necessary PyData modules.", "Now, let us import our data set. The data set contains model-specific fuel consumption ratings and estimated carbon dioxide emissions for new light-duty vehicles for retail sale in Canada.", "Here\u2019s the link for the data set. I will also share the link to the Github repo containing the Jupyter notebook and the dataset at the end of this project.", "Click the link to download the csv file- drive.google.com", "Here\u2019s how it looks in my Jupyter notebook:", "The following are the columns present in our data set.", "One of the most important steps in any data science project is pre-processing the data. This involves cleaning the data, typecasting some columns as required, conversion of categorical variables and standardizing/normalizing the data as per the project requirements.", "For our project, the first step of the pre-processing is going to be checking whether we need to typecast the data type of any feature/target variable.", "As we can see, there\u2019s no need to typecast any column.", "The second step in our data wrangling process is analyzing whether the features need to be standardized or not. For that, let us have a look at the descriptive analysis of the dataframe.", "As we can see, all the potential features are of the same order in terms of scales, so we needn\u2019t standardize any feature.", "For this project, the features we will be choosing are ENGINESIZE, CYLINDERS & FUELCONSUMPTION_COMB and the target variable is CO2EMISSIONS.", "Our next step- Checking the number of NaN(null) values in the dataframe.", "As we can see, there are are no null values in our dataframe. So the data is perfect for training the model.", "First, we will have a look at the correlation of the features and the target variables.", "This table shows a strong positive correlation between the features and the target variable. Remember, a strong correlation is a good thing for a linear regression model.", "Now, let us visualize the plots of different features against the target variable. This will allow us to get an idea whether the features show a linear relation with the target variable or not.", "As we can see, the features show a considerable linear relationship with the target. Hence, we can use them for training the model.", "Linear regression uses the following mathematical formula for prediction of a dependent variable using an independent variable.", "The following is the process for developing a linear regression model.", "First, let\u2019s cast the features to a NumPy array, features.", "Now, let us get cast the target column to a NumPy array, target.", "Since we have 3 dependent variables, we will have 3 weights. Let\u2019s generate array weights of 3 small random weights.", "Since we have a single target variable, we will have just one bias, b. We will also create an array bias equal to the length of features array having bias b for each element.", "Now, we will define our model function that uses weights, biases and dependent variables to calculate \u0177.", "Now, let us run the function once to see the results we\u2019ll get.", "Now, we will define the MSE function to calculate the total loss of our model.", "Let us now calculate the information loss based on the y_hat values we got earlier.", "As we can see, our model is currently massively inaccurate and we need to optimize it.", "Now comes the most important step in the linear regression. Formulating the SGD function. This is a slightly advance topic as compared to all the basic functions we have covered up until this point. It requires some knowledge of differential calculus; partial differentiation to be specific. I have tried to explain this in the image below, however, if you don\u2019t get it, I\u2019d strongly suggest you get familiar with the mathematics portion of Machine Learning (Calculus, Statistics and Probability, Linear Algebra) before proceeding any further.", "Once we have calculated the gradients, we will update the parameters as follows.", "Once we have the new updated values of the weights and biases, we will calculate the loss again. We will repeat the process for n epochs, i.e., number of cycles and plot the loss values after each epoch. To keep the code clean, I will create a separate function for calculation of gradients.", "Now, let us write the SDG function that will return the updated weights and biases so we can formulate our final model.", "Finally, we have the optimizer function for our linear regression model. Let us run the function now and store the values for further use.", "The initial MSE was around 65,000 while the current MSE is around 680. We can see from the results that our model has significantly improved.", "Finally, we will write the model function that uses the updated model weights and biases to predict the target values.", "As a test run, we will now test our model on the following data.", "The actual target value for the data is 196. Let\u2019s see how our model fares.", "The original target value was 196 for the given model. As we can see, our model did a fairly good job at making the prediction, considering this is a model implementation from scratch. You can further improve the model though, by tweaking a few things or maybe running more optimization epochs. However, too much optimization can lead to model overfitting, which is equally bad for the model as overfitting makes the model practically unusable for real world data.", "Now, to check the accuracy of our model, we will calculate its r-squared score. The following is the formula for r2 score-", "As we can see, our model explains around 83% of the variability of the response data around its mean, which is fairly good. However, there is always room for improvement in a Machine Learning model!", "With this, we come to an end for our project.", "I am going to make a series of blogs, where we will be working on similar projects, coding new ML models from scratch, working hands-on with real world datasets and problem statements.", "I am just a novice in the field of Machine Learning and Data Science so any suggestions and criticism will really help me improve.", "Hit that follow and stay tuned for more ML stuff!", "Link to GitHub repo for dataset and Jupyter notebook-", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Programming computers to do the work for me and using data to solve problems are my passion. My machine and I are learning. Connect on Twitter @amansharma2910"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7d270feaca63&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d270feaca63--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d270feaca63--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://amansharma2910.medium.com/?source=post_page-----7d270feaca63--------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=post_page-----7d270feaca63--------------------------------", "anchor_text": "Aman Sharma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84e03a4d7261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&user=Aman+Sharma&userId=84e03a4d7261&source=post_page-84e03a4d7261----7d270feaca63---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d270feaca63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d270feaca63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ridham?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ridham Nagralawala"}, {"url": "https://unsplash.com/s/photos/line?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://drive.google.com/file/d/13UHA0B1velyQh9fk3eBOK4i337J441Ce/view?usp=sharing", "anchor_text": "FuelConsumptionCo2.csvClick the link to download the csv file- drive.google.com"}, {"url": "https://towardsdatascience.com/linear-regression-using-gradient-descent-97a6c8700931", "anchor_text": "Adarsh Menon-Medium.com"}, {"url": "https://github.com/amansharma2910/CO2_emission_predictionML", "anchor_text": "amansharma2910/CO2_emission_predictionMLContribute to amansharma2910/CO2_emission_predictionML development by creating an account on GitHub.github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7d270feaca63---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----7d270feaca63---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7d270feaca63---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python-programming?source=post_page-----7d270feaca63---------------python_programming-----------------", "anchor_text": "Python Programming"}, {"url": "https://medium.com/tag/technology?source=post_page-----7d270feaca63---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d270feaca63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&user=Aman+Sharma&userId=84e03a4d7261&source=-----7d270feaca63---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d270feaca63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&user=Aman+Sharma&userId=84e03a4d7261&source=-----7d270feaca63---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d270feaca63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d270feaca63--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7d270feaca63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7d270feaca63---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d270feaca63--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7d270feaca63--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7d270feaca63--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7d270feaca63--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7d270feaca63--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7d270feaca63--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7d270feaca63--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7d270feaca63--------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aman Sharma"}, {"url": "https://amansharma2910.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "94 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84e03a4d7261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&user=Aman+Sharma&userId=84e03a4d7261&source=post_page-84e03a4d7261--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F186d48c6a7d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-model-with-numpy-7d270feaca63&newsletterV3=84e03a4d7261&newsletterV3Id=186d48c6a7d2&user=Aman+Sharma&userId=84e03a4d7261&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}