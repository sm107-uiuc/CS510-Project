{"url": "https://towardsdatascience.com/machine-learning-how-to-do-the-feature-selection-2de56182cd9b", "time": 1683014908.525594, "path": "towardsdatascience.com/machine-learning-how-to-do-the-feature-selection-2de56182cd9b/", "webpage": {"metadata": {"title": "[Machine Learning] How to do feature selection | by Jay Hui | Towards Data Science", "h1": "[Machine Learning] How to do feature selection", "description": "When I had an interview for a data science-related job, the interviewer asked me the following question. Afterwards, I also asked the same question to the candidate when I was an interviewer: Given a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/kkhuiaa/feature-selection-notebook", "anchor_text": "Kaggle notebook is uploaded here", "paragraph_index": 4}, {"url": "https://www.kaggle.com/c/prudential-life-insurance-assessment", "anchor_text": "prudential life insurance underwriting data", "paragraph_index": 4}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.feature_selection", "anchor_text": "Scikit-learn", "paragraph_index": 5}], "all_paragraphs": ["When I had an interview for a data science-related job, the interviewer asked me the following question. Afterwards, I also asked the same question to the candidate when I was an interviewer: Given a large dataset (more than 1,000 columns with 100,000 rows (records)), how will you select the useful features to build a (supervised) model?", "This is a good question to distinguish your data science knowledge between a student and a professional level. When you are a student, you learn algorithms from a beautiful and cleansed dataset. However, in the business world, data scientists put a lot of effort into data cleansing to build a machine learning model.", "Given a large dataset (more than 1000 columns with 10000 rows (records)), how do you select the useful features to build a (supervised) model?", "In fact, there is no absolute solution to this question but is to test your logical thinking and explanation skill. In this post, I would share a few methodologies (feature selection) to handle it.", "The Kaggle notebook is uploaded here, where the dataset I use is the prudential life insurance underwriting data:", "This task aims to predict the risk level (underwriting) of the life insurance applicant. For more implementation of feature selection, you may check the Scikit-learn article as well.", "Here I am going to do some simple data cleansing. Most machine learning model implementations do not accept string inputs, and hence we have to transform them into numeric values. As our target is is an ordinal target (i.e., supervised learning), transforming the categorical variable by the basic OneHotEncoder suffers from the \u201ccurse of dimensionality\u201d (usually it takes more time in model training as well).", "Instead, what we do for the categorical column is as follows: Based on its categorical value, we calculate the corresponding mean values of the Y target (by \u201cGroupBy\u201d) and rank it from 0 to the number of unique categorical values that column minus 1. Such mapping is available for testing data or production later.", "Then, we fill in the missing value as a standard procedure:", "Suppose you have 200 football players, and you would like to select 11 of them to form the best football team. How would you select them?", "In the analogy of the football player selection, the unsupervised approach evaluates each player's basic information, such as height, BMI, age, and other health markers. These are not football-specific (unsupervised), but most excellent football players should have a good physical foundation.", "A more sophisticated approach is to do it by supervised learning. Back to our analogy of football team selection, we do it in two rounds:", "In the first round, we evaluate the football skills (supervised), such as penalty kick, shooting, short-pass ability, for each player and rank them. Suppose we can select the top 50 players out of the 200 players now.", "In the second round, since we want to find the best combination of 11 players out of the 50 players, we need to evaluate how these 50 players will cooperate. We will finally find the best 11 players. (Why do we not do the second round directly? Running every iteration takes a lot of time, so we need the preliminary test in the first round.)", "Technically speaking, the first round is the \u201cfeature selection by model,\u201d and the second round is \u201cRecursive Feature Elimination\u201d (RFE). Let\u2019s go back to machine learning and coding now.", "We also plot the model importance rankings for each model:", "Since L1-based logistic regression has the highest accuracy, so we will only select the top 60 features (from the graph) by logistic regression:", "As you can see, the validation accuracy will finally saturate (around 0.475) as trained with more features. We can check our feature importance ranking now:", "Again, there is no Golden Rule to perform the feature selection. In the business world with production, we have to balance the hardware capability, required time, stability of the model, and the model performance. After finding the best combination of columns, we can now select the best set of hyper-parameter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2de56182cd9b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jay-hui.medium.com/?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": ""}, {"url": "https://jay-hui.medium.com/?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": "Jay Hui"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102abb901d98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&user=Jay+Hui&userId=102abb901d98&source=post_page-102abb901d98----2de56182cd9b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2de56182cd9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2de56182cd9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/kkhuiaa/feature-selection-notebook", "anchor_text": "Kaggle notebook is uploaded here"}, {"url": "https://www.kaggle.com/c/prudential-life-insurance-assessment", "anchor_text": "prudential life insurance underwriting data"}, {"url": "https://www.kaggle.com/kkhuiaa/feature-selection-notebook", "anchor_text": "feature selection notebookExplore and run machine learning code with Kaggle Notebooks | Using data from Prudential Life Insurance Assessmentwww.kaggle.com"}, {"url": "https://scikit-learn.org/stable/modules/classes.html#module-sklearn.feature_selection", "anchor_text": "Scikit-learn"}, {"url": "https://buffer.com/library/free-images/", "anchor_text": "unsplash photo, uploaded by Alora Griffiths"}, {"url": "https://stackabuse.com/implementing-pca-in-python-with-scikit-learn/", "anchor_text": "this article"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2de56182cd9b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----2de56182cd9b---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/supervised-learning?source=post_page-----2de56182cd9b---------------supervised_learning-----------------", "anchor_text": "Supervised Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2de56182cd9b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2de56182cd9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&user=Jay+Hui&userId=102abb901d98&source=-----2de56182cd9b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2de56182cd9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&user=Jay+Hui&userId=102abb901d98&source=-----2de56182cd9b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2de56182cd9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2de56182cd9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2de56182cd9b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2de56182cd9b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2de56182cd9b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2de56182cd9b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2de56182cd9b--------------------------------", "anchor_text": ""}, {"url": "https://jay-hui.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jay-hui.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jay Hui"}, {"url": "https://jay-hui.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "137 Followers"}, {"url": "https://www.linkedin.com/in/jay-hui-187222120/", "anchor_text": "https://www.linkedin.com/in/jay-hui-187222120/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102abb901d98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&user=Jay+Hui&userId=102abb901d98&source=post_page-102abb901d98--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdfb93693b5df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-how-to-do-the-feature-selection-2de56182cd9b&newsletterV3=102abb901d98&newsletterV3Id=dfb93693b5df&user=Jay+Hui&userId=102abb901d98&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}