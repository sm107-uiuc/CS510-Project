{"url": "https://towardsdatascience.com/everything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5", "time": 1683001994.601334, "path": "towardsdatascience.com/everything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5/", "webpage": {"metadata": {"title": "Everything you need to know about Auto-Deeplab: Google\u2019s latest on Segmentation | by Vandit Jain | Towards Data Science", "h1": "Everything you need to know about Auto-Deeplab: Google\u2019s latest on Segmentation", "description": "Review of the Paper Aut-Deeplab by Google."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Viterbi_algorithm", "anchor_text": "Viterbi Algorithm", "paragraph_index": 19}, {"url": "https://arxiv.org/pdf/1901.02985.pdf", "anchor_text": "paper", "paragraph_index": 23}, {"url": "https://medium.com/@vandit_15", "anchor_text": "Medium", "paragraph_index": 24}, {"url": "https://github.com/vandit15", "anchor_text": "Github", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/vandit-jain15/", "anchor_text": "LinkedIn", "paragraph_index": 25}], "all_paragraphs": ["All previous versions of DeepLab(v1, v2, v3 and v3plus) stretched the state-of-the-art for semantic segmentation problem when they were published. Meanwhile, Neural Architecture Search had been used to beat the state-of-the-art in the image recognition problem set by networks designed by humans. So, the subsequent step was to have a go at solving a dense image prediction problem like semantic segmentation using Neural Architecture Search. This story is a review of the paper \u201cAuto-DeepLab: Hierarchical Neural Architecture Search for Semantic Image Segmentation\u201d presented at CVPR 2019.", "Semantic Segmentation problem is being tackled by some of the earliest CNNs such as AlexNet, VGG, Inception, ResNet etc. Then came improved versions of these models such as Wide ResNet, Xception, ResNeXt etc. However, all these models were generic feature extractors being used for the problem in hand. These models were then followed by a series of models especially for segmentation such as series of DeepLab models proposing the ideas of atrous convolutions or PSPNet for instance that were winners of the segmentation challenges of several datasets when they were respectively published. However, most of the models used nowadays use ImageNet pre-training. However, the model proposed here produces competitive results without such aid.", "To reduce computational power needed to search the network, they use differential NAS instead of the older techniques that used evolutionary algorithms or reinforcement learning. This way, we are able to get the structure from a latent space instead of complete random search.", "Further, NAS has been used in the past to search for a CNN block that is repeated regularly to form the whole network. In other words, it has been used only on a cell interior level and not for determining the network structure. However, here they propose to use NAS for searching the network as well along with the normal task of searching the cell.", "To search for a cell, first, we define a cell. Here, a cell is a fully convolutional module consisting of B blocks. Each block is a two-branch structure and can be defined by a 5-tuple (I\u2081, I\u2082, O\u2081, O\u2082, C) where I\u2081, I\u2082 \u2208 I\u02e1\u1d62 which is the set of all possible selections of input for block i in layer l and O\u2081, O\u2082 are selection of layer types for the block C is the method used to combine the individual outputs of the two branches to get the output of this block H\u1d62\u02e1. The cell\u2019s output tensor H\u02e1 is simply the concatenation of output from the blocks. The set of possible tensors for a block contains the output of the previous two cells i.e. H\u02e1\u207b\u00b9 and H\u02e1\u207b\u00b2. Also, the output from a block j in a cell can be input to every block i where i > j.", "Further, the types of branches that will be considered in every block are the following:", "depthwise-separable conv was introduced first in MobileNetV2 and atrous conv in DeepLab.", "The network-level search space is especially needed because this is a dense image prediction problem and generally networks for such problems tend to start with a high-resolution image and get the spatial dimension down somewhere during the network and then back up again to the original dimension. Here, the authors restrict the total downsampling factor to 32. Also, the movement in terms of spatial dimension can be done only by a factor of 2. Further, the total number of layers, i.e totals the number of cells threaded is set to 12.", "The figure below is a schematic diagram of the latent space. In the left is the latent space of the whole network. It is a mesh of spatial dimension factor vs layer number. The ASPP module which is used for segmentation is put at every possible according to every possible final spatial dimension factor(s = 4,8,16,32) when searching the architecture.", "The figure in right is the latent space for a cell. It contains five blocks with all possible connections. These connections are explained in the next section.", "This is where we get the models by searching. This is a 3-step process as follows:", "First, we go through the system that explains how the architecture will be searched that also follows the search space defined above. In short, we give weights to every possible connection that is possible for all the layers (input to be chosen, branch to be chosen and the spatial dimension to be selected) using formulas described below:", "The hidden output of a block H\u1d62\u02e1 :", "Also, we approximate branch to be used O\u2c7c\u208b\u1d62 for each connection using this:", "Basically, along with the normal CNN weights, we add these weights (\u03b1\u1d4f\u2c7c\u208b\u1d62) (I will call them meta weights from now on) across the whole latent search space that contains all the connections between possible inputs and the possible branches within a cell. We give a weighted addition and learn what combination of these meta weights gives us the best structure of the cell. The best part of this structure is since the above equation is differentiable, the meta weights can be trained simultaneously along with the normal weights. Since according to the latent space decided already, we can have output from the previous two cells into the current cell. So the overall mathematical formulation of a cell to give output at layer l can be written as:", "Next comes the structure of the network as a whole that is to be searched while being in the latent space as described in the previous section. If the spatial dimension factor at the current layer is s then input to this layer can come from three spatial dimensions only i.e s/2, s and s as per the latent space. Hence, just like we did for the cell structure, we define meta weights for getting the correct connections:", "Here \u03b2 is the set of meta weights. The relation between \u03b2s is would be given as :", "Just like normal weights, we train these \u201cmeta weights\u201d using cross-entropy loss in order to get an optimized situation where various values of \u03b1 describe us the network within a cell and various values of \u03b2 describe the overall structure. After training, they came up with the following model.", "They got to this architecture using the third step which is:", "For cell structure, we take the two strongest connections from all possible inputs using the largest values of \u03b1 for that branch and repeating this exercise for all the blocks. For network architecture, values of \u03b2 cannot be calculated greedily. Our aim is to get that sequence of values that gives us the maximum value at the end. This is a classic case of Dynamic Programming and it can be solved easily using the Viterbi Algorithm.", "After decoding we get the final structure as the figure above. In comparison, the structure for Deeplab looks something like this:", "One of the biggest achievements of this model is that it doesn\u2019t need any Imagenet pre-training. The results can be summarised in the following tables. On CityScapes dataset, it AutoDeepLab-L outperforms GridNet and matches the performance with DeepLabV3+ at 82.1% while requiring almost half the computation power.", "Similarly, on COCO dataset, the results are comparable to models that use Imagenet pre-training. This goes to show the power of NAS and the architecture that we get from this idea.", "Check out the Auto-DeepLab paper to know more about this idea.", "To learn more about computer vision and deep learning, follow me on Medium and Github.", "You can also follow me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F181425d17cd5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----181425d17cd5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----181425d17cd5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vandit_15?source=post_page-----181425d17cd5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vandit_15?source=post_page-----181425d17cd5--------------------------------", "anchor_text": "Vandit Jain"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd74000cb9d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&user=Vandit+Jain&userId=d74000cb9d0&source=post_page-d74000cb9d0----181425d17cd5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F181425d17cd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F181425d17cd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Viterbi_algorithm", "anchor_text": "Viterbi Algorithm"}, {"url": "https://arxiv.org/pdf/1901.02985.pdf", "anchor_text": "paper"}, {"url": "https://medium.com/@vandit_15", "anchor_text": "Medium"}, {"url": "https://github.com/vandit15", "anchor_text": "Github"}, {"url": "https://www.linkedin.com/in/vandit-jain15/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----181425d17cd5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----181425d17cd5---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/google?source=post_page-----181425d17cd5---------------google-----------------", "anchor_text": "Google"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----181425d17cd5---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/ai?source=post_page-----181425d17cd5---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F181425d17cd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&user=Vandit+Jain&userId=d74000cb9d0&source=-----181425d17cd5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F181425d17cd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&user=Vandit+Jain&userId=d74000cb9d0&source=-----181425d17cd5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F181425d17cd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----181425d17cd5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F181425d17cd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----181425d17cd5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----181425d17cd5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----181425d17cd5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----181425d17cd5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----181425d17cd5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----181425d17cd5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----181425d17cd5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----181425d17cd5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----181425d17cd5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vandit_15?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vandit_15?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vandit Jain"}, {"url": "https://medium.com/@vandit_15/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "236 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd74000cb9d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&user=Vandit+Jain&userId=d74000cb9d0&source=post_page-d74000cb9d0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff3b483522866&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feverything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5&newsletterV3=d74000cb9d0&newsletterV3Id=f3b483522866&user=Vandit+Jain&userId=d74000cb9d0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}