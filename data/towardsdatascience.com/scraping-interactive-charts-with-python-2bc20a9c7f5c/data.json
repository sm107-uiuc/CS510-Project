{"url": "https://towardsdatascience.com/scraping-interactive-charts-with-python-2bc20a9c7f5c", "time": 1683008475.979875, "path": "towardsdatascience.com/scraping-interactive-charts-with-python-2bc20a9c7f5c/", "webpage": {"metadata": {"title": "Scraping Interactive Line Charts with Python | by Ot\u00e1vio Sim\u00f5es Silveira | Towards Data Science", "h1": "Scraping Interactive Line Charts with Python", "description": "So let\u2019s say you want to see how the dollar is performing against the Euro today. A quick google search will get it done, just type: \u201cdollar euro\u2019. You\u2019ll see an interactive chart like this one: In\u2026"}, "outgoing_paragraph_urls": [{"url": "https://twitter.com/_otavioss", "anchor_text": "Twitter", "paragraph_index": 23}, {"url": "https://github.com/otavio-s-s/data_science", "anchor_text": "GitHub", "paragraph_index": 23}, {"url": "https://www.linkedin.com/in/otavioss28/", "anchor_text": "Linkedin", "paragraph_index": 23}], "all_paragraphs": ["So let\u2019s say you want to see how the dollar is performing against the Euro today. A quick google search will get it done, just type: \u201cdollar euro\u2019. You\u2019ll see an interactive chart like this one:", "In order to see the values for the whole period, you need to move the cursor along the line, while you do it the label containing the value and date keeps being updated instantly.", "Now suppose you\u2019d like to get all the data from this chart and create yourself a database. How to scrape the data from the entire line if the values in the label change all the time? Since if you can see it, you can scrape it, there must be a way.", "If you were going to do it manually, what you\u2019d do is to move the cursor along the line while you\u2019d type each value in an Excel sheet or maybe even hand-write in your notebook. Well, in this post we\u2019ll see how to get selenium doing exactly the same thing. We\u2019ll make it work pretty much like a human would, going through the line and recording the values.", "Although we are working with Google's chart, the logic implemented here can be adapted to any similar charts.", "We are basically using selenium, pandas, and the datetime module. OK, after we import everything we\u2019ll use, let\u2019s go straight to open the connection and grab the page.", "We then instantiate the action object, which we\u2019ll use to move the cursor on the screen, and the search_bar and search_button objects that we will use to perform our search. With that done, just use send_keys method to write the search and the click method to click on the search button. We\u2019ll use WebDriverWait so it waits for the element to be fully loaded in the page:", "Now let\u2019s find the chart element and get its size and location on the page. This is important so we know where to move the cursor. We\u2019ll also use WebDriverWait for this.", "Run everything we have done so far so you can see this output:", "Now that we have this information, we can use it to move the cursor to the extreme right of the object, using the move_to_element_with_offset. This method moves the mouse by an offset of the specified element. The offsets are relative to the top-left corner of the element, so we need to pass as the xoffset the entire length of the object. As there is no need to move on y-axis, the yoffset can be set to zero:", "If we had used move_to_element instead, the cursor would be moved to the center of the element.", "And now our cursor is here:", "Notice the cursor on the extreme right of the chart.", "We then get the first date value pair:", "We just need our cursor to keep moving left now. For that we need to set up:", "We\u2019ll use the move_by_offset method of the action object to move the cursor from its last known position to the next. An infinity loop will make the cursor move until the limit date we set up. When the date surpasses the limit, we call break.", "And this is the behavior we expect:", "Cool, huh?! Each time the cursor moves to the left, it scrapes a new value and date from the label. Just like a human being moving the mouse and taking notes!", "If you are doing this in a graph from Google and you change the time range of the chart, let\u2019s say, to years, some dates might be skipped. These dates are not accessible even manually. Maybe because the x-axis becomes too big for such a small chart.", "Also, it\u2019s important to make it clear that the pace is set by trial and error. If the pace is too small, the cursor will take a long time to move to the next date in the chart. If it is too big, it might skip dates.", "However, it\u2019s inevitable that the sometimes cursor will still be on the same date even though it just moved. Because of that, it is good to store the data in a dictionary and use it to discard the duplicate data. When we are done scraping, we can just convert this dictionary to a DataFrame. This is the full code for this:", "And this is the data we just scraped:", "Last warning: if you are watching the cursor moving through the line, you\u2019ll notice that it goes back to the beginning in each loop. This happens even though selenium keeps that last position, but you can also notice the cursor keeps going further left in each new loop at the pace we established. So, everything is worked as planned.", "Well, that is it. I hope you enjoyed it and that this can maybe be useful somehow. If you have a question, a suggestion, or just want to be in touch, feel free to contact through Twitter, GitHub, or Linkedin.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2bc20a9c7f5c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@otavios.s?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@otavios.s?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": "Ot\u00e1vio Sim\u00f5es Silveira"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1092aaeb5b32&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&user=Ot%C3%A1vio+Sim%C3%B5es+Silveira&userId=1092aaeb5b32&source=post_page-1092aaeb5b32----2bc20a9c7f5c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bc20a9c7f5c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bc20a9c7f5c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.freepik.com/free-photos-vectors/business", "anchor_text": "Business photo created by freepik \u2014 www.freepik.com"}, {"url": "https://twitter.com/_otavioss", "anchor_text": "Twitter"}, {"url": "https://github.com/otavio-s-s/data_science", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/otavioss28/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/python?source=post_page-----2bc20a9c7f5c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/selenium?source=post_page-----2bc20a9c7f5c---------------selenium-----------------", "anchor_text": "Selenium"}, {"url": "https://medium.com/tag/web-scraping?source=post_page-----2bc20a9c7f5c---------------web_scraping-----------------", "anchor_text": "Web Scraping"}, {"url": "https://medium.com/tag/programming?source=post_page-----2bc20a9c7f5c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----2bc20a9c7f5c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2bc20a9c7f5c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&user=Ot%C3%A1vio+Sim%C3%B5es+Silveira&userId=1092aaeb5b32&source=-----2bc20a9c7f5c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2bc20a9c7f5c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&user=Ot%C3%A1vio+Sim%C3%B5es+Silveira&userId=1092aaeb5b32&source=-----2bc20a9c7f5c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2bc20a9c7f5c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2bc20a9c7f5c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2bc20a9c7f5c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2bc20a9c7f5c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@otavios.s?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@otavios.s?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ot\u00e1vio Sim\u00f5es Silveira"}, {"url": "https://medium.com/@otavios.s/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "507 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1092aaeb5b32&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&user=Ot%C3%A1vio+Sim%C3%B5es+Silveira&userId=1092aaeb5b32&source=post_page-1092aaeb5b32--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbb9b9ebd7b6b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-interactive-charts-with-python-2bc20a9c7f5c&newsletterV3=1092aaeb5b32&newsletterV3Id=bb9b9ebd7b6b&user=Ot%C3%A1vio+Sim%C3%B5es+Silveira&userId=1092aaeb5b32&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}