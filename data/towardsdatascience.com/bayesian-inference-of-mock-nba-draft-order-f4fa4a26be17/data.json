{"url": "https://towardsdatascience.com/bayesian-inference-of-mock-nba-draft-order-f4fa4a26be17", "time": 1683016223.9267552, "path": "towardsdatascience.com/bayesian-inference-of-mock-nba-draft-order-f4fa4a26be17/", "webpage": {"metadata": {"title": "Bayesian Inference of Mock NBA Draft Order | by Evan Zamir | Towards Data Science", "h1": "Bayesian Inference of Mock NBA Draft Order", "description": "Many of us who follow the NBA Draft closely have a keen desire to know the precise ordering of the Draft, eg where each player will be taken (\u201cwhere\u201d having a dual meaning here, both the team and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cran.rstudio.com/web/packages/PlackettLuce/vignettes/Overview.html", "anchor_text": "Plackett-Luce Distribution", "paragraph_index": 2}, {"url": "https://github.com/agadetsky/pytorch-pl-variance-reduction", "anchor_text": "here", "paragraph_index": 2}, {"url": "http://pyro.ai/", "anchor_text": "Pyro probabilistic programming language", "paragraph_index": 2}, {"url": "https://pytorch.org/", "anchor_text": "Facebook\u2019s PyTorch", "paragraph_index": 2}], "all_paragraphs": ["Many of us who follow the NBA Draft closely have a keen desire to know the precise ordering of the Draft, eg where each player will be taken (\u201cwhere\u201d having a dual meaning here, both the team and draft slot). To this end, it is common behavior to ingest the information we get from the dozen or more \u201cprominent\u201d mock drafts available leading up to the Draft. There are different ways analysts and media try to aggregate this information into what I like to call \u201cMeta Mocks\u201d. Typically this just involves very simple operations like averaging ranks or looking at the minimum and maximum draft position. Chris Feller just the other day shared a very cool approach using survival analysis. I haven\u2019t dug into it yet, but it will be interesting to compare to what I\u2019m doing here.", "What I wanted to do that is a bit different from using survival analysis, but can yield similar insights as I\u2019ll show later, is to create a generative meta-model for mock drafts. In theory this enables one to infer some measure of \u201cvalue\u201d from rank orderings (no mock draft that I could find assigns numerical ratings to players) and then generate random mock draft orders from the posterior distribution. In other words, much like Nate Silver runs simulations to predict who will win the election, we can create a simulation for mock drafts and do all kinds of neat things therein. Let me show you how!", "The first thing we need is a probability distribution that makes sense for rank data. Say hello to the Plackett-Luce Distribution. The basic idea is that if you have some set S of items each with some \u201cworth\u201d w_i you can generate a probability distribution on the rank of any arbitrary permutation those items in some vector. I won\u2019t show you the equations (see the reference), but I can show you a very simple simulation to get the idea across quickly. First we need to import some packages and define the PL Distribution which I found someone had implemented on github here. The work herein is all done using the Pyro probabilistic programming language that is made open-source by Uber and built upon Facebook\u2019s PyTorch deep learning library.", "Ok, so let\u2019s do a little simulation. It\u2019s very simple. Imagine that we have 5 race car drivers. We are going to generate some \u201cworth\u201d vector using an Exponential distribution. We see that Driver 3 has by the far the highest rating and Driver 0 the lowest. Given those parameters we then generate random samples of \u201craces\u201d using the PL distribution. We do this 10 times.", "You can see that drivers 3 and 4 come in 1 and 2 in all 10 of our simulated races.", "Now let\u2019s do the same simulation but increase the Exponential rate parameter such that the drivers are more \u201ceven\u201d.", "You can see that now driver 4 wins some races and even driver 1 gets to stand at the podium. Sweet! Hopefully this is starting to make sense to you. We\u2019re basically ready to go. We just need to read in some data, create the model, and do some inference. Let\u2019s do it!", "I\u2019ve collected data from 17 publicly available mock drafts. Not all drafts mock both rounds though. That is ok, since there is still useful information in even one round. I\u2019ll explain how I deal with that shortly, but let\u2019s read in the data first.", "As you can see there are 86 players total in these mock drafts. Now we\u2019re going to put the mocks in a data format that Pyro can understand, a Torch tensor containing 17 rows. Each row will have all 86 players in some permutation. Now I can explain how I \u201cpad\u201d each mock such that whether a mock had 30 or 60 players, each will be padded to contain all 86. I assume something very simple: if a mock doesn\u2019t have a player then every other player can just be randomly shuffled to fill out the full mock to position 86. This is about the simplest way I could do it. A more advanced way would be to start with a randomization like this, but then subsequently refine the \u201ccounterfactual\u201d padding with a random order that is based on the inferred ratings from the model. One could keep iterating like this until some equilibrium is reached (basically until there is no more improvement).", "Let\u2019s look at one of these rows:", "Ok, now the exciting part. Let\u2019s define the model:", "That\u2019s all it is really. I\u2019m using a Cauchy distribution because if you think about the distribution of NBA talent it seems \u201cfat-tailed\u201d. In other words, we want our model to be able to handle the case where there is a \u201csuperstar\u201d or consensus top pick(s). If we make our distribution too flat, it would be more like a horse race where any horse has a shot at finishing first (more or less). Now we do the inference step, setting up a guide and optimizer according to the Pyro parlance for doing stochastic variational inference (in the future I plan to investigate the more accurate MCMC sampling approach, but this should fine for now).", "Here are the results of our Meta Mock!", "Ok, not bad, but that\u2019s not the coolest part. The coolest part is now we have probability distributions for each player so we can go and simulate thousands of mock drafts. Let\u2019s do it! Basically we\u2019re just going to sample the posterior distribution (from the Pyro guide function) and generate one sample mock draft order. We then do that 10,000(!) times and place them all in a Pandas dataframe.", "So now we have distributions (histograms) of simulated draft position for each player. For example, let\u2019s look at where Anthony Edwards is predicted:", "An easier way to understand this distribution is to look at the cumulative probability. Remember when I said this model can be used in a similar way to survival analysis? This is what I\u2019m talking about:", "From this we see Edwards has around a 45% chance of being taken first and around 80% to go top 2 and so on. Pretty neat! Now let\u2019s look at someone with a wider range of predictions, Saddiq Bey:", "Ooh isn\u2019t that cool? A very wide range indeed. Let\u2019s take a look at a more fringey player, Nick Richards:", "Ok, so I should explain that in the simulation if a player is not drafted in the top 60, I just put him at 61, thus essentially making him an undrafted free agent (UDFA). These plots get kind of messy but before I\u2019m done, here\u2019s one that has the top 10 guys in one chart.", "Well, that\u2019s all I got for now. Be on the lookout (via my Twitter) for more things related to this as we get closer to the Draft (Nov. 18). If you have any suggestions (or corrections) let me know! Here\u2019s a link to the github repo for this project:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff4fa4a26be17&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://thecity2.medium.com/?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": ""}, {"url": "https://thecity2.medium.com/?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": "Evan Zamir"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F949f03393eeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&user=Evan+Zamir&userId=949f03393eeb&source=post_page-949f03393eeb----f4fa4a26be17---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff4fa4a26be17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff4fa4a26be17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cran.rstudio.com/web/packages/PlackettLuce/vignettes/Overview.html", "anchor_text": "Plackett-Luce Distribution"}, {"url": "https://github.com/agadetsky/pytorch-pl-variance-reduction", "anchor_text": "here"}, {"url": "http://pyro.ai/", "anchor_text": "Pyro probabilistic programming language"}, {"url": "https://pytorch.org/", "anchor_text": "Facebook\u2019s PyTorch"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----f4fa4a26be17---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f4fa4a26be17---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nba-draft?source=post_page-----f4fa4a26be17---------------nba_draft-----------------", "anchor_text": "NBA Draft"}, {"url": "https://medium.com/tag/nba?source=post_page-----f4fa4a26be17---------------nba-----------------", "anchor_text": "NBA"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----f4fa4a26be17---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff4fa4a26be17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&user=Evan+Zamir&userId=949f03393eeb&source=-----f4fa4a26be17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff4fa4a26be17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&user=Evan+Zamir&userId=949f03393eeb&source=-----f4fa4a26be17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff4fa4a26be17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff4fa4a26be17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f4fa4a26be17---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f4fa4a26be17--------------------------------", "anchor_text": ""}, {"url": "https://thecity2.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://thecity2.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Evan Zamir"}, {"url": "https://thecity2.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "462 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F949f03393eeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&user=Evan+Zamir&userId=949f03393eeb&source=post_page-949f03393eeb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7a0dcde46962&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-inference-of-mock-nba-draft-order-f4fa4a26be17&newsletterV3=949f03393eeb&newsletterV3Id=7a0dcde46962&user=Evan+Zamir&userId=949f03393eeb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}