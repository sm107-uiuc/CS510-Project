{"url": "https://towardsdatascience.com/improving-the-performance-of-a-machine-learning-model-5637c12fc41c", "time": 1683013603.485019, "path": "towardsdatascience.com/improving-the-performance-of-a-machine-learning-model-5637c12fc41c/", "webpage": {"metadata": {"title": "Improving the Performance of a Machine Learning Model | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Improving the Performance of a Machine Learning Model", "description": "In the previous post, we explored and analyzed a customer churn data set. Then, we built a machine learning model to predict customer churn that achieved an accuracy of %91.7 on the training set and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-practical-machine-learning-guide-fa2111c65f42", "anchor_text": "previous post", "paragraph_index": 0}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html", "anchor_text": "random forest", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/a-practical-machine-learning-guide-fa2111c65f42", "anchor_text": "previous post", "paragraph_index": 16}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 42}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 42}], "all_paragraphs": ["In the previous post, we explored and analyzed a customer churn data set. Then, we built a machine learning model to predict customer churn that achieved an accuracy of %91.7 on the training set and %90.7 on the test set.", "In this post, we will work on:", "It is important to note that the go-to way to increase the performance of a model is usually collecting more data. However, it may not always be an available option.", "Let\u2019s go back to our topic.", "The model we built was a random forest classifier with hyperparameters:", "Here is the performance of the model:", "The first and second matrices are confusion matrices on the train and test set, respectively. The confusion matrix goes deeper than classification accuracy by showing the correct and incorrect (i.e. true or false) predictions on each class.", "Let\u2019s first focus on the accuracy and then dive deep into the confusion matrix and related metrics.", "One way to improve the performance of a model is to search for optimal hyperparameters. Adjusting the hyperparameters is like tuning the model. There are many hyperparameters of the random forest but the most important ones are the number of trees (n_estimators) and the maximum depth of an individual tree (max_depth).", "We will use the GridSearchCV class of scikit-learn. It allows selecting the best parameters from a range of values. Let\u2019s first create a dictionary that includes a set of values for n_estimators and max_depth. I will select the values around the ones we used previously.", "You can try more values or hyperparameters. There is not a single correct answer. We can now pass this dictionary to a GridSearchCV object along with an estimator.", "The cv parameter is doing the cross-validation.", "We have trained the GridSearchCV object. Let\u2019s see what the best parameters are:", "I have run the GridSearchCV one more time with values around 12 and 225. The best parameters turned out to be 13 and 235.", "Let\u2019s see the confusion matrix and accuracy with these new hyperparameter values.", "The accuracy on the training set increased but we did not achieve anything on the test set. If we can collect more data which is usually the best way to increase the accuracy, test accuracy might also improve with these new parameters.", "If you recall from the previous post, we had eliminated the 4 features which are less informative compared to other ones. In some cases, it is a good practice to eliminate less informative or uncorrelated features not to put unnecessary computation burden on the model. However, these eliminated features might slightly improve the accuracy so it comes down to a decision between performance enhancement and computation burden.", "I played around with the hyperparameter values and trained with all the features. Here is the result:", "We have achieved an approximately %1 increase in test accuracy which is also an improvement in terms of overfitting.", "Our task is to predict if a customer will churn (i.e. stop being a customer). Thus, the focus should be on the positive class (1). We have to predict all the positive classes (Exited=1) correctly. We can afford to have some wrong predictions on the negative class (Exited=0).", "We need to take the accuracy one step further. Let\u2019s start with the confusion matrix.", "Since we want to predict customer churn as much as possible, we aim to maximize TP and minimize FN.", "FN occurs when we predict \u201cthe customer will not churn (0)\u201d but, in the actual situation, customer churns.", "It is time to introduce two metrics which are precision and recall.", "Precision measures how good our model is when the prediction is positive.", "The focus of precision is positive predictions. It indicates how many positive predictions are true.", "Recall measures how good our model is at correctly predicting positive classes.", "The focus of recall is actual positive classes. It indicates how many of the positive classes the model is able to predict correctly.", "We want to predict all the positive classes so recall is the appropriate metric for our task. Maximizing TP and/or minimizing FN will increase the recall value.", "Here are the confusion matrices on train and test sets:", "We need to minimize the values marked with yellow which are false negatives (FN).", "One way to achieve this is to tell the model that \u201cpositive class (1) is more important than the negative class (0)\u201d. With our random forest classifier, it can be achieved by the class_weight parameter.", "We passed a dictionary that contains weights for each class. I set it as 3 to 1 as an example.", "Here are the new confusion matrices:", "The number of false positives is greatly reduced. The wrong predictions on the positive class are more penalized than the ones on negative class. Thus, the model leans towards making mistakes on the positive class as low as possible.", "There is a downside to this approach. While getting better at predicting the positive class, the overall accuracy might get worse. Let\u2019s check.", "The accuracy on the test set went down to %89.57 from %91.21. Thus, it comes down to a business decision. If we just want to predict all positive classes and do not care about the overall accuracy, we can further increase the weight of the positive class.", "For instance, here is the confusion matrices and accuracy when we assign the weights as 10 to 1:", "We can also try different algorithms and see if the performance gets better. However, more complex models need more data. They are data-hungry. Gradient boosted decision tree (GBDT) and its variations (e.g. XGBOOST, LightGBM) can also be tried but I think there can only be a slight increase in the performance.", "When the complexity of the task and the amount of data are considered, I think random forests will do the job just fine.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5637c12fc41c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----5637c12fc41c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5637c12fc41c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5637c12fc41c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chrisliverani?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Chris Liverani"}, {"url": "https://unsplash.com/s/photos/customer?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/a-practical-machine-learning-guide-fa2111c65f42", "anchor_text": "previous post"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html", "anchor_text": "random forest"}, {"url": "https://towardsdatascience.com/a-practical-machine-learning-guide-fa2111c65f42", "anchor_text": "previous post"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5637c12fc41c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5637c12fc41c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----5637c12fc41c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----5637c12fc41c---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/predictive-analytics?source=post_page-----5637c12fc41c---------------predictive_analytics-----------------", "anchor_text": "Predictive Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5637c12fc41c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----5637c12fc41c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5637c12fc41c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----5637c12fc41c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5637c12fc41c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5637c12fc41c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5637c12fc41c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5637c12fc41c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5637c12fc41c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5637c12fc41c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5637c12fc41c--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimproving-the-performance-of-a-machine-learning-model-5637c12fc41c&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}