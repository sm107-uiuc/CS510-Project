{"url": "https://towardsdatascience.com/linear-regression-with-python-and-numpy-25d0e1dd220d", "time": 1683002686.351871, "path": "towardsdatascience.com/linear-regression-with-python-and-numpy-25d0e1dd220d/", "webpage": {"metadata": {"title": "Linear Regression with Only Python and Numpy | by Anirudh S | Towards Data Science", "h1": "Linear Regression with Only Python and Numpy", "description": "In this post, we\u2019ll see how to implement linear regression in Python without using any machine learning libraries. In another post, we saw how the linear regression algorithm works in theory. With\u2026"}, "outgoing_paragraph_urls": [{"url": "https://hackerstreak.com/linear-regression/", "anchor_text": "another post", "paragraph_index": 0}, {"url": "https://hackerstreak.com/linear-regression/", "anchor_text": "previous article", "paragraph_index": 8}, {"url": "https://github.com/Baakchsu/LinearRegression", "anchor_text": "repository", "paragraph_index": 18}], "all_paragraphs": ["In this post, we\u2019ll see how to implement linear regression in Python without using any machine learning libraries. In another post, we saw how the linear regression algorithm works in theory. With the rise in popularity of machine learning libraries, anyone can implement ML algorithms with a few API calls. But only a few dig deeper to understand how the algorithms work under the hood. We\u2019ll program linear regression in Python and train it!", "We\u2019ll be coding the linear regression algorithm and train it with Python language. If you already have programming experience but new to Python, it would be an absolute breeze. However, if you don\u2019t have any programming experience, I\u2019d suggest you go through Python\u2019s documentation. Just to get a basic understanding of programming and language syntax. Moreover, Python is really intuitive and you\u2019d be up and running in no time. And Google\u2019s Colab is a nice way to run your program as it is hassle-free when installing libraries. But if you have Python IDE already, you\u2019re welcome to skip. Alright then. Without further ado let\u2019s jump right to the code.", "First, we import Numpy, the most needed matrix operation library. Then, \u2018matplotlib\u2019 is for sketching plots and graphs. This is to visualize our model\u2019s fitting and performance. And Pandas helps to easily load datasets (csv, excel files) into pandas data frames. We\u2019ll use these to load the dataset, initialize a linear regression model and train it.", "This line pulls the \u201cpredict the height with weight\u201d dataset from my Github repo and reads it into a data frame.", "Up next, we\u2019ll create a class for the linear regression model just like scikit\u2019s model. Its model can be called with \u201csklearn.linear_model.LinearRegression\u201d method. But, we\u2019ll make it as just LinearRegression. Let\u2019s see how it comes up.", "Turned out pretty simple right? Let us go through the code to understand a bit more in detail. Here, we define the LinearRegression class with two methods \u201cFit\u201d and \u201cPredict\u201d. Yes, they do what their names suggest. The fit method takes in the input feature vector (weight of people) and output variable (Height of people ) and trains the Linear model to get a perfect fit.", "We convert the arguments X and Y into numpy arrays and reshape them into the shape (number of data, number of feature variables). Since we\u2019re predicting the height with just weight, the number of variables is just one (num_var). We do the same for the output target variable Y.", "After that, we initialize the weight matrix and the intercept variable. The weight matrix will have a shape (num_var, number of output variables to predict). Hence, for our problem, it turns out to be (1,1). Because both the number of input and output variables are just one (weight is just one variable and so is the height). If we were to predict the height of a person with the weight and gender of the input, we\u2019d have two input and one output variables. Hence, the weight matrix will have a shape (2,1).", "An intercept is just a single number that denotes the Y-intercept of our linear regression model. If you\u2019re confused about what is weight and intercept, check out the previous article that explains in detail. We use parameter_cache to cache our model parameters as we train.", "Finally, we train our model with backpropagation. Here\u2019s the equation of the partial derivative of the cost with respect (w.r.t) to the model parameters from the previous post.", "We implement the above equations in the first two lines (dcostdm and dcostdc).", "Next, we update the parameters \u2018weight_matrix\u2019 and \u2018intercept\u2019 with the calculated gradients using the above equations. Then, we append the model parameters to the cache. After the training loop ends, we return the parameters and the cache from the fit function.", "The predict method takes in the input feature and predicts the output with the trained parameters of the Linear regression class. The \u2018self.weight_matrix\u2019 and \u2018self.intercept\u2019 denote the model parameters that we saw in the fit method. Likewise, we return the predicted values.", "Till now, we just created the model class and the training code. Now, we\u2019ll create an instance of the Linear Regression class with the above line of code.", "These two lines will standardize the dataset using the mathematical formula X-u/std. In that, X is the variable we want to standardize, \u2018u\u2019 is the mean of that variable and \u2018std\u2019 is the standard deviation. This helps the model learn faster as all the variables will be in the range ( -1 to 1). It centers the mean to 0 and unit standard deviation (std=1).", "By calling the fit method of the class instance \u2018reg\u2019 and passing the X and Y values, we initiate the training. Here, we pass the dataset leaving the last 180 data points for testing.", "Once we finish training, we can predict using our trained regression model. We do that using the \u2018reg.predict\u2019 method and we pass in the test data (last 180 data points). Now, the \u2018pred\u2019 variable will have the predicted outputs for the test data. In order to visualize how the model fits, we first create a plot with the test data points. Then, we plot the model fitting line with the \u2018plt.plot\u2019 function.", "For a linear regression model made from scratch with Numpy, this gives a good enough fit. Notably, from the plot, we can see that it generalizes well on the dataset. Well, it is just a linear model. But knowing its working helps to apply it better.", "From the parameter cache that we returned from the \u2018fit\u2019 method, we plot the model\u2019s fit during the course of training. The blue line from the top is the initial fit with random parameters before training. As you can see, the model improves its predictive performance as it trains. You can play around with the code, changing initialization conditions and see how the model fit changes. For that, find the code here on the GitHub repository", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Always Believing there's more to learn!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F25d0e1dd220d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@baakchsu.sprx77?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@baakchsu.sprx77?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": "Anirudh S"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1a92cae35860&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&user=Anirudh+S&userId=1a92cae35860&source=post_page-1a92cae35860----25d0e1dd220d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25d0e1dd220d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25d0e1dd220d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://hackerstreak.com/linear-regression/", "anchor_text": "another post"}, {"url": "https://hackerstreak.com/linear-regression/", "anchor_text": "previous article"}, {"url": "https://github.com/Baakchsu/LinearRegression", "anchor_text": "repository"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----25d0e1dd220d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----25d0e1dd220d---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/python?source=post_page-----25d0e1dd220d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/numpy?source=post_page-----25d0e1dd220d---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25d0e1dd220d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&user=Anirudh+S&userId=1a92cae35860&source=-----25d0e1dd220d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F25d0e1dd220d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&user=Anirudh+S&userId=1a92cae35860&source=-----25d0e1dd220d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F25d0e1dd220d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F25d0e1dd220d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----25d0e1dd220d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----25d0e1dd220d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@baakchsu.sprx77?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@baakchsu.sprx77?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anirudh S"}, {"url": "https://medium.com/@baakchsu.sprx77/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "127 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1a92cae35860&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&user=Anirudh+S&userId=1a92cae35860&source=post_page-1a92cae35860--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff34e096e7feb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-with-python-and-numpy-25d0e1dd220d&newsletterV3=1a92cae35860&newsletterV3Id=f34e096e7feb&user=Anirudh+S&userId=1a92cae35860&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}