{"url": "https://towardsdatascience.com/car-classification-using-inception-v3-71b63e9825b7", "time": 1683014812.359502, "path": "towardsdatascience.com/car-classification-using-inception-v3-71b63e9825b7/", "webpage": {"metadata": {"title": "Car Classification using Inception-v3 | by Piyush Maheshwari | Towards Data Science", "h1": "Car Classification using Inception-v3", "description": "This article is about training 3 deep convolutional neural networks using Monk, which is an open source library for computer vision, and then deploying them through an API. The models take an image\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "Monk", "paragraph_index": 0}, {"url": "https://ai.stanford.edu/~jkrause/cars/car_dataset.html", "anchor_text": "Cars Dataset", "paragraph_index": 0}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier", "anchor_text": "this", "paragraph_index": 3}, {"url": "https://github.com/PiyushM1/Car-classification-API", "anchor_text": "this", "paragraph_index": 4}, {"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "GitHub repository", "paragraph_index": 5}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier/blob/master/Car_make_model_year_classifier.ipynb", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier/blob/master/Car_make_model_year_classifier.ipynb", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://ai.stanford.edu/~jkrause/cars/car_dataset.html", "anchor_text": "Cars Dataset", "paragraph_index": 8}, {"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "Monk", "paragraph_index": 11}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier/blob/master/Car_make_model_year_classifier.ipynb", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://github.com/PiyushM1/Car-classification-API/tree/master/workspace", "anchor_text": "here", "paragraph_index": 24}, {"url": "https://github.com/PiyushM1/Car-classification-API", "anchor_text": "this", "paragraph_index": 25}, {"url": "https://docs.python.org/3/tutorial/venv.html", "anchor_text": "a virtual environment", "paragraph_index": 26}, {"url": "https://github.com/PiyushM1/Car-classification-API/blob/master/requirements.txt", "anchor_text": "here", "paragraph_index": 26}, {"url": "https://github.com/PiyushM1/Car-classification-API/tree/master/static", "anchor_text": "this", "paragraph_index": 29}, {"url": "https://github.com/PiyushM1/Car-classification-API/tree/master/templates", "anchor_text": "this", "paragraph_index": 29}, {"url": "http://0.0.0.0:5000/", "anchor_text": "http://0.0.0.0:5000", "paragraph_index": 35}, {"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "here", "paragraph_index": 37}, {"url": "https://www.linkedin.com/in/piyushmaheshwari1/", "anchor_text": "LinkedIn", "paragraph_index": 38}], "all_paragraphs": ["This article is about training 3 deep convolutional neural networks using Monk, which is an open source library for computer vision, and then deploying them through an API. The models take an image of a car as the input and then predict the Make, Model and Year of the car. The models have been trained on the Cars Dataset.", "For transfer learning, the Inception-v3 architecture with pre-trained weights was used. Some initial layers were frozen and training was done on the remaining layers.", "After training, the models were deployed through a Flask API. It accepts an image through a POST request and returns the predictions to the user.", "For the training notebook, check this.", "For the Flask API, check this.", "Monk is an open source computer vision library. You don\u2019t need in-depth knowledge of Python or any deep learning framework to be able to use it. It simplifies computer vision by providing wrapper functions for popular deep learning frameworks and enables one to use their functionalities with minimal code. Check its GitHub repository for more information.", "This article uses the PyTorch backend of Monk library, but you can install any other version of Monk if you want to. Check the detailed instructions for installation here.", "To install the library manually, follow the instructions provided here.", "The training dataset used for this task is Cars Dataset. It contains 16,185 images of 196 classes of cars. Classes are typically at the level of Make, Model, Year, e.g. Tesla Model S 2012 or BMW M3 coupe 2012. The dataset is accompanied with a devkit that contains the labels for each image, as well as the coordinates of the bounding box around the car. But we\u2019ll only use the labels. The code given here is intended to be run in a python notebook.", "The files in devkit needed for preparing labels:", "To prepare the labels for training:", "When using Monk, experimenting with the models becomes very easy. By changing a few parameters, we can quickly see how it affects the overall performance of the model. It also speeds up the prototyping.", "We\u2019ll use the PyTorch backend of Monk. However, Keras and MXNet-gluon backends are also available.", "Here, I\u2019ll explain the procedure to train the Make classifier. The other two classifiers can be trained in a similar way. You can find the entire training notebook here.", "We\u2019ll load the Inception-v3 model with pre-trained weights for training the classifiers using transfer learning. This usually makes the model perform better when the training dataset is not big enough.", "I had also tried training the ResNet-50 model, but its performance was not nearly as good as Inception-v3.", "For now, we\u2019ll train the model for 5 epochs. The training can be continued from the final epoch if the learning rate and other hyper parameters are good enough. We\u2019ll use softmax cross entropy as the loss function since it is usually great for classification tasks. For the optimiser, I had experimented with stochastic gradient descent, but RMSProp seemed to perform better.", "This will save the models obtained after every epoch along with some additional information related to the training into the workspace directory.", "Detailed summary of the training can be obtained by running ptf.Summary().", "We\u2019ll run the models on the entire test data to get the test accuracy, and then run them on some individual images.", "Evaluate the model on test data:", "The below code returns the overall test accuracy as well as the individual class-based accuracies, that can be used to gain some useful insights about its performance.", "Running the trained model for some images:", "The models were evaluated on the entire test data of 8,041 images. Validation set was a 20% split from the original training dataset. Accuracies obtained by the models:", "When training the models with Monk, it automatically creates a workspace directory. It contains all the training logs and all the intermediate models obtained during training. For developing the API, we just need the final models with the same directory structure that they were created in. If you have trained your models, you can use them. Otherwise, you can download the workspace with the final models from here.", "If you just want to test the API, check this. The readme file has detailed instructions to set up the environment.", "Create a sub-directory named \u2018uploads\u2019 in the project directory, wherein the files uploaded by the user would be saved before returning the predictions. Set up a virtual environment and install the required libraries. A virtual environment is not necessary, but is recommended. Download the requirements.txt file from here and run pip install -r requirements.txt", "Create a file named app.py in the project directory where the workspace is located. We\u2019ll write the code for the API in this file.", "Functions to respond to HTTP requests:", "I have included a user interface for the API, but it is not necessary. If you wish use it as well, download this and this directory into the project directory, and then define the index() function given below to make the API load the webpage when accessed through a browser.", "The upload() function responds to the POST requests at \u2018/predict\u2019, saves it to a subdirectory named \u2018uploads\u2019 and returns a string with the predictions if the file is a valid image.", "It loads the models and starts the server.", "Use the command python3 app.py in your terminal to run the app.", "Once the server has started, you can test the API by sending a POST request using cURL. To do so, you\u2019ll first need to install cURL if you don\u2019t have it already. Then, through your terminal, run the following command after replacing <image_path> with a valid path for an image.", "This will return the prediction to your terminal itself.", "Alternatively, you can go to http://0.0.0.0:5000 in your browser for the user interface. Then upload any image using the Choose button, and click Predict. It will then return a prediction like this:", "This article covered the entire process including data preparation, training image classification models, and finally deploying them through a Flask API. We also used data normalisation, random horizontal flipping, transfer learning, custom optimiser, learning rate and loss function. Upon evaluating the models on test data, they performed really well with an accuracy close to 85%. However, I was a bit puzzled with the year classifier having such a good accuracy, given that there really aren\u2019t any obvious features that could help in predicting the manufacturing year of a car. I\u2019m not sure if it is a good idea to try and predict the year with just an image.", "You should also try to tweak some hyper parameters, or use a different model architecture and see how it goes. It is also possible to test multiple combinations of models or hyper parameters simultaneously with Monk, check it out here.", "Thanks for reading! Let me know if you found this article helpful. Let\u2019s connect through LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "3rd year Computer Science undergrad at BITS Pilani, Goa. Interested in Computer Vision, Data structures & Algorithms and Web Development."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F71b63e9825b7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@PiyushMaheshwari1?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@PiyushMaheshwari1?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": "Piyush Maheshwari"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff77e3259fe28&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&user=Piyush+Maheshwari&userId=f77e3259fe28&source=post_page-f77e3259fe28----71b63e9825b7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71b63e9825b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71b63e9825b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@olav_tvedt?utm_source=medium&utm_medium=referral", "anchor_text": "Olav Tvedt"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "Monk"}, {"url": "https://ai.stanford.edu/~jkrause/cars/car_dataset.html", "anchor_text": "Cars Dataset"}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier", "anchor_text": "this"}, {"url": "https://github.com/PiyushM1/Car-classification-API", "anchor_text": "this"}, {"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "GitHub repository"}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier/blob/master/Car_make_model_year_classifier.ipynb", "anchor_text": "here"}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier/blob/master/Car_make_model_year_classifier.ipynb", "anchor_text": "here"}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier/blob/master/Car_make_model_year_classifier.ipynb", "anchor_text": "here"}, {"url": "https://ai.stanford.edu/~jkrause/cars/car_dataset.html", "anchor_text": "Cars Dataset"}, {"url": "http://imagenet.stanford.edu/internal/car196/cars_test_annos_withlabels.mat", "anchor_text": "here"}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier/tree/master/Labels", "anchor_text": "here"}, {"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "Monk"}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier/blob/master/Car_make_model_year_classifier.ipynb", "anchor_text": "here"}, {"url": "https://github.com/PiyushM1/Car-classification-API/tree/master/workspace", "anchor_text": "here"}, {"url": "https://github.com/PiyushM1/Car-classification-API", "anchor_text": "this"}, {"url": "https://docs.python.org/3/tutorial/venv.html", "anchor_text": "a virtual environment"}, {"url": "https://github.com/PiyushM1/Car-classification-API/blob/master/requirements.txt", "anchor_text": "here"}, {"url": "https://github.com/PiyushM1/Car-classification-API/tree/master/static", "anchor_text": "this"}, {"url": "https://github.com/PiyushM1/Car-classification-API/tree/master/templates", "anchor_text": "this"}, {"url": "http://0.0.0.0:5000/", "anchor_text": "http://0.0.0.0:5000"}, {"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "here"}, {"url": "https://github.com/PiyushM1/Car-make-model-and-year-classifier", "anchor_text": "https://github.com/PiyushM1/Car-make-model-and-year-classifier"}, {"url": "https://github.com/PiyushM1/Car-classification-API", "anchor_text": "https://github.com/PiyushM1/Car-classification-API"}, {"url": "https://ai.stanford.edu/~jkrause/cars/car_dataset.html", "anchor_text": "https://ai.stanford.edu/~jkrause/cars/car_dataset.html"}, {"url": "https://github.com/Tessellate-Imaging/monk_v1", "anchor_text": "https://github.com/Tessellate-Imaging/monk_v1"}, {"url": "https://www.linkedin.com/in/piyushmaheshwari1/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----71b63e9825b7---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/deployment?source=post_page-----71b63e9825b7---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----71b63e9825b7---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----71b63e9825b7---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/flask?source=post_page-----71b63e9825b7---------------flask-----------------", "anchor_text": "Flask"}, {"url": "http://creativecommons.org/licenses/by/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F71b63e9825b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&user=Piyush+Maheshwari&userId=f77e3259fe28&source=-----71b63e9825b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F71b63e9825b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&user=Piyush+Maheshwari&userId=f77e3259fe28&source=-----71b63e9825b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71b63e9825b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F71b63e9825b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----71b63e9825b7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----71b63e9825b7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----71b63e9825b7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----71b63e9825b7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----71b63e9825b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@PiyushMaheshwari1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@PiyushMaheshwari1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Piyush Maheshwari"}, {"url": "https://medium.com/@PiyushMaheshwari1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff77e3259fe28&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&user=Piyush+Maheshwari&userId=f77e3259fe28&source=post_page-f77e3259fe28--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ff77e3259fe28%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcar-classification-using-inception-v3-71b63e9825b7&user=Piyush+Maheshwari&userId=f77e3259fe28&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}