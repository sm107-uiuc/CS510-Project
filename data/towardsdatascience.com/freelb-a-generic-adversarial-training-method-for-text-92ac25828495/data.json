{"url": "https://towardsdatascience.com/freelb-a-generic-adversarial-training-method-for-text-92ac25828495", "time": 1683003816.122081, "path": "towardsdatascience.com/freelb-a-generic-adversarial-training-method-for-text-92ac25828495/", "webpage": {"metadata": {"title": "FreeLB: A Generic Adversarial Training method for Text | by Rohit Pillai | Towards Data Science", "h1": "FreeLB: A Generic Adversarial Training method for Text", "description": "In 2013, Szegedy et al. published \u201cIntriguing properties of neural networks\u201d. One of the big takeaways of this paper is that models can be fooled by adversarial examples. These are examples that\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1909.11764.pdf", "anchor_text": "link", "paragraph_index": 6}, {"url": "http://aka.ms/mmai", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://medium.com/@rohit.rameshp", "anchor_text": "https://medium.com/@rohit.rameshp", "paragraph_index": 8}], "all_paragraphs": ["In 2013, Szegedy et al. published \u201cIntriguing properties of neural networks\u201d. One of the big takeaways of this paper is that models can be fooled by adversarial examples. These are examples that contain some sort of perturbation which could be imperceptible to the human eye but can completely fool a model. This paper also found that adversarial examples were generalizable across models that were trained on different data, i.e. all these models were fooled by an example that had the same imperceptible perturbation.", "Goodfellow et al. published \u201cExplaining and Harnessing Adversarial Examples\u201d in 2014 as a follow up to this work to further analyze why adversarial examples are so generalizable and how to generate them. This gave rise to the concept of adversarial training, where models are trained using generated adversarial samples in addition to the training dataset to the end of making the model more robust and generalizable. Here\u2019s a caveat: robustness and generalizability are at odds in some domains (computer vision) while they\u2019re complements in others (NLP). Thus, adversarial training helps the model to be more robust and potentially more generalizable.", "Since Goodfellow\u2019s paper, adversarial training techniques have continued to become more elegant and effective thereby making models more robust to malicious examples. This new work from Microsoft Dynamics 365 AI Research proposes a novel adversarial training algorithm for the NLP domain, FreeLB (Free Large Batch), that promotes higher robustness and invariance in the embedding space, by adding adversarial perturbations to word embeddings and minimizing the resultant adversarial risk inside different regions around input samples. This is unlike previous work which added adversarial perturbations to the text input i.e., by adding random words/sentences, by misspelling words or by paraphrasing the text input into a completely different sentence structure. By adding perturbations on the embedding level, this method can introduce examples that wouldn\u2019t be possible to generate if we were simply modifying the input text.", "FreeLB leverages \u201cfree\u201d training strategies (Shafahi et al., 2019; Zhang et al. 2019) to enlarge each training batch size with diversified adversarial samples at no extra cost than the current state-of-the-art algorithm, Projected Gradient Descent (PGD). Specifically, PGD seeks to find a set of parameters to minimize the maximum risk for any r within a norm ball as:", "Where D is the data distribution, y is the label, and L is some loss function. Compared with PGD, which only uses the gradient of X+r output in the last step, FreeLB takes the average value of the gradient of r outputs per iteration, which is equivalent to treating the input as a virtual batch that is K times larger, [X+r1, X+r2, \u2026, X+rk]. The specific formula is:", "The team finetuned both BERT and RoBERTa language models using this FreeLB technique on several downstream tasks. When tested on the GLUE benchmark, the BERT test score increased from 78.3 to 79.4 while the RoBERTA-large model\u2019s score increased by 0.3 to 88.8. The finetuned RoBERTa-large is also able to achieve state-of-the-art performance on the ARC-Easy (85.44%) and ARC-Challenge (67.75%) benchmarks. Finally, experiments on the CommonsenseQA benchmark demonstrate that FreeLB can be generalized and boost the performance of RoBERTa-large model on other tasks as well.", "Here\u2019s a link to the FreeLB paper if you want to go into more detail about how FreeLB works and click here to see more publications and other work from the team.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m an engineer at Microsoft Dynamics 365 AI Research and I\u2019ll post our new NLP, CV and Multimodal research . Check out https://medium.com/@rohit.rameshp"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F92ac25828495&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----92ac25828495--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----92ac25828495--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://conversationalaiteam.medium.com/?source=post_page-----92ac25828495--------------------------------", "anchor_text": ""}, {"url": "https://conversationalaiteam.medium.com/?source=post_page-----92ac25828495--------------------------------", "anchor_text": "Rohit Pillai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7f2959a1653&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&user=Rohit+Pillai&userId=7f2959a1653&source=post_page-7f2959a1653----92ac25828495---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92ac25828495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92ac25828495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1909.11764.pdf", "anchor_text": "link"}, {"url": "http://aka.ms/mmai", "anchor_text": "here"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Szegedy%2C+C", "anchor_text": "Christian Szegedy"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Zaremba%2C+W", "anchor_text": "Wojciech Zaremba"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Sutskever%2C+I", "anchor_text": "Ilya Sutskever"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Bruna%2C+J", "anchor_text": "Joan Bruna"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Erhan%2C+D", "anchor_text": "Dumitru Erhan"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Goodfellow%2C+I", "anchor_text": "Ian Goodfellow"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Fergus%2C+R", "anchor_text": "Rob Fergus"}, {"url": "https://arxiv.org/search/stat?searchtype=author&query=Goodfellow%2C+I+J", "anchor_text": "Ian J. Goodfellow"}, {"url": "https://arxiv.org/search/stat?searchtype=author&query=Shlens%2C+J", "anchor_text": "Jonathon Shlens"}, {"url": "https://arxiv.org/search/stat?searchtype=author&query=Szegedy%2C+C", "anchor_text": "Christian Szegedy"}, {"url": "https://arxiv.org/search/stat?searchtype=author&query=Madry%2C+A", "anchor_text": "Aleksander Madry"}, {"url": "https://arxiv.org/search/stat?searchtype=author&query=Makelov%2C+A", "anchor_text": "Aleksandar Makelov"}, {"url": "https://arxiv.org/search/stat?searchtype=author&query=Schmidt%2C+L", "anchor_text": "Ludwig Schmidt"}, {"url": "https://arxiv.org/search/stat?searchtype=author&query=Tsipras%2C+D", "anchor_text": "Dimitris Tsipras"}, {"url": "https://arxiv.org/search/stat?searchtype=author&query=Vladu%2C+A", "anchor_text": "Adrian Vladu"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Cheng%2C+Y", "anchor_text": "Yu Cheng"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Gan%2C+Z", "anchor_text": "Zhe Gan"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Sun%2C+S", "anchor_text": "Siqi Sun"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Goldstein%2C+T", "anchor_text": "Tom Goldstein"}, {"url": "https://arxiv.org/search/cs?searchtype=author&query=Liu%2C+J", "anchor_text": "Jingjing Liu"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----92ac25828495---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----92ac25828495---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/adversarial-training?source=post_page-----92ac25828495---------------adversarial_training-----------------", "anchor_text": "Adversarial Training"}, {"url": "https://medium.com/tag/freelb?source=post_page-----92ac25828495---------------freelb-----------------", "anchor_text": "Freelb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F92ac25828495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&user=Rohit+Pillai&userId=7f2959a1653&source=-----92ac25828495---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F92ac25828495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&user=Rohit+Pillai&userId=7f2959a1653&source=-----92ac25828495---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92ac25828495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----92ac25828495--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F92ac25828495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----92ac25828495---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----92ac25828495--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----92ac25828495--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----92ac25828495--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----92ac25828495--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----92ac25828495--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----92ac25828495--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----92ac25828495--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----92ac25828495--------------------------------", "anchor_text": ""}, {"url": "https://conversationalaiteam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://conversationalaiteam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rohit Pillai"}, {"url": "https://conversationalaiteam.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "68 Followers"}, {"url": "https://medium.com/@rohit.rameshp", "anchor_text": "https://medium.com/@rohit.rameshp"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7f2959a1653&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&user=Rohit+Pillai&userId=7f2959a1653&source=post_page-7f2959a1653--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6630fb9ccb26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffreelb-a-generic-adversarial-training-method-for-text-92ac25828495&newsletterV3=7f2959a1653&newsletterV3Id=6630fb9ccb26&user=Rohit+Pillai&userId=7f2959a1653&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}