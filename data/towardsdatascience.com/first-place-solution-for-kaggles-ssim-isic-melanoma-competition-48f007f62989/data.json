{"url": "https://towardsdatascience.com/first-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989", "time": 1683018341.037387, "path": "towardsdatascience.com/first-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989/", "webpage": {"metadata": {"title": "1st place solution for Kaggle\u2019s skin cancer (Melanoma) Competition | by Mostafa Ibrahim | Towards Data Science", "h1": "1st place solution for Kaggle\u2019s skin cancer (Melanoma) Competition", "description": "5 months ago I participated in my first official kaggle competition, SSIM-ISIC Melanoma. Here is a brief overview of what the competition was about (from Kaggle): Personally, I feel very motivated\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification", "anchor_text": "SSIM-ISIC Melanoma", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Vanishing_gradient_problem", "anchor_text": "vanishing gradient problem.", "paragraph_index": 7}, {"url": "https://arxiv.org/abs/1905.11946", "anchor_text": "EfficientNet", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "CNN", "paragraph_index": 10}, {"url": "https://medium.com/@neuralnets/swish-activation-function-by-google-53e1ea86f820", "anchor_text": "Swish", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Batch_normalization", "anchor_text": "Batch Normalisation", "paragraph_index": 13}, {"url": "https://medium.com/@amarbudhiraja/https-medium-com-amarbudhiraja-learning-less-to-learn-better-dropout-in-deep-machine-learning-74334da4bfc5", "anchor_text": "Dropout", "paragraph_index": 13}], "all_paragraphs": ["5 months ago I participated in my first official kaggle competition, SSIM-ISIC Melanoma. Here is a brief overview of what the competition was about (from Kaggle):", "Skin cancer is the most prevalent type of cancer. Melanoma, specifically, is responsible for 75% of skin cancer deaths, despite being the least common skin cancer. The American Cancer Society estimates over 100,000 new melanoma cases will be diagnosed in 2020. It\u2019s also expected that almost 7,000 people will die from the disease. As with other cancers, early and accurate detection \u2014 potentially aided by data science \u2014 can make treatment more effective.", "Personally, I feel very motivated when working on something that I believe in. This feeling resonated with me throughout this competition as skin cancer ruins a lot of people\u2019s lives immensely. As someone who is passionate about machine learning and especially in healthcare this was super interesting for me. Since this was my first competition, most of what I was doing was learning rather than actually coding and therefore I ended up in the top 72%.", "This story will be mainly about my experience and the first place solution (which there is a lot to learn from).", "One of the quite difficult challenges of this competition is that the dataset was extremely unbalanced. The domain of the problem was binary classification for images. The distribution of the classes was 98% for class 1 and only 2% for class 2 ! For the sake of brevity and not duplicating content, I found this article quite helpful to tackle this issue :", "The rest of this story will be about tackling other challenges in this competition.", "In terms on the actual model, these 3 nets were extremely popular among all solutions and thus it made a lot of sense that the top solution would be using an ensemble of those 3. I won\u2019t dive into the details of how each of them works since there are tons of resources for that, but I will give an overview.", "One of the main challenges in modelling CNNs is scaling them up and determining their width and depth. These networks tackle those challenges in different ways. There are multiple issues that you will have to deal with if you just keep on increasing the number of layers (bruteforce solution!) like the vanishing gradient problem.", "Residual networks operate on the idea of \u201cresidual blocks\u201d which have identity skip connections. If you want to further understand this, check out this story:", "ResNext is just a variation of ResNet that adds a \u201csplit-transform-merge\u201d step where the outputs of different paths are merged by adding them together.", "EfficientNet is to me, the most impressive one. Probably because it has only been around for about 2 years. The main idea of EfficientNet is an efficient technique to scale up the CNN so that you get higher accuracy with a much lower number of parameters.", "To explain how this works is a bit out of the scope of this story, but you can probably get a sense of it if you are familiar with the different types of scaling:", "One of the lessons that I have learned from this competition is to use all of the data given, I was mostly focused on using the images and did not pay much attention to the metadata that was provided for each patient. The first place solution was using a concatenation of the CNNs outputs and the output of a fully connected network. This fully connected network was using an activation function called Swish, which is an upgrade of the classic ReLu.", "For this fully connected network, they were also using Batch Normalisation and Dropout, which are also typically used in a lot of networks.", "This is the final model pipeline:", "The CNN model block represents an ensemble of the 3 CNN models discussed above. Ensembling was also a new trick that I have learned that proved to be very effective. Not only does it give you better accuracy / results, but because the final competition rankings are evaluated on a small subset of the data, ensembling gives you a much better chances of surviving a \u201cshake down\u201d. A shake down is where your models overfit the training data and thus the final result is much worse so you end up with a worse rank.", "I also found it quite helpful to think about your machine learning solution as a pipeline and visualise it in this way. As a web developer, I am used to data architecture diagrams, however I never applied the same methodology of architecture in machine learning (which is a huge mistake).", "One of the main reasons that they managed to achieve the first place was that they were using a much bigger ensemble of networks and a bigger combination of data.", "To have stable validation, we used 2018+2019+2020\u2019s data for both train and validation. We track two cv scores, cv_all and cv_2020. The former is much more stable than the latter.", "Also a common trick to further increase the size of the dataset it to use data augmentation. They were using a very good mixture of simple data augmentation techniques and complex ones. As for the simple ones they were using vertical & horizontal flips, random brightness & contrast and resizing. For the complex ones, they were using Gaussian Blur / Gaussian Noise, Elastic transform and Grid distortion. There are others that you can pick up from their code:", "And finally, they were ranking the final prediction of the models to ensure that they were evenly distributed. One important point to note here is that data augmentation is becoming a very heavily used technique in almost all modern machine learning projects, I have seen this technique being used in a great amount of competitions and solutions.", "In terms of my model I was simply using a ResNext model with K-fold cross validation. I have learned the concept of ensembling, concatenating the results with metadata, the power of data augmentation and many other bits. And I think this is one of the main benefits of Kaggle competitions, they expose you to the awesome community and their solutions. Many thanks as well to the \u201cNotebooks\u201d section on the Kaggle competition where every one shares their solutions.", "A very good tip for beginner Kagglers is to always take a look at the top solutions, this is where you will experience a huge amount of learning. Compare it to your solution and evaluate the differences. My main takeaway was to not place all of my efforts on modelling, but rather focus on data engineering and preprocessing.", "Finally, don\u2019t use only one type of a CNN architecture, use several ones and ensemble, most of the time this will give you better results. I am not going to dive into the advantages of ensembling as this has been covered thoroughly, if you are interested you can check out this article:", "If you want to receive regular paper reviews about the latest papers in AI & Machine learning, add your email here & Subscribe!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Eng. University College London Computer Science Graduate. Passionate about Machine Learning in Healthcare. Top writer in AI"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F48f007f62989&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----48f007f62989--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----48f007f62989--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mostafaibrahim18.medium.com/?source=post_page-----48f007f62989--------------------------------", "anchor_text": ""}, {"url": "https://mostafaibrahim18.medium.com/?source=post_page-----48f007f62989--------------------------------", "anchor_text": "Mostafa Ibrahim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb1f214c06d3e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&user=Mostafa+Ibrahim&userId=b1f214c06d3e&source=post_page-b1f214c06d3e----48f007f62989---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48f007f62989&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48f007f62989&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@giorgiotrovato?utm_source=medium&utm_medium=referral", "anchor_text": "Giorgio Trovato"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification", "anchor_text": "SSIM-ISIC Melanoma"}, {"url": "https://towardsdatascience.com/methods-for-dealing-with-imbalanced-data-5b761be45a18", "anchor_text": "Methods for Dealing with Imbalanced DataImbalanced classes are a common problem in machine learning classification where there are a disproportionate ratio of\u2026towardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Vanishing_gradient_problem", "anchor_text": "vanishing gradient problem."}, {"url": "https://towardsdatascience.com/an-overview-of-resnet-and-its-variants-5281e2f56035", "anchor_text": "https://towardsdatascience.com/an-overview-of-resnet-and-its-variants-5281e2f56035"}, {"url": "https://towardsdatascience.com/an-overview-of-resnet-and-its-variants-5281e2f56035", "anchor_text": "https://towardsdatascience.com/an-overview-of-resnet-and-its-variants-5281e2f56035"}, {"url": "https://arxiv.org/abs/1905.11946", "anchor_text": "EfficientNet"}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "CNN"}, {"url": "https://arxiv.org/abs/1905.11946", "anchor_text": "EfficientNet Paper"}, {"url": "https://arxiv.org/abs/1905.11946", "anchor_text": "EfficientNet Paper"}, {"url": "https://medium.com/@neuralnets/swish-activation-function-by-google-53e1ea86f820", "anchor_text": "Swish"}, {"url": "https://en.wikipedia.org/wiki/Batch_normalization", "anchor_text": "Batch Normalisation"}, {"url": "https://medium.com/@amarbudhiraja/https-medium-com-amarbudhiraja-learning-less-to-learn-better-dropout-in-deep-machine-learning-74334da4bfc5", "anchor_text": "Dropout"}, {"url": "https://www.kaggle.com/c/siim-isic-melanoma-classification/discussion/175412", "anchor_text": "Kaggle"}, {"url": "https://github.com/haqishen/SIIM-ISIC-Melanoma-Classification-1st-Place-Solution", "anchor_text": "Github"}, {"url": "https://towardsdatascience.com/the-power-of-ensemble-methods-in-machine-learning-7ddd28d7d8e6", "anchor_text": "The Power of Ensemble Methods in Machine LearningHow to boost the performance with bagging and boostingtowardsdatascience.com"}, {"url": "https://artisanal-motivator-8249.ck.page/5524b8f934", "anchor_text": "https://artisanal-motivator-8249.ck.page/5524b8f934"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----48f007f62989---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----48f007f62989---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/cancer?source=post_page-----48f007f62989---------------cancer-----------------", "anchor_text": "Cancer"}, {"url": "https://medium.com/tag/technology?source=post_page-----48f007f62989---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----48f007f62989---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F48f007f62989&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&user=Mostafa+Ibrahim&userId=b1f214c06d3e&source=-----48f007f62989---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F48f007f62989&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&user=Mostafa+Ibrahim&userId=b1f214c06d3e&source=-----48f007f62989---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48f007f62989&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----48f007f62989--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F48f007f62989&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----48f007f62989---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----48f007f62989--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----48f007f62989--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----48f007f62989--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----48f007f62989--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----48f007f62989--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----48f007f62989--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----48f007f62989--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----48f007f62989--------------------------------", "anchor_text": ""}, {"url": "https://mostafaibrahim18.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mostafaibrahim18.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mostafa Ibrahim"}, {"url": "https://mostafaibrahim18.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb1f214c06d3e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&user=Mostafa+Ibrahim&userId=b1f214c06d3e&source=post_page-b1f214c06d3e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd376c1b5023a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffirst-place-solution-for-kaggles-ssim-isic-melanoma-competition-48f007f62989&newsletterV3=b1f214c06d3e&newsletterV3Id=d376c1b5023a&user=Mostafa+Ibrahim&userId=b1f214c06d3e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}