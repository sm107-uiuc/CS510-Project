{"url": "https://towardsdatascience.com/apache-flume-71ed475eee6d", "time": 1683007942.545467, "path": "towardsdatascience.com/apache-flume-71ed475eee6d/", "webpage": {"metadata": {"title": "Apache Flume. Trickle-feed unstructured data into\u2026 | by Prathamesh Nimkar | Towards Data Science", "h1": "Apache Flume", "description": "Trickle-feed unstructured data into HDFS using Apache Flume"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@prathamesh.nimkar/sqoop-359a42a66c40", "anchor_text": "Apache Sqoop", "paragraph_index": 0}, {"url": "https://medium.com/@prathamesh.nimkar/install-mysql-database-7d64f0207cf9", "anchor_text": "MySQL database", "paragraph_index": 0}, {"url": "https://medium.com/@prathamesh.nimkar/sqoop-commands-2793557839a5", "anchor_text": "push that data into HDFS and back", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/@bmedalen?source=responses-----71ed475eee6d----0------------------", "anchor_text": "Brett M", "paragraph_index": 31}, {"url": "https://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html", "anchor_text": "Apache Flume User Guide", "paragraph_index": 32}, {"url": "https://unsplash.com/@theforestbirds?utm_source=medium&utm_medium=referral", "anchor_text": "Joel & Jasmin F\u00f8restbird", "paragraph_index": 33}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash", "paragraph_index": 33}, {"url": "https://www.linkedin.com/in/prathameshnimkar/", "anchor_text": "https://www.linkedin.com/in/prathameshnimkar/", "paragraph_index": 35}], "all_paragraphs": ["We\u2019ve discussed how Apache Sqoop is used to extract structured data from our relational MySQL database (RDBMS) and how to push that data into HDFS and back.", "The question now is how do we get unstructured data into HDFS? We use Apache Kafka, no no no\u2026Flume. Apache Flume.", "Apache Flume is an open-source, powerful, reliable and flexible system used to collect, aggregate and move large amounts of unstructured data from multiple data sources into HDFS/Hbase (for example) in a distributed fashion via it\u2019s strong coupling with the Hadoop cluster.", "There are 3 main components to Flume\u2019s architecture, i.e. Source, Channel and Sink, in that order. Together these three form a \u201cFlume Agent\u201d.", "The \u201cSource\u201d is a component which extracts the unstructured data aka \u201cevent/s\u201d from one or more applications/clients. The extraction process can be event-driven or through frequent polling and is conducted by source-runners. \u201cSource Runners\u201d and \u201cSink Runners\u201d are the underlying invisible components of Flume that drive the source and sink, respectively. Runners can be thought of as wrappers that control the source or sink. Flume has built-in compatibility with several sources such as Avro, Thrift, Exec (/bin/sh -c for example), Spooling directory, Taildir, JMS, Syslog and many more.", "The \u201cChannel\u201d is a buffer between the source and the sink. The buffer\u2019s properties are based on the type of channel used, i.e. memory channel, file channel or JDBC channel (Kafka channel isn\u2019t built-in). The type of channel used is based upon a single factor, i.e. event reliability. For example, memory channel buffered events have higher performance but are also highly volatile and easily susceptible to failures. File channel has moderate performance and is moderately secure against failures and lastly, JDBC channel\u2019s performance is slowest but it provides the highest security against failures. So, we have to choose very carefully based on our use-case, but typically, File channels are used in Production to balance performance and reliability.A combination of memory channel and file channel aka Spillable Memory Channel is currently in the development phase (not recommended for Production) that would store events in-memory and on the file system after max memory capacity is reached, thus giving the reliability of the file channel and the performance of in-memory queuing (memory channel). Lastly, Flume follows a transactional approach and doesn\u2019t remove the event from the channel until it is moved into the sink and has received a confirmation from the subsequent sink runner. This is very important as some sinks maybe slower than sources in terms of processing speeds and can cause data corruption.", "The \u201cSink\u201d is the final dump of the data extracted or the destination of the sourced events. Typically, we use HDFS here, but other options are also available such as Hbase, Hive, Elasticsearch and many more.", "What\u2019s interesting is the ability to handle all of this via an agent configuration file and networking alone, no complex programming required.", "All theory and no practicals makes Jack a dull boy", "Optional prerequisite (Not for production systems)", "HDFS is a stickler for permissions. It doesn\u2019t consider the unix \u201croot\u201d user as it\u2019s super user, hence we simply disable permissions check to prevent unnecessary errors when running jobs on HDFS. While this is okay for our training environment, it is not okay for the Production environment, wherein, proper permissions would be allocated to each user.", "Navigate to HDFS service information in Cloudera Manager. Hit the configuration tab.", "Search for \u201cCheck HDFS Permissions\u201d and un-check the box in order to disable permissions on HDFS. Next, restart your cluster in order to push the changes in (mostly it would ask, if it doesn\u2019t, please do it).", "We have just 1 source, 1 channel and 1 sink. There are plenty of other options or combinations to choose from, which can be found in Apache Flume\u2019s User Guide (referenced below).", "Once you\u2019ve got this configuration file ready, load it into your instance-1 VM and execute the below command to start processing the file through Flume:", "After a few iterations, please quit the process using control+c. Let\u2019s understand the log file in depth:", "Even after stopping the flow with control+c, data is still getting loaded into the target sink. This is because of the channel, which is a buffer of data held in memory (in this case).", "Let\u2019s quickly check the contents of the taildir_position.json file under /var/log/flume-ng/", "Lastly, let\u2019s check the data, make sure to go to the smallest unit", "The most basic requirement for any large-scale logging system is it\u2019s ability to consolidate data or fan-in from multiple sources on-the-fly, and Flume provides this functionality as a default OOTB. In fact, I\u2019ve seen use-cases with over hundreds of clients pushing logs to several agents only to consolidate over several iterations. Basically, creating a chain of flume agents is allowed too.", "Does Flume support bifurcation of the flow? Well yes, and just as the image below displays:", "The fan-out feature hast two options, i.e. replicating and multiplexing. In replicating, for example, a source\u2019s event is copied across three channels and pushed downstream into three sinks. On the other hand, multiplexing is like filtering, for example, if event is of type \u201cError\u201d then push event to channel 1 and 3, else channel 2. Please note, this is also set in a configuration file.", "Filtering can be done with or without multiplexing using Interceptors. Let\u2019s quickly understand it with this beautiful gist:", "With this fan-out feature, fail-over and load balancing attributes are expected. Offcourse, with multiplexing, this is not possible as the events are \u201cfiltered\u201d, however, one could theoretically combine replication and multiplexing in their Flume flow to achieve the attributes.", "So for a replicated sink, the fail-over mechanism guarantees that so long as one sink is available, the events will be consumed. Any failed sink is dropped from the flow and sent back to the pool. Once the transaction is completed, only then can it be re-assigned, if it is functional. If there are multiple failed sinks, a priority is assigned to them and basis that, the higher priority sinks are re-assigned first, again if functional. The priority is assigned within the configuration file.", "Load-balancing mechanism allows the flow over multiple sinks. There are two mechanisms provided under load-balancing in Flume, namely, round-robin and random. Random scheduling is rarely used and infact custom schedulers are used if round-robin is not preferred.In general round-robin is used in Production and is the default for Flume, so it is imperative to understand how it works.", "Round-robin load-balancing provides a specific time slot or \u201cquantum\u201d to each event to be processed by the sink. If the event doesn\u2019t complete by then, it is paused and the next event is provided the same quantum and the cycle repeats until all events have executed. In the above image, you will see E0 is the first event that arrives at time 0 ms. It takes about 250 ms to execute completely. Our quantum is set at 100 ms, so E0 wouldn\u2019t complete. Next, at 50 ms E1 arrives, waits for 50 ms for resources to become available. At 100 ms, E0 is forced to stop and E1 executes. Here\u2019s how it looks:", "Let\u2019s have a quick look at one, shall we:", "Quick look at the same taildir_position.json file:", "So, everything seems all handy-dandy, and it is:", "I would be remiss, if I didn\u2019t mention the reasons why Flume is dying/dead:", "Update: Be sure to check Brett M\u2019s interesting comment below.", "[1] Apache Flume User Guide, Apache Flume, ASF", "[2] Unstructured Log \u2014 Photo by Joel & Jasmin F\u00f8restbird on Unsplash", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech Enthusiast \u2014 Data Engineering | Data Analytics | LinkedIN: https://www.linkedin.com/in/prathameshnimkar/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F71ed475eee6d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@prathamesh.nimkar?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prathamesh.nimkar?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": "Prathamesh Nimkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6f0e324a756e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=post_page-6f0e324a756e----71ed475eee6d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71ed475eee6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71ed475eee6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@theforestbirds?utm_source=medium&utm_medium=referral", "anchor_text": "Joel & Jasmin F\u00f8restbird"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@prathamesh.nimkar/sqoop-359a42a66c40", "anchor_text": "Apache Sqoop"}, {"url": "https://medium.com/@prathamesh.nimkar/install-mysql-database-7d64f0207cf9", "anchor_text": "MySQL database"}, {"url": "https://medium.com/@prathamesh.nimkar/sqoop-commands-2793557839a5", "anchor_text": "push that data into HDFS and back"}, {"url": "https://unsplash.com/@magpole?utm_source=medium&utm_medium=referral", "anchor_text": "Mag Pole"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Round-robin_scheduling", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Round-robin_scheduling", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/@bmedalen?source=responses-----71ed475eee6d----0------------------", "anchor_text": "Brett M"}, {"url": "https://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html", "anchor_text": "Apache Flume User Guide"}, {"url": "https://unsplash.com/@theforestbirds?utm_source=medium&utm_medium=referral", "anchor_text": "Joel & Jasmin F\u00f8restbird"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Round-robin_scheduling", "anchor_text": "Round-robin scheduling"}, {"url": "https://towardsdatascience.com/apache-sqoop-1113ce453639", "anchor_text": "Apache SqoopRDBMS to HDFS and backtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/apache-yarn-zookeeper-61e17a958215", "anchor_text": "Apache YARN & ZookeeperAll about Resource Allocation and High Availabilitytowardsdatascience.com"}, {"url": "https://medium.com/@prathamesh.nimkar/big-data-analytics-using-the-hadoop-ecosystem-411d629084d3", "anchor_text": "Big Data Analytics Pipeline using the Hadoop EcosystemLanding Pagemedium.com"}, {"url": "https://medium.com/tag/big-data?source=post_page-----71ed475eee6d---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/data-science?source=post_page-----71ed475eee6d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/apache?source=post_page-----71ed475eee6d---------------apache-----------------", "anchor_text": "Apache"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----71ed475eee6d---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F71ed475eee6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=-----71ed475eee6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F71ed475eee6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=-----71ed475eee6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F71ed475eee6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F71ed475eee6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----71ed475eee6d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----71ed475eee6d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----71ed475eee6d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----71ed475eee6d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----71ed475eee6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prathamesh.nimkar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prathamesh.nimkar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Prathamesh Nimkar"}, {"url": "https://medium.com/@prathamesh.nimkar/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "186 Followers"}, {"url": "https://www.linkedin.com/in/prathameshnimkar/", "anchor_text": "https://www.linkedin.com/in/prathameshnimkar/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6f0e324a756e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=post_page-6f0e324a756e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4018850c89c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fapache-flume-71ed475eee6d&newsletterV3=6f0e324a756e&newsletterV3Id=4018850c89c8&user=Prathamesh+Nimkar&userId=6f0e324a756e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}