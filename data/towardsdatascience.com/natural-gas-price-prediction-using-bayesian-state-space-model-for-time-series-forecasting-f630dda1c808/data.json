{"url": "https://towardsdatascience.com/natural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808", "time": 1682993017.461544, "path": "towardsdatascience.com/natural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808/", "webpage": {"metadata": {"title": "Prediction using Bayesian State Space Model | by Sarit Maitra | Towards Data Science", "h1": "Prediction using Bayesian State Space Model", "description": "Time series observations are assumed to depend linearly on a state vector that is unobserved and is generated by a stochastic and dynamic process in a state space analysis. The observations are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.jstatsoft.org/article/view/v041i04", "anchor_text": "here", "paragraph_index": 33}], "all_paragraphs": ["Time series observations are assumed to depend linearly on a state vector that is unobserved and is generated by a stochastic and dynamic process in a state space analysis. The observations are further assumed to be subject to measurement error and independent of the state vector. Therefore, two main components which make up state space models are an observed data and the unobserved states.", "A time-series is described probabilistic by a stochastic process (Yt; t = 1, 2, . . .), that is, by an ordered sequence of random vectors with the index t (time). For simplicity, we will think of equally spaced time points (daily data, monthly data, and so on). The target is to make forecasts about the value of the next observation [yn+1 having observed data up to time n, (y1 = y1, . . . , yn)].", "This series looks clearly non-stationary and in fact quite irregular and volatile. The data is on daily level since 2007 till date. We can see that, price drooped significantly from nearly $20 to close to $1 during 2008/2009, before being going up till around $15 during 2010/2011; however, a highly volatile state since can be seen all across as on date and last price recorded as $8.61.", "We will do a uni-variate analysis; so, let us extract the monthly \u201cClose\u201d prices from the data-set. Monthly data was taken for computational ease. Depending on available computational power, data can be taken on hourly, daily or weekly as well.", "Following data processing are important to convert the data to data-frame and further time -series for future analysis.", "Here, our data-set is now processed and we are ready to perform further analysis.", "Most statistical models rely on a normal distribution, a distribution that is symmetric and has a characteristic bell shape. Probability distributions are usually (not entirely) represented in charts whose abscissa axis represents the possible values of the variable and whose ordinal axis represents the probability of occurrence.", "The distribution plot comprising density and normal Q-Q plot above clearly shows that data distribution is not normal and reflects non-Gaussian characteristics.", "Output from the above stationarity tests show non-stationary characteristics of data.", "We normalize the data in the stock prediction scenario because of the values of random behavior. Here, min-max normalization is not advised because the stock values are not limited to a certain price range; the prices having brownian motion and can change dramatically. Therefore, advisable to normalize the stock prices with elementary standardization function:", "Therefore, it can be concluded that the ACF signal is stationary. But, the trend signal is not stationary. The stationary series has a better variance around the mean level, and the peaks are evidence of the interventions in the original series. We will further decompose the time series which involves a combination of level, trend, seasonality, and noise components. Decomposition helps to provide a better understanding of problems during analysis and forecasting.", "Decomposing a time series means separating it into its constituent components, which are often a trend component and a random component, and if the data is seasonal, a seasonal component.", "Non-seasonal time series consist of a trend component and a random component. Decomposing the time series involves tying to separate the time series into these individual components. A seasonal time series, in addition to the trend and random components, also has a seasonal component. Decomposing a seasonal time series means separating the time series into these three components. Let's estimate the trend, seasonal, and random components of the Natural Gas TS.", "The above plot clearly shows that trend is non-stationary which we can see from the trend signal plot in the normalization section. The seasonal component exists for a brief period of time every year most likely during the winter session. Overall, the price is highly volatile with random walk movement.", "Unfortunately, there is no universally accepted notation for state space models. However, the most commonly used notations in statistical and econometric applications can be found in the work of Harrison & Stevens (1976) and West & Harrison (1997). The main focus is on Bayesian analysis is maximum likelihood (ML) estimation of unknown parameter. We will start with a local level model to introduce the methodology.", "We will develop the prediction with a Base Level Model followed by ARIMA and Dynamic Linear Model to compare the prediction output.", "State-space models are based on the idea that the time series (Yt) is an incomplete and noisy function of some underlying un-observable process (\u03b8t, t = 1, 2, . . .), called the state process.", "A structural approach to time-series analysis is facilitated by the state space framework. In this approach, different unobserved components responsible for the dynamics of the series. These are trend, seasonal, cycle, and the effects of explanatory and intervention variables are identified separately before being put together in a state space model. Let us understand the mathematical intuition for local level model.", "A time series is normally considered a set of observation y1,\u2026\u2026, yn ordered in time. Here, the base model for representing the time series is additive model. The formula can be written as:", "To develop suitable models and \u03bct and \u03d2t, we need the concept of random walk. We can consider a simple form of model in which \u03bct = \u03b1t, where \u03b1t is random walk, no seasonal is present and all random variables are normally distributed. We assume that \u03b5t has constant variance \u03c32\u03b5. This gives the model:", "for t = 1,\u2026..,n, where \u03b5t\u2019s and \u03b7t\u2019s are mutually independent and independent on \u03b11. There are two parameters, and \u03c32\u03b7. It is an ARIMA(0,1,1) model, but with restrictions on the parameter set. This is called local level model and provides the basis for our analysis. It exhibits the characteristics structure of state space models where there is a series of unobserved values \u03b11,\u2026.,\u03b1n, which are states and represents the development over time of the system under study together with a set of observations y1,\u2026.,yn, which are related to the \u03b1t\u2019s by the state space model. This is suitable for both Classical and Bayesian analysis. Where \u03b5t\u2019s and \u03b7t\u2019s are not normally distributed we obtain equivalent results from the standpoint of minimum variance linear unbiased estimation.", "Initially we assume that, \u03b11 ~ N(\u03b11, P1), where \u03b11 and P1 are known and that \u03c32\u03b5 and \u03c32\u03b7 are known. Since, random walk are non-stationary, the model is non-stationary and the distribution of random variables yt and \u03b1t depend on time t.", "The local linear trend model, type = \u201ctrend\u201d, has the same measurement equation, but with a time-varying slope in the dynamics. The basic structural model, type = \u201cBSM\u201d, is a local trend model with an additional seasonal component.", "All significance tests in linear Gaussian state space models \u2014 and the construction of confidence intervals \u2014 are based on assumptions concerning the residuals of the analysis. The residuals should satisfy independence, homoscedasticity, and normality. The independence and normality of the residuals can be diagnosed using the Box-Ljung test statistic. Homoscedasticity can be checked by testing the variance of the standardized prediction errors.", "Below plot shows the predicted Close price data for 12 months, together with 50% and 90% probability intervals.", "Auto-regressive integrated moving average (ARIMA) model can be put into state space form.", "In auto arima is able to decide whether to use or not a seasonal arima (SARIMA) model.", "We can see from the first and last graphs that, the residuals don\u2019t appear to be white noise. The ACF plot shows no significant correlation exists among the residuals.", "This prediction is similar to structural time series. However, we will check further Dynamic Linear Model in below section.", "Dynamic linear models are a special case of state space models where the errors of the state and observed components are normally distributed. DLM can be specified by means of two equations", "here, Gt and Ft are known matrices and the (vt) & (wt) are two independent white noise sequences (i.e., they are independent, both between them and within each of them), with mean zero and known co-variance matrices Vt and Wt respectively.", "The general state space model for a uni-variate time series (Yt, t = 1, 2, . . .) is the so-called random walk plus noise model, defined by:", "with arbitrary functions gt and ht which is more flexible. The error sequences (vt) and (wt) are independent. The linear state space models specify gt and ht as linear functions, and Gaussian linear models add the assumptions of Gaussian distributions.", "A polynomial DLM (a local level model is a polynomial DLM of order 1) , a local linear trend is a polynomial DLM of order 2). You may find more details of dlm model here.", "The arguments dV and dW are used to specify the diagonal of the observation and evolution covariance matrices respectively.", "The main purpose of the Kalman filter is to obtain optimal estimates of the state at time point t, only considering the observations {y1, y2, . . . , yt\u22121}. The key property of the predicted state and its related estimates is therefore that they are only based on the historical values of the series. The objective of filtering is to update our knowledge of the system each time a new observation yt is brought in.", "The Kalman smoother allows to compute the densities of \u03b8t|DT , starting from t = T\u22121, in which case \u03b8T|DT ~ N(sT = mT , ST = CT ), and then proceeding backward for computing the densities of \u03b8t|DT for t = T\u22122, t = T\u22123, etc.", "Here, we can see from the above plot that, the model has been able capture the trend quite well. Filtered and smoothed lines are moving together in the series and do not differ much from each other. The lines of forecast series for next 12 months has been picked up from where the original series ends", "If we compare the three predicted results, we find that, DLM model has been able to capture the trend better than other two.", "Similar approach can be applied to analyze and forecast for both uni-variate and multi-variate time-series. Here, the structural time series computes the maximum likelihood estimates of the variance parameters and the filtered means of the state vectors for a basic structural model, i.e., a constant DLM consisting of a random walk plus noise, a local linear trend. we have used the same data-set in all three models to maintain consistency. Interestingly ARIMA & Structural Models are not been able to pick up on the seasonal component like the dlm model. We have not considered the seasonal component in case of dlm modeling. However, the seasonal component can also be added for better prediction.", "DLM is quite an interesting package and I would like to further use it for multi-variate analysis in future.", "Notice: The programs described here are experimental and should be used with caution. All such use at your own risk.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics & Data Science Practice Lead"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff630dda1c808&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f630dda1c808--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f630dda1c808--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----f630dda1c808--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----f630dda1c808--------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8----f630dda1c808---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff630dda1c808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff630dda1c808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.jstatsoft.org/article/view/v041i04", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/saritmaitra/", "anchor_text": "here"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----f630dda1c808---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f630dda1c808---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistical-modeling?source=post_page-----f630dda1c808---------------statistical_modeling-----------------", "anchor_text": "Statistical Modeling"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff630dda1c808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&user=Sarit+Maitra&userId=c611876588a8&source=-----f630dda1c808---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff630dda1c808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&user=Sarit+Maitra&userId=c611876588a8&source=-----f630dda1c808---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff630dda1c808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f630dda1c808--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff630dda1c808&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f630dda1c808---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f630dda1c808--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f630dda1c808--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f630dda1c808--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f630dda1c808--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f630dda1c808--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f630dda1c808--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f630dda1c808--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f630dda1c808--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://sarit-maitra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba440ad8d04d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-gas-price-prediction-using-bayesian-state-space-model-for-time-series-forecasting-f630dda1c808&newsletterV3=c611876588a8&newsletterV3Id=ba440ad8d04d&user=Sarit+Maitra&userId=c611876588a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}