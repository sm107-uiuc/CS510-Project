{"url": "https://towardsdatascience.com/deep-learning-for-image-classification-on-mobile-devices-f93efac860fd", "time": 1683006122.7448142, "path": "towardsdatascience.com/deep-learning-for-image-classification-on-mobile-devices-f93efac860fd/", "webpage": {"metadata": {"title": "Deep Learning for Image Classification on Mobile Devices | by Yuefeng Zhang, PhD | Towards Data Science", "h1": "Deep Learning for Image Classification on Mobile Devices", "description": "React is a popular JavaScript framework for building Web user interfaces. Reactive Native inherits and extends the component framework (e.g., component, props, state, JSX, etc.) of React to support\u2026"}, "outgoing_paragraph_urls": [{"url": "https://reactjs.org/docs/introducing-jsx.html", "anchor_text": "React", "paragraph_index": 0}, {"url": "https://reactnative.dev/docs/getting-started", "anchor_text": "Reactive Native", "paragraph_index": 0}, {"url": "https://reactjs.org/docs/introducing-jsx.html", "anchor_text": "JSX", "paragraph_index": 0}, {"url": "https://docs.expo.io/versions/v37.0.0/", "anchor_text": "Expo", "paragraph_index": 1}, {"url": "https://blog.tensorflow.org/2020/02/tensorflowjs-for-react-native-is-here.html", "anchor_text": "TensorFlow.js for React Native", "paragraph_index": 2}, {"url": "https://github.com/amandeepmittal/mobilenet-tfjs-expo/blob/master/assets/tfjs.jpg", "anchor_text": "tfjs.jpg", "paragraph_index": 9}, {"url": "https://www.npmjs.com/package/expo-camera", "anchor_text": "expo-camera", "paragraph_index": 12}, {"url": "http://twitter.com/tensorflow/tfjs-react-native", "anchor_text": "@tensorflow/tfjs-react-native", "paragraph_index": 12}, {"url": "https://reactjs.org/docs/introducing-jsx.html", "anchor_text": "React JSX", "paragraph_index": 30}], "all_paragraphs": ["React is a popular JavaScript framework for building Web user interfaces. Reactive Native inherits and extends the component framework (e.g., component, props, state, JSX, etc.) of React to support the development of native Android and iOS applications using pre-built native components such as View, Text, TouchableOpacity, etc. The native code is typically developed using Xcode or Android Studio.", "Expo is a framework and platform built around React Native and mobile native platforms that allow us to develop, build, and deploy mobile applications on iOS, Android, and web apps from the same JavaScript/TypeScript codebase. The JavaScript/TypeScript code can be developed using any text editor tool.", "With the announcement of TensorFlow.js for React Native, it is now possible to train new machine learning and deep learning models and/or use pre-trained models for prediction and other machine learning purposes on mobile devices.", "In this article, similarly to [3], I use Expo [4] with React Native [5] to develop a multi-page mobile application that uses TensorFlow.js [1] and a pre-trained convolutional neural network model MobileNet [2] for image classification on mobile devices.", "This mobile application is developed on Mac as follows:", "In order to use Expo CLI to generate a new project template automatically, first the Expo CLI needs to be installed:", "Then a new Expo project template can be generated as follows:", "The project name is react-native-deeplearning in this article.", "As shown below, I choose the tabs template of Expo managed workflow to automatically generate several example screens and navigation tabs.", "The TensorFlow logo image file tfjs.jpg [3] is used in this project and it needs to be stored in the generated ./asserts/images directory.", "The following libraries need to be installed for the image classification app on mobile devices:", "In addition, the react-native-fs (a native filesystem access for react-native) is required by @tensorflow/tfjs-react-native/dist/bundle_resource_io.js:", "The expo-camera (a React component that renders a preview for the device\u2019s either front or back camera) is needed as well since it is used in @tensorflow/tfjs-react-native/dist/camera/camera_stream.js.", "As described before, as a start, first I used Expo CLI to generate example screens and navigation tabs automatically. Then I modified the generated screens and added a new screen for image classification. As a result (see next section for details), I created three screens:", "There are three corresponding tabs at the bottom of screen for navigation purpose.", "This article focuses on the image classification screen class (see [7] for source code). The rest of this section discusses the implementation details.", "The lifecycle method componentDidMount() is used to initialize TensorFlow.js, load the pre-trained MobileNet model, and get permission for accessing camera on mobile device after the user interface of the image classification screen is ready.", "Once the TensorFlow library and MobileNet model are ready, the method selectImage() is called for choosing an image on mobile device for model prediction.", "Similarly to [3], once an image has been chosen on mobile device, the classifyImage() method is called for image classification.", "In this method, first the fetch API for TensorFlow React Native is used to load the selected image on mobile device. Then the method imageToTensor() is called to convert the loaded raw image data into a 3D image tensor. Finally the prepared MobileNet model is called to take the 3D image tensor as input and generates top 3 predictions with probabilities/confidences.", "Note that there are two versions of fetch API, one is React fetch API and the other is a fetch API for TensorFlow React Native.", "It is important to be sure to import the correct fetch API for TensorFlow React Native as follows to avoid error like \u201cfilereader.readasarraybuffer is not implemented in react native\u201d:", "Once the image classification is done, the method renderPrediction() is called to display the prediction results on the screen of mobile device.", "The mobile application in this article consists of a react native application server and one or more mobile clients. A mobile client can be an iOS simulator, Android emulator, iOS devices (e.g., iPhone and iPad), Android devices, etc. I verified the mobile application server on Mac and mobile clients on both iPhone 6+ and iPad.", "The mobile app server needs to start before any mobile client begins to run. The following commands can be used to compile and run the react native application server:", "If everything goes through smoothly, a Web interface as shown in Figure 1 should show up.", "Once the mobile app server is running, we can start mobile clients on mobile devices.", "Since I use Expo [4] for development in this article, the corresponding Expo client/app is needed on mobile devices. The Expo app for iOS mobile devices is available in Apple Store.", "Once the Expo client app has been installed on an iOS device, then we can use the camera on the mobile device to scan the bar code of the react native application server (see Figure 1) to use the Expo client app to run the mobile application.", "Figures 3, 4, 5 show the resulting screens of the mobile application on iOS devices (iPhone and iPad).", "In this article, I developed a multi-page mobile application for image classification on mobile devices using Expo [4], React JSX, React Native [5], TensorFlow.js [1], and a pre-trained convolutional neural network model MobileNet [2].", "I verified the mobile application server on Mac and the mobile application clients on iOS mobile devices (both iPhone and iPad).", "This mobile app can potentially be used as a template for the development of other machine learning and deep learning mobile apps.", "The mobile application project files are available in Github [7].", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist at Wavicle Data Solutions, He was a Senior Data Scientist at SMS Assist, a Senior Data Engineer at Capital One, and a DMTS at Motorola"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff93efac860fd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f93efac860fd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f93efac860fd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zhangyuefeng1?source=post_page-----f93efac860fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=post_page-----f93efac860fd--------------------------------", "anchor_text": "Yuefeng Zhang, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80e8f2faf4bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=post_page-80e8f2faf4bc----f93efac860fd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff93efac860fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff93efac860fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://reactjs.org/docs/introducing-jsx.html", "anchor_text": "React"}, {"url": "https://reactnative.dev/docs/getting-started", "anchor_text": "Reactive Native"}, {"url": "https://reactjs.org/docs/introducing-jsx.html", "anchor_text": "JSX"}, {"url": "https://docs.expo.io/versions/v37.0.0/", "anchor_text": "Expo"}, {"url": "https://blog.tensorflow.org/2020/02/tensorflowjs-for-react-native-is-here.html", "anchor_text": "TensorFlow.js for React Native"}, {"url": "https://reactjs.org/docs/introducing-jsx.html", "anchor_text": "React JSX"}, {"url": "https://github.com/amandeepmittal/mobilenet-tfjs-expo/blob/master/assets/tfjs.jpg", "anchor_text": "tfjs.jpg"}, {"url": "http://twitter.com/tensorflow/tfjs", "anchor_text": "@tensorflow/tfjs"}, {"url": "http://twitter.com/tensorflow/tfjs-react-native", "anchor_text": "@tensorflow/tfjs-react-native"}, {"url": "https://github.com/react-native-community/async-storage", "anchor_text": "@react-native-community/async-storage"}, {"url": "https://github.com/tensorflow/tfjs-models/tree/master/mobilenet", "anchor_text": "@tensorflow-models/mobilenet"}, {"url": "https://docs.expo.io/versions/latest/sdk/gl-view/", "anchor_text": "expo-gl"}, {"url": "https://en.wikipedia.org/wiki/OpenGL_ES", "anchor_text": "OpenGL ES"}, {"url": "https://www.npmjs.com/package/jpeg-js", "anchor_text": "jpeg-js"}, {"url": "http://twitter.com/react", "anchor_text": "@react"}, {"url": "http://twitter.com/tensorflow/tfjs", "anchor_text": "@tensorflow/tfjs"}, {"url": "http://twitter.com/tensorflow/tfjs-react-native", "anchor_text": "@tensorflow/tfjs-react-native"}, {"url": "http://twitter.com/tensorflow", "anchor_text": "@tensorflow"}, {"url": "https://www.npmjs.com/package/expo-camera", "anchor_text": "expo-camera"}, {"url": "http://twitter.com/tensorflow/tfjs-react-native", "anchor_text": "@tensorflow/tfjs-react-native"}, {"url": "http://twitter.com/tensorflow/tfjs-react-native", "anchor_text": "@tensorflow/tfjs-react-native"}, {"url": "https://reactjs.org/docs/introducing-jsx.html", "anchor_text": "React JSX"}, {"url": "https://blog.tensorflow.org/2020/02/tensorflowjs-for-react-native-is-here.html", "anchor_text": "TensorFlow.js for React Native"}, {"url": "https://github.com/tensorflow/tfjs-models/tree/master/mobilenet", "anchor_text": "MobileNet"}, {"url": "https://heartbeat.fritz.ai/image-classification-on-react-native-with-tensorflow-js-and-mobilenet-48a39185717c", "anchor_text": "Image Classification on React Native with TensorFlow.js and MobileNet"}, {"url": "https://docs.expo.io/versions/v37.0.0/", "anchor_text": "Expo"}, {"url": "https://reactnative.dev/docs/getting-started", "anchor_text": "React Native"}, {"url": "https://reactjs.org/docs/getting-started.html", "anchor_text": "React"}, {"url": "https://github.com/yzzhang/machine-learning/tree/master/mobile_apps/image_classification", "anchor_text": "Github"}, {"url": "https://medium.com/tag/tensorflowjs?source=post_page-----f93efac860fd---------------tensorflowjs-----------------", "anchor_text": "Tensorflowjs"}, {"url": "https://medium.com/tag/mobilenet?source=post_page-----f93efac860fd---------------mobilenet-----------------", "anchor_text": "Mobilenet"}, {"url": "https://medium.com/tag/expo?source=post_page-----f93efac860fd---------------expo-----------------", "anchor_text": "Expo"}, {"url": "https://medium.com/tag/react?source=post_page-----f93efac860fd---------------react-----------------", "anchor_text": "React"}, {"url": "https://medium.com/tag/react-native?source=post_page-----f93efac860fd---------------react_native-----------------", "anchor_text": "React Native"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff93efac860fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=-----f93efac860fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff93efac860fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=-----f93efac860fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff93efac860fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f93efac860fd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff93efac860fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f93efac860fd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f93efac860fd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f93efac860fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f93efac860fd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f93efac860fd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f93efac860fd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f93efac860fd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f93efac860fd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f93efac860fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yuefeng Zhang, PhD"}, {"url": "https://medium.com/@zhangyuefeng1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "293 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80e8f2faf4bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=post_page-80e8f2faf4bc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F84632d34eae6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-image-classification-on-mobile-devices-f93efac860fd&newsletterV3=80e8f2faf4bc&newsletterV3Id=84632d34eae6&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}