{"url": "https://towardsdatascience.com/web-scraping-apartment-listings-in-stockholm-3fcebacf8be6", "time": 1682994374.8760169, "path": "towardsdatascience.com/web-scraping-apartment-listings-in-stockholm-3fcebacf8be6/", "webpage": {"metadata": {"title": "Web Scraping Apartment Listings in Stockholm | by Christopher Furu | Towards Data Science", "h1": "Web Scraping Apartment Listings in Stockholm", "description": "Me and by partner have sold our apartment and are in search of a new one. Since the majority of people, searching for a new apartment, manually go through https://www.hemnet.se/ which to me seems\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.hemnet.se/", "anchor_text": "https://www.hemnet.se/", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/christopher-furu-402b33a4/", "anchor_text": "linkedin", "paragraph_index": 23}], "all_paragraphs": ["Me and by partner have sold our apartment and are in search of a new one. Since the majority of people, searching for a new apartment, manually go through https://www.hemnet.se/ which to me seems tedious and exhausting. So I thought \u2014 why not use my Python knowledge to programatically find the most suitable apartments? So that is what I did, I built a very simple web scraper in order to find objects that are up for sale.", "Down below follows a pair of functions that handles HTML-objects via the library BeautifulSoup. Please keep in mind that these functions can be written in a more professional and optimal way but the scope of this project was indeed to get a hold of the data fast, in order to close an \u201coptimal\u201d apartment deal.", "First we need to handle the BeautifulSoup object which we do in a standard Python function that I have chose to name \u201cBooli_ScrapeObjects\u201d. The function take two input arguments (page and object_info) where page is the URL and object_info is a Pandas Data Frame that is suppose to store all the interesting information for each object. The function works on the premise that the HTML-object of the website stays static. The function follows:", "The above function scrapes objects that can be found on the given page. If the number of objects found are > 38 the objects are split into multiple pages (see picture to the left). This problem is solved in the function stated below, which takes the same URL argument in order to calculate how many pages we have, based on the premise that each page contains at most 38 objects.", "Having the two above functions we can write a new function that loops through each URL and stores the information in a Pandas Data Frame. The function follows:", "In order to store the Pandas Data Frame in a regular Microsoft SQL Server Database we need to clean the data. For example we would like two rewrite objects that have 1\u00bd rooms to 1.5 and so on. A simple function that performs this simple cleaning process can be found below:", "Finally we have all the data in a structured format - so now it\u2019s time to store it in a convenient way, namely, in a database. We have all the data stored in a Pandas Data Frame that looks like this:", "So we need to construct a database table that can store each column. This can easily be done via the following SQL-code (given that you use MS SQL server - though the syntax is similair for other databases):", "Now lets write a simple function that can connect to my local \u201con-prem\u201d database using the pyodbc-package. The function follows:", "Using this function combined with a query that inserts data by row we finally reach our goal (the query could preferably be written using a simple merge statement):", "Now we can obtain the result by simply talking to the database via a simple select-query:", "It is easy to adjust the code in order to scrape sold objects instead of objects up for sale, I wont go over how to do it but instead I will show some simple visualization of scraped data from sold objects. First of we start by calling the database with a SQL-query in order to obtain the data. The resulting data will be stored in a Pandas Data Frame by the name \u201cdata\u201d. The Python code for fetching the data looks like this:", "Further we split the rent cost into different price sections by using the inbuilt pandas function \u201ccut\u201d:", "Now we can plot the data in order to get a understanding of how the price varies between rent categories over time", "As the intuition tells you \u2014 the lower the rent the higher the price. Now lets take a closer look on how the prices differ between regions in Stockholm", "For those of you that live in Stockholm the result, probably, wont come as a surprise that \u00d6stermalm has the highest mean sell price and is far above the overall mean.", "Now lets have a look at the distribution for each regions [price/m\u00b2] with their respective mean", "and further the distribution of [price/m\u00b2], for the whole sample:", "Lastly we take a look at the mean [price/m\u00b2] for each region and number of rooms for the objects.", "as mentioned before, the sample lacks data for apartments in the upper \u201c# rooms\u201d-range and therefor the mean is not representative for actual market price. Just to make my point clear lets count objects per region and \u201c#rooms\u201d", "as the plot shows \u2014 in the best of worlds maby we can say that \u201c#rooms\u201d = 1,2,3 and 4 have a representative mean where as the mean for \u201c#rooms\u201d > 4 have a highly distorted mean due to few data points.", "First of the Python-code can, most surely, be written more efficiently but as pointed out the purpose of this project was not to write production ready code for scraping aparments, this was just a one-off project for a specific purpose. With that said one clear optimization for the scraping part would be to search for multiple areas instead of one.", "One could implement a simple regression model with response variable, Y, of \u201cprice per squared meter\u201d to find out the contribution of each independent variable X. The model could also be used as a price estimator given a set of values for the independent variables.", "Thank you for reading. If you have any questions please contact me via cfuru@kth.se and please feel free to add me at linkedin.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3fcebacf8be6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@christopher.furu?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christopher.furu?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": "Christopher Furu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe657a4e0ab59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&user=Christopher+Furu&userId=e657a4e0ab59&source=post_page-e657a4e0ab59----3fcebacf8be6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3fcebacf8be6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3fcebacf8be6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.hemnet.se/", "anchor_text": "https://www.hemnet.se/"}, {"url": "https://unsplash.com/@gavlak?utm_source=medium&utm_medium=referral", "anchor_text": "Adam Gavl\u00e1k"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/p/3fcebacf8be6#935a", "anchor_text": "The web scraping part"}, {"url": "https://medium.com/p/3fcebacf8be6#7798", "anchor_text": "Scraping functions"}, {"url": "https://medium.com/p/3fcebacf8be6#f7a6", "anchor_text": "The database storing part"}, {"url": "https://medium.com/p/3fcebacf8be6#beba", "anchor_text": "Visualizing data from sold objects"}, {"url": "https://medium.com/p/3fcebacf8be6#9709", "anchor_text": "Remarks"}, {"url": "https://medium.com/p/3fcebacf8be6#8932", "anchor_text": "Further work"}, {"url": "https://www.linkedin.com/in/christopher-furu-402b33a4/", "anchor_text": "linkedin"}, {"url": "https://medium.com/tag/sql?source=post_page-----3fcebacf8be6---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3fcebacf8be6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----3fcebacf8be6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/beautifulsoup?source=post_page-----3fcebacf8be6---------------beautifulsoup-----------------", "anchor_text": "Beautifulsoup"}, {"url": "https://medium.com/tag/web-scraping?source=post_page-----3fcebacf8be6---------------web_scraping-----------------", "anchor_text": "Web Scraping"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3fcebacf8be6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&user=Christopher+Furu&userId=e657a4e0ab59&source=-----3fcebacf8be6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3fcebacf8be6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&user=Christopher+Furu&userId=e657a4e0ab59&source=-----3fcebacf8be6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3fcebacf8be6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3fcebacf8be6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3fcebacf8be6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3fcebacf8be6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christopher.furu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christopher.furu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christopher Furu"}, {"url": "https://medium.com/@christopher.furu/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "23 Followers"}, {"url": "http://M.Sc", "anchor_text": "M.Sc"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe657a4e0ab59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&user=Christopher+Furu&userId=e657a4e0ab59&source=post_page-e657a4e0ab59--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fe657a4e0ab59%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fweb-scraping-apartment-listings-in-stockholm-3fcebacf8be6&user=Christopher+Furu&userId=e657a4e0ab59&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}