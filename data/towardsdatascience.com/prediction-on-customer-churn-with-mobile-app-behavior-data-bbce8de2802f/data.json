{"url": "https://towardsdatascience.com/prediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f", "time": 1683009770.580725, "path": "towardsdatascience.com/prediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f/", "webpage": {"metadata": {"title": "Prediction on Customer Churn with Mobile App Behavior Data | by Luke Sun | Towards Data Science", "h1": "Prediction on Customer Churn with Mobile App Behavior Data", "description": "Deep Dive into Logistic Regression Modeling with Data Processing, Model Building, Validation, Feature Analysis and Selection"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/logistic-regression-how-to-on-app-behavior-data-8a95802a988f", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://medium.com/@vistaxjtu/exploratory-data-analysis-on-mobile-app-behavior-data-2777fc937973", "anchor_text": "article", "paragraph_index": 2}, {"url": "https://machinelearningmastery.com/rfe-feature-selection-in-python/", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://github.com/luke4u/Customer_Behaviour_Prediction/tree/main/churn_prediction", "anchor_text": "Github", "paragraph_index": 25}], "all_paragraphs": ["In the previous article, we created a logistic regression model to predict user enrollment using app behavior data. Hopefully, you had good learning there. This post aims to improve your model building skills with new techniques and tricks based on a larger mobile app behavior data. It is split into 7 parts.", "We are tasked by a Fintech firm to analyze mobile app behavior data to identify potential churn customers. The goal is to predict which users are likely to churn, so the firm can focus on re-engaging these users with better products.", "EDA should be performed before data processing. Detailed steps are introduced in this article. The video below shows the final data after EDA.", "One-hot encoding is a technique to convert categorical variables into numerical variables. It is needed as the model we are to build cannot read categorical data. One-hot encoding simply creates additional features based on the number of unique categories. Here, specifically,", "The above automatically convert all categorical variables to numerical variables. But one drawback of one-hot encoding is the dummy variable trap. It is a scenario in which variables are highly correlated to each other. To avoid the trap, one of the dummy variables has to be dropped. Specifically,", "This is to split the data into train and test sets. Specifically,", "There are many ways to combat imbalanced classes, such as changing performance metrics, collecting more data, over-sampling or down-sampling data, etc. Here we use the down-sampling method.", "First, let\u2019s investigate the imbalance level of the dependent variable in y_train.", "As shown in Fig.1, the dependent variable is slightly imbalanced. To down-sample the data, we take the index of each class, and randomly choose the index of the majority class at a number of minority class in y_train. Then concatenate the index of both classes and down-sample x_train and y_train.", "Fundamentally, feature scaling is to normalize the range of the variables. This is to avoid any variable having a dominant impact on the model. For a neural network, feature scaling helps gradient descent converge faster than without it.", "Here we use standardization to normalize the variables. Specifically,", "Now, let\u2019s test and evaluate the model. Specifically,", "Finally, we got an accuracy of 0.61 and F1 of 0. 61. Not too bad performance.", "With the model trained and tested, one question is how good the model is to generalize to an unknown dataset. We use cross-validation to measure the size of the performance difference between known datasets and unknown datasets. Specifically,", "With the above, we found 10-fold cross-validation produces an average accuracy of 0.64.5 with a standard deviation of 0.023. This indicates the model can generalize well on an unknown dataset \u2728\u2728.", "With 41 features, we built a logistic regression model. But how to know which feature is more important in predicting the dependent variable? Specifically,", "As shown in Figure 2, we found two features that are very important: purchase_partners and purchase. This indicates a user\u2019s purchase history plays a great role when deciding churn or not. Meanwhile, this indicates that not all variables are important for prediction.", "Feature selection is a technique to select a subset of the most relevant features for modeling training.", "In this application, x_train contains 41 features, but as seen in Figure 2, not all features play important roles. Using feature selection helps to reduce the number of unimportant features and achieve similar performance with less training data. A more detailed explanation of feature selection can be found here.", "Here, we use the Recursive Feature Elimination (RFE). It works by fitting the given algorithm, ranking the feature by importance, discarding the least important features, and refitting until a specified number of features is achieved. Specifically,", "Note above, we set to select 20 features. Figure 3 shows all selected features.", "Great. with the RFE selected features, let\u2019s retrain and test the model.", "In the end, we got an accuracy of 0.61 and F1 of 0.61. The same performance as the model trained on 41 features \ud83d\ude07\ud83d\ude07!", "If we apply cross-validation again, we got an average accuracy of 0.647 with a standard deviation of 0.014. Again, very much the same as the previous model.", "Initially, we trained a logistic regression model with 41 features, achieving an accuracy of 0.645. But using feature selection, we created a light version of the model with only 20 features, with an accuracy of 0.647. Half of the features are of no relevance in deciding the customer\u2019s churn. Well done!", "Great! That\u2019s all of this journey! If you need the source code, feel free to visit my Github page \ud83e\udd1e\ud83e\udd1e (FYI, the repos is actively maintained).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Enthusiast, Data Scientist, Python Developer. Love to share articles about technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbbce8de2802f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lukesun.medium.com/?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508----bbce8de2802f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbce8de2802f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbce8de2802f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/ux-prototyping-design-webdesign-788002/", "anchor_text": "link"}, {"url": "https://towardsdatascience.com/logistic-regression-how-to-on-app-behavior-data-8a95802a988f", "anchor_text": "article"}, {"url": "https://medium.com/@vistaxjtu/exploratory-data-analysis-on-mobile-app-behavior-data-2777fc937973", "anchor_text": "article"}, {"url": "https://en.wikipedia.org/wiki/Logistic_regression", "anchor_text": "Wikipedia"}, {"url": "https://machinelearningmastery.com/rfe-feature-selection-in-python/", "anchor_text": "here"}, {"url": "https://github.com/luke4u/Customer_Behaviour_Prediction/tree/main/churn_prediction", "anchor_text": "Github"}, {"url": "https://medium.com/tag/logistic-regression?source=post_page-----bbce8de2802f---------------logistic_regression-----------------", "anchor_text": "Logistic Regression"}, {"url": "https://medium.com/tag/binary-classification?source=post_page-----bbce8de2802f---------------binary_classification-----------------", "anchor_text": "Binary Classification"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bbce8de2802f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bbce8de2802f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/feature-selection?source=post_page-----bbce8de2802f---------------feature_selection-----------------", "anchor_text": "Feature Selection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbbce8de2802f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&user=Luke+Sun&userId=7b5b79d21508&source=-----bbce8de2802f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbbce8de2802f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&user=Luke+Sun&userId=7b5b79d21508&source=-----bbce8de2802f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbce8de2802f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbbce8de2802f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bbce8de2802f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bbce8de2802f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bbce8de2802f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bbce8de2802f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bbce8de2802f--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://lukesun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F38f46069f6d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-on-customer-churn-with-mobile-app-behavior-data-bbce8de2802f&newsletterV3=7b5b79d21508&newsletterV3Id=38f46069f6d3&user=Luke+Sun&userId=7b5b79d21508&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}