{"url": "https://towardsdatascience.com/mixture-modelling-from-scratch-in-r-5ab7bfc83eef", "time": 1682996160.801455, "path": "towardsdatascience.com/mixture-modelling-from-scratch-in-r-5ab7bfc83eef/", "webpage": {"metadata": {"title": "Mixture modelling from scratch, in R | by Arnaud M. | Towards Data Science", "h1": "Mixture modelling from scratch, in R", "description": "In the Machine Learning literature, K-means and Gaussian Mixture Models (GMM) are the first clustering / unsupervised models described [1\u20133], and as such, should be part of any data scientist\u2019s\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-means", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Mixture_model#Gaussian_mixture_model", "anchor_text": "Gaussian Mixture Models", "paragraph_index": 0}, {"url": "https://www.r-bloggers.com/an-intro-to-gaussian-mixture-modeling/", "anchor_text": "An Intro to Gaussian Mixture Modeling", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm", "anchor_text": "Expectation-Maximization", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Iris dataset", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Linear_discriminant_analysis", "anchor_text": "Linear Discriminant Analysis", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm", "anchor_text": "Expectation-Maximization", "paragraph_index": 10}, {"url": "https://www.springer.com/de/book/9780387848570", "anchor_text": "The Elements of Statistical Learning, Data Mining, Inference, and Prediction", "paragraph_index": 12}, {"url": "https://www.cs.ubc.ca/~murphyk/MLbook/", "anchor_text": "Machine Learning, A Probabilistic Perspective", "paragraph_index": 13}, {"url": "https://www.jstor.org/stable/pdf/2394164.pdf", "anchor_text": "The species problem in Iris", "paragraph_index": 14}, {"url": "http://www.laurent-duval.eu/Documents/Steinhaus_H_1956_j-bull-acad-polon-sci_division_cmp-k-means.pdf", "anchor_text": "Sur la division des corps mat\u00e9riels en parties", "paragraph_index": 15}, {"url": "https://projecteuclid.org/download/pdf_1/euclid.bsmsp/1200512992", "anchor_text": "Some methods for classification and analysis of multivariate observations", "paragraph_index": 16}, {"url": "http://web.mit.edu/6.435/www/Dempster77.pdf", "anchor_text": "Maximum Likelihood from Incomplete Data via the EM Algorithm", "paragraph_index": 17}, {"url": "https://www.linkedin.com/in/amignan/", "anchor_text": "https://www.linkedin.com/in/amignan/", "paragraph_index": 19}], "all_paragraphs": ["In the Machine Learning literature, K-means and Gaussian Mixture Models (GMM) are the first clustering / unsupervised models described [1\u20133], and as such, should be part of any data scientist\u2019s toolbox. In R, one can use kmeans(), Mclust() or other similar functions, but to fully understand those algorithms, one needs to build them from scratch. An online search will guide you towards many useful tutorials but you will be hard-pressed to find fully transparent R codes. The best example I came upon is the excellent article \u2018An Intro to Gaussian Mixture Modeling\u2019 on R-bloggers.", "But I still remained somewhat unsatisfied. Here is what I was looking for, all at once:", "The code I mentioned above filled about half of those requirements (A-to-Z, elegant GMM multivariate code). I completed the rest with a bit more of research, with the result presented below. Note that I keep this article very short to focus on the essence of the algorithms. Equations can be found on Wikipedia and ML textbooks. R codes are annotated just to give enough details about the modelling steps. I also use the same structure for both K-means and GMM to highlight the clear parallel between them (i.e. hard and soft versions of the Expectation-Maximization algorithm, respectively).", "For illustration, we will apply those clustering algorithms to the famous Iris dataset. In the early 20th century, Edgar Anderson collected data to quantify the morphologic variations of three Iris flower species: Iris setosa, Iris virginica and Iris versicolor. The dataset consists for 50 samples from each of the 3 species and 4 features: length and width of the sepals and petals [4]. British statistician and geneticist Ronald Fisher (1890\u20131962), \u201ca genius who almost single-handedly created the foundations for modern statistical science\u201d [5], then used this dataset as an example of Linear Discriminant Analysis (LDA) in \u2018The use of multiple measurements in taxonomic problems\u2019 [6]. Since then, the Iris dataset has become a textbook example of a simple multidimensional clustering problem (although Fisher obviously used the labels for LDA, which is a supervised learning model). The iris dataset is included in the R datasets package.", "We learn from the excellent review \u2018Data clustering: 50 years beyond K-means\u2019 [7] that the development of clustering methods has been an interdisciplinary endeavour with a multitude of contributions from taxonomists, biologists, psychologists, statisticians, engineers, etc., and that the term \u2018data clustering\u2019 first appeared in the title of a 1954 article dealing with anthropological data. Of all existing clustering algorithms, K-means is the most popular and simplest. It has a rich and diverse history as it was independently discovered in different scientific fields between 1956 and 1967 [8\u20139]. It is described in the following annotated R code:", "Let\u2019s compare with the packaged algorithm km.pkg <- kmeans(X, 3):", "The following animation is based on the proposed R code but with the radius of the cluster spherical decision boundary plotted, using the panel option of the pairs() function. For clarity, this is not shown in the previous code, as it would have doubled its size! The full code is however provided in the Appendix. Comparing to the Iris species labelling, we get an accuracy of 88.7% (no error for setosa, 3 observations misclassified for versicolor and 14 for virginica \u2014 note that results can slightly change depending on the random initiation). Using the kmeans() built-in R function yields a similar result but faster.", "The mixture of Gaussians (Gaussian Mixture Model or GMM) is the most widely used mixture model. GMM can be described as a soft version of K-means with Gaussian density. Below is a R code for the multidimensional case meaning that we go full tensorial, which is the best way to learn all the intricacies of GMM via the multivariate normal distribution and eigendecomposition of the covariance matrix. Here we go:", "Let\u2019s compare with gmm.mclust <- Mclust(X, 3) from library(mclust):", "Once again, the plotting of the ellipses during iteration, as illustrated in the animation that follows, is not shown in the present code for clarity (see Appendix for the full code). Comparing to the Iris species labelling, we get an accuracy of 96.7% when classifying each observation to the highest cluster probability (no error for setosa and virginica, 5 observations misclassified for versicolor). Note however that results may slightly vary depending on the random parameter initiation; run the algorithms several times to investigate this variability. Similar results are obtained when using Mclust() (but Mclust() is obviously much faster). If we compare in detail the results of both clustering algorithms, we can see that it is the spherical assumption made by K-means that makes it perform slightly worse than a GMM on the Iris dataset.", "See now the resemblance between the two algorithms, both structured in three steps: initiation, E-step and M-step of the Expectation-Maximization (EM) algorithm [10]. EM is a simple and powerful iterative algorithm which alternates between inferring the cluster given the parameters (E-step), and then optimizing the parameters given the predicted cluster (M-step).", "Voila. Now that you understand the steps of those two classic clustering algorithms, I recommend that you use official R functions (kmeans(), Mclust(), etc.), which have been benchmarked and are far more efficient.", "[2] T. Hastie et al., The Elements of Statistical Learning, Data Mining, Inference, and Prediction (2009), Springer, 2nd ed.", "[3] K. P. Murphy, Machine Learning, A Probabilistic Perspective (2012), The MIT Press", "[4] E. Anderson, The species problem in Iris (1936), Annals of the Missouri Botanical Garden", "[8] H. Steinhaus, Sur la division des corps mat\u00e9riels en parties (1956), Bulletin de l\u2019Acad\u00e9mie Polonaise des Sciences", "[9] J. MacQueen, Some methods for classification and analysis of multivariate observations (1967), Fifth Berkeley Symposium", "[10] A. P. Dempster et al., Maximum Likelihood from Incomplete Data via the EM Algorithm (1977), Journal of the Royal Statistical Society", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Catastrophe risk expert & machine learning practitioner \u2014 https://www.linkedin.com/in/amignan/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5ab7bfc83eef&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://am80.medium.com/?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": ""}, {"url": "https://am80.medium.com/?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": "Arnaud M."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e7153f793c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&user=Arnaud+M.&userId=9e7153f793c4&source=post_page-9e7153f793c4----5ab7bfc83eef---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ab7bfc83eef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ab7bfc83eef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-means"}, {"url": "https://en.wikipedia.org/wiki/Mixture_model#Gaussian_mixture_model", "anchor_text": "Gaussian Mixture Models"}, {"url": "https://www.r-bloggers.com/an-intro-to-gaussian-mixture-modeling/", "anchor_text": "An Intro to Gaussian Mixture Modeling"}, {"url": "https://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm", "anchor_text": "Expectation-Maximization"}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Iris dataset"}, {"url": "https://en.wikipedia.org/wiki/Linear_discriminant_analysis", "anchor_text": "Linear Discriminant Analysis"}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm", "anchor_text": "Expectation-Maximization"}, {"url": "https://www.springer.com/de/book/9780387310732", "anchor_text": "Pattern Recognition and Machine Learning"}, {"url": "https://www.springer.com/de/book/9780387310732", "anchor_text": "Pattern Recognition and Machine Learning"}, {"url": "https://www.springer.com/de/book/9780387848570", "anchor_text": "The Elements of Statistical Learning, Data Mining, Inference, and Prediction"}, {"url": "https://www.cs.ubc.ca/~murphyk/MLbook/", "anchor_text": "Machine Learning, A Probabilistic Perspective"}, {"url": "https://www.jstor.org/stable/pdf/2394164.pdf", "anchor_text": "The species problem in Iris"}, {"url": "https://www.amazon.com/History-Mathematical-Statistics-Wiley-Probability/dp/0471179124", "anchor_text": "A History of Mathematical Statistics"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0167865509002323", "anchor_text": "Data clustering: 50 years beyond K-means"}, {"url": "http://www.laurent-duval.eu/Documents/Steinhaus_H_1956_j-bull-acad-polon-sci_division_cmp-k-means.pdf", "anchor_text": "Sur la division des corps mat\u00e9riels en parties"}, {"url": "https://projecteuclid.org/download/pdf_1/euclid.bsmsp/1200512992", "anchor_text": "Some methods for classification and analysis of multivariate observations"}, {"url": "http://web.mit.edu/6.435/www/Dempster77.pdf", "anchor_text": "Maximum Likelihood from Incomplete Data via the EM Algorithm"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5ab7bfc83eef---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----5ab7bfc83eef---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/visualization?source=post_page-----5ab7bfc83eef---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/clustering?source=post_page-----5ab7bfc83eef---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/r?source=post_page-----5ab7bfc83eef---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5ab7bfc83eef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&user=Arnaud+M.&userId=9e7153f793c4&source=-----5ab7bfc83eef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5ab7bfc83eef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&user=Arnaud+M.&userId=9e7153f793c4&source=-----5ab7bfc83eef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5ab7bfc83eef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5ab7bfc83eef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5ab7bfc83eef---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5ab7bfc83eef--------------------------------", "anchor_text": ""}, {"url": "https://am80.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://am80.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arnaud M."}, {"url": "https://am80.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "109 Followers"}, {"url": "https://www.linkedin.com/in/amignan/", "anchor_text": "https://www.linkedin.com/in/amignan/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e7153f793c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&user=Arnaud+M.&userId=9e7153f793c4&source=post_page-9e7153f793c4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe3335d951935&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmixture-modelling-from-scratch-in-r-5ab7bfc83eef&newsletterV3=9e7153f793c4&newsletterV3Id=e3335d951935&user=Arnaud+M.&userId=9e7153f793c4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}