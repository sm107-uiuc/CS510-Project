{"url": "https://towardsdatascience.com/unsupervised-learning-project-creating-customer-segments-17c4b4bbf925", "time": 1682995986.799637, "path": "towardsdatascience.com/unsupervised-learning-project-creating-customer-segments-17c4b4bbf925/", "webpage": {"metadata": {"title": "Unsupervised Learning Project: Creating Customer Segments | by Victor Roman | Towards Data Science", "h1": "Unsupervised Learning Project: Creating Customer Segments", "description": "Throughout this project, we are going to analyze the spending behaviours of several customers in some product categories. The main goals of the project are: To carry out this project we will use the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Wholesale+customers", "anchor_text": "UCI Machine Learning Repository", "paragraph_index": 1}, {"url": "https://github.com/rromanss23/Machine_Leaning_Engineer_Udacity_NanoDegree/tree/master/projects/customer_segments", "anchor_text": "GitHub page", "paragraph_index": 2}, {"url": "http://econbrowser.com/archives/2014/02/use-of-logarithms-in-economics", "anchor_text": "often appropriate", "paragraph_index": 22}, {"url": "http://scipy.github.io/devdocs/generated/scipy.stats.boxcox.html", "anchor_text": "Box-Cox test", "paragraph_index": 23}, {"url": "http://datapigtechnologies.com/blog/index.php/highlighting-outliers-in-your-data-with-the-tukey-method/", "anchor_text": "Tukey\u2019s Method for identfying outliers", "paragraph_index": 26}, {"url": "http://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html", "anchor_text": "silhouette coefficient", "paragraph_index": 47}], "all_paragraphs": ["Throughout this project, we are going to analyze the spending behaviours of several customers in some product categories. The main goals of the project are:", "To carry out this project we will use the dataset that can be found in the following UCI Machine Learning Repository.", "You can find the complete project, documentation and dataset on my GitHub page:", "We will focus our analysis on the six product categories recorded for the customers, excluding the \u2018Channel\u2019 and \u2018Region\u2019 fields.", "Now we will explore the dataset through visualizations and code in order to understand the relationships between features. In addition, we will calculate a statistical description of the dataset and consider the overall relevance of each feature.", "In order to understand better our dataset and how the data will be transformed through the analysis, we will select a few sample points and explore them in detail.", "Let us consider now the total purchase cost of each product category and the statistical description of the dataset above for our sample customers. If we would have to predict what kind of establishment (customer) each of the three samples chosen represent:", "We can make the following predictions:", "- Largest spending on detergents and paper and groceries of the entire dataset, which usually are products for houses.", "- Higher than average spending on milk.", "- Lower than average spending on frozen products.", "- High spending on almost every product category.", "- Highest spending on fresh products of the entire dataset. Likely to be a large market.", "- The amount of every product is significantly lower than the previous two customers considered.", "- The spending on fresh products is the lowest of the entire dataset.", "- The spending on milk and detergent and papers is in the bottom quartile.", "We will now analyze the relevance of the features for understanding the purchasing behaviours of the customers. In other words, to determine if a customer that purchase some amount of one category of products will necessarily purchase some proportional amount of another category of products.", "We will study this by training a supervised regression learner on a subset of the data with one feature removed, and then score how well that model can predict the removed feature.", "In order to understand better our dataset, we will display a scatter matrix of every product feature.", "The product features that show a correlation in the scatter matrix will be relevant to predict others.", "Using the scatter matrix and the correlation matrix as a references, we can infer the following:", "This step is crucial to make sure that the results obtained are significant, meaningful and they are optimized. We will preprocess data by scaling it and detecting potential outliers.", "Usually, when data is not normally distributed, especially if the mean and median vary significantly (indicating a large skew), it is most often appropriate to apply a non-linear scaling \u2014 particularly for financial data.", "One way to achieve this scaling is by using a Box-Cox test, which calculates the best power transformation of the data that reduces skewness. A simpler approach which can work in most cases would be applying the natural logarithm.", "After applying a natural logarithm scaling to the data, the distribution of each feature appear much more normal. For any pairs of features we have identified earlier as being correlated, we observe here that correlation is still present (and whether it is now stronger or weaker than before).", "Detecting outliers in the data is extremely important in the data preprocessing step of any analysis. The presence of outliers can often skew results which take into consideration these data points.", "Here, we will use Tukey\u2019s Method for identfying outliers: An outlier step is calculated as 1.5 times the interquartile range (IQR). A data point with a feature that is beyond an outlier step outside of the IQR for that feature is considered abnormal.", "Now we will use Principal Component Analysis (PCA) to extract conclusions about the hidden structure of the dataset. PCA is used to calculate those dimensions that maximize variance, so we will find the combination of features that describe best each customer.", "Once the data has been scaled to a normal distribution and the necessary outliers have been removed, we can apply PCA to the good_data to discover which dimensions about the data best maximize the variance of features involved.", "In addition to finding these dimensions, PCA will also report the explained variance ratio of each dimension \u2014 how much variance within the data is explained by that dimension alone.", "When using principal component analysis, one of the main goals is to reduce the dimensionality of the data.", "Dimensionality reduction comes at a cost: Fewer dimensions used implies less of the total variance in the data is being explained. Because of this, the cumulative explained variance ratio is extremely important for knowing how many dimensions are necessary for the problem. Additionally, if a signifiant amount of variance is explained by only two or three dimensions, the reduced data can be visualized afterwards.", "The cell below show how the log-transformed sample data has changed after having a PCA transformation applied to it using only two dimensions. Observe how the values for the first two dimensions remains unchanged when compared to a PCA transformation in six dimensions.", "A biplot is a scatterplot where each data point is represented by its scores along the principal components. The axes are the principal components (in this case Dimension 1 and Dimension 2).", "The biplot shows the projection of the original features along the components. A biplot can help us interpret the reduced dimensions of the data, and discover relationships between the principal components and original features.", "Once we have the original feature projections (in red), it is easier to interpret the relative position of each data point in the scatterplot.", "For instance, a point the lower right corner of the figure will likely correspond to a customer that spends a lot on 'Milk', 'Grocery'and 'Detergents_Paper', but not so much on the other product categories.", "In this section, we will choose to use either a K-Means clustering algorithm or a Gaussian Mixture Model (GMM) clustering algorithm to identify the various customer segments hidden in the data.", "We will then recover specific data points from the clusters to understand their significance by transforming them back into their original dimension and scale.", "1) The main advantages of using K-Means as a cluster algorithm are:", "- It is easy to implement.", "- With large number of variables, if (K is small), it may be computationally faster than hierarchichal clustering.", "- It is guaranteed to converge.", "2) The main advantages of using Gaussian Mixture Models as a cluster algorithm are:", "- It is much more flexible in terms of cluster covariance. Which means that each cluster can have unconstrained covariance structure. In other words, whereas K-means assumes that every cluster have spherical estructure, GMM allows eliptical.", "- Points can belong to different clusters, with different level of memebership. This level of membership is the probability of each point to belong to each cluster.", "When the number of clusters is not known a priori, there is no guarantee that a given number of clusters best segments the data, since it is unclear what structure exists in the data.", "However, we can quantify the \u201cgoodness\u201d of a clustering by calculating each data point\u2019s silhouette coefficient. The silhouette coefficient for a data point measures how similar it is to its assigned cluster from -1 (dissimilar) to 1 (similar). Calculating the mean silhouette coefficient provides for a simple scoring method of a given clustering.", "The number of cluster with the best Silhouette Score is 2, with a score of 0.42.", "Once we\u2019ve chosen the optimal number of clusters for the clustering algorithm using the scoring metric above, we can now visualize the results in the code block below.", "Each cluster present in the visualization above has a central point. These centers (or means) are not specifically data points from the data, but rather the averages of all the data points predicted in the respective clusters.", "For the problem of creating customer segments, a cluster\u2019s center point corresponds to the average customer of that segment. Since the data is currently reduced in dimension and scaled by a logarithm, we can recover the representative customer spending from these data points by applying the inverse transformations.", "The code below shows to which ckustr each sample point is predicted ot belong.", "How can the wholesale distributor label the new customers using only their estimated product spending and the customer segment data?", "A supervised learning algorithm could be used with the estimated product spending as attributes and the customer segment as the target variable, making it a classification problem (we would have 2 possible labels). As there is not a clear mathematical relationship between the customer segment and the product spending KNN could be a good algorithm to work with.", "At the beginning of this project, it was discussed that the 'Channel' and 'Region' features would be excluded from the dataset so that the customer product categories were emphasized in the analysis. By reintroducing the 'Channel' feature to the dataset, an interesting structure emerges when considering the same PCA dimensionality reduction applied earlier to the original dataset.", "The code block below shows how each data point is labeled either 'HoReCa' (Hotel/Restaurant/Cafe) or 'Retail' the reduced space.", "We can observe that the cluster algorithm does a pretty good job of clustering the data to the underlying distribution as the cluster 0 can be associated perfectly with a retailer and the cluster 1 to the Ho/Re/Ca.", "As always, I hope you enjoyed the post, that you are now a pro on neural networks!", "If you want to learn more about Machine Learning, Data Science and Artificial Intelligence follow me on Medium, and stay tuned for my next posts!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Industrial Engineer and passionate about 4.0 Industry. My goal is to encourage people to learn and explore its technologies and their infinite posibilites."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F17c4b4bbf925&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rromanss23.medium.com/?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": ""}, {"url": "https://rromanss23.medium.com/?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": "Victor Roman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F77fd145c8783&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&user=Victor+Roman&userId=77fd145c8783&source=post_page-77fd145c8783----17c4b4bbf925---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17c4b4bbf925&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17c4b4bbf925&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/5fNmWej4tAA", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Wholesale+customers", "anchor_text": "UCI Machine Learning Repository"}, {"url": "https://github.com/rromanss23/Machine_Leaning_Engineer_Udacity_NanoDegree/tree/master/projects/customer_segments", "anchor_text": "GitHub page"}, {"url": "https://github.com/rromanss23/Machine_Leaning_Engineer_Udacity_NanoDegree/tree/master/projects/customer_segments", "anchor_text": "https://github.com/rromanss23/Machine_Leaning_Engineer_Udacity_NanoDegree/tree/master/projects/customer_segments"}, {"url": "http://econbrowser.com/archives/2014/02/use-of-logarithms-in-economics", "anchor_text": "often appropriate"}, {"url": "http://scipy.github.io/devdocs/generated/scipy.stats.boxcox.html", "anchor_text": "Box-Cox test"}, {"url": "http://datapigtechnologies.com/blog/index.php/highlighting-outliers-in-your-data-with-the-tukey-method/", "anchor_text": "Tukey\u2019s Method for identfying outliers"}, {"url": "http://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html", "anchor_text": "silhouette coefficient"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----17c4b4bbf925---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----17c4b4bbf925---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/clustering?source=post_page-----17c4b4bbf925---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----17c4b4bbf925---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----17c4b4bbf925---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17c4b4bbf925&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&user=Victor+Roman&userId=77fd145c8783&source=-----17c4b4bbf925---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F17c4b4bbf925&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&user=Victor+Roman&userId=77fd145c8783&source=-----17c4b4bbf925---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F17c4b4bbf925&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F17c4b4bbf925&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----17c4b4bbf925---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----17c4b4bbf925--------------------------------", "anchor_text": ""}, {"url": "https://rromanss23.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rromanss23.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Victor Roman"}, {"url": "https://rromanss23.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F77fd145c8783&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&user=Victor+Roman&userId=77fd145c8783&source=post_page-77fd145c8783--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7e807bd3a047&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervised-learning-project-creating-customer-segments-17c4b4bbf925&newsletterV3=77fd145c8783&newsletterV3Id=7e807bd3a047&user=Victor+Roman&userId=77fd145c8783&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}