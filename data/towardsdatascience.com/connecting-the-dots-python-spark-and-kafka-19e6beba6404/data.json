{"url": "https://towardsdatascience.com/connecting-the-dots-python-spark-and-kafka-19e6beba6404", "time": 1682997048.270824, "path": "towardsdatascience.com/connecting-the-dots-python-spark-and-kafka-19e6beba6404/", "webpage": {"metadata": {"title": "Connecting the Dots (Python, Spark, and Kafka) | by Kiruparan Balachandran | Towards Data Science", "h1": "Connecting the Dots (Python, Spark, and Kafka)", "description": "Frequently, Data scientists prefer to use Python (in some cases, R) to develop machine learning models. Here, they have a valid justification since data-driven solutions arrive with many experiments\u2026"}, "outgoing_paragraph_urls": [{"url": "http://spark.apache.org/downloads.html", "anchor_text": "http://spark.apache.org/downloads.html", "paragraph_index": 4}, {"url": "http://iqx.iqmedialabs.com:8080/", "anchor_text": "http://abc.def.com:8080/", "paragraph_index": 12}, {"url": "https://medium.com/@kiruparan/quickstart-apache-kafka-kafka-python-e8356bec94", "anchor_text": "Kafka", "paragraph_index": 15}, {"url": "https://www.linkedin.com/pulse/quickstart-apache-kafka-kafka-python-kiruparan-balachandran/", "anchor_text": "article", "paragraph_index": 38}], "all_paragraphs": ["Frequently, Data scientists prefer to use Python (in some cases, R) to develop machine learning models. Here, they have a valid justification since data-driven solutions arrive with many experiments. Numerous interactions with the language we use to develop the models are required to perform experiments, and the libraries and platforms available in python to develop machine-learning models are tremendous. This is a valid argument; however, we confront issues when these models are applied to production.", "We still have the Python micro-service library such as Flask to deploy machine-learning models and publish it as API. Nevertheless, the question is, \u2018can this cater for real-time analytics where you need to process millions of events in a millisecond of time?\u2019 The answer is \u2018no.\u2019 This situation is my motivation to write this article.", "To overcome all the above problems, I have identified a set of dots that could be appropriately connected. In this article, I attempt to connect these dots, which are Python, Apache Spark, and Apache Kafka.", "The article is structured in the following order;", "The latest version of Apache Spark is available at http://spark.apache.org/downloads.html", "Spark-2.3.2 was the latest version by the time I wrote this article.", "Step 1: Download spark-2.3.2 to the local machine using the following command", "Step 3: Create soft links (optional).", "This step is optional, but preferred; it facilitates upgrading spark versions in the future.", "Step 4: Add SPARK_HOME entry to bashrc", "The following output would be visible on the console if everything were accurate:", "Step 6: Start the master in this machine", "Spark Master Web GUI (the flowing screen) is accessible from the following URL: http://abc.def.com:8080/", "If everything were accurate, the entry for Workers would appear on the same screen.", "Here Kafka is a streaming platform that helps to produce and consume the events to the spark platform.", "Please refer to the article on Kafka I have already written for more detailed instructions.", "Step 1: Go to the Kafka root folder", "Step 4: Create two Kafka Topics (input_event and output_event)", "First setup python packages in each node of the cluster and specify the path to each worker node. Installation of Anaconda is preferred here, which contains a majority of the necessary python packages.", "Add the below entry in spark-env.sh to specify the path to each worker node.", "Installation of other python dependencies used in this spark app is required. For example, we use Kafka-python to write the processed event back to Kafka.", "This is the process to install Kafka python:", "In a console, go to anaconda bin directory", "Now we have arranged the whole atmosphere necessary to run the Spark application.", "Spark Context is the entry point to access spark functionalities and provides connection to a Spark cluster. To create SparkContext, first, we should create SparkConf that contains parameters required to pass to SparkContext. The below code snipe shows how to create SparkContext.", "Here, only master URL and application name were arranged, but not limited to this. SparkConf allows you to control more parameters. For example, you can specify the number of cores to use for the driver process, the amount of memory to use per executor process, etc.", "Creating [StreamingContext + input stream for Kafka Brokers]", "Streaming Context is the entry point to access spark streaming functionalities. The key functionality of the streaming context is to create Discretized Stream from different streaming sources. The following code snip shows creating a StreamingContext.", "Next, we create the input stream for pulls message from the Kafka Brokers. Following parameters creating the input stream should be specified:", "The following code snipe expresses how to create an input stream for Kafka Brokers.", "Process events and write back to Kafka", "After creating the stream for Kafka Brokers, we pull each event from the stream and process the events. Here I demonstrate a typical example (word count) referred in most spark tutorials, with minor alterations, to keep the key value throughout the processing period and write back to Kafka.", "The following code snip describes receiving the inbound stream and creating another stream with the processed events:", "Now, all that remain is to write back to Kafka. We get the processed stream and write back to the external system by applying the output operation to stream (here we use foreachRDD). This pushes the data in each RDD to an external system (in our use case, to Kafka). The following code snipe explains how to the data in each RDD write back to Kafka:", "Script spark-submit is applied to launch spark application. Following parameters should be specified during launch application:", "Finally, we must submit the PySpark script we wrote in this section, i.e., spark_processor.py", "After launching all commands, our spark application will be as follows:", "Provided all be fine, the following output will appear in the console:", "Now we have the necessary setup and is the time for testing. Here, I used Kafka-python to create the events and consume the events already discussed in one of my previous articles.", "Here is the code snipe for your reference:", "If everything is accurate, the process events consume and display in the console as follows:", "The key takeaways from this article are,1) Python, Spark, and Kafka are important frameworks in a data scientist\u2019s daily activities.2) This article helps data scientists to perform their experiments in Python while deploying the final model in a scalable production environment.", "Thank you for reading this. Hope that you guys will also manage to connect these dots!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A Data enthusiast on extracting insights from business data sets, machine learning, and building and deploying large-scale machine learning models."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F19e6beba6404&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----19e6beba6404--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19e6beba6404--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kiruparan.medium.com/?source=post_page-----19e6beba6404--------------------------------", "anchor_text": ""}, {"url": "https://kiruparan.medium.com/?source=post_page-----19e6beba6404--------------------------------", "anchor_text": "Kiruparan Balachandran"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F67ef34422eeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&user=Kiruparan+Balachandran&userId=67ef34422eeb&source=post_page-67ef34422eeb----19e6beba6404---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19e6beba6404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19e6beba6404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@cesar-gaviria-232160", "anchor_text": "C\u00e9sar Gaviria"}, {"url": "https://www.pexels.com/@cesar-gaviria-232160", "anchor_text": "Pexels"}, {"url": "https://www.linkedin.com/pulse/quickstart-apache-kafka-kafka-python-kiruparan-balachandran/", "anchor_text": "article"}, {"url": "http://spark.apache.org/downloads.html", "anchor_text": "http://spark.apache.org/downloads.html"}, {"url": "http://iqx.iqmedialabs.com:8080/", "anchor_text": "http://abc.def.com:8080/"}, {"url": "https://medium.com/@kiruparan/quickstart-apache-kafka-kafka-python-e8356bec94", "anchor_text": "Kafka"}, {"url": "https://mvnrepository.com/artifact/org.apache.spark/spark-streaming-kafka-0-8-assembly", "anchor_text": "https://mvnrepository.com/artifact/org.apache.spark/spark-streaming-kafka-0-8-assembly"}, {"url": "https://www.linkedin.com/pulse/quickstart-apache-kafka-kafka-python-kiruparan-balachandran/", "anchor_text": "article"}, {"url": "https://medium.com/tag/apache-spark?source=post_page-----19e6beba6404---------------apache_spark-----------------", "anchor_text": "Apache Spark"}, {"url": "https://medium.com/tag/apache-kafka?source=post_page-----19e6beba6404---------------apache_kafka-----------------", "anchor_text": "Apache Kafka"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----19e6beba6404---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/event-stream-processing?source=post_page-----19e6beba6404---------------event_stream_processing-----------------", "anchor_text": "Event Stream Processing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19e6beba6404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&user=Kiruparan+Balachandran&userId=67ef34422eeb&source=-----19e6beba6404---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19e6beba6404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&user=Kiruparan+Balachandran&userId=67ef34422eeb&source=-----19e6beba6404---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19e6beba6404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19e6beba6404--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F19e6beba6404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----19e6beba6404---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----19e6beba6404--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----19e6beba6404--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----19e6beba6404--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----19e6beba6404--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----19e6beba6404--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----19e6beba6404--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----19e6beba6404--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----19e6beba6404--------------------------------", "anchor_text": ""}, {"url": "https://kiruparan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kiruparan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kiruparan Balachandran"}, {"url": "https://kiruparan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F67ef34422eeb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&user=Kiruparan+Balachandran&userId=67ef34422eeb&source=post_page-67ef34422eeb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc1eaa38291b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconnecting-the-dots-python-spark-and-kafka-19e6beba6404&newsletterV3=67ef34422eeb&newsletterV3Id=c1eaa38291b&user=Kiruparan+Balachandran&userId=67ef34422eeb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}