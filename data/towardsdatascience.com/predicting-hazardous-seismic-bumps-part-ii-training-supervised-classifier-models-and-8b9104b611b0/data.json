{"url": "https://towardsdatascience.com/predicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0", "time": 1683013369.899914, "path": "towardsdatascience.com/predicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0/", "webpage": {"metadata": {"title": "Predicting Hazardous Seismic Bumps Part II: Training & Tuning Supervised ML Classifiers and Model Performance Analysis | by Nabanita Roy | Towards Data Science", "h1": "Predicting Hazardous Seismic Bumps Part II: Training & Tuning Supervised ML Classifiers and Model Performance Analysis", "description": "This article demonstrates predicting hazardous seismic bumps using different supervised machine learning classifiers, tuning model hyperparameters and performance assessment, accuracy paradox and importance of business problem statement in model performance analysis"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/predicting-hazardous-seismic-bumps-using-supervised-classification-algorithms-part-i-2c5d21f379bc", "anchor_text": "previous article", "paragraph_index": 0}, {"url": "https://github.com/royn5618", "anchor_text": "GitHub repository", "paragraph_index": 1}, {"url": "https://docs.python.org/3/library/datetime.html", "anchor_text": "datetime python module", "paragraph_index": 2}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "GridSearchCV", "paragraph_index": 14}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html", "anchor_text": "Scikit-Learns documentation on KNN", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/svm.html#svm-kernels", "anchor_text": "Scikit-learn documentation", "paragraph_index": 40}, {"url": "https://medium.com/u/7a033ba6b705?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "CathL", "paragraph_index": 48}, {"url": "https://medium.com/@nroy0110", "anchor_text": "Medium", "paragraph_index": 49}, {"url": "https://www.linkedin.com/in/nabanita-roy/", "anchor_text": "LinkedIn", "paragraph_index": 49}, {"url": "https://github.com/royn5618", "anchor_text": "GitHub", "paragraph_index": 49}], "all_paragraphs": ["In my previous article on the seismic bumps dataset sourced from UCI\u2019s Data Archive, I applied basic data analysis techniques for feature engineering and test-train splitting strategies for imbalanced datasets. In this article, I have demonstrated how to apply supervised machine learning algorithms (KNN, Random Forest, and SVM) for predictions and tune hyperparameters (using GridSearchCV) for optimum results. The outcomes of the performance assessment also clearly exhibit Accuracy Paradox which I will elaborate on in the following sections. Additionally, it also demonstrates why understanding the \u201cbusiness problem\u201d is essential to pick the best model.", "The complete notebook can be found in my GitHub repository", "creating a folder in which I\u2019d save my models. When fitting multiple algorithms to your data, it is always good to save your models after training and tuning. For this, I created a folder using the datetime python module.", "Every best performing model will be stored in this folder.", "This is a binary classification task and I selected the simplest classification model, K-Nearest Neighbours (KNN) to begin prediction modelling. KNN is one of the simplest classifiers that assign a label to the unseen instance based on the maximum number of labels in the top K similar seen instances.", "To improve models, a baseline is required, to which the subsequent models will be compared. Consequently, it is called the \u201cBaseline Model\u201d. Therefore, for a baseline model, I initialised a KNN classifier with default parameters:", "Next, I checked the performance first, using StratifiedKFold of 10 splits, keeping the scoring metric \u2018accuracy\u2019.", "For all the folds, the accuracy lies in between 0.92 to 0.93 and that closeness of the values is exhibited through the standard deviation of the scores.", "The accuracy is really high here. Now, let\u2019s fit the model in our training data and check the model\u2019s performance \u2014", "I added a data frame to hold each model\u2019s hyperparameters and performances as shown below:", "And added my baseline model\u2019s performance:", "This is how the performance of KNN looks beyond accuracy. This is a classic example of an accuracy paradox. Since most the seismic bumps are non-hazardous, therefore true negatives(TN) is a much higher number than TP, FP, and FN combined, thereby numerically boosting the accuracy and creating an illusion of predictions being correct but as precision and recall show \u2014 hazardous seismic bumps identification is below 30%.", "Therefore, based on the baseline performance metrics, only 25% of the predicted hazardous bumps are correct and only 5% of the actual hazardous seismic bumps were correctly identified by the model. 93% of the data actually contains non-hazardous seismic bumps and thus the accuracy figures in the cross_val_score makes sense and lies around 93% as well.", "However, as you can see, precision and recall have suffered, let\u2019s look at tuning the hyperparameters using GridSearchCV", "GridSearchCV is a function that takes in possible values or ranges of hyperparameters and runs all combinations of the hyperparameter values specified and calculates the performance based on the scoring metric mentioned. This scoring metric should basically align with the business value or your objectives.", "To see what scoring metrics are provided, this code helps:", "This code will produce the entire list of scoring methods available.", "Next, I defined the hyperparameters for KNN as shown in the code below, and created a dictionary called param_grid that contains the parameters for KNN\u2019s hyperparameters, as defined in Scikit-Learns documentation on KNN, the keys, while the values contain the corresponding list of values.", "Next, I initialized the GridSearchCV with the model, the grid for best hyperparameter search, the cross-validation type, scoring metric as precision and I also used the refit parameter to ensure that the best-evaluated estimator is available as best_estimator_ , which is the fitted model when the training set, made available for making predictions. Verbose determines how much information you want on your screen from the logs.", "And\u2026 I call the fit method to initiate the hyperparameter tuning process.", "Basically, grid_result contains all the outputs, from the fit times to individual scores, and also the best model evaluated based on the passed parameters. grid_result.best_estimator_ contains the chosen values of the best-fitted model\u2019s hyperparameters, optimized based on the scoring metric.", "I experimented with different scoring -", "Model 1 \u2014 scoring : precision", "Model 2 \u2014 scoring : recall", "Following is the summary of the models\u2019 performance:", "If you notice in this grid, the best possible outcome of scoring metrics per model belongs to that respective scoring metric specified in the entire grid, i.e., when the parameter is \u2018precision\u2019, no other model\u2019s performance for \u2018precision\u2019 is as good as Model 1. Similarly, for \u2018recall\u2019, the best in the grid is shared by Model 2 and Model 3. In fact, their performance is the same.", "In Model 1, whose precision is 50%, i.e. 50% of the predicted hazardous seismic bumps were correct, there is a possibility of commenting that this model is only as good as a coin toss. But the coin toss was fair while our dataset isn\u2019t, it is an imbalanced dataset. In a fair coin toss, heads and tails are equally likely to occur but for this dataset, hazardous and non-hazardous seismic bumps are not.", "In Model 2 & Model 3, recall is the highest, which can be interpreted as 14% of the actual hazardous seismic bumps that were correctly identified. The precision is 16% as well. The f1-score is far better than Model 1, which is rather good. The low f1-score of Model 1 is because of the poor recall of 2%, which says that this model could only predict 2% of the actual hazardous seismic bumps, which is no bueno.", "The next model that I chose is Random Forest Classifier, the competition-winning ML model. It is a robust ML model where multiple decision trees are built to ensemble their outputs. The final prediction is a function of all the individual decision tree\u2019s predictions. This why random forest models perform better.", "I started off with initializing a random forest classifier:", "Next, I constructed a grid to find the best-suited parameters:", "I also selected \u2018precision\u2019 again for \u2018scoring\u2019. Here is the complete code:", "The model that followed from this is \u2014", "However, upon predicting the test set, precision is zero.", "Since the random forest model really disappointed me, I thought of using Support Vector Machine (SVM). SVMs belong to the kernel methods group of classification algorithms that are used to fit a decision boundary. Classification is based on which side of the decision boundary is the data-point.", "SVMs are computationally expensive and it can be demoed through this grid search set-up:", "Fitting this grid took over 10 hours which I actually had to interrupt. I checked that a polygon kernel had better results. All linear kernels are fast but had zero precision. In total, this grid was equivalent to 500 fits, 5 folds for every 100 candidates (5 * 5 * 4).", "Therefore, I constructed a new grid as follows:", "This grid had a total of 15 fits and took around 3.5 hours to complete the tuning process.", "Now, following the same process, I looked at the best fitting model like below:", "The default kernel is \u2018rbf\u2019 or Radial Basis Function (RBF). To know more on kernel function, refer to Scikit-learn documentation.", "Here is the final performance results of the SVM:", "This looks much better in terms of precision than all the other models so far. The recall is, however, only marginally better.", "In the table above, accuracy is slightly better in the SVM but the precision has a massive improvement with 67% of the actual number of hazardous seismic bumps are being correctly predicted. However, the recall is 6%, that is, only 6% of the actual hazardous seismic bumps are correct. The f1-score of the KNN model is lower than that of SVM\u2019s.", "Overall, this problem statement would require a better recall due to the risk factor associated with not being able to identify hazardous seismic bumps. The only model that performed better for the recall was KNN with uniform weights, n_neighbours as 1 and leaf_size 10.", "The importance of business requirements varies from case to case. Sometimes recall is preferred (like here) and sometimes precision is preferred. If there is a cost associated with taking action on the predicted outcomes then precision is important, i.e., you would want fewer false positives. A higher recall is desired in cases when a cost is associated with every false negative. In cases, when both are important, f1-score, which is the harmonic mean of precision and recall, gets importance.", "[1] Sikora M., Wrobel L.: Application of rule induction algorithms for analysis of data collected by seismic hazard monitoring systems in coal mines. Archives of Mining Sciences, 55(1), 2010, 91\u2013114.", "Thanks for visiting. I hope you enjoyed reading this blog!", "For more on handling unbalanced class using SMOTE refer to this blog authored by CathL and team:", "My Links: Medium | LinkedIn | GitHub", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist @ EY (UK & Ireland) | Education Lead @ Women in AI Ireland | \u2764 NLP"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8b9104b611b0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nroy0110.medium.com/?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": ""}, {"url": "https://nroy0110.medium.com/?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "Nabanita Roy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd36a8b28c928&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&user=Nabanita+Roy&userId=d36a8b28c928&source=post_page-d36a8b28c928----8b9104b611b0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b9104b611b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b9104b611b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@kctinman?utm_source=medium&utm_medium=referral", "anchor_text": "Shane McLendon"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/predicting-hazardous-seismic-bumps-using-supervised-classification-algorithms-part-i-2c5d21f379bc", "anchor_text": "previous article"}, {"url": "https://github.com/royn5618", "anchor_text": "GitHub repository"}, {"url": "https://unsplash.com/@dsmacinnes?utm_source=medium&utm_medium=referral", "anchor_text": "Danielle MacInnes"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://docs.python.org/3/library/datetime.html", "anchor_text": "datetime python module"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Winkler"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html", "anchor_text": "GridSearchCV"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html", "anchor_text": "Scikit-Learns documentation on KNN"}, {"url": "https://unsplash.com/@lucabravo?utm_source=medium&utm_medium=referral", "anchor_text": "Luca Bravo"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/svm.html#svm-kernels", "anchor_text": "Scikit-learn documentation"}, {"url": "https://medium.com/u/7a033ba6b705?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "CathL"}, {"url": "https://medium.com/womeninai/predicting-hazardous-seismic-bumps-part-iii-improving-model-performance-for-imbalanced-datasets-88fa64b4d622", "anchor_text": "Predicting Hazardous Seismic Bumps Part III: improving model performance for imbalanced datasetsA newbie evaluation on trying out Machine Learning Models for Classification and Data Augmentation to Support better\u2026medium.com"}, {"url": "https://github.com/royn5618/Medium_Blog_Codes/blob/master/Predicting%20Hazardrous%20Seismic%20Bumps/Predicting_Seismic_Bumps.ipynb", "anchor_text": "royn5618/Medium_Blog_CodesPermalink Dismiss GitHub is home to over 50 million developers working together to host and review code, manage\u2026github.com"}, {"url": "https://medium.com/@nroy0110", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/nabanita-roy/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/royn5618", "anchor_text": "GitHub"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8b9104b611b0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/support-vector-machine?source=post_page-----8b9104b611b0---------------support_vector_machine-----------------", "anchor_text": "Support Vector Machine"}, {"url": "https://medium.com/tag/random-forest-classifiers?source=post_page-----8b9104b611b0---------------random_forest_classifiers-----------------", "anchor_text": "Random Forest Classifiers"}, {"url": "https://medium.com/tag/k-nearest-neighbours?source=post_page-----8b9104b611b0---------------k_nearest_neighbours-----------------", "anchor_text": "K Nearest Neighbours"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----8b9104b611b0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8b9104b611b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&user=Nabanita+Roy&userId=d36a8b28c928&source=-----8b9104b611b0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8b9104b611b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&user=Nabanita+Roy&userId=d36a8b28c928&source=-----8b9104b611b0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b9104b611b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8b9104b611b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8b9104b611b0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8b9104b611b0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8b9104b611b0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8b9104b611b0--------------------------------", "anchor_text": ""}, {"url": "https://nroy0110.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nroy0110.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nabanita Roy"}, {"url": "https://nroy0110.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "222 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd36a8b28c928&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&user=Nabanita+Roy&userId=d36a8b28c928&source=post_page-d36a8b28c928--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa0eba44b2636&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hazardous-seismic-bumps-part-ii-training-supervised-classifier-models-and-8b9104b611b0&newsletterV3=d36a8b28c928&newsletterV3Id=a0eba44b2636&user=Nabanita+Roy&userId=d36a8b28c928&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}