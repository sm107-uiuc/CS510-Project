{"url": "https://towardsdatascience.com/remaining-life-estimation-with-keras-2334514f9c61", "time": 1682995919.1202612, "path": "towardsdatascience.com/remaining-life-estimation-with-keras-2334514f9c61/", "webpage": {"metadata": {"title": "Remaining Life Estimation with Keras | by Marco Cerliani | Towards Data Science", "h1": "Remaining Life Estimation with Keras", "description": "Predict rare events is becoming an important topic of research and development in a lot of Artificial Intelligent solutions. Survival Analysis, Customer churn prediction, Predictive Maintenance and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ti.arc.nasa.gov/tech/dash/groups/pcoe/prognostic-data-repository/", "anchor_text": "Dataset", "paragraph_index": 3}, {"url": "https://www.kaggle.com/tigurius/recuplots-and-cnns-for-time-series-classification", "anchor_text": "resource", "paragraph_index": 13}, {"url": "https://towardsdatascience.com/whats-wrong-with-spectrograms-and-cnns-for-audio-processing-311377d7ccd", "anchor_text": "here", "paragraph_index": 13}], "all_paragraphs": ["Predict rare events is becoming an important topic of research and development in a lot of Artificial Intelligent solutions. Survival Analysis, Customer churn prediction, Predictive Maintenance and Anomaly Detection are some examples of the most popular fields of application that deal with rare events. Given these scenarios, we can imagine a rare event as a particular state that occurs under specific conditions, divergent from normal behaviors, but which plays a key role in terms of economic interest.", "In this post, I\u2019ve developed a Machine Learning solution to predict the Remaining Useful Life (RUL) of a particular engine component. This kind of problem plays a key role in the field of Predictive Maintenance, where the purpose is to say \u2018How much time is left before the next fault?\u2019. To achieve this target I developed a Convolutional NN in Keras that deals with time series in the form of images.", "For Data Scientists the most important problem, when dealing with this kind of task, is the lack of rare events in the form of observations available. So the first step to achieving good performance is to try to have at disposal the richest dataset that treats every kind of possible scenario.", "Turbofan Engine Degradation Simulation Dataset, provided by NASA, is becoming an important benchmark in the Remaining Useful Life (RUL) estimation for a fleet of engines of the same type (100 in total). Data are available in the form of time series: 3 operational settings, 21 sensor measurements and cycle \u2014 i.e. observations in terms of time for working life.", "The engine is operating normally at the start of each time series, and develops a fault at some point during the series. In the training set, the fault grows in magnitude until system failure. In the test set, the time series ends some time prior to system failure. The objective is to predict the number of remaining operational cycles before failure in the test set, i.e., the number of operational cycles after the last cycle that the engine will continue to operate.", "To understand better this explanation we try to have a look at the data:", "Engines have different life durations. The average working time in train data is 206 cycles with a minimum of 128 and a maximum of 362.", "The operational settings and sensor measurements, in train set for a singular engine, are plotted belove:", "To plot is always a good idea\u2026 In this way, we can have an impressive and general overview of the data at our disposal. At the end of the majority of the series, we can observe a divergent behavior, which announces a future failure.", "In order to predict the RUL for each engine, we\u2019ve pursued a classification approach, generating the label by ourself in this way:", "From 0 (fault) to 15 remaining cycles, we\u2019ve labeled as 2; from 16 to 45 cycles, we\u2019ve labeled as 1 and the rest (>46) as 0. It is clear that in a realistic scenario, the category labeled as 2 is the most economically valuable. Predict this class with good performance will permit us to operate an adequate program of maintenance, avoiding future faults and saving money.", "In order to have at our disposal the maximum number of data for the train, we split the series with a fixed window and a sliding of 1 step. For example, engine1 have 192 cycles in train, with a window length equal to 50 we extract 142 time series with length 50:window1 -> from cycle0 to cycle50, window2 -> from cycle1 to cycle51, \u2026 , window142 -> from cycle141 to cycle50, window191. Each window is labeled with the corresponding label of the final cycle taken into account by the window.", "To make things more interesting I have decided to transform the series at our disposal in images; in order to feed our classification model with them.", "I\u2019ve created the images following this amazing resource. The concept is simple\u2026 when we try to transform time series into images we always make use of spectrogram. This choice is clever but not always the best one (as you can read here). In this post, the author explains his justified perplexity about dealing with audio series with a spectrogram representation. He talks about sound but the meaning can be translated in our scenario. Spectrograms are powerful but their usage may result in a loss of information, particularly if we try to approach the problem in a computer vision way. To be efficient a 2D CNN requires spatial invariance; this builds on the assumption that features of a classical image (like a photo) carry the same meaning regardless of their location. On the other side, a spectrogram implies a two dimensions representation made by two different units (frequency and time).", "For these reasons, I decided to transform my time series windows (of length 50 cycles) making use of Recurrence Plots. They are easy to implement in python with a few lines of code, making use of Scipy.", "With this function, we are able to generate an image of 50x50 for every time series at our disposal (I\u2019ve excluded the constant time series with 0 variances). So every single observation is made by an array of images of size 50x50x17 (17 are the time series with no zero variance) like below.", "At this point, we are ready to build our model. I\u2019ve adopted a classical 2D CNN architecture:", "I fit it for only 10 epochs and I\u2019ve achieved an ACCURACY of 0.832%.", "From the confusion matrix we can see that our model can well discriminate when an engine is close to failure (2 labels: <16 cycles remaining) or when it works normally (0 label: >45 cycles). A little bit of noise is present in the intermediate class (>15, <46 cycles). We are satisfied to achieve a great and clear result for the prediction of class 2 \u2014 i.e. near to failure.", "In this post, we try to solve a Predictive Maintenance problem. Estimating RUL of engines we are conscious to deal with rare events, due to the difficulty to collect this kind of data. We propose an interesting solution transforming time series into images, making use of Recurrence Plots. In this way, we are able to discriminate well engines which are at the end of their working life.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2334514f9c61&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2334514f9c61--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2334514f9c61--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----2334514f9c61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----2334514f9c61--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----2334514f9c61---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2334514f9c61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2334514f9c61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@spacex?utm_source=medium&utm_medium=referral", "anchor_text": "SpaceX"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://ti.arc.nasa.gov/tech/dash/groups/pcoe/prognostic-data-repository/", "anchor_text": "Dataset"}, {"url": "https://www.kaggle.com/tigurius/recuplots-and-cnns-for-time-series-classification", "anchor_text": "resource"}, {"url": "https://towardsdatascience.com/whats-wrong-with-spectrograms-and-cnns-for-audio-processing-311377d7ccd", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html", "anchor_text": "sklearn documentation"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2334514f9c61---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/predictive-maintenance?source=post_page-----2334514f9c61---------------predictive_maintenance-----------------", "anchor_text": "Predictive Maintenance"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2334514f9c61---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----2334514f9c61---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2334514f9c61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&user=Marco+Cerliani&userId=c843902314c7&source=-----2334514f9c61---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2334514f9c61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&user=Marco+Cerliani&userId=c843902314c7&source=-----2334514f9c61---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2334514f9c61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2334514f9c61--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2334514f9c61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2334514f9c61---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2334514f9c61--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2334514f9c61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2334514f9c61--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2334514f9c61--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2334514f9c61--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2334514f9c61--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2334514f9c61--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2334514f9c61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fremaining-life-estimation-with-keras-2334514f9c61&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}