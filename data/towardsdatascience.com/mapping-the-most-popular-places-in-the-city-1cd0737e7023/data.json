{"url": "https://towardsdatascience.com/mapping-the-most-popular-places-in-the-city-1cd0737e7023", "time": 1682996353.714231, "path": "towardsdatascience.com/mapping-the-most-popular-places-in-the-city-1cd0737e7023/", "webpage": {"metadata": {"title": "Mapping the most popular places in the city | by Maradona Morais | Towards Data Science", "h1": "Mapping the most popular places in the city", "description": "Some studies related to analyze human behavior, big cities, consumption of services and others are of my interest when the term \u201cdata science\u201d comes up. Last time working with it I made a map for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/mrmorais/uber-map-natal", "anchor_text": "map for Uber services in Natal", "paragraph_index": 0}, {"url": "https://github.com/mrmorais/behavior-map-natal", "anchor_text": "GitHub", "paragraph_index": 4}, {"url": "https://colab.research.google.com/drive/1TW67ytLbvg6WOGxVy8rPXpfNsie420pg", "anchor_text": "interactives Colab notebooks", "paragraph_index": 4}, {"url": "https://developers.google.com/places/web-service/intro", "anchor_text": "Google Places API", "paragraph_index": 6}, {"url": "https://developers.google.com/places/web-service/get-api-key", "anchor_text": "access token", "paragraph_index": 6}, {"url": "https://developers.google.com/places/web-service/search#PlaceSearchRequests", "anchor_text": "Nearby Search", "paragraph_index": 7}, {"url": "https://github.com/m-wrzr/populartimes", "anchor_text": "this repo", "paragraph_index": 8}, {"url": "https://kepler.gl/", "anchor_text": "Kepler.gl", "paragraph_index": 17}, {"url": "https://mrmorais.github.io/others/behavior-map-natal/keplergl.html", "anchor_text": "this address", "paragraph_index": 18}, {"url": "https://mrmorais.github.io", "anchor_text": "https://mrmorais.github.io", "paragraph_index": 28}], "all_paragraphs": ["Some studies related to analyze human behavior, big cities, consumption of services and others are of my interest when the term \u201cdata science\u201d comes up. Last time working with it I made a map for Uber services in Natal, Brazil, interested in see how central neighborhoods are better attended. This time, the interest came from a Google Search feature for places: the \u201cPopular times.\u201d", "Google, smart as it is, can show us (sometimes even \u201clive\u201d) how busy is the place you searched. So\u2026", "What if I compare several places based on popular times? and discover which times certain types of places are more popular than others? many questions can be asked working with that kind of data.", "So, why not get different types of places in a 15 miles radius from the center of Natal (city I live in), then catch the popular times data for each place and plot a interactive map with that data? That\u2019s what we\u2019re doing here.", "I\u2019ll try to explain, with enough detail to don\u2019t make this article annoying, how I did and how this experiment can be replicated. The technologies used here are Python, pandas and folium libraries. If you want to learn more about, the code is available on GitHub, such as interactives Colab notebooks in which you can upload your own database and generate the maps.", "Before plotting maps, we have to extract the data we\u2019ll need. It will be necessary two types of data: a set of places in Natal and for each of these places, the data about popular moments.", "We are going to use Google Places API in order to get the places. There are several services offered by this API, for all of them you\u2019ll need a access token to consume data.", "I used the \u201cNearby Search\u201d to look for places near to a point in the center of Natal and with 15 miles of radius. The read_places.py script search these places selecting by types (gym, supermarket, bank\u2026) \u2014 for each type I defined the number of places I want; this way I\u2019ll have the most relevant results. Then, the script saves the .csv file for the places dataset as places.csv .", "Now we\u2019ve got the places. With the filters and boundaries I setted we\u2019ve got 800 places in Natal. The next step is catch all popular times for each of these. Looking for that topic in the Places API documentation you will note that there is no metion to any \u201cpopular times\u201d (at least not until today, May 2019.) But with a quick Google search I found this repo that give us access to this service. It is said in the repo that Google does allow that kind of requesition but it is not for free, the API call is SKU\u2019d as \u201cFind Current Place\u201d. You can make 5000 calls to this API with the alloted monthly budget.", "Using that API the get_places_popular_moments.py reads the places dataset and includes the popular moments on it, generating a new places_with_moments.csv dataset. Now, we supposed to have 800 places, but instead we have only 300 because there are no \u201cpopular times\u201d for every place.", "By now our dataset looks like this:", "For each weekday column there is a 24 positions with moment values for each hour of a day.", "Now we would like to visualize these data in a pretty and interactive map. We\u2019ll use Folium \u2014 a Python library based on leaflet.js to visualize maps.", "Here\u2019s the map of popular moments for places in Natal on mondays 10 a.m. The circle\u2019s color means the place\u2019s type and the size, the moment value.", "The piece of code that generate this map is this one:", "It takes as parameter a week day, an hour and, optionally, a subset of places types. The first thing it does is create a new map natal and for each desired type it creates a FeatureGroup . This resource allows us to create a menu on the map with the option to toggle types.", "Looping through all items on dataset we add each item to the corresponding FeatureGroup.", "Going deeper in the colab notebook you\u2019ll see that there is a modification on the dataset that adapts it to using with Kepler.gl \u2014 a powerfull web tool to geospatial analysis. Kepler gives us more resources than Folium and with a extremely good performance. So we can do this:", "The animation above was generated using Kepler and allows us to see the movimentation flow in Natal during the week. Kepler also alows us to export the environment to make it acessible online, in this address you can access that map above.", "The information about popular times at first glance doesn\u2019t means a lot. What Google means with \u201cthe place is 100 crowded\u201d? It\u2019s a density scale of people in the place? What means, in the end, these popular times data?", "Analysing better some values, I realized that a \u201cmomet\u201d scale goes from 0 to 100, which leads to classifications like \u201cUsually not too busy\u201d or \u201cUsually a little busy\u201d, for instance. But my real question is \u201chow much that information means something?\u201d", "To undestand it better I went for another approach, interested in find some useful informations in that dataset. So here\u2019s what I found:", "This is a good one. The gym flow shown in the graph is a common sense confirmation: gyms are busier on Mondays and less busy on Fridays. The rush hour is around 20 p.m.", "Most of the charts do not have peak hours at lunch time, this is different with airports, which is busier at 12 pm", "On Fridays afternoon the medical clinics have a decline.", "People in Natal prefer to go to the hairdresser on Fridays afternoon.", "These are some of the interesting information that can be inferred from the date we have obtained. Overall, I was pleased that the data was compatible with reality, which led me to believe that the is, indeed, a meaning in \u201cpopular times\u201d data. These results may lead us to interesting analyzes that may be meaningful for understanding behavior in Natal and, of course, other cities.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I.T. student. Developer. Data science, Cloud Native, Microservices, Functional Programming. https://mrmorais.github.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1cd0737e7023&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mrmorais.medium.com/?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": ""}, {"url": "https://mrmorais.medium.com/?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": "Maradona Morais"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbace27dc934c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&user=Maradona+Morais&userId=bace27dc934c&source=post_page-bace27dc934c----1cd0737e7023---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cd0737e7023&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cd0737e7023&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/mrmorais/uber-map-natal", "anchor_text": "map for Uber services in Natal"}, {"url": "https://github.com/mrmorais/behavior-map-natal", "anchor_text": "GitHub"}, {"url": "https://colab.research.google.com/drive/1TW67ytLbvg6WOGxVy8rPXpfNsie420pg", "anchor_text": "interactives Colab notebooks"}, {"url": "https://developers.google.com/places/web-service/intro", "anchor_text": "Google Places API"}, {"url": "https://developers.google.com/places/web-service/get-api-key", "anchor_text": "access token"}, {"url": "https://developers.google.com/places/web-service/search#PlaceSearchRequests", "anchor_text": "Nearby Search"}, {"url": "https://github.com/m-wrzr/populartimes", "anchor_text": "this repo"}, {"url": "https://kepler.gl/", "anchor_text": "Kepler.gl"}, {"url": "https://mrmorais.github.io/others/behavior-map-natal/keplergl.html", "anchor_text": "this address"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1cd0737e7023---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1cd0737e7023&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&user=Maradona+Morais&userId=bace27dc934c&source=-----1cd0737e7023---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1cd0737e7023&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&user=Maradona+Morais&userId=bace27dc934c&source=-----1cd0737e7023---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1cd0737e7023&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1cd0737e7023&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1cd0737e7023---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1cd0737e7023--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1cd0737e7023--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1cd0737e7023--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1cd0737e7023--------------------------------", "anchor_text": ""}, {"url": "https://mrmorais.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mrmorais.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maradona Morais"}, {"url": "https://mrmorais.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "29 Followers"}, {"url": "https://mrmorais.github.io", "anchor_text": "https://mrmorais.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbace27dc934c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&user=Maradona+Morais&userId=bace27dc934c&source=post_page-bace27dc934c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcb937f100654&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmapping-the-most-popular-places-in-the-city-1cd0737e7023&newsletterV3=bace27dc934c&newsletterV3Id=cb937f100654&user=Maradona+Morais&userId=bace27dc934c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}