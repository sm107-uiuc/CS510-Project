{"url": "https://towardsdatascience.com/build-your-first-random-forest-classifier-cbc63a956158", "time": 1683012415.530943, "path": "towardsdatascience.com/build-your-first-random-forest-classifier-cbc63a956158/", "webpage": {"metadata": {"title": "Build Your First Random Forest Classifier | by Magdalena Konkiewicz | Towards Data Science", "h1": "Build Your First Random Forest Classifier", "description": "In this post, I will guide you through building a simple classifier using Random Forest from the scikit-learn library. We will start by downloading data set from Kaggle, after that, we will do some\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "link", "paragraph_index": 4}, {"url": "https://www.aboutdatablog.com/post/build-your-first-random-forest-classifier-and-predict-heart-disease-across-patients", "anchor_text": "Build your first random forest classifier", "paragraph_index": 62}, {"url": "https://www.aboutdatablog.com/", "anchor_text": "aboutdatablog.com", "paragraph_index": 63}, {"url": "https://medium.com/subscribe/@konkiewicz.m", "anchor_text": "email list", "paragraph_index": 63}, {"url": "https://medium.com/@konkiewicz.m/membership", "anchor_text": "here", "paragraph_index": 63}, {"url": "http://aboutdatablog.com", "anchor_text": "aboutdatablog.com", "paragraph_index": 66}, {"url": "https://medium.com/@konkiewicz.m/membership", "anchor_text": "https://medium.com/@konkiewicz.m/membership", "paragraph_index": 66}], "all_paragraphs": ["In this post, I will guide you through building a simple classifier using Random Forest from the scikit-learn library.", "We will start by downloading data set from Kaggle, after that, we will do some basic data cleaning, and finally, we will fit the model and evaluate it. On the way, we will also create a baseline model that will be used for evaluation.", "This article is suitable for beginner Data Scientists who would like to see the basic workflow for the Machine Leaning project and build their first classifier.", "Downloading and loading the data set", "We will be working with Heart Disease Data set that can be downloaded from Kaggle using this link.", "This data set consists of almost 300 hundred patients that either have or do not have heart issues. This is what we will be predicting.", "In order to do this, we will use thirteen different features:", "Take time to familiarize yourself with these descriptions now so you have an understanding of what each column represents.", "Once you have downloaded the data set and placed it in the same folder as your Jupyter notebook file, you can use the following commands to load the data set.", "This is the head of the data frame that you will be working with.", "Did you spot question marks in the data frame above? It looks like the author of this data set have used them to indicate null values. Let\u2019s replace them with real Nones.", "Now that we have done that we can inspect how many null values are in our data set. We can do this with info() function.", "We can see here that columns 10, 11, and 12 have a lot of nulls. \u2018 Ca\u2019 and \u2018thal\u2019 are actually almost empty and \u2018slope\u2019 has only 104 entries. This is too many missing values to fill in so let\u2019s drop them.", "The rest of the columns have none or little missing values. For simplicity, I suggest dropping the entries that do have them. We should not lose too much data.", "Another information that we could read from the result of the info() function is the fact that most of the columns are objects even though they seem to have numeric values.", "My suspicion is that this was caused by the question marks in the initial data set. Now that we have removed them we should be able to change the objects to numeric values.", "In order to do this, we will use pd.to_numeric() function on the whole data frame. The object values should become numbers and it should not affect the values that already numbers.", "As you can see we are now left only with floats and integers. The info() function also confirm that the columns \u2018 Ca\u2019, \u2018thal\u2019, and \u2018slope\u2019 were dropped.", "Also, rows with null values got removed and as a result, we have a data set with 261 numeric variables.", "There is one more thing we need to do before we can proceed. I have noticed that the last column \u2018num\u2019 has some trailing spaces in its name (you cannot see this with a bare eye) so let\u2019s have a look at the list of column names.", "You should see the trailing spaces in the last column \u2018num\u2019. Let\u2019s remove them by applying strip() function.", "Let\u2019s do some basic data analysis. We are going to look at the distribution of variables using histograms first.", "What we can notice straight away is the fact that some variables are not continuous. Actually, only five features are continuous:\u2019\u2019age\u2019, \u2018chol\u2019, \u2018oldpeak\u2019, \u2018thalach\u2019, \u2018trestbps\u2019 whereas the other are categorical variables.", "Because we want to treat them differently in our exploration we should divide them into two groups.", "After doing this you can check their values by typing the variable names in Jupyter notebook cell.", "Now we would like to inspect how the continuous features differ across the target variable. We will do this with a scatterplot.", "* Note that we had to make the \u2018num\u2019 variable a string in order to use it as a hue parameter. We did it by mapping 0s to \u2018no\u2019 meaning healthy patients, and 1s to \u2018yes\u2019 meaning patients with heart disease.", "If you look at the scatterplots and kdes you can see that there are district patterns for patients with heart disease in comparison to patients who are healthy.", "In order to explore categorical variables, we will look at distinct values they can take by using describe() function.", "We can see that \u2018 exang\u2019, \u2018fbs\u2019 and \u2018sex\u2019 are binary (they take only two distinct values). Whereas \u2018cp\u2019 and \u2018resteceg\u2019 take respectively four and three distinct values.", "The last two are ordered categorical variables as encoded by the data set authors. I am not sure if we should treat them like that or change them to dummy encodings. This would need further investigation and we could change the approach in the future. For now, we will leave them ordered.", "Last but not least we are going to explore the target variable.", "We have 163 healthy patients and 98 patients with heart problems. Not ideally balanced data set but that should be ok for our purposes.", "After a quick exploratory data analysis, we are ready to build an initial classifier. We are going to start by dividing the data set into features and the target variable.", "* Note that I have to reverse the mapping I have applied while creating a seaborn graph, therefore, a need for map() function while creating y variable.", "We also have used all features that the data set had as by looking at our quick EDA they all seemed relevant.", "Now we will divide X and y variables further into their train and test correspondents using train_test_split() function.", "As a result of the above operations, we should have now four different variables: X_train, X_test, y_train, y_test whose dimensions are printed above.", "Now we will build a baseline using a DummyClassifier.", "As you can see the baseline classifier is giving us 62% accuracy on the train set. The strategy for our baseline is predicting the most frequent class.", "Let\u2019s see if we can beat it with Random Forest.", "The code below sets a Random Forest Classifier and uses cross-validation to see how well it performs on different folds.", "As you can see these accuracies are in general much higher than our dummy baseline. Only the last fold has lower accuracy. It looks like this last fold has examples that are hard to recognize.", "Nevertheless, if we take the average of those five, we get an accuracy of around 74%, and this is much higher than 62% baseline.", "Normally this is a stage where we would like to further tune model parameters using for example GridSearchCV but this is not a part of this tutorial.", "Let\u2019s see how well the model performs on the test set now. If you have paid attention we have not done anything with the test so far. It has been left alone until now.", "We will start by checking model performance in terms of accuracy.", "First, we will fit the model using the whole training data, and then we will call the accuracy_score() function on the test parts.", "We are getting 75% accuracy on the test. Similar to our average cross-validation accuracy calculation on the train set which was 74%.", "Let\u2019s see how well the Dummy classifier does on the test set.", "Accuracy for the baseline classifier is around 51%. This is actually much worse than the accuracy of our random forest model.", "However, we should not only look at accuracy when evaluating a classifier. Let\u2019s have a looks at confusion matrices for both random forest and the baseline model.", "We will start with computing confusion matrix for Random Forest using scikit-learn function.", "Actually we are not doing bad at all. We only have five False Positives, and also eight False Negatives. Additionally, we have predicted heart disease for eighteen people out of twenty-six people that had heart problems.", "Not great but not that bad. Note that we did not even tune the model!", "Let\u2019s compare this confusion matrix with the one calculated for the baseline model.", "Have a closer look at the graph above. Can you see that we always predict label 0? This means we predict that all patients are healthy!", "That is right, we have set our Dummy Classifier to predict the majority class. Note that it would be a terrible model for our purposes as we would not discover any patients with heart issues.", "Random Forest did much better! We actually have discovered 18 people with heart problems out of 26 in the test set.", "In this post, you have learned how to build a basic classifier using Random Forest.", "It was rather an overview of the main techniques that are used when building a model on a data set without going into too many details.", "This was intended so this article does not get too long and serves as a starting point for someone who wants to build their first classifier.", "Originally published at aboutdatablog.com: Build your first random forest classifier, on August 13, 2020.", "PS: I am writing articles that explain basic Data Science concepts in a simple and comprehensible manner on Medium and aboutdatablog.com. You can subscribe to my email list to get notified every time I write a new article. And if you are not a Medium member yet you can join here.", "Below there are some other posts you may enjoy:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, NLP, ML practitioner, and educator. Blogging from Medium and aboutdatablog.com. Support my writing: https://medium.com/@konkiewicz.m/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcbc63a956158&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cbc63a956158--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cbc63a956158--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@konkiewicz.m?source=post_page-----cbc63a956158--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konkiewicz.m?source=post_page-----cbc63a956158--------------------------------", "anchor_text": "Magdalena Konkiewicz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6ba7ed0ad871&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=post_page-6ba7ed0ad871----cbc63a956158---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcbc63a956158&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcbc63a956158&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "link"}, {"url": "https://www.aboutdatablog.com/post/build-your-first-random-forest-classifier-and-predict-heart-disease-across-patients", "anchor_text": "Build your first random forest classifier"}, {"url": "https://www.aboutdatablog.com/", "anchor_text": "aboutdatablog.com"}, {"url": "https://medium.com/subscribe/@konkiewicz.m", "anchor_text": "email list"}, {"url": "https://medium.com/@konkiewicz.m/membership", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/medium-writers-you-should-follow-as-an-aspiring-data-scientist-13d5a7e6c5dc", "anchor_text": "Medium writers you should follow as an aspiring Data ScientistMy top 10 favorite Data Science Bloggers that will make your learning journey easier.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/pandas-profiling-and-exploratory-data-analysis-with-line-one-of-code-423111991e58", "anchor_text": "Pandas profiling and exploratory data analysis with line one of code!Learn how to install and use pandas profiling for automatic EDAtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/jupyter-notebook-autocompletion-f291008c66c", "anchor_text": "Jupyter notebook autocompletionThe best productivity tool for Data Scientist you should be using if you are not doing it yet\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/top-9-jupyter-notebook-extensions-7a5d30269bc8", "anchor_text": "Top 9 Jupyter Notebook extensionsImprove notebook functionality and boost your productivitytowardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cbc63a956158---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cbc63a956158---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----cbc63a956158---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----cbc63a956158---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----cbc63a956158---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcbc63a956158&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=-----cbc63a956158---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcbc63a956158&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=-----cbc63a956158---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcbc63a956158&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cbc63a956158--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcbc63a956158&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cbc63a956158---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cbc63a956158--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cbc63a956158--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cbc63a956158--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cbc63a956158--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cbc63a956158--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cbc63a956158--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cbc63a956158--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cbc63a956158--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konkiewicz.m?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@konkiewicz.m?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Magdalena Konkiewicz"}, {"url": "https://medium.com/@konkiewicz.m/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.5K Followers"}, {"url": "http://aboutdatablog.com", "anchor_text": "aboutdatablog.com"}, {"url": "https://medium.com/@konkiewicz.m/membership", "anchor_text": "https://medium.com/@konkiewicz.m/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6ba7ed0ad871&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=post_page-6ba7ed0ad871--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9d790b04b3c0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-your-first-random-forest-classifier-cbc63a956158&newsletterV3=6ba7ed0ad871&newsletterV3Id=9d790b04b3c0&user=Magdalena+Konkiewicz&userId=6ba7ed0ad871&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}