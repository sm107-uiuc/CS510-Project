{"url": "https://towardsdatascience.com/understanding-and-coding-a-resnet-in-keras-446d7ff84d33", "time": 1682994468.517607, "path": "towardsdatascience.com/understanding-and-coding-a-resnet-in-keras-446d7ff84d33/", "webpage": {"metadata": {"title": "Understanding and Coding a ResNet in Keras | by Priya Dwivedi | Towards Data Science", "h1": "Understanding and Coding a ResNet in Keras", "description": "ResNet, short for Residual Networks is a classic neural network used as a backbone for many computer vision tasks. This model was the winner of ImageNet challenge in 2015. The fundamental\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ResNet", "paragraph_index": 0}, {"url": "https://www.deeplearning.ai/", "anchor_text": "DeepLearning.AI", "paragraph_index": 3}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/tree/master/resnet_keras", "anchor_text": "Github repo", "paragraph_index": 4}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/blob/master/resnet_keras/Residual_Networks_yourself.ipynb", "anchor_text": "notebook", "paragraph_index": 9}, {"url": "https://people.eecs.berkeley.edu/~jonlong/long_shelhamer_fcn.pdf", "anchor_text": "Fully Convolutional Network (FCN)", "paragraph_index": 12}, {"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "U-Net", "paragraph_index": 12}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/blob/master/resnet_keras/Residual_Networks_yourself.ipynb", "anchor_text": "notebook", "paragraph_index": 13}, {"url": "https://keras.io/applications/", "anchor_text": "library", "paragraph_index": 18}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/blob/master/resnet_keras/Residual_Network_Keras.ipynb", "anchor_text": "notebook", "paragraph_index": 19}, {"url": "http://deeplearninganalytics.org/", "anchor_text": "http://deeplearninganalytics.org/", "paragraph_index": 24}, {"url": "https://medium.com/@priya.dwivedi", "anchor_text": "https://medium.com/@priya.dwivedi", "paragraph_index": 25}], "all_paragraphs": ["ResNet, short for Residual Networks is a classic neural network used as a backbone for many computer vision tasks. This model was the winner of ImageNet challenge in 2015. The fundamental breakthrough with ResNet was it allowed us to train extremely deep neural networks with 150+layers successfully. Prior to ResNet training very deep neural networks was difficult due to the problem of vanishing gradients.", "AlexNet, the winner of ImageNet 2012 and the model that apparently kick started the focus on deep learning had only 8 convolutional layers, the VGG network had 19 and Inception or GoogleNet had 22 layers and ResNet 152 had 152 layers. In this blog we will code a ResNet-50 that is a smaller version of ResNet 152 and frequently used as a starting point for transfer learning.", "However, increasing network depth does not work by simply stacking layers together. Deep networks are hard to train because of the notorious vanishing gradient problem \u2014 as the gradient is back-propagated to earlier layers, repeated multiplication may make the gradient extremely small. As a result, as the network goes deeper, its performance gets saturated or even starts degrading rapidly.", "I learnt about coding ResNets from DeepLearning.AI course by Andrew Ng. I highly recommend this course.", "On my Github repo, I have shared two notebooks one that codes ResNet from scratch as explained in DeepLearning.AI and the other that uses the pretrained model in Keras. I hope you pull the code and try it for yourself.", "ResNet first introduced the concept of skip connection. The diagram below illustrates skip connection. The figure on the left is stacking convolution layers together one after the other. On the right we still stack convolution layers as before but we now also add the original input to the output of the convolution block. This is called skip connection", "It can be written as two lines of code :", "The coding is quite simple but there is one important consideration \u2014 since X, X_shortcut above are two matrixes, you can add them only if they have the same shape. So if the convolution + batch norm operations are done in a way that the output shape is the same,then we can simply add them as shown below.", "Otherwise, the x_shortcut goes through a convolution layer chosen such that the output from it is the same dimension as the output from the convolution block as shown below:", "In the notebook on Github, the two functions identity_block and convolution_block implement above. These functions use Keras to implement Convolution and Batch Norm layers with ReLU activation. Skip connection is technically the one line X = Add()([X, X_shortcut]).", "One important thing to note here is that the skip connection is applied before the RELU activation as shown in the diagram above. Research has found that this has the best results.", "This is an interesting question. I think there are two reasons why Skip connections work here:", "Infact since ResNet skip connections are used in a lot more model architectures like the Fully Convolutional Network (FCN) and U-Net. They are used to flow information from earlier layers in the model to later layers. In these architectures they are used to pass information from the downsampling layers to the upsampling layers.", "The identity and convolution blocks coded in the notebook are then combined to create a ResNet-50 model with the architecture shown below:", "The ResNet-50 model consists of 5 stages each with a convolution and Identity block. Each convolution block has 3 convolution layers and each identity block also has 3 convolution layers. The ResNet-50 has over 23 million trainable parameters.", "I have tested this model on the signs data set which is also included in my Github repo. This data set has hand images corresponding to 6 classes. We have 1080 train images and 120 test images.", "Our ResNet-50 gets to 86% test accuracy in 25 epochs of training. Not bad!", "I loved coding the ResNet model myself since it allowed me a better understanding of a network that I frequently use in many transfer learning tasks related to image classification, object localization, segmentation etc.", "However for more regular use it is faster to use the pretrained ResNet-50 in Keras. Keras has many of these backbone models with their Imagenet weights available in its library.", "I have uploaded a notebook on my Github that uses Keras to load the pretrained ResNet-50. You can load the model with 1 line code:", "Here weights=None since I want to initialize the model with random weights as I did on the ResNet-50 I coded. Otherwise I can also load the pretrained ImageNet weights. I set include_top=False to not include the final pooling and fully connected layer in the original model. I added Global Average Pooling and a dense output layaer to the ResNet-50 model.", "As shown above Keras provides a very convenient interface to load the pretrained models but it is important to code the ResNet yourself as well at least once so you understand the concept and can maybe apply this learning to another new architecture you are creating.", "The Keras ResNet got to an accuracy of 75% after training on 100 epochs with Adam optimizer and a learning rate of 0.0001. The accuracy is a bit lower than our own coded model and I guess this has to do with weight initializations.", "Keras also provides an easy interface for data augmentation so if you get a chance, try augmenting this data set and see if that results in better performance.", "I have my own deep learning consultancy and love to work on interesting problems. I have helped many startups deploy innovative AI based solutions. Check us out at \u2014 http://deeplearninganalytics.org/.", "You can also see my other writings at: https://medium.com/@priya.dwivedi", "If you have a project that we can collaborate on, then please contact me through my website or at info@deeplearninganalytics.org", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F446d7ff84d33&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438----446d7ff84d33---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F446d7ff84d33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F446d7ff84d33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ResNet"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "DeepLearning.AI"}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/tree/master/resnet_keras", "anchor_text": "Github repo"}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/blob/master/resnet_keras/Residual_Networks_yourself.ipynb", "anchor_text": "notebook"}, {"url": "https://people.eecs.berkeley.edu/~jonlong/long_shelhamer_fcn.pdf", "anchor_text": "Fully Convolutional Network (FCN)"}, {"url": "https://arxiv.org/abs/1505.04597", "anchor_text": "U-Net"}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/blob/master/resnet_keras/Residual_Networks_yourself.ipynb", "anchor_text": "notebook"}, {"url": "https://keras.io/applications/", "anchor_text": "library"}, {"url": "https://github.com/priya-dwivedi/Deep-Learning/blob/master/resnet_keras/Residual_Network_Keras.ipynb", "anchor_text": "notebook"}, {"url": "http://deeplearninganalytics.org/", "anchor_text": "http://deeplearninganalytics.org/"}, {"url": "https://medium.com/@priya.dwivedi", "anchor_text": "https://medium.com/@priya.dwivedi"}, {"url": "https://www.deeplearning.ai/", "anchor_text": "DeepLearning.AI"}, {"url": "https://keras.io/applications/", "anchor_text": "Keras"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ReNet Paper"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----446d7ff84d33---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----446d7ff84d33---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----446d7ff84d33---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----446d7ff84d33---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----446d7ff84d33---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F446d7ff84d33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&user=Priya+Dwivedi&userId=b040ce924438&source=-----446d7ff84d33---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F446d7ff84d33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&user=Priya+Dwivedi&userId=b040ce924438&source=-----446d7ff84d33---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F446d7ff84d33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F446d7ff84d33&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----446d7ff84d33---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----446d7ff84d33--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----446d7ff84d33--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----446d7ff84d33--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----446d7ff84d33--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://priya-dwivedi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.1K Followers"}, {"url": "http://www.deeplearninganalytics.org/", "anchor_text": "http://www.deeplearninganalytics.org/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F373349a3bfb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-and-coding-a-resnet-in-keras-446d7ff84d33&newsletterV3=b040ce924438&newsletterV3Id=373349a3bfb7&user=Priya+Dwivedi&userId=b040ce924438&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}