{"url": "https://towardsdatascience.com/pneumonia-detection-using-deep-learning-5dc66468eb9", "time": 1683010101.020154, "path": "towardsdatascience.com/pneumonia-detection-using-deep-learning-5dc66468eb9/", "webpage": {"metadata": {"title": "Pneumonia Detection using Deep Learning | by Allen Kong | Towards Data Science", "h1": "Pneumonia Detection using Deep Learning", "description": "With the recent outbreak of COVID-19 also known as the coronavirus, it does seem like history is repeating itself and we are going back in time to the 1900s during the spanish influenza. The\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia", "anchor_text": "Chest X-Ray Images (Pneumonia)", "paragraph_index": 2}], "all_paragraphs": ["With the recent outbreak of COVID-19 also known as the coronavirus, it does seem like history is repeating itself and we are going back in time to the 1900s during the spanish influenza. The coronavirus is a deadly virus that has claimed hundreds of thousands of lives in countries around the world. Older adults and people who have severe underlying medical conditions or prior cases of pneumonia seem to be at higher risk for developing more serious complications from the virus. With rising deaths and limited medical resources, doctors and medical professionals around the world are working around the clock to treat patients and prevent the spread of the virus. Severe forms of the virus can cause pneumonia leading to greater risk of death. It is crucial to have quick and accurate detection of pneumonia so patients can receive treatment in a timely manner especially in impoverished regions.", "With the growing technological advancements we have in this day and age, it is possible to use tools based on deep learning frameworks to detect pneumonia based on chest x-ray images. The challenge here would be to aid the diagnosis process which allows for expedited treatment and better clinical outcomes.", "The dataset that will be used for this project will be the Chest X-Ray Images (Pneumonia) from Kaggle. The dataset consists of training data, validation data, and testing data. The training data consists of 5,216 chest x-ray images with 3,875 images shown to have pneumonia and 1,341 images shown to be normal. The validation data is relatively small with only 16 images with 8 cases of pneumonia and 8 normal cases. The testing data consists of 624 images split between 390 pneumonia cases and 234 normal cases.", "As shown from the training data, we can see that the data is very imbalanced. There appears to be almost three times more pneumonia cases than normal cases which makes sense because this is medical data. Since the validation data is a small sample, I will just combine it with the training data and shuffle the new dataset before applying a training/validation split.", "After exploring some of the images in the dataset, I noticed that some images were grayscale 1-channel and others were 3-channel. Before doing any transforms and data loading, the data needs to be consistent so I decided to convert all single channel images to 3-channel images. This is done simply by repeating the single channel values 3 times as shown in my code below for the PneumoniaDataset class.", "For the training set and validation set, I decided to do a 80/20 split. For the data transforms, I chose to resize the images to a (256, 256) size and use a 90 degree affine transformation. Data transformation or augmentation is a powerful technique which helps in almost every case for improving the robustness of a model. This technique can prove to be even more helpful when the dataset is imbalanced. You can generate different samples of undersampled classes in order to try to balance the overall distribution. For the sake of simplicity, I will just use the original dataset. For the batch size, I will use a size of 16 since a lower batch size will help prevent our model from overfitting. Let\u2019s take a quick look at some of the images in our training and validation sets.", "After carefully looking at the images, it would be hard for anyone besides medical professionals to distinguish between a normal case and a pneumonia case. If we\u2019re able to build a strong model, it would certainly help medical professionals a lot in their work which hopefully, in the end, helps them save time and money.", "Our initial model will be a simple 8-layer convolutional neural network with max pooling and a ReLU activation function. Let\u2019s see how well the model does with the validation and testing set.", "We can see that our model does quite well with the training and validation datasets but failed to classify not even half of the images from the testing set correctly. Our model is definitely overfitting so we need to introduce some regularization techniques that can help with this issue. Let\u2019s define a new model with batch normalization and dropout, two common regularization techniques that are very useful in preventing overfitting.", "With the introduction of batch normalization, dropout, and a few more layers, this model proves to be much better than the previous model. It is now able to classify more than half of the images in the testing dataset correctly. However, this is still not good enough to be used in the real world comfortably. The models that we\u2019ve used so far are not complex enough to capture the intricacies of the images. To solve this issue, we use the optimization technique of transfer learning where we repurpose complex models trained for one purpose on another. In this case, we will use a pretrained residual network that is trained on the ImageNet dataset and repurpose that model to our chest x-rays dataset. We will use a 34 layer residual network with dropout in the last layer and see how well it compares to the previous models.", "A testing accuracy of about 83% which is definitely an improvement from the prior two models. This shows the power and effectiveness of using transfer learning to solve general image problems. While the testing accuracy has increased significantly, it is still questionable whether or not this is good enough to be deployed into the real world. Let\u2019s try the model on a few test images.", "The model clearly isn\u2019t great but it\u2019s still impressive at what it does. It\u2019s definitely better than me at classifying whether the above two images are diseased or normal.", "In this project, we\u2019ve discovered the power of transfer learning and how well it can improve the performance of a deep learning model. The final model certainly could\u2019ve been improved more by further adding regularization and optimization techniques as well as tweaking hyper-parameters. Also, training on an imbalanced dataset is not optimal so generating new images to balance the distribution would also prove to be useful in this case.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Enthusiast, Self-Learner Fascinated with Big Data"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5dc66468eb9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@allen.kong21?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allen.kong21?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": "Allen Kong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F64c6503c82e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&user=Allen+Kong&userId=64c6503c82e8&source=post_page-64c6503c82e8----5dc66468eb9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5dc66468eb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5dc66468eb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@fusion_medical_animation?utm_source=medium&utm_medium=referral", "anchor_text": "Fusion Medical Animation"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia", "anchor_text": "Chest X-Ray Images (Pneumonia)"}, {"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia", "anchor_text": "Chest X-Rays Dataset"}, {"url": "https://jovian.ml/allenkong221/pneumonia-detection-resnet", "anchor_text": "Source Code"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----5dc66468eb9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/resnet?source=post_page-----5dc66468eb9---------------resnet-----------------", "anchor_text": "Resnet"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----5dc66468eb9---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----5dc66468eb9---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/pneumonia?source=post_page-----5dc66468eb9---------------pneumonia-----------------", "anchor_text": "Pneumonia"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5dc66468eb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&user=Allen+Kong&userId=64c6503c82e8&source=-----5dc66468eb9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5dc66468eb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&user=Allen+Kong&userId=64c6503c82e8&source=-----5dc66468eb9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5dc66468eb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5dc66468eb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5dc66468eb9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5dc66468eb9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5dc66468eb9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5dc66468eb9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5dc66468eb9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allen.kong21?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allen.kong21?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Allen Kong"}, {"url": "https://medium.com/@allen.kong21/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "64 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F64c6503c82e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&user=Allen+Kong&userId=64c6503c82e8&source=post_page-64c6503c82e8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4f72a13337d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpneumonia-detection-using-deep-learning-5dc66468eb9&newsletterV3=64c6503c82e8&newsletterV3Id=4f72a13337d5&user=Allen+Kong&userId=64c6503c82e8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}