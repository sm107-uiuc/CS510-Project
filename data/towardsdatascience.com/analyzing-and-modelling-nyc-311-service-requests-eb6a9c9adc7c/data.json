{"url": "https://towardsdatascience.com/analyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c", "time": 1683017076.008501, "path": "towardsdatascience.com/analyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c/", "webpage": {"metadata": {"title": "Noisy Neighbors and Traffic Trouble: An Analysis of NYC 311 Service Requests | Towards Data Science", "h1": "Noisy Neighbors and Traffic Trouble", "description": "NYC Open Data is a vast trove of City government datasets that have been made available to the public. One such dataset, 311 Service Requests from 2010 to Present, will be the focus of this article\u2026"}, "outgoing_paragraph_urls": [{"url": "https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9", "anchor_text": "311 Service Requests from 2010 to Present", "paragraph_index": 0}, {"url": "https://github.com/AvonleaFisher/Analyzing-NYC-311-Service-Requests", "anchor_text": "GitHub repository", "paragraph_index": 0}, {"url": "https://dev.socrata.com/consumers/getting-started.html", "anchor_text": "Open Data (SODA)", "paragraph_index": 1}, {"url": "https://communityprofiles.planning.nyc.gov/", "anchor_text": "NYC Department of City Planning\u2019s Community District Profiles", "paragraph_index": 2}, {"url": "https://plotly.com/python/filled-area-plots/", "anchor_text": "area plots", "paragraph_index": 7}, {"url": "https://nymag.com/intelligencer/2020/08/hurricane-isaias-updates-damage-tracking-path-and-more.html", "anchor_text": "Tropical Storm Isaias", "paragraph_index": 10}, {"url": "https://plotly.com/python/mapbox-density-heatmaps/", "anchor_text": "apbox Density Heatmap", "paragraph_index": 11}, {"url": "https://communityprofiles.planning.nyc.gov/data/cd_profile_data_dictionary.csv", "anchor_text": "dictionary", "paragraph_index": 13}, {"url": "https://keras.io/guides/sequential_model/", "anchor_text": "Sequential model", "paragraph_index": 20}, {"url": "https://www.linkedin.com/in/avonlea-fisher/", "anchor_text": "https://www.linkedin.com/in/avonlea-fisher/", "paragraph_index": 30}], "all_paragraphs": ["NYC Open Data is a vast trove of City government datasets that have been made available to the public. One such dataset, 311 Service Requests from 2010 to Present, will be the focus of this article. This 311 data is updated daily and contains information about more than 24 million service requests made since 2010. For those who aren\u2019t familiar, 311 is a phone number used in the U.S. that allows callers to access non-emergency municipal services, report problems to government agencies, and request information. This article discusses my process for exploring trends in a recent subset of the data (June-Nov. 2020), and for building a neural network to classify the government agency that responded to a given call. The full code for this project is available on its GitHub repository.", "The 311 data was obtained through the Socrata Open Data (SODA) API, which partners with NYC Open Data to host City data. The code below creates a data frame with data for the 1.5 million most recent calls.", "This project also uses data from the NYC Department of City Planning\u2019s Community District Profiles. A CSV file containing indicators for all community districts can be downloaded from any district profile. Both the 311 data and the indicators data contain a column for the community district/board. After reformatting the values and column name in the indicators data frame, it could be merged with the 311 data on their mutual \u201ccommunity board\u201d column:", "Using Plotly Express bar charts, I visualized the distribution of calls across different complaint types and government agencies. There were dozens of unique complaint types, so the first plot displays only the top 30 most frequent complaints:", "We can see that complaints related to noise, vehicles/traffic, utilities and trees are the most common, with noise complaints standing out as the clear majority category.", "The agency column is similarly imbalanced: since the NYPD handles noise complaints, it responds to the vast majority of 311 calls. The Department of Housing Preservation and Development (HPD) and the Department of Parks and Recreation (DPR) also respond to a significant proportion of calls.", "To explore how the volume of calls received in different complaint categories changed over time, the function below generated daily call frequency dictionaries for a given complaint type:", "There was no \u201cday\u201d column in the original data frame, but by converting the \u201ccreated date\u201d column to a datetime object, a new day column could be generated by applying datetime.date() to each row. This allowed for the creation of area plots that show the change in daily call counts over time. The following plot, for example, shows the daily counts for calls related to COVID-19.", "The non-compliance calls peaked in August, and with the exception of a couple dips, consistently exceeded 200 calls per day. Mass gathering complaints, on the other hand, were not recorded during the summer, and hover just above 100 daily calls at their peak. This does not indicate that no mass gatherings occurred in the summer (as a New Yorker, I can confidently attest to the contrary). It means, simply, that this complaint category was not formally introduced to the data before the fall. Let\u2019s now take a look at noise complaints, which were the most common type:", "The number of residential noise complaints surpasses that of other noise categories, and exceeded more than 4000 calls on some days. We would expect most people in their homes to be particularly bothered by excessive noise coming nearby locations; and with all the tiny, packed apartments in this city, it is no surprise that residential noise takes the lead here. Vehicle and sidewalk/street noise complaints are also fairly common. Next, we\u2019ll look at a complaint type with a single peak in call count: damaged trees.", "Damaged tree calls are relatively rare on most days, but on August 4th and the subsequent couple of days, the call counts exceeded 12k. A quick Google search revealed the likely culprit: Tropical Storm Isaias, which not only damaged thousands of trees, but also resulted in mass power outages and took the lives of at least 5 people. This plot is demonstrative of just one form of wide-sweeping, devastating damage that natural disasters can cause.", "Using Plotly\u2019s Mapbox Density Heatmap and the location data for the calls, it was possible to create animations that show how call volume varied across the 5 boroughs:", "The animation to the left shows, as an example, what the above plot_calls() function rendered for the month of August. Yellow areas indicate high call volume and appear predominantly in the Bronx, Manhattan, and parts of Brooklyn. Observe how, on the days with thousands of damaged tree complaints, the entire city flares up in yellow.", "The scatterplot below uses information from both datasets to show how average daily call volume (per square mile) and the crime rate (per 1000 residents) varies across different community districts. The dictionary for the community district indicators defines the crime rate variable as the \u201crate of 7 major felonies, as defined by the NYPD, reported in the community district in 2016 per 1,000 residents.\u201d The Chart Studio rendering condenses some of the information within the plot, but a community district\u2019s crime rate and average daily call volume can be displayed by hovering over one of the points. Larger points indicate a higher crime rate.", "Manhattan Community Board 5, located in Midtown, had the highest crime rate at 29.4 per 1000 residents. Two community boards in the Bronx have the highest daily averages for 311 calls, but have lower crime rates than many other districts. Staten Island, compared to other boroughs, appears to have both low crime rates and low average volumes of 311 calls. These observations suggest that, contrary to what our intuitive expectations may be, the rate of crime and the rate of non-emergency violations or problems do not have a clear linear relationship. It\u2019s important to note, furthermore, that the data only reflects crimes and non-emergency issues that have been reported, and consequently does not paint a complete and accurate picture of these variables.", "As previously illustrated, the NYPD is responsible for responding to most 311 calls, and some agencies respond to very few. A basic classifier that predicts that every call is responded to by the NYPD would still be accurate just over 50% of the time. In a balanced dataset, conversely, such a classifier would be accurate just 7% of the time. When dealing with imbalanced classes such as this one, it\u2019s important to adjust how we evaluate a model\u2019s accuracy: 50% accuracy in classifying the agency does not indicate a strong performance, despite the large number of classes, because a single class is associated with the majority of calls.", "The community districts\u2019 numeric data were not strong predictors of the agency that responded to 311 calls made within them. The calls\u2019 descriptors, unsurprisingly, were far more effective. There were just over 800 unique descriptors, including chin-scratchers like \u201cbingo hall\u201d, and, simply, \u201cmonkey.\u201d The word cloud below shows which words appeared most frequently in the descriptor column.", "Words that appear larger in this cloud are those that were more common in the descriptors. Given that noise was the most common complaint type category, it makes sense that words like \u201cmusic,\u201d \u201cparty,\u201d and \u201cloud\u201d appear the largest. Words related to parking/vehicles, streets, sidewalks, and trees are also featured prominently in the word cloud.", "Calls that received responses from minority agencies were oversampled with the below custom function in preparing the training data. In this function, \u2018n_samples_dict\u2019 is a dictionary with the number of samples that would be taken for each agency if the weights of the agencies in the training subset were to match those of the entire dataset.", "The function was applied to each agency name, and the weighted samples were concatenated into a single data frame. This sampling technique ensured that, in the training data, all agencies were represented and that no agency had a sample of fewer than 400 calls. In the training subset, the largest agency sample, NYPD, consisted of 60k calls. To ensure that every unique descriptor was also represented, rows with descriptors that didn\u2019t appear in the original training data samples were subsequently identified and added.", "A Keras neural network Sequential model, which is appropriate when attempting to build a model with a single input and output, was created to classify the agency. Both the input variable (descriptor) and output variable (agency) required some further preprocessing before being fed into the model. The below code shows how the descriptor column from the data frame of weighted samples was processed.", "In natural language processing, a tokenizer separates a text (the descriptors) into smaller \u201ctokens\u201d (words within the descriptors). The Keras fit_on_texts() method updates the tokenizer\u2019s vocabulary based on the list of texts that is passed in. The texts_to_matrix() method converts the list of texts to a NumPy matrix, and specifying the mode \u201cbinary\u201d means that only the presence or absence of each word will be accounted for in the matrix. The word index is a dictionary that contains words in the tokenizer\u2019s vocabulary as keys, and integers that correspond to the keys\u2019 frequency rank as values. The word \u201cmusic,\u201d for example, had a value of 1 because it is the first most frequent word in the descriptor column.", "The agency values were processed sklearn\u2019s label encoder, as shown below.", "The label encoder assigns a unique integer to each of the 14 agencies in the column. Note that both the descriptor and agency data were one-hot encoded. One-hot encoding converts a single categorical variable to multiple binary variables, where each new variable is a value of the original one. One-hot encoding can be used to process categorical data when there is no relationship between different categories. Without this step, the model may identify a relationship that doesn\u2019t actually exist and mis-classify the input data accordingly.", "Given that the models were trained on data in which minority agencies were oversampled, evaluating their performance only on test data with similar oversampling would produce misleading results. For this reason, performance was also evaluated on a random subset of the original data that underwent the same one-hot encoding process shown above. The below function was used to fit and evaluate a model given a dictionary of parameters. It returns plots of the accuracy and loss curves, as well as accuracy scores for both the test and random subset (\u2018r_test\u2019 and \u2018r_label_test\u2019) data.", "The overall best-performing model had the following parameters passed in:", "The model had 90% accuracy on the test data and 73% accuracy on the random subset that didn\u2019t undergo any resampling. While these are far from perfect accuracy scores, they are substantially higher than what we would expect to get from classifying all calls\u2019 responding agency as the NYPD. The plots below visualize the learning history of the model:", "The accuracy curves, despite remaining constant for about the first 50 epochs, moved upward thereafter. The loss curves, similarly, move downward as the number of epochs increases. Given that neither set of curves seems to get worse as the number of epochs increases, we can be confident that the model is not overfit to the training data.", "The description of a 311 call, after being encoded as numeric data, is a strong predictor of the agency that responded to the call. Noise complaints make up the majority of 311 calls and are assigned to the NYPD. This analysis lends itself to further inquiry into how non-emergency service requests are handled in NYC and other cities. If a similar classifier were trained on larger and more diverse description data, could the assignment of government agencies to non-emergency requests be handled more efficiently? In terms of meeting the needs of city residents, does it make sense for the same agency responsible for emergency calls to handle most 311 requests? Future research in the fields of data science and public policy should explore these questions further.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Brooklyn-based data science and political science graduate, interested in using the power of data for public good. https://www.linkedin.com/in/avonlea-fisher/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feb6a9c9adc7c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://avfisher.medium.com/?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": ""}, {"url": "https://avfisher.medium.com/?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": "Avonlea Fisher"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fca492a9277a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&user=Avonlea+Fisher&userId=ca492a9277a8&source=post_page-ca492a9277a8----eb6a9c9adc7c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb6a9c9adc7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb6a9c9adc7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mikechv?utm_source=medium&utm_medium=referral", "anchor_text": "Mike C. Valdivia"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9", "anchor_text": "311 Service Requests from 2010 to Present"}, {"url": "https://github.com/AvonleaFisher/Analyzing-NYC-311-Service-Requests", "anchor_text": "GitHub repository"}, {"url": "https://dev.socrata.com/consumers/getting-started.html", "anchor_text": "Open Data (SODA)"}, {"url": "https://communityprofiles.planning.nyc.gov/", "anchor_text": "NYC Department of City Planning\u2019s Community District Profiles"}, {"url": "https://plotly.com/python/filled-area-plots/", "anchor_text": "area plots"}, {"url": "https://nymag.com/intelligencer/2020/08/hurricane-isaias-updates-damage-tracking-path-and-more.html", "anchor_text": "Tropical Storm Isaias"}, {"url": "https://plotly.com/python/mapbox-density-heatmaps/", "anchor_text": "apbox Density Heatmap"}, {"url": "https://communityprofiles.planning.nyc.gov/data/cd_profile_data_dictionary.csv", "anchor_text": "dictionary"}, {"url": "https://www.vectorstock.com/royalty-free-vector/new-york-city-map-flat-vector-19210492", "anchor_text": "vectorstock.com"}, {"url": "https://keras.io/guides/sequential_model/", "anchor_text": "Sequential model"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----eb6a9c9adc7c---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/data-science?source=post_page-----eb6a9c9adc7c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/civic-data?source=post_page-----eb6a9c9adc7c---------------civic_data-----------------", "anchor_text": "Civic Data"}, {"url": "https://medium.com/tag/new-york-city?source=post_page-----eb6a9c9adc7c---------------new_york_city-----------------", "anchor_text": "New York City"}, {"url": "https://medium.com/tag/keras?source=post_page-----eb6a9c9adc7c---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feb6a9c9adc7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&user=Avonlea+Fisher&userId=ca492a9277a8&source=-----eb6a9c9adc7c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feb6a9c9adc7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&user=Avonlea+Fisher&userId=ca492a9277a8&source=-----eb6a9c9adc7c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb6a9c9adc7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feb6a9c9adc7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eb6a9c9adc7c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eb6a9c9adc7c--------------------------------", "anchor_text": ""}, {"url": "https://avfisher.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://avfisher.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Avonlea Fisher"}, {"url": "https://avfisher.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "92 Followers"}, {"url": "https://www.linkedin.com/in/avonlea-fisher/", "anchor_text": "https://www.linkedin.com/in/avonlea-fisher/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fca492a9277a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&user=Avonlea+Fisher&userId=ca492a9277a8&source=post_page-ca492a9277a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fed2d194144cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-and-modelling-nyc-311-service-requests-eb6a9c9adc7c&newsletterV3=ca492a9277a8&newsletterV3Id=ed2d194144cd&user=Avonlea+Fisher&userId=ca492a9277a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}