{"url": "https://towardsdatascience.com/1000x-faster-data-augmentation-b91bafee896c", "time": 1682996548.670488, "path": "towardsdatascience.com/1000x-faster-data-augmentation-b91bafee896c/", "webpage": {"metadata": {"title": "1000x Faster Data Augmentation. Population Based Augmentation: Quickly\u2026 | by Daniel Ho | Towards Data Science", "h1": "1000x Faster Data Augmentation", "description": "In this blog post we introduce Population Based Augmentation (PBA), an algorithm that quickly and efficiently learns a state-of-the-art approach to augmenting data for neural network training. PBA\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1905.05393.pdf", "anchor_text": "recent paper", "paragraph_index": 1}, {"url": "https://github.com/arcelien/pba", "anchor_text": "run PBA for yourself", "paragraph_index": 1}, {"url": "https://ray.readthedocs.io/en/latest/tune.html", "anchor_text": "Tune", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1805.09501", "anchor_text": "AutoAugment", "paragraph_index": 3}, {"url": "https://deepmind.com/blog/population-based-training-neural-networks/", "anchor_text": "Population Based Training algorithm", "paragraph_index": 7}, {"url": "https://github.com/arcelien/pba", "anchor_text": "https://github.com/arcelien/pba", "paragraph_index": 13}, {"url": "https://github.com/arcelien/pba", "anchor_text": "Github", "paragraph_index": 14}, {"url": "https://arxiv.org/abs/1905.05393", "anchor_text": "Population Based Augmentation: Efficient Learning of Augmentation Policy Schedules", "paragraph_index": 15}], "all_paragraphs": ["In this blog post we introduce Population Based Augmentation (PBA), an algorithm that quickly and efficiently learns a state-of-the-art approach to augmenting data for neural network training. PBA matches the previous best result on CIFAR and SVHN but uses one thousand times less compute, enabling researchers and practitioners to effectively learn new augmentation policies using a single workstation GPU. You can use PBA broadly to improve deep learning performance on image recognition tasks.", "We discuss the PBA results from our recent paper and then show how to easily run PBA for yourself on a new data set in the Tune framework.", "Recent advances in deep learning models have been largely attributed to the quantity and diversity of data gathered in recent years. Data augmentation is a strategy that enables practitioners to significantly increase the diversity of data available for training models, without actually collecting new data. Data augmentation techniques such as cropping, padding, and horizontal flipping are commonly used to train large neural networks. However, most approaches used in training neural networks only use basic types of augmentation. While neural network architectures have been investigated in depth, less focus has been put into discovering strong types of data augmentation and data augmentation policies that capture data invariances.", "Recently, Google has been able to push the state-of-the-art accuracy on datasets such as CIFAR-10 with AutoAugment, a new automated data augmentation technique. AutoAugment has shown that prior work using just applying a fixed set of transformations like horizontal flipping or padding and cropping leaves potential performance on the table. AutoAugment introduces 16 geometric and color-based transformations, and formulates an augmentation policy that selects up to two transformations at certain magnitude levels to apply to each batch of data. These higher performing augmentation policies are learned by training models directly on the data using reinforcement learning.", "AutoAugment is a very expensive algorithm which requires training 15,000 models to convergence to generate enough samples for a reinforcement learning based policy. No computation is shared between samples, and it costs 15,000 NVIDIA Tesla P100 GPU hours to learn an ImageNet augmentation policy and 5,000 GPU hours to learn an CIFAR-10 one. For example, if using Google Cloud on-demand P100 GPUs, it would cost about $7,500 to discover a CIFAR policy, and $37,500 to discover an ImageNet one! Therefore, a more common use case when training on a new dataset would be to transfer a pre-existing published policy, which the authors show works relatively well.", "Our formulation of data augmentation policy search, Population Based Augmentation (PBA), reaches similar levels of test accuracy on a variety of neural network models while utilizing three orders of magnitude less compute. We learn an augmentation policy by training several copies of a small model on CIFAR-10 data, which takes five hours using a NVIDIA Titan XP GPU. This policy exhibits strong performance when used for training from scratch on larger model architectures and with CIFAR-100 data.", "Relative to the several days it takes to train large CIFAR-10 networks to convergence, the cost of running PBA beforehand is marginal and significantly enhances results. For example, training a PyramidNet model on CIFAR-10 takes over 7 days on a NVIDIA V100 GPU, so learning a PBA policy adds only 2% precompute training time overhead. This overhead would be even lower, under 1%, for SVHN.", "PBA leverages the Population Based Training algorithm to generate an augmentation policy schedule which can adapt based on the current epoch of training. This is in contrast to a fixed augmentation policy that applies the same transformations independent of the current epoch number.", "This allows an ordinary workstation user to easily experiment with the search algorithm and augmentation operations. One interesting use case would be to introduce new augmentation operations, perhaps targeted towards a particular dataset or image modality, and be able to quickly produce a tailored, high performing augmentation schedule. Through ablation studies, we have found that the learned hyperparameters and schedule order are important for good results.", "We use Population Based Training with a population of 16 small WideResNet models. Each worker in the population will learn a different candidate hyperparameter schedule. We transfer the best performing schedule to train larger models from scratch, from which we derive our test error metrics.", "The population models are trained on the target dataset of interest starting with all augmentation hyperparameters set to 0 (no augmentations applied). At frequent intervals, an \u201cexploit-and-explore\u201d process \u201cexploits\u201d high performing workers by copying their model weights to low performing workers, and then \u201cexplores\u201d by perturbing the hyperparameters of the worker. Through this process, we are able to share compute heavily between the workers and target different augmentation hyperparameters at different regions of training. Thus, PBA is able to avoid the cost of training thousands of models to convergence in order to reach high performance.", "We leverage Tune\u2019s built-in implementation of PBT to make it straightforward to use PBA.", "We call Tune\u2019s implementation of PBT with our custom exploration function. This will create 16 copies of our ResNet-40\u20132 model and train them time-multiplexed. The policy schedule used by each copy is saved to disk and can be retrieved after termination to use for training new models.", "You can run PBA by following the README at: https://github.com/arcelien/pba. On a Titan XP, it only requires one hour to learn a high performing augmentation policy schedule on the SVHN dataset. It is also easy to use PBA on a custom dataset as well: simply define a new dataloader and everything else falls into place.", "Big thanks to Eric Liang, Richard Liaw, Daniel Rothchild, Ashwinee Panda, Aniruddha Nrusimha, Daniel Seita, Joseph Gonzalez, and Ion Stoica for helpful feedback while writing this post. Feel free to get in touch with us on Github!", "[1] Daniel Ho, Eric Liang, Ion Stoica, Pieter Abbeel, Xi Chen, Population Based Augmentation: Efficient Learning of Augmentation Policy Schedules (2019), International Conference on Machine Learning (ICML) 2019", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer working on robotics and machine learning at (Google) X. Formerly with Berkeley AI Research, NVIDIA, LLNL. Berkeley \u201918."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb91bafee896c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b91bafee896c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b91bafee896c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@itsdanielho?source=post_page-----b91bafee896c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@itsdanielho?source=post_page-----b91bafee896c--------------------------------", "anchor_text": "Daniel Ho"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F654731887895&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&user=Daniel+Ho&userId=654731887895&source=post_page-654731887895----b91bafee896c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb91bafee896c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb91bafee896c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1905.05393.pdf", "anchor_text": "recent paper"}, {"url": "https://github.com/arcelien/pba", "anchor_text": "run PBA for yourself"}, {"url": "https://ray.readthedocs.io/en/latest/tune.html", "anchor_text": "Tune"}, {"url": "https://arxiv.org/abs/1805.09501", "anchor_text": "AutoAugment"}, {"url": "https://arxiv.org/abs/1605.07146", "anchor_text": "WideResNet"}, {"url": "https://arxiv.org/abs/1705.07485", "anchor_text": "Shake-Shake"}, {"url": "https://arxiv.org/abs/1610.02915", "anchor_text": "PyramidNet"}, {"url": "https://arxiv.org/abs/1802.02375", "anchor_text": "ShakeDrop"}, {"url": "https://deepmind.com/blog/population-based-training-neural-networks/", "anchor_text": "Population Based Training algorithm"}, {"url": "https://deepmind.com/blog/population-based-training-neural-networks/", "anchor_text": "Source"}, {"url": "https://github.com/arcelien/pba", "anchor_text": "https://github.com/arcelien/pba"}, {"url": "https://github.com/arcelien/pba", "anchor_text": "Github"}, {"url": "https://arxiv.org/abs/1905.05393", "anchor_text": "Population Based Augmentation: Efficient Learning of Augmentation Policy Schedules"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b91bafee896c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----b91bafee896c---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b91bafee896c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b91bafee896c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b91bafee896c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb91bafee896c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&user=Daniel+Ho&userId=654731887895&source=-----b91bafee896c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb91bafee896c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&user=Daniel+Ho&userId=654731887895&source=-----b91bafee896c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb91bafee896c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b91bafee896c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb91bafee896c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b91bafee896c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b91bafee896c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b91bafee896c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b91bafee896c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b91bafee896c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b91bafee896c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b91bafee896c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b91bafee896c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b91bafee896c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@itsdanielho?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@itsdanielho?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Daniel Ho"}, {"url": "https://medium.com/@itsdanielho/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "79 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F654731887895&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&user=Daniel+Ho&userId=654731887895&source=post_page-654731887895--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F654731887895%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F1000x-faster-data-augmentation-b91bafee896c&user=Daniel+Ho&userId=654731887895&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}