{"url": "https://towardsdatascience.com/em-algorithm-aaaa181af127", "time": 1683011183.936372, "path": "towardsdatascience.com/em-algorithm-aaaa181af127/", "webpage": {"metadata": {"title": "EM Algorithm. Mathematical Background and Example | by Mengsay Loem | Towards Data Science", "h1": "EM Algorithm", "description": "Working with a stochastic approach based-machine learning, we consider the information origin as a type of probability distribution. Once we estimate the distribution, it is straightforward to\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Working with a stochastic approach based-machine learning, we consider the information origin as a type of probability distribution. Once we estimate the distribution, it is straightforward to classifier unknown data as well as to predict future generated data. There are two phases to estimate a probability distribution. 1) Decide a model to define the distribution, for example, the form of probability density function (Gaussian distribution, Multinomial distribution\u2026). Here, consider the Gaussian Mixture Model (GMM) as an example. The form of probability density function can be defined by", "where w_k is the ratio data generated from the k-th Gaussian distribution.", "2) After deciding a form of probability density function, we estimate its parameters from observed data. For example, in the case of Gaussian distribution, mean and variance are parameters to estimate.", "Our current known knowledge is observed data set D and the form of generative distribution (unknown parameter Gaussian distributions). However, to solve 2) we need the information on which Gaussian distribution each observed data is generated from, and this information is not directly shown in the observed data.", "In this case, the variables which represent the information that cannot be obtained directly from the observed data set are called Latent Variables. In the above example, w_k is a latent variable.", "Therefore, in GMM, it is necessary to estimate the latent variable first. And next, we use the estimated latent variable to estimate the parameters of each Gaussian distribution.", "An effective method to estimate parameters in a model with latent variables is the Expectation and Maximization algorithm (EM algorithm).", "Let\u2019s prepare the symbols used in this part.", "Our purpose is to estimate theta from the observed data set D with EM algorithm.", "In the case that observed data is i.i.d, the log-likehood function is", "We can rewrite our purpose in the following form.", "The probability shown in log-likelihood function p(x,z|theta) can be represented with the probability of latent variable z as the following form. The third relation is the result of marginal distribution on the latent variable z", "Now, our goal is to determine the parameter theta which maximizes the log-likelihood function log p(x|theta). However, it is not possible to directly maximize this value from the above relation. Therefore, we decide a process to update the parameter theta while maximizing the log p(x|theta). We consider theta be the optimal parameter to be defined, theta(t) be the t-th step value of parameter theta. In the following process, we tend to define an update rule to increase log p(x|theta(t)) compare to log p(x|theta).", "Here, we represent q(z) by conditional probability given recent parameter theta and observed data.", "Hence, log p(x|theta) can be written as", "We start by focusing on the change of log p(x|theta)-log p(x|theta(t)) when update theta(t). We try to define rule which lead to decrease the amount of log p(x|theta)-log p(x|theta(t)).", "Rewrite this relation, we get the following form. Equation (1):", "Now, we need to evaluate the right-hand side to find a rule in updating parameter theta. To do this, consider a well-known mathematical relationlog x \u2264 x-1. Using this relation, we can obtain the following inequality.", "Therefore, the 3rd term of Equation(1) is", "The first and second term of Equation(1) is non-negative. It is true because, when we replace theta by theta(t), term1-term2=0 then by maximizing the first term, term1-term2 becomes larger or equal to 0.", "Consider this relation, log p(x|theta)-log p(x|theta(t))\u22650. Therefore, to maximize the left-hand side of Equation(1), we just update theta(t) with a value of theta(t) which maximizes the first term of the right-hand side of Equation(1).", "Let the subject of argmax of the above update rule be function Q(theta).", "We can translate this relation as an expectation value of log p(x,z|theta) when theta=theta(t).", "From this update, we can summary the process of EM algorithm as the following E step and M step.", "Let\u2019s take a 2-dimension Gaussian Mixture Model as an example.", "Random variable: x_n (d-dimension vector) Latent variable: z_mMixture ratio: w_kMean : mu_k (d-dimension vector)Variance-covariance matrix: Sigma_k (dxd matrix)", "Here, if an observed data x is generated from m-th Gaussian distribution, then z_m = 1, else z_m = 0. The distribution of latent variable z, therefore can be written as", "The probability density function of m-th Gaussian distribution is given by", "Therefore, the probability which data x belongs to m-th distribution is p(z_m=1|x) which is calculated by", "Randomly initialize mu, Sigma and w. t = 1.", "Using theta(t) to calculate the expectation value of latent variable z.", "Therefore, if z_nm is the latent variable of x_n, N_m is the number of observed data in m-th distribution, the following relation is true.", "Our goal in this step is to define w_m, mu_m, Sigma_m which maximize Q(theta|theta(t)).", "Solve this equation, the update of mu is", "Solve this equation, the update of Sigma is", "To derivate the update relation of w, we use Lagrange method to maximize Q(theta|theta(t)) subject to w_1+w_2+\u2026+w_M=1.", "Solving this equation for lambda and use the restraint relation, the update rule for w_m is", "From the result, with the EM algorithm, the log-likelihood function always converged after repeat the update rules on parameters. However, since the EM algorithm is an iterative calculation, it easily falls into local optimal state. As saw in the result(1),(2) differences in M value(number of mixture model) and initializations offer different changes in Log-likelihood convergence and estimate distribution. To solve this problem, a simple method is to repeat the algorithm with several initialization states and choose the best state from those works.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Master's Student @ Tokyo Tech | Dept. of Computer Science"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faaaa181af127&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----aaaa181af127--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aaaa181af127--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mengsaylms?source=post_page-----aaaa181af127--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mengsaylms?source=post_page-----aaaa181af127--------------------------------", "anchor_text": "Mengsay Loem"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fde1bfda96132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&user=Mengsay+Loem&userId=de1bfda96132&source=post_page-de1bfda96132----aaaa181af127---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaaa181af127&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaaa181af127&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/gaussian-mixture-model?source=post_page-----aaaa181af127---------------gaussian_mixture_model-----------------", "anchor_text": "Gaussian Mixture Model"}, {"url": "https://medium.com/tag/em-algorithm?source=post_page-----aaaa181af127---------------em_algorithm-----------------", "anchor_text": "Em Algorithm"}, {"url": "https://medium.com/tag/pattern-recognition?source=post_page-----aaaa181af127---------------pattern_recognition-----------------", "anchor_text": "Pattern Recognition"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----aaaa181af127---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faaaa181af127&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&user=Mengsay+Loem&userId=de1bfda96132&source=-----aaaa181af127---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faaaa181af127&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&user=Mengsay+Loem&userId=de1bfda96132&source=-----aaaa181af127---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faaaa181af127&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aaaa181af127--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faaaa181af127&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----aaaa181af127---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----aaaa181af127--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----aaaa181af127--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----aaaa181af127--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----aaaa181af127--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----aaaa181af127--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----aaaa181af127--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----aaaa181af127--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----aaaa181af127--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mengsaylms?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mengsaylms?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mengsay Loem"}, {"url": "https://medium.com/@mengsaylms/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fde1bfda96132&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&user=Mengsay+Loem&userId=de1bfda96132&source=post_page-de1bfda96132--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F48022e86df09&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fem-algorithm-aaaa181af127&newsletterV3=de1bfda96132&newsletterV3Id=48022e86df09&user=Mengsay+Loem&userId=de1bfda96132&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}