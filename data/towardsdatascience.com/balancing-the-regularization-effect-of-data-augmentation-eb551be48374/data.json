{"url": "https://towardsdatascience.com/balancing-the-regularization-effect-of-data-augmentation-eb551be48374", "time": 1683011313.889753, "path": "towardsdatascience.com/balancing-the-regularization-effect-of-data-augmentation-eb551be48374/", "webpage": {"metadata": {"title": "Balancing the Regularization Effect of Data Augmentation | by Metika Sikka | Towards Data Science", "h1": "Balancing the Regularization Effect of Data Augmentation", "description": "When training neural networks, data augmentation is one of the most commonly used pre-processing techniques. The word \u201caugmentation\u201d which literally means \u201cthe action or process of making or becoming\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/franciscoescobar/satellite-images-of-water-bodies", "anchor_text": "Kaggle data set", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/unet-line-by-line-explanation-9b191c76baf5", "anchor_text": "This article", "paragraph_index": 5}, {"url": "https://github.com/MS1997/Semantic-Segmentation-of-Water-Bodies", "anchor_text": "Github", "paragraph_index": 24}], "all_paragraphs": ["When training neural networks, data augmentation is one of the most commonly used pre-processing techniques. The word \u201caugmentation\u201d which literally means \u201cthe action or process of making or becoming greater in size or amount\u201d, summarizes the outcome of this technique. But another important effect is that it increases or augments the diversity of the data. The increased diversity means, at each training stage the model comes across a different version of the original data.", "Why do we need this \u2018increased diversity\u2019 in data? The answer lies in the core tenet of machine learning \u2014 The Bias-Variance tradeoff. More complex models like deep neural networks have low bias but suffer from high variance. This implies that, these models overfit the training data and would show poor perform on test data or the data, they haven\u2019t seen before. This would lead to higher prediction errors. Thus, the increased diversity from data augmentation reduces the variance of the model by making it better at generalizing.", "For images, some common methods of data augmentation are taking cropped portions, zooming in/out, rotating along the axis, vertical/horizontal flips, adjusting the brightness and sheer intensity. Data augmentation for audio data involves adding noise, changing speed and pitch.", "While data augmentation prevents the model from overfitting, some augmentation combinations can actually lead to underfitting. This slows down training which leads to a huge strain on resources like available processing time, GPU quotas, etc. Moreover, the model isn\u2019t able to learn as much information to give accurate predictions which, again leads to high prediction errors. In this blog post we take the example of semantic segmentation on satellite images, to see the impact of different combinations of data augmentations on training.", "This Kaggle data set gives the satellite images from Sentinel 2 and their corresponding masks which segment the water bodies. The masks have been calculated using the Normalized Difference Water Index or NDWI. Out of a total 2841 images in the data set, 2560 were extracted for the train set, 256 for the validation set and 25 for the test set respectively. The entire analysis and modeling was done on Google Colab with GPU support.", "Simply put, a U-NET is an autoencoder with residual or skip connections from each convolutional block in the encoder to its counterpart in the decoder. This results in a symmetric \u2018U\u2019 like structure. This article gives a comprehensive line by line explanation of the structure of a U-NET from the original paper.", "We use a slightly modified version of the U-NET as shown below.", "We explore 5 different cases of data augmentation with the help of Keras ImageDataGenerator. We want to see how augmentation can lead to overfitting or underfitting during training. Thus, for comparison of the 5 cases, Accuracy and Loss during training & validation were used; where binary cross-entropy was taken as the loss function.", "When dealing with semantic segmentation, an important point to remember is to apply the same augmentations to the images and their corresponding masks!", "In all 5 cases, the pixel values of the images and masks were rescaled by a factor of 1/255. All images and their masks in the validation and test set were also rescaled.", "Case 1: This was the base case. Only the pixel values of images and their masks were rescaled. No augmentations were applied. This case produced a training set with the least variance.", "Case 2: In addition to rescaling, the images and their masks were randomly flipped vertically or horizontally .", "Case 3: For this case, rescaling, random vertical or horizontal flips and random rotations between [-20,20] degrees were applied to images and their corresponding masks.", "Case 4: The images and their corresponding masks were randomly shifted along the width and height by a factor of 0.3.", "Case 5: The sheer transformations were randomly applied to the images and their corresponding masks using a factor of 20. They were also randomly zoomed in between the range [0.2,0.5].", "Across all 5 cases, the model was trained for 250 epochs with a batch size of 16. The Adam optimizer was used with a learning rate of 0.00001, beta 1 of 0.99 and beta 2 of 0.99. In the below graphs, we see that, each case of data augmentation gave a varying performance for the same model, trained for the same number of epochs with the same initial state of the optimizer.", "The base case gave the best performance in terms of both training accuracy and loss. However, this could imply overfitting. On the other hand the perfomance of the third, fourth and fifth case was worse. The training accuracy for these three cases did not go above 80% and the training loss did not fall below 0.1. This could mean underfitting. The second case in which data augmentation consisted of randomly flipping the images and their corresponding masks, seems to show a balanced performance. Even though it performed a bit worse than the base case, it had a much higher accuracy and lower loss than the last three cases.", "The validation accuracy and loss, showed a similar trend. The last case performed the worst for both these metrics. Looking closer we see that, the cases 3 and 4 showed similar performance to training in terms of loss but a slightly higher validation accuracy than training. This signals underfitting. For the base case, the validation loss and accuracy were much worse than their training counterparts which again points towards overfitting. While we see very high fluctuations in validation accuracy and loss for the second case, on an average it seems to perform the best out of the five.", "From the four graphs we can also see that each case of data augmentation converged at a different point during training for the same number of epochs and same initial state of the optimizer. It is almost like each case followed a separate trajectory.", "The maximum accuracy and the minimum loss for Training and Validation are shown in the table below. The table supports the conclusion from the graphs. The second case seems to balance overfitting and underfitting during training quite well.", "We see predicted segmentation of water bodies in satellite images in each of the five cases using 3 test images. It is again worth noting that, the same model trained using 5 different data augmentation combinations, predicted 5 different images for each test image.", "It should be noted that, the test images were most similar in terms format to the base case since, the base cases used no augmentations. Hence, for all three images, the base case model was able to segment the overall shape of the water body. However, case 2 was able to capture the minute edges as well. This confirms our conclusion from the graphs that, the base case model slightly over fit the training data (due to least variance).", "The performance of Case 3 and 4 varied with each test image. Case 5 gave the worst prediction for all three images (especially second and third images). This could imply that, for training this model on such a data set, changing the sheer intensity or zooming in too much can lead to poor prediction results. And this can be attributed to the fact that the model under fit the training data as it had, a very high variance.", "In the end, it again comes back to the core tenet \u2014 balancing the bias and variance. While data augmentation does have an explicit regularization effect, exploiting it can actually lead to the model not learning enough resulting in poor prediction results. Thus, we can see that there is a need to try out different combinations of data augmentation to find the most appropriate one for the data set of the problem statement.", "The entire code can be found on Github!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feb551be48374&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eb551be48374--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eb551be48374--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://metika.medium.com/?source=post_page-----eb551be48374--------------------------------", "anchor_text": ""}, {"url": "https://metika.medium.com/?source=post_page-----eb551be48374--------------------------------", "anchor_text": "Metika Sikka"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F127625b11501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&user=Metika+Sikka&userId=127625b11501&source=post_page-127625b11501----eb551be48374---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb551be48374&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb551be48374&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/franciscoescobar/satellite-images-of-water-bodies", "anchor_text": "Kaggle data set"}, {"url": "https://towardsdatascience.com/unet-line-by-line-explanation-9b191c76baf5", "anchor_text": "This article"}, {"url": "https://github.com/MS1997/Semantic-Segmentation-of-Water-Bodies", "anchor_text": "Github"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----eb551be48374---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----eb551be48374---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-augmentation?source=post_page-----eb551be48374---------------data_augmentation-----------------", "anchor_text": "Data Augmentation"}, {"url": "https://medium.com/tag/image-segmentation?source=post_page-----eb551be48374---------------image_segmentation-----------------", "anchor_text": "Image Segmentation"}, {"url": "https://medium.com/tag/keras?source=post_page-----eb551be48374---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feb551be48374&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&user=Metika+Sikka&userId=127625b11501&source=-----eb551be48374---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feb551be48374&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&user=Metika+Sikka&userId=127625b11501&source=-----eb551be48374---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb551be48374&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eb551be48374--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feb551be48374&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eb551be48374---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eb551be48374--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eb551be48374--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eb551be48374--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eb551be48374--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eb551be48374--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eb551be48374--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eb551be48374--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eb551be48374--------------------------------", "anchor_text": ""}, {"url": "https://metika.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://metika.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Metika Sikka"}, {"url": "https://metika.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "61 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F127625b11501&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&user=Metika+Sikka&userId=127625b11501&source=post_page-127625b11501--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Facd64ae209a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbalancing-the-regularization-effect-of-data-augmentation-eb551be48374&newsletterV3=127625b11501&newsletterV3Id=acd64ae209a2&user=Metika+Sikka&userId=127625b11501&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}