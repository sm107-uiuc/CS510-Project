{"url": "https://towardsdatascience.com/3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932", "time": 1683015607.4370172, "path": "towardsdatascience.com/3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932/", "webpage": {"metadata": {"title": "3 Simple Outlier/Anomaly Detection Algorithms every Data Scientist needs | by Vagif Aliyev | Towards Data Science", "h1": "3 Simple Outlier/Anomaly Detection Algorithms every Data Scientist needs", "description": "In statistics, an outlier is a data point that differs significantly from other observations. From the figure above, we can clearly see that while most points lie in and around the linear hyperplane\u2026"}, "outgoing_paragraph_urls": [{"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/housing.csv", "anchor_text": "GitHub", "paragraph_index": 27}, {"url": "http://Upword.ai", "anchor_text": "Upword.ai", "paragraph_index": 58}], "all_paragraphs": ["I\u2019m sure you have come across a few of the following scenarios:", "Well congratulations, because you might have outliers in your data!", "In statistics, an outlier is a data point that differs significantly from other observations. From the figure above, we can clearly see that while most points lie in and around the linear hyperplane, a single point can be seen diverge from the rest. This point is an outlier.", "For example, take a look at the list below:", "Here, it is clearly easy to see that 1 and 4500 are outliers in the dataset.", "Usually, outliers can occur from one of the following scenarios:", "Let\u2019s suppose you have some data, and you want to predict house prices from it using Linear Regression. A possible hypothesis could look like this:", "In this case, we are actually fitting the data too well(overfitting). However, note how all the points are situated are roughly the same range.", "Now, let\u2019s see what happens when we add an outlier.", "Clearly, we see how our hypothesis has shifted, and therefore, inference will be much worse that it would be without the outlier. Linear models include:", "A common scenario is to have missing data, and one of two approaches can be taken:", "If we were to go with the second option, we could have problematic imputations, as outliers can greatly change the values of statistical methods . For example, going back to our fictional data with no outliers:", "Clearly this analogy is quite extreme, but the idea remains the same; outliers in our data is usually a problem, as outliers can cause serious problems in statistical analysis and modelling. However, in this article, we will be looking at a few ways into how we can detect and combat them.", "Density-based spatial clustering of applications with noise(or, more simply, DBSCAN) is actually an unsupervised clustering algorithm, just like KMeans. However, one of its uses is also being able to detect outliers in data.", "DBSCAN is popular because it can find non-linearly separable clusters, which can\u2019t be done with KMeans and Gaussian Mixtures. It works well when clusters and dense enough, and are separated by low-density regions.", "The algorithm defines clusters as continuous regions of high density. The algorithm is quite simple:", "The DBSCAN algorithm is very easy to use thanks to Scikit-Learn\u2019s intuitive API. Let\u2019s see an example of the algorithm in action:", "Here we will instantiate DBSCAN with a \u03b5-neighbourhood length of 0.05, and 5 to be the minimum number of samples required for an instance to be considered a core instance", "Remember, we do not pass in our labels as it is an unsupervised algorithm. We can see the labels the labels that the algorithm produced using the following command:", "Note how some labels have values equal to -1: these are the outliers.", "The DBSCAN does not have a predict method, only a fit_predict method, meaning that it can\u2019t cluster new instances. Instead, we can use a different classifier to train and predict on. For this example, let\u2019s use a KNN:", "Here, we fit the KNN classifier on the core samples and their respective neighbours.", "However, we run into one problem; we have given the KNN data without any outliers. This is problematic, as it will force KNN to choose a cluster for new instances, even if the new instance is indeed an outlier.", "To combat this, we leverage the leverage the kneighbors method of the KNN classifier, which, given a set of instances, returns the distances and indices of the k nearest neighbours of the training set. We can then set a maximum distance, and if an instance exceeds that distance, we qualify it as an outlier:", "Here we have discussed and implemented DBSCAN for anomaly detection. DBSCAN is great because it\u2019s quick, has only two hyperparameters and is robust to outliers.", "An IsolationForest is an ensemble learning anomaly detection algorithm, that is especially useful at detecting outliers in high dimensional datasets. The algorithm basically does the following:", "Again, thanks to Scikit-Learn\u2019s intuitive API, we can easily implement the IsolationForest class. Let\u2019s see an example of the algorithm in action:", "We will also import mean_absolute_error to measure our error. For the data, we will use a dataset that can be obtained from Jason Brownlee\u2019s GitHub:", "Before we fit an Isolation Forest, let\u2019s try fit a vanilla Linear Regression model on the data and get our MAE:", "A relatively good score. Now, let\u2019s see if the Isolation Forest can improve the score by removing anomalies!", "First, we will instantiate our IsolationForest:", "The most important hyperparameter in the algorithm is probably the contamination parameter, which is used to help estimate the number of outliers in the dataset. This is a value between 0.0 and 0.5 and by default is set to 0.1", "However, it is essentially a randomised Random Forest, so all the hyperparameters of a random forest can also be used in the algorithm.", "Next, we will fit the data to the algorithm:", "Note how we also filter out predictions values = -1, as just like in DBSCAN, these are considered as outlier.", "Now, we will reassign the X and Y with the outlier-filtered data:", "And now let\u2019s try fit our Linear Regression model to the data and measure the MAE:", "Wow, a good decrease in cost. This clearly demonstrates the power of the Isolation Forest.", "While Boxplots are quite a common way to identify outliers, I really find that the latter is probably the most underrated method to identify outliers. But before we get into the Tuckey Method, let\u2019s talk about Boxplots:", "Boxplots essentially provide a graphical way to display numerical data through quantiles.It is a very simple yet effective way to visualise outliers.", "The upper and lower whiskers show the boundaries of the distribution, and anything above or below is considered to be an outlier. In the figure above, anything above ~80 and below ~62 is considered to be an outlier.", "Essentially, the box plot works by splitting the dataset into 5 parts:", "The Interquartile Range (IQR) is important as it is what defines outliers. Essentially, it is the following:", "In a boxplot, a distance of 1.5 * IQR is measured out and encompasses the higher observed points of the dataset. Similarly, a distance of 1.5 * IQR is measured out on the lower observed points of the dataset. Anything outside these distances is an outlier. More specifically:", "Let\u2019s see how we can detect outliers using Boxplots in Python!", "Let\u2019s plot a boxplot of our data:", "So we see that we have a median value of 50 and 3 outliers in our data, according to our boxplot. Let\u2019s get rid of these points:", "Here, I have basically set a threshold, so that all points less than -50 and greater than 150 will be excluded. And the result; an even distribution!", "The tuckey method outlier detection is actually a non-visual method of the box plot; the method is the same, except that there is no visualisation.", "The reason I sometimes prefer this method, as oppose to the boxplot, is because sometimes taking a look at the visualisation and making a rough estimate of what the threshold should be set as is not really effective.", "Instead, we can code an algorithm that can actually return the instances that it defined as outliers.", "The code for the implementation is the following:", "Basically, this code does the following:", "2. Next, it defines the outlier step, which, just like in boxplots, is 1.5 * IQR", "4. It then checks selects observations that have k outliers(in this case, k = 2)", "To summarise, there exists many outlier detection algorithms, but we went through the 3 most common ones: DBSCAN, IsolationForest and Boxplots. I encourage you to :", "I really do appreciate my followers, and I do hope to constantly write and give everybody great food for thought. For now, however, I must say goodbye ;}", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "19 y/o student ex-founder of Snapstudy (acquired), founding engineer at Upword.ai"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe71b1304a932&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e71b1304a932--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e71b1304a932--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vagifaliyev.medium.com/?source=post_page-----e71b1304a932--------------------------------", "anchor_text": ""}, {"url": "https://vagifaliyev.medium.com/?source=post_page-----e71b1304a932--------------------------------", "anchor_text": "Vagif Aliyev"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6b4e6b48584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&user=Vagif+Aliyev&userId=6b4e6b48584&source=post_page-6b4e6b48584----e71b1304a932---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe71b1304a932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe71b1304a932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.flickr.com/photos/31673483@N00/", "anchor_text": "Scott.T"}, {"url": "https://www.flickr.com/photos/31673483@N00/39151353820/in/photolist-22DEVtJ-JK3N3j-73AeXk-WtscC8-awpTxE-MZx16D-bv51wM-pYJoVx-262n5CX-b7L1uH-uGu7nd-2dmbaVW-XFRM8N-2jKUw4v-d85XWy-2j5aTjR-WNNJAf-pdRgEy-N8MRV6-2j22H6Y-U3xQuk-XES3Zn-r9m7SS-TV1Fmf-2jJ1QFJ-cauLTY-ds31pR-qtMWbF-niZxTj-2hMkNCc-nKi4XA-DowBNs-5yKzFd-2bQqifH-qB9Nvk-oEQ9WG-CRNtRN-hQzL9o-JXxP5u-29Wj4Lj-dGz93P-JKjBGX-2j7NfDg-nDv1WE-8Q1mSc-seYDya-wVPBZN-oZdBXB-2g3uJeP-s6sqJm", "anchor_text": "Flickr"}, {"url": "https://stats.stackexchange.com/questions/328968/is-it-an-outlier/328986", "anchor_text": "StackExchange"}, {"url": "https://unsplash.com/@theeastlondonphotographer?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ehimetalor Akhere Unuabona"}, {"url": "https://unsplash.com/s/photos/missing?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/DBSCAN", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Isolation_forest", "anchor_text": "Author"}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/housing.csv", "anchor_text": "GitHub"}, {"url": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/housing.csv'", "anchor_text": "https://raw.githubusercontent.com/jbrownlee/Datasets/master/housing.csv'"}, {"url": "https://en.wikipedia.org/wiki/Box_plot", "anchor_text": "Wikipedia"}, {"url": "https://stackoverflow.com/questions/48719873/how-to-get-median-and-quartiles-percentiles-of-an-array-in-javascript-or-php?rq=1", "anchor_text": "StackOverflow"}, {"url": "https://en.wikipedia.org/wiki/Box_plot#Example(s)", "anchor_text": "Wikipedia"}, {"url": "https://www.flickr.com/photos/hit-thepineapple/3740510520/in/photolist-6Gx6sG-3BRTT-aKGUWR-vfmAbJ-2jQXvsu-2jbxm87-8RdPJ-8b7L44-27Bpxnx-6Zk8FP-eMsWsS-3RFHy-smyjPc-8veeS2-2e9yDYX-Wu5D6r-bnCWXg-55QKEB-TnH85D-6jfenr-4TYH1T-2e9yDZi-5Bq4G1-2cKFWDr-6CCPBy-2icpZMn-2gvGVpQ-2hutLvF-U76bvn-2inoGCK-4uqPt7-72LKqn-7txdM-67hfDv-2cKFWDM-Nb3XAw-6t9gHx-8AUJY4-CyuTL-e12QP-Lewuc-W5RM2o-2hztpRp-4ZKnuV-nLC7gh-6wN132-Wfh7FH-2abfTG-a3RyD7-2cKFWDX", "anchor_text": "ZoeyMoey"}, {"url": "https://www.flickr.com/photos/hit-thepineapple/", "anchor_text": "Flickr"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e71b1304a932---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e71b1304a932---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data?source=post_page-----e71b1304a932---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e71b1304a932---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----e71b1304a932---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe71b1304a932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&user=Vagif+Aliyev&userId=6b4e6b48584&source=-----e71b1304a932---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe71b1304a932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&user=Vagif+Aliyev&userId=6b4e6b48584&source=-----e71b1304a932---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe71b1304a932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e71b1304a932--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe71b1304a932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e71b1304a932---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e71b1304a932--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e71b1304a932--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e71b1304a932--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e71b1304a932--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e71b1304a932--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e71b1304a932--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e71b1304a932--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e71b1304a932--------------------------------", "anchor_text": ""}, {"url": "https://vagifaliyev.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vagifaliyev.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vagif Aliyev"}, {"url": "https://vagifaliyev.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "209 Followers"}, {"url": "http://Upword.ai", "anchor_text": "Upword.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6b4e6b48584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&user=Vagif+Aliyev&userId=6b4e6b48584&source=post_page-6b4e6b48584--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6f056d3d77d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-simple-outlier-anomaly-detection-algorithms-every-data-scientist-needs-e71b1304a932&newsletterV3=6b4e6b48584&newsletterV3Id=6f056d3d77d3&user=Vagif+Aliyev&userId=6b4e6b48584&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}