{"url": "https://towardsdatascience.com/power-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b", "time": 1683016959.568946, "path": "towardsdatascience.com/power-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b/", "webpage": {"metadata": {"title": "Power BI Functions \u2014 (List.MaxN, R-slice_max, TOPN) | by Peter Hui | Towards Data Science", "h1": "Power BI Functions \u2014 (List.MaxN, R-slice_max, TOPN)", "description": "Using these functions in Power BI to do slicing by groups with TOPN, slice_max, top_n, COUNTROWS, Data Modelling Power BI, Data Analysis Power BI"}, "outgoing_paragraph_urls": [{"url": "https://docs.microsoft.com/en-us/power-bi/connect-data/desktop-r-scripts", "anchor_text": "info on downloading", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/power-bi-column-vs-measure-which-one-should-i-use-and-when-ed91fffcea1b?sk=5a6cdbd2e5406864914367200515eb27", "anchor_text": "Here is an article", "paragraph_index": 37}], "all_paragraphs": ["Top N by groups. I personally think it\u2019s a very underrated way of exploring data. It\u2019s like a saw, you just want to saw off the first few rows of a data set for analysis. I\u2019m sure you have had to group summaries before, but you can also do some cool EDA with it using Power BI.", "If you are able to group the data you have, get the difference of the top 2 items by the group, you almost always find something interesting there. Sometimes the \u201cmagic\u201d happens when you see a big difference between specific groups and you begin asking yourself why.", "Here in this article, I want to lay out a few methods you can use to get Top N by any grouping -", "Let\u2019s take a look at the function in Power BI, you know I love Power Query, so let\u2019s start there.", "I have a simple table here \u2014 a list of units by company.", "Basically, I want to rejig this simple data frame into a table that has 2 rows of each company.", "Company A should display 21 and 4. Company B should display 44 and 33 and finally, Company C should display 66 and 22.", "If you use power query, you gotta love the group by function :)", "There is one problem though \u2014 the group by feature here only allows you to group by Max, Sum and Count, etc but doesn\u2019t allow you to display the Max 2 by group, or Max 3 by group and so on.", "Hmm.. let\u2019s still use the group by and use the Max for now. Summarizing by Max only provides a summary like this.", "It\u2019s not exactly what we want. We want top 2 by group. ( Top 2 by company A, B,C)", "Here is a tip \u2014 you may not know every Power Query functions, that\u2019s okay, you just need to use the UI to get you close to where you need to go and then tweak it from there.", "Here I will tweak the List.Max function. Instead of List.Max, I now used List.MaxN and add 2 in the parameter.", "List.MaxN takes a list as input and a count as a second input.", "Here we have the [Units] as a list and 2 is the N number we wish to return.", "Now it returns a list of the 2 max values by group.", "We will expand this column though, so we can do this by copying the result into a new column.", "Let\u2019s expand it and it\u2019ll get us to what we want.", "Simple right? We now have top 2 by [Company].", "You can also do the same by running an R script.", "You can do this via Transform > Run R Script. You will need to have R downloaded first. This is where you can find some info on downloading it.", "To run the R script \u2014 select the Run R script ribbon and it will give you an empty dialogue box.", "Here, you will need to load your R package and run the script.", "This message at the top is saying the current table is called \u201cdataset\u201d.", "I love the Tidyverse \u2014 here the script reads,", "Take the dataset, group it by Company, then take the top_n or top 2 in this case of each group and return it in a table called \u201cNew\u201d", "Side note: you can also use slice_max which is the most current function since top_n has been superseded. You can just replace top_n with slice_max", "How about top n without Power Query and just straight in Power BI?", "If you want the Top 2 for each company, you can simply drag in the columns of company and units into the visualization pane using the table visual.", "Step 1 \u2014 After you have loaded in your data \u2014 select the table visual.", "Step 2 \u2014 put in the columns [Company] and [Units]. I jazzed it up a bit using the table styles.", "Step 3 \u2014 Select Top N and input 2 since we want to see the top 2 by group and the value being evaluated is [Units].", "Wait a minute \u2014 that doesn\u2019t make sense! I want the top 2 by group, not all of the groups.", "This is the great thing about Power BI \u2014 you can add in a filter to change the context of the entire visual. ( A single visual, single page or all pages for that matter)", "Select a company and it will give you the top 2 in [Company] A, B or C.", "On the side panels, if you prefer, you can use those buckets as filters as well if you don\u2019t want the filters to be displayed on the page itself.", "Now another way of doing this is using COUNTROWS and display this as a calculated column.", "I always believe that calculated columns should be done for categories you want to slice and dice by. Here is an article if that helps. Here, we can slice and dice by the ranking of 1 and 2.", "I\u2019ll insert a new column using the below formula.", "It\u2019s a bit complicated \u2014 but these are the functions you will need to know.", "ALLEXCEPT \u2014 it\u2019s a grouping function, if you use it for \u2018Table (3)\u2019[Company], it will group the [Company] column for measures you will use.", "EARLIER \u2014 it\u2019s somewhat like R lag function but not exactly, since the order of the evaluation doesn\u2019t change the the value of the column is sorted.", "FILTER \u2014 returns a table, according to your filter conditions.", "In Power BI, when you see a FILTER function, read it from there first. Here the script reads,", "Return a table that creates a grouping of [Company] using ALLEXCEPT and compare the [Units] using EARLIER. Then count the rows of the units column of units that have the same value or more using COUNTROWS.", "The result once filtered will give you this.", "You can then build measures based on the ranking of 1 and 2 and go from there.", "What do I do with this?", "Ask yourself \u2014 at your work and the dataset you deal with, did you only take the max or min of a group summarized it, and reported it? Maybe comparing the top 2 will give you something interesting.", "There you have it \u2014 a simple Top n analysis using Power Query, R, and Power BI.", "Thank you everyone for the claps and \u2018Hello\u2019 to all the new followers :)", "I hope to write these articles every 2 weeks or so. I learn a lot from writing these and I hope you learn something from them too.", "Be safe! Take care of yourself and good luck with your data journey!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about Power BI, Power Automate and other cool Microsoft power tools. Microsoft certified data analyst. Constant learner and an aspiring writer. \ud83d\udc4d"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3c422f02de9b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://peter-hui.medium.com/?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": ""}, {"url": "https://peter-hui.medium.com/?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": "Peter Hui"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F62a43e57781b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&user=Peter+Hui&userId=62a43e57781b&source=post_page-62a43e57781b----3c422f02de9b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c422f02de9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c422f02de9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@greysonjoralemon?utm_source=medium&utm_medium=referral", "anchor_text": "Greyson Joralemon"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://docs.microsoft.com/en-us/power-bi/connect-data/desktop-r-scripts", "anchor_text": "info on downloading"}, {"url": "https://towardsdatascience.com/power-bi-column-vs-measure-which-one-should-i-use-and-when-ed91fffcea1b?sk=5a6cdbd2e5406864914367200515eb27", "anchor_text": "Here is an article"}, {"url": "https://medium.com/tag/power-bi?source=post_page-----3c422f02de9b---------------power_bi-----------------", "anchor_text": "Power Bi"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3c422f02de9b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----3c422f02de9b---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/technology?source=post_page-----3c422f02de9b---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/learning?source=post_page-----3c422f02de9b---------------learning-----------------", "anchor_text": "Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3c422f02de9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&user=Peter+Hui&userId=62a43e57781b&source=-----3c422f02de9b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3c422f02de9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&user=Peter+Hui&userId=62a43e57781b&source=-----3c422f02de9b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c422f02de9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3c422f02de9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3c422f02de9b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3c422f02de9b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3c422f02de9b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3c422f02de9b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3c422f02de9b--------------------------------", "anchor_text": ""}, {"url": "https://peter-hui.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://peter-hui.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Peter Hui"}, {"url": "https://peter-hui.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "592 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F62a43e57781b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&user=Peter+Hui&userId=62a43e57781b&source=post_page-62a43e57781b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd0268e337bf9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpower-bi-functions-list-maxn-r-slice-max-topn-3c422f02de9b&newsletterV3=62a43e57781b&newsletterV3Id=d0268e337bf9&user=Peter+Hui&userId=62a43e57781b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}