{"url": "https://towardsdatascience.com/how-to-make-a-gpt2-twitter-bot-8669df60e60a", "time": 1683005192.993231, "path": "towardsdatascience.com/how-to-make-a-gpt2-twitter-bot-8669df60e60a/", "webpage": {"metadata": {"title": "How to Make a GPT2 Twitter Bot. It\u2019s only ~100 lines of code but the\u2026 | by Nicolas Bertagnolli | Towards Data Science", "h1": "How to Make a GPT2 Twitter Bot", "description": "How to make a twitter bot using gpt2. This is a tutorial on implementing a gpt2 twitter bot using tweepy, python, and gpt2."}, "outgoing_paragraph_urls": [{"url": "https://twitter.com/deepproverbs", "anchor_text": "one", "paragraph_index": 1}, {"url": "https://github.com/nbertagnolli/DeepProverbs", "anchor_text": "this repository", "paragraph_index": 1}, {"url": "https://github.com/minimaxir/gpt-2-simple", "anchor_text": "gpt2-simple library", "paragraph_index": 2}, {"url": "https://github.com/nbertagnolli/DeepProverbs", "anchor_text": "repository", "paragraph_index": 2}, {"url": "https://developer.twitter.com/", "anchor_text": "developer site", "paragraph_index": 6}, {"url": "https://github.com/nbertagnolli/DeepProverbs/tree/master/Data", "anchor_text": "here", "paragraph_index": 18}, {"url": "https://twitter.com/kanyewest_bot", "anchor_text": "Kanye West tweets", "paragraph_index": 18}, {"url": "https://twitter.com/deepdrumpf?lang=en", "anchor_text": "current", "paragraph_index": 18}, {"url": "https://twitter.com/roborosewater?lang=en", "anchor_text": "magic cards", "paragraph_index": 18}, {"url": "https://github.com/minimaxir/gpt-2-simple", "anchor_text": "amazing library", "paragraph_index": 21}, {"url": "https://openai.com/blog/better-language-models/", "anchor_text": "GPT2", "paragraph_index": 21}, {"url": "https://github.com/nbertagnolli/DeepProverbs", "anchor_text": "repository", "paragraph_index": 33}, {"url": "https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/", "anchor_text": "https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/", "paragraph_index": 36}], "all_paragraphs": ["I love generative models. There is something magical about showing a machine a bunch of data and having it draw a picture or write a little story in the same vein as the original material. What good are these silly little models if we can\u2019t share them with others right? This is the information age after all. In this post we\u2019ll:", "When you\u2019re done with the tutorial you\u2019ll be able to create a bot just like this one which tweets out generated proverbs. All code for this project can be found in this repository. Let\u2019s get started : ).", "This tutorial will use Python3. We will be using the gpt2-simple library to train our model. It relies on tensorflow.contrib which was removed in tensorflow 2.0 so you\u2019ll need to use an earlier version : /. Sorry about that. To make things easy I\u2019ve put together a docker container and Makefile for easy running in the repository. You can load up a working environment to play in by building the docker container:", "If Jupyter is more your style you can also do", "just notice that the port is set to 8989 instead of the usual 8888.", "Setting up a bot with Twitter just requires you to apply for a developer account and link the credentials with whatever code you want to run. The below section walks through in detail setting up a developer account. It\u2019s kind of boring so if you\u2019ve already got one just skip to the next section.", "Start by logging into Twitter then heading to their developer site. You should see something like the below image.", "Click the Apply button in the top right. This will take you to a new page where you need to click on \u201capply for a developer account.\u201d", "This will take you to a page asking what you\u2019re going to be doing with the developer account. We\u2019re making a bot so choose that, but if you\u2019re feeling spicy and want to do other things mark those as well.", "Then fill in all the information on the next page and add a phone number.", "The last page involves two questions which need to be answered. Below I outline my responses to each question which got approval. Feel free to copy them if you intend to use this bot as I do just to make tweets sometimes. You can mark the other ones as not relevant for this bot.", "In English, please describe how you plan to use Twitter data and/or APIs. The more detailed the response, the easier it is to review and approve.", "\u201cI plan to build a small bot which will use GPT2, a Markov Chain, or some variation of an RNN to make simple tweets daily about a given topic. The purpose is to just share some of the fun generated text that these models make via the Twitter platform.\u201d", "Will your app use Tweet, Retweet, like, follow, or Direct Message functionality?", "\u201cThe app will use the tweepy Python library to update the bot\u2019s twitter status with a tweet daily. The Python script will be run from a cron job on my computer and will only use the Tweet functionality.\u201d", "You\u2019ll need to wait for them to approve your application. At this point, we have the pleasure of filling out another form describing our App! Navigate to the App page by clicking on your name and then the App drop down field.", "Once all of this is filled out and submitted you should be good to go. You\u2019ll see your new app in the App page. When you click on details you can get your API keys. You can only view your access tokens one time so make sure to write them down. I stored mine in a JSON file. This made it easy for me to access these tokens programmatically.", "That\u2019s it! We are finally ready to write some code!", "I\u2019m going to have my Twitter bot write funny proverbs. You can find the data I used to train my model here. For yours, see if you can find a data set where the main ideas are short and there is a decent bit of data. Some ideas might be Kanye West tweets, the tweets of current and former presidents, or even magic cards.", "The GPT2 simple model we will be using acts on a text file so all we need to do is compile whatever text source we are interested in into a single text file. One thing I like to do while training GPT2 is add separators between different sections which don\u2019t show up in the text. For example, you could just put all of the book of proverbs into one file, or you could separate each proverb with \u201c\\n==========\\n\u201d. Then the model can learn where the proverbs begin and end and you can parse the output more easily. I\u2019ve formatted the proverbs text the way I like where there is a \u201c\\n==========\\n\u201d delimiting the end of each proverb and all extra characters have been removed.", "Making a world class generative model for text has never been easier. When I made my first generative model I had to write a ton of code to build the model, train the model, extract reasonable predictions from the model, etc. Now we can do a little transfer learning on GPT2 and get better results than we could have dreamed of a few years ago.", "Max Woolf created an amazing library which makes it super easy to fine tune GPT2. We\u2019re going to take all of his excellent work and use that interface for training. The below 30 lines of code are all that\u2019s needed to fine tune a best in class generative model. The gpt2_simple finetune function takes in a few parameters which are worth explaining.", "We can calculate the number of steps by looking at the total number of words in the text using the wc utility:", "We can see that this file has 1,816 lines, 15,984 words, and 93,056 characters. The default number of words passed to the model in a step is set with the sample_length parameter and is 1023 by default. So 15984 / 1023 = 15.6. So every 16 steps we go through all of the data one time. That means we should probably train our model for somewhere between 33 and 66 steps. To avoid overfitting.", "To generate new text given the model we can use the gpt2_simple.generate function like so:", "Again let\u2019s break down these arguments.", "Running that code we can generate some proverbs!", "We have data, a model that has been trained on our data, and a Twitter developer account all that is left is to link them together. Our bot needs to do 3 things.", "Luckily Tweepy makes the first and third part super easy and we\u2019ve already done the second!", "To start we need to get our credentials into Python. As I mentioned earlier I stored mine in a little JSON file so that it was super easy to load it in with Python.", "With all of these credentials, we can authenticate with the Twitter API using Tweepy.", "Now we can generate new text using the code we wrote earlier. I packaged all of that into a little function called generate_text. After generating the text we want to make sure we don\u2019t grab any spans of text longer than 280 characters, because that\u2019s Twitter\u2019s tweet limit.", "Tweeting is just two lines now! Select a proverb at random, then update the bots status using Tweepy!", "We\u2019ve got code to generate tweets in the style of biblical proverbs, and the technology to do this with any text corpus! I usually just schedule a cron job on my server to run this once or twice a day. I\u2019ve included a Makefile in the repository to make it easy to have the bot tweet with one command. Simply run:", "I wrapped all of the code we\u2019ve written today into some nice click functions so it should be easy to run from the command line.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CAIO at mpathic. I\u2019m working on applying modern NLP techniques to improve communication. Let\u2019s connect https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8669df60e60a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8669df60e60a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8669df60e60a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nbertagnolli.medium.com/?source=post_page-----8669df60e60a--------------------------------", "anchor_text": ""}, {"url": "https://nbertagnolli.medium.com/?source=post_page-----8669df60e60a--------------------------------", "anchor_text": "Nicolas Bertagnolli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa998d10e34d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=post_page-a998d10e34d8----8669df60e60a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8669df60e60a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8669df60e60a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://twitter.com/deepproverbs", "anchor_text": "one"}, {"url": "https://github.com/nbertagnolli/DeepProverbs", "anchor_text": "this repository"}, {"url": "https://github.com/minimaxir/gpt-2-simple", "anchor_text": "gpt2-simple library"}, {"url": "https://github.com/nbertagnolli/DeepProverbs", "anchor_text": "repository"}, {"url": "https://developer.twitter.com/", "anchor_text": "developer site"}, {"url": "https://github.com/nbertagnolli/DeepProverbs/tree/master/Data", "anchor_text": "here"}, {"url": "https://twitter.com/kanyewest_bot", "anchor_text": "Kanye West tweets"}, {"url": "https://twitter.com/deepdrumpf?lang=en", "anchor_text": "current"}, {"url": "https://twitter.com/roborosewater?lang=en", "anchor_text": "magic cards"}, {"url": "https://github.com/minimaxir/gpt-2-simple", "anchor_text": "amazing library"}, {"url": "https://openai.com/blog/better-language-models/", "anchor_text": "GPT2"}, {"url": "https://github.com/nbertagnolli/DeepProverbs", "anchor_text": "repository"}, {"url": "https://medium.com/tag/ai?source=post_page-----8669df60e60a---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/python?source=post_page-----8669df60e60a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8669df60e60a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----8669df60e60a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/twitter?source=post_page-----8669df60e60a---------------twitter-----------------", "anchor_text": "Twitter"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8669df60e60a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=-----8669df60e60a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8669df60e60a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=-----8669df60e60a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8669df60e60a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8669df60e60a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8669df60e60a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8669df60e60a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8669df60e60a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8669df60e60a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8669df60e60a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8669df60e60a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8669df60e60a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8669df60e60a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8669df60e60a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8669df60e60a--------------------------------", "anchor_text": ""}, {"url": "https://nbertagnolli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nbertagnolli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nicolas Bertagnolli"}, {"url": "https://nbertagnolli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "286 Followers"}, {"url": "https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/", "anchor_text": "https://www.linkedin.com/in/nicolas-bertagnolli-058aba81/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa998d10e34d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=post_page-a998d10e34d8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1205c8722589&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-a-gpt2-twitter-bot-8669df60e60a&newsletterV3=a998d10e34d8&newsletterV3Id=1205c8722589&user=Nicolas+Bertagnolli&userId=a998d10e34d8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}