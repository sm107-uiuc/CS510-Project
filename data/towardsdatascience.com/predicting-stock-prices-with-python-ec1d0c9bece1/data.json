{"url": "https://towardsdatascience.com/predicting-stock-prices-with-python-ec1d0c9bece1", "time": 1682993916.768107, "path": "towardsdatascience.com/predicting-stock-prices-with-python-ec1d0c9bece1/", "webpage": {"metadata": {"title": "Predicting Stock Prices with Python | by Lucas Kohorst | Towards Data Science", "h1": "Predicting Stock Prices with Python", "description": "Investing in the stock market used to require a ton of capital and a broker that would take a cut from your earnings. Then Robinhood disrupted the industry allowing you to invest as little as $1 and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pypi.org/project/scikit-learn/", "anchor_text": "scikit-learn", "paragraph_index": 2}, {"url": "https://pypi.org/project/iexfinance/", "anchor_text": "iexfinnance", "paragraph_index": 2}, {"url": "https://sites.google.com/a/chromium.org/chromedriver/", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://finance.yahoo.com/screener/predefined/aggressive_small_caps?offset=0&count=202", "anchor_text": "https://finance.yahoo.com/screener/predefined/aggressive_small_caps?offset=0&count=202", "paragraph_index": 12}, {"url": "https://finance.yahoo.com/screener", "anchor_text": "https://finance.yahoo.com/screener", "paragraph_index": 12}, {"url": "https://20somethingfinance.com/how-to-send-text-messages-sms-via-email-for-free/", "anchor_text": "website", "paragraph_index": 32}, {"url": "https://github.com/Lucas-Kohorst/Python-Stock/", "anchor_text": "View the full source code on Github", "paragraph_index": 37}], "all_paragraphs": ["Investing in the stock market used to require a ton of capital and a broker that would take a cut from your earnings. Then Robinhood disrupted the industry allowing you to invest as little as $1 and avoid a broker altogether. Robinhood and apps like it have opened up investing to anyone with a connected device and gave non-investors the opportunity to profit from the newest tech start-up.", "However, giving those of us who are not economists or accountants the freedom to invest our money in the \u201chottest\u201d or \u201ctrending\u201d stocks is not always the best financial decision.", "Thousands of companies use software to predict the movement in the stock market in order to aid their investing decisions. The average Robinhood user does not have this available to them. Primitive predicting algorithms such as a time-sereis linear regression can be done with a time series prediction by leveraging python packages like scikit-learn and iexfinnance.", "This program will scrape a given amount of stocks from the web, predict their price in a set number of days and send an SMS message to the user informing them of stocks that might be good to check out and invest in.", "In order to create a program that predicts the value of a stock in a set amount of days, we need to use some very useful python packages. You will need to install the following packages:", "If you do not already have some of these packages you can install them through pip install PACKAGE or by cloning the git repository.", "Here is an example of installing numpy with pip", "Now open up your favorite text editor and create a new python file. Start by importing the following packages", "Note: the datetime, time and smtplib packages come with python", "In order to scrape the Yahoo stock screener, you will also need to install the Chromedriver in order to properly use Selenium. That can be found here", "Using the Selenium package we can scrape Yahoo stock screeners for stock\u2019s ticker abbreviations.", "First, make a function getStocks that takes a parameter of n, where n is the number of stocks we wish to retrieve.", "In the function create your chrome driver then use driver.get(url) to retrieve the desired webpage. We will be navigating to https://finance.yahoo.com/screener/predefined/aggressive_small_caps?offset=0&count=202 which will display 200 stocks listed in the category \u201caggressive small caps\u201d. If you go to https://finance.yahoo.com/screener you will see a list of all screener categories that Yahoo provides. You can then change the URL to your liking.", "Make sure to add the path to where you downloaded the chromedriver to where the bolded code is.", "You will now need to create a list to hold the ticker values stock_list = [] .", "Next, we need to find the XPath for the ticker elements so that we can scrape them. Go to the screener URL and open up developer tools in your web browser (Command+Option+i / Control+Shift+I or F12 for Windows).", "Click on the ticker and inspect its attributes", "Finally, copy the XPath of the first ticker the HTML element should look something like this", "The XPath should look something like this", "If you inspect the ticker attributes below the first one you will notice that the XPath is exactly the same except the bolded 1 in the code above increments by 1 for each ticker. So the 57th ticker XPath value is", "This greatly helps us. We can simply make a for loop that increments that value every time it runs and stores the value of the ticker to our stock_list.", "n is the number of stocks that our function, getStocks(n), will retrieve. We have to increment by 1 since Python is 0-indexed. Then we use the value i to modify our XPath for each ticker attribute.", "Use driver.quit() to exit the web browser. We now have all ticker values and are ready to predict the stocks.", "We are going to create a function to predict the stocks in the next section but right now we can create another for loop that cycles through all the ticker values in our list and predicts the price for each.", "Handle the code with a try and except block (just in case our stock package does not recognize the ticker value).", "Create a new function predictData that takes the parameters stock and days (where days is the number of days we want to predict the stock in the future). We are going to use about 2 years of data for our prediction from January 1, 2017, until now (although you could use whatever you want). Set start = datetime(2017, 1, 1) and end = datetime.now(). Then use the iexfinance function to get the historical data for the given stock df = get_historical_data(stock, start=start, end=end, output_format=\u2019pandas\u2019).", "Then export the historical data to a .csv file, create a new virtual column for the prediction and set forecast_time = int(days)", "Use numpy to manipulate the array then, preprocess the values and create X and Y training and testing values. For this prediction, we are going to use a test_size of 0.5 this value gave me the most accurate results.", "Finally, run a linear regression on the data. Create a variable clf = LinearRegression(), fit the X and Y training data and store the X value prediction in a variable prediction.", "In the next section, we will define the function, sendMessage, that sends the prediction of the stocks via SMS. In the predictData function add an if statement that stores a string as the output and calls the sendMessage function passing it the parameter output.", "The variable output can contain whatever information that you find useful. I had it tell me the stock name, the 1-day prediction and the 5-day prediction.", "Create a function sendMessage that takes output as a parameter. To send an SMS message we are going to use the smtplib package making it so we can send text messages through our email.", "Store your email username, password and the receiving number as variables. My cell phone carrier is Verizon so I am using the @vtext domain here are some popular phone companies extensions thanks to this website.", "Use the following lines to send the SMS with the proper message", "Finally, create a main method to run the program. We are going to set the number of stocks to be predicted at 200.", "Running the prediction on just 10 stocks the average percent error between the actual 1-day price and 1 day predicted price was 9.02% where the 5-day percent error was a surprising 5.90% off. This means that, on average, the 5-day prediction was only $0.14 off of the actual price.", "These results could be attributed to a small sample size but either way they are promising and can serve as a great aid when you are investing in stocks.", "View the full source code on Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fec1d0c9bece1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lucaskohorst.medium.com/?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": ""}, {"url": "https://lucaskohorst.medium.com/?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": "Lucas Kohorst"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11f6119feee0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&user=Lucas+Kohorst&userId=11f6119feee0&source=post_page-11f6119feee0----ec1d0c9bece1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec1d0c9bece1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec1d0c9bece1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rawpixel?utm_source=medium&utm_medium=referral", "anchor_text": "rawpixel"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://pypi.org/project/scikit-learn/", "anchor_text": "scikit-learn"}, {"url": "https://pypi.org/project/iexfinance/", "anchor_text": "iexfinnance"}, {"url": "https://pypi.org/project/numpy/", "anchor_text": "nump"}, {"url": "https://pypi.org/project/selenium/", "anchor_text": "selenium"}, {"url": "https://pypi.org/project/scikit-learn/", "anchor_text": "sklearn"}, {"url": "https://pypi.org/project/iexfinance/", "anchor_text": "exfinance"}, {"url": "https://github.com/numpy/numpy", "anchor_text": "https://github.com/numpy/numpy"}, {"url": "https://sites.google.com/a/chromium.org/chromedriver/", "anchor_text": "here"}, {"url": "https://finance.yahoo.com/screener/predefined/aggressive_small_caps?offset=0&count=202", "anchor_text": "https://finance.yahoo.com/screener/predefined/aggressive_small_caps?offset=0&count=202"}, {"url": "https://finance.yahoo.com/screener", "anchor_text": "https://finance.yahoo.com/screener"}, {"url": "http://twitter.com/id", "anchor_text": "@id"}, {"url": "http://twitter.com/id", "anchor_text": "@id"}, {"url": "https://20somethingfinance.com/how-to-send-text-messages-sms-via-email-for-free/", "anchor_text": "website"}, {"url": "https://github.com/Lucas-Kohorst/Python-Stock/", "anchor_text": "View the full source code on Github"}, {"url": "https://medium.freecodecamp.org/creating-a-twitter-bot-in-python-with-tweepy-ac524157a607", "anchor_text": "Create a Twitter Bot in Python Using TweepyWith about 15% of Twitter being composed of bots, I wanted to try my hand at it. I googled how to create a Twitter bot\u2026medium.freecodecamp.org"}, {"url": "https://medium.com/@lucaskohorst/twitter-data-analysis-d5fb7d42ebc7", "anchor_text": "Twitter Data AnalysisAfter creating the Free Wtr bot using Tweepy and Python and this code, I wanted a way to see how Twitter users were\u2026medium.co"}, {"url": "https://towardsdatascience.com/ranking-news-bias-in-python-e9bb5d1ba93f", "anchor_text": "Ranking News Bias in PythonI recently read an article in the Washington Post titled, \u201cRanking the media from liberal to conservative, based on\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/python?source=post_page-----ec1d0c9bece1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----ec1d0c9bece1---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ec1d0c9bece1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/predictive-analytics?source=post_page-----ec1d0c9bece1---------------predictive_analytics-----------------", "anchor_text": "Predictive Analytics"}, {"url": "https://medium.com/tag/predictions?source=post_page-----ec1d0c9bece1---------------predictions-----------------", "anchor_text": "Predictions"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fec1d0c9bece1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&user=Lucas+Kohorst&userId=11f6119feee0&source=-----ec1d0c9bece1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fec1d0c9bece1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&user=Lucas+Kohorst&userId=11f6119feee0&source=-----ec1d0c9bece1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fec1d0c9bece1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fec1d0c9bece1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ec1d0c9bece1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ec1d0c9bece1--------------------------------", "anchor_text": ""}, {"url": "https://lucaskohorst.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lucaskohorst.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lucas Kohorst"}, {"url": "https://lucaskohorst.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "587 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11f6119feee0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&user=Lucas+Kohorst&userId=11f6119feee0&source=post_page-11f6119feee0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9cb2d1b33469&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-with-python-ec1d0c9bece1&newsletterV3=11f6119feee0&newsletterV3Id=9cb2d1b33469&user=Lucas+Kohorst&userId=11f6119feee0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}