{"url": "https://towardsdatascience.com/single-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de", "time": 1683017266.818031, "path": "towardsdatascience.com/single-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de/", "webpage": {"metadata": {"title": "Single and Multi-Step Temperature Time Series Forecasting for Vilnius Using LSTM Deep Learning Model | by Eligijus Bujokas | Towards Data Science", "h1": "Single and Multi-Step Temperature Time Series Forecasting for Vilnius Using LSTM Deep Learning Model", "description": "The aim of this article is to provide code examples and explain the intuition behind modeling time series data using python and TensorFlow. The article above explains how to forecast time-series data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://openweathermap.org/", "anchor_text": "https://openweathermap.org", "paragraph_index": 7}], "all_paragraphs": ["The aim of this article is to provide code examples and explain the intuition behind modeling time series data using python and TensorFlow.", "All the code and data is public and can be seen in the following repository:", "This article is a generalization of one of my previous articles:", "The article above explains how to forecast time-series data for a single step forward. This article shows how to do multi-step forecasting and use more than 1 feature in the model.", "The very brief version of this article is that using the past 48 hours of data and forecasting 1 hour into the future (single step) I have achieved a mean absolute error of 0.48 (0.34 median) degrees of Celcius error.", "Using the past 168 hours of data and forecasting 24 hours ahead, the mean absolute error was 1.69 (1.27 median) degrees of Celcius.", "The features used were the hourly past data of temperature, the daily and yearly cyclical signals, pressure, and wind speed.", "The data is obtained using an API from https://openweathermap.org/. The data was gathered every hour from 1990.01.01 to 2020.11.30 near the TV tower of Vilnius. Vilnius is not a large metropolis and the TV tower is in the city itself so the temperature that is near the tower should be very similar to what is the temperature in all parts of the city.", "Here and throughout the article the main data object is called d. It is created by reading the raw data:", "There are 271008 total data points in the dataset.", "The data seems to be stationary with a clear cyclical pattern.", "The graph above shows that there is a clear day cycle of temperatures \u2014 the median temperature is the highest around noon and the lowest around midnight.", "The cyclical pattern is even more evident in the temperatures grouped by month \u2014 the hottest months are June up to August and the coldest ones are December to February.", "The problem with the data as it is now, we only have the date column. If would convert it to numeric (let us say, extract the timestamp in seconds) and add it as a feature in modeling the cyclical nature would be lost. Thus, the first thing we need to do is to engineer some features that catch the cyclical trend.", "We want the machine to know that hours 23 and 0 are closer to each other than hours 0 and 4. We know that the period of the cycle is 24 hours. We can use the cos(x) and sin(x) functions. The x in the functions is the hour of the day.", "The head of the resulting data frame:", "The newly created features catch the cyclical pattern. The question may arise, why do we use both sin and cos functions?", "Drawing a horizontal line in the above graph and analyzing just one of the curves we would get that, for example, cos(7.5h) = cos(17.5h) and so on. This may lead to some errors when learning and predicting so in order to make every point unique, we add another cyclical function. Using the two features together, all times can be distinguished from each other.", "To create the same cyclical logic for the time of the year, we will use the timestamp functionality. Timestamp in python is a value that calculates how many seconds have passed since 1970.01.01 0H:0m:0s. Every date object in python has the function timestamp().", "In this section, we have created 4 additional features from the datetime column: day_sin, day_cos, month_sin and month_cos.", "In the weather dataset, there are two additional columns: wind_speed and pressure. Wind speed is measured in meters per second (m/s) and the pressure is measured in hectopascals (hPa).", "To see any relationship between the temperature and the two features we can plot the 2d histograms:", "The more intense the color the bigger the relationship in certain bin values of the two distributions. For example, the temperatures tend to be higher when the pressure is around 1010 and 1020 hPa.", "We will use these two features in modeling as well.", "The data that we have with all the feature engineering is this:", "The function f that we want to approximate is:", "The goal is to use past values to predict the future. The data is a time series or a sequence. For sequence modeling, we will choose tensorflow implementation of recurrent neural network with an LSTM layer.", "The input to an LSTM network is a 3D array:", "samples \u2014 total number of sequences constructed for training.", "timesteps \u2014 the length of the samples.", "features \u2014 number of features used.", "The first thing before modeling is from the data that is in a 2D format convert into a 3D array. The following function does that:", "For example, if we assume that the whole data is the first 10 rows of the data, we use 3 past hours as features and we want to forecast 1 step ahead:", "As we can see, the shape of the X matrix is 6 samples, 3 timesteps and 7 features. In other words, we have 6 observations each with 3 rows of data and 7 columns. There are 6 observations because the first 3 lags are dropped and used only as X data and we are forecasting 1 step ahead thus the last observation is lost as well.", "The first value pairs of X and Y are presented in the above picture.", "The hyperparameter list for the final model:", "The last step before creating all the matrices for the modeling is to scale the data.", "Now we split the matrices into training and validation matrices", "The final shapes of the matrices:", "All that is left is to create the object using the model class, train the model, and inspect the results on the validation set.", "With the trained model we can forecast and compare the values with the original ones.", "The two lines are very close to each other, they basically overlap. The distribution of absolute errors:", "The median absolute error is 0.34 degrees Celcius and the average is 0.48 degrees Celcius.", "To predict 24 hours ahead the only thing needed is to change the hyperparameters. Specifically, the n_ahead variable. The model will try to predict the next 24 hour values using 168 hours from before (one week).", "Inspecting some random chunks of 24 hours chunks:", "Some 24 hours sequences seem to be close to one another while others are not.", "The mean absolute error is 1.69 C and the median is 1.27 C.", "In conclusion, this article presented a simple pipeline example when working with modeling and forecasting of the time series data:", "Reading, cleaning, and augmenting the input data", "Selecting the hyperparameters for the lag and n steps ahead", "Selecting the hyperparameters for the deep learning model", "I hope that the reader can use the code showcased in this article in his/her professional and academic work.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A person who tries to understand the world through data and equations"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb9719a0009de&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b9719a0009de--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b9719a0009de--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://eligijus-bujokas.medium.com/?source=post_page-----b9719a0009de--------------------------------", "anchor_text": ""}, {"url": "https://eligijus-bujokas.medium.com/?source=post_page-----b9719a0009de--------------------------------", "anchor_text": "Eligijus Bujokas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd61597e07b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&user=Eligijus+Bujokas&userId=d61597e07b4d&source=post_page-d61597e07b4d----b9719a0009de---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9719a0009de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9719a0009de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@antonghost?utm_source=medium&utm_medium=referral", "anchor_text": "Anton Ivanchenko"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/Eligijus112/Vilnius-weather-LSTM", "anchor_text": "Eligijus112/Vilnius-weather-LSTMRepository for the analysis of Vilnius weather using tensorflow. The main aim of this analysis is to try to create a\u2026github.com"}, {"url": "https://towardsdatascience.com/energy-consumption-time-series-forecasting-with-python-and-lstm-deep-learning-model-7952e2f9a796", "anchor_text": "Energy consumption time series forecasting with python and LSTM deep learning modelA showcase of a class in python to model and predict time series data using deep learning.towardsdatascience.com"}, {"url": "https://openweathermap.org/", "anchor_text": "https://openweathermap.org"}, {"url": "https://medium.com/tag/lstm?source=post_page-----b9719a0009de---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----b9719a0009de---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/timeseries?source=post_page-----b9719a0009de---------------timeseries-----------------", "anchor_text": "Timeseries"}, {"url": "https://medium.com/tag/weather?source=post_page-----b9719a0009de---------------weather-----------------", "anchor_text": "Weather"}, {"url": "https://medium.com/tag/python?source=post_page-----b9719a0009de---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb9719a0009de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&user=Eligijus+Bujokas&userId=d61597e07b4d&source=-----b9719a0009de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb9719a0009de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&user=Eligijus+Bujokas&userId=d61597e07b4d&source=-----b9719a0009de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb9719a0009de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b9719a0009de--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb9719a0009de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b9719a0009de---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b9719a0009de--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b9719a0009de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b9719a0009de--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b9719a0009de--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b9719a0009de--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b9719a0009de--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b9719a0009de--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b9719a0009de--------------------------------", "anchor_text": ""}, {"url": "https://eligijus-bujokas.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://eligijus-bujokas.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Eligijus Bujokas"}, {"url": "https://eligijus-bujokas.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "359 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd61597e07b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&user=Eligijus+Bujokas&userId=d61597e07b4d&source=post_page-d61597e07b4d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3e3cf5271629&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsingle-and-multi-step-temperature-time-series-forecasting-for-vilnius-using-lstm-deep-learning-b9719a0009de&newsletterV3=d61597e07b4d&newsletterV3Id=3e3cf5271629&user=Eligijus+Bujokas&userId=d61597e07b4d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}