{"url": "https://towardsdatascience.com/face-recognition-with-deep-learning-767a1e6f4974", "time": 1682993516.461374, "path": "towardsdatascience.com/face-recognition-with-deep-learning-767a1e6f4974/", "webpage": {"metadata": {"title": "Do I look like Brad Pitt?. Let\u2019s ask a Deep Learning Model | by Lewis Gavin | Towards Data Science", "h1": "Do I look like Brad Pitt?", "description": "In another post I looked at data prep to extract a face from an image and align it so that regardless of the rotation of the face, the facial features were always aligned centrally. In this post I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@lewisdgavin/facial-image-data-prep-for-a-deep-learning-model-fe547473a68b", "anchor_text": "data prep", "paragraph_index": 0}, {"url": "https://medium.com/@ageitgey/machine-learning-is-fun-part-2-a26a10b68df3#.7nppi8lvx", "anchor_text": "Adam Geitgey has a great post", "paragraph_index": 4}, {"url": "http://www.lewisgavin.co.uk/Machine-Learning-Basics/", "anchor_text": "classification model", "paragraph_index": 6}, {"url": "http://www.lewisgavin.co.uk/ImageDataPrep", "anchor_text": "previous post", "paragraph_index": 8}, {"url": "http://www.cv-foundation.org/openaccess/content_cvpr_2015/app/1A_089.pdf", "anchor_text": "Google", "paragraph_index": 11}, {"url": "https://github.com/cmusatyalab/openface", "anchor_text": "Openface", "paragraph_index": 11}, {"url": "https://pypi.python.org/pypi/dlib#downloads", "anchor_text": "Dlib", "paragraph_index": 12}, {"url": "http://docs.opencv.org/3.2.0/da/df6/tutorial_py_table_of_contents_setup.html", "anchor_text": "OpenCV", "paragraph_index": 12}, {"url": "http://www.lewisgavin.co.uk/tag/machine%20learning/", "anchor_text": "Machine Learning applications", "paragraph_index": 17}, {"url": "http://www.lewisgavin.co.uk/Machine-Learning-SVM/", "anchor_text": "Support Vector Machine algorithm", "paragraph_index": 19}, {"url": "http://easyfundraising.org.uk", "anchor_text": "easyfundraising.org.uk", "paragraph_index": 29}], "all_paragraphs": ["In another post I looked at data prep to extract a face from an image and align it so that regardless of the rotation of the face, the facial features were always aligned centrally.", "In this post I will be preparing a number of images of myself and also Brad Pitt. The goal will be to train a Deep Learning model on these images to see if it can detect the difference between us when presented with a new image.", "It\u2019s sort of a Catch-22. If all goes well the model will be able to recognise me or Brad Pitt successfully. On the other hand, if it can do this easily, it probably means I look nothing like Brad Pitt!", "Machine Learning and Deep Learning are quite overloaded terms. They are seen as the silver bullet that can solve any problem, easily, without much effort. However it isn\u2019t always so simple. In order to build a model you need to understand what it is you are looking for, what parameters are available, how much training data is available, how reliable it is etc.", "Deep Learning is a strand of Machine Learning that concentrates on Neural Networks. That is programming and building a model that is inspired by the human brain. Adam Geitgey has a great post that will explain Neural Networks a lot better than I ever could.", "For this post, Deep Learning will be used to produce points called embeddings (explained later). These points describe the image of the face. It\u2019s goal in our case, given images for two sets of people, is to ensure the points (embeddings) it produces are very similar for faces of the same person but very different for the faces of the other person.", "This will then allow us to train a classification model to tell the two sets of images apart.", "The first step was to get some more data. I didn\u2019t want to spend forever digging and downloading images so I initially trialled it with 3 images of Brad and 3 images of myself, just to prove the concept.", "I run each of the images through the face_skew.py python application I wrote in the previous post. This gave me a total of 6 aligned images.", "I stored these images in a folder called aligned_faces each within their own sub directory.", "Now I had prepped my data, it was time to build the embeddings.", "Remember that these embeddings are a set of 128 points that are produced by the Neural Network. These points are similar for the same faces and different from the faces of others. The 128 point embeddings process was developed out of some research at Google. Building a Deep Learning model to do this is time consuming and requires some beefy graphics cards. To overcome this, I have used a pre-trained model from Openface.", "They provide some helper code along with the model that helped me generate my embeddings. You will need to make sure you have Python installed with the sklearn and pandas libraries, along with Dlib, OpenCV and Openface(https://github.com/cmusatyalab/openface) installed too.", "Once you have all that installed, go into the Openface base directory, then into a folder called batch-recognise.", "From here I run the following commands to build the embeddings for my aligned faces.", "In the outDir this should produce 2 files: labels.csv and reps.csv. These contain the image paths for the input images and a row of 128 points for each image respectively.", "Success! I have run my images against a Deep Learning model and produced some output", "You may notice a trend when dealing with Machine Learning applications. Most of the work is in the data prep and getting the data into a format the is machine readable. In our case here, it was taking image data and converting it to a numerical representation. Before classifying textual data for sentiment analytics we have to do the same thing.", "Once completed, all that remained was building a simple classifier to do the \u201crecognition\u201d.", "If you want a more advanced approach to this step, you could train your own classification model to classify the embeddings. However within the Openface directory, they kindly provided an example python classifier that uses a Support Vector Machine algorithm.", "From the Openface base directory, go into the directory named demos.", "To train the classifier I ran the following:", "Now within your embeddings file, you should have a pickle file that contains your generated SVM.", "To test it, I simply obtained two extra images that were different to the ones I used to train the model. One of myself and the other of Brad Pitt.", "I ran them through and obtained the following results:", "In conclusion, unfortunately, even with a training data set of just 3 images, the model was able to easily tell me and Brad Pitt apart! I should have seen it coming really.", "It did however seem to work with just that small sample of data. This was a great intro to get me started with understanding the power of deep learning and how it works. It\u2019s important to read around on the subject as well as just copying a pasting the commands though, to at least gain some understanding of how the model worked.", "In the future I\u2019ll be looking at trying to build my own Deep Learning model from scratch.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data and Productivity Writer \u2014 Data Architect at easyfundraising.org.uk"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F767a1e6f4974&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lewisdgavin.medium.com/?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": ""}, {"url": "https://lewisdgavin.medium.com/?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": "Lewis Gavin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4fae13346549&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&user=Lewis+Gavin&userId=4fae13346549&source=post_page-4fae13346549----767a1e6f4974---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F767a1e6f4974&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F767a1e6f4974&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@lewisdgavin/facial-image-data-prep-for-a-deep-learning-model-fe547473a68b", "anchor_text": "data prep"}, {"url": "https://medium.com/@ageitgey/machine-learning-is-fun-part-2-a26a10b68df3#.7nppi8lvx", "anchor_text": "Adam Geitgey has a great post"}, {"url": "http://www.lewisgavin.co.uk/Machine-Learning-Basics/", "anchor_text": "classification model"}, {"url": "http://www.lewisgavin.co.uk/ImageDataPrep", "anchor_text": "previous post"}, {"url": "http://www.cv-foundation.org/openaccess/content_cvpr_2015/app/1A_089.pdf", "anchor_text": "Google"}, {"url": "https://github.com/cmusatyalab/openface", "anchor_text": "Openface"}, {"url": "https://pypi.python.org/pypi/dlib#downloads", "anchor_text": "Dlib"}, {"url": "http://docs.opencv.org/3.2.0/da/df6/tutorial_py_table_of_contents_setup.html", "anchor_text": "OpenCV"}, {"url": "http://www.lewisgavin.co.uk/tag/machine%20learning/", "anchor_text": "Machine Learning applications"}, {"url": "http://www.lewisgavin.co.uk/Machine-Learning-SVM/", "anchor_text": "Support Vector Machine algorithm"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----767a1e6f4974---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----767a1e6f4974---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----767a1e6f4974---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/ai?source=post_page-----767a1e6f4974---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----767a1e6f4974---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F767a1e6f4974&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&user=Lewis+Gavin&userId=4fae13346549&source=-----767a1e6f4974---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F767a1e6f4974&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&user=Lewis+Gavin&userId=4fae13346549&source=-----767a1e6f4974---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F767a1e6f4974&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F767a1e6f4974&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----767a1e6f4974---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----767a1e6f4974--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----767a1e6f4974--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----767a1e6f4974--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----767a1e6f4974--------------------------------", "anchor_text": ""}, {"url": "https://lewisdgavin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lewisdgavin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lewis Gavin"}, {"url": "https://lewisdgavin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.4K Followers"}, {"url": "http://easyfundraising.org.uk", "anchor_text": "easyfundraising.org.uk"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4fae13346549&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&user=Lewis+Gavin&userId=4fae13346549&source=post_page-4fae13346549--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbf4772af6419&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-recognition-with-deep-learning-767a1e6f4974&newsletterV3=4fae13346549&newsletterV3Id=bf4772af6419&user=Lewis+Gavin&userId=4fae13346549&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}