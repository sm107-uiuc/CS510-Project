{"url": "https://towardsdatascience.com/getting-machine-learning-models-ready-for-production-a970b5cfb88d", "time": 1683000314.661577, "path": "towardsdatascience.com/getting-machine-learning-models-ready-for-production-a970b5cfb88d/", "webpage": {"metadata": {"title": "Getting Machine Learning Models Ready For Production | by Adit Mehta | Towards Data Science", "h1": "Getting Machine Learning Models Ready For Production", "description": "As a Scientist, it\u2019s incredibly satisfying to be given the freedom to experiment by applying new research and rapidly prototyping. This satisfaction can be sustained quite well in a lab environment\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/pandas-profiling/pandas-profiling", "anchor_text": "Pandas Profiling", "paragraph_index": 9}, {"url": "https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell", "anchor_text": "Master", "paragraph_index": 25}], "all_paragraphs": ["As a Scientist, it\u2019s incredibly satisfying to be given the freedom to experiment by applying new research and rapidly prototyping. This satisfaction can be sustained quite well in a lab environment but can diminish quickly in a corporate environment. This is because of the underlying commercial value motive which science is driven by in a business setting \u2014 if it doesn\u2019t add business value to employees or customers, there\u2019s no place for it! Business value, however, goes beyond just being a nifty experiment which shows potential value to employees or customers. In the context of Machine Learning models, the only [business] valuable models, are models in Production!", "In this blog post, I will take you through the journey which my team and I went through in taking Machine Learning models to Production and some important lessons learnt along the way.", "After building several PoCs which didn\u2019t pivot into MVPs, we realised that there are 3 things we needed to get right:", "So, in order to get these three things right, we chartered out an 8 week sprint plan which (from a Data Science perspective) looked like this.", "Note: this blog post will not discuss the technical details involved in the actual production deployment. I\u2019ll save that for another post.", "AI is an extremely overwhelming field! New technologies, algorithms and approaches are being developed and published every day. For this reason, research is key!", "In our context, we were tackling an anomaly detection problem and so each Data Scientist in the team spent the first sprint researching different approaches to anomaly detection which could be applied to our problem. This research process involved reading papers, blogs, watching videos, cloning Github repos and playing with code \u2014 you name it! All of this research culminated in a consolidated view of the technical landscape relevant to solving our problem.", "By the end of the week each Data Scientist had to write up a short literature review and play back the findings of their research to the team.", "That\u2019s the way it goes for modelling! So, to prevent this from happening, it is crucial that you understand the data you\u2019re working with! To gain this understanding, EDA is the way to go!", "For us, this process was fairly model agnostic \u2014 we just wanted to understand our data. This process involved checking the cleanliness of our data, plotting data distributions, findings correlations, and extracting potentially useful fields for feature engineering. There are a tonne of resources out there to help with EDA including some really awesome libraries such as Pandas Profiling.", "The result of this exercise was an understanding of what data to use and how to use it for feature engineering and model building.", "Feature Engineering is arguably the most important step in building Machine Learning Models. It does not matter how much data you have or what model architecture you apply, Bad Features = Bad Model!", "We decided on a rule: 1 Data Scientist per model. Each Data Scientist spent this sprint doing Feature Engineering in the context of a particular Machine Learning algorithm. There was a fair bit of experimentation involved in Feature Engineering but the EDA performed in the previous sprint, along with some intuition from our Business Stakeholders, gave us a good starting point. We quickly realised that it is quite difficult deciding which features work best for a particular model. To come to a decision, we ran baseline models (default hyper-parameters) over various feature permutations and measured model performance against appropriate success metrics.", "The output of this sprint was a playback of our Feature Selection to business and the team, showing them baseline model performance results, and talking through the intuition behind the features used.", "A common misconception is that model development accounts for the majority of Data Scientists\u2019 time. As we discovered, a large amount of Data Scientists\u2019 time is spent cleaning, exploring, and manipulating data such that it can be used by a Machine Learning algorithm, and not developing the algorithm itself.", "The purpose of this sprint was clear to us: Find the perfect pickle!", "Each Data Scientist went about developing further on top of their baseline models by trying out different model architectures and hyper-parameters. It is important that appropriate success metrics e.g. F1 score, accuracy etc. be selected prior to this sprint as this is what determines how well your model is performing.", "The deliverable at the end of this sprint was The Perfect Pickle \u2014 a trained model file which can be taken to production.", "Once we had a trained model that produced results which we and our business were comfortable with, we went on to model optimisation. For us, the model optimisation process largely focussed on improving the prediction speeds of our models. We had a unique system integration constraint which required us to perform end-to-end predictions in under 100ms.", "At this point, most Data Scientists would stop and say \u201cwell, my work is done\u201d.", "Data Scientist: \u201cOkay cool, I\u2019ve trained my model. Here you go\u2026\u201d", "Software Engineer: \u201cWhat must I do with this?\u201d", "Data Scientist: \u201cTake it to Production?\u201d", "Data Scientist: \u201cI don\u2019t know. That\u2019s your job, no?\u201d", "A slightly exaggerated conversion, but the message is clear: Data Science has to meet Engineering! This is where code refactoring comes in.", "Each model has to have serving code (code which will take production data, transform it appropriately, load a model file, and use it to make predictions). For us, a standard model serving template was created within which our serving code was placed. This serving code is then packaged as a module, containerised and deployed to a Dev environment. Part and parcel of this refactoring process was a requirement that unit tests have to be written for serving methods and all unit tests have to pass before your code can be merged into Master.", "My experience to date has shown that getting Data Scientists to write production-ready code is difficult, but not impossible. There is a fair amount of friction between Engineers and Data Scientists at this point but there are strategies on how to smoothen things out (I\u2019ll save that for another blog post as well).", "The output of this sprint was serving code and a model file deployed and running in Dev!", "The last two sprints in our 8 week production cycle involved the following:", "In our context, we had an extremely large dataset (> 200 000 000 rows). Experimenting on such a large dataset is not feasible and for this reason, we had baseline models (trained on smaller subsets of data) deployed to Dev. The purpose of doing this was to ensure that the code and models deployed to the Dev environment perform as expected when compared to the local environments.", "Several integration tests were run to ensure that every component in our Architecture was performing as expected in Dev.", "Once we were happy with the performance in Dev, we kicked off training on the complete dataset. The models from this final training were the models which were to be taken to production.", "BOOM! We were now ready for Production!", "There were numerous challenges which were encountered along the way to Production. Below is a summary of some of these challenges and the disciplines which we had to follow in order to meet our delivery target:", "As I mentioned at the beginning of this post, the satisfaction gained from experimentation is great! Equally as great, or at least for me, is the satisfaction gained from seeing your work running in real-time!", "Taking Machine Learning models to production is no easy feat! It\u2019s important to recognise that it is indeed a journey \u2014 a journey that takes patience, commitment, discipline, and resilience, but leads you to a destination can be extremely rewarding!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer | Techie | Young Leader. I write about the intersection of technology and human connection, and have a particular interest in Values-Based Leadership."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa970b5cfb88d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aditb.mehta?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aditb.mehta?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": "Adit Mehta"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6980e99c1e56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&user=Adit+Mehta&userId=6980e99c1e56&source=post_page-6980e99c1e56----a970b5cfb88d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa970b5cfb88d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa970b5cfb88d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/pandas-profiling/pandas-profiling", "anchor_text": "Pandas Profiling"}, {"url": "https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell", "anchor_text": "Master"}, {"url": "https://www.atlassian.com/software/jira?&aceid=&adposition=1t1&adgroup=63127837864&campaign=1439934854&creative=340023072955&device=c&keyword=jira&matchtype=e&network=g&placement=&ds_kids=p34164036290&ds_e=GOOGLE&ds_eid=700000001558501&ds_e1=GOOGLE&gclid=CjwKCAjwzdLrBRBiEiwAEHrAYoKr0ymRtBNy2MAk8Y2ylxZlmdLHVn8HhGAl6G2_gWolbQHlCe1FARoC4sAQAvD_BwE&gclsrc=aw.ds", "anchor_text": "JIRA"}, {"url": "https://bitbucket.org/product?&aceid=&adposition=1t1&adgroup=55499725436&campaign=1407243005&creative=377621228819&device=c&keyword=bitbucket&matchtype=e&network=g&placement=&ds_kids=p33208875779&ds_e=GOOGLE&ds_eid=700000001551985&ds_e1=GOOGLE&gclid=CjwKCAjwzdLrBRBiEiwAEHrAYhLoDHnKJ8dMWDXAk5IGNuS1eU-Frw4U5hV4S3KT--ThGZ5emkSUehoCBOEQAvD_BwE&gclsrc=aw.ds", "anchor_text": "Bitbucket"}, {"url": "https://www.atlassian.com/software/confluence?&aceid=&adposition=1t1&adgroup=56762752698&campaign=1398156602&creative=301831929106&device=c&keyword=confluence&matchtype=e&network=g&placement=&ds_kids=p32969589259&ds_e=GOOGLE&ds_eid=700000001542923&ds_e1=GOOGLE&gclid=CjwKCAjwzdLrBRBiEiwAEHrAYhHgfnMme1QmZjZq8bSKb-yo-i9yH7RjYEl1bnB9QHVx8e9W3wIkHRoCrSwQAvD_BwE&gclsrc=aw.ds", "anchor_text": "Confluence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a970b5cfb88d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a970b5cfb88d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a970b5cfb88d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/production?source=post_page-----a970b5cfb88d---------------production-----------------", "anchor_text": "Production"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----a970b5cfb88d---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa970b5cfb88d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&user=Adit+Mehta&userId=6980e99c1e56&source=-----a970b5cfb88d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa970b5cfb88d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&user=Adit+Mehta&userId=6980e99c1e56&source=-----a970b5cfb88d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa970b5cfb88d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa970b5cfb88d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a970b5cfb88d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a970b5cfb88d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aditb.mehta?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aditb.mehta?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adit Mehta"}, {"url": "https://medium.com/@aditb.mehta/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "73 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6980e99c1e56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&user=Adit+Mehta&userId=6980e99c1e56&source=post_page-6980e99c1e56--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5a0eb93554f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgetting-machine-learning-models-ready-for-production-a970b5cfb88d&newsletterV3=6980e99c1e56&newsletterV3Id=5a0eb93554f&user=Adit+Mehta&userId=6980e99c1e56&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}