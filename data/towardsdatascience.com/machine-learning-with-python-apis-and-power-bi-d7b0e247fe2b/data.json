{"url": "https://towardsdatascience.com/machine-learning-with-python-apis-and-power-bi-d7b0e247fe2b", "time": 1683017629.3246121, "path": "towardsdatascience.com/machine-learning-with-python-apis-and-power-bi-d7b0e247fe2b/", "webpage": {"metadata": {"title": "Machine Learning with Python APIs and Power BI | by Barrett Studdard | Towards Data Science", "h1": "Machine Learning with Python APIs and Power BI", "description": "Machine Learning can be used to make predictions and cluster like data. How can we integrate some basic Machine Learning capabilities with Power BI and have a backend that handles the logic and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.pythonanywhere.com/", "anchor_text": "PythonAnywhere", "paragraph_index": 3}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "Flask", "paragraph_index": 17}, {"url": "https://flask-restful.readthedocs.io/en/latest/", "anchor_text": "Flask-RESTful", "paragraph_index": 17}, {"url": "https://marshmallow.readthedocs.io/en/stable/", "anchor_text": "Marshmallow", "paragraph_index": 18}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Scikit-learn", "paragraph_index": 21}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "KMeans Clustering", "paragraph_index": 21}, {"url": "https://github.com/bstuddard/power-bi-examples/tree/master/custom-ai-api", "anchor_text": "Github", "paragraph_index": 35}], "all_paragraphs": ["Machine Learning can be used to make predictions and cluster like data. How can we integrate some basic Machine Learning capabilities with Power BI and have a backend that handles the logic and dependencies? This article provides a basic how-to, showing one way to deploy a Python Machine Learning API and connect via Power BI.", "For demonstration, I created a fictitious dataset containing housing data. With only a handful of features, a rough guess can be made on how they will be clustered. You can see the data below \u2014 a couple of the houses are smaller, a couple in the middle, and one large outlier.", "Given the breaks in this data, we can manually cluster by just looking at the records. However, on a large dataset this may not be possible and writing manual rules may be time-consuming. How can we use machine learning to automatically clustering our data into like groups? In this demo, we\u2019ll use the following approach:", "The first step is to create an account on PythonAnywhere. They have a free beginner tier, which is perfect for this demo, learning, and small personal projects.", "Click the create account button and you\u2019ll be prompted to enter a username, email, and password. Once you login, you\u2019ll see the header in the top right corner. We\u2019ll be using the Dashboard, Consoles, Files, and Web tabs.", "Setting Up a Python Virtual Environment", "The first thing we need to do after logging in is to set up a virtual environment with the relevant python packages. Click the Bash button on the PythonAnywhere Dashboard to open up a new console, and execute the following commands:", "2. Install required python packages using pip:", "Once this is complete, navigate back to the dashboard. The next step is to create a web app.", "Click the Web header at the top and then the Add a new web app option. Accept the default domain and choose a manual configuration with Python Version 3.7 (or matching what you chose in the previous step). There are a few additional options we want to change outlined in the next steps.", "The first modification is the WSGI configuration file under the Code heading. Click on the link (ends in .py) to open the file.", "This code gets called first when the server is loaded. The default code in this file is setup by PythonAnywhere and contains comments that give you an overview of some functionality. For this demo, delete out everything and replace with the following (change the username string to match your build):", "This code adds our project to the system path and then imports our app. Save this file and navigate back to the Web tab.", "The next step is to point our web app to the virtual environment we created. Click on the Enter path to a virtualenv link and type in your path (example below).", "Finally, we\u2019ll Force HTTPS for security purposes:", "That is it on the web tab for now, time to write some Python!", "This example is simple enough that we could reduce the logic to one or two files; however, in order to allow for easier integrations later, I will separate many of the imports and components. The overall project is structured as followed.", "Flask and Flask-RESTful are used as the web and API framework. A separate Python module will be purposed to just spin up the app and api to be used in later stages.", "Marshmallow is used to help validate and structure data for both incoming requests (made by Power BI) and outgoing responses back to Power BI after the clustering logic has ran.", "You\u2019ll see that the request_schemas.py file below has a RequestInput class (inherits Marshmallow\u2019s Schema) that matches the columns in our csv.", "The ClusterResultSchema class specifies the outputs that will be returned to Power BI after the clustering code has run \u2014 row to allow a join back to the original data and group to denote the cluster each house is in. The many=True option is used since inputs and outputs have multiple records.", "Scikit-learn and more specifically KMeans Clustering is used to cluster the data. The cluster_houses function below is responsible for clustering the data given an input dictionary containing the various records (houses).", "The bulk of the code is handling and parsing the the data, as well as sending back the response. The api_operations.py file below is responsible for tying all the pieces together and exposing the API endpoint. Using the HTTP Post method, Power BI submits data that will be parsed, classifications ran, and then results dumped to a json string in the response.", "Finally, a simple high level module is used as an entry point for PythonAnywhere. It simply imports the Flask and API objects to keep the file light and cleanly structured. This allows for easier enhancements, additional features or endpoints, etc that can be incorporated easily.", "If you recall earlier when setting up the WSGI file, the app object from SimpleRecommendation was imported in that code \u2014 this is the file it is referencing.", "And that is it for the python code. The next step will be uploading these files and testing out the app.", "Time to upload our .py files to PythonAnywhere. If you click on the Files header, you\u2019ll see existing system and default files. Create a new directory named pbi_demo (note this was used in our earlier config file) and then upload the files with the same folder structure/nesting. SimpleRecommendation.py will be at the top level of this new directory, with the other files in new subdirectories.", "Once all the files have been uploaded, click the Web tab and then the Reload button to reload the web app server.", "Processing the data, sending results, and retrieving clusters can all be done in PowerQuery. At a high level, the below code does the following:", "You can see the results below after the last step of the PowerQuery code has completed.", "Our API returned a group number (starting with 0) for each record. The actual number doesn\u2019t signify anything, but those houses with the same number are clustered together \u2014 displaying similar characteristics as determined by KMeans. With this small dataset, it did pretty well. The two smallest and cheapest houses were grouped together (Cluster #2), the next two largest grouped together (Cluster #0), and the largest outlier we manually spotted is clustered by itself (Cluster #1)!", "So what are the benefits with an API-driven approach? We could\u2019ve run this python program locally and just added the results to our csv file; however, separating out our Machine Learning logic into a separate API has some additional benefits:", "This demo shows an example of end-to-end machine learning from initial dataset through pulling results into a BI tool. However, this doesn\u2019t mean you should take exactly this approach. There are a few things worth calling out that may slightly change how you implement something like this in practice:", "I hope this walkthrough was helpful and gets you thinking of ways to integrate Machine Learning and AI with Power BI in a way that is repeatable and automated.", "Interested in your thoughts, if you found this approach helpful or have used different approaches in the past to solve similar issues \u2014 comment below!", "All examples and files available on Github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd7b0e247fe2b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://barrettstuddard.medium.com/?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": ""}, {"url": "https://barrettstuddard.medium.com/?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": "Barrett Studdard"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4f34db0b270c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&user=Barrett+Studdard&userId=4f34db0b270c&source=post_page-4f34db0b270c----d7b0e247fe2b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7b0e247fe2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7b0e247fe2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pythonanywhere.com/", "anchor_text": "PythonAnywhere"}, {"url": "https://www.pythonanywhere.com/", "anchor_text": "PythonAnywhere"}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "Flask"}, {"url": "https://flask-restful.readthedocs.io/en/latest/", "anchor_text": "Flask-RESTful"}, {"url": "https://marshmallow.readthedocs.io/en/stable/", "anchor_text": "Marshmallow"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "Scikit-learn"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "KMeans Clustering"}, {"url": "https://azure.microsoft.com/en-us/services/machine-learning/", "anchor_text": "Azure Machine Learning"}, {"url": "https://docs.microsoft.com/en-us/power-bi/transform-model/dataflows/dataflows-machine-learning-integration", "anchor_text": "AI capabilities"}, {"url": "https://github.com/bstuddard/power-bi-examples/tree/master/custom-ai-api", "anchor_text": "Github"}, {"url": "https://datastud.dev/posts/python-pbi-ml", "anchor_text": "https://datastud.dev"}, {"url": "https://medium.com/tag/power-bi?source=post_page-----d7b0e247fe2b---------------power_bi-----------------", "anchor_text": "Power Bi"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d7b0e247fe2b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d7b0e247fe2b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/api?source=post_page-----d7b0e247fe2b---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7b0e247fe2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&user=Barrett+Studdard&userId=4f34db0b270c&source=-----d7b0e247fe2b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7b0e247fe2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&user=Barrett+Studdard&userId=4f34db0b270c&source=-----d7b0e247fe2b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7b0e247fe2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd7b0e247fe2b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d7b0e247fe2b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d7b0e247fe2b--------------------------------", "anchor_text": ""}, {"url": "https://barrettstuddard.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://barrettstuddard.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Barrett Studdard"}, {"url": "https://barrettstuddard.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "164 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4f34db0b270c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&user=Barrett+Studdard&userId=4f34db0b270c&source=post_page-4f34db0b270c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb16510f76a53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-with-python-apis-and-power-bi-d7b0e247fe2b&newsletterV3=4f34db0b270c&newsletterV3Id=b16510f76a53&user=Barrett+Studdard&userId=4f34db0b270c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}