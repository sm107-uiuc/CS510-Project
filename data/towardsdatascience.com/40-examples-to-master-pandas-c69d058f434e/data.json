{"url": "https://towardsdatascience.com/40-examples-to-master-pandas-c69d058f434e", "time": 1683017964.883429, "path": "towardsdatascience.com/40-examples-to-master-pandas-c69d058f434e/", "webpage": {"metadata": {"title": "40 Examples to Master Pandas. A comprehensive practical guide | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "40 Examples to Master Pandas", "description": "Pandas is one of the most widely-used data analysis and manipulation libraries. It provides numerous functions and methods to clean, process, manipulate, and analyze data. The best way to get\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/30-examples-to-master-pandas-f8a2da751fa4", "anchor_text": "30 examples", "paragraph_index": 1}, {"url": "https://www.kaggle.com/yoghurtpatil/direct-marketing", "anchor_text": "marketing", "paragraph_index": 4}, {"url": "https://www.kaggle.com/heeraldedhia/groceries-dataset", "anchor_text": "grocery", "paragraph_index": 4}, {"url": "https://github.com/chris1610/sidetable", "anchor_text": "Sidetable", "paragraph_index": 79}, {"url": "https://towardsdatascience.com/pandas-sidetable-a-smarter-way-of-using-pandas-96fa7c61e514", "anchor_text": "article", "paragraph_index": 82}, {"url": "https://towardsdatascience.com/30-examples-to-master-pandas-f8a2da751fa4", "anchor_text": "previous", "paragraph_index": 99}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 103}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 103}], "all_paragraphs": ["Pandas is one of the most widely-used data analysis and manipulation libraries. It provides numerous functions and methods to clean, process, manipulate, and analyze data.", "The best way to get comfortable working with Pandas is through practice. I previously wrote a practical guide that contains 30 examples.", "In this article, I will enrich the examples to cover a broader scope together with the previous article. 40 examples in this article will include not only the basic functions and techniques but also some extreme cases.", "Most of the examples include the functions and methods that were not discussed in the previous article. The few examples that cover the same functions are the ones that I want to emphasize and explain again with a different example.", "We will be using a marketing and a grocery data set to do the examples. The first example is reading the csv files into Pandas dataframes.", "The read_csv function provides flexible ways for reading csv files into Pandas dataframes.", "The dates need to be stored in the datetime data type in order to use the datetime functions of Pandas. Let\u2019s check the data type of the columns of the groceries dataframe.", "As you can see, the data type of the date column is object. We can change it using the astype function.", "We can also use the to_datetime function to assign appropriate data types for dates. The syntax is a little different than the astype function.", "In the first examples, I mentioned that the read_csv function is quite flexible at reading the csv files. It can also handle the dates. We can assign appropriate data types for dates while reading the data. It will save us from having to change the data type later on.", "There are many ways to filter a dataframe based on the values. We can use logical operators such as equal (==), not equal (!=), or greater than (>).", "The isin method allows to filter based on a specific set of values. We can just pass a list of the values we want to filter.", "There are 126 entries that belong to the customers whose member number is given in the list.", "The tilde (~) operator can be used as \u201cnot\u201d while applying filters. For instance, we can find the complement of the filtered rows in the previous example by just adding the tilde operator at the beginning.", "The value_counts is one of most frequently used functions. It counts the number of occurrences of each value and returns a series. If it is used with the normalize parameter, we get an overview of the percentage of the occurrences.", "The most frequent value in the catalogs column is 12 which occupies about 28 percent of the entire column.", "Pandas assigns integer index to dataframes by default but we can change it to any column using the set_index function.", "For instance, we can set the date column as the index of the groceries dataframe.", "When some rows are dropped, Pandas does not automatically reset the index. Similarly, when two dataframes are concatenated, the indices will not be reset. In such cases, the new dataframes will not have consecutive index values.", "We can use the reset_index function in those cases. I have dropped some rows of the groceries dataframe:", "As you can see, some indices are skipped. We can now use the reset_index function.", "The order of values are the same but the index is reset. The drop parameter is important. If we do not set it as True, the old index will be kept as a new column in the dataframe. The inplace parameter ensures the changes are saved.", "The unique function returns an array of the unique values in a column.", "I have only displayed the first 5 elements for demonstration purposes.", "If we are only interested in the number of unique values, we can use the nunique function. It can be called on the entire dataframe or a particular column.", "There are other ways to count the number of unique values in a column. For instance, the length of the array returned by the unique function gives us the number of unique values.", "The sample function can be used to create a random sample of the rows of a dataframe. It comes in handy when working with unbalanced datasets in machine learning.", "We can only create samples that are smaller than the original one unless the replace parameter is changed to true. The replace parameter allows for using the same row more than once.", "Let us create a random sample of the groceries dataframe by only using the rows with a spent amount of less than 300.", "We can concatenate dataframes horizontally or vertically with the concat function. The axis parameter is used to determine the axis through which the concatenation occurs.", "We can concatenate the marketing and sample dataframes we created in the previous examples.", "The default values of the axis parameter is 0 which means concatenating along index. The dataframes must have the same number of columns.", "We can select a range of rows and columns by using the iloc function. It accepts the indices of the desired rows and columns. The pandas dataframes have integer index for both rows and columns.", "For instance, we can select the first 4 rows and the first 3 columns as follows:", "The iloc function also accepts an array of values instead of ranges. We can pass a list or numpy array.", "We have created a numpy array of 7 random integers between 0 and 100. We have passed this array to the iloc function along with a list of 3 columns to be selected.", "The loc function is just like the iloc function but it accepts labels instead of indices.", "I have replicated the selection in the previous example to point out the difference between the loc and iloc functions. You may have noticed that the same array is used for the row part. The reason is that the labels and indices of the rows are the same unless we assign different labels for rows.", "Pandas provides lots of functions to operate on the dates. They are used through the dt accessor.", "We can easily extract the year and month from dates as follows:", "In the previous example, we created two new columns. By default, pandas add the new columns at the end of a dataframe but we can change it.", "We will add the new columns at a specific position in the next example. However, we first need to drop them which can be done by using the drop function.", "We pass the list of columns or rows to be dropped. The axis parameter needs to be 1 to drop columns and 0 to drop rows.", "The year and month columns might look better if they are placed before the date column. We can use the insert function to accomplish this task.", "In the previous example, we created a month column that contains numbers to represent months. You may want this column to contain the names of months (i.e. January, February, and so on).", "There are multiple ways to do this operation. I will first show you the harder way. In the next example, we will see a much simpler method.", "We can use the replace function to replace integers with strings of month names.", "We have created a dictionary that indicates the replacements and then passed it to the replace function.", "There is much simpler way of doing the task in the previous step. We will make a function of the dt accessor.", "We can directly retrieve the month name from the date column. It is important to note that the functions of dt accessor can only be used with datetime like values.", "The cumsum function allows to create a column based on the cumulative sum of another column. Consider the marketing dataframe. We can create a column that contains the cumulative sum of the spent amount.", "In the previous example, we have mentioned the dt accessor which makes it very easy and simple to deal with dates. Similarly, the str accessor provides many functions and methods that expedite to process textual data.", "For instance, we can check if strings contain a specific set of characters. A typical use case would be to count the number of rows that contains the word \u201cmilk\u201d in the description column of the groceries table.", "The contains function returns true if a value contains the given string. By applying the sum function (1 for each true value), we calculate the total number of rows that contains the word \u201cmilk\u201d.", "We can also filter string based on the length (i.e. number of characters). Let us find the items with long descriptions.", "The filtering is on the item description column and the descriptions that are longer than 20 characters are selected.", "Pandas is not a data visualization library so it is not optimized for visualization tasks. However, it provides plotting functions which I think make it highly convenient to produce basic plots.", "For instance, we can create a kde plot to see the distribution of the salary column.", "Histograms are also commonly used to check the distribution of a numerical feature. We can use the plot function to produce histograms as well.", "In this example, we will combine a few operations to create a plot that shows the trend in monthly sales. The first step is to create a month column as we did previously.", "We will calculate the number of items sold in each month by using the group by function and then plot the values.", "You may have noticed that we did not use the kind parameter of the plot function. The reason is that the default value of kind parameter produces a line plot which is what we need in our case.", "It is possible to apply different aggregate functions to different columns in the group by function. We can pass a dictionary to indicate which functions will be applied to which columns.", "We have calculated the average salary and total spent amount by each group in the married column. However, it would be better if we also somehow indicate which functions are applied to each column.", "The solution is the NamedAgg method.", "We will do the same operation as in the previous example but only change the column names in the result.", "The cross tab function is used to create a cross table based on specified columns, values, and aggregate functions. It is similar to a pivot table.", "For instance, we can calculate the average salary of cross categories between the age and gender columns.", "The middle aged males have the highest average salary.", "We will do a slightly more complex example with the crosstab function. We can pass multiple columns and also display the overall values.", "This cross table is more informative than the previous one as it includes more specific categories and overall average values.", "It is extremely similar to the crosstable function with a few small differences in the syntax. I will create the same table as in the previous example using the pivot_table function.", "We can pass the dataframe to the data parameter and use the column names as strings.", "The string accessor can be used to split or combine strings. For instance, we can split the parts of the date in the groceries dataframe to obtain day, month, and year values.", "Please note that the data type should be object or string to be able apply str accessor.", "Note: If you have the date column stored with datetime64[ns] data type, convert it back to \u201cstring\u201d data type in order to apply the following splitting operation. Converting back to \u201cobject\u201d will not allow to use str accessor for some reason. However, if you have it stored as \u201cobject\u201d or \u201cstring\u201d at the first place, you can apply the str accessor.", "We have splitted the date colum at \u201c-\u201d characted. The expand parameter is set as true to create a different column for each part. We have selected the second column ([1]) which is the month.", "We can select part of strings based on the position of characters. Consider the previous example. We may want to retrieve the last two characters of the years (e.g. 15 instead of 2015).", "The str accessor allows indexing on strings.", "Sidetable is an add-on for Pandas which makes it easier to create summaries of dataframes. It can be considered as a combination of value counts and cross tab functions.", "Once installed, it can be used as other accessors such as str and dt.", "Freq function returns a dataframe that conveys 3 pieces of information.", "Sidetable offers more functionality. I wrote a detailed article about sidetable if you\u2019d like to read further.", "Missing values need to be handled very carefully in order to make accurate and robust analysis.", "The isna function can be used the find the missing values in a dataframe. It returns true if the value is missing. Thus, we can count the total number of missing values by applying the sum function.", "We do not have any missing values in the groceries dataframe.", "The fillna function can be used to handle missing values. It provides many options to fill missing values such as mean, median, or a constant value.", "We can also use the previous or next value to fill a missing value.", "Let us first change a few values as missing value in the groceries dataframe.", "We can use the most frequent item to fill missing values in the item description column. For the date column, we will use the previous value to replace a missing value.", "The select_dtypes function can be used select columns that belong or does not belong to a particular data type.", "We can include or exclude certain data types.", "The DataFrame function can be used to create a dataframe. A dictionary can be passed to the DataFrame function. The keys will be the column names and the values will represent the row values.", "Let\u2019s create a dataframe that contains the prices of the items in the groceries dataframe.", "We assign the prices randomly by creating a numpy array of random integers between 0 and 10.", "The merge function can be used to merge two dataframes based on a shared column or columns. For instance, we can merge the groceries and price dataframes based on the item description column.", "When working on a machine learning task, the correlations between numerical variables need to be taken into consideration.", "The corr function calculates the correlations and returns a matrix that contains correlation coefficients between variables.", "As we can see, the salary and spent amount is highly correlated.", "In this article and the previous one, we have covered a great deal of the functions and methods of Pandas.", "As you keep using pandas for your data analysis tasks, you may discover new functions and methods. As with any other subject, practice makes perfect.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc69d058f434e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c69d058f434e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c69d058f434e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----c69d058f434e--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----c69d058f434e--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----c69d058f434e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc69d058f434e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc69d058f434e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@hengfilms?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Heng Films"}, {"url": "https://unsplash.com/@hengfilms?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/30-examples-to-master-pandas-f8a2da751fa4", "anchor_text": "30 examples"}, {"url": "https://www.kaggle.com/yoghurtpatil/direct-marketing", "anchor_text": "marketing"}, {"url": "https://www.kaggle.com/heeraldedhia/groceries-dataset", "anchor_text": "grocery"}, {"url": "https://github.com/chris1610/sidetable", "anchor_text": "Sidetable"}, {"url": "https://towardsdatascience.com/pandas-sidetable-a-smarter-way-of-using-pandas-96fa7c61e514", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/30-examples-to-master-pandas-f8a2da751fa4", "anchor_text": "previous"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c69d058f434e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c69d058f434e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c69d058f434e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----c69d058f434e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----c69d058f434e---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc69d058f434e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----c69d058f434e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc69d058f434e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----c69d058f434e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc69d058f434e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c69d058f434e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc69d058f434e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c69d058f434e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c69d058f434e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c69d058f434e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c69d058f434e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c69d058f434e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c69d058f434e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c69d058f434e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c69d058f434e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c69d058f434e--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F40-examples-to-master-pandas-c69d058f434e&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}