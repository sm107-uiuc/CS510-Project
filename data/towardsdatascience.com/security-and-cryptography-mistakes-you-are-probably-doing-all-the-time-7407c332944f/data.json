{"url": "https://towardsdatascience.com/security-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f", "time": 1683002022.7782688, "path": "towardsdatascience.com/security-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f/", "webpage": {"metadata": {"title": "Security and Cryptography Mistakes You Are Probably Doing All The Time | by Martin Heinz | Towards Data Science", "h1": "Security and Cryptography Mistakes You Are Probably Doing All The Time", "description": "There are a lot of myths and wrong assumptions about cryptography and security in general. It\u2019s common for people to misuse cryptographic primitives, assume that something is secure by default or use\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.2uo.de/myths-about-urandom", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.daemonology.net/blog/2009-06-24-encrypt-then-mac.html", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://xkcd.com/936/", "anchor_text": "xkcd Password Strength comic", "paragraph_index": 12}, {"url": "https://martinheinz.dev/blog/12", "anchor_text": "martinheinz.dev", "paragraph_index": 24}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 25}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 25}, {"url": "https://martinheinz.dev/", "anchor_text": "https://martinheinz.dev/", "paragraph_index": 27}, {"url": "https://ko-fi.com/martinheinz", "anchor_text": "https://ko-fi.com/martinheinz", "paragraph_index": 27}], "all_paragraphs": ["There are a lot of myths and wrong assumptions about cryptography and security in general. It\u2019s common for people to misuse cryptographic primitives, assume that something is secure by default or use outdated technology/algorithms. So, let\u2019s look at some of those myths and common mistakes so that you can avoid them in the future.", "Pretty much anybody would say that you should always use /dev/random for cryptographic purposes. Well, that's wrong. Both /dev/urandom and /dev/random are using the exact same CSPRNG. The difference between them is, that /dev/random blocks until it has enough entropy. Which is another issue - you don't want your applications to wait for entropy and design logic around possibility of /dev/random blocking, especially considering that you don't need that much entropy... All you need is about 256 bits of entropy, which you will get from /dev/urandom. If you want to delve deeper into this topic, then see article here.", "As you surely know AES is a block cipher. It encrypts plain text in blocks of 128 bits. Alright, sounds good, so what is the problem with using ECB (Electronic Code Book) mode? It uses an unaltered key on every block, so if you encrypt more than 128 bits of data, your ciphertext will look something like this:", "That\u2019s not much of an encryption, right? So, what should you use instead of ECB? Counter mode (CTR)! Why? Because encryption can be done in parallel and it uses IV (nonce) to get rid of the unaltered key problem, that ECB mode has. Just remember to never reuse the IV.", "This is how the cipher text would look with CTR mode:", "You can try it yourself with openssl:", "While we are on the topic of never using stuff\u2026 Forget about MD5, like, right now. It was designed for use as a secure cryptographic hash algorithm, but there is nothing secure about it at this point. It has collision vulnerability, where you can create a pair of files that have the same MD5 hash, meaning that you can fake an SSL or CA certificate. So, what should you use instead? It depends on the use case \u2014 for password hashing use bcrypt or scrypt. Which one of those you use, is in my opinion personal preference - scrypt was designed to be \"better\" than bcrypt but it's newer so it faced less scrutiny. I - personally - still use bcrypt. As for the other use cases, use hash function from SHA-2 family, preferably longer digests like SHA-512.", "The title of this section says \u201cEncrypt-then-MAC\u201d, but let\u2019s backtrack a little bit first. A lot of people don\u2019t realize that they should always use encryption in conjunction with message authentication. I don\u2019t want to go into too much detail about why you should actually authenticate messages, all I\u2019m gonna say is that if you don\u2019t authenticate messages, then you are opening your applications to quite a few possible attacks, like replay attack or active attack.", "With that out of the way, why encrypt-then-MAC? Simply put, it\u2019s the only way to get provable security, which isn\u2019t always necessary, but it means that it\u2019s essentially impossible to mess up cryptographically when using this construction.", "If you want a more in-depth explanation, then I recommend the article here by Colin Percival.", "Not necessarily, at least. A good password is one that you can remember, so throwing in characters like !@#$%^&* will make it more likely that you or users of your application will either forget it or write it down somewhere where someone else can see it.", "What is the reason to add special characters to password in the first place? It\u2019s entropy, so if we don\u2019t want to force users to include special characters in their passwords, then what is the alternative to keep the entropy high enough?", "Make it loooong. As shown in popular xkcd Password Strength comic, it makes more sense to use password made by concatenating a few random words, than trying to remember some gibberish. Creating these kinds of passwords satisfies both human and computer aspect of it, in other words, it\u2019s easy to remember and reasonably hard to guess (high entropy, no way to brute force it).", "Note: In an ideal world, everybody would use a password manager and generate their random super high entropy passwords, but that\u2019s not something we can expect of the average, non-tech savvy user.", "Somebody probably already told you, that you should rotate your keys at some time interval and that\u2019s right, you absolutely should do that. A lot of people, though, think that they should do it to decrease the probability of key being broken, which is not the case for encryption keys. You should rotate encryption keys to reduce the amount of data encrypted by the key, to lower the potential damage caused by a single key being compromised. This misconception doesn\u2019t change the fact that you should rotate keys, but it\u2019s important to know why you are doing it so that you can correctly assess what intervals should be used.", "Back to the \u201cnever do stuff\u201d topic once more. This one is a little bit of a rant, I\u2019ve seen so many times, that a website sent me a password by email after I registered\u2026 like\u2026 first thing you should do when you get a password from a user is to hash it and throw away the clear text version of the password and if you are sending it to me by email, then you are clearly not doing that (end of rant)!", "So, let\u2019s take a deep breath\u2026 how to store those passwords then?", "As soon as you receive the password from user \u2014 hash it with slow hash function like bcrypt using work factor of at least 12 and erase the clear text password from memory. The work factor of 12 is valid now, at the time of posting and will not be enough a year from now. I would personally shoot for up to 400ms for validation of password, you can check on your machine which work factor would give you.", "If you\u2019re not gonna use bcrypt make sure to add salt to password to prevent precomputation attacks like rainbow table attack.", "A lot of people think that Docker containers are secure by default, but that\u2019s not the case. They were built to solve deployment problems, not security ones.", "There are even vulnerabilities that would allow an attacker to get root access to the host system and all that is needed is shell access to the container. So, how to avoid these security problems and vulnerabilities?", "There are many more things that you could do to secure your images, which you can google later, but I think the list above is the bare minimum that everybody should have in mind when using Docker images/containers.", "Every software developer/DevOps engineer is responsible for the security of applications and system, at least to some extent (whether you like it or not). Therefore, I believe that all of us should take a little bit of time to do the necessary research to make sure to avoid stupid mistakes and misconceptions like the ones above.", "Don\u2019t just trust what people tell you (people make mistakes all the time). When it comes to security and cryptography look things up and check it yourself \u2014 make decisions based on facts.", "Note: This was originally posted at martinheinz.dev", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "CKA | RHCE | DevOps Engineer at IBM | Working with Python, Kubernetes, Linux and more | https://martinheinz.dev/ | https://ko-fi.com/martinheinz"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7407c332944f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7407c332944f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7407c332944f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@martin.heinz?source=post_page-----7407c332944f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@martin.heinz?source=post_page-----7407c332944f--------------------------------", "anchor_text": "Martin Heinz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4cbd6b36e62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&user=Martin+Heinz&userId=4cbd6b36e62a&source=post_page-4cbd6b36e62a----7407c332944f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7407c332944f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7407c332944f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.2uo.de/myths-about-urandom", "anchor_text": "here"}, {"url": "https://www.daemonology.net/blog/2009-06-24-encrypt-then-mac.html", "anchor_text": "here"}, {"url": "https://xkcd.com/936/", "anchor_text": "xkcd Password Strength comic"}, {"url": "https://martinheinz.dev/blog/12", "anchor_text": "martinheinz.dev"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/security?source=post_page-----7407c332944f---------------security-----------------", "anchor_text": "Security"}, {"url": "https://medium.com/tag/programming?source=post_page-----7407c332944f---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/software-engineering?source=post_page-----7407c332944f---------------software_engineering-----------------", "anchor_text": "Software Engineering"}, {"url": "https://medium.com/tag/cybersecurity?source=post_page-----7407c332944f---------------cybersecurity-----------------", "anchor_text": "Cybersecurity"}, {"url": "https://medium.com/tag/technology?source=post_page-----7407c332944f---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7407c332944f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&user=Martin+Heinz&userId=4cbd6b36e62a&source=-----7407c332944f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7407c332944f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&user=Martin+Heinz&userId=4cbd6b36e62a&source=-----7407c332944f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7407c332944f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7407c332944f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7407c332944f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7407c332944f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7407c332944f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7407c332944f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7407c332944f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7407c332944f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7407c332944f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7407c332944f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7407c332944f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7407c332944f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@martin.heinz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@martin.heinz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Martin Heinz"}, {"url": "https://medium.com/@martin.heinz/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.4K Followers"}, {"url": "https://martinheinz.dev/", "anchor_text": "https://martinheinz.dev/"}, {"url": "https://ko-fi.com/martinheinz", "anchor_text": "https://ko-fi.com/martinheinz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4cbd6b36e62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&user=Martin+Heinz&userId=4cbd6b36e62a&source=post_page-4cbd6b36e62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff723091181e3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsecurity-and-cryptography-mistakes-you-are-probably-doing-all-the-time-7407c332944f&newsletterV3=4cbd6b36e62a&newsletterV3Id=f723091181e3&user=Martin+Heinz&userId=4cbd6b36e62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}