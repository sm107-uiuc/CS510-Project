{"url": "https://towardsdatascience.com/google-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e", "time": 1682996139.6947799, "path": "towardsdatascience.com/google-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e/", "webpage": {"metadata": {"title": "Google Cloud AutoML Vision for Medical Image Classification | by Ekaba Bisong | Towards Data Science", "h1": "Google Cloud AutoML Vision for Medical Image Classification", "description": "Google Cloud AutoML Vision simplifies the creation of custom vision models for image recognition use-cases. The concepts of neural architecture search and transfer learning are used under the hood to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia", "anchor_text": "Chest X-Ray Images (Pneumonia)", "paragraph_index": 1}, {"url": "https://github.com/dvdbisong/automl-medical-image-classification", "anchor_text": "https://github.com/dvdbisong/automl-medical-image-classification", "paragraph_index": 17}, {"url": "https://amzn.to/2Hz1n5B", "anchor_text": "\u201cBuilding Machine Learning and Deep Learning Models on Google Cloud Platform\u201d", "paragraph_index": 30}], "all_paragraphs": ["Google Cloud AutoML Vision simplifies the creation of custom vision models for image recognition use-cases. The concepts of neural architecture search and transfer learning are used under the hood to find the best network architecture and the optimal hyperparameter configuration that minimizes the loss function of the model. This article uses Google Cloud AutoML Vision to develop an end-to-end medical image classification model for Pneumonia Detection using Chest X-Ray Images.", "The dataset is hosted on Kaggle and can be accessed at Chest X-Ray Images (Pneumonia).", "(2). Open Cloud AutoML Vision by clicking the triple-dash at the top-left corner of the GCP dashboard. Select Vision under the product section for Artificial Intelligence.", "(3). Select Image Classification under AutoML Vision.", "(4). Setup Project APIs, permissions and Cloud Storage bucket to store the image files for modeling and other assets.", "(5). Select your GCP billing project from the drop-down when asked. Now we are ready to create a Dataset for building the custom classification model on AutoML. We will return here after downloading the raw dataset from Kaggle to Cloud Storage and preparing the data for modeling with AutoML.", "In this case, the automatically created bucket is called: gs://ekabasandbox-vcm.", "(1). Activate the Cloud shell (in red circle) to launch the ephemeral VM instance to stage the dataset download from Kaggle, unzip it and upload to the storage bucket.", "(2). Install the Kaggle command-line interface. This tool will allow us to download datasets from Kaggle. Run the following code:", "Note, however, that the Cloud Shell instance is ephemeral and does not persist system-wide changes when the session ends. Also, if a dataset is particularly large, other options exist such as spinning-up a compute VM, downloading the dataset, unzip it and then upload to Cloud Storage. It is possible to design other advanced data pipelines to get data into GCP for analytics/ machine learning.", "(3). Download Kaggle API token key that will enable the Kaggle CLI to authenticate/ authorize against Kaggle to download the desired datasets.", "(4). Download dataset from Kaggle to Google Cloud Storage.", "(6). Move the dataset from the ephemeral cloud shell instance to the created cloud storage bucket. Insert your bucket name here.", "(1). Launch Jupyter Notebooks on the Google Cloud AI Platform.", "(2). Create a new Notebook Instance.", "(3). Select an instance name and create.", "(5). Before building a custom image recognition model with AutoML Cloud Vision, the dataset must be prepared in a particular format:", "(6). Clone the preprocessing script from Github. Click on the icon, circled in red and labeled (1) and enter the Github URL https://github.com/dvdbisong/automl-medical-image-classification to clone the repo with the preprocessing code.", "(7). Run all the cells in the notebook preprocessing.ipynb to create the CSV file containing the path and labels of the images and upload this file to Cloud Storage. Be sure to change the parameter for the bucket_name.", "(1). Click on \u201cNew Dataset\u201d from the AutoML Vision Dashboard.", "(2). Fill-in the dataset name and select the CSV file from the Cloud Storage bucket created by AutoML.", "(3). For now, you may dismiss if you see the error message that duplicated files are located. To the best of my knowledge, this is not the case as per the file names.", "(4). Click on Train as shown in red in the image above to initiate model building with Cloud AutoML.", "(5). Select how the model will be hosted, and the training budget.", "(6). After model training is complete, click on Evaluate to view the performance metric of the model.", "(7). Assess the performance metric (precision, recall and confusion matrix).", "(1). Click on the Predict tab to test the model.", "(2). Here\u2019s an example of a test. The image is a chest x-ray scan that was not used to train the model. The medical experts reading this can verify the accuracy of the model prediction.", "The custom image recognition model is also exposed as a REST or Python API for integration into software applications as a prediction service for inference.", "The article provided a walkthrough to design powerful vision models for custom use-cases by leveraging Google Cloud Platform AutoML Vision. Moreso, the model is hosted on the cloud for inference as a prediction service. This is a powerful mechanism to quickly prototype and build image classification or object detection use-cases before deciding whether to go ahead with more fine-grained and or hand-tuned modeling efforts. With this, I trust it will serve as a template for applying to the vision problems that you care about. Also, be sure to delete your models and datasets when it is no longer needed, this will save cloud costs.", "Excerpts of this article are taken from the book \u201cBuilding Machine Learning and Deep Learning Models on Google Cloud Platform\u201d published by Apress (Springer Nature).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI Researcher, Google Developer Expert in Machine Learning and author of book \u201cBuilding Machine Learning and Deep Learning Models on Google Cloud Platform\u201d"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F76dfbf12a77e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dvdbisong?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvdbisong?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": "Ekaba Bisong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe523d9921f29&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&user=Ekaba+Bisong&userId=e523d9921f29&source=post_page-e523d9921f29----76dfbf12a77e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76dfbf12a77e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76dfbf12a77e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.cell.com/cell/fulltext/S0092-8674(18)30154-5", "anchor_text": "https://www.cell.com/cell/fulltext/S0092-8674(18)30154-5"}, {"url": "https://medium.com/p/76dfbf12a77e#fdf2", "anchor_text": "Pneumonia Detection using Chest X-Ray Images"}, {"url": "https://medium.com/p/76dfbf12a77e#f2b1", "anchor_text": "About the Dataset"}, {"url": "https://medium.com/p/76dfbf12a77e#0ba2", "anchor_text": "Part 1: Enable AutoML Cloud Vision on GCP"}, {"url": "https://medium.com/p/76dfbf12a77e#b4bd", "anchor_text": "Part 2: Download the Dataset to Google Cloud Storage"}, {"url": "https://medium.com/p/76dfbf12a77e#cefd", "anchor_text": "Part 3: Preparing the Dataset for Modeling"}, {"url": "https://medium.com/p/76dfbf12a77e#5fd4", "anchor_text": "Part 4: Modeling with Cloud AutoML Vision"}, {"url": "https://medium.com/p/76dfbf12a77e#c62e", "anchor_text": "Part 5: Testing the Model"}, {"url": "https://medium.com/p/76dfbf12a77e#e3a3", "anchor_text": "Part 6: Conclusion"}, {"url": "https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia", "anchor_text": "Chest X-Ray Images (Pneumonia)"}, {"url": "https://cloud.google.com/", "anchor_text": "https://cloud.google.com/"}, {"url": "https://github.com/dvdbisong/automl-medical-image-classification", "anchor_text": "https://github.com/dvdbisong/automl-medical-image-classification"}, {"url": "https://amzn.to/2Hz1n5B", "anchor_text": "\u201cBuilding Machine Learning and Deep Learning Models on Google Cloud Platform\u201d"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----76dfbf12a77e---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----76dfbf12a77e---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----76dfbf12a77e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/software-development?source=post_page-----76dfbf12a77e---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----76dfbf12a77e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F76dfbf12a77e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&user=Ekaba+Bisong&userId=e523d9921f29&source=-----76dfbf12a77e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F76dfbf12a77e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&user=Ekaba+Bisong&userId=e523d9921f29&source=-----76dfbf12a77e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76dfbf12a77e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F76dfbf12a77e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----76dfbf12a77e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----76dfbf12a77e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvdbisong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvdbisong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ekaba Bisong"}, {"url": "https://medium.com/@dvdbisong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "271 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe523d9921f29&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&user=Ekaba+Bisong&userId=e523d9921f29&source=post_page-e523d9921f29--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa2bd8714c81a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e&newsletterV3=e523d9921f29&newsletterV3Id=a2bd8714c81a&user=Ekaba+Bisong&userId=e523d9921f29&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}