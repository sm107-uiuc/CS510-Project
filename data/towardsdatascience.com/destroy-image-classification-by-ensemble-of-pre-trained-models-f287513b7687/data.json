{"url": "https://towardsdatascience.com/destroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687", "time": 1683007292.402418, "path": "towardsdatascience.com/destroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687/", "webpage": {"metadata": {"title": "Destroy Image Classification by Ensemble of Pre-trained models | by Vardan Agarwal | Towards Data Science", "h1": "Destroy Image Classification by Ensemble of Pre-trained models", "description": "Annihilate image classification tasks by making an integrated stacking ensemble model of pre-trained networks like InceptionV3, Xception, etc. in Tensorflow"}, "outgoing_paragraph_urls": [{"url": "https://machinelearningmastery.com/stacking-ensemble-for-deep-learning-neural-networks/", "anchor_text": "article", "paragraph_index": 18}], "all_paragraphs": ["Pre-trained networks are pretty cool. They provide great accuracies and don\u2019t take a lot of time to train. So what can be better than a pre-trained network? Using two of those. Even better use three of those. Or a matter of fact, use how many you want together as an ensemble model and destroy image classification tasks.", "If you want to code along you will require Tensorflow and OpenCV. You can also use Google Colab like me where all the required packages for our task will be pre-installed and it also offers free GPU.", "The dataset chosen to be annihilated is the classic cats vs dogs one. As it is a small dataset we\u2019ll load it completely in the memory so that it trains faster.", "The paths of all the training and validation (in this case testing) images are stored in total_train and total_val. We will use OpenCV to read the images and store them in NumPy array having dimensions (no of images x image shape x channels). Their corresponding labels will also be stored in a one dimensional NumPy array.", "Our first task would be to create all the individual models. I will be creating three different models using MobileNetV2, InceptionV3, and Xception. Creating a model using a pre-trained network is very easy in Tensorflow. We need to load the weights, decide whether to freeze or unfreeze the loaded weights, and finally add Dense layers to make the output how we want. The basic structure I will be using for my models:", "After creating our models we need to fit them on our training data for some epochs.", "Let us see how our models performed on there own.", "The results are not at all bad but we will still improve them.", "Our next step is to load the models we have just created above and freeze their layers so that their weights are not altered when we fit our ensemble model on them.", "Take the outputs of all the models and put them in a concatenation layer. Then add a Dense layer with some units followed by a Dense layer with a single output and an activation equal to \u201csigmoid\u201d as our task is a binary classification. This can be thought of as an ANN where the predictions of all the models are taken as inputs and an output is provided.", "I used the classic \u2018Adam\u2019 optimizer with a little high learning rate of 10x-3 to compile the model.", "Let\u2019s see how our model looks now.", "Can we train this normally by just passing the dataset like how we trained our individual models? No! Inputs are required at three places while only one output is generated. So we will need to configure our X values like that.", "Now we can fit the model as we had done previously.", "First, let us plot the graphs for our ensemble model.", "I have trained it for just 20 epochs but having a look at the loss curves shows that the curve is still going down and the model can be trained for some more epochs. Let\u2019s see what validation accuracies did the models give on their final epochs.", "The ensemble accuracy is almost a 0.5% increase which is tremendous especially if taken into account that the accuracies before that were 97.8%.", "It is a very long procedure to create an ensemble model this way. It required four times the effort than a single model however, it can help in getting just a little more accuracy which is pretty hard to get once we reach the upper 90s in accuracy. Below you can find the complete code.", "Before ending I would like to give some credit to this article which helped me in creating this.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff287513b7687&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f287513b7687--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f287513b7687--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vardanagarwal16?source=post_page-----f287513b7687--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=post_page-----f287513b7687--------------------------------", "anchor_text": "Vardan Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0b122513e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&user=Vardan+Agarwal&userId=e0b122513e3b&source=post_page-e0b122513e3b----f287513b7687---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff287513b7687&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff287513b7687&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@rodlong?utm_source=medium&utm_medium=referral", "anchor_text": "Rod Long"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://machinelearningmastery.com/stacking-ensemble-for-deep-learning-neural-networks/", "anchor_text": "article"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f287513b7687---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----f287513b7687---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----f287513b7687---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----f287513b7687---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f287513b7687---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff287513b7687&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&user=Vardan+Agarwal&userId=e0b122513e3b&source=-----f287513b7687---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff287513b7687&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&user=Vardan+Agarwal&userId=e0b122513e3b&source=-----f287513b7687---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff287513b7687&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f287513b7687--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff287513b7687&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f287513b7687---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f287513b7687--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f287513b7687--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f287513b7687--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f287513b7687--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f287513b7687--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f287513b7687--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f287513b7687--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f287513b7687--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vardan Agarwal"}, {"url": "https://medium.com/@vardanagarwal16/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "399 Followers"}, {"url": "https://www.linkedin.com/in/vardan-agarwal-6bb123168/", "anchor_text": "https://www.linkedin.com/in/vardan-agarwal-6bb123168/"}, {"url": "https://www.buymeacoffee.com/vardan", "anchor_text": "https://www.buymeacoffee.com/vardan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0b122513e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&user=Vardan+Agarwal&userId=e0b122513e3b&source=post_page-e0b122513e3b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4ce0157411b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdestroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687&newsletterV3=e0b122513e3b&newsletterV3Id=4ce0157411b4&user=Vardan+Agarwal&userId=e0b122513e3b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}