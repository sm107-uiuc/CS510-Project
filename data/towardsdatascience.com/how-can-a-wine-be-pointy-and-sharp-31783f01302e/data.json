{"url": "https://towardsdatascience.com/how-can-a-wine-be-pointy-and-sharp-31783f01302e", "time": 1683003364.7590652, "path": "towardsdatascience.com/how-can-a-wine-be-pointy-and-sharp-31783f01302e/", "webpage": {"metadata": {"title": "How can a wine be pointy and sharp? | by Alen Tersakyan | Towards Data Science", "h1": "How can a wine be pointy and sharp?", "description": "The goals of the project: 1) Use Natural Language Processing and topic modeling to find trends in wine reviews 2) Create a recommendation system that finds similar (and cheaper) wines based off of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/atersakyan/Projects/tree/master/MetisProject4", "anchor_text": "Github", "paragraph_index": 3}, {"url": "https://medium.com/@lettier/how-does-lda-work-ill-explain-using-emoji-108abf40fa7d", "anchor_text": "This", "paragraph_index": 10}, {"url": "https://github.com/atersakyan/Projects/tree/master/MetisProject4", "anchor_text": "Github", "paragraph_index": 28}, {"url": "https://www.linkedin.com/in/atersakyan/", "anchor_text": "LinkedIn", "paragraph_index": 28}], "all_paragraphs": ["How can a wine be pointy, sharp, laser-like, or fleshy? Wine descriptions (especially sommelier-written reviews) often contain seemingly random adjectives that can be very confusing to the consumer. Having previously worked in a wine store, I\u2019ve seen first-hand how these descriptions and reviews cause confusion. How is a consumer supposed to know if they\u2019ll like a bottle if the review for the wine does not make sense? If they enjoyed a wine, how can they find similar bottles?", "The goals of the project: 1) Use Natural Language Processing and topic modeling to find trends in wine reviews 2) Create a recommendation system that finds similar (and cheaper) wines based off of the topic modeling in part one.", "The data: The dataset for this project was found on Kaggle, and was created by a user who scraped Wine Enthusiast magazine in 2017. It has 130k wine reviews with many useful features such as: grape varietal, points, price, region, and of course the sommelier\u2019s review. For a more detailed preview into the features and the data, see the dataset here.", "As with any data science project, EDA and cleaning are the first steps. Some hate it, some love it, we all have to do it. Most of the EDA for this project was for fun/practice and was not too necessary for the NLP or recommendation system, so I won\u2019t go into detail. However, if you\u2019d like to see my code and process, check out the project on Github.", "First of all, what is topic modeling? Topic modeling is a type of NLP model that analyzes the words in documents to try to find underlying \u201ctopics\u201d (themes) between them. For example, let\u2019s say we had four sentences (also known as documents in NLP): 1) \u201cI like dogs and cats\u201d 2) \u201cThe wine has hints of strawberry\u201d 3) \u201cThe dog\u2019s fur is black\u201d 4) \u201cThe wine smells of cat food\u201d. If we think about the topics in these documents, it\u2019s pretty clear that number one and three are about animals, number two is about wine, and number four might be a combination of the two topics. Topic models basically do this with a more mathematical approach.", "There are many variants of topic modeling such as NMF, LDA, and LSA, each with their own unique mathematical underpinnings. Furthermore, these models can be run in a variety of Python packages such as spaCy, Gensim, scikit-learn, and more. Each package requires slightly different steps, especially in text pre-processing. Although I tried various models and packages, my best performing model was an LDA model done in Gensim, so this blog posts outlines my experience with that.", "Before jumping into topic modeling, we need to prepare the text we are going to run the models on. For this analysis I was looking for underlying themes in wine descriptions, so I only used the description column in the dataset. This is the feature with the sommelier-written review of each wine.", "The preprocessing steps are as follows:", "Now the text is ready to be modeled. As mentioned earlier, there are many different approaches and packages for topic modeling. In the following sections, I will discuss my final Gensim LDA model.", "LDA is a probabilistic model that assumes each document in the corpus consists of a distribution of topics, and each topic is composed of a distribution of words. The goal for the model is to learn the topic mixture of each document, and the word mixture of each topic. When using LDA for NLP, we pick the number of topics (this part is tricky and involves many iterations) and the model is forced to have a topic distribution of n topics. The model analyzes text on the word-topic level as well as the topic-document level. When running through the iterations, the model asks: What\u2019s the probability of a word belonging to a topic, and what\u2019s the probability of this document being composed of these topics?", "The diagram below helps me visualize how LDA works. Assume we have three topics \u2014 each corner of the triangle is a unique topic. In this case each document consists of some ratio of the three topics. If our document consists of an even mix between the topics, it would look like the top right triangle. If the document was a mix of topics two and three, then it would look like the bottom left triangle. There are two hyperparameters (alpha, beta) for LDA that affect the topic compositions, but I just used the defaults in my model. This Medium article describes them well.", "After running the model, you should examine your topics to see if they make sense. This is the tricky part of NLP \u2014 there is no correct answer. You need to use your intuition and domain knowledge to see if the topics make sense. You\u2019ll likely have to try a few times. After running the model above, some of the topics looked like this:", "These topics make sense to me. The first could be representative of buttery, oaky, chardonnays. The ninth could be chocolatey and oaky red wines.", "Imagine you go to dinner at your boss\u2019 house and have some amazing wine. The next day you check the review and find out it\u2019s $200. Maybe you want to find something with a similar taste profile that\u2019s more affordable. Pinpointing the flavors you liked and navigating confusing descriptions can be daunting.", "Now that topic modeling is complete, we can use these results to create a recommendation system. There are two major types of recommendation systems: content based and collaborative filtering. For this project, I created a content based recommendation system. Content based models use additional information about users and/or items (such as demographics), rather than relying on user-item interactions. Here, since my model does not have any user information, the content is the wine descriptions\u2019 topic distributions. So, the model recommends wines that have similar topic breakdowns.", "In the simplest terms, recommendation systems work by comparing items on some distance metric. This can be cosine similarity, euclidean distance, Jensen-Shannon Distance, Kullback-Leibler Divergence, or many other options. They all just measure how close items are in space. For this project I used the Jensen-Shannon Distance because it\u2019s a way of measuring the distance between probability distributions \u2014 which is what each document\u2019s topic distribution is in the LDA model.", "To implement this in python, I took advantage of SciPy\u2019s entropy measurement. Without getting deep into the math, just know that Jensen-Shannon is based off of Kullback-Leibler Distance, and that SciPy\u2019s entropy is just a measure of Kullback-Leibler Distance. The Jensen-Shannon Distance ranges from zero to one, with zero meaning two distributions are the closest/most similar.", "The first step to getting Jensen-Shannon Distance is transforming our matrix from the LDA into a dense document X topic matrix. In this new matrix, each row is a wine review, and the columns are topic breakdowns for each wine. Once we have this matrix, we run the distance metrics (i.e. Jensen-Shannon Distance) between document vectors.", "This involves a few simple steps:", "If we access a random wine in the dataframe, we can easily see its topic composition.", "Now that we have our document X topic matrix, we just need to run a few functions to extract the most similar wines to our query.", "The output from these functions is the index of the most similar k wines. It looks something like this:", "One thing to note, when running this function, new_wine is the topic distribution of a query wine that we want to find recommendations from. Maybe it\u2019s the wine you drank at your boss\u2019 house.", "Ok, just one more step before we can finally make some wine recommendations. The pandas indices that come from the previous functions are ilocs from the document X topic matrix which only contains topic distributions as the columns \u2014 no information about the wines. We need to merge this dataframe with the original dataframe so when we extract the most similar wines we have all the information at our disposal. This is important if we want to give the user descriptive information about the wine, but also to use the descriptive information (such as price) as filters. Just make sure they\u2019re merged correctly or you\u2019ll have some mismatches. Once that\u2019s complete you can create a final function that encapsulates everything, and has an input for a price range.", "The best way to illustrate the final model is with an example. I picked a $215 Malbec from Argentina and ran it through the final recommendation system. I also added a price filter in order to find a similar bottle that was under $50. The top recommended wine was a $35 Cabernet Sauvignon from Washington state.", "I plotted the topic distributions for both wines and they are pretty similar. This means that the recommendation system is working. Of course it\u2019s not perfect, and all of the topic modeling can be iterated through many times to get better and clearer topics, which will in turn return better recommendations.", "The goals of this project were: 1) Use NLP topic modeling to find common themes in wine reviews 2) Create a content based recommendation system to find similar wines.", "In this article, I reviewed the steps for text preprocessing, a brief LDA overview, and LDA topic modeling in Gensim. Finally, I went over steps for building a content based recommendation system. Through this project, I was able to achieve my two goals and create a final model that recommends wines based on flavor profiles from text descriptions.", "All the code for this project is on my Github. Feel free to contact me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist with a background in psychology and neuroscience research."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F31783f01302e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----31783f01302e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----31783f01302e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@atersakyan?source=post_page-----31783f01302e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@atersakyan?source=post_page-----31783f01302e--------------------------------", "anchor_text": "Alen Tersakyan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff62b1dff674b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&user=Alen+Tersakyan&userId=f62b1dff674b&source=post_page-f62b1dff674b----31783f01302e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31783f01302e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31783f01302e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://winefolly.com/tips/40-wine-descriptions/", "anchor_text": "https://winefolly.com/tips/40-wine-descriptions/"}, {"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "here"}, {"url": "https://github.com/atersakyan/Projects/tree/master/MetisProject4", "anchor_text": "Github"}, {"url": "https://github.com/atersakyan/Projects/blob/master/MetisProject4/2_WineNLP_Cleaning%2BLDA.ipynb", "anchor_text": "Github"}, {"url": "https://medium.com/@lettier/how-does-lda-work-ill-explain-using-emoji-108abf40fa7d", "anchor_text": "This"}, {"url": "https://www.researchgate.net/figure/Content-based-filtering-vs-Collaborative-filtering-Source_fig5_323726564", "anchor_text": "https://www.researchgate.net/figure/Content-based-filtering-vs-Collaborative-filtering-Source_fig5_323726564"}, {"url": "https://github.com/atersakyan/Projects/tree/master/MetisProject4", "anchor_text": "Github"}, {"url": "https://www.linkedin.com/in/atersakyan/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----31783f01302e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----31783f01302e---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----31783f01302e---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/topic-modeling?source=post_page-----31783f01302e---------------topic_modeling-----------------", "anchor_text": "Topic Modeling"}, {"url": "https://medium.com/tag/wine?source=post_page-----31783f01302e---------------wine-----------------", "anchor_text": "Wine"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F31783f01302e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&user=Alen+Tersakyan&userId=f62b1dff674b&source=-----31783f01302e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F31783f01302e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&user=Alen+Tersakyan&userId=f62b1dff674b&source=-----31783f01302e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F31783f01302e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----31783f01302e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F31783f01302e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----31783f01302e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----31783f01302e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----31783f01302e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----31783f01302e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----31783f01302e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----31783f01302e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----31783f01302e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----31783f01302e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----31783f01302e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@atersakyan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@atersakyan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alen Tersakyan"}, {"url": "https://medium.com/@atersakyan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "46 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff62b1dff674b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&user=Alen+Tersakyan&userId=f62b1dff674b&source=post_page-f62b1dff674b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3cf81c1794d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-can-a-wine-be-pointy-and-sharp-31783f01302e&newsletterV3=f62b1dff674b&newsletterV3Id=3cf81c1794d5&user=Alen+Tersakyan&userId=f62b1dff674b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}