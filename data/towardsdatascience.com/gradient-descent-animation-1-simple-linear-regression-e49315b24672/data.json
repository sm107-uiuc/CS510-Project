{"url": "https://towardsdatascience.com/gradient-descent-animation-1-simple-linear-regression-e49315b24672", "time": 1683010151.831476, "path": "towardsdatascience.com/gradient-descent-animation-1-simple-linear-regression-e49315b24672/", "webpage": {"metadata": {"title": "Gradient Descent animation: 1. Simple linear Regression | by Tobias Roeschl | Towards Data Science", "h1": "Gradient Descent animation: 1. Simple linear Regression", "description": "The Gradient Descent method is one of the most widely used parameter optimization algorithms in machine learning today. Python\u2019s celluloid-module enables us to create vivid animations of model\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pypi.org/project/celluloid/", "anchor_text": "Python\u2019s celluloid-module", "paragraph_index": 0}, {"url": "https://scikit-learn.org/0.20/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "sklearn\u2019s inborn linear regression model", "paragraph_index": 8}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html", "anchor_text": "meshgrid", "paragraph_index": 15}, {"url": "https://github.com/BundleOfKent/Animation_SimpleLinReg/blob/master/Animation_SimpleLinReg.ipynb", "anchor_text": "GitHub", "paragraph_index": 17}, {"url": "http://www.linkedin.com/in/tobi-roeschl-60430217b", "anchor_text": "www.linkedin.com/in/tobi-roeschl-60430217b", "paragraph_index": 19}], "all_paragraphs": ["The Gradient Descent method is one of the most widely used parameter optimization algorithms in machine learning today. Python\u2019s celluloid-module enables us to create vivid animations of model parameters and costs during gradient descent.", "In this article, I exemplarily want to use simple linear regression to visualize batch gradient descent. The goal is to build a linear regression model and train it on some data points we made up. For every training round (\u2018epoch\u2019), we intend to store current model parameters and costs. Finally, we aim to create some animations with our stored values.", "There are various articles on how to set up and fit a linear regression model on Medium alone. In theory, we are trying to find the best fitting, straight line for our data. Mathematically, a straight line in two-dimensional space can be described with the following function: y= w*x+b, with w representing the slope (or \u201cweight) and b representing the y-intercept (or \u201cbias\u201d) of our line. There are numerous methods on how to determine the optimal values for w and b given our n data points. The gradient descent algorithm aims to minimize the mean squared error between observed data points (y) and points we predicted with our regression line (\u0177). The mean squared error is also being referred to as \u2018cost function\u2019 (or \u2018costs\u2019) usually denoted as J.", "With our data points fixed, the cost function is only dependent on the parameters w and b. We aim to adjust our parameters until the cost function reaches its minimum. To get a glimpse on how to adjust (decrease vs. increase) the parameters we introduce the gradient of our cost function \u2207J(w,b):", "with \u03b4J/\u03b4w and \u03b4J/\u03b4b being the partial derivatives of J with respect to w and b respectively. By constantly moving our parameters in the opposite direction of the current gradient \u2207J, we can stepwise reduce the costs J. The size of the steps we take to reach the (local/global) minimum of J is usually denoted as \u03b1 and is also referred to as \u2018learning rate\u2019. When training our model, our objective is to repeat the following for each epoch until we reach convergence:", "Metaphorically speaking, the cost function can be imagined as some mountainous terrain, where beginning from a certain starting point, we want to head downhill until we reach a valley. Analogously, the gradient is giving us the \u2018multidimensional slope\u2019 i.e. the direction of where \u2018uphill\u2019 is on the mountain surface. That\u2019s why we intend to constantly adjust our parameters in the opposite direction of the gradient.", "Gradient descent algorithm can be sub-classified according to how much of the training data is being used simultaneously to compute the gradient of our cost function. In the following example, we use the entire dataset for every update respectively, which is also referred to as batch gradient descent. In Python we import some useful libraries and set up our simple linear regression model:", "We then want to introduce our training data, define the learning rate (\u03b1=0.001), initialize our starting parameters (w=3, b=-1), and finally train our model. For every epoch, we store the updated values of our parameters, the costs, and some particular predicted y-values in lists. List items are then being stored in numpy arrays where they serve as raw data for our animated plots.", "Note that the particularly small learning rate of 0.001 was chosen on purpose to prevent overly large steps during the first epochs of gradient descent. A larger learning rate (e.g. \u03b1=0.1) usually results in faster model convergence requiring fewer epochs. However, overly large steps during the first epochs of gradient descent tend to result in less appealing animations or even failure to converge. Just to make sure our fitted parameters converged to their true values, we verify our results with sklearn\u2019s inborn linear regression model.", "Since we are now confident that our gradient descent algorithm worked out as planned, we can move on to the animations.", "With our data points being generated and stored, we can now start to build some animations. We could, for example, plot the values our cost function and parameters take on with respect to the epoch while plotting the corresponding regression line simultaneously:", "These rather basic plots reveal a very important characteristic of gradient descent: if set up correctly, costs drop rapidly and parameter values change noticeably at the beginning of gradient descent. With rising epochs, only minor changes to costs and parameter values can be observed. Therefore, plotting all values we initially stored seems unfavorable. While predominantly focusing on the first epochs of the fitting process we can visualize most of the \u2018action\u2019 without crashing Python while generating these resource-intensive animations. After trying out some different selections of points to plot, I decided to utilize the first 50 epochs of the fitting process continuously, followed by plotting only every 5th or 200th data point until the number of epochs reaches 12,000. In the following piece of code, we define the epochs we intend to incorporate in our plots and create the animation above through snapshots after each for-loop. By calling Camera\u2019s animate-function we can turn our snapshots into animations.", "In my opinion, it makes sense to return the final values of J, w and b being plotted, so that we can make sure we roughly visualized model convergence in our animation despite not using all the points we stored during the fitting process. Especially in 3D-animations, it can sometimes be difficult to confirm the former just by looking at the graph.", "A more intriguing way of visualizing gradient descent can be obtained if we plot the cost function with respect to the parameters w and b, since this is closer to the actual concept of J being a function of w and b. In addition, we seek to introduce connection lines (dashed) between the regression line and our training data to portray the respective residuals.", "Some minor changes to our previous piece of code get us the animation above:", "Referring to the aforementioned \u2018mountain\u2019-analogy, creating a 3D visualization of gradient descent seems desirable. However, this requires some preliminary work since we have to create some data points we never encountered during the fitting process. In other words, we need to compute costs for every possible pair of w and b over a predefined range of parameter values to obtain a surface plot. Fortunately, numpy has a built-in function called meshgrid, which enables us to create coordinate grids for our three-dimensional plots.", "With the following code, we can now visualize gradient descent in three dimensions.", "I hope you enjoyed this article. If anything is unclear or if you have noticed any mistakes, please feel free to leave a comment. In the next article, I will address animations of gradient descent using the example of multilinear regression. The complete notebook can be found on my GitHub. Thank you for your interest!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Resident physician passionate about data science, statistics and machine learning. Get in touch: www.linkedin.com/in/tobi-roeschl-60430217b"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe49315b24672&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e49315b24672--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e49315b24672--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tobi.roeschl?source=post_page-----e49315b24672--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobi.roeschl?source=post_page-----e49315b24672--------------------------------", "anchor_text": "Tobias Roeschl"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe91e3908d96f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&user=Tobias+Roeschl&userId=e91e3908d96f&source=post_page-e91e3908d96f----e49315b24672---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe49315b24672&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe49315b24672&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pypi.org/project/celluloid/", "anchor_text": "Python\u2019s celluloid-module"}, {"url": "https://scikit-learn.org/0.20/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "sklearn\u2019s inborn linear regression model"}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html", "anchor_text": "meshgrid"}, {"url": "https://github.com/BundleOfKent/Animation_SimpleLinReg/blob/master/Animation_SimpleLinReg.ipynb", "anchor_text": "GitHub"}, {"url": "http://fa.bianp.net/teaching/2018/eecs227at/gradient_descent.html", "anchor_text": "http://fa.bianp.net/teaching/2018/eecs227at/gradient_descent.html"}, {"url": "https://machinelearningmastery.com/gentle-introduction-mini-batch-gradient-descent-configure-batch-size/", "anchor_text": "https://machinelearningmastery.com/gentle-introduction-mini-batch-gradient-descent-configure-batch-size/"}, {"url": "https://medium.com/tag/python?source=post_page-----e49315b24672---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e49315b24672---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/gradient-descent?source=post_page-----e49315b24672---------------gradient_descent-----------------", "anchor_text": "Gradient Descent"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe49315b24672&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&user=Tobias+Roeschl&userId=e91e3908d96f&source=-----e49315b24672---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe49315b24672&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&user=Tobias+Roeschl&userId=e91e3908d96f&source=-----e49315b24672---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe49315b24672&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e49315b24672--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe49315b24672&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e49315b24672---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e49315b24672--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e49315b24672--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e49315b24672--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e49315b24672--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e49315b24672--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e49315b24672--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e49315b24672--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e49315b24672--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobi.roeschl?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tobi.roeschl?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tobias Roeschl"}, {"url": "https://medium.com/@tobi.roeschl/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "143 Followers"}, {"url": "http://www.linkedin.com/in/tobi-roeschl-60430217b", "anchor_text": "www.linkedin.com/in/tobi-roeschl-60430217b"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe91e3908d96f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&user=Tobias+Roeschl&userId=e91e3908d96f&source=post_page-e91e3908d96f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe104edfdb597&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgradient-descent-animation-1-simple-linear-regression-e49315b24672&newsletterV3=e91e3908d96f&newsletterV3Id=e104edfdb597&user=Tobias+Roeschl&userId=e91e3908d96f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}