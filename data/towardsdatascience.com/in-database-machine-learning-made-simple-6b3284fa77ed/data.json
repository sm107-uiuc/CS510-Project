{"url": "https://towardsdatascience.com/in-database-machine-learning-made-simple-6b3284fa77ed", "time": 1683016048.4566941, "path": "towardsdatascience.com/in-database-machine-learning-made-simple-6b3284fa77ed/", "webpage": {"metadata": {"title": "Database Machine Learning \u2014 Made Simple | by Ben Epstein | Towards Data Science", "h1": "Database Machine Learning \u2014 Made Simple", "description": "If you\u2019ve clicked on this article, I don\u2019t need to convince you that Machine Learning is a game-changing tool. Building ML models is now accessible, easy, and beginner-friendly (most of the time)\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cloud.splicemachine.io/register?redirect=%2F_%2Fdashboard%2Factivity", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/Ben-Epstein/Medium-Aritcles/tree/master/in_db_ml", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://nbviewer.jupyter.org/gist/Ben-Epstein/66a7a15c86d8d83fd8f64f2b75a283e7", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://cloud.splicemachine.io/register?redirect=%2F_%2Fdashboard%2Factivity", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://github.com/Ben-Epstein/Medium-Aritcles/tree/master/in_db_ml", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html", "anchor_text": "Iris dataset", "paragraph_index": 11}, {"url": "https://www.mlflow.org/docs/1.8.0/tracking.html", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://pysplice.readthedocs.io/en/latest/splicemachine.spark.html", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://pysplice.readthedocs.io/en/latest/splicemachine.mlflow_support.html#splicemachine.mlflow_support.mlflow_support._deploy_db", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://www.tutorialspoint.com/jupyter/ipython_magic_commands.htm", "anchor_text": "magic", "paragraph_index": 24}, {"url": "http://cloud.splicemachine.io", "anchor_text": "notebook instance", "paragraph_index": 26}], "all_paragraphs": ["*Disclaimer: I am the Machine Learning lead for Splice Machine", "If you\u2019ve clicked on this article, I don\u2019t need to convince you that Machine Learning is a game-changing tool. Building ML models is now accessible, easy, and beginner-friendly (most of the time). Deploying those models, however, is another story. Simplicity, scalability, and inference speed are just a few of the roadblocks you have to overcome.", "One of the biggest problems with creating ML models is that the models are built in environments that are useless for deployment. Maybe you\u2019ve started a single-instance Jupyter notebook with Python. You could integrate Spark for big data processing, which is great, but the resulting inference speeds are extremely slow. Maybe you\u2019ve created a pipeline for putting your individual model in production with Flask, which works, but it\u2019s missing reproducibility (and potentially scalability). Maybe Python is just too slow for your real-time use case.", "The fundamental issue is that Machine Learning deployment is a young and immature field, and it hasn\u2019t yet developed the toolkits that database or software development have. Databases, for example, are widely available, stable, (sometimes) scalable and extremely fast. Because of this, we\u2019re going to piggyback on the work that database engineers have done, and use their tools to our advantage. Here, we\u2019ll focus on using scale-out RDBMS for model deployment.", "In this article I\u2019m going to walk you through building and deploying a Machine Learning model into a database using familiar tools. To get the full experience, you can walk through the examples with me by creating a free sandbox environment here.", "TL;DR The notebook is located here, and a gist of the notebook with outputs is here. To skip directly to the model deployment section of the article, click here", "To start, create a free sandbox environment here. Once you have your database ready, click on the database name to enter the dashboard.", "From there, you can click \u201cRetrieve DB Password\u201d to get your login.", "Once you have that, click \u201cNotebook\u201d to launch your Jupyter Notebook instance.", "You\u2019ll be prompted to enter your username and password, which you just saw from the dashboard. That will take a minute or so to start.", "Now that you\u2019re in your notebook environment, you\u2019ll create a new notebook, choosing Python 3 as your kernel. The entire notebook used will be available here", "You\u2019ll be building a Spark model to predict the Iris dataset to keep the demo short, but this can be extended to any dataset (of any size).", "First, you\u2019ll create your Spark Session. The configuration settings are handled under the hood for you, so just run the following lines to get going.", "At any time you can check out your Spark Console by running the lines", "That will return an interactive window where you can watch your Spark jobs and drill into them as they run.", "Now that you have your Spark Session, you can get your MLFlow Session and your Native Database connection. You can learn more about MLflow here and more about the Native Spark Datasource here.", "These lines automatically configure your MLflow session and connect it to the database.", "Last, you\u2019ll start your MLflow experiment and run to signify you\u2019re about to build your first model. Just like with Spark, you can view the MLflow UI with a similar command.", "Now that you\u2019ve connected, you will load the data and build your first model. This section will be shorter as it\u2019s focused on deployment, but you can access longer, more in-depth examples in your trial cluster\u2019s Jupyter Notebook by clicking on the \u201csplice notebooks\u201d folder, then \u201c7. MLManager\u201d", "Now, you\u2019ll load the iris dataset and convert it to a Spark Dataframe for training.", "You\u2019ll build a simple decision tree model here for classification.", "If you want, you can log some information to MLflow to keep track of what you\u2019ve done. Crucially, you will log your model to MLflow so you can deploy it.", "That\u2019s it! You\u2019ve created a simple Spark Model. Now it\u2019s time to deploy it to the database and utilize SQL to interact with it. You\u2019ll use the deploy_db function to make this happen. This function has a lot of optional parameters which you can dig into here, but for now, simply:", "It\u2019s as simple as that. What\u2019s happening under the hood is that the job is being submitted to the server which processes the request on your behalf. The last line, calling watch_job grabs the logs that are automatically streamed in from the server to you, so you can see what is happening in real time and debug if something goes wrong.", "Now that you have your model deployed, you\u2019ll make some predictions. You can run SQL in your notebooks by starting the cell with %%sql. That is a custom magic that allows you to run SQL directly against the Splice Machine Database you are working on.", "Finally, you can stop your Spark Session and end your run. This won\u2019t affect the SQL, and you can continue to interact with the deployed model by inserting new rows.", "That\u2019s it! You\u2019ve created your Machine Learning model, tracked it, and deployed it into the database for scalability, availability and speed. This simple example can be extended to Scikit-learn (which you can see in the folder \u201c7. MLManager\u201d) or into difficult problems with massive datasets and complex pipelines. You can even chain models (tables) together with triggers. To check out some of the other examples, see the splice_notebooks folder that came with your notebook instance, in the 7. MLManager folder.", "Thanks for sticking with me for the example! If you have any questions, please post them in the article and I\u2019ll be sure to respond.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Founding Engineer @ Galileo. Working on data-centric AI and looking for new hikes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6b3284fa77ed&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ben-epstein.medium.com/?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": ""}, {"url": "https://ben-epstein.medium.com/?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": "Ben Epstein"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4e3d9faca043&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&user=Ben+Epstein&userId=4e3d9faca043&source=post_page-4e3d9faca043----6b3284fa77ed---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b3284fa77ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b3284fa77ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://stock.adobe.com/contributor/206257799/pickup?load_type=author&prev_url=detail", "anchor_text": "pickup"}, {"url": "https://stock.adobe.com/", "anchor_text": "Adobe Stock"}, {"url": "https://cloud.splicemachine.io/register?redirect=%2F_%2Fdashboard%2Factivity", "anchor_text": "here"}, {"url": "https://github.com/Ben-Epstein/Medium-Aritcles/tree/master/in_db_ml", "anchor_text": "here"}, {"url": "https://nbviewer.jupyter.org/gist/Ben-Epstein/66a7a15c86d8d83fd8f64f2b75a283e7", "anchor_text": "here"}, {"url": "https://cloud.splicemachine.io/register?redirect=%2F_%2Fdashboard%2Factivity", "anchor_text": "here"}, {"url": "https://github.com/Ben-Epstein/Medium-Aritcles/tree/master/in_db_ml", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html", "anchor_text": "Iris dataset"}, {"url": "https://www.mlflow.org/docs/1.8.0/tracking.html", "anchor_text": "here"}, {"url": "https://pysplice.readthedocs.io/en/latest/splicemachine.spark.html", "anchor_text": "here"}, {"url": "https://pysplice.readthedocs.io/en/latest/splicemachine.mlflow_support.html#splicemachine.mlflow_support.mlflow_support._deploy_db", "anchor_text": "here"}, {"url": "https://www.tutorialspoint.com/jupyter/ipython_magic_commands.htm", "anchor_text": "magic"}, {"url": "http://cloud.splicemachine.io", "anchor_text": "notebook instance"}, {"url": "https://medium.com/tag/machine-learing?source=post_page-----6b3284fa77ed---------------machine_learing-----------------", "anchor_text": "Machine Learing"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6b3284fa77ed---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/mlops?source=post_page-----6b3284fa77ed---------------mlops-----------------", "anchor_text": "Mlops"}, {"url": "https://medium.com/tag/ml-model-deployment?source=post_page-----6b3284fa77ed---------------ml_model_deployment-----------------", "anchor_text": "Ml Model Deployment"}, {"url": "https://medium.com/tag/database?source=post_page-----6b3284fa77ed---------------database-----------------", "anchor_text": "Database"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b3284fa77ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&user=Ben+Epstein&userId=4e3d9faca043&source=-----6b3284fa77ed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b3284fa77ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&user=Ben+Epstein&userId=4e3d9faca043&source=-----6b3284fa77ed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b3284fa77ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6b3284fa77ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6b3284fa77ed---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6b3284fa77ed--------------------------------", "anchor_text": ""}, {"url": "https://ben-epstein.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ben-epstein.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ben Epstein"}, {"url": "https://ben-epstein.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "52 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4e3d9faca043&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&user=Ben+Epstein&userId=4e3d9faca043&source=post_page-4e3d9faca043--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F4e3d9faca043%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-database-machine-learning-made-simple-6b3284fa77ed&user=Ben+Epstein&userId=4e3d9faca043&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}