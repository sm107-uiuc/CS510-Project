{"url": "https://towardsdatascience.com/isolation-forest-and-pyspark-part-2-76f7cd9cee56", "time": 1683005144.544414, "path": "towardsdatascience.com/isolation-forest-and-pyspark-part-2-76f7cd9cee56/", "webpage": {"metadata": {"title": "Isolation Forest and Pyspark part 2 | by Maria Karanasou | Towards Data Science", "h1": "Isolation Forest and Pyspark part 2", "description": "So, after a few runs with the PySpark ml implementation of Isolation Forest presented here, I stumbled upon a couple of things and I thought I\u2019d write about them so that you don\u2019t waste the time I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/isolation-forest-and-spark-b88ade6c63ff", "anchor_text": "here", "paragraph_index": 0}, {"url": "http://buymeacoffee.com/mkaranasou", "anchor_text": "buymeacoffee.com/mkaranasou", "paragraph_index": 9}], "all_paragraphs": ["So, after a few runs with the PySpark ml implementation of Isolation Forest presented here, I stumbled upon a couple of things and I thought I\u2019d write about them so that you don\u2019t waste the time I wasted troubleshooting.", "In the previous article, I used VectorAssembler to gather the feature vectors. It so happened that the test data I had, created only DenseVectors, but when I tried the example on a different dataset, I realized that:", "The current workaround is to transform all vectors to dense, using a udf unfortunately.", "Set the approxQuantileRelativeError or the threshold parameter for large datasets", "If you are planning on training on a big dataset, e.g. more than 10M rows, even if you set parameters like maxSamples and maxFeatures to decrease the dimensions, you need to set the approxQuantileRelativeError parameter to something reasonable, e.g. 0.2. The reason is that the approxQuantile function is a very expensive function to use, especially if we expect the approxQuantileRelativeError to be 0. (which is the default value). Doing this, drastically cut the training time and the OOM and executor communication issues, and, up to now, I haven\u2019t seen any decline in prediction accuracy.", "From the comments of the implementation:", "Alternatively, set the threshold beforehand in fit and avoid the approxQuantile calculation like this:", "Hope this helps and saves you some time :) Let me know if you have any suggestions, corrections or ideas.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A mom and a Software Engineer who loves to learn new things & all about ML & Big Data. Buy me a coffee to help me keep going buymeacoffee.com/mkaranasou"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F76f7cd9cee56&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@karanasou", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://karanasou.medium.com/?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": ""}, {"url": "https://karanasou.medium.com/?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": "Maria Karanasou"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1570cd236e2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&user=Maria+Karanasou&userId=1570cd236e2d&source=post_page-1570cd236e2d----76f7cd9cee56---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76f7cd9cee56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76f7cd9cee56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/isolation-forest-and-spark-b88ade6c63ff", "anchor_text": "here"}, {"url": "https://github.com/titicaca/spark-iforest", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/isolation-forest-and-spark-b88ade6c63ff", "anchor_text": "Isolation Forest and SparkMain characteristics and ways to use Isolation Forest in PySparktowardsdatascience.com"}, {"url": "https://medium.com/mlearning-ai/machine-learning-interpretability-shapley-values-with-pyspark-16ffd87227e3", "anchor_text": "Machine Learning Interpretability \u2014 Shapley Values with PySparkInterpreting Isolation Forest\u2019s predictions \u2014 and not onlymedium.com"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----76f7cd9cee56---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----76f7cd9cee56---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/spark?source=post_page-----76f7cd9cee56---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/big-data?source=post_page-----76f7cd9cee56---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----76f7cd9cee56---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F76f7cd9cee56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&user=Maria+Karanasou&userId=1570cd236e2d&source=-----76f7cd9cee56---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F76f7cd9cee56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&user=Maria+Karanasou&userId=1570cd236e2d&source=-----76f7cd9cee56---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76f7cd9cee56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F76f7cd9cee56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----76f7cd9cee56---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----76f7cd9cee56--------------------------------", "anchor_text": ""}, {"url": "https://karanasou.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://karanasou.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Maria Karanasou"}, {"url": "https://karanasou.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.4K Followers"}, {"url": "http://buymeacoffee.com/mkaranasou", "anchor_text": "buymeacoffee.com/mkaranasou"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1570cd236e2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&user=Maria+Karanasou&userId=1570cd236e2d&source=post_page-1570cd236e2d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F399ab963554c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fisolation-forest-and-pyspark-part-2-76f7cd9cee56&newsletterV3=1570cd236e2d&newsletterV3Id=399ab963554c&user=Maria+Karanasou&userId=1570cd236e2d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}