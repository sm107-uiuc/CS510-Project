{"url": "https://towardsdatascience.com/covid-19-data-processing-58aaa3663f6", "time": 1683006143.628902, "path": "towardsdatascience.com/covid-19-data-processing-58aaa3663f6/", "webpage": {"metadata": {"title": "COVID-19 data processing with Pandas DataFrame | by B. Chen | Towards Data Science", "h1": "COVID-19 data processing with Pandas DataFrame", "description": "I published an article a couple days ago showing a step by step tutorial to building an Interactive Data Visualization for exploring Coronavirus Spreads. Several people left private notes on it\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/interactive-data-visualization-for-exploring-coronavirus-spreads-f33cabc64043", "anchor_text": "Interactive Data Visualization for exploring Coronavirus Spreads", "paragraph_index": 0}, {"url": "https://github.com/CSSEGISandData/COVID-19", "anchor_text": "Github page", "paragraph_index": 1}, {"url": "https://github.com/CSSEGISandData/COVID-19", "anchor_text": "Github page", "paragraph_index": 10}, {"url": "http://vega.github.io/vega", "anchor_text": "Vega", "paragraph_index": 37}, {"url": "http://vega.github.io/vega-lite", "anchor_text": "Vega-Lite", "paragraph_index": 37}, {"url": "https://github.com/altair-viz/vega_datasets", "anchor_text": "vega_datasets", "paragraph_index": 38}], "all_paragraphs": ["I published an article a couple days ago showing a step by step tutorial to building an Interactive Data Visualization for exploring Coronavirus Spreads. Several people left private notes on it asking specifically for the data processing steps.", "Today, I am posting the step by step tutorial to download, load, merge, clean and aggregate the COVID-19 time series data. The data was provided by the Johns Hopkins University Center for Systems Science and Engineering (JHU CSSE) who shared their data on a public Github page. The Johns Hopkins CSSE aggregates data from primary sources, such as the World Health Organisation, national, and regional public health institutions. This data is made freely available and is updated every day.", "Before we getting into the details, I would like to show you the final output of the COVID-19 data processing. Confirmed, Deaths, Recovered and Active are cumulative data. New cases, New deaths and New Recovered are day wise data. This DataFrames is ordered by Date and Country/Region.", "Also, I would like to thank the following projects for their COVID-19 data processing ideas:", "The main reason behind data processing is that data almost never comes in a form that is ready for us. And in my personal experience, a large amount of time spent on a data science project is on manipulating data.", "Let\u2019s take a look at the COVID-19 time series data,", "Here are some problems for me:", "This COVID-19 data processing tutorial runs the following steps:", "At the end of the data processing, I will show 2 simple data visualizations with Altair for demonstration.", "Let\u2019s import the libraries we need", "Go to Johns Hopkins CSSE public Github page and navigate to csse_covid_19_data/css_covid_19_time_series/", "Click the global CSV dataset and click \u201cRaw\u201d button to get the data url.", "Then, keep the urls in a collection and download using wget.download()", "Once download complete, it should output like below and the 3 files should appear in your working directory.", "Let\u2019s have a quick look at data, for example, confirmed_df.head() shows 93 columns. It should be the same on deaths_df and recovered_df", "By running confirmed_df.columns , deaths_df.columns and recovered_df.columns, all of them should output the same result as below:", "Notice that columns are all date from the 4th column onwards and to get the list of dates confirmed_df.columns[4:]", "Before merging, we need to use melt() to unpivot DataFrames from current wide format into long format. In other words, we are kinda transposing all date columns into values. Here are the main settings for that:", "Above should return new long DataFrames. All of them are ordered by Date and Country/Region because raw data was already ordered by Country/Region and the date columns are already in ASC order.", "Here is the example of confirmed_df_long", "In addition, we have to remove recovered data for Canada due to mismatch issue (\ud83e\udd37\u200d\u2642 Canada recovered data is counted by Country-wise rather than Province/State-wise).", "After that, we use merge() to merge the 3 DataFrames one after another", "Now, we should get a full table with Confirmed, Deaths and Recovered columns", "There are 3 tasks we would like to do", "You probably already notice that the values in the new Date column are all string with m/dd/yy format. To convert Date values from string to datetime, let\u2019s use DataFrame.to_datetime()", "Missing values NaN can be detected by running full_table.isna().sum()", "We found a lot NaN in Province/State, and that makes sense as many countries only report the Country-wise data. However, there are 1,602 NaNs in Recovered and let\u2019s replace them with 0.", "Apart from missing values, there are coronavirus cases reported from 3 cruise ships: Grand Princess, Diamond Princess and MS Zaandam. These data need to be extracted and treated differently due to Province/State and Country/Region mismatch over time. Here is what I was talking about:", "And here is how we extract the ship data.", "And to get rid of ship data from full_table :", "So far, all the Confirmed, Deaths, Recovered are existing data from raw CSV dataset. Let\u2019s add an active cases column Active, which is calculated by active = confirmed \u2014 deaths \u2014 recovered .", "And here is what full_table looks like now.", "Next, let\u2019s aggregate data into Country/Region wise and group them by Date and Country/Region.", "And here is what full_grouped looks like now", "Now let\u2019s add day wise New cases, New deaths and New recovered by deducting the corresponding accumulative data on the previous day.", "And finally here is the full_grouped. Be aware of that this final output is Country-wise data with", "Finally, you can save this final data to a CSV file:", "For simplicity, let\u2019s use Python Data Visualization library Altair to create some simple visualizations. Altair is a declarative statistical visualization library for Python, based on Vega and Vega-Lite. Altair offers a powerful and concise visualization grammar that enables you to build a wide range of statistical visualizations quickly.", "For Altair installation, I would strongly recommend creating a new Virtual Environment because Altair has a lot of dependencies. Then, activate your Virtual Environment, and run pip install altair vega_datasets to install Altair along with example dataset in vega_datasets.", "For tutorials on Virtual Environment, you can take a look:", "First, let\u2019s import the libraries, load data and select a country, for example, United Kingdom:", "Then, let\u2019s create a base chart with the common elements", "After that, we can concatenate horizontally using the | operator", "First, let\u2019s import the libraries, load data and select a list of countries", "Let\u2019s create a circle chart to display the day wise New cases,", "This article is mainly to show everyone how to process COVID-19 data step by step using Pandas. There are only 2 simple examples in the Data Exploration section for demonstration.", "If you are interested in learning Altair, you can take a look at the following two articles.", "And that\u2019s about it. Thanks for reading", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F58aaa3663f6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----58aaa3663f6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58aaa3663f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58aaa3663f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@uniqueton?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Anton"}, {"url": "https://unsplash.com/s/photos/covid-19?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/interactive-data-visualization-for-exploring-coronavirus-spreads-f33cabc64043", "anchor_text": "Interactive Data Visualization for exploring Coronavirus Spreads"}, {"url": "https://github.com/CSSEGISandData/COVID-19", "anchor_text": "Github page"}, {"url": "https://github.com/imdevskp/covid_19_jhu_data_web_scrap_and_cleaning", "anchor_text": "https://github.com/imdevskp/covid_19_jhu_data_web_scrap_and_cleaning"}, {"url": "https://www.kaggle.com/imdevskp/covid-19-analysis-visualization-comparisons/notebook", "anchor_text": "https://www.kaggle.com/imdevskp/covid-19-analysis-visualization-comparisons/notebook"}, {"url": "https://www.kaggle.com/neelkudu28/covid-19-visualizations-predictions-forecasting", "anchor_text": "https://www.kaggle.com/neelkudu28/covid-19-visualizations-predictions-forecasting"}, {"url": "https://github.com/CSSEGISandData/COVID-19", "anchor_text": "Github page"}, {"url": "https://github.com/CSSEGISandData/COVID-19", "anchor_text": "Github page"}, {"url": "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv'", "anchor_text": "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv'"}, {"url": "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv'", "anchor_text": "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv'"}, {"url": "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv'", "anchor_text": "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv'"}, {"url": "http://vega.github.io/vega", "anchor_text": "Vega"}, {"url": "http://vega.github.io/vega-lite", "anchor_text": "Vega-Lite"}, {"url": "https://github.com/altair-viz/vega_datasets", "anchor_text": "vega_datasets"}, {"url": "https://towardsdatascience.com/create-virtual-environment-using-virtualenv-and-add-it-to-jupyter-notebook-6e1bf4e03415", "anchor_text": "Create Virtual Environment using \u201cvirtualenv\u201d and add it to Jupyter NotebookAre you a Machine Learning Engineer and working with Python and Jupyter Notebook? In this article, you will see why\u2026towardsdatascience.com"}, {"url": "https://medium.com/analytics-vidhya/create-virtual-environment-using-conda-and-add-it-to-jupyter-notebook-d319a81dfd1", "anchor_text": "Create Virtual Environment using \u201cconda\u201d and add it to Jupyter NotebookAre you using anaconda and working with Jupyter Notebook and Python? In this article you will see how to create virtual\u2026medium.com"}, {"url": "https://towardsdatascience.com/python-interactive-data-visualization-with-altair-b4c4664308f8", "anchor_text": "Python Interactive Data Visualization with AltairCreating an interactive chart with less than 20 lines of code.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/interactive-data-visualization-for-exploring-coronavirus-spreads-f33cabc64043", "anchor_text": "Interactive Data Visualization for exploring Coronavirus SpreadsCreating an interactive compound chart with less than 30 lines of code using Altairtowardsdatascience.com"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----58aaa3663f6---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/data-science?source=post_page-----58aaa3663f6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----58aaa3663f6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/coronavirus?source=post_page-----58aaa3663f6---------------coronavirus-----------------", "anchor_text": "Coronavirus"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----58aaa3663f6---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F58aaa3663f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&user=B.+Chen&userId=563d09da62a&source=-----58aaa3663f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F58aaa3663f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&user=B.+Chen&userId=563d09da62a&source=-----58aaa3663f6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F58aaa3663f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F58aaa3663f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----58aaa3663f6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----58aaa3663f6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----58aaa3663f6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----58aaa3663f6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----58aaa3663f6--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-data-processing-58aaa3663f6&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}