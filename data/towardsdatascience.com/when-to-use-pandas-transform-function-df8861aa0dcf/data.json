{"url": "https://towardsdatascience.com/when-to-use-pandas-transform-function-df8861aa0dcf", "time": 1683013849.231083, "path": "towardsdatascience.com/when-to-use-pandas-transform-function-df8861aa0dcf/", "webpage": {"metadata": {"title": "When to use Pandas transform() function | by B. Chen | Towards Data Science", "h1": "When to use Pandas transform() function", "description": "Pandas is an amazing library that contains extensive built-in functions for manipulating data. Among them, transform() is super useful when you are looking to manipulate rows or columns. Let\u2019s see\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/013-pandas-transform/pandas-transform.ipynb", "anchor_text": "Github repo", "paragraph_index": 2}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.sum.html#pandas.Series.sum", "anchor_text": "sum()", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/working-with-missing-values-in-pandas-5da45d16e74", "anchor_text": "replace missing values is to replace NaN with mean", "paragraph_index": 30}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/013-pandas-transform/pandas-transform.ipynb", "anchor_text": "notebook on my Github", "paragraph_index": 33}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github", "paragraph_index": 35}], "all_paragraphs": ["Pandas is an amazing library that contains extensive built-in functions for manipulating data. Among them, transform() is super useful when you are looking to manipulate rows or columns.", "In this article, we will cover the following most frequently used Pandas transform() features:", "Please check out my Github repo for the source code", "Let\u2019s take a look at pd.transform(func, axis=0)", "Let\u2019s see how transform() works with the help of some examples.", "We can pass a function to func. For example", "You can also use a lambda expression. Below is the lambda equivalent for the plus_10() :", "We can pass any valid Pandas string function to func, for example 'sqrt' :", "func can be a list of functions. for example sqrt and exp from NumPy:", "func can be a dict of axis labels -> function. For example", "One of the most compelling usages of Pandas transform() is combining grouby() results.", "Let\u2019s see how this works with the help of an example. Suppose we have a dataset about a restaurant chain", "We can see that each city has multiple restaurants with sales. We would like to know \u201cWhat is the percentage of sales each restaurant represents in the city\u201d. The expected output is:", "The tricky part in this calculation is that we need to get a city_total_sales and combine it back into the data in order to get the percentage.", "The first solution is splitting the data with groupby() and using apply() to aggregate each group, then merge the results back into the original DataFrame using merge()", "Step 1: Use groupby() and apply() to calculate the city_total_sales", "groupby('city') split the data by grouping on the city column. For each of these groups, the function sum gets applied to the sales column to calculate the sum for each group. Finally, the new column gets renamed to city_total_sales and the index gets reset (Note: reset_inde() is required to clear the index generated bygroupby('city')).", "In addition, Pandas has a built-in sum() function and the following is the Pandas sum() equivalent:", "Step 2: Use merge() function to combine the results", "The group results get merged back into the original DataFrame using merge() with how='left' for left outer join.", "Finally, the percentage can be calculated and formatted.", "This certainly does our work. But it is a multistep process and requires extra code to get the data in the form we require.", "We can solve this effectively using the transform() function", "This solution is a game-changer. A single line of code can solve the apply and merge.", "Step 1: Use groupby() and transform() to calculate the city_total_sales", "The transform function retains the same number of items as the original dataset after performing the transformation. Therefore, a one-line step using groupby followed by a transform(sum) returns the same output.", "Finally, this is the same as the solution one to get the percentage.", "transform() can also be used to filter data. Here we are trying to get records where the city\u2019s total sales is greater than 40", "Another usage of Pandas transform() is to handle missing values at the group level. Let\u2019s see how this works with an example.", "Here is a DataFrame for demonstration", "In the example above, the data can be split into three groups by name, and each group has missing values. A common solution to replace missing values is to replace NaN with mean.", "Let\u2019s take a look at the average value in each group.", "Here we can use transform() to replace missing values with the group average value.", "Please checkout the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "More can be found from my Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf8861aa0dcf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----df8861aa0dcf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf8861aa0dcf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf8861aa0dcf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@billow926?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "billow926"}, {"url": "https://unsplash.com/s/photos/programming-pandas?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/013-pandas-transform/pandas-transform.ipynb", "anchor_text": "Github repo"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.sum.html#pandas.Series.sum", "anchor_text": "sum()"}, {"url": "https://towardsdatascience.com/working-with-missing-values-in-pandas-5da45d16e74", "anchor_text": "replace missing values is to replace NaN with mean"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/013-pandas-transform/pandas-transform.ipynb", "anchor_text": "notebook on my Github"}, {"url": "https://medium.com/@bindiatwork/difference-between-apply-and-transform-in-pandas-242e5cf32705", "anchor_text": "Difference between apply() and transform() in Pandas"}, {"url": "https://medium.com/@bindiatwork/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac", "anchor_text": "Using Pandas method chaining to improve code readability"}, {"url": "https://towardsdatascience.com/working-with-datetime-in-pandas-dataframe-663f7af6c587", "anchor_text": "Working with datetime in Pandas DataFrame"}, {"url": "https://medium.com/@bindiatwork/all-the-pandas-read-csv-you-should-know-to-speed-up-your-data-analysis-1e16fe1039f3", "anchor_text": "Pandas read_csv() tricks you should know"}, {"url": "https://towardsdatascience.com/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e", "anchor_text": "4 tricks you should know to parse date columns with Pandas read_csv()"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github"}, {"url": "https://medium.com/tag/python?source=post_page-----df8861aa0dcf---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----df8861aa0dcf---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pandas?source=post_page-----df8861aa0dcf---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----df8861aa0dcf---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/transform?source=post_page-----df8861aa0dcf---------------transform-----------------", "anchor_text": "Transform"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf8861aa0dcf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&user=B.+Chen&userId=563d09da62a&source=-----df8861aa0dcf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf8861aa0dcf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&user=B.+Chen&userId=563d09da62a&source=-----df8861aa0dcf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf8861aa0dcf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdf8861aa0dcf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----df8861aa0dcf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----df8861aa0dcf--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhen-to-use-pandas-transform-function-df8861aa0dcf&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}