{"url": "https://towardsdatascience.com/automating-machine-learning-models-on-aws-bfa183fe4065", "time": 1683000427.554304, "path": "towardsdatascience.com/automating-machine-learning-models-on-aws-bfa183fe4065/", "webpage": {"metadata": {"title": "Automating Machine Learning Models on AWS | by Ankit Yadav | Towards Data Science", "h1": "Automating Machine Learning Models on AWS", "description": "Working as a Research Assistant under Professor Gordon Gao, at the University of Maryland, I have had the opportunity to combine both my Data Engineering and Science interests to automate machine\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Working as a Research Assistant under Professor Gordon Gao, at the University of Maryland, I have had the opportunity to combine both my Data Engineering and Science interests to automate machine learning models in the cloud. Assisting one of Professor Gao\u2019s Phd fellows, I was tasked with providing an AWS-based solution, which would reduce human interventions when running a deep learning model for an upcoming health startup.", "Our client defined the problem as", "\u201cReduce Costs of EC2 instances, by running them only for computations, these computations happen whenever a customer uploads data into an S3 bucket, which can be anytime during the day.\u201d", "The computations mentioned encompass the machine learning model and processing data uploaded in S3. This meant, the EC2 should only be run for executing the ML model and should be switched off at other times, also these jobs don\u2019t have a fixed time and, the only fixed property they possess is that they have to be run as soon as the data is uploaded into the S3 Data bucket. I formed a rough workflow with the following algorithm which later helped me streamline the entire automation.", "1. Upload data into S3 Data bucket, setting off the Trigger Lambda function.", "2. The Trigger Lambda function switches on the EC2 instance and invokes the Worker Lambda function.", "3. Worker Lambda function copies data from the S3 Data bucket and begins execution of the Machine Learning model.", "3. EC2 instance executes ML model and sends output to S3 Output Bucket.", "4. Output File is PUT into S3 Output Bucket, which executes Stop EC2 Lambda function.", "5. Stop EC2 Lambda Function switches off EC2 instance.", "I had previously worked on EC2 and S3 while creating class assignments during my tenure as a Teaching Assistant under Professor Gao. However not with Lambda, and these being academic settings, I did not have many restrictions. Now,I was dealing with a client, which brought about the important aspect of security and added the element of working to meet a deadline. This, coupled with the fact that I had to use Lambda Functions for most of the heavy lifting in the project, made it more difficult for me.", "This automation ensured that the EC2 instance would only be instantiated for processing the data and switched off as soon as the output was written to an S3 bucket.", "I started off with setting up my Elastic Cloud Compute instance. I created a virtual environment in Python to load the libraries, which would be required to run my worker.py and trigger.py scripts, along with the packages needed for the ML model. I also added a tag to the EC2 instance as this would help me identify the instacnce when configuring the Lambda functions. Once the EC2 instance was setup, I began work on the Lambda functions. The Trigger function was responsible for two tasks: starting the EC2 instance when data was uploaded into the S3 Data Bucket and then calling the Worker Lambda Function once the EC2 started.", "I used the boto3 library to call various AWS APIs, for example starting the EC2 instance and invoking the Worker Lambda function and passing it the IP of the EC2.", "Next, I began developing the Worker Lambda function and programmed it to copy data from the S3 Data bucket to EC2 and then start execution of the machine learning model.", "From the above function, we can see that I used my private key(.pem) to log into EC2 and then executed commands to initiate an S3 copy from the Data bucket to the EC2 and then call the machine learning Python script on the data and copy the generated result to the S3 Output Bucket.", "Further, I coded the Stop EC2 Lambda function, which would be initiated once the output of the machine learning model was copied into S3 Output Bucket, this Lambda function would call the stop API on EC2, ensuring the EC2 runs only for the duration of the machine learning model.", "I had the individual Lambda functions ready, but getting them to work together, initiating each other when one completed was a different task that needed to be accomplished. Initially, I began work with AWS CloudWatch, and tried to use it to trigger the different Lambda functions, setting cron like timings and using alarms to execute functions. As feasible as these seemed, our client felt that I was increasing complexity of the entire workflow and wanted me to make things simpler.These constraints pushed me to find solutions using the existing services and this is when I encountered S3 events.", "S3 events is a feature which can be found under Properties tab of a S3 bucket and allows you to schedule events when you perform certain operations in a S3 bucket. After further researching, I was able to set Events for two of my Lambda functions, allowing me to link the pipeline and complete the automation.", "The workflow was now simpler to understand and setup, the initial PUT request in the S3 Data Bucket would set off the first S3 event which was designed to call Trigger Lambda function. The Trigger function switches the EC2 on and calls the Worker Lambda function next. As stated before, the Worker function will copy the uploaded data from the Data Bucket and run the deep learning model on the data. Once the computation was finished, the Worker function would then copy the result into the S3 Output bucket, setting off the next event of calling the Stop EC2 Lambda function and stopping the EC2.", "This ensured that the deep learning model was now automated and the EC2 would only be run when required, while being switched off at all other times.", "Thus, I had successfully reduced the runtime of the EC2 instance, Previously, my client had to run the EC2 from 9 am to 5 pm, for jobs that were run three or four times a day and did not take more than 20 minutes individually. After I automated the process, the client\u2019s runtime reduced from 8 hours to 1 hour, consequently allowing the client to reduce around 90% costs on AWS services.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbfa183fe4065&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ankity09?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankity09?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "Ankit Yadav"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2d3ff530ddc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&user=Ankit+Yadav&userId=2d3ff530ddc5&source=post_page-2d3ff530ddc5----bfa183fe4065---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbfa183fe4065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbfa183fe4065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@samuelzeller?utm_source=medium&utm_medium=referral", "anchor_text": "Samuel Zeller"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@perrygrone?utm_source=medium&utm_medium=referral", "anchor_text": "Perry Grone"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@neonbrand?utm_source=medium&utm_medium=referral", "anchor_text": "NeONBRAND"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/u/e4a60d4b1fc1?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "Kanak Yadav"}, {"url": "https://aws.amazon.com/premiumsupport/knowledge-center/start-stop-lambda-cloudwatch/", "anchor_text": "Stop and Start EC2 Instances at Scheduled Intervals Using Lambda and CloudWatchI want to reduce my Amazon Elastic Compute Cloud (Amazon EC2) usage by stopping and starting my EC2 instances\u2026aws.amazon.com"}, {"url": "https://medium.com/tag/aws?source=post_page-----bfa183fe4065---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bfa183fe4065---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----bfa183fe4065---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/tag/automation?source=post_page-----bfa183fe4065---------------automation-----------------", "anchor_text": "Automation"}, {"url": "https://medium.com/tag/amazon?source=post_page-----bfa183fe4065---------------amazon-----------------", "anchor_text": "Amazon"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbfa183fe4065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&user=Ankit+Yadav&userId=2d3ff530ddc5&source=-----bfa183fe4065---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbfa183fe4065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&user=Ankit+Yadav&userId=2d3ff530ddc5&source=-----bfa183fe4065---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbfa183fe4065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbfa183fe4065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bfa183fe4065---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bfa183fe4065--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bfa183fe4065--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bfa183fe4065--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankity09?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankity09?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ankit Yadav"}, {"url": "https://medium.com/@ankity09/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "81 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2d3ff530ddc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&user=Ankit+Yadav&userId=2d3ff530ddc5&source=post_page-2d3ff530ddc5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9f76d65267b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomating-machine-learning-models-on-aws-bfa183fe4065&newsletterV3=2d3ff530ddc5&newsletterV3Id=9f76d65267b0&user=Ankit+Yadav&userId=2d3ff530ddc5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}