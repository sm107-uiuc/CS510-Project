{"url": "https://towardsdatascience.com/hands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e", "time": 1683012773.096402, "path": "towardsdatascience.com/hands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e/", "webpage": {"metadata": {"title": "Hands-on Guide to Plotting a Decision Surface for ML in Python | by Salma El Shahawy | Towards Data Science", "h1": "Hands-on Guide to Plotting a Decision Surface for ML in Python", "description": "Utilize matplotlib to visualize decision boundaries for classification ML algorithms in python"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Lately, I have been struggling for a while to visualize the generated model of a classification model. I relied only on the classification report and the confusion matrix to weigh the model performance.", "However, visualize the results of the classification has its charm and makes more sense of it. So, I built a decision surface, and when I succeeded, I decided to write about it as a learning process and for anyone who might have stuck on the same issue.", "In this tutorial, I will start with the built-in dataset package within the Sklearn library to focus on the implementation steps. After that, I will use a pre-processed data (without missing data or outliers) to plot the decision surface after applying the standard scaler.", "Classification in machine learning means to train your data to assign labels to the input examples.", "Each input feature is defining an axis on a feature space. A plane is characterized by a minimum of two input features, with dots representing input coordinates in the input space. If there were three input variables, the feature space would be a three-dimensional volume.", "The ultimate goal of classification is to separate the feature space so that labels are assigned to points in the feature space as correctly as possible.", "This method is called a decision surface or decision boundary, and it works as a demonstrative tool for explaining a model on a classification predictive modeling task. We can create a decision surface for each pair of input features if you have more than two input features.", "I will use the make_blobs()function within the datasets class from the Sklearn library to generate a custom dataset. Doing so would focus on the implementations rather than cleaning the data. However, the steps are the same and are a typical pattern.Let\u2019s start by defining the dataset variables with 1000 samples and only two features and a standard deviation of 3 for simplicity\u2019s sake.", "Once the dataset is generated, hence we can plot a scatter plot to see the variability between variables.", "Here we looped over the dataset and plotted points between each Xand y colored by a class label. In the next step, we need to build a predictive classification model to predict the class of unseen points. A logistic regression could be used in this case since we have only two categories.", "All y_predcould be evaluated using the accuracy_scoreclass from thesklearn library.", "matplotlib provides a handy function called contour(), which can insert the colors between points. However, as the documentation suggested, we need to define the grid of points Xof yin the feature space. The beginning point would be to find the maximum value and minimum value of each feature then increase by one to make sure that the whole space is covered.", "Then we can define the scale of the coordinates using arange() function from the numpy library with a0.01 resolution to get the scale range.", "The next step would be converting x1_scale and x2_scale into a grid. The function meshgrid() within the numpy library is what we need.", "The generated x_gridis a 2-D array. To be able to use it, we need to reduce the size to a one dimensional array using the flatten() method from thenumpy library.", "Finally, stacking the vectors side-by-side as columns in an input dataset, like the original dataset, but at a much higher resolution.", "Now, we can fit into the model to predict values.", "Now, a grid of values and the predicted class label across the feature space has been generated.", "Subsequently, we will plot those grids as a contour plot using contourf(). The contourf()function needs separate grids per axis. To achieve that, we can utilize the x_gridand y_gridand reshape the predictions (y_pred)to have the same shape.", "Now it is time to apply the previous steps to real data to connect everything. As I mentioned earlier, this dataset is already cleaned with no missing points. The dataset represents car purchase history for a sample of people according to their age and salary per year.", "The dataset has two features Ageand EstimatedSalaryand one dependent variable purchased as a binary column. Value 0 represents the person with similar age, and salary that didn\u2019t make a car purchase. However, one means that the person did purchase the car. The next step would be to separate the dependent variable from features as X and y", "We need this step because Age and salary is not on the same scale", "It is exactly the same as the previous code, but instead of using train use test set.", "Finally, I hope this boilerplate could help in visualizing the classification model results. I recommend applying the same steps using another classification model, for example, SVM with more than two features. Thanks for reading, I am looking forward to any constructive comments.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F149710ee2a0e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://salmaeng71.medium.com/?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0----149710ee2a0e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F149710ee2a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F149710ee2a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jancanty?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Jan Canty"}, {"url": "https://unsplash.com/s/photos/boundaries?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html", "anchor_text": "Sklearn.datasets A"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.transform.html", "anchor_text": "Utilizing pandas to transform data"}, {"url": "https://matplotlib.org/api/_as_gen/matplotlib.pyplot.contour.html", "anchor_text": "ontour() A"}, {"url": "https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid", "anchor_text": "numpy.meshgrid() A"}, {"url": "https://scikit-learn.org/stable/auto_examples/tree/plot_iris_dtc.html", "anchor_text": "Plot the decision surface of a decision tree on the iris dataset"}, {"url": "https://www.kaggle.com/salmaeng/plot-decision-boundry-classification/edit", "anchor_text": "Full working Kaggle notebook"}, {"url": "https://github.com/salma71/blog_post", "anchor_text": "GitHub repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----149710ee2a0e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----149710ee2a0e---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/python?source=post_page-----149710ee2a0e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----149710ee2a0e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----149710ee2a0e---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F149710ee2a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----149710ee2a0e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F149710ee2a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----149710ee2a0e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F149710ee2a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F149710ee2a0e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----149710ee2a0e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----149710ee2a0e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----149710ee2a0e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----149710ee2a0e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----149710ee2a0e--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://salmaeng71.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "414 Followers"}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "https://www.linkedin.com/in/salma-elshahawy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F428e575094be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-plotting-a-decision-surface-for-ml-in-python-149710ee2a0e&newsletterV3=992085c0dce0&newsletterV3Id=428e575094be&user=Salma+El+Shahawy&userId=992085c0dce0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}