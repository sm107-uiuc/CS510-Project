{"url": "https://towardsdatascience.com/random-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed", "time": 1682996943.211825, "path": "towardsdatascience.com/random-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed/", "webpage": {"metadata": {"title": "Random Matrix Theory: The Best Classifier for prediction of Drug Binding? | by Laksh | Towards Data Science", "h1": "Random Matrix Theory: The Best Classifier for prediction of Drug Binding?", "description": "Two algorithms that have repeatedly shown consistent results (AUCs of around 0.7\u20130.8) are the following: However, a relatively recent algorithm inspired by Random Matrix Theory was reported a couple\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.pnas.org/content/pnas/113/48/13564.full.pdf", "anchor_text": "PNAS paper", "paragraph_index": 1}, {"url": "https://www.alpha-lee.com/", "anchor_text": "Alpha Lee", "paragraph_index": 1}, {"url": "https://www.ebi.ac.uk/chembl/", "anchor_text": "ChEMBL", "paragraph_index": 3}, {"url": "https://www.pnas.org/content/pnas/113/48/13564.full.pdf", "anchor_text": "PNAS paper", "paragraph_index": 3}, {"url": "https://medium.com/@lakshaithani/a-practical-introduction-to-the-use-of-molecular-fingerprints-in-drug-discovery-7f15021be2b1", "anchor_text": "fingerprints", "paragraph_index": 10}, {"url": "https://www.pnas.org/content/116/9/3373", "anchor_text": "PNAS paper", "paragraph_index": 37}, {"url": "https://www.linkedin.com/in/laksh-aithani-7b0451148/", "anchor_text": "LinkedIn", "paragraph_index": 40}], "all_paragraphs": ["Two algorithms that have repeatedly shown consistent results (AUCs of around 0.7\u20130.8) are the following:", "However, a relatively recent algorithm inspired by Random Matrix Theory was reported a couple of years back in a PNAS paper by the talented Alpha Lee. It obtains much better AUCs of ~0.9!", "Skip to 3. if you already know how to generate a matrix of bit vectors of molecules.", "To get these datasets, we head to the ChEMBL database and download all ligands for the ADR1B receptor. Alternatively, the dataset is on my GitHub. For the decoy set, we will use ligands from another arbitrary receptor (albeit a receptor that doesn\u2019t share homology with ADRB1). We will choose ligands from the 5HT1A receptor as this shares very little homology with ADRB1. Alternatively, we could use a selection of random ligands from ChEMBL and this is what is done in the PNAS paper.", "Once we have obtained the CSV files for our training and validation set, and decoy set, we load it into Python and clean it up. Here is the code to do that \u2014 feel free to copy it as the details are relatively uninteresting. The most important thing to note is that for the train_validation set, we only select molecules that have a binding affinity of less than 1000nM i.e these molecules are binders. For the decoy set, the binding affinity (to 5HT1A) is irrelevant because we assume that the binding affinity to ADR1B is very poor (a reasonable assumption).", "Let\u2019s have a look at the dataset:", "If you scroll to the right, there is a column containing the SMILES string of the molecule.", "We finally select the relevant columns. We don\u2019t actually need the affinity columns as we already know that the entire train_test set contains only binders and that the decoy set contains only non-binders. We include the affinity variables simply for completion (also, we can use sklearn\u2019s train_test_split function to conveniently split the train_test set into training and testing/validation sets).", "We\u2019ll use the SMILES column to generate a molecular fingerprint of each molecule.", "We essentially want to convert the molecular structure into a mathematical object, to do machine learning on it. We can use the chemoinformatics library RDKit to accomplish this, converting the SMILES string to molecule structure to a Morgan bit vector of length 2048. We can think of each entry corresponding to the absence or presence of a particular chemical substructure.", "This is a big topic in itself so please refer to my other blog post on fingerprints if you wish to find out more.", "The code to convert molecule to fingerprint is here \u2014 feel free to copy it as it is not particularly relevant to the crux of this post.", "Finally, we split our train_test set into a train set of binders and test/validation set of binders.", "This is slightly different to your canonical machine learning problem so take note of this. We have:", "We want to see what the most important features or combination of features are in the training set. We can do this by a Principal Component Analysis.", "Before doing this, we need to remember to scale all columns of the train set to have 0 mean and unit standard deviation. An additional requirement is to retain the column means and standard deviation, as we\u2019ll use these to also scale the test/validation and decoy set. Sklearn\u2019s StandardScaler function will do this. Then, we use the column means and stds to scale of the training matrix, to scale the testing and decoy ligands. This can also be done easily. Finally, we delete columns in all matrices that correspond to columns with 0 standard deviation in the training matrix. This code will do that:", "All that is required is forming the correlation matrix and then diagonalizing it. The eigenvectors corresponding to the largest eigenvalues will account for the most variance in the training set.", "We then note a key result from Random Matrix Theory \u2014 the Marchenko-Pastur distribution. It states that for a random matrix (entries are drawn from a Gaussian distribution with 0 mean and unit variance), its correlation matrix has the following eigenvalue distribution:", "Gamma = p/N describes how well sampled the dataset is. Recall that the training matrix had dimensions N x p. The positive subscript indicates that we only consider that bracket if it is positive. This means that eigenvalues that are larger than the MP threshold (shown below) are very unlikely in a random correlation matrix.", "Thus, by creating a vector space composed of eigenvectors of the correlation matrix, whose corresponding eigenvalues are larger than the MP threshold, we find the chemical feature space that facilitates binding to that particular receptor.", "We now have the binding vector space of our receptor. We can use this vector space to classify unknown ligands. The method is simple.", "The important thing to note here is we use the column means and stds of the training set. This is required \u2014 intuitively the unknown data should be scaled with the same parameters that were used to scale the training data. This has already been done in the previous code \u2014 Sklearn\u2019s StandardScaler makes this easy to do.", "This is easy enough to do. See below.", "We can make a simple function to do this in code:", "Here, dim_V is the dimension of the vector space V, governed by the MP threshold. p is the number of features of our fingerprint, and feature_vecs is a matrix where the columns are eigenvectors of the correlation matrix. All fairly standard.", "The most important question is: how do we choose epsilon? This is arbitrary and in fact, epsilon can be used to tune the false positive/true positive ratio and generate a ROC curve.", "As the default value of epsilon, we will choose it so that 95% of the training matrix is classified as binders (thus necessitating a 5% error rate in the training set).", "This concludes the RMT algorithm and below is a short code implementation of it in Python.", "We will do a sklearn classifier -type OOP implementation.", "The threshold_multiple parameter is for expanding or contracting our vector space by changing the MP threshold. I don\u2019t recommend changing this value however, as the MP threshold is about optimum.", "That\u2019s it. We\u2019re done. We can now use our algorithm to make a prediction on our dataset, which has conveniently already been cleaned and put into the right format.", "Note that the predict function returns an array of 1\u2019s and 0\u2019s indicating a prediction of binding or non-binding. Since we know the test/validation set consists of just binders, we can take the mean of test_preds to get the true-positive rate.", "Similarly, since the decoy set consists of non-binders, the mean of decoy_preds gives the false positive rate.", "A ROC curve plots the false positive rate against the true positive rate. A better classifier has a very high area under the curve (AUC). There needs to be some parameter in the model that tunes the fp/tp rate, and in our case, it is the parameter epsilon.", "Here is the output of the last cell, which is the introductory image.", "An obvious thought might be that we are checking unknown ligands for positive correlations with the receptor, but we are not checking unknown ligands for negative correlations. For example, a certain substructure or moiety might completely ruin the binding of the ligand to the binding pocket.", "We can address this naturally using a slight variant of the above algorithm. We repeat the RMT process as we have done but on a set of molecules that are known not to bind to the target. The intuition is that this set of molecules have chemical features that hinder binding, and we can select against these features when trying to predict an unknown molecule.", "This will be the focus of the next blog post, and it was actually described in a PNAS paper a few months ago also by Alpha Lee and colleagues.", "This algorithm, named Random Matrix Discriminant, outperforms RMT and all other commonly used methods, as shown below.", "If you enjoyed reading this, and/or want to be kept in the loop about the next algorithm, follow me on Medium.", "Feel free to connect with me on LinkedIn and tell me if you end up using this code in your research/job.", "Until then, have a nice day.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff82613fb48ed&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://laksh1997.medium.com/?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": ""}, {"url": "https://laksh1997.medium.com/?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": "Laksh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fb0cb9afbd2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&user=Laksh&userId=1fb0cb9afbd2&source=post_page-1fb0cb9afbd2----f82613fb48ed---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff82613fb48ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff82613fb48ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.youtube.com/watch?v=J4Wdy0Wc_xQ&vl=en", "anchor_text": "https://www.youtube.com/watch?v=J4Wdy0Wc_xQ&vl=en"}, {"url": "https://machinelearningmastery.com/naive-bayes-for-machine-learning/", "anchor_text": "https://machinelearningmastery.com/naive-bayes-for-machine-learning/"}, {"url": "https://www.pnas.org/content/pnas/113/48/13564.full.pdf", "anchor_text": "PNAS paper"}, {"url": "https://www.alpha-lee.com/", "anchor_text": "Alpha Lee"}, {"url": "https://en.wikipedia.org/wiki/Beta-1_adrenergic_receptor", "anchor_text": "ADR"}, {"url": "https://www.ebi.ac.uk/chembl/", "anchor_text": "ChEMBL"}, {"url": "https://www.pnas.org/content/pnas/113/48/13564.full.pdf", "anchor_text": "PNAS paper"}, {"url": "https://medium.com/@lakshaithani/a-practical-introduction-to-the-use-of-molecular-fingerprints-in-drug-discovery-7f15021be2b1", "anchor_text": "fingerprints"}, {"url": "https://www.pnas.org/content/116/9/3373", "anchor_text": "PNAS paper"}, {"url": "https://www.linkedin.com/in/laksh-aithani-7b0451148/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f82613fb48ed---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/drug-discovery?source=post_page-----f82613fb48ed---------------drug_discovery-----------------", "anchor_text": "Drug Discovery"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f82613fb48ed---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----f82613fb48ed---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/chemistry?source=post_page-----f82613fb48ed---------------chemistry-----------------", "anchor_text": "Chemistry"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff82613fb48ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&user=Laksh&userId=1fb0cb9afbd2&source=-----f82613fb48ed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff82613fb48ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&user=Laksh&userId=1fb0cb9afbd2&source=-----f82613fb48ed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff82613fb48ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff82613fb48ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f82613fb48ed---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f82613fb48ed--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f82613fb48ed--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f82613fb48ed--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f82613fb48ed--------------------------------", "anchor_text": ""}, {"url": "https://laksh1997.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://laksh1997.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Laksh"}, {"url": "https://laksh1997.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "305 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fb0cb9afbd2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&user=Laksh&userId=1fb0cb9afbd2&source=post_page-1fb0cb9afbd2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F83b5c97f3c22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frandom-matrix-theory-the-best-classifier-for-prediction-of-drug-binding-f82613fb48ed&newsletterV3=1fb0cb9afbd2&newsletterV3Id=83b5c97f3c22&user=Laksh&userId=1fb0cb9afbd2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}