{"url": "https://towardsdatascience.com/glr-with-python-and-scikit-learn-library-67b5b0d418ea", "time": 1683008015.332489, "path": "towardsdatascience.com/glr-with-python-and-scikit-learn-library-67b5b0d418ea/", "webpage": {"metadata": {"title": "Linear Regression with Python and scikit-learn library | by Guillaume Androz | Towards Data Science", "h1": "Linear Regression with Python and scikit-learn library", "description": "One of the most used tools in machine learning, statistics and applied mathematics, in general, is the regression tool. I say the regression, but there are lots of regression models and the one I\u2026"}, "outgoing_paragraph_urls": [{"url": "http://en.wikipedia.org/wiki/Least_squares#Lasso_method", "anchor_text": "LASSO", "paragraph_index": 9}, {"url": "http://en.wikipedia.org/wiki/Tikhonov_regularization", "anchor_text": "RIDGE", "paragraph_index": 9}], "all_paragraphs": ["One of the most used tools in machine learning, statistics and applied mathematics, in general, is the regression tool. I say the regression, but there are lots of regression models and the one I will try to cover here is the well known generalized linear regression. The idea underneath this complex word is quite simple: the observation we try to fit is supposed to be a linear combination of input explanatory variables. Mathematically, the observation vector be formulated", "where the x\u2096 stands for the explanatory vector k, and the w\u2096 are the weight of each explanatory variable. Furthermore, as we usually need for an intercept, by convention we set x\u2080=1 so that the weight w\u2080 represents the intercept.", "As a first example, let\u2019s begin by a simple linear regression which consists of minimizing the sum of error squares. The error is defined as the difference between the expected true value and the predicted value obtained by our model", "To illustrate this simple example, let\u2019s use the awesome library scikit-learn and especially the package sklearn.linear_model", "The model we use here is quite simple, it is just a line. The model seems quite good with fitted coefficients of w\u2080 =-0.87998 and w\u2081=4.54914, but the error is not null (mean squared error = 15.57 in the example). Sometimes a way to reduce the residual error is to change the model by a slightly more complex one. In our case, we simply fitted a polynom of degree 1. What if we increase the polynom degree? For example, let\u2019s say we increase the degree up to 12:", "As we can see, the more we increase the polynomial degree of the model, the more we reduce the residual error. However, and it is particularly evident in this example, the reductions of the error is not necessarily a sign of a better model. Indeed, imagine we use a high degree polynom as our model, the error tends to be null (and it is actually here as we have a polynom degree equal to the number of observations). But if we add an extra observation, our model surely experiences a high residual error.", "As we can see in this example, adding an observation at x=15 leads to increasing error with the polynom degree. This behavior is known as overfitting, i.e. the model fit very well the data but tends to poorly perform on new data. We say that it suffers from great variance.", "To overcome this problem, we need to choose the right polynom degree. We could, for example, split our dataset into two parts, a train set and a test set. Then, the best model would be the one with the least residual error on the test set. However, there a clever method to limit the overfitting phenomenon: regularization.", "Regularization consists of adding a penalty to a model, with the goal of preventing overfitting. It comes from the constatation that when the degree of the polynom increases (to take our first example), the weights of each monom also increases. Therefore, to overcome overfitting, we penalize monoms with high weight. The minimization function now becomes", "where |.| is typically L1 or L2 norm, and lambda is an hyper-parameter that can be tunable to adjust the penality sensibility (0 means no penalty, i.e. unregularized model). The two widely used regularization methods are L1 and L2 regularization, also called LASSO and RIDGE regression.", "To cite content of the scikit-learn library", "LASSO is useful in some contexts due to its tendency to prefer solutions with fewer parameter values, effectively reducing the number of variables upon which the given solution is dependent. For this reason, the LASSO and its variants are fundamental to the field of compressed sensing. Under certain conditions, it can recover the exact set of non-zero weights.", "We clearly see the effect of regularization. When we increase the penalty, we strongly limit the weights of each coefficient, up to only keep the intercept. But how to choose the right parameter? Well, here again, we need to look at the residual error computed on a set which is not the training set. Such a method is known as validation. The principle is to split the data set into three parts, say 80% for the training set, 10% for validation and 10% for test. The model is trained on the training set, then the validation set is used to choose the hyper-parameter. Finally, the test set is used to estimate the true error of the model. However, on small data sets, this approach is not efficient enough as it limits the amount of data available for training. For such small data sets, we can apply the method of cross-validation. For that, we split the data set into two parts, one for the training and the other for the test. The training is then performed on all the training set but some k samples. So let\u2019s imagine that the training set is composed of N samples. We perform N/k regressions on the N-k samples and we compute the validation error on the k remaining samples. After all those regressions, the validation error is the mean error of all the validation errors.", "In the scikit-learn library, there is a class that implement this approach and finds the optimal hyper-parameter: LassoCV. We then re-use the preceeding code sample omitting the alpha parameter to force the use of the LassoCV model :", "According to the LassoCV model, the optimal hyper-parameter alpha=4.16e\u207b\u2074.", "The RIDGE regression is quite similar to LASSO, and differs only by the order of the norm used in the regularization term. In LASSO, we used a norm of order 1 (L1) and in the RIDGE regression we use a norm of order 2 (L2). The behavior of this regularization technique is that all resulting weights of the models are still non null, but eventually with very small value so that their influence on the predicted value is quite low. On the opposite, LASSO imposes sparsity of the model by eventually setting weights to null which make the model interpretation easier. The main advantage of the RIDGE regression is that it is indifferent to multiplicative factor, and tends to equals weights of highly-correlated variables whereas LASSO will choose or the other.", "The implementation of our example is really similar to the previous LASSO case. All we have to do is replacing Lasso and LassoCV by Ridge and RidgeCV !", "And with the use of cross-validation:", "As we can see, the resulting model is a little different as with the LASSO regularization. And if we now look at the weight coefficients:", "In this article, we saw two regularization techniques and the importance to use regularization when we try to fit a model. We also saw that both techniques, although quite similar, give very different results. Indeed, whereas the RIDGE technique includes all the explanatory variables, LASSO results in a sparse model which is often easier to understand. However, LASSO performs less well in the case of highly correlated variables as it tends to produce high sparsity in the result. And that\u2019s exactly what we saw in our example when we tried to fit a cosinus with a polynom. Each variable are highly correlated so that the resulting model has a lot of zero values as weight coefficients. Along with RIDGE and LASSO, Elastic Net is another useful techniques which combines both L1 and L2 regularization. It allows for learning a sparse model while it also keep RIDGE properties.", "We briefly went through the subject, but as always in machine learning, we need several datasets to train the model, validate it and test it. We discussed that a little and we quickly saw how to deal with small datasets with cross-validation.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F67b5b0d418ea&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://guandroz.medium.com/?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": ""}, {"url": "https://guandroz.medium.com/?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": "Guillaume Androz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe9c80b7a94f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&user=Guillaume+Androz&userId=e9c80b7a94f6&source=post_page-e9c80b7a94f6----67b5b0d418ea---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67b5b0d418ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67b5b0d418ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@fabioha", "anchor_text": "@fabioha"}, {"url": "https://unsplash.com/", "anchor_text": "https://unsplash.com/"}, {"url": "http://en.wikipedia.org/wiki/Least_squares#Lasso_method", "anchor_text": "LASSO"}, {"url": "http://en.wikipedia.org/wiki/Tikhonov_regularization", "anchor_text": "RIDGE"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----67b5b0d418ea---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----67b5b0d418ea---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/python?source=post_page-----67b5b0d418ea---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/statistics?source=post_page-----67b5b0d418ea---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/regularization?source=post_page-----67b5b0d418ea---------------regularization-----------------", "anchor_text": "Regularization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F67b5b0d418ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&user=Guillaume+Androz&userId=e9c80b7a94f6&source=-----67b5b0d418ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F67b5b0d418ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&user=Guillaume+Androz&userId=e9c80b7a94f6&source=-----67b5b0d418ea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67b5b0d418ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F67b5b0d418ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----67b5b0d418ea---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----67b5b0d418ea--------------------------------", "anchor_text": ""}, {"url": "https://guandroz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://guandroz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Guillaume Androz"}, {"url": "https://guandroz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "80 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe9c80b7a94f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&user=Guillaume+Androz&userId=e9c80b7a94f6&source=post_page-e9c80b7a94f6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe5973915e993&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fglr-with-python-and-scikit-learn-library-67b5b0d418ea&newsletterV3=e9c80b7a94f6&newsletterV3Id=e5973915e993&user=Guillaume+Androz&userId=e9c80b7a94f6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}