{"url": "https://towardsdatascience.com/avoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf", "time": 1683017947.5966249, "path": "towardsdatascience.com/avoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf/", "webpage": {"metadata": {"title": "Avoid these 8 mistakes before training a Machine Learning model | by Roman Orac | Towards Data Science", "h1": "Avoid these 8 mistakes before training a Machine Learning model", "description": "One of the most common misconceptions in Machine Learning is that ML Engineers get a CSV dataset and they spend the majority of the time optimizing the hyperparameters of a model. If you work in the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://lightgbm.readthedocs.io/en/latest/Advanced-Topics.html#missing-value-handle", "anchor_text": "LightGBM", "paragraph_index": 18}, {"url": "https://romanorac.github.io/assets/notebooks/2020-03-23-machine-learning-tips.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 48}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter", "paragraph_index": 50}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet", "paragraph_index": 50}], "all_paragraphs": ["One of the most common misconceptions in Machine Learning is that ML Engineers get a CSV dataset and they spend the majority of the time optimizing the hyperparameters of a model.", "If you work in the industry, you know that\u2019s far from the truth. ML Engineers spend most of the time planning how to construct the training set that resembles real-world data distribution for a certain problem.", "When you\u2019ve managed to construct such training set, just add a few well-crafted features and the Machine Learning model won\u2019t have a hard time finding the decision boundary.", "In this article, we\u2019re going to go through 8 Machine Learning tips that will help you to train a model with fewer screw-ups. These tips are most useful when you need to construct the training set, e.g. you didn\u2019t get it from Kaggle.", "At the end of the article, I also share a link to the Jupyter Notebook template, which you can incorporate into your Machine Learning workflow.", "It\u2019s easier to learn with examples. Let\u2019s create a sample dataset with random features.", "One row represents a customer with his features and a binary target variable. customer_id is an index in the DataFrame.", "Despite being obvious that no positive customer is also marked as a negative, it does happen in the real world and it\u2019s worthwhile to check it.", "I use the assert statement above in a Jupyter Notebook, which breaks execution if there is a mistake in the training set. So when I construct a new training set and use the Jupyter command: \u201cRestart kernel and run all cells\u201d, I can be sure that the trainset has the required properties.", "When doing Exploratory Data Analysis (EDA), we need to aware that real-world datasets have mistakes in unexpected places. One of the goals of EDA is to discover them.", "How do the duplicates come into the training set?", "Many times with joins in SQL databases!", "E.g. you join an SQL table with another table by customer_id key. If any of those tables have multiples entries for a customer_id, it will create duplicates.", "Check my article about avoiding mistakes in SQL:", "How can we make sure there aren\u2019t any duplicates in our training set?", "We can use an assert statement that will break execution in case a duplicated customer_id appears:", "In my experience, missing values appear for two reasons:", "In the latter case, we can simply fix the query and map the NULL value. For real missing values, we need to know how our model handles them.", "For example, LightGBM supports missing values by default and we can set the desired behavior.", "LightGBM uses NA (NaN) to represent missing values by default. Change it to use zero by setting zero_as_missing=true. When zero_as_missing=false (default), the unshown values in sparse matrices (and LightSVM) are treated as zeros. When zero_as_missing=true, NA and zeros (including unshown values in sparse matrices (and LightSVM)) are treated as missing.", "Let\u2019s check if our dataset contains missing values.", "std_price_product_a column has a single missing value. Let\u2019s remove the entry and rerun the check.", "By now, we see that these checks can be very useful. We didn\u2019t spend a second on debugging! These checks notify us right away about the unexpected values in the dataset.", "When a missing value is expected for a certain feature, we can whitelist it so the check won\u2019t break execution next time.", "When working on feature engineering, we define certain features on a 0\u20131 scale or some other scale. It\u2019s worthwhile to check if a feature in between desired boundaries.", "In this example, we only check if features are on a scale between 0 and 1, but I would suggest you add more checks that are appropriate for your dataset.", "Before you start with training the model, I suggest you manually set the data type for every feature. At first, it might feel redundant, but you will thank me later.", "We can set the feature types in a for loop:", "Why is this useful? What happens to the integer data type when we add a missing value?", "The column data type changes from integer to the object data type. When we convert it to the numpy array it has floats instead of integers. The classifier could misinterpret ordinal or categorical features as continuous features.", "Let\u2019s look at an example below:", "It\u2019s a well-established practice in Machine Learning to define features in a list that we use in the model.", "It\u2019s worthwhile to check if a certain feature goes into the model more than once. It seems trivial but you can mistakenly duplicate features when coding and rerunning the Jupyter Notebook for X-th time.", "I would suggest you also list the features that you don\u2019t use in the model. That way you can spot a feature that should be in the model but it is not.", "Checking the correlation between the features (and target) is essential when modeling.", "Linear Regression is a well-known algorithm that has problems with multicollinearity \u2014 when your model includes multiple features that are similar to each other.", "Highly correlated features are also problematic with models that don\u2019t have a problem with multicollinearity, like Random Forest or Boosting. Eg. the model divides feature importance between correlated feature A and feature B, which makes feature importance misleading.", "Let\u2019s plot the correlation matrix and try to spot highly correlated features:", "In the correlation matrix above, we can observe that product_a_ratio and product_b_ratio are highly correlated.", "We need to be careful when removing correlated features as they can still add information despite high correlation.", "In our example, features have a Pearson Correlation (PC) equal to 1.0, so we can safely remove one of them. But if the PC would be 0.9 then we could reduce the overall accuracy of the model by removing such a feature.", "A good practice is also to add a comment, with a reason why we excluded the feature.", "After you\u2019ve trained the model and checked the metrics, the next step is to do a sanity check with a few samples that the model classified with confidence (customers classified with probability 0 or 1).", "This requires some manual work. When retraining the model, many times those top 5 predictions change. After the X-th change, it is not clear, if you\u2019ve already reviewed the sample or not.", "To help you remember that you\u2019ve already reviewed a customer, add a notes column to your DataFrame and write a short note to each sample that you review:", "While I was working as a Software Engineer, I found tests essential to quality software development. Tests (when well written) guarantee that the software works with given input arguments.", "The tips that I\u2019m sharing here guarantee that the dataset has the desired properties. This template can be thought of as a sequence of tests before training the model.", "The template drastically reduces redundant sanity checks. There are fewer \u201cWhat did I screw up again\u201d moments.", "You can download the Jupyter notebook template here.", "Some of the links above are affiliate links and if you go through them to make a purchase I\u2019ll earn a commission. Keep in mind that I link courses because of their quality and not because of the commission I receive from your purchases.", "Follow me on Twitter, where I regularly tweet about Data Science and Machine Learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcc3a3d12e4bf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://romanorac.medium.com/?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd----cc3a3d12e4bf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc3a3d12e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc3a3d12e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lazycreekimages?utm_source=medium&utm_medium=referral", "anchor_text": "Michael Dziedzic"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@roadtripwithraj?utm_source=medium&utm_medium=referral", "anchor_text": "Road Trip with Raj"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@jrarce?utm_source=medium&utm_medium=referral", "anchor_text": "Ricardo Arce"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-with-pandas-508a5e8a5964", "anchor_text": "Exploratory Data Analysis with pandas5 pandas tricks that will make you better with Exploratory Data Analysistowardsdatascience.com"}, {"url": "https://unsplash.com/@ferrez?utm_source=medium&utm_medium=referral", "anchor_text": "Stefano Ferretti"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/dont-repeat-these-5-mistakes-with-sql-9f61d6f5324f", "anchor_text": "Don\u2019t Repeat These 5 Mistakes with SQLDoing Data Analysis with SQL is pretty straightforward\u2026 until it is NOT!towardsdatascience.com"}, {"url": "https://unsplash.com/@lazycreekimages?utm_source=medium&utm_medium=referral", "anchor_text": "Michael Dziedzic"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://lightgbm.readthedocs.io/en/latest/Advanced-Topics.html#missing-value-handle", "anchor_text": "LightGBM"}, {"url": "https://unsplash.com/@jdent?utm_source=medium&utm_medium=referral", "anchor_text": "Jason Dent"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@nhillier?utm_source=medium&utm_medium=referral", "anchor_text": "Nick Hillier"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@noahdavis?utm_source=medium&utm_medium=referral", "anchor_text": "Noah N\u00e4f"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@sharonmccutcheon?utm_source=medium&utm_medium=referral", "anchor_text": "Sharon McCutcheon"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@laurensauderstudio?utm_source=medium&utm_medium=referral", "anchor_text": "Lauren Sauder"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@aarsoph?utm_source=medium&utm_medium=referral", "anchor_text": "Kristijan Arsov"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://romanorac.github.io/assets/notebooks/2020-03-23-machine-learning-tips.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://www.humanfirst.ai/", "anchor_text": "Labeling and Data Engineering for Conversational AI and Analytics"}, {"url": "https://imp.i115008.net/c/2402645/880006/11298", "anchor_text": "Data Science for Business Leaders"}, {"url": "https://imp.i115008.net/c/2402645/788201/11298", "anchor_text": "Intro to Machine Learning with PyTorch"}, {"url": "https://imp.i115008.net/c/2402645/803127/11298", "anchor_text": "Become a Growth Product Manager"}, {"url": "https://amzn.to/3ncTG7D", "anchor_text": "Deep Learning (Adaptive Computation and ML series)"}, {"url": "https://aigents.co/skills", "anchor_text": "Free skill tests for Data Scientists & Machine Learning Engineers"}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter"}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet"}, {"url": "https://unsplash.com/@cmhedger?utm_source=medium&utm_medium=referral", "anchor_text": "Courtney Hedger"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cc3a3d12e4bf---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cc3a3d12e4bf---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----cc3a3d12e4bf---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python?source=post_page-----cc3a3d12e4bf---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----cc3a3d12e4bf---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcc3a3d12e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&user=Roman+Orac&userId=68bf0657a0cd&source=-----cc3a3d12e4bf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcc3a3d12e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&user=Roman+Orac&userId=68bf0657a0cd&source=-----cc3a3d12e4bf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcc3a3d12e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcc3a3d12e4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cc3a3d12e4bf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cc3a3d12e4bf--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://romanorac.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.7K Followers"}, {"url": "https://romanorac.medium.com/membership", "anchor_text": "https://romanorac.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa69c18dd3c04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Favoid-these-8-mistakes-before-training-a-machine-learning-model-cc3a3d12e4bf&newsletterV3=68bf0657a0cd&newsletterV3Id=a69c18dd3c04&user=Roman+Orac&userId=68bf0657a0cd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}