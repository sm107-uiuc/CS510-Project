{"url": "https://towardsdatascience.com/the-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f", "time": 1682995098.043977, "path": "towardsdatascience.com/the-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f/", "webpage": {"metadata": {"title": "The limits of SQL in data science, analytics, and engineering | by Matt Hagy | Towards Data Science", "h1": "The limits of SQL in data science, analytics, and engineering", "description": "I truly want to do more with SQL. It seems like such a simple and elegant way to represent data joins, filtering, and basic transformations in a concise format. In many ways, I feel SQL is closer to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@matthagy/quickly-learning-the-basics-of-scala-through-structure-and-interpretation-of-computer-programs-ed5bfa90e8dc", "anchor_text": "Quickly learning the basics of Scala through Structure and Interpretation of Computer Programs examples (Part 1)", "paragraph_index": 17}, {"url": "http://matthagy.com", "anchor_text": "matthagy.com", "paragraph_index": 19}], "all_paragraphs": ["I truly want to do more with SQL. It seems like such a simple and elegant way to represent data joins, filtering, and basic transformations in a concise format. In many ways, I feel SQL is closer to a mathematical way of defining computation (i.e., a functional, LISPy, declarative approach) than conventional imperative code, which is a plus for SQL in my opinion. I particularly treasure short SQL queries that can quickly answer random ad hoc questions such as the following.", "Further, I find many people who don\u2019t identify as highly technical can learn basic SQL quickly and if necessary master it well enough to perform serious data analysis and transformations. As a data scientist and engineer, I find it great to be able to work with a larger set of stakeholders in thinking through the business logic we want to implement in computing stats or processing data. We simply access more people\u2019s critiques and ideas when non-engineers can work with the logic.", "But I always find SQL inadequate once the complexity grows beyond about a dozen lines of code in that I immediately start worrying about correctness and legibility. I\u2019d much rather implement the transformation in Spark with DataFrames using Scala (or if necessary PySpark using Python). I can then break my logic down into simple well-named functions and rigorously unit test each function. Simple integration tests can be used to verify that everything is connected together correctly. All around, I\u2019m simply more confident in the correctness of a Scala solution and feel more capable in refining and maintaining the code in the future.", "In many ways, I wish it didn\u2019t have to be that way with SQL. I\u2019d really like a great way to extract arbitrary SQL expression into functions and further have a great environment for testing SQL. I have yet to find anything that works for a range of SQL dialects and is also open source. Let me know if there is a good tool I should be looking into.", "I further find SQL to be a difficult language for expressing certain complex logic. For example, parsing JSON and then extracting and transforming specific fields. I know there exist solutions for loading nested JSON into SQL engines for subsequent processing, but I\u2019d rather write a Spark workflow that just directly reads the raw SQL data and perform the parsing and transformations in Scala.", "Further, I\u2019ve found myself having to implement complex business logic to perform various analysis and transformations (particularly for feature engineering) that just couldn\u2019t be written in SQL. Or at least it wasn\u2019t straightforward to implement in a conventional SQL approach. Sometimes I\u2019ve found hacky solutions, but they don\u2019t seem like a good representation of the logic we want to develop and maintain. Here\u2019s an example of a Spark workflow that I\u2019d struggle to implement elegantly in SQL.", "Can you think of a good way to implement this logic in SQL?", "Traditionally, user-defined functions (UDFs) would be developed in a conventional programming language to extend SQL capabilities. I find that solution inelegant in that we\u2019re now mixing two languages. Further, there are limits to what can be implemented in UDFs (and user-defined aggregates, UDAs). Nowadays, I think it\u2019s just better to use (Py)Spark and define the custom logic alongside the data processing definitions.", "Lastly, I really like types in any programming language. I think types convey so much information not only to the compiler but also to people reading the code. I find well-named functions, objects, and members \u2014with type annotations \u2014 provide a great level of self-documentation in code. Combine that with some small comments and concise external documentation, and you end up with highly legible code that anyone familiar with the language can learn and work with.", "Scala has an excellent type system and even modern Python has optional type annotations. While most SQL dialects support some level of types in stored procedures and functions, I\u2019ve found this limited to basic types and therefore can\u2019t be used to the same extent as type annotations in a robust programming language.", "I just don\u2019t see a path forward to getting SQL to the same quality as a Spark, DataFrame, and Scala solution. Yet, I recognize the need for data processing logic to be legible and modifiable to more than just engineers. I hypothesize that Spark, DataFrames, and basic Scala (SDS) could be used to that end.", "I\u2019m not proposing that non-engineers be able to read, reason about, and modify a full production Scala engineering system, but instead that they can work with small code snippets at a complexity level comparable to SQL. Further, DataFrame operations can build off their current understanding of SQL operations such as joins, filtering, and mapping transformations. They simply need only to learn the new syntax for implementing these familiar operations. Over time, they can learn more Scala to implement more complex logic when their work requires it.", "To further facilitate this education, I\u2019d like to develop a small tutorial of transferring SQL concepts to the SDS stack. Further, to really sell the materials, I\u2019d like to also develop a cool SQL->SDS transpiler. People could use this to see how their current SQL logic is transformed into this other tech stack. Combined with a snazzy web app, people could immediately start learning the equivalent SDS code for their work. This would allow people familiar with SQL to start learning the specific SDS knowledge they need to start solving problems.", "Such education synergizes with the development of cloud solutions for hosting Spark (e.g., AWS EMR, GCP Dataproc, Databricks, Cloudera Altus Cloud) such that more people can now easily access a Spark environment. Over time, maybe we could even get AWS and GCP to create ad hoc managed Spark environments comparable to the SQL solutions of Athena and Big Query. Overall, I anticipate more and more professionals are going to have access to Spark environments when they want them.", "I could even see data scientists transitioning to more complicated data engineering work when they need to build something to facilitate their data science work. Similarly, product managers may find themselves coding up complex business logic in Scala because it\u2019s simply harder to write up the logic in English. If we teach these SQL-to-Scala converts how to modularize code and write tests, we may soon find ourselves with an army of situational engineers that can implement parts of systems important to their work.", "What do you think? Do you believe Spark/DataFrames/Scala (SDS) can replace SQL for a growing number of non-engineers? Could it even help us all get more engineering work done, which all data companies are constantly looking to do? Let me know your thoughts in the comment section below because I\u2019d like to collect feedback on this idea before investing too much time in helping SQL aficionados transition to SDS.", "If you\u2019re interested in collaborating on SQL-to-SDS tutorials and/or the transpiler, drop me a message at matthew.hagy@gmail.com. Also, feel free to beat me to it! I\u2019ll gladly help develop and promote however I can.", "Update: If you\u2019ve found the Scala examples in this article interesting and would like to learn more about this powerful programming language you can check out my article, Quickly learning the basics of Scala through Structure and Interpretation of Computer Programs examples (Part 1).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer and fmr. Data Scientist and Manager. Ph.D. in Computational Statistical Chemistry. (matthagy.com)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4d7e48271a2f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@matthagy?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthagy?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": "Matt Hagy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3fe708dd30ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&user=Matt+Hagy&userId=3fe708dd30ed&source=post_page-3fe708dd30ed----4d7e48271a2f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d7e48271a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d7e48271a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@matthagy/quickly-learning-the-basics-of-scala-through-structure-and-interpretation-of-computer-programs-ed5bfa90e8dc", "anchor_text": "Quickly learning the basics of Scala through Structure and Interpretation of Computer Programs examples (Part 1)"}, {"url": "https://medium.com/tag/big-data?source=post_page-----4d7e48271a2f---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/sql?source=post_page-----4d7e48271a2f---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/spark?source=post_page-----4d7e48271a2f---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4d7e48271a2f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/scala?source=post_page-----4d7e48271a2f---------------scala-----------------", "anchor_text": "Scala"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d7e48271a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&user=Matt+Hagy&userId=3fe708dd30ed&source=-----4d7e48271a2f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d7e48271a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&user=Matt+Hagy&userId=3fe708dd30ed&source=-----4d7e48271a2f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d7e48271a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4d7e48271a2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4d7e48271a2f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4d7e48271a2f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthagy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthagy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matt Hagy"}, {"url": "https://medium.com/@matthagy/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "229 Followers"}, {"url": "http://matthagy.com", "anchor_text": "matthagy.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3fe708dd30ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&user=Matt+Hagy&userId=3fe708dd30ed&source=post_page-3fe708dd30ed--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F80fe9ab5a2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-limits-of-sql-in-data-science-analytics-and-engineering-4d7e48271a2f&newsletterV3=3fe708dd30ed&newsletterV3Id=80fe9ab5a2a&user=Matt+Hagy&userId=3fe708dd30ed&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}