{"url": "https://towardsdatascience.com/playing-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889", "time": 1683013356.229727, "path": "towardsdatascience.com/playing-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889/", "webpage": {"metadata": {"title": "Playing Optimal Heads-Up Poker with Reinforcement Learning | by Derek Austin | Towards Data Science", "h1": "Playing Optimal Heads-Up Poker with Reinforcement Learning", "description": "Reinforcement learning has been at the center of many AI breakthroughs in recent years. The opportunity for algorithms to learn without the onerous constraints of data collection presents huge\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/dcaustin33/poker", "anchor_text": "here", "paragraph_index": 6}], "all_paragraphs": ["Reinforcement learning has been at the center of many AI breakthroughs in recent years. The opportunity for algorithms to learn without the onerous constraints of data collection presents huge opportunities for key advancements. Google\u2019s DeepMind has been at the center of Reinforcement Learning, featuring breakthroughs with projects that garnered national attention like AlphaZero, a self-trained competitive agent that became the best Go player in the world in a span of 4 days.\u00b9", "Traditional reinforcement learning algorithms such as Q-learning, SARSA, etc. work well in contained single agent environments, where they are able to continually explore until they find an optimal strategy. However, a key assumption of these algorithms is a stationary environment, meaning the transition probabilities and other factors remain unchanged episode to episode. When agents are trained against each other, such as in the case of poker, this assumption is impossible as both agents strategies are continually evolving leading to a dynamic environment. Furthermore, the algorithms above are deterministic in nature meaning that one action will always be considered optimal as compared to another action given a state.", "Deterministic policies, however, do not hold for everyday life or poker. For example, when given an opportunity in poker, a player can bluff, meaning they represent better cards than they actually have by putting in an oversized bet meant to scare the other players into folding. However, if a player bluffs every time the opponents would recognize such a strategy and easily bankrupt the player. This leads to another class of algorithms called policy gradient algorithms which output a stochastic optimal policy that can then be sampled from.", "Still, a large problem with traditional policy gradient methods is a lack of convergence due to dynamic environments as well as relatively low data efficiency. Luckily, numerous algorithms have come out in recent years that provide for a competitive self play environment that leads to optimal or near-optimal strategy such as Proximal Policy Optimization (PPO) published by OpenAI in 2017.\u00b2 The uniqueness of PPO stems from the objective function which clips the probability ratio from the previous to the new model, encouraging small policy changes instead of drastic change.", "These methods have been applied successfully to numerous multi-player Atari games, so my hypothesis was that they could easily be adapted to heads up poker. In tournament poker the majority of winnings are concentrated in the winners circle, meaning that to make a profit, wins are much more important than simply \u201ccashing\u201d or making some money each time. A large portion of success in heads up poker is the decision to go all in or not, so in this simulation the agent had two options, fold or go all-in which also reduced the possible state space dramatically which is key to making this problem solvable with algorithms like PPO.", "The rules of poker dictate a \u201csmall blind\u201d and a \u201cbig blind\u201d to start the betting, meaning that the small blind has to put in a set amount of chips and the big blind has to put in double that amount. Then cards are dealt and the players bet. The only parameters the agents were given were the following: what percentage chance they would win the current hand against a random heads up player, whether they were first to bet, and how much they had already bet. They were then fed to a simple two layer neural network.", "The packages for comparing winners as well as simulations to determine the percentage likelihood of winning the hand given a players cards can all be found on my Github here. In order to judge the effectiveness of PPO, I decided to compare the performance to that of the Reinforce algorithm a traditional policy gradient method. I chose to test the agents at different big blind levels as well which I set to be 1/50 of their total chips, 1/20 of their total, 1/10, 1/4 and 1/2. After each hand, their chip count was reset and the episode was run again. I ran each through a million simulations and then compared. What was extremely interesting to me was that at no level of blinds, did the difference as measured in chips won between the reinforce and the PPO algorithms become significant at a .05 level. However, the policies of the two different algorithms were extremely different. For example, here is a heatmap of the PPO policy for unsuited cards when the blinds are 1/20 of the stack, and the agent is the first to bet as compared to the reinforce policy in the exact same scenario.", "Reinforce is practically a deterministic policy whereas PPO is a far gentler transition meaning that PPO will bluff more while Reinforce will play only with a likely winner. Interestingly enough, these correspond to two different types of poker players. Those that are called \u201ctight\u201d only play when they think they have favorable odds, whereas \u201cloose\u201d players will play lots of hands, bluff and even fold some large hands if they think they are beaten. As the size of the hands increases, the reinforce agent still has closer to a deterministic policy but increases the number of combinations they will bet all-in on.", "This can be seen as the agent learning a key strategy in poker known as pot odds. This is the concept that as the number of chips you can win increases relative to the size of your next bet you should be willing to play more hands. The reason being that the expected value will allow a lower probability of winning as long as the pot size is relatively large. For example, if the pot is $800 and the bet for you to go all in is $200, you would only need a 20% chance of winning that hand in order to break even in the long run if you bet as you would win $1000 chips 20% of the time thus equaling your bet of 200. However, if the pot is $200 and your all-in bet is $200 you would need a 50% of winning that hand. The agents recognize this aspect and play more loosely with their chips as they are getting pot odds than they had when the blinds were lower. We can see this reach a breaking point when the blinds are 50% of each agent's total chips and practically all hands are likely to be played.", "While the agents did not differ significantly in performance, as you can see from the graphs they had extremely different playing styles which was an interesting finding. I expect that as the complexity increased PPO would do better as it seems to have a smoother function that could adapt an optimal stochastic policy whereas Reinforce approached a deterministic policy. Poker, especially this limited scenario, is just one of many possible applications of policy gradient theorems that are continually being explored. Furthermore, Carnegie Mellon and Facebook created a truly incredible agent that was able to beat top poker players in 6 player No-Limit Texas Hold \u2019Em.\u00b3 It is truly a very exciting time for reinforcement learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Recent grad extremely interested in machine learning, looking to specialize in reinforcement learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5fefe6261889&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5fefe6261889--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5fefe6261889--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dcaustin33?source=post_page-----5fefe6261889--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dcaustin33?source=post_page-----5fefe6261889--------------------------------", "anchor_text": "Derek Austin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8480f4c123c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&user=Derek+Austin&userId=8480f4c123c4&source=post_page-8480f4c123c4----5fefe6261889---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5fefe6261889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5fefe6261889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/dcaustin33/poker", "anchor_text": "here"}, {"url": "https://deepmind.com/blog/article/alphazero-shedding-new-light-grand-games-chess-shogi-and-go", "anchor_text": "https://deepmind.com/blog/article/alphazero-shedding-new-light-grand-games-chess-shogi-and-go"}, {"url": "https://arxiv.org/abs/1710.03748", "anchor_text": "https://arxiv.org/abs/1710.03748"}, {"url": "https://science.sciencemag.org/content/365/6456/885", "anchor_text": "https://science.sciencemag.org/content/365/6456/885"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----5fefe6261889---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/tag/ppo?source=post_page-----5fefe6261889---------------ppo-----------------", "anchor_text": "Ppo"}, {"url": "https://medium.com/tag/poker?source=post_page-----5fefe6261889---------------poker-----------------", "anchor_text": "Poker"}, {"url": "https://medium.com/tag/policy-gradient?source=post_page-----5fefe6261889---------------policy_gradient-----------------", "anchor_text": "Policy Gradient"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5fefe6261889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&user=Derek+Austin&userId=8480f4c123c4&source=-----5fefe6261889---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5fefe6261889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&user=Derek+Austin&userId=8480f4c123c4&source=-----5fefe6261889---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5fefe6261889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5fefe6261889--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5fefe6261889&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5fefe6261889---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5fefe6261889--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5fefe6261889--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5fefe6261889--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5fefe6261889--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5fefe6261889--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5fefe6261889--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5fefe6261889--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5fefe6261889--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dcaustin33?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dcaustin33?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Derek Austin"}, {"url": "https://medium.com/@dcaustin33/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "20 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8480f4c123c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&user=Derek+Austin&userId=8480f4c123c4&source=post_page-8480f4c123c4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F24015b6f5edd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fplaying-optimal-heads-up-poker-with-reinforcement-learning-5fefe6261889&newsletterV3=8480f4c123c4&newsletterV3Id=24015b6f5edd&user=Derek+Austin&userId=8480f4c123c4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}