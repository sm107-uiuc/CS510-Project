{"url": "https://towardsdatascience.com/a-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a", "time": 1683013496.981955, "path": "towardsdatascience.com/a-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a/", "webpage": {"metadata": {"title": "Transfer Learning using VGG Pre-trained model with Keras | Towards Data Science", "h1": "A Poor Example of Transfer Learning: Applying VGG Pre-trained model with Keras", "description": "Transfer learning is one of the state-of-the-art techniques in machine learning that has been widely used in image classification. In this article, I will discuss transfer learning, the VGG model\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scholar.google.com/scholar?hl=en&as_sdt=0%2C11&q=%22Very+Deep+Convolutional+Networks+for+Large-Scale+Image+Recognition%22&btnG=", "anchor_text": "Very Deep Convolutional Networks for Large-Scale Image Recognition", "paragraph_index": 1}, {"url": "http://www.image-net.org/challenges/LSVRC/", "anchor_text": "ILSVRC", "paragraph_index": 1}, {"url": "https://analyticsindiamag.com/transfer-learning-deep-learning-significance/", "anchor_text": "Significance Of Transfer Learning In The World Of Deep Learning", "paragraph_index": 5}, {"url": "https://masum-math8065.medium.com/membership", "anchor_text": "https://masum-math8065.medium.com/membership", "paragraph_index": 25}], "all_paragraphs": ["Transfer learning is one of the state-of-the-art techniques in machine learning that has been widely used in image classification. In this article, I will discuss transfer learning, the VGG model, and feature extraction. In the last section, I will demonstrate an interesting example of transfer learning where the transfer learning technique displays unexpectedly poor performance in classifying the MNist digit dataset.", "VGG is a convolutional neural network with a specific architecture that was proposed in the paper \u2014 Very Deep Convolutional Networks for Large-Scale Image Recognition by a group of researchers (visual geometry group) from the University of Oxford. The VGG group participated in an annual computer vision competition \u2014 ImageNet Large Scale Visual Recognition Challenge (ILSVRC) and submitted the famous VGG model for competing in object localization (detecting objects within an image coming from 200 classes)and image classification tasks (1000-class classification). The ImageNet dataset, a major computer vision benchmark dataset that was used in the competition, includes more than 14 million images belonging to 1000 classes. The VGG model outperformed other models with 92.7% top-5 test accuracy and won 1st and 2nd place in the 2014 ILSVRC competition.", "The VGG has two different architectures: VGG-16 contains 16 layers and VGG-19 contains 19 layers. In this article, we focus on VGG-16 which mainly contains three different parts: convolution, pooling, and fully connected layers \u2014 it starts with two convolution layers followed by pooling, then another two convolutions followed by pooling, after that repetition of three convolutions followed by pooling, and then finally three fully connected layers. The following figure shows the architecture of the VGG-16 model. The most interesting part of the VGG model is that the model weights are available on different platforms (i.e. Keras) and can be used for further analysis \u2014 developing models and applications. The idea of utilizing models\u2019 weights for further tasks initiates the idea of transfer learning.", "We can run the following three lines of code to plot the VGG-16 model architecture in python:", "We know that the training time increases exponentially with the neural network architecture increasing/deepening. In general, it could take hours/days to train a 3\u20135 layers neural network with a large-scale dataset. Consequently, deploying VGG from scratch on a large-scale dataset is a tiresome and computationally expensive task due to the depth and number of fully connected layers/nodes in the models\u2019 architecture. Another challenge is that building VGG from scratch requires considerably large memory space and bandwidth since the size of ImageNet trained VGG-16 weights is 528 MB. However, instead of building a VGG from scratch, we can perform transfer learning i.e. \u2014 utilizing the knowledge like weights, and features of the previously trained (e.g. pre-trained VGG) models\u2019 to solve a similar kind of problem. For instance, if we want to develop a binary image classifier, then we can use a pre-trained model that is trained on a large benchmark image dataset like VGG. Therefore, transfer learning is a machine learning method where a model developed for a task is reused as the starting point for a model on a second task. Transfer learning is generally used for speeding up the training time and eventually improving the performance of the models\u2019. While leveraging transfer learning, we must consider that the benefits of using transfer learning are not obvious.", "You can read the article Significance Of Transfer Learning In The World Of Deep Learning that explains when to use transfer learning.", "Machine learning algorithms especially deep neural networks may not able to learn properly when the training data is not enough. Transfer learning can play a significant role to solve this issue and adjust the model to suit the new task. There are a few factors we can look for while applying transfer learning [1]:", "Why the VGG model for transfer learning?", "Assuming the given number of training samples (images) are not sufficient enough for building a classifier, in that case, VGG can be easily leveraged for feature extraction as it is trained on millions of images. VGG was introduced in 2014 and still, it mysteriously produces better accuracy for some specific tasks compared to other classifiers through many state-of-the-art Image classifiers that came after 2014.", "In this article, we will show one demonstration of transfer learning with the VGG model that shows that the transfer learning approach does not perform up to the mark. In the future post, we will demonstrate another example where models\u2019 performance improved as expected for leveraging the transfer learning method.", "In this demonstration, we use the famous MNIST digit dataset. We use a portion of the MNIST dataset that contains only digits 8 and 6. Altogether there are 8200 samples and 784 features for each of the samples. We extract features for the MNIST dataset using the VGG pre-trained weights.", "We upload the dataset into the Google Colab from the local hard drive and convert the labels to 1 and 0 from 8 and 6.", "Now, we read the dataset. The following figure shows that the labels are 8 & 6. As in the later section, we will apply logistic regression, we convert the labels into 1 and 0.", "Running the one line of code will convert the labels:", "Step 2 \u2014 Extracting Features from the VGG-16 Model", "Before extracting features, just observe the summary of the VGG-16 model:", "In the summary, the VGG-16 contains 16 layers where the number of features is 25,088 after flatten of the last convolutional layer (the 1st highlighted) and in the final layer (prediction or final dense layer), the number of nodes is 1000 as VGG-16 mainly trained for 1000-class classification problem (the 2nd highlighted).", "For transfer learning purposes, we can extract 25088 features from the MNIST dataset using the VGG model. The red vertical line shows the cut for feature extraction.", "The following code section will cut the VGG model after the final convolutional layer:", "After extracting features from the digit data using the VGG model, we trained a logistic regression binary classifier with the features and perform a 10-fold cross-validation. Simultaneously, we also apply logistic regression on the raw mnist digit data with 10-fold cross-validation to compare results with the performance of transfer learning.", "The following two tables show the results of applying logistic regression to the raw data and extracted features from the raw data. Without transfer learning i.e. applying LR to the raw digit data achieves approximately 98% accuracy, while the model that leverages the transfer learning features achieves only 50% accuracy which is similar to a random guess for a binary classification problem. In general, we expect that with the transfer learning the model performance should be increased. However, in this demonstration, we experience that with transfer learning the model performance dramatically dropped.", "The possible reasons that VGG16 does not perform well:", "2. Background noises in the ImageNet data that were learned by the VGG-16 higher representational features", "3. VGG-16 trained for 1000-class classification while for this task we used it for binary classification", "Though the model with the transfer learning does not provide rewarding results in this experiment, utilizing other layers of the VGG for the feature extraction process or fine-tuning the parameters may produce better accuracy. To sum up, transfer learning is a state-of-the-art machine learning technique that can boost models\u2019 performance. However, smartly utilizing the transfer learning technique is a requirement to gain the proper advantages.", "Your membership fee will directly support and inspire Mohammad Masum and thousands of other writers you read. You\u2019ll also get full access to every story on Medium \u2014 https://masum-math8065.medium.com/membership", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Enthusiast | Student of Life |"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc9f5b8b1ab0a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://masum-math8065.medium.com/?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": ""}, {"url": "https://masum-math8065.medium.com/?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": "Masum"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F64ae8cb1d212&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&user=Masum&userId=64ae8cb1d212&source=post_page-64ae8cb1d212----c9f5b8b1ab0a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9f5b8b1ab0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9f5b8b1ab0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tq_photos?utm_source=medium&utm_medium=referral", "anchor_text": "T. Q."}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://scholar.google.com/scholar?hl=en&as_sdt=0%2C11&q=%22Very+Deep+Convolutional+Networks+for+Large-Scale+Image+Recognition%22&btnG=", "anchor_text": "Very Deep Convolutional Networks for Large-Scale Image Recognition"}, {"url": "http://www.image-net.org/challenges/LSVRC/", "anchor_text": "ILSVRC"}, {"url": "https://analyticsindiamag.com/transfer-learning-deep-learning-significance/", "anchor_text": "Significance Of Transfer Learning In The World Of Deep Learning"}, {"url": "https://masum-math8065.medium.com/membership", "anchor_text": "https://masum-math8065.medium.com/membership"}, {"url": "https://analyticsindiamag.com/transfer-learning-deep-learning-significance/", "anchor_text": "https://analyticsindiamag.com/transfer-learning-deep-learning-significance/"}, {"url": "https://keras.io/guides/transfer_learning/", "anchor_text": "https://keras.io/guides/transfer_learning/"}, {"url": "https://www.alibabacloud.com/blog/part-1-image-classification-using-features-extracted-by-transfer-learning-in-keras_595289", "anchor_text": "https://www.alibabacloud.com/blog/part-1-image-classification-using-features-extracted-by-transfer-learning-in-keras_595289"}, {"url": "https://medium.com/tag/transfer-learning?source=post_page-----c9f5b8b1ab0a---------------transfer_learning-----------------", "anchor_text": "Transfer Learning"}, {"url": "https://medium.com/tag/vgg16?source=post_page-----c9f5b8b1ab0a---------------vgg16-----------------", "anchor_text": "Vgg16"}, {"url": "https://medium.com/tag/feature-extraction?source=post_page-----c9f5b8b1ab0a---------------feature_extraction-----------------", "anchor_text": "Feature Extraction"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c9f5b8b1ab0a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mnist-dataset?source=post_page-----c9f5b8b1ab0a---------------mnist_dataset-----------------", "anchor_text": "Mnist Dataset"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9f5b8b1ab0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&user=Masum&userId=64ae8cb1d212&source=-----c9f5b8b1ab0a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9f5b8b1ab0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&user=Masum&userId=64ae8cb1d212&source=-----c9f5b8b1ab0a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9f5b8b1ab0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc9f5b8b1ab0a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c9f5b8b1ab0a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c9f5b8b1ab0a--------------------------------", "anchor_text": ""}, {"url": "https://masum-math8065.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://masum-math8065.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Masum"}, {"url": "https://masum-math8065.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "260 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F64ae8cb1d212&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&user=Masum&userId=64ae8cb1d212&source=post_page-64ae8cb1d212--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2dafcb5642c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-demonstration-of-transfer-learning-of-vgg-convolutional-neural-network-pre-trained-model-with-c9f5b8b1ab0a&newsletterV3=64ae8cb1d212&newsletterV3Id=e2dafcb5642c&user=Masum&userId=64ae8cb1d212&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}