{"url": "https://towardsdatascience.com/how-to-do-text-binary-classification-with-bert-f1348a25d905", "time": 1682995656.17683, "path": "towardsdatascience.com/how-to-do-text-binary-classification-with-bert-f1348a25d905/", "webpage": {"metadata": {"title": "Text Classification with BERT and Tensorflow in Ten Lines of Code | by Shuyi Wang | Towards Data Science", "h1": "Text Classification with BERT and Tensorflow in Ten Lines of Code", "description": "We all know BERT is a compelling language model which has already been applied to various kinds of downstream tasks, such as Sentiment Analysis and Question answering (QA). In some of them, it\u2026"}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/github/google-research/bert/blob/master/predicting_movie_reviews_with_bert_on_tf_hub.ipynb", "anchor_text": "this Colab Notebook", "paragraph_index": 11}, {"url": "https://github.com/SunYanCN?tab=repositories", "anchor_text": "Yan Sun", "paragraph_index": 16}, {"url": "https://github.com/SunYanCN/bert-text", "anchor_text": "bert-text", "paragraph_index": 16}, {"url": "https://github.com/wshuyi/demo-text-binary-classification-with-bert/blob/master/bert_text_classification.ipynb", "anchor_text": "this link", "paragraph_index": 17}], "all_paragraphs": ["We all know BERT is a compelling language model which has already been applied to various kinds of downstream tasks, such as Sentiment Analysis and Question answering (QA). In some of them, it over-performed human beings!", "Have you ever tried it on text binary classification?", "Honestly, till recently, my answer was still NO.", "Because the example code on BERT\u2019s official GitHub repo was not very user-friendly.", "Firstly, I want an IPython Notebook, instead of a Python script file, for I want to get instant feedback when I run a code chunk. Of course, a Google Colab Notebook would be better, for I can use the code right away with the free GPU/TPU.", "Secondly, I don\u2019t want to know the detail except for the ones I care. I want to control the useful parameters, such as the number of epochs and batch size. However, do I need to know all the \u201cprocessors,\u201d \u201cflags\u201d and logging functions?", "I am a spoiled machine learning user after I tried all other friendly frameworks.", "For example, in Scikit-learn, if you try to build a tree classifier, here is (almost) all your code.", "If you want to do image classification in fast.ai, you need to input these lines.", "Not only you can get the classification result, but an activation map as well.", "Why on earth cannot Google Developers give us a similar interface to use BERT for text classification?", "On Monday, I found this Colab Notebook. It\u2019s an example of predicting sentiment of movie reviews.", "I was so excited, for I learned BERT is now included in Tensorflow Hub.", "However, when I opened it, I found there are still too many details for a user who only cares about the application of text classification.", "So I tried to refactor the code, and I made it.", "However, originally, there were still a lot of codes in the notebook.", "So I asked my readers to help me package them. Soon, Yan Sun, a CS major graduate student in Huazhong University of Science & Technology did that, and made it a PYPI package named bert-text.", "Please follow this link and you will see the IPynb Notebook file on github.", "Click the \u201cOpen in Colab\u201d Button. Google Colab will be opened automatically.", "You need to save a copy to your own Google Drive by clicking on the \u201cCOPY TO DRIVE\u201d button.", "You only need to do four things after that.", "Let us install bert-text package and load the API.", "My example is a sample dataset of IMDB reviews. It contains 1000 positive and 1000 negative samples in training set, while the testing set contains 500 positive and 500 negative samples.", "I used it in my INFO 5731 class at UNT to let students compare the result of textblob package, Bag of Words model, simple LSTM with word embedding, and ULMfit.", "Now I can add BERT into the list, finally.", "You need to run the following line to make sure the training data is shuffled correctly.", "Your dataset should be stored in Pandas Data Frame. There should be one training set, called train and one testing set, called test.", "Both of them should at least contain two columns. One column is for the text, and the other one is for the binary label. It is highly recommended to select 0 and 1 as label values.", "Now that your data is ready, you can set the parameters.", "The first two parameters are just the name of columns of your data frame. You can change them accordingly.", "The third parameter is the learning rate. You need to read the original paper to figure out how to select it wisely. Alternatively, you can use this default setting.", "The last parameter is to set how many epochs you want BERT to run. I chose 10 here, for the training dataset is very small, and I don\u2019t want it overfits.", "By default, the pre-trained language model is \u201cbert_uncased_L-12_H-768_A-12\". It has been trained on English Wikipedia and the BookCorpus. Apart from that, there are five more options you can choose from by now.", "If you want to change to another pre-trained model, say Multilingual one to handle French or German, change the myparam setting as follow:", "The Chinese language is a particular case. You may need to set myparam like this:", "If you want to see the whole output (Optional), you should add the following two lines of code.", "Okay. Now you can run BERT!", "Warning! This line takes you some time to run.", "When it\u2019s finished, you can run the last line to get evaluation result of your classification model (on BERT).", "For such a small training set, I think the result is quite good.", "Now you can use the state of the art language modeling technique to train your text binary classifier too!", "If you are interested in this blog article, you may also want to read the following ones:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD in Information Science. Associate Professor at Tianjin Normal University. Former Adjunct Faculty at UNT. First Prize Winner of HackNTX 2018."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff1348a25d905&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1348a25d905--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1348a25d905--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://wshuyi.medium.com/?source=post_page-----f1348a25d905--------------------------------", "anchor_text": ""}, {"url": "https://wshuyi.medium.com/?source=post_page-----f1348a25d905--------------------------------", "anchor_text": "Shuyi Wang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ada2b2489b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&user=Shuyi+Wang&userId=5ada2b2489b7&source=post_page-5ada2b2489b7----f1348a25d905---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1348a25d905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1348a25d905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colab.research.google.com/github/google-research/bert/blob/master/predicting_movie_reviews_with_bert_on_tf_hub.ipynb", "anchor_text": "this Colab Notebook"}, {"url": "https://github.com/SunYanCN?tab=repositories", "anchor_text": "Yan Sun"}, {"url": "https://github.com/SunYanCN/bert-text", "anchor_text": "bert-text"}, {"url": "https://github.com/wshuyi/demo-text-binary-classification-with-bert/blob/master/bert_text_classification.ipynb", "anchor_text": "this link"}, {"url": "https://towardsdatascience.com/how-to-practice-python-with-google-colab-45fc6b7d118b", "anchor_text": "How to Practice Python with Google Colab?"}, {"url": "https://towardsdatascience.com/how-to-predict-severe-traffic-jams-with-python-and-recurrent-neural-networks-e53b6d411e8d", "anchor_text": "How to Predict Severe Traffic Jams with Python and Recurrent Neural Networks?"}, {"url": "https://medium.com/datadriveninvestor/deep-learning-with-python-and-fast-ai-part-1-image-classification-with-pre-trained-model-cd9364107872", "anchor_text": "Deep Learning with Python and fast.ai, Part 1: Image classification with pre-trained model"}, {"url": "https://medium.com/datadriveninvestor/deep-learning-with-python-and-fast-ai-part-2-nlp-classification-with-transfer-learning-e7aaf7514e04", "anchor_text": "Deep Learning with Python and fast.ai, Part 2: NLP Classification with Transfer Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f1348a25d905---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/bert?source=post_page-----f1348a25d905---------------bert-----------------", "anchor_text": "Bert"}, {"url": "https://medium.com/tag/classification?source=post_page-----f1348a25d905---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/google-colab?source=post_page-----f1348a25d905---------------google_colab-----------------", "anchor_text": "Google Colab"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f1348a25d905---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1348a25d905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&user=Shuyi+Wang&userId=5ada2b2489b7&source=-----f1348a25d905---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff1348a25d905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&user=Shuyi+Wang&userId=5ada2b2489b7&source=-----f1348a25d905---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff1348a25d905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f1348a25d905--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff1348a25d905&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f1348a25d905---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f1348a25d905--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f1348a25d905--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f1348a25d905--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f1348a25d905--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f1348a25d905--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f1348a25d905--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f1348a25d905--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f1348a25d905--------------------------------", "anchor_text": ""}, {"url": "https://wshuyi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://wshuyi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shuyi Wang"}, {"url": "https://wshuyi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "927 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5ada2b2489b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&user=Shuyi+Wang&userId=5ada2b2489b7&source=post_page-5ada2b2489b7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F957871bf04b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-text-binary-classification-with-bert-f1348a25d905&newsletterV3=5ada2b2489b7&newsletterV3Id=957871bf04b5&user=Shuyi+Wang&userId=5ada2b2489b7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}