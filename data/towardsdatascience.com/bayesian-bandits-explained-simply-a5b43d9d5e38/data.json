{"url": "https://towardsdatascience.com/bayesian-bandits-explained-simply-a5b43d9d5e38", "time": 1682997293.876262, "path": "towardsdatascience.com/bayesian-bandits-explained-simply-a5b43d9d5e38/", "webpage": {"metadata": {"title": "Bayesian Bandits explained simply | by Rahul Agarwal | Towards Data Science", "h1": "Bayesian Bandits explained simply", "description": "Any good business at the same time also tries to focus on a particular opportunity it has found already and tries to \u201cexploits\u201d it. Thought Experiment: Assume that we have infinite slot machines\u2026"}, "outgoing_paragraph_urls": [{"url": "https://amzn.to/2y0Tm42", "anchor_text": "pyMC3", "paragraph_index": 33}, {"url": "https://www.kaggle.com/mlwhiz/bayesian-bandits?scriptVersionId=17478592", "anchor_text": "kaggle", "paragraph_index": 38}, {"url": "https://amzn.to/2y0Tm42", "anchor_text": "Bayesian", "paragraph_index": 42}, {"url": "https://www.kaggle.com/mlwhiz/bayesian-bandits?scriptVersionId=17478592", "anchor_text": "Kaggle Kernel", "paragraph_index": 44}, {"url": "https://coursera.pxf.io/3PqL3r", "anchor_text": "Bayesian Methods for Machine Learning", "paragraph_index": 45}, {"url": "https://medium.com/@rahul_agarwal?source=post_page---------------------------", "anchor_text": "Medium", "paragraph_index": 46}, {"url": "http://eepurl.com/dbQnuX?source=post_page---------------------------", "anchor_text": "blog", "paragraph_index": 46}, {"url": "https://twitter.com/MLWhiz?source=post_page---------------------------", "anchor_text": "@mlwhiz", "paragraph_index": 46}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal", "paragraph_index": 48}], "all_paragraphs": ["Exploration and Exploitation play a key role in any business.", "And any good business will try to \u201cexplore\u201d various opportunities where it can make a profit.", "Any good business at the same time also tries to focus on a particular opportunity it has found already and tries to \u201cexploits\u201d it.", "Let me explain this further with a thought experiment.", "Thought Experiment: Assume that we have infinite slot machines. Every slot machine has some win probability. But we don\u2019t know these probability values.", "You have to operate these slot machines one by one. How do you come up with a strategy to maximize your outcome from these slot machines in minimum time.", "You will most probably start by trying out some machines.", "Would you stick to a particular machine that has an okayish probability(exploitation) or would you keep searching for better machines(exploration)?", "And the question is how do we balance this tradeoff such that we get maximum profits?", "There are a lot of places where such a thought experiment could fit.", "In this post, we will focus on AB Testing but this experiment will work for any of the above problems.", "The problem we have is that we have different assets which we want to show on our awesome website but we really don\u2019t know which one to show.", "One asset is blue(B), another red(R) and the third one green(G).", "Our UX team say they like the blue one. But you like the green one.", "Which one to show on our website?", "Before we delve down into the algorithm we will use to solve this, let us revisit the Bayes theorem.", "Just remember that Bayes theorem says that Posterior ~ likelihood*Prior", "We just need a small foray to understand the beta distribution. The beta distribution is a continuous probability distribution defined on the interval [0, 1] parametrized by two positive shape parameters, denoted by \u03b1 and \u03b2. The PDF of the beta distribution is:", "And, the pdf looks like below for different values of \u03b1 and \u03b2:", "Don\u2019t worry if you don\u2019t understand the beta distribution yet.", "Just keep in mind that the beta distribution is frequently applied to model the behavior of probabilities as it lies in the range [0,1].", "So after knowing the above concepts let us come back to our present problem.", "For the sake of this problem, let's assume that we know the click probabilities of these assets also.", "The win probability of blue(B) is 0.3, red(R) is 0.8 and green(G) is 0.4. Please note that in real life, we won\u2019t know this.", "These probabilities are going to be hidden from our algorithm and we will see how our algorithm will still converge to these real probabilities.", "So, what are our priors(beliefs) about the probability of each of these assets?", "Since we have not observed any data we cannot have prior beliefs about any of our three assets.", "We need to model our prior probabilities and we will use beta distribution to do that. See the curve for beta distribution above for \u03b1 = 1 and \u03b2=1.", "It is actually just a uniform distribution over the range [0,1]. And that is what we want for our prior probabilities for our assets. We don\u2019t have any information yet so we start with a uniform probability distribution over our probability values.", "So we can denote the prior probabilities of each of our asset using a beta distribution.", "The reason we took beta distribution to model our probabilities is because of its great mathematical properties.", "If the prior is f(\u03b1,\u03b2), then the posterior distribution is again beta, given by f(\u03b1+#success, \u03b2+#failures)", "where #success is the number of clicks and #failures are the number of views minus the number of clicks.", "We have every bit of knowledge we require for writing some code now. I will be using pretty much simple and standard Python functionality to do this but there exist tools like pyMC3 and such for this sort of problem formulations.", "Let us work through this problem step by step.", "We have three assets with different probabilities.", "We will be trying to see if our strategy given above works or not.", "Let us run this strategy multiple times and collect the data.", "This is the result of our runs. You can see the functions I used to visualize the posterior distributions here at kaggle. As you can see below, we have pretty much converged to the best asset by the end of 20 runs. And the probabilities are also estimated roughly what they should be.", "At the start, we have a uniform prior. As we go through with the runs we see that the \u201cred\u201d asset\u2019s posterior distribution converges towards a higher mean and as such a higher probability of pick. But remember that doesn\u2019t mean that the green asset and blue asset are not going to be picked ever.", "Let us also see how many times each asset is picked in the 50 runs we did.", "We can see that although we are mostly picking R we still end up sometimes picking B(Pick 45) and G(Pick 44) in the later runs too. Overall we can see that in the first few runs, we are focussing on exploration and as we go towards later runs we focus on exploitation.", "We saw how solving this problem using the Bayesian approach could help us converge to a good solution while maximizing our profit and not discarding any asset.", "An added advantage of such an approach is that it is self-learning and could self-correct by itself if the probability of click on the red decreases and blue asset increases. This case might happen when the user preferences change for example.", "The whole code is posted in the Kaggle Kernel.", "Also, if you want to learn more about Bayesian Statistics, one of the newest and best resources that you can keep an eye on is the Bayesian Methods for Machine Learning.", "I am going to be writing more of such posts in the future too. Follow me up at Medium or Subscribe to my blog to be informed about them. As always, I welcome feedback and constructive criticism and can be reached on Twitter @mlwhiz.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "4M Views. Bridging the gap between Data Science and Intuition. MLE@FB, Ex-WalmartLabs, Citi. Connect on Twitter @mlwhiz \u2615\ufe0f ko-fi.com/rahulagarwal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa5b43d9d5e38&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mlwhiz.medium.com/?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9----a5b43d9d5e38---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa5b43d9d5e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa5b43d9d5e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alicewu?utm_source=medium&utm_medium=referral", "anchor_text": "Alice Wu"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://amzn.to/2y0Tm42", "anchor_text": "pyMC3"}, {"url": "https://www.kaggle.com/mlwhiz/bayesian-bandits?scriptVersionId=17478592", "anchor_text": "kaggle"}, {"url": "https://amzn.to/2y0Tm42", "anchor_text": "Bayesian"}, {"url": "https://www.kaggle.com/mlwhiz/bayesian-bandits?scriptVersionId=17478592", "anchor_text": "Kaggle Kernel"}, {"url": "https://coursera.pxf.io/3PqL3r", "anchor_text": "Bayesian Methods for Machine Learning"}, {"url": "https://medium.com/@rahul_agarwal?source=post_page---------------------------", "anchor_text": "Medium"}, {"url": "http://eepurl.com/dbQnuX?source=post_page---------------------------", "anchor_text": "blog"}, {"url": "https://twitter.com/MLWhiz?source=post_page---------------------------", "anchor_text": "@mlwhiz"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a5b43d9d5e38---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a5b43d9d5e38---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----a5b43d9d5e38---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a5b43d9d5e38---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a5b43d9d5e38---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa5b43d9d5e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----a5b43d9d5e38---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa5b43d9d5e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&user=Rahul+Agarwal&userId=e8cce06956c9&source=-----a5b43d9d5e38---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa5b43d9d5e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa5b43d9d5e38&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a5b43d9d5e38---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a5b43d9d5e38--------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mlwhiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahul Agarwal"}, {"url": "https://mlwhiz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13.9K Followers"}, {"url": "http://ko-fi.com/rahulagarwal", "anchor_text": "ko-fi.com/rahulagarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8cce06956c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&user=Rahul+Agarwal&userId=e8cce06956c9&source=post_page-e8cce06956c9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff41165c9f72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-bandits-explained-simply-a5b43d9d5e38&newsletterV3=e8cce06956c9&newsletterV3Id=f41165c9f72f&user=Rahul+Agarwal&userId=e8cce06956c9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}