{"url": "https://towardsdatascience.com/missing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d", "time": 1683015487.755541, "path": "towardsdatascience.com/missing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d/", "webpage": {"metadata": {"title": "How to Handle Missing Data with Python and KNN | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "How to Handle Missing Data with Python and KNN", "description": "Missing value imputation isn\u2019t that difficult of a task to do. Methods range from simple mean imputation and complete removing of the observation to more advanced techniques like MICE. Nowadays, the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/stop-using-mean-to-fill-missing-data-678c0d396e22", "anchor_text": "MICE", "paragraph_index": 0}, {"url": "https://www.kaggle.com/arslanali4343/real-estate-dataset", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://www.kaggle.com/arslanali4343/real-estate-dataset", "anchor_text": "this link", "paragraph_index": 4}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights.", "paragraph_index": 25}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 26}, {"url": "https://betterdatascience.com/impute-missing-data-with-python-and-knn/", "anchor_text": "https://betterdatascience.com", "paragraph_index": 27}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 29}], "all_paragraphs": ["Missing value imputation isn\u2019t that difficult of a task to do. Methods range from simple mean imputation and complete removing of the observation to more advanced techniques like MICE. Nowadays, the more challenging task is to choose which method to use. Today we\u2019ll explore one simple but highly effective way to impute missing data \u2014 the KNN algorithm.", "KNN stands for K-Nearest Neighbors, a simple algorithm that makes predictions based on a defined number of nearest neighbors. It calculates distances from an instance you want to classify to every other instance in the training set. You can learn how to implement it from scratch here:", "We won\u2019t use the algorithm for classification purposes but to fill missing values, as the title suggests. The article will use the housing prices dataset, a simple and well-known one with just over 500 entries. You can download it here.", "The article is structured as follows:", "As mentioned previously, you can download the housing dataset from this link. Also, make sure you have both Numpy and Pandas imported. This is how the first couple of rows look:", "By default, the dataset is very low on missing values \u2014 only five of them in a single attribute:", "Let\u2019s change that. It\u2019s not something you would typically do, but we need a bit more of missing values. To start, let\u2019s create two arrays of random numbers, ranging from 1 to the length of the dataset. The first array has 35 elements, and the second has 20 (arbitrary choice):", "Here\u2019s how the first array looks like:", "Your array will be different because the randomization process is, well, random. Next, we will replace existing values at particular indices with NANs. Here\u2019s how:", "Let\u2019s now check again for missing values \u2014 this time, the count is different:", "That\u2019s all we need to begin with imputation. Let\u2019s do that in the next section.", "The entire imputation boils down to 4 lines of code \u2014 one of which is library import. We need KNNImputer from sklearn.impute and then make an instance of it in a well-known Scikit-Learn fashion. The class expects one mandatory parameter \u2013 n_neighbors. It tells the imputer what\u2019s the size of the parameter K.", "To start, let\u2019s choose an arbitrary number of 3. We\u2019ll optimize this parameter later, but 3 is good enough to start. Next, we can call the fit_transform method on our imputer to impute missing data.", "Finally, we\u2019ll convert the resulting array into a pandas.DataFrame object for easier interpretation. Here\u2019s the code:", "Wasn\u2019t that easy? Let\u2019s check for missing values now:", "As expected, there aren\u2019t any. Still, one question remains \u2014 how do we pick the right value for K?", "This housing dataset is aimed towards predictive modeling with regression algorithms, as the target variable is continuous (MEDV). It means we can train many predictive models where missing values are imputed with different values for K and see which one performs the best.", "But first, the imports. We need a couple of things from Scikit-Learn \u2014 to split the dataset into training and testing subsets, train the model, and validate it. We\u2019ve chosen the Random Forests algorithm for training, but the decision is once again arbitrary. RMSE was used for the validation:", "Here are the steps necessary to perform the optimization:", "It sounds like a lot, but it boils down to around 15 lines of code. Here\u2019s the snippet:", "We can now call the optimize_k function with our modified dataset (missing values in 3 columns) and pass in the target variable (MEDV):", "And that\u2019s it! The k_errors array looks like this:", "It looks like K=15 is the optimal value in the given range, as it resulted in the smallest error. We won\u2019t cover the interpretation of the error, as it\u2019s beyond this article\u2019s scope. Let\u2019s wrap things up in the next section.", "Missing data imputation is easy, at least the coding part. It\u2019s the reasoning that makes it hard \u2014 understanding which attributes should and which shouldn\u2019t be imputed. For example, maybe some values are missing because a customer isn\u2019t using that type of service, making no sense to perform an imputation.", "Consulting with a domain expert and studying the domain is always a way to go. The actual coding is easy.", "Join my private email list for more helpful insights.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Originally published at https://betterdatascience.com on October 21, 2020.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F308e7abd273d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----308e7abd273d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----308e7abd273d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----308e7abd273d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----308e7abd273d--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----308e7abd273d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F308e7abd273d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F308e7abd273d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/stop-using-mean-to-fill-missing-data-678c0d396e22", "anchor_text": "MICE"}, {"url": "https://www.freepik.com/photos/background", "anchor_text": "Background photo"}, {"url": "http://www.freepik.com", "anchor_text": "freepik"}, {"url": "https://towardsdatascience.com/lets-make-a-knn-classifier-from-scratch-e73c43da346d", "anchor_text": "Let\u2019s Make a KNN Classifier from ScratchYou\u2019ll need only Numpy and a bit of time. Source code included.towardsdatascience.com"}, {"url": "https://www.kaggle.com/arslanali4343/real-estate-dataset", "anchor_text": "here"}, {"url": "https://www.kaggle.com/arslanali4343/real-estate-dataset", "anchor_text": "this link"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://betterdatascience.com/impute-missing-data-with-python-and-knn/", "anchor_text": "https://betterdatascience.com"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----308e7abd273d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----308e7abd273d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----308e7abd273d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----308e7abd273d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----308e7abd273d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F308e7abd273d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----308e7abd273d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F308e7abd273d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----308e7abd273d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F308e7abd273d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----308e7abd273d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F308e7abd273d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----308e7abd273d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----308e7abd273d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----308e7abd273d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----308e7abd273d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----308e7abd273d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----308e7abd273d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----308e7abd273d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----308e7abd273d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----308e7abd273d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmissing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}