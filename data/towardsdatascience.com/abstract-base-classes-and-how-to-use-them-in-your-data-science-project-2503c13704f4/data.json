{"url": "https://towardsdatascience.com/abstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4", "time": 1683015172.788579, "path": "towardsdatascience.com/abstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4/", "webpage": {"metadata": {"title": "Abstract base classes and how to use them in your data science project | by Sebastian Dick | Towards Data Science", "h1": "Abstract base classes and how to use them in your data science project", "description": "Have you ever encountered code like this and wondered what\u2019s so abstract about these classes and methods? Well, I\u2019m about to show you! If you stick around long enough I will also share a little trick\u2026"}, "outgoing_paragraph_urls": [{"url": "https://twitter.com/semodi92", "anchor_text": "twitter", "paragraph_index": 35}, {"url": "https://www.linkedin.com/in/sebastianmdick/", "anchor_text": "LinkedIn", "paragraph_index": 35}, {"url": "https://stackoverflow.com/users/17624/thomas-wouters", "anchor_text": "Thomas Wouters", "paragraph_index": 36}], "all_paragraphs": ["Have you ever encountered code like this and wondered what\u2019s so abstract about these classes and methods? Well, I\u2019m about to show you!", "If you stick around long enough I will also share a little trick that you can use to automate unit testing across your classes.", "One key concept of object-oriented programming (OOP) is inheritance. Inheritance means that we base one (child-)class on another (parent-)class. The child class thereby inherits certain properties from its parent while at the same time implementing new ones.", "Let\u2019s look at an example. Imagine you want to write a software library about the animal world. You would perhaps start by defining a class Animal:", "Animal is a very general term, which is why you would like to create more specific classes:", "Writing Animal in parentheses indicates that Dog and Cat inherit from the Animal class. This means that, without having to write it out, both animals automatically implement the __init__ method. In addition, both child classes implement their own methods: \u201cmake_sound\u201d and \u201cpounce\u201d. As a rule of thumb, inheritance makes sense if your two classes fit the sentence \u201cA is a B\u201d: \u201cDog is an Animal\u201d.", "Let\u2019s say you want to implement a lion class. Lions are cats, so we would want the class to inherit from Cat. Doing so, the methods that Cat inherited from Animal carry over to Lion as well", "The class Lion now has three methods: __init__, pounce and make_sound. By redefining make_sound in the Lion class we have overwritten the version inherited from Cat.", "Abstract base classes (ABC) provide a way to regulate this inheritance and at the same time structure your code. An ABC can be seen as the scaffolding or template (not to be confused with actual templates, think: C++!) for all classes inheriting from it.", "In Python, one can define an ABC by inheriting from abc.ABC:", "An ABC is not meant to be instantiated, i.e. one should not (and in certain cases cannot) create objects of an ABC.", "So, why bother using abstract base classes at all? Because, as I said before, they add structure and safety to your project. The ABC \u201cAnimal\u201d tells future developers working on your code (or future you) how any class inheriting from Animal should operate. To do so, ABCs have a tool at their disposal:", "An abstract method is a method that has to be implemented by any class inheriting from the ABC.", "We could, e.g. decide that every animal in our code has to be able to make some kind of sound. We can then define:", "If we try to instantiate any child-class that does not implement the abstract method, we get the following error:", "At the beginning of a new project, a developer should pause and consider which methods are absolutely necessary for a class to operate properly. These methods should be declared abstract methods to avoid unexpected runtime errors in the future.", "In my opinion this is especially important in non-compiled languages such as Python, which can be notoriously fragile to these errors.", "Many popular data science and machine learning library use abstract base classes. One of those libraries is scikit-learn. The code snippet at the beginning of this post contains scikit-learn\u2019s implementation of a \u201cKernel\u201d base class. Kernels are used in Support Vector Machines, Kernel Ridge and Gaussian Process methods among others. They can be seen as a distance metric between two vectors. You might be familiar with the Radial Basis Function (RBF) or squared exponential kernel", "but many others exist and are implemented in scikit-learn.", "What all these kernels have in common, is that (in scikit-learn) they inherit from the Kernel ABC:", "By making __call__, and is_stationary abstract methods, scikit-learn ensures that every new kernel will implement theses methods. At least in the case of __call__(self, X, Y), this is very reasonable, as a function to evaluate the kernel on two input matrices is absolutely necessary. Without it, the kernel would not have much use.", "Wouldn\u2019t it be great to automatically generate unit-tests for every new child of the Kernel class?", "By creating a so-called registry we only need to implement a single unit-test once to apply it across our classes (one can do other fun things with registries, but I won\u2019t get into any details here).", "A registry simply keeps track of all the classes you create. To implement a registry in Python, we need to use meta-classes.", "One way to look at it is the following:", "While a class tells Python how an instance of a class behaves, a meta-class defines the behavior of the class itself. [1]", "So, by using a meta-class we can tell Python: \u201cCreate a new entry in the registry whenever a new class is implemented\u201d", "If all this sounds very confusing, you can also just copy paste the following code into your project:", "(Note that in principle the registry does not have to inherit from ABCMeta but it usually makes sense to combine the two.)", "Let\u2019s go back to our Kernel example. Instead of inheriting from ABC, we now write", "By creating the attribute _registry_name, we tell our registry how to call the classes. Accessing the registry will produce the following output:", "Let\u2019s say we want to test whether the kernels we implemented are symmetric:", "Every valid kernel has to obey this condition, so it makes perfect sense to test for it.", "Using pytest and its parametrize functionality we can now automatically apply the test to every class that inherits from \u201cKernel\u201d:", "Of course, one could always explicitly loop over all relevant classes. The use of a registry has the advantage that contributors adding new classes don\u2019t need to worry about adding entries to the appropriate tests as well.", "If you enjoyed this article please feel free to follow me here, on twitter or connect on LinkedIn.", "[1] Loosely based on Thomas Wouters\u2019 explanation on stackoverflow.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Physics PhD student using machine learning to study molecules and materials. Always striving to learn more about data science and statistics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2503c13704f4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2503c13704f4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2503c13704f4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sebastiandick42?source=post_page-----2503c13704f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sebastiandick42?source=post_page-----2503c13704f4--------------------------------", "anchor_text": "Sebastian Dick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa6e6f577a7bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&user=Sebastian+Dick&userId=a6e6f577a7bc&source=post_page-a6e6f577a7bc----2503c13704f4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2503c13704f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2503c13704f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://twitter.com/semodi92", "anchor_text": "twitter"}, {"url": "https://www.linkedin.com/in/sebastianmdick/", "anchor_text": "LinkedIn"}, {"url": "https://stackoverflow.com/users/17624/thomas-wouters", "anchor_text": "Thomas Wouters"}, {"url": "https://medium.com/tag/programming?source=post_page-----2503c13704f4---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2503c13704f4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/best-practices?source=post_page-----2503c13704f4---------------best_practices-----------------", "anchor_text": "Best Practices"}, {"url": "https://medium.com/tag/oop?source=post_page-----2503c13704f4---------------oop-----------------", "anchor_text": "Oop"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2503c13704f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&user=Sebastian+Dick&userId=a6e6f577a7bc&source=-----2503c13704f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2503c13704f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&user=Sebastian+Dick&userId=a6e6f577a7bc&source=-----2503c13704f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2503c13704f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2503c13704f4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2503c13704f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2503c13704f4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2503c13704f4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2503c13704f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2503c13704f4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2503c13704f4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2503c13704f4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2503c13704f4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2503c13704f4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2503c13704f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sebastiandick42?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sebastiandick42?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sebastian Dick"}, {"url": "https://medium.com/@sebastiandick42/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "112 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa6e6f577a7bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&user=Sebastian+Dick&userId=a6e6f577a7bc&source=post_page-a6e6f577a7bc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F173d000ac8a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fabstract-base-classes-and-how-to-use-them-in-your-data-science-project-2503c13704f4&newsletterV3=a6e6f577a7bc&newsletterV3Id=173d000ac8a4&user=Sebastian+Dick&userId=a6e6f577a7bc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}