{"url": "https://towardsdatascience.com/build-evaluation-framework-for-forecast-models-fbc1bd775edd", "time": 1683011492.020048, "path": "towardsdatascience.com/build-evaluation-framework-for-forecast-models-fbc1bd775edd/", "webpage": {"metadata": {"title": "Build Evaluation Framework for Forecast Models | by Ajay Tiwari | Towards Data Science", "h1": "Build Evaluation Framework for Forecast Models", "description": "The goal of any time series forecasting model is to make accurate predictions. The popular machine learning evaluation techniques like train-test split and k-fold cross-validation do not work on the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "systematic", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html", "anchor_text": "sci-kit-learn", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "sliding", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "expanding", "paragraph_index": 28}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "previous", "paragraph_index": 74}], "all_paragraphs": ["The goal of any time series forecasting model is to make accurate predictions. The popular machine learning evaluation techniques like train-test split and k-fold cross-validation do not work on the time-series data in their current form. As we discussed in the previous article time series data expects an order dependence between observations, whereas, in other machine learning datasets, all observations are treated equally.", "In this tutorial, we are going to explore various evaluation techniques applied to time series data.", "To begin with, let\u2019s download the following dataset, open a Jupyter notebook, and import these python libraries.", "At first glance, we might think it is best to select a model that generates the best forecast on the data at hand, which we used to train our model. When we deploy this model for business use, we observe a significant reduction in forecast accuracy. This scenario is also known as overfitting, which means that the model is not only fitting the systematic component of the data, but also the noise.", "Thus, the accuracy of forecasts can only be determined by measuring performance on new data that were not used when fitting the model.", "We can address this overfitting problem by data partitioning, an important preliminary step before applying any forecasting method.", "In machine learning problems, often we split our data into training and test set, where the training dataset is used to build the model and the test dataset is used to evaluate model performance. We also use an advanced version of this split called k-fold cross-validation, where we systematically split data into k groups and each group was given a chance to evaluate the model, which was developed using remaining k-1 groups.", "These methods can not be used directly with time-series data similar to other machine learning problems, which means we cannot randomly split the dataset into training and test groups. Instead, we have to split the series into two time-periods maintaining the temporal order of the series.", "The evaluation of time series forecasting using historical data is also known as backtesting. Let\u2019s discuss these methods with our \u2018airline-passengers\u2019 dataset.", "We can split our dataset into training and test subsets, the model can be developed on the training dataset and its performance can be evaluated on the test dataset. This can be done by selecting a split point on the sequential observations (e.g., 60:40,70:30 or 80:20) based on the length of the time series available.", "For example, if we have monthly data for a year and we want a 66.66:33.33 split, the first 8 months can be used as training, and the last 4 months can be used as the testing dataset.", "Let\u2019s understand this with the following example, there are a total of 20 time periods, the first 15 (blue points) can be used to train the model and the last 5 (red points) can be used to validate the forecasting accuracy.", "This train-test proportion varies according to your data and business need, there is no fixed rule around this split. Just we have to make sure that we have sufficient data in hand to train the model.", "Python can help us quickly splitting this dataset into training and test subsets. We can specify a split point as a percentage in the array, all observations up to the split point are taken as a training dataset and all observations from that point to the end of the series are taken as test dataset.", "Let\u2019s visualize this split on a line plot using different colors, the training dataset and test dataset are displayed with blue and orange colors respectively.", "We can split the time series into multiple training and test datasets to train an ensemble model for a more robust estimate. This approach requires multiple models to be developed using respective splits. This could be done manually by repeating the above process.", "For example, we have a dataset with 20 observations at 20 time periods, we can create 3 different train-test splits as below.", "These splits can be used to build 3 different models and output can be averaged out to get a robust prediction.", "In Python, the sci-kit-learn library can help us with its TimeSeriesSplit function to create multiple splits, just we need to specify the number of splits.", "As per sci-kit-learn official page, the total number of training and test observations are calculated in each split iteration (i) as follows:", "Where \u2018n_samples\u2019 is the total number of observations and \u2018n_splits\u2019 is the total number of splits. Assume we have 100 observations and wanted to create 3 splits.", "Let\u2019s apply above arithmetic to calculate the training and test dataset sizes.", "Now we can implement TimeSeriesSplit function on our \u2018airline-passengers\u2019 dataset and partition our datasets. The dataset has 144 observations and we want 3 different splits. As per above calculations, we would expect following number of observations in respective splits.", "We can see number of observations are as per our expectations in each split.", "A more sophisticated version of training and test split is time-series cross-validation, this is also known as walk-forward validation as it involves moving along the time series one-time step at a time. This approach provides the best opportunity to make forecasts at each time step.", "Let\u2019s see in the following example how different splits of a dataset is moving forward along with the time series.", "The forecast accuracy is estimated by averaging across test sets. Before creating this validation framework we have to decide which historical observations we are interested in.", "First, we must decide the minimum number of observations required to train our model, i.e., window width.", "Next, we must decide whether we want a sliding window (most recent observations) or an expanding window (all historical observations).", "After deciding on these requirements, now let\u2019s implement this splitting method on our \u2018airline-passengers\u2019 dataset.", "We can see that many more splits are created and we can train an equally high number of models. Again, this will help us in providing a much more robust estimation. Walk- forward method is considered to best model evaluation, this is also known as k-fold cross-validation of time series world.", "The goal of any time series forecasting model is to make accurate forecasts, but the question is how we can measure and compare the predictive accuracy. Therefore, as a preliminary requirement, we have to define a suitable performance metrics that measure predictive accuracy.", "There are many different performance measures to choose from, in this section we are going to discuss some of the popular measures.", "Consider a validation dataset with \u2018v\u2019 periods, t=1,\u2026v. The forecast error (e\u209c) is defined as the difference between an observed value (x\u209c)and the predicted value (y\u209c) at a time-period (t).", "The forecast error can be calculated for each prediction, let\u2019s see how we can calculate this error in Python.", "Does this solve our problem of evaluation? Not yet, we have to summarize these errors as a single comparable number.", "Let\u2019s discuss a few popular measures of predictive accuracy.", "The mean forecast error is calculated as the average of the forecast error values.", "As we know forecast errors can be positive and negative and this performance measure is calculated as the average of these forecast errors, so an ideal mean forecast error for a series would be zero. Error-values away from zero are considered as bias.", "Let\u2019s see how we can manually calculate the mean forecast error in Python using a dummy actual and predicted values.", "The mean absolute error, or MAE, is calculated as the average of the forecast error values, where all of the forecast values are forced to be positive.", "We can manually calculate in Pythion using mean_absolute_error function.", "The mean absolute percentage error or MAPE give a percentage score of how forecasts deviate from the actual values. It is useful for comparing performance across multiple series that have different scales.", "There is no inbuilt function in sci-kit learn, we can use a custom function to calculate this measure.", "The mean squared error, or MSE, is calculated as the average of the squared forecast error values. Squaring the forecast error values forces errors to be positive. Thus, this measure puts more weight on large errors.", "We can calculate this measure using the mean_squared_error function of sci-kit learn in Python.", "The root mean squared error, or RMSE, is the transformed version of mean squared error. It can be calculated by taking the square root of the mean squared error value.", "In Python, this can be calculated by using the sqrt() function of the math library on the mean squared error calculated above.", "We have partitioned our dataset into training and test subsets, we have also defined an ideal performance measure for evaluating our model. Now, we are all set to start with the modeling exercise, we can choose any of the available advanced algorithms to model the time series.", "But, how can we trust the forecasting accuracy of that model? Do we have any benchmark accuracy in mind?", "Let\u2019s establish a baseline forecast performance which we can use as a point of reference while evaluating the performance of different techniques. We can improve the model if its accuracy is as at par or below the baseline, in case we fail to achieve the desired accuracy, we can explore other techniques.", "The most common baseline method for time series forecasting is the Naive forecast, this is simply the latest value of the series that is available at the time of prediction. The naive algorithm uses the value at the current time step (t) to predict the expected outcome at the next time step (t+1).", "Let\u2019s implement a Naive forecast in Python.", "Let's transform our \u2018airline-passengers\u2019 dataset into a supervised learning problem, we can achieve this by creating a lag feature. In this transformed dataset, values at (t) are predictors (X) and values at (t+1) are the target variable (Y).", "We have to discard the first row as it doesn't have any input value.", "Next, we can split the dataset into training and test subsets as below. 70% of the series created as training and 30% as a test subset.", "It\u2019s fairly simple to set up a baseline model. We know the naive algorithm uses the value at the current time step (t) to predict the expected outcome at the next time step (t+1). Therefore, in our transformed supervised version of the dataset, the first column is the prediction for the second column. We have to discard the first row of the dataset as it doesn\u2019t have any input value.", "As a final step, we can evaluate our baseline model on the test dataset. In this case, no model training or retraining is required, we know the first column is prediction and the second column is the actual number. We walk through the test dataset time step by time step and get predictions.", "We can observe the line plot of this forecast which shows training set in blue, the test set in green, and predictions in red color.", "Looking at the line plot we can see a decent prediction on the test dataset. We have to maintain or improve this accuracy when we explore other advanced techniques.", "We are ready with our baseline model, now its time to investigate the goodness of fit using forecast errors. These errors on time series problems are called residuals or residual errors. Analyzing the residual error of our model can explain a lot about our forecast and even suggest improvements.", "Let\u2019s recalculate the residuals of our naive forecast on the same dataset to explore further in this section.", "We can see the example output of the first five forecast errors. Let's visualize these numbers for a meaningful interpretation.", "The first plot is to look at the residuals over time as a line plot. We would not expect any trend and cyclic behavior if the model is fitted well, the plot should be random around the value of 0.", "We can still observe a cyclic behavior in the line plot which suggests a scope of improvement in the model which can be achieved by better feature engineering and exploring other advanced models.", "Next, we can analyze summary statistics on the residual errors. Primarily, we are interested in the mean value of the residual errors. A value close to zero suggests no bias in the forecasts, whereas positive and negative values suggest a positive or negative bias in the forecasts.", "Summary statistics also suggest a positive bias in the model.", "These plots can be used to better understand the distribution of errors beyond summary statistics. We would expect the forecast errors to be normally distributed around a zero mean. Plots can help discover skews in this distribution. We can use both histograms and density plots to better understand the distribution of residual errors.", "It can be clearly observed residuals are not distributed normally, they are negatively skewed. Again, this confirms that our model needs improvement.", "This is also called a quantile plot, can be used to check the normality of the distribution of residuals. The values are ordered and compared to an idealized Gaussian distribution on a scatter plot. We expect all the dots to overlap the diagonal line to confirm a complete match between the two distributions.", "We can see some bumps and outliers on the Q-Q plot which need to be corrected in order to achieve a better forecast.", "Autocorrelation explains the strength of the relationship between observation and observations at prior time steps. We would not expect there to be any correlation left between the residuals. Let\u2019s calculate and plot the autocorrelation of the residual errors.", "We can see autocorrelation still exists in the residuals which validate our finding that model require improvement in terms of feature engineering and choice of algorithms.", "In this article, we have discussed all the important techniques to construct a robust evaluation framework. We started with data partitioning, then discussed a wide range of performance measures to choose from, established a persistence forecast model as a benchmark to enhance the accuracy, and finally learned about model investigation using residuals.", "After data preparation (covered in my previous article) and having a robust evaluation framework in place, now we are completely prepared to explore various forecasting techniques. In the next few articles, I will be discussing different forecasting techniques, I will start with classical techniques.", "Thanks for reading, hope you found this article informative.", "[1] Galit Shmueli and Kenneth Lichtendahl, Practical Time Series Forecasting with R: A Hands-On Guide, 2016.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffbc1bd775edd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ajaytiwari.ib?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajaytiwari.ib?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": "Ajay Tiwari"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6cd36cd3bec9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=post_page-6cd36cd3bec9----fbc1bd775edd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbc1bd775edd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbc1bd775edd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "article"}, {"url": "https://jovian.ml/ajaytiwari-isb/time-series-model-evaluation-46ffd/v/1/files/airline-passengers.csv", "anchor_text": "airline-passengers.csv"}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "systematic"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html", "anchor_text": "sci-kit-learn"}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "sliding"}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "expanding"}, {"url": "https://towardsdatascience.com/time-series-forecasting-968192b3781a", "anchor_text": "previous"}, {"url": "https://machinelearningmastery.com/", "anchor_text": "https://machinelearningmastery.com/"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fbc1bd775edd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fbc1bd775edd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fbc1bd775edd---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----fbc1bd775edd---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/analytics?source=post_page-----fbc1bd775edd---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffbc1bd775edd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=-----fbc1bd775edd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffbc1bd775edd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=-----fbc1bd775edd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbc1bd775edd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffbc1bd775edd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fbc1bd775edd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fbc1bd775edd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajaytiwari.ib?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ajaytiwari.ib?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ajay Tiwari"}, {"url": "https://medium.com/@ajaytiwari.ib/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "258 Followers"}, {"url": "https://www.linkedin.com/in/ajtiwari/", "anchor_text": "https://www.linkedin.com/in/ajtiwari/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6cd36cd3bec9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=post_page-6cd36cd3bec9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F12278ac13bbe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-evaluation-framework-for-forecast-models-fbc1bd775edd&newsletterV3=6cd36cd3bec9&newsletterV3Id=12278ac13bbe&user=Ajay+Tiwari&userId=6cd36cd3bec9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}