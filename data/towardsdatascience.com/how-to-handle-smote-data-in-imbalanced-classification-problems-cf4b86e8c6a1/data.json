{"url": "https://towardsdatascience.com/how-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1", "time": 1683006660.277436, "path": "towardsdatascience.com/how-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1/", "webpage": {"metadata": {"title": "How to Handle SMOTE Data in Imbalanced Classification Problems | by Steven Dye | Towards Data Science", "h1": "How to Handle SMOTE Data in Imbalanced Classification Problems", "description": "Classification problems are quite common in the data science world. Whether it is fraud detection, sentiment analysis, or disease testing, being able to predict what group a particular data point is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_breast_cancer.html", "anchor_text": "breast cancer dataset", "paragraph_index": 4}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html", "anchor_text": "documentation", "paragraph_index": 15}, {"url": "https://www.linkedin.com/in/stevenpdye/", "anchor_text": "https://www.linkedin.com/in/stevenpdye/", "paragraph_index": 19}], "all_paragraphs": ["Classification problems are quite common in the data science world. Whether it is fraud detection, sentiment analysis, or disease testing, being able to predict what group a particular data point is in is incredibly powerful.", "Usually the focus is on detecting data points in the minority group, and that can present some common problems. Typically in situations like this the data you have collected is imbalanced, meaning that the target you are interested in has significantly smaller amounts of data than the other groups. This imbalance in your data will cause your model to become bias towards selecting the majority group. When dealing with imbalanced data sets there are three common techniques to balance the data:", "This blog post will take a look at one kind of over-sampling technique, called the SMOTE method.", "SMOTE (Synthetic Minority Over-sampling Technique) is a type of over-sampling procedure that is used to correct the imbalances in the groups. This technique creates new data instances of the minority groups by copying existing minority instances and making small changes to them. This makes SMOTE great at amplifying signals that already exist in the minority groups, but won\u2019t create new signals for those groups.", "Let\u2019s take a look at some classification data that hasn\u2019t been balanced with SMOTE. We\u2019ll use the breast cancer dataset from the sci-kit learn library. Let\u2019s import the necessary packages, import our data, and create a function that can evaluate our models.", "From here we\u2019ll perform a train-test split on our data and initialize our base model.", "Reminder: it is important to set a random state in the train-test split function in order to be certain that any changes in your model\u2019s performance is due to changes that you have made, and not due to the random seed. The stratify parameter splits the data according to the input parameter, in this case y. This means that your training and test sets will have the same percentage of samples for each group.", "Now let\u2019s see how our base model performed.", "Overall we see that our base model does a reasonable job at modeling the data, but let\u2019s see if we can use SMOTE to improve the performance.", "Now, when dealing with synthetic data, the first rule is:", "Don\u2019t put synthetic data in your testing data!", "We want to implement our model on live data, so we want to see how our model will perform on real data and not the synthetic data that we have created. This means that we can only add the synthetic data to the training set. We can do that with the following code:", "From here we can train our model on the training data with SMOTE included.", "As we can see, our model was able to more accurately predict the testing data with the SMOTE data included. However, one issue that causes concern is our cross validation score. The cross validation score is used to evaluate your model on a limited set of data in order to predict how the model will perform on real world data. Ideally we want our cross validation score to be the same or near our testing score. In this case, our scores are diverging because we broke the second rule in dealing with synthetic data, which is:", "Don\u2019t put synthetic data in your validation data!", "Just like with our testing data, we want to validate our model using only real data. This means that we only want our SMOTE data in the training folds and not in the validation folds. An example of how to add synthetic data to each individual fold can be found in the sci-kit learn documentation using the StratifiedKFold function.", "Fortunately for us, there is an imbalenced-learn module that can do all of the data handeling for us, the pipeline module. Just include the SMOTE process and your model into the pipeline and the module will handle the rest. You can use either the Pipeline or make_pipeline function for this task.", "As we can see, our cross validation score now more accurately reflects the actual performance that we can expect from our model in the the real world. Hopefully this blog helps you in implementing your model into the real world.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Physics Ph.D. living in the data science world. https://www.linkedin.com/in/stevenpdye/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcf4b86e8c6a1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@steven.p.dye?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@steven.p.dye?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": "Steven Dye"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d9bcaf8406a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&user=Steven+Dye&userId=3d9bcaf8406a&source=post_page-3d9bcaf8406a----cf4b86e8c6a1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf4b86e8c6a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf4b86e8c6a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_breast_cancer.html", "anchor_text": "breast cancer dataset"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html", "anchor_text": "documentation"}, {"url": "https://medium.com/tag/data-science?source=post_page-----cf4b86e8c6a1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cf4b86e8c6a1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----cf4b86e8c6a1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/smote?source=post_page-----cf4b86e8c6a1---------------smote-----------------", "anchor_text": "Smote"}, {"url": "https://medium.com/tag/imbalanced-data?source=post_page-----cf4b86e8c6a1---------------imbalanced_data-----------------", "anchor_text": "Imbalanced Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf4b86e8c6a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&user=Steven+Dye&userId=3d9bcaf8406a&source=-----cf4b86e8c6a1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf4b86e8c6a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&user=Steven+Dye&userId=3d9bcaf8406a&source=-----cf4b86e8c6a1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf4b86e8c6a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcf4b86e8c6a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cf4b86e8c6a1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cf4b86e8c6a1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@steven.p.dye?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@steven.p.dye?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Steven Dye"}, {"url": "https://medium.com/@steven.p.dye/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "181 Followers"}, {"url": "https://www.linkedin.com/in/stevenpdye/", "anchor_text": "https://www.linkedin.com/in/stevenpdye/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d9bcaf8406a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&user=Steven+Dye&userId=3d9bcaf8406a&source=post_page-3d9bcaf8406a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2a2119178c2f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-smote-data-in-imbalanced-classification-problems-cf4b86e8c6a1&newsletterV3=3d9bcaf8406a&newsletterV3Id=2a2119178c2f&user=Steven+Dye&userId=3d9bcaf8406a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}