{"url": "https://towardsdatascience.com/how-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9", "time": 1683003229.919321, "path": "towardsdatascience.com/how-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9/", "webpage": {"metadata": {"title": "How to Insert Records and Do Conditional Delete for DynamoDB Using Python and Boto3 Library | by billydharmawan | Towards Data Science", "h1": "How to Insert Records and Do Conditional Delete for DynamoDB Using Python and Boto3 Library", "description": "It is very common to have many junk or dummy records in our DynamoDB table for testing purposes. It may be an application we are developing or even just a function. It can also be some records that\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/better-programming/how-to-set-up-a-local-dynamodb-in-a-docker-container-and-perform-the-basic-putitem-getitem-38958237b968", "anchor_text": "tutorial", "paragraph_index": 12}], "all_paragraphs": ["It is very common to have many junk or dummy records in our DynamoDB table for testing purposes. It may be an application we are developing or even just a function. It can also be some records that our existing application generates but, actually, they have no values. Regardless of what it is, we end up creating many records in our database.", "Every now and then, we want to clean up our database tables, so only valuable and meaningful records are stored. For example, we did a load testing to test the user account creation API in our application. This obviously resulted in many records in the table, which are just \u201ctest\u201d records. All these \u201ctest\u201d records have the characteristics of the email starting with testing and last name starting with TEST. You know, whatever. \ud83d\ude06 These records, obviously, can be removed from the table once we finish our load testing.", "In this tutorial, you will learn how to use Python to insert items and conditionally delete items from your DynamoDB table, which you do not want to keep anymore, for whatever reasons it may be. We are going to use the official AWS SDK library for Python, which is known as Boto3.", "I am not going to do a detailed walkthrough on this but will show you quickly how to do it via virtualenv.", "First things first, you need to install virtualenv via pip3 if you haven\u2019t already. It is as simple as:", "Then, create a directory where you want to put your project file (or in this case, the Python script).", "Go to the directory and create the virtual environment in there.", "Lastly, we want to active the virtual environment. Just a quick reminder, a virtual environment is really useful as it isolates your development from the rest of your machine. Think of it like a container, where all the dependencies are provided within the virtual environment and accessible only from within the environment.", "Notice the (venv). This indicates that you are in the virtual environment. You may not see that, though, depending on your terminal\u2019s settings. So, as an alternative, here\u2019s why you can validate whether your virtual environment is active or not.", "You can see that the Python and pip executables are the one from our virtual environment. All is good. \ud83d\ude42", "The only dependency for this tutorial is the Boto3 library. So, let\u2019s go ahead and install it within our virtual environment.", "Once you have completed the pre-requisites, we\u2019re ready to do the fun stuff, which is writing the actual script that will do the batch delete of our junk records.", "To help us see how the script works, we will spin up a local DynamoDB instance in a Docker container. You can follow this tutorial to achieve this.", "Essentially, what you need to do is spin up the DynamoDB Docker and create the table demo-customer-info as written in the tutorial.", "Let\u2019s create dummy records so we can see how the batch operation works. To do this, we are going to write a Python script that calls the DynamoDB PutItem operation in a loop. Create a new Python file in batch-ops-dynamo and name it insert_dummy_records.py.", "As mentioned in the Introduction section earlier, our dummy records will have the following traits:", "Our script will have the following components:", "We also leverage random.randint method to generate some random integers to be added to our dummy records\u2019 attributes, which are:", "Our script looks good! Now, it\u2019s time for us to run it from the command line, using the Python executable from our virtual environment.", "Ok. The script seems to work as expected. Hooray! \ud83d\ude04", "Let\u2019s validate by calling the scan operation on our local DynamoDB demo-customer-info table to check the records.", "Perfect! We have some dummy records in our table now.", "We\u2019ll quickly insert 2 records that are \u201creal\u201d to the table. To do this, we are just going to write another Python script that takes command line argument as its input. Let\u2019s name the file insert_real_record.py.", "The content of the file will be as follows.", "Let\u2019s go ahead and insert 2 records to the table.", "Finally, we are going to write the script that deletes records that meet some specified conditions from our table.", "Again, as a reminder, we want to remove the dummy records we inserted. The filter that we need to apply is last name begins with TEST and email address begins with testing.", "Go ahead and run this script from the command line.", "Great! The script works as intended. Now, let\u2019s check the remaining records in our table.", "There are only 2 records remaining, which are the \u201creal\u201d records we inserted. We can be certain now that our delete_records_conditionally.py script does what it is intended for.", "Let\u2019s take a look at a few things from the delete_records_conditionally.py script we just wrote.", "Notice that we have a deserializer and we use it to get the customerId. The reason is because, the scan operation actually returns something like this.", "Since we are only interested in the value of customerId, we need to deserialise the DynamoDB item using the TypeDeserializer that is provided by the Boto3 library.", "Another component worth mentioning is the Select and ProjectionExpression, which are parameters of the scan function. These 2 parameters work hand-in-hand. We set the value of Select to SPECIFIC_ATTRIBUTES and according to the official Boto3 documentation, this will return only the attributes listed in AttributesToGet. AttributesToGet has been marked as a legacy parameter and AWS advises us to use ProjectionExpression, instead.", "\u201cIf you use the ProjectionExpression parameter, then the value for Select can only be SPECIFIC_ATTRIBUTES . Any other value for Select will return an error.\u201d", "These 2 parameters are basically saying that the scan operation should only return the customerId attribute, which is what we need.", "Lastly, we use the begins_with() function that is provided by AWS. This function takes an attribute name and the prefix to check against the value of the attribute specified.", "By this point, you will have learnt how to do insert and delete DynamoDB records with Python and Boto3. You can certainly adjust and modify the script to suit your needs. For instance, the filter expression used in this tutorial is relatively simple, you can add more complex conditions, if need be.", "Anyways, I hope this tutorial has given you a basic understanding of how to do DynamoDB operation using Python. So, go ahead and be creative, taking this script and enhance it to do more advanced stuff. Happy hacking! \ud83d\ude42", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "An ordinary man trying to leave a good legacy on earth"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3303f74c18b9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://billydharmawan.medium.com/?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": ""}, {"url": "https://billydharmawan.medium.com/?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": "billydharmawan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F201d9c61a29a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&user=billydharmawan&userId=201d9c61a29a&source=post_page-201d9c61a29a----3303f74c18b9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3303f74c18b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3303f74c18b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@daniel_von_appen?utm_source=medium&utm_medium=referral", "anchor_text": "Daniel von Appen"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/better-programming/how-to-set-up-a-local-dynamodb-in-a-docker-container-and-perform-the-basic-putitem-getitem-38958237b968", "anchor_text": "tutorial"}, {"url": "http://localhost:8042", "anchor_text": "http://localhost:8042"}, {"url": "http://localhost:8042", "anchor_text": "http://localhost:8042"}, {"url": "https://github.com/billydh/batch-ops-dynamodb", "anchor_text": "repo"}, {"url": "https://unsplash.com/@antogabb?utm_source=medium&utm_medium=referral", "anchor_text": "Antonio Gabola"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3303f74c18b9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/technology?source=post_page-----3303f74c18b9---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/programming?source=post_page-----3303f74c18b9---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/software-development?source=post_page-----3303f74c18b9---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/python?source=post_page-----3303f74c18b9---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3303f74c18b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&user=billydharmawan&userId=201d9c61a29a&source=-----3303f74c18b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3303f74c18b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&user=billydharmawan&userId=201d9c61a29a&source=-----3303f74c18b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3303f74c18b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3303f74c18b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3303f74c18b9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3303f74c18b9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3303f74c18b9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3303f74c18b9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3303f74c18b9--------------------------------", "anchor_text": ""}, {"url": "https://billydharmawan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://billydharmawan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "billydharmawan"}, {"url": "https://billydharmawan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "509 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F201d9c61a29a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&user=billydharmawan&userId=201d9c61a29a&source=post_page-201d9c61a29a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8ac392f5a205&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-insert-records-and-do-conditional-delete-for-dynamodb-using-python-and-boto3-library-3303f74c18b9&newsletterV3=201d9c61a29a&newsletterV3Id=8ac392f5a205&user=billydharmawan&userId=201d9c61a29a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}