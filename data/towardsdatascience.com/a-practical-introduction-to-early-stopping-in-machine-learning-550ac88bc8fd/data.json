{"url": "https://towardsdatascience.com/a-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd", "time": 1683011725.4875891, "path": "towardsdatascience.com/a-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd/", "webpage": {"metadata": {"title": "Early Stopping in Practice: an example with Keras and TensorFlow 2.0 | by B. Chen | Towards Data Science", "h1": "Early Stopping in Practice: an example with Keras and TensorFlow 2.0", "description": "In this article, we will focus on adding and customizing Early Stopping in our machine learning model and look at an example of how we do this in practice with Keras and TensorFlow 2.0. In machine\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/machine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e", "anchor_text": "regularization techniques", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/machine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e", "anchor_text": "model regularization", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/batch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f", "anchor_text": "batch normalization", "paragraph_index": 8}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/005-early-stopping/early-stopping.ipynb", "anchor_text": "machine learning repo", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Anderson Iris flower (iris)", "paragraph_index": 13}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "UCI Iris dataset", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "anchor_text": "one-hot encoding", "paragraph_index": 17}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and TensorFlow 2.0", "paragraph_index": 22}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github", "paragraph_index": 46}], "all_paragraphs": ["In this article, we will focus on adding and customizing Early Stopping in our machine learning model and look at an example of how we do this in practice with Keras and TensorFlow 2.0.", "In machine learning, early stopping is one of the most widely used regularization techniques to combat the overfitting issue.", "Early Stopping monitors the performance of the model for every epoch on a held-out validation set during the training, and terminate the training conditional on the validation performance.", "Early Stopping is a very different way to regularize the machine learning model. The way it does is to stop training as soon as the validation error reaches a minimum. The figure below shows a model being trained.", "As the epochs go by, the algorithm leans and its error on the training set naturally goes down, and so does its error on the validation set. However, after a while, the validation error stops decreasing and actually starts to go back up. This indicates that the model has started to overfit the training data. With Early Stopping, you just stop training as soon as the validation error reaches the minimum.", "It is such a simple and efficient regularization technique that Geoffrey Hinton called it a \u201cbeautiful free lunch.\u201d [1].", "With Stochastic and Mini-batch Gradient Descent, the curves are not so smooth, and it may be hard to know whether you have reached the minimum or not. One solution is to stop only after the validation error has been above the minimum for some time (when you are confident that the model will not do any better), then roll back the model parameters to the point where the validation error was at a minimum.", "In the following article, we are going to add and customize Early Stopping in our machine learning model.", "We will be using the same dataset as we did in the model regularization and batch normalization. You can skip this chapter if you are already familiar with it.", "In order to run this tutorial, you need to install", "TensorFlow 2, numpy, pandas, sklean, matplotlib", "They can all be installed directly vis PyPI and I strongly recommend to create a new Virtual Environment. For a tutorial on creating a Python virtual environment", "This is a step by step tutorial and all instructions are in this article. For source code, please check out my Github machine learning repo.", "This tutorial uses the Anderson Iris flower (iris) dataset for demonstration. The dataset contains a set of 150 records under five attributes: sepal length, sepal width, petal length, petal width, and class (known as target from sklearn datasets).", "First, let\u2019s import the libraries and obtain iris dataset from scikit-learn library. You can also download it from the UCI Iris dataset.", "For the purpose of exploring data, let\u2019s load data into a DataFrame", "And the df should look like below:", "We notice the label column is a categorical feature and will need to convert it to one-hot encoding. Otherwise, our machine learning algorithm won\u2019t be able to directly take in that as input.", "Now, the df should look like:", "Next, let\u2019s create X and y. Keras and TensorFlow 2.0 only take in Numpy array as inputs, so we will have to convert DataFrame back to Numpy array.", "Finally, let\u2019s split the dataset into a training set (80%)and a test set (20%) using train_test_split() from sklearn library.", "Great! our data is ready for building a Machine Learning model.", "There are 3 ways to create a machine learning model with Keras and TensorFlow 2.0. Since we are building a simple fully connected neural network and for simplicity, let\u2019s use the easiest way: Sequential Model with Sequential().", "Let\u2019s go ahead and create a function called create_model() to return a Sequential model.", "Our model has the following specifications:", "In order to train a model, we first have to configure our model using compile() and pass the following arguments:", "After that, we can call model.fit() to fit our model to the training data.", "If all runs smoothly, we should get an output like below", "Finally, let\u2019s plot the loss vs. epochs graph on the training and validation sets.", "It is preferable to create a small function for plotting metrics. Let\u2019s go ahead and create a function plot_metric().", "By running plot_metric(history, 'loss') to get a picture of loss progress.", "From the above graph, we can see that the model has overfitted the training data, so it outperforms the validation set.", "The Keras module contains a built-in callback designed for Early Stopping [2].", "First, let\u2019s import EarlyStopping callback and create an early stopping object early_stopping .", "EarlyStopping() has a few options and by default:", "Next, we just need to pass the callback object to model.fit() method.", "You can see that early_stopping get passed in a list to the callbacks argument. It is a list because in practice we might be passing a number of callbacks for performing different tasks, for example debugging and learning rate scheduler.", "By executing the statement, you should get an output like below:", "Note: your output can be different due to the different weight initialization.", "The training gets terminated at Epoch 6 due to the increase of val_loss value and that is exactly the conditions monitor='val_loss' and patience=0.", "It\u2019s often more convenient to look at a plot, let\u2019s run plot_metric(history, 'loss') to get a clear picture. In the below graph, validation loss is shown in orange and it\u2019s clear that validation error increases at Epoch 6.", "Apart from the options monitor and patience we mentioned early, the other 2 options min_delta and mode are likely to be used quite often.", "And here is an example of a customized early stopping:", "monitor='val_accuracy' to use validation accuracy as performance measure to terminate the training. patience=8 means the training is terminated as soon as 8 epochs with no improvement. min_delta=0.001 means the validation accuracy has to improve by at least 0.001 for it to count as an improvement. mode='max' means it will stop when the quantity monitored has stopped increasing.", "Let\u2019s go ahead and run it with the customized early stopping.", "This time, the training gets terminated at Epoch 9 as there are 8 epochs with no improvement on validation accuracy (It has to be \u2265 0.001 to count as an improvement). For a clear picture, let\u2019s look at a plot representation of accuracy by running plot_metric(history, 'accuracy'). In the below graph, validation accuracy is shown in orange and it\u2019s clear that validation accuracy hasn\u2019t got any improvement.", "Please checkout the notebook on my Github for the source code.", "Stay tuned if you are interested in the practical aspect of machine learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F550ac88bc8fd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----550ac88bc8fd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F550ac88bc8fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F550ac88bc8fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sambourke?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Samuel Bourke"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/machine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e", "anchor_text": "regularization techniques"}, {"url": "https://towardsdatascience.com/machine-learning-model-regularization-in-practice-an-example-with-keras-and-tensorflow-2-0-52a96746123e", "anchor_text": "model regularization"}, {"url": "https://towardsdatascience.com/batch-normalization-in-practice-an-example-with-keras-and-tensorflow-2-0-b1ec28bde96f", "anchor_text": "batch normalization"}, {"url": "https://towardsdatascience.com/create-virtual-environment-using-virtualenv-and-add-it-to-jupyter-notebook-6e1bf4e03415", "anchor_text": "Create Virtual Environment using \u201cvirtualenv\u201d and add it to Jupyter Notebook"}, {"url": "https://medium.com/analytics-vidhya/create-virtual-environment-using-conda-and-add-it-to-jupyter-notebook-d319a81dfd1", "anchor_text": "Create Virtual Environment using \u201cconda\u201d and add it to Jupyter Notebook"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/005-early-stopping/early-stopping.ipynb", "anchor_text": "machine learning repo"}, {"url": "https://en.wikipedia.org/wiki/Iris_flower_data_set", "anchor_text": "Anderson Iris flower (iris)"}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "UCI Iris dataset"}, {"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "anchor_text": "one-hot encoding"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "3 ways to create a machine learning model with Keras and TensorFlow 2.0"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "notebook on my Github"}, {"url": "https://keras.io/api/callbacks/early_stopping/", "anchor_text": "Keras Official Documentation for Early Stopping"}, {"url": "https://medium.com/tag/early-stopping?source=post_page-----550ac88bc8fd---------------early_stopping-----------------", "anchor_text": "Early Stopping"}, {"url": "https://medium.com/tag/keras?source=post_page-----550ac88bc8fd---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----550ac88bc8fd---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----550ac88bc8fd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----550ac88bc8fd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F550ac88bc8fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&user=B.+Chen&userId=563d09da62a&source=-----550ac88bc8fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F550ac88bc8fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&user=B.+Chen&userId=563d09da62a&source=-----550ac88bc8fd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F550ac88bc8fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F550ac88bc8fd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----550ac88bc8fd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----550ac88bc8fd--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-introduction-to-early-stopping-in-machine-learning-550ac88bc8fd&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}