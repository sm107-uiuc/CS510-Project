{"url": "https://towardsdatascience.com/building-a-language-toxicity-classification-model-b006ae6981a4", "time": 1683000591.305673, "path": "towardsdatascience.com/building-a-language-toxicity-classification-model-b006ae6981a4/", "webpage": {"metadata": {"title": "Building a Language Toxicity Classification Model | by Ekaba Bisong | Towards Data Science", "h1": "Building a Language Toxicity Classification Model", "description": "Online communities are a significant part of interactions over the internet. The rise of such communities comes with the need for community moderation to ensure that participants adhere to their\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge", "anchor_text": "Toxic Comment Classification Challenge on Kaggle by Jigsaw and Google", "paragraph_index": 4}, {"url": "https://github.com/dvdbisong/automl-toxicity-classification.git", "anchor_text": "https://github.com/dvdbisong/automl-toxicity-classification.git", "paragraph_index": 20}, {"url": "https://amzn.to/2Hz1n5B", "anchor_text": "\u201cBuilding Machine Learning and Deep Learning Models on Google Cloud Platform\u201d", "paragraph_index": 32}], "all_paragraphs": ["Online communities are a significant part of interactions over the internet. The rise of such communities comes with the need for community moderation to ensure that participants adhere to their prescribed guidelines and avoid \u201cclear and obvious\u201d and objective policy violations.", "Due to the presence of bad actors with malicious intent, the work of moderation poses particular challenges. One of such is the time spent on moderating online communities due to the size of bad actors. Moreso, the volume of these violations may result in some of them making it past the moderators and may be extremely dangerous in specific communities. An example is an obscene text getting past moderators in an online community for K-12 children.", "Also, the work of moderation may lead to other challenges such as consistency in judgment and more importantly, psychological danger due to constant exposure to graphic and obscene materials.", "Google Cloud AutoML for Natural Language provides the platform for designing and developing custom language models for language recognition use-cases. This article uses Google Cloud AutoML for Natural Language to develop an end-to-end language toxicity classification model to identify obscene text. The concept of neural architecture search and transfer learning are used under the hood to find the best network architecture and the optimal hyperparameter setting that improves the performance of the model.", "The data used in this project is from the Toxic Comment Classification Challenge on Kaggle by Jigsaw and Google. The data is modified to have a sample of 16,000 toxic and 16,000 non-toxic words as inputs to build the model on AutoML NLP.", "(2). Open Cloud AutoML Natural Language by clicking the triple-dash at the top-left corner of the GCP dashboard. Select Natural Language under the product section for Artificial Intelligence.", "(3). Select Text Classification under AutoML Natural Language.", "(4). Setup Project APIs, permissions and Cloud Storage bucket to store the text files for modeling and other AutoML assets.", "(5). Select your GCP billing project from the drop-down when asked. Now we are ready to create a Dataset for building the custom classification model on AutoML. We will return here after downloading the raw dataset from Kaggle to Cloud Storage and preparing the data for modeling with AutoML.", "In this case, the automatically created bucket is called: gs://ekabasandbox-lcm.", "(1). Activate the Cloud shell (in red circle) to launch the ephemeral VM instance to stage the dataset download from Kaggle, unzip it and upload to the storage bucket.", "(2). Install the Kaggle command-line interface. This tool will allow us to download datasets from Kaggle. Run the following code:", "Note, however, that the Cloud Shell instance is ephemeral and does not persist system-wide changes when the session ends. Also, if a dataset is particularly large, other options exist such as spinning-up a compute VM, download the dataset, unzip it and then upload to Cloud Storage. It is possible to design other advanced data pipelines to get data into GCP for analytics/ machine learning.", "(3). Download Kaggle API token key that will enable the Kaggle CLI to authenticate/ authorize against Kaggle to download the desired datasets.", "(4). Download dataset from Kaggle to Google Cloud Storage.", "(6). Move the dataset from the ephemeral cloud shell instance to the created cloud storage bucket. Insert your bucket name here.", "(1). Launch Jupyter Notebooks on the Google Cloud AI Platform.", "(2). Create a new Notebook Instance.", "(3). Select an instance name and create.", "(5). Before building a custom language classification model with AutoML Cloud Natural Language, the dataset must be prepared in a particular format:", "(6). Clone the preprocessing script from Github. Click on the icon, circled in red and enter the Github URL https://github.com/dvdbisong/automl-toxicity-classification.git to clone the repo with the preprocessing code.", "(7). Run all the cells in the notebook nlp_preprocessing.ipynb to create the CSV file containing the path and labels of the images and upload this file to Cloud Storage.", "(1). Click on \u201cNew Dataset\u201d from the AutoML Natural Language Dashboard.", "(2). Fill-in the dataset name and select the CSV file from the Cloud Storage bucket created by AutoML.", "(3). For now, you may dismiss if you see the error message that duplicated files are located. To the best of my knowledge, this is not the case as per the file names.", "(4). Click on Train as shown in red in the image above to initiate model building with Cloud AutoML.", "(6). After model training is complete, click on Evaluate to view the performance metric of the model.", "(7). Assess the performance metric (precision, recall and confusion matrix).", "(1). Click on the Predict tab to test the model.", "(2). We can explore this model by passing in introductory text about Nigeria from Wikipedia. We expect the model prediction to be clean. By further exploration, the model performs well on \u201cclear and obvious\u201d toxic examples.", "The custom language classification model is also exposed as a REST or Python API for integration into software applications as a prediction service for inference.", "The article provided a walkthrough to design powerful language classification models for custom use-cases by leveraging Google Cloud Platform AutoML Natural Language. Also, the model is hosted on the cloud for inference as a prediction service. This is a powerful mechanism to build and deploy language classification products. I trust this sample serves as a template for using AutoML to build Natural Language products. Finally, be sure to delete your models and datasets when it is no longer needed, this will spare cloud costs.", "Excerpts of this article are taken from the book \u201cBuilding Machine Learning and Deep Learning Models on Google Cloud Platform\u201d published by Apress (Springer Nature).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI Researcher, Google Developer Expert in Machine Learning and author of book \u201cBuilding Machine Learning and Deep Learning Models on Google Cloud Platform\u201d"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb006ae6981a4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dvdbisong?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvdbisong?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": "Ekaba Bisong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe523d9921f29&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&user=Ekaba+Bisong&userId=e523d9921f29&source=post_page-e523d9921f29----b006ae6981a4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb006ae6981a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb006ae6981a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge", "anchor_text": "Toxic Comment Classification Challenge on Kaggle by Jigsaw and Google"}, {"url": "https://cloud.google.com/", "anchor_text": "https://cloud.google.com/"}, {"url": "https://www.kaggle.com/[KAGGLE_USER_NAME]/account", "anchor_text": "https://www.kaggle.com/[KAGGLE_USER_NAME]/account"}, {"url": "https://github.com/dvdbisong/automl-toxicity-classification.git", "anchor_text": "https://github.com/dvdbisong/automl-toxicity-classification.git"}, {"url": "https://amzn.to/2Hz1n5B", "anchor_text": "\u201cBuilding Machine Learning and Deep Learning Models on Google Cloud Platform\u201d"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----b006ae6981a4---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/software-development?source=post_page-----b006ae6981a4---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b006ae6981a4---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b006ae6981a4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b006ae6981a4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb006ae6981a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&user=Ekaba+Bisong&userId=e523d9921f29&source=-----b006ae6981a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb006ae6981a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&user=Ekaba+Bisong&userId=e523d9921f29&source=-----b006ae6981a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb006ae6981a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb006ae6981a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b006ae6981a4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b006ae6981a4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b006ae6981a4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b006ae6981a4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b006ae6981a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvdbisong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dvdbisong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ekaba Bisong"}, {"url": "https://medium.com/@dvdbisong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "271 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe523d9921f29&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&user=Ekaba+Bisong&userId=e523d9921f29&source=post_page-e523d9921f29--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa2bd8714c81a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-language-toxicity-classification-model-b006ae6981a4&newsletterV3=e523d9921f29&newsletterV3Id=a2bd8714c81a&user=Ekaba+Bisong&userId=e523d9921f29&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}