{"url": "https://towardsdatascience.com/lime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16", "time": 1683017708.7064261, "path": "towardsdatascience.com/lime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16/", "webpage": {"metadata": {"title": "LIME vs. SHAP: Which is Better for Explaining Machine Learning Models? | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "LIME vs. SHAP: Which is Better for Explaining Machine Learning Models?", "description": "Do you want to use machine learning in production? Good luck explaining predictions to non-technical folks. LIME and SHAP can help. Explainable machine learning is a term any modern-day data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/piyushagni5/white-wine-quality", "anchor_text": "wine quality dataset", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/shap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9", "anchor_text": "dependence plots", "paragraph_index": 25}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 28}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 30}], "all_paragraphs": ["Do you want to use machine learning in production? Good luck explaining predictions to non-technical folks. LIME and SHAP can help.", "Explainable machine learning is a term any modern-day data scientist should know. Today you\u2019ll see how the two most popular options compare \u2014 LIME and SHAP.", "If acronyms LIME and SHAP sound like a foreign language, please refer to the articles below:", "These two cover the basic theory and practical implementation. It\u2019s a good read if you\u2019re new to the topic.", "Let\u2019s keep this part simple and train a model on one of the simplest datasets available. The wine quality dataset is a perfect candidate, as it requires no preparation. Here\u2019s how to load it with Pandas:", "The dataset is as clean as they come, so you can immediately proceed with the train/test split. Here\u2019s the code:", "The final step is to train the model. Any tree-based model will work great for explanations:", "The final line of code separates a single instance from the test set. You\u2019ll use it to make explanations with both LIME and SHAP.", "If you\u2019ve read the article on LIME, you already know how to make explanations. If not, you should still be able to follow along. You\u2019ll use LimeTabularExplainer to classify a single instance as good or bad.", "LIME also needs a function for making predictions. Since this is a classification problem, let\u2019s use probabilities (predict_proba). Here\u2019s the code:", "If you\u2019re following along, you should see this in the notebook:", "The model is almost certain this is a bad wine (96% chance). Take a look at the first three features \u2014 they are all increasing the chance of a wine being classified as bad.", "That\u2019s LIME in a nutshell. Only one problem with it \u2014 the visualizations look horrible.", "They\u2019re still interpretable, but I wouldn\u2019t show this visualization to my boss. It\u2019s not necessarily a problem \u2014 LIME lets you access prediction probabilities. Here\u2019s how:", "LIME also lets you access the probabilities for the middle chart:", "I\u2019m sure you can use this data to make better-looking visualizations.", "To conclude \u2014 LIME tells you everything you need but doesn\u2019t produce the best-looking visuals. Still, tweaking them shouldn\u2019t be a problem.", "SHAP is a bit different. It bases the explanations on shapely values \u2014 measures of contributions each feature has in the model.", "The idea is still the same \u2014 get insights into how the machine learning model works.", "Below you\u2019ll find code for importing the libraries, creating instances, calculating SHAP values, and visualizing the interpretation of a single prediction. For convenience sake, you\u2019ll interpret the prediction for the same data point as with LIME:", "The visualization looks great, sure, but isn\u2019t as interpretable as the one made by LIME. The red marks push the prediction higher towards the base value, and the blue marks do just the opposite.", "For the wine dataset \u2014 if you see more blues than reds, the wine is classified as bad and vice versa.", "The story doesn\u2019t end here. SHAP comes with summary plots \u2014 a neat way to visualize every feature\u2019s importance and their impact on prediction. Let\u2019s make one next:", "To conclude \u2014 SHAP doesn\u2019t look as intuitive as LIME out of the box. It comes with summary charts that make understanding an entire machine learning model easy.", "So, which one should you use for machine learning projects?", "Why not both? I use LIME to get a better grasp of a single prediction. On the other hand, I use SHAP mostly for summary plots and dependence plots.", "Maybe using both will help you to squeeze out some additional information. But in general:", "Which one do you prefer? For which use cases? Let me know in the comment section below.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd68d8290bb16&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----d68d8290bb16---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd68d8290bb16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd68d8290bb16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@_staticvoid?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Lucas Santos"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/shap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9", "anchor_text": "SHAP: How to Interpret Machine Learning Models With PythonExplainable machine learning with a single function calltowardsdatascience.com"}, {"url": "https://towardsdatascience.com/lime-how-to-interpret-machine-learning-models-with-python-94b0e7e4432e", "anchor_text": "LIME: How to Interpret Machine Learning Models With PythonExplainable machine learning at your fingertips.towardsdatascience.com"}, {"url": "https://www.kaggle.com/piyushagni5/white-wine-quality", "anchor_text": "wine quality dataset"}, {"url": "https://towardsdatascience.com/shap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9", "anchor_text": "dependence plots"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d68d8290bb16---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d68d8290bb16---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d68d8290bb16---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----d68d8290bb16---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----d68d8290bb16---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd68d8290bb16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----d68d8290bb16---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd68d8290bb16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----d68d8290bb16---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd68d8290bb16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd68d8290bb16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d68d8290bb16---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d68d8290bb16--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d68d8290bb16--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d68d8290bb16--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d68d8290bb16--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flime-vs-shap-which-is-better-for-explaining-machine-learning-models-d68d8290bb16&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}