{"url": "https://towardsdatascience.com/multiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d", "time": 1683017968.437136, "path": "towardsdatascience.com/multiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d/", "webpage": {"metadata": {"title": "Multiprocessing and Pickle, How to Easily fix that? | by Salma El Shahawy | Towards Data Science", "h1": "Multiprocessing and Pickle, How to Easily fix that?", "description": "As a data scientist, you may sometimes require to send complex object hierarchies over a network or save your objects\u2019 internal state to a disk or database for later use. To achieve this, you can use\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@bfortuner", "anchor_text": "Brendan Fortuner", "paragraph_index": 13}, {"url": "https://medium.com/@bfortuner/python-multithreading-vs-multiprocessing-73072ce5600b", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://github.com/uqfoundation/pathos", "anchor_text": "pathos", "paragraph_index": 14}, {"url": "https://dill.readthedocs.io/en/latest/dill.html", "anchor_text": "dill", "paragraph_index": 15}, {"url": "https://stackoverflow.com/questions/37906154/dill-vs-cpickle-speed-difference", "anchor_text": "Mike McKerns (dill author answer on Stackoverflow dill vs. cPickle)", "paragraph_index": 16}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "Linkedin", "paragraph_index": 22}], "all_paragraphs": ["As a data scientist, you may sometimes require to send complex object hierarchies over a network or save your objects\u2019 internal state to a disk or database for later use. To achieve this, you can use a process called serialization, which is entirely supported by the standard library. This article will discuss the following:", "This tutorial doesn\u2019t include serialization using jypter notebooks or anaconda configurations.", "Pickling or Serialization transforms from object state into a series of bits \u2014 the object could be methods, data, class, API end-points, etc. Serialization is an effective way to share big objects easily without losing information. The original object could be retrieved through the object Deserialization process. As usual, every great thing comes with a tradeoff; You need to be vigilant when downloading a pickle file from an unknown source, where it could have malware.", "Suppose you have the following class named Process, and you have some helpful methods that you frequently use in your data preprocessing step. To save you some time, you\u2019ve decided to pickle this class using the pickle module.", "If you need to pickle an object that has a database connection, for instance, then you\u2019re in for a hard time because it\u2019s an unserializable object even for dill. The solution is to freeze the object out from the serialization process. Then, reinitializing the connection after the object is deserialized utilizing setter and getter methods within the class definition.", "2. Save the file and run it through python process.py in the terminal.", "The test_pickle.pkl supposed to appear on the left-hand side of the code editor with no raised errors in the running terminal.", "Now, you can easily reuse that pickle file anytime within any project. You can open it using the open() within main() method and initialize that class and start using the methods within that class.", "As demonstrated in the screenshot above, __dict__ has only one key args, and fun parameter was excluded when opening the test_pickle.py file.", "If you didn\u2019t exclude the lambda initialization in the __getstate__() , the pickling would fail because lambda cannot pickle as we mentioned before.", "To unpickle the file and retrieve all lambda functions that you excluded in the pickling process, all you need to do is to update the state attribute inside the __setstate__() like the following \u2014 redefine the method:", "We retrieved the fun attribute. Awesome \ud83d\ude0e", "In real life situation, you might need high computational power to execute some tasks. A great example is to train the machine learning model or neural network, which are intensive and time-consuming processes.", "If you are interested to read more about multiprocessing, Brendan Fortuner wrote a great article about threads and processes in Python. You can check it out here", "One of the routes you might consider is distributing the training task over several processes utilizing the pathos fork from python\u2019s multiprocessing module. However, the multiprocess tasks can\u2019t be pickled; it would raise an error failing to pickle. That\u2019s because when dividing a single task over multiprocess, these might need to share data; however, it doesn\u2019t share memory space.", "In this situation, the dill package comes in handy, where it can serialize many types of objects that aren\u2019t pickleable. It can serialize database connections, lambda functions, running threads, and more.", "dill is slower typically, but that's the penalty you pay for more robust serialization. If you are serializing a lot of classes and functions, then you might want to try one of the dill variants in dill.settings . If you use byref=True then dill will pickle several objects by reference (which is faster then the default). Other settings trade off picklibility for speed in selected objects. \u2014 Mike McKerns (dill author answer on Stackoverflow dill vs. cPickle)", "To make sense of it, let\u2019s have an example.", "The dump_session() used to serialize the entire session of the interpreter.", "Now, restart the python terminal and investigate the global environment:", "It should return something similar to the following, which is the interpreter initial state", "Next, try to reload the dill session you saved earlier by:", "Finally, I hope this tutorial gave you a good idea about serialization. If you have any questions or suggestions to improve the article, please write them in the comment section, or if you have any issues following along, please feel free to contact me over Linkedin; I would be more than happy to help. Happy learning!\ud83d\udc4d", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6f7e55dee29d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://salmaeng71.medium.com/?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0----6f7e55dee29d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f7e55dee29d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f7e55dee29d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://xkcd.com/2054/", "anchor_text": "https://xkcd.com/2054/"}, {"url": "https://towardsdatascience.com/how-to-set-up-python3-the-right-easy-way-11c18b0b4ac0", "anchor_text": "check this quick guide for a proper installation"}, {"url": "https://www.programiz.com/python-programming/object-oriented-programming", "anchor_text": "check this one"}, {"url": "https://gist.github.com/salma71/33ac57e69498b48cdce3bc73118d9c7c", "anchor_text": "https://gist.github.com/salma71/33ac57e69498b48cdce3bc73118d9c7c"}, {"url": "https://gist.github.com/salma71/9eabea4297e7f954e9123d0443049acb", "anchor_text": "https://gist.github.com/salma71/9eabea4297e7f954e9123d0443049acb"}, {"url": "https://medium.com/@bfortuner", "anchor_text": "Brendan Fortuner"}, {"url": "https://medium.com/@bfortuner/python-multithreading-vs-multiprocessing-73072ce5600b", "anchor_text": "here"}, {"url": "https://github.com/uqfoundation/pathos", "anchor_text": "pathos"}, {"url": "https://dill.readthedocs.io/en/latest/dill.html", "anchor_text": "dill"}, {"url": "https://stackoverflow.com/questions/37906154/dill-vs-cpickle-speed-difference", "anchor_text": "Mike McKerns (dill author answer on Stackoverflow dill vs. cPickle)"}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6f7e55dee29d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----6f7e55dee29d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6f7e55dee29d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----6f7e55dee29d---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/python3?source=post_page-----6f7e55dee29d---------------python3-----------------", "anchor_text": "Python3"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6f7e55dee29d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----6f7e55dee29d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6f7e55dee29d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&user=Salma+El+Shahawy&userId=992085c0dce0&source=-----6f7e55dee29d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f7e55dee29d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6f7e55dee29d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6f7e55dee29d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6f7e55dee29d--------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://salmaeng71.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Salma El Shahawy"}, {"url": "https://salmaeng71.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "414 Followers"}, {"url": "https://www.linkedin.com/in/salma-elshahawy/", "anchor_text": "https://www.linkedin.com/in/salma-elshahawy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F992085c0dce0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&user=Salma+El+Shahawy&userId=992085c0dce0&source=post_page-992085c0dce0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F428e575094be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultiprocessing-and-pickle-how-to-easily-fix-that-6f7e55dee29d&newsletterV3=992085c0dce0&newsletterV3Id=428e575094be&user=Salma+El+Shahawy&userId=992085c0dce0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}