{"url": "https://towardsdatascience.com/one-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df", "time": 1683013193.7747688, "path": "towardsdatascience.com/one-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df/", "webpage": {"metadata": {"title": "One-Step Predictions with LSTM: Forecasting Hotel Revenues | by Michael Grogan | Towards Data Science", "h1": "One-Step Predictions with LSTM: Forecasting Hotel Revenues", "description": "Note: This is an update to my previous article Forecasting Average Daily Rate Trends for Hotels Using LSTM. I since recognised a couple of technical errors in the original analysis, and decided to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/forecasting-average-daily-rate-trends-for-hotels-using-lstm-93a31e01190a", "anchor_text": "Forecasting Average Daily Rate Trends for Hotels Using LSTM", "paragraph_index": 0}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://datascience.stackexchange.com/questions/38692/lstm-for-time-series-which-window-size-to-use", "anchor_text": "Data Science Stack Exchange", "paragraph_index": 15}, {"url": "https://www.reddit.com/r/datascience/comments/79hjzn/how_good_is_lstm_for_time_series_forecasting/", "anchor_text": "Reddit thread", "paragraph_index": 38}, {"url": "https://github.com/MGCodesandStats/hotel-cancellations", "anchor_text": "here", "paragraph_index": 41}, {"url": "https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/", "anchor_text": "tutorial by Machine Learning Mastery", "paragraph_index": 42}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 45}], "all_paragraphs": ["Note: This is an update to my previous article Forecasting Average Daily Rate Trends for Hotels Using LSTM. I since recognised a couple of technical errors in the original analysis, and decided to write a new article to address these and expand my prior analysis.", "The purpose of using an LSTM model in this instance is to forecast ADR (average daily rate) for a hotel.", "In this example, the average ADR for customers per week is calculated and formulated into a time series. The LSTM model is then used to forecast this metric on a week-by-week basis.", "The original study by Antonio, Almeida and Nunes (2019) can be found here.", "Using pandas, the average ADR is calculated per week. Here is a plot of the weekly ADR trend.", "Note that the Jupyter Notebook for this example is available at the end of this article.", "As with any neural network, the data needs to be scaled for proper interpretation by the network, a process known as normalization. MinMaxScaler is used for this purpose.", "However, this comes with a caveat. Scaling must be done after the data has been split into training, validation and test sets \u2014 with each being scaled separately. A common mistake when first using the LSTM (I made this mistake myself) is to first normalize the data before splitting the data.", "The reason this is erroneous is that the normalization technique will use data from the validation and test sets as a reference point when scaling the data as a whole. This will inadvertently influence the values of the training data, essentially resulting in data leakage from the validation and test sets.", "In this regard, 100 data points are split into training and validation sets, with the last 15 data points being held as test data for comparison with the LSTM predictions.", "At this point, the training data can be scaled as follows:", "Here is a sample of the output:", "Similarly, the validation data is scaled in the same way:", "A \u201clookback period\u201d defines how many previous timesteps are used in order to predict the subsequent timestep. In this regard, we are using a one-step prediction model.", "The lookback period is set to 5 in this instance. This means that we are using the time steps at t-4, t-3, t-2, t-1, and t to predict the value at time t+1.", "Note that the selection of the lookback period is quite an arbitrary process. In this instance, a lookback window of 5 was shown to demonstrate the best predictive performance on the test set. However, another option could be to use the number of lags as indicated by PACF to set the size of the lookback window, as described at Data Science Stack Exchange.", "Let\u2019s take a look at the normalized window for X_train.", "Here are the first three entries. We can see that the five time steps immediately prior to the one we are trying to predict move in a stepwise motion.", "For instance, the first entry shows 0.63902841 at time t. In the second entry, this value now moves backwards to time t-1.", "Let\u2019s give an example applicable to this situation. For a hotel that wishes to predict the ADR value in week 26 for instance, the hotel will use this model to make the prediction in the prior week using data for weeks 21, 22, 23, 24, and 25.", "Now, the input is reshaped into a [samples, time steps, features] format.", "74 samples are present in the training data, the model is operating on a time step of 1, and 1 feature is being used in the model, i.e. a lagged version of the time series.", "An LSTM model is defined as follows:", "An LSTM model is created with 4 neurons. The mean squared error is being used as the loss function \u2014 given that we are dealing with a regression problem. Additionally, the adam optimizer is used, with training done over 100 epochs with a validation split of 20%.", "Here is a visual overview of the training and validation loss:", "We can see that after an initial increase in the validation loss, the loss starts to decrease after about 10 epochs.", "Now, the predictions are converted back to the original scale:", "The root mean squared error is calculated on the training and validation set:", "The obtained RMSE values are as follows:", "With a mean ADR value of 69.99 across the validation set, the validation error is quite small in comparison (roughly 12% of the mean value), indicating that the model has done a good job at forecasting ADR values.", "Here is a plot of the forecasted versus actual ADR values across the training and validation set.", "We can see that the LSTM model is generally capturing the directional oscillations of the time series. However, during periods of extreme spikes in ADR, e.g. week 60, the model seems to perform less well.", "However, in order to fully determine whether the model has predictive power \u2014 it will now be used to predict the last 15 time steps in the series, i.e. the test data.", "In this example, Xnew uses the previous five time steps to predict at time t+1. For instance, weeks 95 to 100 are used to predict the ADR value for week 101, then weeks 96 to 101 are used to predict week 102, and so on.", "The above graph illustrates the LSTM predictions versus the actual ADR values in the test set \u2014 the last 15 points in the series.", "The obtained RMSE and MAE (mean absolute error) values are as follows:", "The RMSE error for the test set is significantly higher than that for the validation set \u2014 which would be expected since we are working with unseen data.", "However, with a mean ADR value of 160 across the test set, the RMSE error is approximately 20% of the size of the mean value, indicating that the LSTM does still have reasonably strong predictive power in determining the value of the next timestep.", "Ideally, one would like to use a significantly larger data sample to validate whether the LSTM would retain predictive power across new data. Additionally, as illustrated in this Reddit thread, LSTMs can be prone to overfitting depending on the size of the data sample.", "In this regard, a larger data sample is needed to validate if this model would work in a real-world scenario. However, the preliminary results in this case look promising.", "In this example, you have seen:", "Many thanks for reading, and any feedback or questions are greatly appreciated. You can find the Jupyter Notebook for this example here.", "Additionally, I also highly recommend this tutorial by Machine Learning Mastery, which was used as a guideline for designing the LSTM model used in this example.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way. The author has no relationship with any third-parties mentioned in this article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc9ef0d3ef2df&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----c9ef0d3ef2df---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9ef0d3ef2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9ef0d3ef2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/Pexels-2286921/", "anchor_text": "Pexels"}, {"url": "https://pixabay.com/photos/bedroom-hotel-room-white-bedding-1285156/", "anchor_text": "Pixabay"}, {"url": "https://towardsdatascience.com/forecasting-average-daily-rate-trends-for-hotels-using-lstm-93a31e01190a", "anchor_text": "Forecasting Average Daily Rate Trends for Hotels Using LSTM"}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "here"}, {"url": "https://datascience.stackexchange.com/questions/38692/lstm-for-time-series-which-window-size-to-use", "anchor_text": "Data Science Stack Exchange"}, {"url": "https://www.reddit.com/r/datascience/comments/79hjzn/how_good_is_lstm_for_time_series_forecasting/", "anchor_text": "Reddit thread"}, {"url": "https://github.com/MGCodesandStats/hotel-cancellations", "anchor_text": "here"}, {"url": "https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/", "anchor_text": "tutorial by Machine Learning Mastery"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c9ef0d3ef2df---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c9ef0d3ef2df---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----c9ef0d3ef2df---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----c9ef0d3ef2df---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/keras?source=post_page-----c9ef0d3ef2df---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9ef0d3ef2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&user=Michael+Grogan&userId=eec017a8b178&source=-----c9ef0d3ef2df---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9ef0d3ef2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&user=Michael+Grogan&userId=eec017a8b178&source=-----c9ef0d3ef2df---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9ef0d3ef2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc9ef0d3ef2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c9ef0d3ef2df---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c9ef0d3ef2df--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fone-step-predictions-with-lstm-forecasting-hotel-revenues-c9ef0d3ef2df&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}