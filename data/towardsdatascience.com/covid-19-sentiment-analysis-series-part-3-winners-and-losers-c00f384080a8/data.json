{"url": "https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8", "time": 1683010076.430273, "path": "towardsdatascience.com/covid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8/", "webpage": {"metadata": {"title": "COVID-19 Sentiment Analysis Series, Part 3: Bayesian Sentiment Analysis | by Noah Muluberhan-Berhe | Towards Data Science", "h1": "COVID-19 Sentiment Analysis Series, Part 3: Bayesian Sentiment Analysis", "description": "Note from the editors: Towards Data Science is a Medium publication primarily based on the study of data science and machine learning. We are not health professionals or epidemiologists, and the\u2026"}, "outgoing_paragraph_urls": [{"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science", "paragraph_index": 0}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-1-getting-started-70892122630c", "anchor_text": "Part 1: \u201cGetting Started\u201d", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-2-hypothesis-testing-3db511875165", "anchor_text": "Part 2: \u201cHypothesis Testing\u201d", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-2-hypothesis-testing-3db511875165", "anchor_text": "Part 2: \u201cHypothesis Testing\u201d", "paragraph_index": 5}, {"url": "https://machinelearningmastery.com/statistical-power-and-power-analysis-in-python/", "anchor_text": "Power Analysis", "paragraph_index": 25}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html", "anchor_text": "TfidfVectorizer", "paragraph_index": 32}], "all_paragraphs": ["Note from the editors: Towards Data Science is a Medium publication primarily based on the study of data science and machine learning. We are not health professionals or epidemiologists, and the opinions of this article should not be interpreted as professional advice. To learn more about the coronavirus pandemic, you can click here.", "In this series, we have been using Londoners\u2019 tweets to understand how emotions evolved in the COVID-19 lockdown, and which public figures and businesses were the winners and losers in their eyes.", "In Part 1: \u201cGetting Started\u201d we got our Twitter data and processed it, using entity recognition and sentiment scoring.", "In Part 2: \u201cHypothesis Testing\u201d, using various different types of hypothesis tests we explained why sentiment towards the NHS was so much more positive than towards the Government.", "Today in the 3rd (and final) part, we will be casting the net wider to find more winners and losers from the lockdown:", "Picking up where we left off in Part 2: \u201cHypothesis Testing\u201d, let\u2019s start by visualising the most frequently mentioned organisations in our dataset of tweets. We have also narrowed our search just on those tweets that were scored to be either positive or negative, as we\u2019re interested in finding winners and losers:", "We can see Amazon and the Treasury very clearly come to the fore as the most frequently mentioned organisations. However it\u2019s difficult to see beyond these two as the wordcloud is cluttered with capitalised words that spaCy mistakenly labelled as entities.", "Nonetheless we can still look at Amazon and make the statement:", "Due to Londoners switching to online shopping during the lockdown, Amazon will be a big winner.", "It\u2019s not enough to conduct a 1-sample test to show that Amazon\u2019s sentiment score was positive, we will need to show Amazon\u2019s score was more positive vs. a sensible baseline. For this, we will conduct two 2-sample means t-tests:", "Hypothesis 1: Amazon sentiment improved on a pre-lockdown baseline.", "Hypothesis 2: Amazon sentiment in lockdown was higher than the baseline average across all entities.", "We can create the 2 distributions: amazon_prelockdown and amazon_postlockdown very easily, and run SciPy\u2019s t-test:", "which shows us that any difference in the overall mean isn\u2019t statistically significant. Why?", "Because our data only has 3 pre-lockdown tweets mentioning Amazon, leading to a standard error too high to be able to reject the null.", "Similarly creating the relevant distributions, and running the same t-test:", "We have a low p-value which would lead us to reject the null, however let\u2019s check the distributions and the sample sizes to check that the assumption of normality holds, for us to have performed this parametric statistical test:", "We can see 2 issues here:", "Lesson: make sure to remove all duplicate texts from now on.", "2. The sample size for \u2018Other Entities\u2019 is much too large to represent the baseline I was hoping it would represent, ie. only for other organisations. It appears that SpaCy incorrectly tagging capitalised words as entities has led to this distribution becoming polluted. Therefore allowing this to more closely represent the broader sample set. I manually created a good subset of the most-mentioned organisations that could make up the \u2018Other Entities\u2019:", "WHO, Facebook, FDA, UN, Whatsapp, Tesco, Premier League, Google, FDA, Apple, CDC, Parliament, White House", "We now fail to reject the null because:", "In essence, if we wanted to be sure that the difference between Amazon\u2019s positive mean and the Others\u2019 neutral mean was statistically significant, we would need to collect more samples to increase the power of our test to reject the null. We can measure this using a Power Analysis\u2026", "How many tweets would we have needed in order to conclude with 95% confidence that the two sample means were indeed different?", "Put another way: how large a sample size would have been needed to reduce the Type II error rate to below a certain threshold. We will choose a threshold of 20%, which translates to a Power (the ability to correctly reject the null) of 80%.", "We can conduct a Power Analysis (the details of which we won\u2019t go into here) but the code is quite simple and utilises Statsmodel\u2019s TTestIndPower function:", "which shows that a very large sample size of almost 1000 tweets would have been needed for our test to correctly reject the null 80% of the time.", "So, even a commercial entity that had a relatively large number of tweets (Amazon) tested vs. ALL the other most tweeted about commercial entities still doesn\u2019t give us enough statistical power to differentiate between their means.", "However we know from a 1-sample test that we\u2019re confident that sentiment towards Amazon was positive:", "So 2 sample tests don\u2019t have enough statistical power, whereas looking at each entity alone can.", "How do we then present this 1-sample view across all entities to see which ones were indeed the winners / losers, without having to re-run a t-test for each entity individually?", "To do this we can reframe the question into a supervised learning problem. We can apply Statsmodel\u2019s Logistic Regression classifier predicting for one of two label classes positive or negative, with the features being the organisations that were recognised by SpaCy.", "I used the scikit-learn\u2019s TfidfVectorizer to encode the entities into a features array with weightings derived using it\u2019s TF-IDF methodology. I also used this function to remove stopwords and other unwanted words, and restricted this to the Top 70 features. The results returned were:", "The overall model, particularly when restricted to just the 70 top features, couldn\u2019t predict if a tweet would be positive or negative (looking at the R\u00b2). However we can learn a lot at the individual feature level: we can see which were net positive (because coef > 0) and which were net negative (coef < 0).", "The model results also show us the certainty of our sample statistic (the coefficient) using: the standard-error for that distribution (influenced by sample size), the z-score and the p-value which both show whether this sample statistic was statistically significant, and then the 95% confidence interval for the sample statistic.", "We have used Frequentist statistics to create a top-down approach to finding the organisational drivers of good and bad sentiment, however this relies on the 3 months of data we have already collected.", "At the start of the observation period when the situation was evolving fast, we saw large swings in sentiment towards an entity coupled with lower sample sizes leading to much more uncertainty. This is where a Bayesian model can help\u2026", "In the Frequentist view of the world, we have a broader population that, through sampling, we\u2019re trying to understand. As a result there is one true population parameter which by sampling we can estimate through our sample statistic.", "In the Bayesian view of the world, we don\u2019t think of there being a broader population. We only have our sample. However we do concede that, because our sample size is finite, there is uncertainty in our sample statistic so we should model this as a distribution not as a single number.", "Given the \u2018live\u2019 nature of most data collection, particularly after a unique event such as COVID-19, it makes sense to look at how a Bayesian approach can help us answer the question.", "2. Luckily as we\u2019re only interested in a binary outcome (our tweets will be either positive or negative, as we will omit neutral tweets), we can achieve conjugacy using perhaps the simplest conjugate pair: the beta-binomial pair", "A long and complicated equation, but the important bits of intuition to take away from this are:", "We can use the output of the Logistic Regression to give us a list of the most-tweeted entities we can look at.", "The process for building the Bayesian Modelling pipeline for a specific entity can be divided into 2 stages:", "I also created an animation in Matplotlib that can show us this evolution:", "Let\u2019s look at the evolution in sentiment for a few entities of interest:", "There were 183 tweets referring to Amazon in this period, the orange distribution shows the probability distribution for sentiment before the lockdown, ie. the 2 weeks leading up to it. This is our prior belief of the probability distribution for Amazon sentiment.", "The distribution in this case is quite flat and shallow, reflecting the fact there were relatively few tweets informing our prior belief: only 2 positive tweets and 1 negative tweet.", "Once we hit lockdown, that\u2019s when we update the prior with tweets gathered from lockdown-period tweets. This enables us then to model the Posterior (in blue). Notice how the distribution narrows and peaks as days pass (denoted by the slider) as we harvest more tweets to inform our posterior distribution.", "Prior to the lockdown, I had no tweets about Keir Starmer to inform any prior belief about him. This is where you can set \u03b1 and \u03b2 both to 0.5 therefore adopting Jeffreys\u2019 Prior to model an uninformed distribution. The prior takes on a U-shape.", "Over the lockdown period we collected 66 tweets, and throughout the entire period Starmer\u2019s MAP remained in negative period, hovering around 0.2.", "We collected 1003 tweets for Dominic Cummings, who started off before lockdown with nothing but positive tweets in my dataset.", "After about 20 days into the lockdown period, the posterior distribution had shifted towards the left, with the MAP ending at just under 0.5.", "This shift from positive to negative sentiment, from looking at the actual dates, coincided with the controversy around his breaking of social distancing rules.", "In this blog series: we showed that it\u2019s possible to set up a feed in from Twitter, apply some text processing, conduct sentiment scoring, and analyse the per-entity sentiment in a way that clarifies the winners and losers.", "I used this extensively to understand bring some statistical clarity to my findings, which taught me a few areas to be cautious about:", "To get an overall view, I used Logistic Regression to model positive vs negative labelled tweets, using the vectorized entity column as the predictor matrix.", "Here I set up an animated slider to show the prior distribution, and then how the posterior distribution evolved after that as new data came in, which could be configured to the entity of choice.", "To those who have made it this far, thanks for reading and of course all feedback is welcome and appreciated, you can find the repo here:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science | Finance | Management Consulting"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc00f384080a8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c00f384080a8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c00f384080a8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@noah.berhe?source=post_page-----c00f384080a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noah.berhe?source=post_page-----c00f384080a8--------------------------------", "anchor_text": "Noah Muluberhan-Berhe"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36db8d98670a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&user=Noah+Muluberhan-Berhe&userId=36db8d98670a&source=post_page-36db8d98670a----c00f384080a8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc00f384080a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc00f384080a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@peterampazzo?utm_source=medium&utm_medium=referral", "anchor_text": "Pietro Rampazzo"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://towardsdatascience.com/", "anchor_text": "Towards Data Science"}, {"url": "https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-1-getting-started-70892122630c", "anchor_text": "Part 1: \u201cGetting Started\u201d"}, {"url": "https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-2-hypothesis-testing-3db511875165", "anchor_text": "Part 2: \u201cHypothesis Testing\u201d"}, {"url": "https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-2-hypothesis-testing-3db511875165", "anchor_text": "Part 2: \u201cHypothesis Testing\u201d"}, {"url": "https://machinelearningmastery.com/statistical-power-and-power-analysis-in-python/", "anchor_text": "Power Analysis"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html", "anchor_text": "TfidfVectorizer"}, {"url": "https://github.com/noahberhe/COVID-19", "anchor_text": "noahberhe/COVID-19NLP applied to recent Coronavirus / COVID19 tweets: How has sentiment progressed in recent weeks? Scrape London-based\u2026github.com"}, {"url": "https://medium.com/tag/twitter-sentiment?source=post_page-----c00f384080a8---------------twitter_sentiment-----------------", "anchor_text": "Twitter Sentiment"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----c00f384080a8---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/matplotlib?source=post_page-----c00f384080a8---------------matplotlib-----------------", "anchor_text": "Matplotlib"}, {"url": "https://medium.com/tag/statistics?source=post_page-----c00f384080a8---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc00f384080a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&user=Noah+Muluberhan-Berhe&userId=36db8d98670a&source=-----c00f384080a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc00f384080a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&user=Noah+Muluberhan-Berhe&userId=36db8d98670a&source=-----c00f384080a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc00f384080a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c00f384080a8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc00f384080a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c00f384080a8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c00f384080a8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c00f384080a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c00f384080a8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c00f384080a8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c00f384080a8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c00f384080a8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c00f384080a8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c00f384080a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noah.berhe?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noah.berhe?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Noah Muluberhan-Berhe"}, {"url": "https://medium.com/@noah.berhe/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "33 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36db8d98670a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&user=Noah+Muluberhan-Berhe&userId=36db8d98670a&source=post_page-36db8d98670a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff406dbc34969&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcovid-19-sentiment-analysis-series-part-3-winners-and-losers-c00f384080a8&newsletterV3=36db8d98670a&newsletterV3Id=f406dbc34969&user=Noah+Muluberhan-Berhe&userId=36db8d98670a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}