{"url": "https://towardsdatascience.com/convolutional-neural-network-for-breast-cancer-classification-52f1213dcc9", "time": 1683000295.908951, "path": "towardsdatascience.com/convolutional-neural-network-for-breast-cancer-classification-52f1213dcc9/", "webpage": {"metadata": {"title": "Convolutional Neural Network for Breast Cancer Classification | by Abhinav Sagar | Towards Data Science", "h1": "Convolutional Neural Network for Breast Cancer Classification", "description": "Breast cancer is the second most common cancer in women and men worldwide. In 2012, it represented about 12 percent of all new cancer cases and 25 percent of all cancers in women. Breast cancer\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/p/convolutional-neural-network-for-breast-cancer-classification-52f1213dcc9?source=email-c3f5233f3441--writer.postDistributed&sk=cdc740178a784a00ec62a51aa87201b3", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://web.inf.ufpr.br/vri/databases/breast-cancer-histopathological-database-breakhis/", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/abhinavsagar/Breast-cancer-classification", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "follow me on Medium", "paragraph_index": 34}, {"url": "https://abhinavsagar.github.io", "anchor_text": "https://abhinavsagar.github.io", "paragraph_index": 37}], "all_paragraphs": ["Stuck behind the paywall? Click here to read the full story with my Friend Link!", "Breast cancer is the second most common cancer in women and men worldwide. In 2012, it represented about 12 percent of all new cancer cases and 25 percent of all cancers in women.", "Breast cancer starts when cells in the breast begin to grow out of control. These cells usually form a tumor that can often be seen on an x-ray or felt as a lump. The tumor is malignant (cancer) if the cells can grow into (invade) surrounding tissues or spread (metastasize) to distant areas of the body.", "Build an algorithm to automatically identify whether a patient is suffering from breast cancer or not by looking at biopsy images. The algorithm had to be extremely accurate because lives of people is at stake.", "The dataset can be downloaded from here. This is a binary classification problem. I split the data as shown-", "The training folder has 1000 images in each category while the validation folder has 250 images in each category.", "Let\u2019s go step by step and analyze each layer in the Convolutional Neural Network.", "A Matrix of pixel values in the shape of [WIDTH, HEIGHT, CHANNELS]. Let\u2019s assume that our input is [32x32x3].", "The purpose of this layer is to receive a feature map. Usually, we start with low number of filters for low-level feature detection. The deeper we go into the CNN, the more filters we use to detect high-level features. Feature detection is based on \u2018scanning\u2019 the input with the filter of a given size and applying matrix computations in order to derive a feature map.", "The goal of this layer is to provide spatial variance, which simply means that the system will be capable of recognizing an object even when its appearance varies in some way. Pooling layer will perform a downsampling operation along the spatial dimensions (width, height), resulting in output such as [16x16x12] for pooling_size=(2, 2).", "In a fully connected layer, we flatten the output of the last convolution layer and connect every node of the current layer with the other nodes of the next layer. Neurons in a fully connected layer have full connections to all activations in the previous layer, as seen in regular Neural Networks and work in a similar way.", "The complete image classification pipeline can be formalized as follows:", "Without much ado, let\u2019s get started with the code. The complete project on github can be found here.", "Let\u2019s start with loading all the libraries and dependencies.", "Next I loaded the images in the respective folders.", "After that I created a numpy array of zeroes for labeling benign images and similarly a numpy array of ones for labeling malignant images. I also shuffled the dataset and converted the labels into categorical format.", "Then I split the data-set into two sets \u2014 train and test sets with 80% and 20% images respectively. Let\u2019s see some sample benign and malignant images.", "I used a batch size value of 16. Batch size is one of the most important hyperparameters to tune in deep learning. I prefer to use a larger batch size to train my models as it allows computational speedups from the parallelism of GPUs. However, it is well known that too large of a batch size will lead to poor generalization. On the one extreme, using a batch equal to the entire dataset guarantees convergence to the global optima of the objective function. However this is at the cost of slower convergence to that optima. On the other hand, using smaller batch sizes have been shown to have faster convergence to good results. This is intuitively explained by the fact that smaller batch sizes allow the model to start learning before having to see all the data. The downside of using a smaller batch size is that the model is not guaranteed to converge to the global optima.Therefore it is often advised that one starts at a small batch size reaping the benefits of faster training dynamics and steadily grows the batch size through training.", "I also did some data augmentation. The practice of data augmentation is an effective way to increase the size of the training set. Augmenting the training examples allow the network to see more diversified, but still representative data points during training.", "Then I created a data generator to get the data from our folders and into Keras in an automated way. Keras provides convenient python generator functions for this purpose.", "The next step was to build the model. This can be described in the following 3 steps:", "Let\u2019s see the output shape and the parameters involved in each layer.", "Before training the model, it is useful to define one or more callbacks. Pretty handy one, are: ModelCheckpoint and ReduceLROnPlateau.", "I trained the model for 20 epochs.", "The most common metric for evaluating model performance is the accurcacy. However, when only 2% of your dataset is of one class (malignant) and 98% some other class (benign), misclassification scores don\u2019t really make sense. You can be 98% accurate and still catch none of the malignant cases which could make a terrible classifier.", "For a better look at misclassification, we often use the following metric to get a better idea of true positives (TP), true negatives (TN), false positive (FP) and false negative (FN).", "Precision is the ratio of correctly predicted positive observations to the total predicted positive observations.", "Recall is the ratio of correctly predicted positive observations to all the observations in actual class.", "F1-Score is the weighted average of Precision and Recall.", "The higher the F1-Score, the better the model. For all three metric, 0 is the worst while 1 is the best.", "Confusion Matrix is a very important metric when analyzing misclassification. Each row of the matrix represents the instances in a predicted class while each column represents the instances in an actual class. The diagonals represent the classes that have been correctly classified. This helps as we not only know which classes are being misclassified but also what they are being misclassified as.", "The 45 degree line is the random line, where the Area Under the Curve or AUC is 0.5 . The further the curve from this line, the higher the AUC and better the model. The highest a model can get is an AUC of 1, where the curve forms a right angled triangle. The ROC curve can also help debug a model. For example, if the bottom left corner of the curve is closer to the random line, it implies that the model is misclassifying at Y=0. Whereas, if it is random on the top right, it implies the errors are occurring at Y=1.", "Although this project is far from complete but it is remarkable to see the success of deep learning in such varied real world problems. In this blog, I have demonstrated how to classify benign and malignant breast cancer from a collection of microscopic images using convolutional neural networks and transfer learning.", "The corresponding source code can be found here.", "If you want to keep updated with my latest articles and projects follow me on Medium. These are some of my contacts details:", "Happy reading, happy learning and happy coding!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Graduate Student at University of Maryland, College Park. https://abhinavsagar.github.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F52f1213dcc9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://abhinav-sagar.medium.com/?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": "Abhinav Sagar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f5233f3441&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&user=Abhinav+Sagar&userId=c3f5233f3441&source=post_page-c3f5233f3441----52f1213dcc9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52f1213dcc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52f1213dcc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tamarabellis?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Tamara Bellis"}, {"url": "https://unsplash.com/search/photos/pink-ribbon?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/p/convolutional-neural-network-for-breast-cancer-classification-52f1213dcc9?source=email-c3f5233f3441--writer.postDistributed&sk=cdc740178a784a00ec62a51aa87201b3", "anchor_text": "here"}, {"url": "https://web.inf.ufpr.br/vri/databases/breast-cancer-histopathological-database-breakhis/", "anchor_text": "here"}, {"url": "https://github.com/abhinavsagar/Breast-cancer-classification", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/transfer-learning-for-image-classification-in-keras-5585d3ddf54e", "anchor_text": "Transfer Learning for Image Classification in KerasOne stop guide to Transfer Learningtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/predicting-invasive-ductal-carcinoma-using-convolutional-neural-network-cnn-in-keras-debb429de9a6", "anchor_text": "Predicting Invasive Ductal Carcinoma using Convolutional Neural Network (CNN) in KerasClassifying histopathology slides as malignant or benign using Convolutional Neural Networktowardsdatascience.com"}, {"url": "https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0214587", "anchor_text": "Breast cancer histopathological image classification using convolutional neural networks with small\u2026Although successful detection of malignant tumors from histopathological images largely depends on the long-term\u2026journals.plos.org"}, {"url": "https://becominghuman.ai/deep-learning-for-image-classification-with-less-data-90e5df0a7b8e", "anchor_text": "Deep Learning for Image Classification with Less DataDeep Learning is indeed possible with less databecominghuman.ai"}, {"url": "https://github.com/abhinavsagar/Breast-cancer-classification", "anchor_text": "abhinavsagar/Breast-cancer-classificationBenign vs Malignant classifier using convolutional neural networks The dataset can be downloaded from here. pip install\u2026github.com"}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "follow me on Medium"}, {"url": "https://abhinavsagar.github.io", "anchor_text": "Personal Website"}, {"url": "https://in.linkedin.com/in/abhinavsagar4", "anchor_text": "Linkedin"}, {"url": "https://medium.com/@abhinav.sagar", "anchor_text": "Medium Profile"}, {"url": "https://github.com/abhinavsagar", "anchor_text": "GitHub"}, {"url": "https://www.kaggle.com/abhinavsagar", "anchor_text": "Kaggle"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----52f1213dcc9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----52f1213dcc9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----52f1213dcc9---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/breast-cancer?source=post_page-----52f1213dcc9---------------breast_cancer-----------------", "anchor_text": "Breast Cancer"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----52f1213dcc9---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52f1213dcc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&user=Abhinav+Sagar&userId=c3f5233f3441&source=-----52f1213dcc9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52f1213dcc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&user=Abhinav+Sagar&userId=c3f5233f3441&source=-----52f1213dcc9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52f1213dcc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F52f1213dcc9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----52f1213dcc9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----52f1213dcc9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----52f1213dcc9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----52f1213dcc9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----52f1213dcc9--------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://abhinav-sagar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abhinav Sagar"}, {"url": "https://abhinav-sagar.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.3K Followers"}, {"url": "https://abhinavsagar.github.io", "anchor_text": "https://abhinavsagar.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f5233f3441&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&user=Abhinav+Sagar&userId=c3f5233f3441&source=post_page-c3f5233f3441--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F34161df55869&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-for-breast-cancer-classification-52f1213dcc9&newsletterV3=c3f5233f3441&newsletterV3Id=34161df55869&user=Abhinav+Sagar&userId=c3f5233f3441&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}