{"url": "https://towardsdatascience.com/pytorch-vs-tensorflow-in-code-ada936fd5406", "time": 1683003461.414616, "path": "towardsdatascience.com/pytorch-vs-tensorflow-in-code-ada936fd5406/", "webpage": {"metadata": {"title": "TensorFlow vs PyTorch for Deep Learning | Towards Data Science", "h1": "TensorFlow vs PyTorch for Deep Learning", "description": "You may be wondering whether to learn PyTorch or TensorFlow (2.0). If so hopefully this blog post can help. You'll see what developing and training neural networks looks like in both."}, "outgoing_paragraph_urls": [{"url": "https://keras.io/examples/imdb_fasttext/", "anchor_text": "example", "paragraph_index": 4}, {"url": "https://github.com/AStoeffelbauer/PyTorchVsTensorFlow/blob/master/blogpost.ipynb", "anchor_text": "code", "paragraph_index": 25}, {"url": "https://pytorch.org/tutorials/beginner/pytorch_with_examples.html", "anchor_text": "here", "paragraph_index": 26}, {"url": "https://github.com/AStoeffelbauer/PyTorchVsTensorFlow/blob/master/blogpost.ipynb", "anchor_text": "here", "paragraph_index": 36}], "all_paragraphs": ["You may be wondering whether to learn PyTorch or TensorFlow (2.0). If so hopefully this blog post can help. The idea is not to give an absolute answer here but just to show what developing and training neural networks look like in both.", "Before looking into the code, some things that are good to know: Both TensorFlow and PyTorch are machine learning frameworks specifically designed for developing deep learning algorithms with access to the computational power needed to process lots of data (e.g. parallel computing, training on GPUs, etc).", "TensorFlow, which comes out of Google, was released in 2015 under the Apache 2.0 license. In Oktober 2019, TensorFlow 2.0 was released, which is said to be a huge improvement. It\u2019s typically used in Python. PyTorch, on the other hand, comes out of Facebook and was released in 2016 under a similarly permissive open source license. As its name suggests, it\u2019s also a Python library.", "Back to the main reason for this blog post. The plan is to implement a simple neural network architecture in both TensorFlow and PyTorch to see some of the similarities and differences.", "The neural network model consists of three layers: Embedding Layer \u2192 Global Average Pooling Layer \u2192 Dense Layer. It\u2019s based on this example.", "The dataset used here consists of 40,000 tweets and their sentiment (0=negative, 1=positive). First, loading the data from a CSV file and displaying some rows of the data frame to get an idea of the data.", "To vectorize the tweets, I used Keras\u2019 tokenizer here but there\u2019re countless others that can do the same or even more.", "Here\u2019s what happens in the code snippet above. We assign an integer to each of the 20,000 most common words of the tweets and then turn the tweets into sequences of integers. We pad shorter ones with zeros and cut off longer ones, forcing a sequence length of 42. Finally, we should have a matrix of dimension 40,000 x 42 (tweets x sequence length).", "Creating TensorFlow models is typically done using Keras. Keras is built on top of TensorFlow and allows for easy and fast prototyping because it has many layers built-in \u2014 it would be tedious or even prohibitive to code them from scratch each time.", "There are three ways to build a neural network model in Keras.", "You can create your own fully-customizable models by subclassing the tf.keras.Model class and implementing the forward pass in the call method. Put differently, layers are defined in the __init__() method and the logic of the forward pass in the call method.", "The benefit of using such an object-oriented approach is that you can reuse layers multiple times within the call method or define a more complex forward pass. But nothing like that is happening in this example here, it\u2019s just a linear stack of layers.", "In the functional API, given some input tensor(s) and output tensor(s), you can also instantiate a Model. It\u2019s a user-friendly way to build a neural network and Keras even recommends it over model subclassing. With this approach, you essentially define a layer and immediately pass it the input of the previous layer. So it requires slightly less coding with the same result.", "The sequential API is the most compact way to define a model and sufficient for certain (simple) neural networks, typically consisting of just a few common layers \u2014 kind of a shortcut to a trainable model. It\u2019s definitely convenient and works well but is too inflexible if you wish to implement more sophisticated ideas.", "Regardless of how you build a Keras model, there are two functions I\u2019d like to show you. First, calling model.summary() prints a compact summary of the model and the number of parameters, which is super useful.", "Second, by calling tf.keras.utils.plot_model() you get a graphical summary of the model. It didn\u2019t work in my Jupyter Notebook, however. So I can\u2019t show it to you here, unfortunately.", "Before you can train a Keras model, it must be compiled by running the model.compile() function, which is also where you specify the loss function and optimizer.", "Keras models have a convenient fit function for training a model (just like Scikit-Learn), which also takes care of batch processing and even evaluates the model on the run (if you tell it to do so).", "Note: It\u2019s okay to pass Numpy arrays as inputs to the fit function even though TensorFlow (PyTorch too for that matter) operates on tensors only, which is a similar data structure but optimized for matrix computations. Keras takes care of transforming the arrays under the hood.", "There are two ways to build a neural network model in PyTorch.", "Similar to TensorFlow, in PyTorch you subclass the nn.Model module and define your layers in the __init__() method. The only difference is that you create the forward pass in a method named forward instead of call.", "Note: Difference to the Keras model: There\u2019s only an average-pooling layer in PyTorch so it needs to have the right kernel size in order the make it global average-pooling.", "PyTorch also offers a Sequential module that looks almost equivalent to TensorFlow\u2019s.", "Note: I found that many layers do not work with PyTorch\u2019s nn.Sequential such as many recurrent layers (RNNs, LSTMS, etc.). In fact, PyTorch didn\u2019t really want to implement the sequential module at all because it wants developers to use subclassing.", "There\u2019s no pre-made fit function for PyTorch models, so the training loop needs to be implemented from scratch. Here\u2019s what a typical training loop in PyTorch looks like.", "Note: In oder to process the data in batches, a dataloader must be created (left out here, see GitHub code). The dataloader returns one batch at a time in a dictionary format.", "Short description of the training loop: For each batch, we calculate the loss and then call loss.backward() to backpropagate the gradient through the layers. In addition, we call optimizer.step() to tell the optimizer to update the parameters. For a more detailed description of how to train a PyTorch model see here.", "Here\u2019re the best resources I know about getting started with TensorFlow and/or PyTorch.", "PyTorch\u2019s official tutorial on their website is awesome and in my view better than TensorFlow\u2019s. There\u2019s also a really good free PyTorch course on Udacity.", "TensorFlow has some really good courses on Coursera, and there\u2019s a great book written by Fran\u00e7ois Chollet, the creator of Keras. TensorFlow\u2019s and especially Keras\u2019 official websites are important sources too.", "I don\u2019t really feel able to answer that because I have only scratched the surface so far. But here are some of the things I\u2019ve noticed.", "TensorFlow is a lot like Scikit-Learn thanks to its fit function, which makes training a model super easy and quick. But even though you need to build every training loop in PyTorch yourself, I kind of like it because it makes you think more carefully about what you\u2019re doing. So it\u2019s less of a black box and that\u2019s always good. I fist learned PyTorch and I think that was a very good idea.", "Note: Of course, TensorFlow allows you to build customized training loops as well, but it\u2019s not as neat. Plus, there are third-party libraries for PyTorch that automate the training loop so that the difference here may not be so big after all.", "All in all, it\u2019s certainly easier to go from a blank script to a trained neural network in TensorFlow than in PyTorch \u2014 mostly due to TensorFlow\u2019s fit method. But another difference plays a role here too. I\u2019ve noticed that Keras layers often do not require you to specify the input dimension whereas in PyTorch you need to be more explicit. It\u2019s easy to confuse the dimensions, especially if you want to try out different ones. Apart from that, Keras\u2019 model.summary() and tf.keras.utils.plot_model()are super useful functions, as mentioned before. There are no standard PyTorch functions (I\u2019m aware of) that can do the same.", "These are definitely some plus points for TensorFlow. But in general, the two libraries feel VERY similar. It seems that they have converged a lot already by learning from each other and adopted each other\u2019s best features. That\u2019s not at all a bad thing but simply a sign that they have matured a lot. Therefore it\u2019s also really easy to switch \u2014 so don\u2019t worry about choosing the \u201cwrong\u201d library. For sure, there are a lot more aspects that I did not consider here, especially any advanced features such as parallel computing, training on GPUs, etc.", "Anyway, it will be interesting to see how TensorFlow and PyTorch will do in 2020. While PyTorch has been more popular among researchers lately, TensorFlow is the frontrunner in the industry. Thanks to TensorFlow and PyTorch, deep learning is more accessible than ever and more people will use it. It\u2019s never been easier.", "The code can also be found as a Jupyter Notebook here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "@ Microsoft | @ London School of Economics (LSE)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fada936fd5406&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ada936fd5406--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ada936fd5406--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@andreas.stoeffelbauer?source=post_page-----ada936fd5406--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreas.stoeffelbauer?source=post_page-----ada936fd5406--------------------------------", "anchor_text": "Andreas St\u00f6ffelbauer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb06af985ef2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&user=Andreas+St%C3%B6ffelbauer&userId=b06af985ef2&source=post_page-b06af985ef2----ada936fd5406---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fada936fd5406&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fada936fd5406&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@cloudvisual?utm_source=medium&utm_medium=referral", "anchor_text": "cloudvisual.co.uk"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://keras.io/examples/imdb_fasttext/", "anchor_text": "example"}, {"url": "https://github.com/AStoeffelbauer/PyTorchVsTensorFlow/blob/master/blogpost.ipynb", "anchor_text": "code"}, {"url": "https://pytorch.org/tutorials/beginner/pytorch_with_examples.html", "anchor_text": "here"}, {"url": "https://pytorch.org/tutorials/", "anchor_text": "Tutorials on the PyTorch Website"}, {"url": "https://www.udacity.com/course/deep-learning-pytorch--ud188", "anchor_text": "Intro to Deep Learning with PyTorch"}, {"url": "https://pytorch.org/deep-learning-with-pytorch", "anchor_text": "Deep Learning with PyTorch"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow Website"}, {"url": "https://keras.io/", "anchor_text": "Keras Dokumentation"}, {"url": "https://www.udacity.com/course/intro-to-tensorflow-for-deep-learning--ud187", "anchor_text": "Intro to TensorFlow for Deep Learning"}, {"url": "https://www.coursera.org/specializations/tensorflow-in-practice", "anchor_text": "TensorFlow in Practice"}, {"url": "https://github.com/AStoeffelbauer/PyTorchVsTensorFlow/blob/master/blogpost.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ada936fd5406---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----ada936fd5406---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----ada936fd5406---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ada936fd5406---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ada936fd5406---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fada936fd5406&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&user=Andreas+St%C3%B6ffelbauer&userId=b06af985ef2&source=-----ada936fd5406---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fada936fd5406&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&user=Andreas+St%C3%B6ffelbauer&userId=b06af985ef2&source=-----ada936fd5406---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fada936fd5406&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ada936fd5406--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fada936fd5406&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ada936fd5406---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ada936fd5406--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ada936fd5406--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ada936fd5406--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ada936fd5406--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ada936fd5406--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ada936fd5406--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ada936fd5406--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ada936fd5406--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreas.stoeffelbauer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andreas.stoeffelbauer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andreas St\u00f6ffelbauer"}, {"url": "https://medium.com/@andreas.stoeffelbauer/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "172 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb06af985ef2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&user=Andreas+St%C3%B6ffelbauer&userId=b06af985ef2&source=post_page-b06af985ef2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5663ada0bace&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpytorch-vs-tensorflow-in-code-ada936fd5406&newsletterV3=b06af985ef2&newsletterV3Id=5663ada0bace&user=Andreas+St%C3%B6ffelbauer&userId=b06af985ef2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}