{"url": "https://towardsdatascience.com/model-based-reinforcement-learning-cb9e41ff1f0d", "time": 1682995458.764759, "path": "towardsdatascience.com/model-based-reinforcement-learning-cb9e41ff1f0d/", "webpage": {"metadata": {"title": "Model Based Reinforcement Learning | by Ziad SALLOUM | Towards Data Science", "h1": "Model Based Reinforcement Learning", "description": "Update: The best way of learning and practicing Reinforcement Learning is by going to http://rl-lab.com If you have ever played a real-time strategy game (RTS) such as Age of Empires or others, you\u2026"}, "outgoing_paragraph_urls": [{"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com", "paragraph_index": 0}, {"url": "https://medium.com/@zsalloum/basics-of-reinforcement-learning-the-easy-way-fb3a0a44f30e", "anchor_text": "MDP", "paragraph_index": 10}, {"url": "https://medium.com/@zsalloum/basics-of-reinforcement-learning-the-easy-way-fb3a0a44f30e", "anchor_text": "MDP", "paragraph_index": 10}, {"url": "https://towardsdatascience.com/monte-carlo-tree-search-in-reinforcement-learning-b97d3e743d0f", "anchor_text": "Monte Carlo Tree Search (MCTS)", "paragraph_index": 35}, {"url": "https://towardsdatascience.com/monte-carlo-tree-search-in-reinforcement-learning-b97d3e743d0f", "anchor_text": "Monte Carlo Tree Search in Reinforcement Learning", "paragraph_index": 39}, {"url": "https://en.wikipedia.org/wiki/AlphaZero", "anchor_text": "Alpha Zero", "paragraph_index": 39}, {"url": "https://neptune.ai/blog/model-based-and-model-free-reinforcement-learning-pytennis-case-study", "anchor_text": "Model-Based and Model-Free Reinforcement Learning \u2014 Pytennis Case Study", "paragraph_index": 40}], "all_paragraphs": ["Update: The best way of learning and practicing Reinforcement Learning is by going to http://rl-lab.com", "If you have ever played a real-time strategy game (RTS) such as Age of Empires or others, you surely know that you start by an almost black screen. The first thing you do is to send units in every direction to scout the terrain and discover the enemy location, as well as the strategic locations and resources such as mines, forests, etc\u2026", "What you are actually doing is in fact building a map (or model) for the world you are in.After creating this map whether partially or completely you start planning your moves and prepare your upcoming battles.", "By planning, we mean simulating actions in your head without really executing them in the environment of the game. This simulation will save you time, however, it is based on the model you have built. If this model is inaccurate and biased your planning will fall apart.", "Let\u2019s consider the case of a chess game:", "Suppose you are playing a chess game, you made a move, then you waited till your opponent makes his move, then you make another move and your opponent follows with his own move, then you discover that your first move was not that good enough after all! Usually, if you are learning, your teacher will let you roll back the moves so you can learn from your mistake.However, you have lost quite some time.", "On the other hand, if you simulate the moves in your head (which is what everyone does) and tell yourself \u201cif I do this move my opponent can counter with this move, then I do this move, etc\u2026\u201d you would avoid all the previous scenario.", "What you are actually doing is that you are unfolding in your head a search tree based on the model you know about chess, and from this tree, you will choose the best move that will potentially lead to winning.", "Now replace yourself with an AI agent, and you get Model-Based Reinforcement Learning.", "You can clearly see how this will save training time. Of course, it won\u2019t be apparent in small environments with high reactivity (Grid World for example), but for more complex environments such as any Atari game learning via model-free RL methods is time consuming, while on the other hand making a reduced set of actions to create a model, then use this model to simulate episodes is a much more efficient.", "Abstractly, a model is your own representation of the reality or the environment you are in. In RL this translates into having a representation M of the MDP [S, A, P, R]. This means having a version i (better be as accurate as possible) of the real MDP.", "If we assume that the states space S and the the transition probabilities A are known the model Mi will become [S, A, Pi, Ri].", "So according to the model Mi going from state S to S\u2019 after performing action A, is subject to the probability Pi(S\u2019 | S, A), similarly having a reward r\u2019 when at state S and performing action A is subject to the relation Ri ( r\u2019 | S, A).", "Model free methods learn directly for experience, this means that they perform actions either in the real world (ex: robots )or in computer (ex: games). Then they collect the reward from the environment, whether positive or negative, and they update their value functions.", "This is a key difference with Model-Based approach. Model-Free methods act in the real environment to learn.", "Conversely Model-Based algorithm uses a reduced number of interactions with the real environment during the learning phase. It aims to construct a model based on these interactions, and then use this model to simulate the further episodes, not in the real environment but by applying them to the constructed model and get the results returned by that model.", "As described previously, this has the advantage of speeding the learning, since there is no need to wait for the environment to respond nor to reset the environment to some state to resume learning.", "On the downside however, if the model is inaccurate, we risk learning something completely different from the reality.", "Another point worth noting, is that Model-Based algorithm will still use Model-Free methods either to construct the model or in the planning/simulation.", "Learning the model consists of executing actions in the real environment and collect the feedback. We call this experience.", "So for each state and action the environment will provide a new state and reward. Based on this collection of experiences we try to deduce the model.As one can guess, this is no other than supervised learning problem.", "We solve this problem by using one of the supervised learning techniques that are available, it can be a regression or neural networks or something else.", "Depending on the supervised learning technique, the model will be represented by a table lookup, neural network, or others\u2026", "The following example depicts two states A and B with transitions from A to B and from B to two possible terminal states.We assume there is no discount factor.", "To build the model, we run several episodes in the real environment, we collect the landing states and the results and then we deduce the [P, R] of the model as shown below:", "We can see that according to our experience (the tests we run) going from A to be is 100% with 0 reward, while from B to the upper terminal state is 75% of the time with reward 1, and to the lower terminal state 25% of the time with reward 0.", "This tells that if we make a simulation using this model (not the real environment) and we run an arbitrary set of tests (sampling) each time we are at A the model will tell us that we will move to B 100% of the time with r = 0 and each time we are at be we can go up 75% of the time with r = 1 and 25% of the time with r =0.", "Now we can compute the value function using a method such as Monte Carlo which leads in our example to V(A) = 1 and V(B) = .75.As a reminder of Monte Carlo value computation:G(s) = r + \ud835\udec4 G(s\u2019) where G is the return at state s after each episode.V(s) = average G(s) for all episodes", "In summary the main loop of Model-Based RL is as follows:", "A variation of the Model-Based RL, called Dyna Architecture. Instead of using the real experience to only construct a model, it is also used to update the value functions.", "The algorithm starts by initializing the Q and Model then enters the main loop. It starts at the current state, selects an action according to a policy, execute the action in the real environment, observes the reward R and the new state S\u2019. With the R and S\u2019 available it updates Q(S,A) and the Model.Note that S\u2019 becomes now the current state.Now it enters the planning phase. The algorithm enters a second loop which it iterates n times, inside this loop the algorithm randomly selects a state and an associated action, apply them to the model and gets the reward and the new state from the Model, then it updates the Q(S,A) as in the outer loop.", "It can be brought to your attention that the planning phase as described previously, randomly samples state from the observed state space, and does not give any emphasis on the current state the agent is in.", "Simulation Based search changes this process by taking the current state St which we arrived to in the real environment and the planning phase it runs multiple simulation starting from St. Notice that this is no more random state as in Dyna-Q.", "So the planning phase is becomes now a loop that generates K episodes from the model M starting from the current state St.", "The superscript k refers to the index of the episode, where K is the total number of episodes.", "Simulation-Based search of the planning phase gives place to many types of implementations, such as Simple Monte Carlo Search, Monte Carlo Tree Search (MCTS).", "Simple Monte Carlo Search consists of a Model and a simulation policy \u03c0 (policy dedicated for the planning phase).Then starting from the real current state St, we take each possible action a and we generate K simulation starting St and action a.", "After that evaluate each simulation by computing Q(St, a) as the average of all returns of the simulated episodes", "Now choose the action to execute in the real environment by selecting the one that maximizes the Q value function at St", "The Monte Carlo Tree Search algorithm has been discussed in detail in the article Monte Carlo Tree Search in Reinforcement Learning. It is used as a building block of Alpha Zero from Deep Mind.", "You might also be interested in the following article: Model-Based and Model-Free Reinforcement Learning \u2014 Pytennis Case Study", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcb9e41ff1f0d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://zsalloum.medium.com/?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2----cb9e41ff1f0d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcb9e41ff1f0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcb9e41ff1f0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@herrherrmann?utm_source=medium&utm_medium=referral", "anchor_text": "Sebastian Herrmann"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://rl-lab.com/", "anchor_text": "http://rl-lab.com"}, {"url": "https://medium.com/@zsalloum/basics-of-reinforcement-learning-the-easy-way-fb3a0a44f30e", "anchor_text": "MDP"}, {"url": "https://medium.com/@zsalloum/basics-of-reinforcement-learning-the-easy-way-fb3a0a44f30e", "anchor_text": "MDP"}, {"url": "https://towardsdatascience.com/monte-carlo-tree-search-in-reinforcement-learning-b97d3e743d0f", "anchor_text": "Monte Carlo Tree Search (MCTS)"}, {"url": "https://towardsdatascience.com/monte-carlo-tree-search-in-reinforcement-learning-b97d3e743d0f", "anchor_text": "Monte Carlo Tree Search in Reinforcement Learning"}, {"url": "https://en.wikipedia.org/wiki/AlphaZero", "anchor_text": "Alpha Zero"}, {"url": "https://neptune.ai/blog/model-based-and-model-free-reinforcement-learning-pytennis-case-study", "anchor_text": "Model-Based and Model-Free Reinforcement Learning \u2014 Pytennis Case Study"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cb9e41ff1f0d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/model-based-learning?source=post_page-----cb9e41ff1f0d---------------model_based_learning-----------------", "anchor_text": "Model Based Learning"}, {"url": "https://medium.com/tag/simulation-learning?source=post_page-----cb9e41ff1f0d---------------simulation_learning-----------------", "anchor_text": "Simulation Learning"}, {"url": "https://medium.com/tag/monte-carlo?source=post_page-----cb9e41ff1f0d---------------monte_carlo-----------------", "anchor_text": "Monte Carlo"}, {"url": "https://medium.com/tag/tree-search?source=post_page-----cb9e41ff1f0d---------------tree_search-----------------", "anchor_text": "Tree Search"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcb9e41ff1f0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----cb9e41ff1f0d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcb9e41ff1f0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&user=Ziad+SALLOUM&userId=1f2b933522e2&source=-----cb9e41ff1f0d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcb9e41ff1f0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcb9e41ff1f0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cb9e41ff1f0d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cb9e41ff1f0d--------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://zsalloum.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ziad SALLOUM"}, {"url": "https://zsalloum.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "845 Followers"}, {"url": "https://rl-lab.com", "anchor_text": "https://rl-lab.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f2b933522e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&user=Ziad+SALLOUM&userId=1f2b933522e2&source=post_page-1f2b933522e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F408fc441c93b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodel-based-reinforcement-learning-cb9e41ff1f0d&newsletterV3=1f2b933522e2&newsletterV3Id=408fc441c93b&user=Ziad+SALLOUM&userId=1f2b933522e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}