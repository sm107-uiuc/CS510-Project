{"url": "https://towardsdatascience.com/microbe-classification-using-deep-learning-e84312046334", "time": 1682999827.814147, "path": "towardsdatascience.com/microbe-classification-using-deep-learning-e84312046334/", "webpage": {"metadata": {"title": "Microbe Classification Using Deep Learning | by Steven | Towards Data Science", "h1": "Microbe Classification Using Deep Learning", "description": "Problem: microbe identification using light microscopy can be time consuming and requires well trained microbiologists. Can deep learning algorithm successfully differentiate between 12 different\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/rtx-2060-vs-gtx-1080ti-in-deep-learning-gpu-benchmarks-cheapest-rtx-vs-most-expensive-gtx-card-cd47cd9931d2", "anchor_text": "https://towardsdatascience.com/rtx-2060-vs-gtx-1080ti-in-deep-learning-gpu-benchmarks-cheapest-rtx-vs-most-expensive-gtx-card-cd47cd9931d2", "paragraph_index": 13}], "all_paragraphs": ["Problem: microbe identification using light microscopy can be time consuming and requires well trained microbiologists. Can deep learning algorithm successfully differentiate between 12 different classes of microbes?", "The entire dataset contains 660 images with 33 different genera and species. As a proof of concept project, I will be only be working with 12 different classes today: Acinetobacter baumanii, Actinomyces israelii, Bacteroides fragilis, Candida albicans, Clostridium perfringens, Enterococcus faecalis, Escherichia coli, Listeria monocytogenes, Neisseria gonorrhoeae, Proteus spp., Pseudomonas aeruginosa, Staphylococcus aureus", "I chose these 12 as they are some of the more medically relevant microbes in the dataset.", "Each class includes approximately 20 images with resolution of 2048 x 1532 pixels. The samples were Gram stained and evaluated using 100x objective under oil-immersion. Images were taken with Olympus CX31 microscope equipped with SC30 camera.", "I decided to break up the images into smaller blocks as the original size of 2048 x 1532 is rather large. For instance, take a look at the original image below. The microbes are physically small and if we resize it to 224 x 224, important features such as edges and clusters may be lost.", "I wrote a custom function to break up the image into 224 x 224 blocks.", "I ran the code for each class, changing the folder name as necessary.", "The end product looks like this:", "For most of the original images, the microbes are distributed evenly across the slide. However, the slides for some classes such as candida are less homogeneous and contain empty areas. To resolve this, I looked through the end products and manually deleted blank slides.", "We are now ready for model building and training.", "First, we import the necessary modules.", "My folder structure: Parent folder (C:\\bacteria\\data)\u2192 sub-folders with class names (C:\\bacteria\\data\\candida) \u2192 images", "We have 12 different classes with 10,234 training images and 2,558 validation images.", "Fasti.ai supports mixed precision training and it\u2019s as simple as adding .to_fp16() when building the learner. For those with NVIDIA RTX graphic cards, mixed precision greatly speeds up training and halves the memory requirement. Eric has an excellent article on this and you can read it here: https://towardsdatascience.com/rtx-2060-vs-gtx-1080ti-in-deep-learning-gpu-benchmarks-cheapest-rtx-vs-most-expensive-gtx-card-cd47cd9931d2", "The results are already looking pretty good even without training the top layers. We will now unfreeze the top layers and find a suitable learning rate.", "I trained the entire model further with a reduced learning rate.", "At the end of 10 epochs, we achieved an accuracy of 99.6%. There is no significant over-fitting as the training and validation loss are similar. Let\u2019s take a look at the confusion matrix.", "The main errors seem to be arising from proteus vs. pseudomonas and E.coli vs. proteus. This is understandable as all 3 species are gram-negative rods which stain and appear similar under the light microscope. Let\u2019s take a look at the images with top losses.", "In conclusion, we achieved admirable accuracy of 99.6% on this rather difficult task. In fact, I am rather surprised by the performance as it is extremely difficult to differentiate between some of the classes visually. For instance, can you tell Staphylococcus. aureus and Enterococcus. fecalis apart?", "Perhaps the model is learning features which I have not yet recognized and further work is needed to improve the \u201cexplainability\u201d of this model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Medical doctor and aspiring AI practitioner. I aim to bring advances in deep learning and data science to healthcare."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe84312046334&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e84312046334--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e84312046334--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@steven827?source=post_page-----e84312046334--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@steven827?source=post_page-----e84312046334--------------------------------", "anchor_text": "Steven"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F474be7e867ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&user=Steven&userId=474be7e867ec&source=post_page-474be7e867ec----e84312046334---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe84312046334&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe84312046334&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@peter_mc_greats?utm_source=medium&utm_medium=referral", "anchor_text": "Pietro De Grandi"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://misztal.edu.pl/software/databases/dibas/", "anchor_text": "http://misztal.edu.pl/software/databases/dibas/"}, {"url": "https://unsplash.com/@matyssik?utm_source=medium&utm_medium=referral", "anchor_text": "Ian Matyssik"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@ro_ka?utm_source=medium&utm_medium=referral", "anchor_text": "Robert Katzki"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/rtx-2060-vs-gtx-1080ti-in-deep-learning-gpu-benchmarks-cheapest-rtx-vs-most-expensive-gtx-card-cd47cd9931d2", "anchor_text": "https://towardsdatascience.com/rtx-2060-vs-gtx-1080ti-in-deep-learning-gpu-benchmarks-cheapest-rtx-vs-most-expensive-gtx-card-cd47cd9931d2"}, {"url": "https://unsplash.com/@ethandow?utm_source=medium&utm_medium=referral", "anchor_text": "Ethan Dow"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e84312046334---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e84312046334---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/fastai?source=post_page-----e84312046334---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----e84312046334---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/tag/microbiology?source=post_page-----e84312046334---------------microbiology-----------------", "anchor_text": "Microbiology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe84312046334&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&user=Steven&userId=474be7e867ec&source=-----e84312046334---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe84312046334&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&user=Steven&userId=474be7e867ec&source=-----e84312046334---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe84312046334&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e84312046334--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe84312046334&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e84312046334---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e84312046334--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e84312046334--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e84312046334--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e84312046334--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e84312046334--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e84312046334--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e84312046334--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e84312046334--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@steven827?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@steven827?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Steven"}, {"url": "https://medium.com/@steven827/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "79 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F474be7e867ec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&user=Steven&userId=474be7e867ec&source=post_page-474be7e867ec--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5849a113ba7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmicrobe-classification-using-deep-learning-e84312046334&newsletterV3=474be7e867ec&newsletterV3Id=5849a113ba7d&user=Steven&userId=474be7e867ec&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}