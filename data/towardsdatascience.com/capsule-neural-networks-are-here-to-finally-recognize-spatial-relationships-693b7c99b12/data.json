{"url": "https://towardsdatascience.com/capsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12", "time": 1682993269.356502, "path": "towardsdatascience.com/capsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12/", "webpage": {"metadata": {"title": "Capsule Neural Networks: The Next Neural Networks? Part 1: CNNs and their problems. | by Tomer Eldor | Towards Data Science", "h1": "Capsule Neural Networks: The Next Neural Networks? Part 1: CNNs and their problems.", "description": "Neural Networks may be the hottest field in Machine Learning. In recent years, there were many new developments improving neural networks and building making them more accessible. However, they were\u2026"}, "outgoing_paragraph_urls": [{"url": "https://research.google.com/pubs/GeoffreyHinton.html", "anchor_text": "Geoffery Hinton", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1710.09829", "anchor_text": "Dynamic Routing Between Capsules", "paragraph_index": 1}, {"url": "https://quip.com/a4MBABJJB7oN", "anchor_text": "Understanding Convolutional Neural Networks", "paragraph_index": 6}, {"url": "https://www.youtube.com/watch?v=rTawFwUvnLE&feature=youtu.be", "anchor_text": "watch Hinton's lecture", "paragraph_index": 8}, {"url": "https://www.youtube.com/watch?v=TFIMqt0yT2I&feature=youtu.be", "anchor_text": "(Hinton, 2012", "paragraph_index": 12}, {"url": "http://helper.ipam.ucla.edu/publications/gss2012/gss2012_10754.pdf", "anchor_text": "took inspiration", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Pose_(computer_vision)", "anchor_text": "pose", "paragraph_index": 17}, {"url": "http://digitalrune.github.io/DigitalRune-Documentation/html/d995ee69-0650-4993-babd-1cdb1fd8fd7a.htm", "anchor_text": "matrix", "paragraph_index": 17}], "all_paragraphs": ["This is part of a series of posts built to teach about Capsule Neural Networks. This first post will explain about \u201cnormal\u201d (convolutional) Neural Networks and their problems.", "Neural Networks may be the hottest field in Machine Learning. In recent years, there were many new developments improving neural networks and building making them more accessible. However, they were mostly incremental, such as adding more layers or slightly improving the activation function, but did not introduce a new type of architecture or topic. Geoffery Hinton is one of the founding fathers of many highly utilized deep learning algorithms including many developments to Neural Networks \u2014 no wonder, for having Neurosciences and Artificial Intelligence background.   At late October 2017, Geoffrey Hinton, Sara Sabour, and Nicholas Frosst Published a research paper under Google Brain named \u201cDynamic Routing Between Capsules\u201d, introducing a true innovation to Neural Networks. This is exciting, since such development has been long awaited for, will likely spur much more research and progress around it, and is supposed to make neural networks even better than they are now.", "Convolutional Neural Networks (CNNs) are extremely flexible machine learning models which were originally inspired by principles from how our brains are theorized to work.", "Neural Networks utilize layers of \u201cneurons\u201d to process raw data into patterns and objects.", "The primary building blocks of a Neural Network is a \u201cConvolutional\u201d layer (hence the name). What does it do? It takes raw information from a previous layer, makes sense of patterns in it, and send it onward to the next layer to make sense of a larger picture.  If you are new to neural networks and want to understand it, I recommend:", "Let\u2019s start from the beginning.  The Neural Net receives raw input data. Let\u2019s say it\u2019s a doodle of a dog. When you see a dog, you brain automatically detects it\u2019s a dog. But to the computer, the image is really just an array of numbers representing the colors intensity in the colors channels. Let\u2019s say it\u2019s just a Black&White doodle, so we can represent it with one array where each cell represents the brightness of the pixel from black to white.", "What is our goal? Our goal is for the net to make visual sense of what is in the picture (which is for it just a sequence of numbers). One way to do it is bottom-up: start by looking at small groups of pixels, make sense of them (like small lines and curves: the curve of the dog\u2019s ear, the small circle of its pupil, the small line in its leg), then build those up to bigger groups of these lines and curves (like: ear, nose, snout, eye), make sense of bigger groups of these shapes (like: face, leg, tail), and finally make sense of the entire picture of the dog.  It does so with many layers transferring information in a sequence from one to another.  If this was new to you, see my summary of Convolutional Networks Structure here: Understanding Convolutional Neural Networks.  In case you didn\u2019t read it but it\u2019s still new to you, below is an even shorter summary of that summary:", "Usually, there are more layers which provide nonlinearities and preservation of dimensions (like padding with 0\u2019s around the edges) that help to improve the robustness of the network and control overfitting. But these are the basics you need to understand what comes after.  Now, importantly, these layers are connected only SEQUENTIALLY. This is in contrast to the structure of capsule networks.", "If this interests you, watch Hinton's lecture explaining exactly what it wrong with them. Below you'll get a couple of key points that are improved by Capsule Networks.", "Hinton says that they have too few levels of substructures (nets are composed from layers composed from neurons, that's it); and that we need to group the neurons in each layer into \u201ccapsules\u201d, like mini-columns, that do a lot of internal computations, and then output a summary result.", "CNN use \u201cpooling\u201d or equivalent methods to \u201csummarize\u201d what's going on in the smaller regions and make sense of larger and larger chunks of the image. This was a solution that made CNNs work well, but it looses valuable information.   Capsule networks will compute a pose (transnational and rotational) relationship between smaller features to make up a larger feature. This loss of information leads to loss of spatial information.", "Subsampling (and pooling) loses the precise spatial relationships between higher-level parts like a nose and a mouth. The precise spatial relationships are needed for identity recognition.", "(Hinton, 2012, in his lecture).  CNNs don't account for spatial relationships between the underlying objects. By having these flat layers of neurons that light up according to which objects they've seen, they recognize the presence of such objects. But then they are passed on to other activation and pooling layers and on to the next layer of neurons (filters), without recognizing what are the relations between these objects we identified in that single layer.  They just account for their presence.   So a (simplistic) Neural network will not hesitate about categorizing both these dogs, Pablo and Picasso, as similarly good representations of \u201ccorgi-pit-bull-terrier mix\u201d.", "The network will categorize both these dogs as similarly good representations of \u201ccorgi-pit-bull-terrier mix\u201d dogs because they both answer the same conditions at the face composition convolutional layer, for example:", "Incorrectly activating the neuron for pitbullmix_face, Instead of something like:", "Conversely, capsule networks represent directionality along with content and connect between capsules of neurons to infer spatial relationships and retain pose information.   Lacking a grouped capsule representation, pose calculations, and overlapping check between the capsules leads to the next problem.", "This makes them more sensitive to the original image itself in order to classify images as the same category.   CNNs are great for solving problems with data similar to what they have been trained on. It can classify images or objects within them which are very close to things it has seen before.   But if the object is slightly rotated, photographed from a slightly different angle, especially in 3D, is tilted or in another orientation than what the CNN has seen - the network won't recognize it well.   One solution is to artificially create tilted representation of the image or groups and add them to the \u201ctraining\u201d set. However, this still lacks a fundamentally more robust structure.", "So how can we encode spatial relationships between 3D objects? Hinton took inspiration from a field that already solved that problem: 3D computer graphics. In 3D graphics, a pose matrix is a special technique to represent the relationships between objects. Poses are essentially matrices representing translation plus rotation. Now we got it. We can retain spatial relationships information using pose relationships between sub-objects; measuring the relative rotations and translations between objects as a 4D pose matrix. This would be key to understanding dynamic routing between capsules.", "Now that we know the basics of Neural Networks and their spatial recognition problems, we can continue to learn about the recently developed solution to that: Capsule Neural Network. That will be the topic of my next post. Stay tuned!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate about data science & AI for social good and making great user-focused products. A Jazz composer living every 4 months in another country."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F693b7c99b12&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----693b7c99b12--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----693b7c99b12--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tomereldor?source=post_page-----693b7c99b12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tomereldor?source=post_page-----693b7c99b12--------------------------------", "anchor_text": "Tomer Eldor"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e1f834f513c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&user=Tomer+Eldor&userId=9e1f834f513c&source=post_page-9e1f834f513c----693b7c99b12---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F693b7c99b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F693b7c99b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://research.google.com/pubs/GeoffreyHinton.html", "anchor_text": "Geoffery Hinton"}, {"url": "https://arxiv.org/abs/1710.09829", "anchor_text": "Dynamic Routing Between Capsules"}, {"url": "https://www.youtube.com/watch?v=aircAruvnKk", "anchor_text": "3Blue1Brown"}, {"url": "https://adeshpande3.github.io/adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/", "anchor_text": "beginner\u2019s blogpost"}, {"url": "http://cs231n.github.io/convolutional-networks/", "anchor_text": "this guide from CS231 at Stanford"}, {"url": "https://www.thesun.co.uk/living/3009674/dog-called-picasso-because-of-his-wonky-face-is-looking-for-a-new-home-and-offers-are-already-flooding-in/", "anchor_text": "The Sun, image: lovable dog rescue"}, {"url": "https://quip.com/a4MBABJJB7oN", "anchor_text": "Understanding Convolutional Neural Networks"}, {"url": "https://quip.com/a4MBABJJB7oN", "anchor_text": "Understanding Convolutional Neural Networks"}, {"url": "https://pdfs.semanticscholar.org/d8b9/eadcadb12d4d4e19201b4c5519470e21114c.pdf", "anchor_text": "From a Google article be Szegedy, Toshev & Erhan presenting Neural Networks"}, {"url": "https://www.youtube.com/watch?v=rTawFwUvnLE&feature=youtu.be", "anchor_text": "watch Hinton's lecture"}, {"url": "https://www.youtube.com/watch?v=TFIMqt0yT2I&feature=youtu.be", "anchor_text": "(Hinton, 2012"}, {"url": "https://www.thesun.co.uk/living/3009674/dog-called-picasso-because-of-his-wonky-face-is-looking-for-a-new-home-and-offers-are-already-flooding-in/", "anchor_text": "The Sun. Image: Lovable Dog Rescue"}, {"url": "http://helper.ipam.ucla.edu/publications/gss2012/gss2012_10754.pdf", "anchor_text": "took inspiration"}, {"url": "https://en.wikipedia.org/wiki/Pose_(computer_vision)", "anchor_text": "pose"}, {"url": "http://digitalrune.github.io/DigitalRune-Documentation/html/d995ee69-0650-4993-babd-1cdb1fd8fd7a.htm", "anchor_text": "matrix"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----693b7c99b12---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----693b7c99b12---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/capsule-networks?source=post_page-----693b7c99b12---------------capsule_networks-----------------", "anchor_text": "Capsule Networks"}, {"url": "https://medium.com/tag/data-science?source=post_page-----693b7c99b12---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/ai?source=post_page-----693b7c99b12---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F693b7c99b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&user=Tomer+Eldor&userId=9e1f834f513c&source=-----693b7c99b12---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F693b7c99b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&user=Tomer+Eldor&userId=9e1f834f513c&source=-----693b7c99b12---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F693b7c99b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----693b7c99b12--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F693b7c99b12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----693b7c99b12---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----693b7c99b12--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----693b7c99b12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----693b7c99b12--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----693b7c99b12--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----693b7c99b12--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----693b7c99b12--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----693b7c99b12--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----693b7c99b12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tomereldor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tomereldor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tomer Eldor"}, {"url": "https://medium.com/@tomereldor/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "180 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e1f834f513c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&user=Tomer+Eldor&userId=9e1f834f513c&source=post_page-9e1f834f513c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2f7b56d17364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcapsule-neural-networks-are-here-to-finally-recognize-spatial-relationships-693b7c99b12&newsletterV3=9e1f834f513c&newsletterV3Id=2f7b56d17364&user=Tomer+Eldor&userId=9e1f834f513c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}