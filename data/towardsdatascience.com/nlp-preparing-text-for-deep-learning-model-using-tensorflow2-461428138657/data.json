{"url": "https://towardsdatascience.com/nlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657", "time": 1683010153.451222, "path": "towardsdatascience.com/nlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657/", "webpage": {"metadata": {"title": "NLP: Preparing text for deep learning model using TensorFlow2 | by Sudip Shrestha, PhD | Towards Data Science", "h1": "NLP: Preparing text for deep learning model using TensorFlow2", "description": "Natural Language Processing (NLP) is commonly used in text classification tasks such as spam detection and sentiment analysis, text generation, language translations and document classification. Text\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/ShresthaSudip/Text-Preprocessing-Tensorflow2", "anchor_text": "GitHub page", "paragraph_index": 2}, {"url": "https://www.youtube.com/watch?v=fNxaJsNG3-s", "anchor_text": "NLP zero to hero", "paragraph_index": 22}], "all_paragraphs": ["Natural Language Processing (NLP) is commonly used in text classification tasks such as spam detection and sentiment analysis, text generation, language translations and document classification. Text data can be considered either in sequence of character, sequence of words or sequence of sentences. Most commonly, text data are considered as sequence of words for most problems. In this article we will delve into, pre-processing using simple example text data. However, the steps discussed here are applicable to any NLP tasks. Particularly, we\u2019ll use TensorFlow2 Keras for text pre-processing which include:", "The figure below depicts the process of text pre-processing along with example outputs.", "First, let\u2019s import the required libraries. (A complete Jupyter notebook is available in my GitHub page).", "Tokenizer is an API available in TensorFlow Keras which is used to tokenize sentences. We have defined our text data as sentences (each separated by a comma) and with an array of strings. There are 4 sentences including 1 with a maximum length of 5. Our text data also includes punctuations as shown below.", "As deep learning models do not understand text, we need to convert text into numerical representation. For this purpose, a first step is Tokenization. The Tokenizer API from TensorFlow Keras splits sentences into words and encodes these into integers. Below are hyperparameters used within Tokenizer API:", "Let\u2019s use the Tokenizer and print out word index. We have used num_words= 100 which is a lot for this data as there are only 9 distinct words and <OOV> string for out of vocabulary token.", "As seen above, each word in our sentences has been converted to numerical tokens. For instance, \u201ci\u201d has a value of 2. The tokenizer also ignored the exclamation mark after the word. For example, there is only one token for the word \u201cplay\u201d or \u201cplay!\u201d i.e. 4.", "Next, let\u2019s represent each sentence by sequences of numbers using texts_to_sequences from tokenizer object. Below, we printed out raw sentences, word index and sequences.", "As shown above, texts are represented by sequences. For example,", "In any raw text data, naturally there will be sentences of different lengths. However, all neural networks require to have inputs with the same size. For this purpose, padding is done. Below, let\u2019s use pad_sequences for padding. pad_sequences uses arguments such as sequences, padding, maxlen, truncating, value and dtype.", "Let\u2019s focus on important arguments used in pad_sequences : padding, maxlen and truncating.", "Use of \u2018pre\u2019 or \u2018post\u2019 padding depends upon the analysis. In some cases, padding at the beginning is appropriate while not in others. For instance, if we use Recurrent Neural Network (RNN) for spam detection, then padding at the beginning would be appropriate as RNN can not learn long distance patterns. Padding at the beginning allows us to keep the sequences in the end hence RNN can make use of these sequences for prediction of next. However, in any case padding should be done after careful consideration and business knowledge.", "Below, the outputs for \u2018pre\u2019 followed by \u2018post\u2019 padding are shown with default maxlen value of maximum length of sequence.", "In our example above, the sequence with maximum length is [ 2, 6, 3, 7, 8] which corresponds to \u201cI want to go out\u201d. When padding =\u2019pre\u2019 is used, padded value of 0 is added at the beginning of all other sequences. Because other sequences have shorter sequence than [ 2, 6, 3, 7, 8], padding actually made all other sequences to be of same size with this sequence.", "Whereas, when padding = \u2018post\u2019 is used , padded value i.e. 0 is added at the end of the sequences.", "pre and post padding with maxlen and truncating option", "We can use both padding and truncating argument together if needed. Below we have shown two-scenarios, 1) pre padding with pre truncation and 2) pre padding with post truncation", "The truncating with \u2018pre\u2019 option allows us to truncate the sequence at the beginning. Whereas, truncating with \u2018post\u2019 will truncate the sequence at the end.", "Let\u2019s look at the example of pre padding with pre truncation.", "By use of maxlen =4, we are truncating the length of padded sequences to 4. As shown, above, the use of maxlen=4 impacted the first sequence [2, 6, 3, 7, 8]. This sequence had length of 5 and is truncated to 4. The truncation happened at the beginning as we used truncating = \u2018pre\u2019 option.", "Let\u2019s look at the truncation = \u2018post\u2019 option.", "The truncation happened at the end as we used truncating = \u2018post\u2019 option. When the post truncation was applied, it impacted the first sequence [ 2, 6, 3, 7, 8] and truncated to length 4 resulting in the sequence [ 2, 6, 3, 7].", "In this article, we focused on pre-processing raw text data and preparing it for deep learning models. Specifically, we covered tokenizing sentences, representing it as sequences and padding it to make all the sequences of same length. This padded sequences are now ready for train/test split that can be used for neural network. Please refer to video by Laurence Moroney\u2019s NLP zero to hero for further reading.", "In future articles, I will explain how we can use pre-processing in real-world data and use such padded sequence data with embedding in deep learning models.", "Thanks for reading this and please leave if any comments or suggestions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist and quantitative analyst. Enjoy extracting information from the data and sharing ideas on Machine Learning and deep learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F461428138657&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----461428138657--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----461428138657--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@statistics.sudip?source=post_page-----461428138657--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@statistics.sudip?source=post_page-----461428138657--------------------------------", "anchor_text": "Sudip Shrestha, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F73ef351df97a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&user=Sudip+Shrestha%2C+PhD&userId=73ef351df97a&source=post_page-73ef351df97a----461428138657---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F461428138657&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F461428138657&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/ShresthaSudip/Text-Preprocessing-Tensorflow2", "anchor_text": "GitHub page"}, {"url": "https://www.youtube.com/watch?v=fNxaJsNG3-s", "anchor_text": "NLP zero to hero"}, {"url": "https://medium.com/tag/nlp?source=post_page-----461428138657---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----461428138657---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----461428138657---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/data-science?source=post_page-----461428138657---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----461428138657---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F461428138657&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&user=Sudip+Shrestha%2C+PhD&userId=73ef351df97a&source=-----461428138657---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F461428138657&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&user=Sudip+Shrestha%2C+PhD&userId=73ef351df97a&source=-----461428138657---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F461428138657&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----461428138657--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F461428138657&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----461428138657---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----461428138657--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----461428138657--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----461428138657--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----461428138657--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----461428138657--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----461428138657--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----461428138657--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----461428138657--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@statistics.sudip?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@statistics.sudip?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sudip Shrestha, PhD"}, {"url": "https://medium.com/@statistics.sudip/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "60 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F73ef351df97a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&user=Sudip+Shrestha%2C+PhD&userId=73ef351df97a&source=post_page-73ef351df97a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa2b8b3526913&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnlp-preparing-text-for-deep-learning-model-using-tensorflow2-461428138657&newsletterV3=73ef351df97a&newsletterV3Id=a2b8b3526913&user=Sudip+Shrestha%2C+PhD&userId=73ef351df97a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}