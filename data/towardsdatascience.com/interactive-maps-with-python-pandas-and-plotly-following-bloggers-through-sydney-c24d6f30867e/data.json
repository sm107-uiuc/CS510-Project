{"url": "https://towardsdatascience.com/interactive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e", "time": 1683003227.420325, "path": "towardsdatascience.com/interactive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e/", "webpage": {"metadata": {"title": "Interactive maps with Python, Pandas and Plotly | by JP Hwang | Towards Data Science", "h1": "Interactive maps with Python, Pandas and Plotly", "description": "In this article and another few, I will explore Python and Plotly to put together a few different awesome looking charts. Plotly.js is a Javascript-based visualisation library, built by a company\u2026"}, "outgoing_paragraph_urls": [{"url": "https://gitlab.com/jphwang/online_articles", "anchor_text": "GitLab repository", "paragraph_index": 2}, {"url": "https://www.mapbox.com", "anchor_text": "set one up with them", "paragraph_index": 10}, {"url": "https://gitlab.com/jphwang/online_articles", "anchor_text": "repo here", "paragraph_index": 13}, {"url": "https://plot.ly/python/mapbox-layers/", "anchor_text": "in this guide", "paragraph_index": 21}, {"url": "https://twitter.com/_jphwang", "anchor_text": "twitter", "paragraph_index": 39}], "all_paragraphs": ["In this article and another few, I will explore Python and Plotly to put together a few different awesome looking charts. Plotly.js is a Javascript-based visualisation library, built by a company (also) called Plotly, and they also provide wrappers for various languages, including a python wrapper called\u2026 plotly.", "Despite their unfortunate naming schema, they\u2019ve really put together a very powerful, yet still very customisable, library, and I\u2019m excited to explore what it can do.", "You can follow along with the source code that I use, and the data, from this GitLab repository.", "I often read articles, like food blogs, or travel blogs, and think: where exactly are these places?", "Over the last Christmas break, I had the opportunity to travel back to Sydney with my partner, who had never been to Australia, let alone Sydney. I am from Sydney, and wanted to help her see the \u201cbest\u201d of Sydney, and appreciate it as many of us do.", "So I read a few travel blogs to see what first-time visitors loved about Sydney. It struck me in doing so that a visitor would be easily confused about where everything was and which sights are worth seeing. Planning each days\u2019 schedule would be a pain as it was never clear as to how far one place was in comparison to another.", "My solution to all this was to plot a map, with three goals in mind:", "Plotly has my go-to visualisation library for anything custom. I had seen that it includes an amazing MapBox integration, which I had not tried before. So I thought I would kill the proverbial two birds with one stone.", "I assume you\u2019re familiar with python. Even if you\u2019re relatively new, this tutorial shouldn\u2019t be too tricky, though.", "You\u2019ll need pandas and plotly Install them (in your virtual environment) with a simple pip install [PACKAGE_NAME].", "If you do not have a Mapbox token, set one up with them \u2014 we are going to want to need it. They offer a very free account with very reasonable access limits.", "I save my key in a file, and load it in with:", "It was slightly painful to collate this information, despite using NLP tools due to people insisting on misspelling names on their blog, or simply calling things by different names. (\u2018Harbour Bridge\u2019 or \u2018Sydney Harbour Bridge\u2019? \u2018Queen Victoria Building\u2019 or QVB\u2019?)", "This tutorial is focussed on Plotly and not scraping, so I will provide loc_data.csv (all data and scripts are available on my repo here). This file includes data for all unique locations that we're going to look at. And the data from each blog is included in the data_csvs subdirectory, named blog_file[N].csv.", "Load the csv file into a dataframe, and take a look at its contents:", "You\u2019ll see that there are five columns: index, location, lat, lon and type.", "They are the index number, location name string, latitude and longitude in decimals and the type of location.", "The \u2018type\u2019 column looks categorical upon first inspection. All unique values in a column can be collated by loc_df.type.unique(). And it shows ['Area', nan, 'Food/Drinks', 'Transport', 'Lodging']. Indeed they are! I remember that the NaN values are those which I couldn't come up with a category for. Let's give them a name, Misc for miscellaneous.", "The easiest way to do this is to use pandas\u2019 .fillna method with the inplace parameter. loc_df.type.fillna('Misc', inplace=True) will do the trick, and fill in any NaN values.", "By this stage, we actually already have enough information to plot something! Through the magic of plotly, we just need these lines of code for our first map:", "Something like this should have opened on your browser (or in your Jupyter notebook). Isn\u2019t that cool? It took just three lines of code to plot this. Plotly Express makes it much faster to create plots. The map is interactive, so have a look zooming, panning, looking at the markers and isolating each plot by clicking on the legends.", "What we\u2019re doing here is passing the entire dataframe to the .scatter_mapbox function, and specifying the columns where the data resides. Then we specify the open-street-map style (available styles are listed in this guide) using update_layout.", "If you\u2019re wondering how we passed the mapbox_key variable that we loaded earlier to Plotly, the answer is that we haven't. Using the open-street-map style means that a mapbox key is not needed, Open Street Map being a free, collaborative project.", "Now that we know how to make a basic map, let\u2019s get into the weeds, really looking at the data closely, and adding some bells and whistles.", "While playing with the map, you probably noticed the mouseover tooltips. They\u2019re great but not particularly informative. So let\u2019s fix that. We want to see the name of the place, and don\u2019t care much for the exact coordinates. Let\u2019s specify parameters hover_name='location', and hover_data=['type'] instead.", "I also thought the colourful map was a little distracting from the overlays, so I change the mapbox style to light, and now we need to provide the mapbox key. Lastly, I thought the map was initially too high up, when I am mostly interested in the Sydney metro area. So let's change the default mapped area by specifying the zoom parameter. The code and the resulting map are below:", "Okay, that\u2019s a huge improvement. And we\u2019ve now met two of our three objectives. For the last one, we\u2019re going to have to compile counts of locations. So, back to the dataframe we go.", "I wanted to see which destinations, or locations, were the most popular by bloggers. So in this section, we will count up how many times each location has been included.", "The first step is to count up which of the locations in the master list are in each blog, and sort the resulting dataframe:", "The loc_in_list function is something I wrote to compare location names to a list, taking into account various combinations of including/omitting the word 'the', and various apostrophe/quote symbol.", "Looking at the dataframe again, looks like we\u2019ve got a dataframe sorted by counts of occurrences. \u2018Harbour Bridge\u2019 makes an appearance on every list with 6!", "We can add a sizing parameter (and max_size to control symbol sizes), and plot the map again:", "The eagle-eyed among you might have noticed these, overlapping locations.", "For places like these, I\u2019m going to look at overlapping locations and just go with the location of the names with the higher counts.", "I simply loop over every row, and look for rows with distances less than a threshold:", "The data is now ready to be plotted! I also turn off the displaybar & disable edits, which I put in on all my plots.", "Look at that \u2014 the points on the bridge have been joined, the names added to each other, and count incremented!", "And so we have an interactive, filterable by category, with tooltips!", "That finishes this writeup on scatter plotting on a map. Hopefully that was interesting to you.", "If you liked this, say \ud83d\udc4b / follow on twitter, or follow for updates.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech / Data science writer & educator; Python dev; sports analytics enthusiast. \ud83c\udde6\ud83c\uddfa \ud83d\udc26: @_jphwang"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc24d6f30867e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@_jphwang?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": "JP Hwang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F964fe0870229&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&user=JP+Hwang&userId=964fe0870229&source=post_page-964fe0870229----c24d6f30867e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc24d6f30867e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc24d6f30867e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://gitlab.com/jphwang/online_articles", "anchor_text": "GitLab repository"}, {"url": "https://www.mapbox.com", "anchor_text": "set one up with them"}, {"url": "https://gitlab.com/jphwang/online_articles", "anchor_text": "repo here"}, {"url": "https://plot.ly/python/mapbox-layers/", "anchor_text": "in this guide"}, {"url": "https://twitter.com/_jphwang", "anchor_text": "twitter"}, {"url": "https://medium.com/tag/visualization?source=post_page-----c24d6f30867e---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/python?source=post_page-----c24d6f30867e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----c24d6f30867e---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/mapping?source=post_page-----c24d6f30867e---------------mapping-----------------", "anchor_text": "Mapping"}, {"url": "https://medium.com/tag/learning-to-code?source=post_page-----c24d6f30867e---------------learning_to_code-----------------", "anchor_text": "Learning To Code"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc24d6f30867e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&user=JP+Hwang&userId=964fe0870229&source=-----c24d6f30867e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc24d6f30867e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&user=JP+Hwang&userId=964fe0870229&source=-----c24d6f30867e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc24d6f30867e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc24d6f30867e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c24d6f30867e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c24d6f30867e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c24d6f30867e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c24d6f30867e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c24d6f30867e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "JP Hwang"}, {"url": "https://medium.com/@_jphwang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F964fe0870229&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&user=JP+Hwang&userId=964fe0870229&source=post_page-964fe0870229--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F743cf2a1623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finteractive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e&newsletterV3=964fe0870229&newsletterV3Id=743cf2a1623e&user=JP+Hwang&userId=964fe0870229&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}