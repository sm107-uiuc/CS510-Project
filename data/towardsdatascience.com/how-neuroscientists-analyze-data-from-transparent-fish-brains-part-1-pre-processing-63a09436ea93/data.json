{"url": "https://towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93", "time": 1682994401.271366, "path": "towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93/", "webpage": {"metadata": {"title": "How neuroscientists analyze data from transparent fish brains : part 1, pre-processing. | by Laetitia LALLA | Towards Data Science", "h1": "How neuroscientists analyze data from transparent fish brains : part 1, pre-processing.", "description": "Brains are cool. And not just human brains. In neurosciences, many animal models are used to study brain circuits: mice, rats, flies, worms and \u2014 my favourite one \u2014 fish. But not just any fish: the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Zebrafish", "anchor_text": "zebrafish", "paragraph_index": 0}, {"url": "https://fr.mathworks.com/discovery/image-registration.html", "anchor_text": "Matlab", "paragraph_index": 6}, {"url": "https://imagej.net/Register_Virtual_Stack_Slices", "anchor_text": "ImageJ / Fiji", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Kernel_(image_processing)#Convolution", "anchor_text": "kernel", "paragraph_index": 9}, {"url": "https://fr.mathworks.com/help/images/ref/bwlabel.html", "anchor_text": "bwlabel", "paragraph_index": 12}], "all_paragraphs": ["Brains are cool. And not just human brains. In neurosciences, many animal models are used to study brain circuits: mice, rats, flies, worms and \u2014 my favourite one \u2014 fish. But not just any fish: the zebrafish.", "Originally from South Asia, zebrafish can nowadays be found in any common aquarium and shops. They are small, have these pretty stripes and like warm water. But what makes them interesting for scientists is that some zebrafish have a mutation that prevent them to generate black pigments, hence they have a completely transparent skin. And that is a nice property to have if one want to study brains. No need to open a skull, no need to cut anything, just put one of this fish under a microscope, and you can study its brain. Or \u2026 almost.", "Zebrafish are truly awesome because their genome is known, and scientists were able to precisely generate some mutations to make the fish neurons emit fluorescent light when they are active (all of this without impacting the function of the brain or the health of the zebrafish !). You can imagine the tremendous amount of work and research behind this, but this is a Data Science blog, so I will now focus on the analysis of this kind of data.", "This is what the raw data looks like : this is a video of a zebrafish brain and every circular patch of white is a neuron becoming active.", "Already pretty cool ! However, before being able to use some machine learning algorithms, like PCA or clustering, we need to transform this video in an exploitable data set, ie a 2D-matrix of [neurons x time] where each element is the degree of activity for a specific neuron at a specific time point. The \u201cpre-processing\u201d pipeline has 3 main steps :", "The first step is the alignment. During the experiments, the fish is alive and can freely move its tail (only the head and the belly are kept immobile by some agarose gel). This can lead to some motion during the recording, and as a consequence, the images may be slightly translated or rotated. Hence, the images must be re-aligned to fit the orientation of one \u201creference\u201d image, chosen by the user. This is the process of image registration.", "This can be done in many ways, for example (among others) with Matlab or with the open-source image processing software ImageJ / Fiji. To keep this post (relatively) short, I will not elaborate on this step and will focus instead on the cell detection.", "Once motion artifacts have been corrected, the second step detects where the neurons are located in the images. Again, many different methods are currently being used or developed by neuroscientists, but the one that I would like to present here uses template matching. Basically, the user can create a template of what a cell is supposed to look like and the algorithm will look for this specific shape in the entire image.", "First, all the registered images corresponding the desired time period are averaged in a referenceImage. This image is then smoothed by a gaussian filter, to unify the background and adjust the contrast for all cells.", "This can be done by 2D-convolution with a gaussian filter (or kernel). The value of each pixel will be replaced by the convolution between the original image and the gaussian kernel. This is nicely described in the following schematic :", "Second, the template of a cell is generated. The user can choose the shape of the template and its size (depending on the brain region you are studying, the neurons can be smaller or larger). Then, this template will be passed over the referenceImage and \u2014 for each chunk of image \u2014 a correlation will be computed with the template.", "The correlation value indicates how well the template matches the part of the image. The outcome will consist of a correlationMap, where the color represents how well the template is matching the area centered around the pixel. Based on the histogram of the correlation values, the user can choose a threshold to select only the pixels with high correlation (in this example, 0.5).", "Since the selected pixels are only the center of our neurons, a dilation step will be needed to add more pixels around it. After that, all the pixels are considered to belong to a neuron : they can be labelled (for example with Matlab function bwlabel), meaning that they are given a new number representing the identity of the neuron they belong to. This result is then displayed to the user, who can remove manually any error of detection.", "This process can be repeated for different templates, of different sizes and shape. The final output is a \u201cmask\u201d of the size of the original image : each pixel has been labelled 0 if it doesn\u2019t belong to a neuron, or a number between 1, 2, 3, \u2026. 550 if it belongs to one (550 being the number of neuron being found in this specific example). This is used for the final step : extract the value of the fluorescence for each neuron during time.", "To extract the fluorescent light level for each neuron in time, the mask is applied to the images and all the values belonging to the pixels composing a neuron are averaged. This creates, for each neuron, a vector displaying its activity in time :", "But when you have 550 neurons, it is impossible to look at them individually. A more efficient way to look at several neurons at the same time is to plot the activity map (x axis : time, y axis : neuron label, color : activity):", "With that, the preprocessing is done. Now, the interesting stuff can start, and that would be the object of a second post where we will look at some clustering algorithms and PCA: How neuroscientists analyze data from transparent fish brains : part 2, clustering neural data.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "(Neural) data scientist, Post-doc in Neurosciences in Trondheim, Norway. Loves Nature \ud83c\udfd5\ufe0f, Travels \ud83c\udfde\ufe0f, Science \ud83d\udc69\u200d\ud83d\udd2c and the brain"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F63a09436ea93&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----63a09436ea93--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63a09436ea93--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@laetitialalla?source=post_page-----63a09436ea93--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laetitialalla?source=post_page-----63a09436ea93--------------------------------", "anchor_text": "Laetitia LALLA"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd23d1fd23a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=post_page-fd23d1fd23a0----63a09436ea93---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63a09436ea93&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63a09436ea93&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Zebrafish", "anchor_text": "zebrafish"}, {"url": "https://yaksilab.com/", "anchor_text": "Yaksi lab"}, {"url": "https://fr.mathworks.com/help/images/register-an-aerial-photograph-to-a-digital-orthophoto.html", "anchor_text": "Matlab"}, {"url": "https://fr.mathworks.com/discovery/image-registration.html", "anchor_text": "Matlab"}, {"url": "https://imagej.net/Register_Virtual_Stack_Slices", "anchor_text": "ImageJ / Fiji"}, {"url": "https://en.wikipedia.org/wiki/Kernel_(image_processing)#Convolution", "anchor_text": "kernel"}, {"url": "https://developer.apple.com/library/archive/documentation/Performance/Conceptual/vImage/ConvolutionOperations/ConvolutionOperations.html", "anchor_text": "developer.apple.com"}, {"url": "https://fr.mathworks.com/help/images/ref/bwlabel.html", "anchor_text": "bwlabel"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----63a09436ea93---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/neuroscience?source=post_page-----63a09436ea93---------------neuroscience-----------------", "anchor_text": "Neuroscience"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----63a09436ea93---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----63a09436ea93---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----63a09436ea93---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63a09436ea93&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=-----63a09436ea93---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63a09436ea93&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=-----63a09436ea93---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63a09436ea93&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63a09436ea93--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F63a09436ea93&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----63a09436ea93---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----63a09436ea93--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----63a09436ea93--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----63a09436ea93--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----63a09436ea93--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----63a09436ea93--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----63a09436ea93--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----63a09436ea93--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----63a09436ea93--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laetitialalla?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@laetitialalla?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Laetitia LALLA"}, {"url": "https://medium.com/@laetitialalla/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "66 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffd23d1fd23a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=post_page-fd23d1fd23a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ffd23d1fd23a0%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93&user=Laetitia+LALLA&userId=fd23d1fd23a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}