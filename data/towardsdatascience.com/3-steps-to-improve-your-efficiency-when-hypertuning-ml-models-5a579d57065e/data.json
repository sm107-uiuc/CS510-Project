{"url": "https://towardsdatascience.com/3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e", "time": 1683013484.605561, "path": "towardsdatascience.com/3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e/", "webpage": {"metadata": {"title": "3 Steps to Improve your Efficiency when Hypertuning ML Models | by Khuyen Tran | Towards Data Science", "h1": "3 Steps to Improve your Efficiency when Hypertuning ML Models", "description": "You may hear about \u201cno free lunch\u201d (NFL) theorem, which indicates that there is no best algorithm for every data. One algorithm may perform well in one data but perform poorly in other data. That is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://hydra.cc/", "anchor_text": "Hydra", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/introduction-to-hydra-cc-a-powerful-framework-to-configure-your-data-science-projects-ed65713a53c6?source=---------4------------------", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://github.com/khuyentran1401/Machine-learning-pipeline", "anchor_text": "clone this repo", "paragraph_index": 8}, {"url": "https://github.com/khuyentran1401/Machine-learning-pipeline", "anchor_text": "example project", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/khuyen-tran-1ab926151/", "anchor_text": "LinkedIn", "paragraph_index": 33}, {"url": "https://twitter.com/KhuyenTran16", "anchor_text": "Twitter", "paragraph_index": 33}, {"url": "https://github.com/khuyentran1401/Data-science", "anchor_text": "this repo", "paragraph_index": 34}], "all_paragraphs": ["You may hear about \u201cno free lunch\u201d (NFL) theorem, which indicates that there is no best algorithm for every data. One algorithm may perform well in one data but perform poorly in other data. That is why there are so many machine learning algorithms available to train data.", "How do we know which machine learning model is the best? We cannot know until we experiment and compare the performance of different models. But experimenting with different models can be a mess, especially when you when to find the best parameters for your model with GridSearchCV.", "For example, when we finished experimenting with RandomForestClassifier and switched to SVC, we might wish to save the parameters of RandomForestClassifier in case we want to reproduce the results we have with RandomForestClassifier. But how do we save these parameters efficiently?", "Wouldn\u2019t it be nice if we have the information about each model saved in different configuration files like below?", "Each file under model will specify their parameters like this", "When we want to use a specific model (let\u2019s say RandomForestClassifier), all we need to do is to run the training file and specify the model we want to train with model=modelname", "Being able to do this has helped me experiment with different models much faster without being afraid of losing the hyperparameters of a particular model used for GridSearchCV. This article will show you how to switch between different models effortlessly like above with Hydra.", "Hydra is a framework for elegantly configuring complex applications. I wrote how you could use hydra for your data science projects here. Besides configuring one configuration file, hydra also makes it much easier to work different configuration files.", "To follow this tutorial, simply clone this repo. This is the tree structure of our project", "To access the config files in experiment , we will add hydra.main as the decorator of our function in train.py like below. The config_path specifies the path of the config files and config_name specifies the name of the config file", "This is how hyperparameters.yaml looks like", "YAML is the easiest language to understand and work with config files. As you can see, to access the training data, we simply use config.processed_data.text.train", "In hyperparameters.yaml, we put general information related to training such as data path, scoring of GridSearchCV, but not the hyperparameters for a specific model. We want to keep this file static while changing the configuration for the model based on the model we use.", "If we want to start training our model with SVC, in hyperparameters.yaml , we set the default model with", "Now when we run python train.py , Hydra will try to search for the file svc.yaml under the directory model", "Thus, our next step is to create a file with the name svc.yaml (or any other name that you would like) under the model directory like this", "Our svc.yaml file will contain the name of the model and the hyperparameters for GridSearchCV to search over", "Hydra will automatically access the svc.yaml config within the model directory and use the parameters in svc.yaml!", "If you want to instead use RandomForestClassifier, create the file named random_forest.yaml then insert the information about our RandomForestClassifier", "Instead of changing the default model in the hyperparameter.yaml file, we can override the default model in the terminal!", "Now our function in train.py can get access to these parameters via config. For example, if I use svc model, this will be what I see", "To use turn the string \u2018SVC\u2019 into a class, use eval", "Now classifier works like a normal SVC class!", "To use the hyperparameters in our config file into a Python dictionary whose values are Python list, we use", "Now you can freely switch between different models in the terminal like this", "From now on, if you want to use a new model with different hyperparameters, all you need to do is to add the config file for that model then run", "Your model will run without the need of changing the code in train.py!", "Sometimes, instead of writing down some specific values that are recognized by YAML file such as a listclassifier__C: [.05, .12], we might want to use the function that is not recognized by YAML such as classifier__C: np.logspace(-4, 4, 20)", "Don\u2019t worry! We can still find a way to work around that situation by wrapping eval() function around the string! This would turn your string np.logspace(-4, 4, 20) into a real python function!", "Then turn all of your value in the dictionary into Python lists so they would be valid parameters for GridSearchCV", "Congratulation! You have just learned how to use Hydra to experiment with different machine learning models. With this tool, you can keep your code separately from the specific information of your data.", "You don\u2019t need to go back to your code if you want to change the hyperparameters of your machine learning model. You just need to add one more config file for an additional model and switch between them with", "Here is the example project that uses hydra.cc and config file.", "I like to write about basic data science concepts and play with different algorithms and data science tools. You could connect with me on LinkedIn and Twitter.", "Star this repo if you want to check out the codes for all of the articles I have written. Follow me on Medium to stay informed with my latest data science articles like these", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5a579d57065e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5a579d57065e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5a579d57065e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://khuyentran1476.medium.com/?source=post_page-----5a579d57065e--------------------------------", "anchor_text": ""}, {"url": "https://khuyentran1476.medium.com/?source=post_page-----5a579d57065e--------------------------------", "anchor_text": "Khuyen Tran"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84a02493194a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&user=Khuyen+Tran&userId=84a02493194a&source=post_page-84a02493194a----5a579d57065e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a579d57065e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a579d57065e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@petritz?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Petritz"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://hydra.cc/", "anchor_text": "Hydra"}, {"url": "https://towardsdatascience.com/introduction-to-hydra-cc-a-powerful-framework-to-configure-your-data-science-projects-ed65713a53c6?source=---------4------------------", "anchor_text": "here"}, {"url": "https://github.com/khuyentran1401/Machine-learning-pipeline", "anchor_text": "clone this repo"}, {"url": "https://github.com/khuyentran1401/Machine-learning-pipeline", "anchor_text": "example project"}, {"url": "https://www.linkedin.com/in/khuyen-tran-1ab926151/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/KhuyenTran16", "anchor_text": "Twitter"}, {"url": "https://github.com/khuyentran1401/Data-science", "anchor_text": "this repo"}, {"url": "https://towardsdatascience.com/how-to-share-your-python-objects-across-different-environments-in-one-line-of-code-f30a25e5f50e", "anchor_text": "How to Share your Python Objects Across Different Environments in One Line of CodeFrustrated with Setting up the Environments to Share your Findings with Others? Here\u2019s how you can Make it Easiertowardsdatascience.com"}, {"url": "https://towardsdatascience.com/top-4-code-viewers-for-data-scientist-in-vscode-e275e492350d", "anchor_text": "Top 4 Code Viewers for Data Scientist in VSCodeMake YAML, JSON, CSV, and Jupyter Notebook Work for You, Not Against youtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-to-create-and-view-interactive-cheatsheets-on-the-command-line-6578641039ff", "anchor_text": "How to Create and View Interactive Cheatsheets on the Command-lineStop Googling for Command-line. Save your Time with Cheat Insteadtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/how-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1", "anchor_text": "How to Efficiently Fine-Tune your Machine Learning ModelsFind it Time-consuming to Find the Best Parameters for your ML Models? Use these Three Trickstowardsdatascience.com"}, {"url": "https://towardsdatascience.com/introduction-to-ibm-federated-learning-a-collaborative-approach-to-train-ml-models-on-private-data-2b4221c3839", "anchor_text": "Introduction to IBM Federated Learning: A Collaborative Approach to Train ML Models on Private DataHow to Keep the Data Secured while Training the Data from Different Sources?towardsdatascience.com"}, {"url": "https://medium.com/tag/python?source=post_page-----5a579d57065e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5a579d57065e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5a579d57065e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/command-line?source=post_page-----5a579d57065e---------------command_line-----------------", "anchor_text": "Command Line"}, {"url": "https://medium.com/tag/gridsearchcv?source=post_page-----5a579d57065e---------------gridsearchcv-----------------", "anchor_text": "Gridsearchcv"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5a579d57065e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&user=Khuyen+Tran&userId=84a02493194a&source=-----5a579d57065e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5a579d57065e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&user=Khuyen+Tran&userId=84a02493194a&source=-----5a579d57065e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a579d57065e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5a579d57065e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5a579d57065e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5a579d57065e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5a579d57065e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5a579d57065e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5a579d57065e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5a579d57065e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5a579d57065e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5a579d57065e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5a579d57065e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5a579d57065e--------------------------------", "anchor_text": ""}, {"url": "https://khuyentran1476.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://khuyentran1476.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Khuyen Tran"}, {"url": "https://khuyentran1476.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "34K Followers"}, {"url": "https://mathdatasimplified.com", "anchor_text": "https://mathdatasimplified.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84a02493194a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&user=Khuyen+Tran&userId=84a02493194a&source=post_page-84a02493194a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fde46523b7a77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3-steps-to-improve-your-efficiency-when-hypertuning-ml-models-5a579d57065e&newsletterV3=84a02493194a&newsletterV3Id=de46523b7a77&user=Khuyen+Tran&userId=84a02493194a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}