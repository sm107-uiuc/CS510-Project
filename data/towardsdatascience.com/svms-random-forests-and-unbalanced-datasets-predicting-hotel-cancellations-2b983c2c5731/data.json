{"url": "https://towardsdatascience.com/svms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731", "time": 1683003862.553282, "path": "towardsdatascience.com/svms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731/", "webpage": {"metadata": {"title": "Imbalanced Classes: Predicting Hotel Cancellations with Support Vector Machines | by Michael Grogan | Towards Data Science", "h1": "Imbalanced Classes: Predicting Hotel Cancellations with Support Vector Machines", "description": "An unbalanced dataset is one where there is an unequal sample size between classes, which induces significant bias into the predictions of the classifier in question. In this particular example\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.michael-grogan.com/articles/hotel-cancellations-svm", "anchor_text": "here", "paragraph_index": 25}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 28}], "all_paragraphs": ["An unbalanced dataset is one where there is an unequal sample size between classes, which induces significant bias into the predictions of the classifier in question.", "In this particular example (available from the references section below), a support vector machine (SVM) classification model is used to classify hotel booking customers in terms of cancellation risk, i.e. 1 if the model predicts that the customer will cancel their booking, 0 if the customer will follow through with the booking.", "The H1 dataset is used to train and validate the model, while the predictions from the resulting model are then tested using the H2 data.", "In this particular dataset, the sample size for the non-cancellation class (0) is significantly greater than the cancellation class (1). In a previous example, this was dealt with by removing numerous 0 entries in order to have an equal sample size between the two classes. However, this is not necessarily the best approach, as many data points are discarded during this process.", "Instead, the SVM model can be modified to penalise wrong predictions on the minor class. Let\u2019s see how this affects the analysis.", "The identified features to be included in the analysis using both the ExtraTreesClassifier and forward and backward feature selection methods are as follows:", "An SVM is a supervised learning model that can be used for both classification and regression tasks.", "The SVM model provides an assessment of the importance of each training point when defining the decision limit between two classes.", "The few training points selected that lie on the decision boundary between the two classes are called support vectors.", "When comparing the accuracy scores, we see that numerous readings are provided in each confusion matrix.", "However, a particularly important distinction exists between precision and recall.", "The two readings are often at odds with each other, i.e. it is often not possible to increase precision without reducing recall, and vice versa.", "An assessment as to the ideal metric to use depends in large part on the specific data under analysis. For example, cancer detection screenings that have false negatives (i.e. indicating patients do not have cancer when in fact they do), is a big no-no. Under this scenario, recall is the ideal metric.", "However, for emails \u2014 one might prefer to avoid false positives, i.e. sending an important email to the spam folder when in fact it is legitimate.", "The f1-score takes both precision and recall into account when devising a more general score.", "Which would be more important for predicting hotel cancellations?", "Well, from the point of view of a hotel \u2014 they would likely wish to identify customers who are ultimately going to cancel their booking with greater accuracy \u2014 this allows the hotel to better allocate rooms and resources. Identifying customers who are not going to cancel their bookings may not necessarily add value to the hotel\u2019s analysis, as the hotel knows that a significant proportion of customers will ultimately follow through with their bookings in any case.", "The relevant features as outlined above are included for determining whether the customer will cancel their booking.", "The data is then split into training and validation data:", "A \u2018balanced\u2019 class weight can be added to the SVM configuration, which adds a greater penalty to incorrect classifications on the minor class (in this case, the cancellation class).", "Here is the classification performance of this model on the validation set:", "Recall for class 1 comes in at 69%, while the f1-score accuracy comes in at 70%. Now, let\u2019s test the prediction performance on H2 (the test set).", "We see that recall for class 1 is now up to 75%, while f1-score accuracy comes in at 63%. Notably, we can see that the f1-score is lower on the test set, but the recall is now higher than on the validation set.", "In this regard, if it is assumed that false positives are more tolerable than false negatives in this situation \u2014 then one could argue that the model has performed quite well on this basis.", "In this example, we have seen how support vector machines can be used to handle unbalanced datasets, and how to interpret confusion matrices for classification accuracy.", "You can find the original article here, along with a link to the relevant repository for the datasets and notebooks illustrated in this example.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2b983c2c5731&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----2b983c2c5731---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2b983c2c5731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2b983c2c5731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/antranias-50356/", "anchor_text": "Antranias"}, {"url": "https://pixabay.com/photos/see-saw-swing-swing-device-rock-240650/", "anchor_text": "Pixabay"}, {"url": "https://www.michael-grogan.com/articles/hotel-cancellations-svm", "anchor_text": "here"}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "Antonio, Almedia and Nunes (2019). Hotel Booking Demand Datasets"}, {"url": "https://elitedatascience.com/imbalanced-classes", "anchor_text": "Elite Data Science: How to Handle Imbalanced Classes in Machine Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2b983c2c5731---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2b983c2c5731---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----2b983c2c5731---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/classification?source=post_page-----2b983c2c5731---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/data?source=post_page-----2b983c2c5731---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2b983c2c5731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&user=Michael+Grogan&userId=eec017a8b178&source=-----2b983c2c5731---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2b983c2c5731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&user=Michael+Grogan&userId=eec017a8b178&source=-----2b983c2c5731---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2b983c2c5731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2b983c2c5731&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2b983c2c5731---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2b983c2c5731--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2b983c2c5731--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2b983c2c5731--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2b983c2c5731--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsvms-random-forests-and-unbalanced-datasets-predicting-hotel-cancellations-2b983c2c5731&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}