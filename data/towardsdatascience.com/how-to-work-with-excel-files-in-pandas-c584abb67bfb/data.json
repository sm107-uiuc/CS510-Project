{"url": "https://towardsdatascience.com/how-to-work-with-excel-files-in-pandas-c584abb67bfb", "time": 1683012557.542536, "path": "towardsdatascience.com/how-to-work-with-excel-files-in-pandas-c584abb67bfb/", "webpage": {"metadata": {"title": "How to Work with Excel files in Pandas | by Dorian Lazar | Towards Data Science", "h1": "How to Work with Excel files in Pandas", "description": "From what I have seen so far, CSV seems to be the most popular format to store data among data scientists. And that\u2019s understandable, it gets the job done and it\u2019s a quite simple format; in Python\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.ons.gov.uk/peoplepopulationandcommunity/crimeandjustice/datasets/crimeinenglandandwalesannualtrendanddemographictables", "anchor_text": "ons.gov.uk", "paragraph_index": 1}, {"url": "https://www.nablasquared.com/how-to-work-with-excel-files-in-pandas/", "anchor_text": "here", "paragraph_index": 41}, {"url": "https://www.nablasquared.com/", "anchor_text": "https://www.nablasquared.com/", "paragraph_index": 43}], "all_paragraphs": ["From what I have seen so far, CSV seems to be the most popular format to store data among data scientists. And that\u2019s understandable, it gets the job done and it\u2019s a quite simple format; in Python, even without any library, one can build a simple CSV parser in under 10 lines of code.", "But you may not always find the data that you need in CSV format. Sometimes the only available format may be an Excel file. Like, for example, this dataset on ons.gov.uk about crime in England and Wales, which is only in xlsx format; dataset that I will use in the examples below.", "The simplest way to read Excel files into pandas data frames is by using the following function (assuming you did import pandas as pd):", "Where sheet_name can be the name of the sheet we want to read, it\u2019s index, or a list with all the sheets we want to read; the elements of the list can be mixed: sheet names or indices. If we want all the sheets, we can use sheet_name=None. In the case in which we want more sheets to be read, they will be returned as a dictionary of data frames. The keys of such a dictionary will be either the index or name of a sheet, depending on how we specified in sheet_name; in the case of sheet_name=None, the keys will be sheet names.", "Now, if we use it to read our Excel file we get:", "That\u2019s right, an error! It turns out that pandas cannot read Excel files on its own, so we need to install another python package to do that.", "There are 2 options that we have: xlrd and openpyxl. The package xlrd can open both Excel 2003 (.xls) and Excel 2007+ (.xlsx) files, whereas openpyxl can open only Excel 2007+ (.xlsx) files. So, we will install xlrd as it can open both formats:", "Now, if we try to read the same data again:", "But Excel files can be a little bit messier. Besides data, they may have other comments/explanations in the first and/or last couple of rows.", "To tell pandas to start reading an Excel sheet from a specific row, use the argument header = 0-indexed row where to start reading. By default, header=0, and the first such row is used to give the names of the data frame columns.", "To skip rows at the end of a sheet, use skipfooter = number of rows to skip.", "This is a little better. There are still some issues that are specific to this data. Depending on what we want to achieve we may also need to rearrange the data values into another way. But in this article, we will focus only on reading and writing to and from data frames.", "Another way to read Excel files besides the one above is by using a pd.ExcelFile object. Such an object can be constructed by using the pd.ExcelFile(\u2018excel_file_path\u2019) constructor. An ExcelFile object can be used in a couple of ways. Firstly, it has a .sheet_names attribute which is a list of all the sheet names inside the opened Excel file.", "Then, this ExcelFile object also has a .parse() method that can be used to parse a sheet from the file and return a data frame. The first parameter of this method can be the index of the sheet we want to parse or its name. The rest of the parameters are the same as in the pd.read_excel() function.", "An example of parsing the second sheet (index 1):", "\u2026 and here we parse the same sheet using its name instead of an index:", "ExcelFiles can also be used inside with \u2026 as \u2026 statements, and if you want to do something a little more elaborate, like parsing only sheets with 2 words in their name, you can do something like:", "The same thing you can do by using pd.read_excel() instead of .parse() method, like this:", "\u2026 or, if you simply want all the sheets, you can do:", "Now that we know how to read excel files, the next step for us is to be able to also write a data frame to an excel file. We can do that by using the data frame method .to_excel(\u2018path_to_excel_file\u2019, sheet_name=\u2019\u2026\u2019).", "Let\u2019s first create a simple data frame for writing to an excel file:", "Now we want to write it to an excel file:", "\u2026 and we got an error.", "Again, pandas can\u2019t write to excel files on its own; we need another package for that. The main options that we have are:", "If we want to be able to write to the old .xls format we should install xlwt as it is the only that handles those files. For .xlsx files, we will choose openpyxl as it also supports the append mode.", "Now if we run again the above code, it works; an excel file was created:", "By default, pandas also writes the index column along with our columns. To get rid of it, use index=False like in the code below:", "The index column isn\u2019t there now:", "What if we want to write more sheets? If we want to add a second sheet to the previous file, do you think that the below code will work?", "The answer is no. It will just overwrite the file with only one sheet: sheet2.", "To write more sheets to an Excel file we need to use a pd.ExcelWriter object as shown below. First, we create another data frame for sheet2, then we open an Excel file as an ExcelWriter object in which we write the 2 data frames:", "Now our Excel file should have 2 sheets. If we then want to add another sheet to it, we need to open the file in append mode and run code similar to the previous one. For example:", "Our Excel file, now, has 3 sheets and looks like this:", "Probably you are wondering, at this point, about Excel formulas. What about them? How to read from files that have formulas? How to write them to Excel files?", "Well\u2026 good news. It is quite easy. Writing formulas to Excel files is as simple as just writing the string of the formula, and these strings will be automatically interpreted by Excel as formulas.", "The Excel file produced by the code above is:", "Now, if we want to read an Excel file with formulas in it, pandas will read into data frames the result of those formulas.", "For example, let\u2019s read our previously created file:", "Sometimes you need to save the Excel file manually for this to work and not get zeros instead of the result of formulas (hit CTRL+S before executing the above code).", "Below is the code as a Jupyter notebook:", "I hope you found this information useful and thanks for reading!", "This article is also posted on my own website here. Feel free to have a look!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate about Data Science, AI, Programming & Math | Owner of \u2207\u00b2 https://www.nablasquared.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc584abb67bfb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dorianlazar.medium.com/?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": ""}, {"url": "https://dorianlazar.medium.com/?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": "Dorian Lazar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79574042e17b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&user=Dorian+Lazar&userId=79574042e17b&source=post_page-79574042e17b----c584abb67bfb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc584abb67bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc584abb67bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@bongkarn-thanyakij-683719?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "bongkarn thanyakij"}, {"url": "https://www.pexels.com/photo/macbook-pro-on-white-table-3787903/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://www.ons.gov.uk/peoplepopulationandcommunity/crimeandjustice/datasets/crimeinenglandandwalesannualtrendanddemographictables", "anchor_text": "ons.gov.uk"}, {"url": "https://www.nablasquared.com/how-to-work-with-excel-files-in-pandas/", "anchor_text": "here"}, {"url": "https://medium.com/tag/python?source=post_page-----c584abb67bfb---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----c584abb67bfb---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/excel?source=post_page-----c584abb67bfb---------------excel-----------------", "anchor_text": "Excel"}, {"url": "https://medium.com/tag/data-manipulation?source=post_page-----c584abb67bfb---------------data_manipulation-----------------", "anchor_text": "Data Manipulation"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c584abb67bfb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc584abb67bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&user=Dorian+Lazar&userId=79574042e17b&source=-----c584abb67bfb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc584abb67bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&user=Dorian+Lazar&userId=79574042e17b&source=-----c584abb67bfb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc584abb67bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc584abb67bfb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c584abb67bfb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c584abb67bfb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c584abb67bfb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c584abb67bfb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c584abb67bfb--------------------------------", "anchor_text": ""}, {"url": "https://dorianlazar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dorianlazar.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dorian Lazar"}, {"url": "https://dorianlazar.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "593 Followers"}, {"url": "https://www.nablasquared.com/", "anchor_text": "https://www.nablasquared.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79574042e17b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&user=Dorian+Lazar&userId=79574042e17b&source=post_page-79574042e17b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9fdaa579c06&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-work-with-excel-files-in-pandas-c584abb67bfb&newsletterV3=79574042e17b&newsletterV3Id=9fdaa579c06&user=Dorian+Lazar&userId=79574042e17b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}