{"url": "https://towardsdatascience.com/stop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21", "time": 1683017890.652967, "path": "towardsdatascience.com/stop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21/", "webpage": {"metadata": {"title": "Stop Wasting Useful Information When Imputing Missing Values | by Jason Chong | Towards Data Science", "h1": "Stop Wasting Useful Information When Imputing Missing Values", "description": "Missing values is one of the most common problems during data analysis and machine learning. Machine learning models require that a dataset does not contain any missing values before they can be\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=QVJY4qJ5-YE", "anchor_text": "video", "paragraph_index": 1}, {"url": "https://github.com/chongjason914/scikit-learn-tutorial/blob/main/missing-values-imputation.ipynb", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://www.kaggle.com/c/titanic/data", "anchor_text": "Kaggle Titanic dataset", "paragraph_index": 6}, {"url": "http://linktr.ee/chongjason", "anchor_text": "linktr.ee/chongjason", "paragraph_index": 39}], "all_paragraphs": ["Missing values is one of the most common problems during data analysis and machine learning. Machine learning models require that a dataset does not contain any missing values before they can be fitted to the data. Therefore, it is crucial that we learn how to properly handle them.", "I put out a video a while ago about handling missing data using Pandas and in that video, I spoke about the two main ways to deal with missing values in a dataset:", "In this article, we will examine the process of imputation in greater detail and more specifically, we will learn about the differences between a univariate approach to imputing versus a multivariate approach to imputing.", "You can find the complete notebook on my GitHub here.", "Univariate imputation implies that we are only considering the values of a single column when performing imputation. Multivariate imputation, on the other hand, involves taking into account other features in the dataset when performing imputation.", "The multivariate approach to imputing is generally preferred over the univariate approach as it is more robust and provides our model with a more accurate representation of the missing values in order to make better predictions.", "In this article, we will explore 3 different imputation techniques with reference to the Kaggle Titanic dataset:", "For the purpose of this tutorial, I went ahead and dropped the PassengerId, Name, Ticket and Cabin columns from the original dataset.", "After dropping those 4 columns, we are left with the following data frame.", "Because there are only 2 rows with missing Embarked values, I decided to drop them from the dataset, leaving us with 177 rows with missing values in the Age column.", "Before we look at how we can impute the missing values in the Age column, let us briefly explore the Age feature.", "We can observe that Fare is slightly positively correlated with Age. In other words, passengers that were older paid a higher fare for their ticket.", "What about the distribution of passenger age?", "Now onto the main purpose of this article. In this section, we will look at 3 different imputation techniques using the Scikit-learn library in Python.", "To demonstrate the differences between the 3 techniques, I have created a sample data frame as follows.", "Notice the missing value on row 6 in the Age column of the data frame. Our goal here will be to use different imputation techniques to replace the missing value with a substituted value and subsequently study the differences between the techniques.", "Simple imputer is an example of a univariate approach to imputing missing values i.e. it only takes a single feature into account when performing imputation.", "Some of the most common uses of simple imputer include:", "Here, our simple imputer has filled the missing value in the Age column with the average age of the first 5 rows which is 31.2.", "Although easy and straightforward, simple imputer is a rather blunt approach to imputing missing values. As we have seen earlier on, Age is positively correlated with Fare so it would be worthwhile to also consider the values in the Fare column when performing imputation.", "This is where multivariate imputation comes in where we take into account multiple features in a dataset during imputation.", "Iterative imputer is an example of a multivariate approach to imputation. It models the missing values in a column by using information from the other columns in a dataset. More specifically, it treats the column with missing values as a target variable while the remaining columns are used are predictor variables to predict the target variable.", "In our sample data frame, the Age column has one missing value on row 6 and is therefore assigned as the target variable in this scenario. This leaves the SibSp and Fare columns as our predictor variables.", "Iterative imputer will use the first 5 rows of the data frame to train a predictive model. Once the model is ready, it will then use values in the SibSp and Fare columns on row 6 as inputs and predict the Age value for that row.", "This is what the result of our iterative imputer looks like.", "KNN is short for k-nearest neighbours which is a machine learning algorithm and another multivariate imputation technique. KNN imputer scans a dataset for k nearest rows to the row with missing values. It then proceeds to fill those missing values with the average of those nearest rows.", "To illustrate this, here I have set k to equal to 2. In other words, I want KNN imputer to impute the missing Age value on row 6 with the average age of the 2 observations that are closest to that row.", "As a result, KNN imputer has decided that row 3 and row 5 are the closest to row 6. Therefore, the average age between those two rows is (26 + 35) / 2 = 30.5.", "Now that we have a better understanding of how the different imputers work, we can move on to apply these techniques to the Titanic dataset and compare the accuracy under each approach.", "We should expect to see our model perform better under multivariate imputation than univariate imputation as multivariate imputation provides a more accurate prediction of the missing values and thus allowing our model to make better predictions.", "In this section, we will build a column transformer which consists of a one-hot encoder for encoding the Sex and Embarked columns as well as an imputer to impute the missing values in the Age column.", "Following that, we will chain the column transformer with a random forest classifier to predict the survival of the passengers on the Titanic.", "Finally, we will perform 10-fold cross-validation to compare the prediction results under univariate imputation versus multivariate imputation.", "The mean cross-validation score is higher under multivariate imputation than it is under univariate imputation.", "Although not a drastic difference, we can conclude that our model performed better under multivariate imputation.", "To summarise, in this article, we have discussed the differences between univariate imputation and multivariate imputation. Furthermore, we looked at 3 different imputation techniques within Scikit-learn which include simple imputer, iterative imputer and KNN imputer.", "After comparing the prediction accuracy of our model using simple imputer versus iterative imputer, we can conclude that multivariate imputation results in better model predictions due to its lower mean cross-validation score.", "As usual, I hope you have found this article helpful. Feel free to check out my previous articles on other applications of the Scikit-learn library in Python.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Quantium, BCom (Actuarial Studies). Check out my stuff at linktr.ee/chongjason"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd6ef91ef4c21&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://chongjason.medium.com/?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": ""}, {"url": "https://chongjason.medium.com/?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": "Jason Chong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdc66e2ca621a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&user=Jason+Chong&userId=dc66e2ca621a&source=post_page-dc66e2ca621a----d6ef91ef4c21---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd6ef91ef4c21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd6ef91ef4c21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@vilmosheim?utm_source=medium&utm_medium=referral", "anchor_text": "Vilmos Heim"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.youtube.com/watch?v=QVJY4qJ5-YE", "anchor_text": "video"}, {"url": "https://github.com/chongjason914/scikit-learn-tutorial/blob/main/missing-values-imputation.ipynb", "anchor_text": "here"}, {"url": "https://www.kaggle.com/c/titanic/data", "anchor_text": "Kaggle Titanic dataset"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html", "anchor_text": "Simple imputer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.IterativeImputer.html#sklearn.impute.IterativeImputer", "anchor_text": "Iterative imputer"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.impute.KNNImputer.html", "anchor_text": "KNN imputer"}, {"url": "https://unsplash.com/@charlesdeluvio?utm_source=medium&utm_medium=referral", "anchor_text": "Charles Deluvio"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@the_modern_life_mrs?utm_source=medium&utm_medium=referral", "anchor_text": "Heather Ford"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@derickray?utm_source=medium&utm_medium=referral", "anchor_text": "Derick McKinney"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/feature-selection-dimensionality-reduction-techniques-to-improve-model-accuracy-d9cb3e008624", "anchor_text": "Feature Selection & Dimensionality Reduction Techniques to Improve Model AccuracyA comprehensive guide to selecting the most important features in any datasettowardsdatascience.com"}, {"url": "https://towardsdatascience.com/guide-to-encoding-categorical-features-using-scikit-learn-for-machine-learning-5048997a5c79", "anchor_text": "Guide to Encoding Categorical Features Using Scikit-Learn For Machine LearningAnd why you should stop using Pandas get_dummiestowardsdatascience.com"}, {"url": "https://scikit-learn.org/stable/modules/impute.html", "anchor_text": "Scikit-learn imputation of missing values"}, {"url": "https://www.youtube.com/watch?v=m_qKhnaYZlc", "anchor_text": "Impute missing values using KNNImputer and IterativeImputer"}, {"url": "https://www.facebook.com/chongjason914", "anchor_text": "Facebook"}, {"url": "https://www.instagram.com/chongjason914", "anchor_text": "Instagram"}, {"url": "https://www.twitter.com/chongjason914", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/chongjason914", "anchor_text": "LinkedIn"}, {"url": "https://www.youtube.com/channel/UCQXiCnjatxiAKgWjoUlM-Xg?view_as=subscriber", "anchor_text": "YouTube"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d6ef91ef4c21---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d6ef91ef4c21---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/imputation?source=post_page-----d6ef91ef4c21---------------imputation-----------------", "anchor_text": "Imputation"}, {"url": "https://medium.com/tag/statistics?source=post_page-----d6ef91ef4c21---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----d6ef91ef4c21---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd6ef91ef4c21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&user=Jason+Chong&userId=dc66e2ca621a&source=-----d6ef91ef4c21---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd6ef91ef4c21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&user=Jason+Chong&userId=dc66e2ca621a&source=-----d6ef91ef4c21---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd6ef91ef4c21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd6ef91ef4c21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d6ef91ef4c21---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d6ef91ef4c21--------------------------------", "anchor_text": ""}, {"url": "https://chongjason.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://chongjason.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jason Chong"}, {"url": "https://chongjason.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "704 Followers"}, {"url": "http://linktr.ee/chongjason", "anchor_text": "linktr.ee/chongjason"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdc66e2ca621a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&user=Jason+Chong&userId=dc66e2ca621a&source=post_page-dc66e2ca621a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9cceb96b5bb3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstop-wasting-useful-information-when-imputing-missing-values-d6ef91ef4c21&newsletterV3=dc66e2ca621a&newsletterV3Id=9cceb96b5bb3&user=Jason+Chong&userId=dc66e2ca621a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}