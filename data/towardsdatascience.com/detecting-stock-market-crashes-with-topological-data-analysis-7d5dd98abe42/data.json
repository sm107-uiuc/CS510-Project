{"url": "https://towardsdatascience.com/detecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42", "time": 1683001470.0839128, "path": "towardsdatascience.com/detecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42/", "webpage": {"metadata": {"title": "Detecting stock market crashes with topological data analysis | by Wallyson De Oliveira | Towards Data Science", "h1": "Detecting stock market crashes with topological data analysis", "description": "As long as there will be financial markets, there will be financial crashes. Most suffer when the market takes a dip\u2026 those who can foresee it can protect their assets or take risky short positions\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=vgqG3ITMv1Q", "anchor_text": "Big-short", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Efficient-market_hypothesis", "anchor_text": "efficient market hypothesis", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/cond-mat/9901035", "anchor_text": "[1]", "paragraph_index": 4}, {"url": "https://github.com/giotto-ai/stock-market-crashes", "anchor_text": "code", "paragraph_index": 5}, {"url": "https://arxiv.org/abs/1703.04385", "anchor_text": "Gidea and Katz", "paragraph_index": 5}, {"url": "https://giotto.ai", "anchor_text": "Giotto-TDA", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/persistent-homology-with-examples-1974d4b9c3d0?gi=856d8bda11eb", "anchor_text": "overview", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Discrete_Fourier_Transform", "anchor_text": "discrete Fourier transform", "paragraph_index": 19}, {"url": "https://en.wikipedia.org/wiki/Takens%27s_theorem", "anchor_text": "theorem", "paragraph_index": 23}], "all_paragraphs": ["As long as there will be financial markets, there will be financial crashes. Most suffer when the market takes a dip\u2026 those who can foresee it can protect their assets or take risky short positions to make a profit (a nevertheless stressful situation to be in, as depicted in the Big-short).", "An asset on the market is associated to a dynamical system, whose price varies in function of the available information. The price of an asset on a financial market is determined by a wide range of information, and in the efficient market hypothesis, a simple change in the information will be immediately priced in.", "The dynamics of financial systems are comparable to those of physical systems", "In the same way that phase transitions occur between solids, liquids, and gases, we can discern a normal regime on the market from a chaotic one.", "Observations show that financial crashes are preceded by a period of increased oscillation in asset prices [1]. This phenomenon translates into an abnormal change in the geometric structure of the time series.", "In this post we use topological data analysis (TDA) to capture these geometric changes in the time series in order to produce a reliable detector for stock market crashes. The code implements the ideas given by Gidea and Katz, thanks to Giotto-TDA an open-source library for topological data analysis.", "Intuitively, stock market crashes are rapid drop in asset prices. The price drop is caused by massive selling of assets, which is an attempt to close positions before prices decrease even further.", "The awareness of a large speculative bubble (like in the case of the sub-primes), or a catastrophic event, will cause markets to crash. In the last two decades we have seen two major crashes: the 2000 dot-com crash and the 2008 global financial crisis.", "We analyse daily prices of the S&P 500 index from 1980 to the present day. The S&P is an index that is commonly used to benchmark the state of the financial market as it measures the stock performance of the 500 large-cap US companies .", "Compared to a simple baseline, we find that topological signals tend to be robust to noise and hence less prone to produce false positives.", "This highlights one of the key motivations behind TDA, namely that topology and geometry can provide a powerful method to abstract subtle structure in complex data.", "Let\u2019s describe in more detail the two approaches.", "Given that market crashes represent a sudden decline of stock prices, one simple approach to detect these changes involves tracking the first derivative of average price values over a rolling window. Indeed, in the figure below we can see that this na\u00efve approach already captures the Black Monday crash (1987), the burst of the dot-com bubble (2000\u20132004), and the financial crisis (2007\u20132008).", "By normalising this time series to take values in the [0,1] interval, we can apply a threshold to label points on our original time series where a crash occurred.", "Evidently this simple method is rather noisy.", "With many points labelled as a crash, following this advice will result in over-panicking and selling your assets too soon. Let\u2019s see if TDA can help us reduce the noise in the signal and obtain a more robust detector!", "The mathematics underlying TDA is deep and won\u2019t be covered in this article \u2014 we suggest this overview. For our purposes, it is sufficient to think of TDA as a means to extract informative features which can be used for modeling downstream.", "The pipeline we developed consists in: 2) embedding the time series into a point cloud and constructing sliding windows of point clouds, 3) building a filtration on each window to have an evolving structure encoding the geometrical shape of each window, 4) extracting the relevant features of those windows using persistence homology, 5) comparing each window by measuring the difference of those features from one window to the next, 6) constructing an indicator of crash based on this difference.", "A typical starting point in a TDA pipeline is to generate a simplicial complex from a point cloud. Thus, the crucial question in time series applications is how to generate such point clouds? Discrete time series, like the ones we are considering, are typically visualised as scatter plots in two dimensions. This representation makes the local behaviour of the time series easy to track by scanning the plot from left to right. But it is often ineffective at conveying important effects which may be occurring over larger time scales.", "One well-known set of techniques for capturing periodic behaviour comes from Fourier analysis. For instance, the discrete Fourier transform of a temporal window over the time series gives information on whether the signal in that window arises as the sum of a few simple periodic signals.", "For our purposes we consider a different way of encoding a time-evolving process. It is based on the idea that some key properties of the dynamics can be unveiled effectively in higher dimensions. We begin by illustrating a way of representing a univariate time series as a point cloud, i.e. a set of vectors in a Euclidean space of arbitrary dimension.", "The procedure works as follows: we pick two integers d and \u03c4. For each time t\u1d62 \u2208 (t\u2080, t\u2081, \u2026), we collect the values of the variable y at d distinct times, evenly spaced by \u03c4 and starting at t\u1d62, and present them as a vector with d entries, namely:", "The result is a set of vectors in d-dimensional space! \u03c4 is called the time delay parameter, and d the embedding dimension.", "This time-delay embedding technique is also called Takens\u2019 embedding after Floris Takens, who demonstrated its significance with a celebrated theorem in the context of nonlinear dynamical systems.", "Finally, applying this procedure separately on sliding windows over the full time series leads to a time series of point clouds (one per sliding window) with possibly interesting topologies. The GIF below shows how such a point cloud is generated in 2-dimensions.", "Now that we know how to generate a time series of point clouds, what can we do with this information? Enter persistent homology, which looks for topological features in a simplicial complex that persist over some range of parameter values. Typically, a feature, such as a hole, will initially not be observed, then will appear, and after a range of values of the parameter will disappear again.", "Given two windows and their corresponding persistence diagrams, we can calculate a variety of distance metrics. Here we compare two distances, one based on the notion of a persistence landscape, the other on Betti curves.", "From these figures we can infer that the metric based on landscape distance is less noisy than the Betti curves.", "Using the landscape distance between windows as our topological feature, it is a simple matter to normalise it as we did for the baseline model. Below we show the resulting detection of stock market crashes for the dot-com bubble and global financial crisis. Compared to our simple baseline, we can see that using topological features appears to reduce the noise in the signal of interest.", "Our results suggest that the periods of high volatility preceding a crash produce geometric signatures that can be more robustly detected using topological data analysis. However, these results concern only a specific market and for a short period of time, so one should further investigate the robustness of the procedure on different markets and varying thresholds. Nevertheless, the results are encouraging and open up some interesting ideas for future development.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Head of mathematical modeling at LearnToForecast (L2F) | Graduate in mathematics at Swiss Federal Institute of Technology Lausanne."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7d5dd98abe42&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Wallyson_Oliveira?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Wallyson_Oliveira?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": "Wallyson De Oliveira"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fad744e5f5159&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&user=Wallyson+De+Oliveira&userId=ad744e5f5159&source=post_page-ad744e5f5159----7d5dd98abe42---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d5dd98abe42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d5dd98abe42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@lewis.c.tunstall", "anchor_text": "Lewis Tunstall"}, {"url": "https://www.youtube.com/watch?v=vgqG3ITMv1Q", "anchor_text": "Big-short"}, {"url": "https://en.wikipedia.org/wiki/Efficient-market_hypothesis", "anchor_text": "efficient market hypothesis"}, {"url": "https://arxiv.org/abs/cond-mat/9901035", "anchor_text": "[1]"}, {"url": "https://github.com/giotto-ai/stock-market-crashes", "anchor_text": "code"}, {"url": "https://arxiv.org/abs/1703.04385", "anchor_text": "Gidea and Katz"}, {"url": "https://giotto.ai", "anchor_text": "Giotto-TDA"}, {"url": "https://towardsdatascience.com/persistent-homology-with-examples-1974d4b9c3d0?gi=856d8bda11eb", "anchor_text": "overview"}, {"url": "https://en.wikipedia.org/wiki/Discrete_Fourier_Transform", "anchor_text": "discrete Fourier transform"}, {"url": "https://en.wikipedia.org/wiki/Takens%27s_theorem", "anchor_text": "theorem"}, {"url": "https://towardsdatascience.com/getting-started-with-giotto-learn-a-python-library-for-topological-machine-learning-451d88d2c4bc", "anchor_text": "Getting started"}, {"url": "https://github.com/giotto-ai/molecule_bond_prediction", "anchor_text": "its notebook"}, {"url": "https://towardsdatascience.com/the-shape-of-chemical-functions-d1e1568d020", "anchor_text": "The shape of chemical functions"}, {"url": "https://github.com/giotto-ai/the-shape-of-chemical-functions", "anchor_text": "notebook"}, {"url": "http://snap.stanford.edu/graphwave/", "anchor_text": "graph-wave"}, {"url": "https://towardsdatascience.com/detecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42", "anchor_text": "Detecting stock crashes"}, {"url": "https://github.com/giotto-ai/stock-market-crashes", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/the-shape-that-survives-the-noise-f0a2a89018c6", "anchor_text": "The shape behind the noise"}, {"url": "https://github.com/giotto-ai/noise-to-signal", "anchor_text": "notebook"}, {"url": "https://towardsdatascience.com/visualising-high-dimensional-data-with-giotto-mapper-897fcdb575d7", "anchor_text": "Getting started with Mapper,"}, {"url": "https://towardsdatascience.com/the-shape-of-the-united-states-presidential-elections-c336d80e4ddf", "anchor_text": "Socio-economic"}, {"url": "https://github.com/giotto-ai/us-election-tda", "anchor_text": "notebook)"}, {"url": "https://towardsdatascience.com/the-shape-of-football-games-1589dc4e652a", "anchor_text": "Shape of Football"}, {"url": "https://github.com/giotto-ai/football-tda", "anchor_text": "notebook"}, {"url": "https://github.com/giotto-ai/giotto-learn", "anchor_text": "Giotto-tda library on Github"}, {"url": "https://giotto.ai/", "anchor_text": "website"}, {"url": "https://twitter.com/giotto_ai", "anchor_text": "Twitter"}, {"url": "https://slack.giotto.ai/", "anchor_text": "Slack"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7d5dd98abe42---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7d5dd98abe42---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/finance?source=post_page-----7d5dd98abe42---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----7d5dd98abe42---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----7d5dd98abe42---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d5dd98abe42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&user=Wallyson+De+Oliveira&userId=ad744e5f5159&source=-----7d5dd98abe42---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d5dd98abe42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&user=Wallyson+De+Oliveira&userId=ad744e5f5159&source=-----7d5dd98abe42---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d5dd98abe42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7d5dd98abe42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7d5dd98abe42---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7d5dd98abe42--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Wallyson_Oliveira?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Wallyson_Oliveira?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wallyson De Oliveira"}, {"url": "https://medium.com/@Wallyson_Oliveira/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "219 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fad744e5f5159&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&user=Wallyson+De+Oliveira&userId=ad744e5f5159&source=post_page-ad744e5f5159--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F518908c1086a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-stock-market-crashes-with-topological-data-analysis-7d5dd98abe42&newsletterV3=ad744e5f5159&newsletterV3Id=518908c1086a&user=Wallyson+De+Oliveira&userId=ad744e5f5159&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}