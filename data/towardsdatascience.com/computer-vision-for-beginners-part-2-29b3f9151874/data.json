{"url": "https://towardsdatascience.com/computer-vision-for-beginners-part-2-29b3f9151874", "time": 1682995542.887917, "path": "towardsdatascience.com/computer-vision-for-beginners-part-2-29b3f9151874/", "webpage": {"metadata": {"title": "Computer Vision for Beginners: Part 2 | by Jiwon Jeong | Towards Data Science", "h1": "Computer Vision for Beginners: Part 2", "description": "Preparation refers to the process of getting ready for a task before actually starting it. It could be a preparing step of writing a story, job interview or data modeling. And having a thorough\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/the-most-intuitive-and-easiest-guide-for-convolutional-neural-network-3607be47480", "anchor_text": "this post", "paragraph_index": 3}, {"url": "https://github.com/jjone36/vision_4_beginners/blob/master/part2_image_processing.ipynb", "anchor_text": "Github", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Salt-and-pepper_noise", "anchor_text": "salt and pepper noise", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Gaussian_noise", "anchor_text": "noises that have a normal distribution", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/White_noise", "anchor_text": "white noise", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Gradient", "anchor_text": "gradient", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Image_gradient", "anchor_text": "image gradient", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Sobel_operator", "anchor_text": "Sobel operation", "paragraph_index": 18}, {"url": "https://homepages.inf.ed.ac.uk/rbf/HIPR2/morops.htm", "anchor_text": "here", "paragraph_index": 30}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=adaptivethreshold#https://datascienceschool.net/view-notebook/c4121d311aa34e6faa84f62ef06e43b0/", "anchor_text": "OpenCV documentation", "paragraph_index": 31}, {"url": "https://www.linkedin.com/in/jiwon-jeong/", "anchor_text": "LinkedIn", "paragraph_index": 32}, {"url": "https://www.linkedin.com/in/jiwon-jeong/", "anchor_text": "https://www.linkedin.com/in/jiwon-jeong/", "paragraph_index": 34}], "all_paragraphs": ["Preparation refers to the process of getting ready for a task before actually starting it. It could be a preparing step of writing a story, job interview or data modeling. And having a thorough preparation can\u2019t be overemphasized of its importance. If we get off without enough preprocessing, it\u2019s hard to expect to get a desirable result no matter how good data we have.", "This is the second part of OpenCV tutorial for beginners and the complete set of the series is as follows:", "Today we\u2019re going to talk about how to manipulate images. These are going to be a preprocessing stage. When it comes to detecting edges and contours, noise gives a great impact on the accuracy of detection. Therefore removing noises and controlling the intensity of the pixel values can help the model to focus on the general details and get higher accuracy. Blurring, thresholding, and morphological transformation are the techniques we use for this purpose.", "This post assumes you are already familiar with the concept of convolution. But if it\u2019s not the case, I\u2019d like to recommend you check this post first. The complete code for this tutorial is also available on Github. Now let\u2019s walk through how to apply image filtering with OpenCV one by one.", "The goal of blurring is to perform noise reduction. But we have to pay extra care here. If we apply edge detection algorithms to the images with high resolution, we\u2019ll get too many detected outcomes that we aren\u2019t interested in.", "On the contrary, if we blur the images too much, we\u2018ll lose the data. Therefore we need to find an adequate amount of blurring we\u2019re going to apply without losing desirable edges.", "There are several techniques used to achieve blurring effects but we\u2019re going to talk about the four major ones used in OpenCV: Averaging blurring, Gaussian blurring, median blurring and bilateral filtering. All four techniques have a common basic principle, which is applying convolutional operations to the image with a filter (kernel). The values of the applying filters are different between the four blurring methods.", "Average blurring is taking the average of all the pixel values under the given kernel area and replace the value at the center. For example, suppose we have a kernel with the size of 5X5. We calculate the average of the convoluted outcome and put that result to the center of the given area.", "Then what will it be like if we increase the size of the kernel? As the size of filters gets bigger, the pixel values will be normalized more. Therefore we can expect the image to get blurred the more. Let\u2019s check out the result with the code as follows. (For comparison, I\u2019ll keep attaching the original image to the result)", "Medium blurring is the same with average blurring except that it uses the median value instead of the average. Therefore when we have to handle sudden noises in the image such as \u2018salt and pepper noise,\u2019 it\u2019ll be better to use medium blurring than average blurring.", "Gaussian blurring is nothing but using the kernel whose values have a Gaussian distribution. The values are generated by a Gaussian function so it requires a sigma value for its parameter. As you can see the image above, the values of the kernel go higher near the center and go smaller near the corner. It\u2019s good to apply this method to the noises that have a normal distribution such as white noise.", "Bilateral Filtering is an advanced version of Gaussian blurring. Blurring produces not only dissolving noises but also smoothing edges. And bilateral filter can keep edges sharp while removing noises. It uses Gaussian-distributed values but takes both distance and the pixel value differences into account. Therefore it requires sigmaSpace and sigmaColor for the parameters.", "Thresholding transforms images into binary images. We need to set the threshold value and max values and then we convert the pixel values accordingly. There are five different types of thresholding: Binary, the inverse of Binary, Threshold to zero, the inverse of Threshold to Zero, and Threshold truncation.", "You can see how each type of thresholding can be expressed in a mathematical way and I(x, y) is the intensity at the point, or the pixel value at (x, y). But I prefer to understand the concept visually. Take a look at the picture on the right. The images are way better for you to comprehend the difference between the types.", "But don\u2019t you think it\u2019s too harsh to take just one value of threshold and apply it to all parts of an image? What if we have a picture with various amount of lighting in different areas? In this case, applying one value to the whole image would be a bad choice. A better approach would be using different thresholds for each part of the image. There is another technique called Adaptive thresholding, which serves this issue. By calculating the threshold within the neighborhood area of the image, we can achieve a better result from images with varying illumination.", "We need to convert the color mode to grayscale to apply adaptive thresholding. The parameters of adaptive thresholding are maxValue (which I set 255 above), adaptiveMethod , thresholdType , blockSize and C . And the adaptive method here has two kinds: ADAPTIVE_THRESH_MEAN_C , ADAPTIVE_THRESH_GAUSSIAN_C . Let\u2019s just see how images are produced differently.", "We have the original image and the one with binary thresholding on the left line. Compare this with the second and third image on the upper line, which is produced by ADAPTIVE_THRESH_MEAN_C . It shows a more detailed result than that of binary thresholding. We can also see that it gets more explicit when the C value is bigger. C indicates how much we\u2019ll subtract from the mean or weighted mean. With the two images on the right line, we can also compare the effect of ADAPTIVE_THRESH_MEAN_C and ADAPTIVE_THRESH_GAUSSIAN_C with the same C value.", "I believe we are already familiar with the concept of gradients. In mathematics, the gradient geometrically represents the slope of the graph of a function with multi-variables. As it is a vector-valued function, it takes a direction and a magnitude as its components. Here we can also bring the same concept to the pixel values of images as well. The image gradient represents directional changes in the intensity or color mode and we can use this concept for locating edges.", "Sobel operation uses both Gaussian smoothing and differentiation. We apply it by cv2.Sobel() and two different directions are available: vertical (sobel_x) and horizontal (sobel_y). dx and dy indicates the derivatives. When dx = 1 , the operator calculates the derivatives of the pixel values along the horizontal direction to make a filter.", "We can also apply in both directions by summing the two filters of sobel_x and sobel_y . With the function cv2.addWeighted() , we can calculate the weighted sum of the filters. As you can see above in the code cell, I gave the same amount of weight to the two filters.", "Laplacian operation uses the second derivatives of x and y. The mathematical expression is shown below.", "A picture is worth a thousand words. Let\u2019s see how the images are like.", "It\u2019s apparent that the first and second image have a directional pattern. With the first image, we can clearly see the edges in the vertical direction. With the second image, we can see the horizontal edges. And both the third and fourth images, the edges on both directions are shown.", "It\u2019s also possible to manipulate the figures of images by filtering, which is called as morphological transformation. Let\u2019s talk about erosion and dilation first.", "Erosion is the technique for shrinking figures and it\u2019s usually processed in a grayscale. The shape of filters can be a rectangle, an ellipse, and a cross shape. By applying a filter we remove any 0 values under the given area.", "Let\u2019s see how these can be implemented in codes.", "Check out how the Simpson\u2019s family shrank with different types of kernels applied. (Sorry to Simpson for losing his hands!) We can see the image with the ellipse filter is eroded in a \u201cround\u201d way while the one with the basic filter with a squared shape is eroded in a \u201clinear\u201d way. The last one with the cross filter shows it shrank in a \u201cdiagonal\u201d way.", "Dilation is the opposite to erosion. It is making objects expand and the operation will be also opposite to that of erosion. Let\u2019s check out the result with the code as follows.", "Opening and closing operation is the mixed version of erosion and dilation. Opening performs erosion first and then dilation is performed on the result from the erosion while closing performs dilation first and the erosion.", "As you can see the picture above, closing is useful to detect the overall contour of a figure and opening is suitable to detect subpatterns. We can implement these operators with the function cv2.morphologyEx() shown below. The parameter op indicates which type of operator we\u2019re going to use.", "Note that the Simpson\u2019s hand is depicted differently in the images with the opening filter and closing filter. Gradient filter (MORPH_CGRADIENT) is the subtracted area from dilation to erosion. Top hat filter (MORPH_TOPHAT) is the subtracted area from opening to the original image while black hot filter (MORPH_BLACKHAT) is that from closing. I\u2019d recommend you to visit here to get further explanations on morphological operators.", "Did you enjoy the various image manipulation techniques? Besides the things we\u2019ve discussed, there are other things available in OpenCV. So don\u2019t hesitate to take a visit and check out OpenCV documentation. Next time will be about the detection techniques such as contour detection and face detections.", "Are there errors you would love to correct? Please share your insight with us. I\u2019m always open to talk, so feel free to leave comments below and share your thoughts. I also share interesting and useful resources on LinkedIn so feel free to follow or reach out to me. I\u2019ll be back with the next series of the story. Stay tuned!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Researcher / Data geek \ud83e\udd13 Bookworm \ud83d\udcda Travel lover \ud83c\udf0f LinkedIn: https://www.linkedin.com/in/jiwon-jeong/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F29b3f9151874&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----29b3f9151874--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29b3f9151874--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jiwon.jeong?source=post_page-----29b3f9151874--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jiwon.jeong?source=post_page-----29b3f9151874--------------------------------", "anchor_text": "Jiwon Jeong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1df293b5ca56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&user=Jiwon+Jeong&userId=1df293b5ca56&source=post_page-1df293b5ca56----29b3f9151874---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29b3f9151874&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29b3f9151874&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/computer-vision-for-beginners-part-1-7cca775f58ef", "anchor_text": "Understanding color models and drawing figures on images"}, {"url": "https://towardsdatascience.com/computer-vision-for-beginners-part-3-79de62dbeef7", "anchor_text": "From feature detection to face detection"}, {"url": "https://towardsdatascience.com/computer-vision-for-beginners-part-4-64a8d9856208", "anchor_text": "Contour detection and having a little bit of fun"}, {"url": "https://towardsdatascience.com/the-most-intuitive-and-easiest-guide-for-convolutional-neural-network-3607be47480", "anchor_text": "this post"}, {"url": "https://github.com/jjone36/vision_4_beginners/blob/master/part2_image_processing.ipynb", "anchor_text": "Github"}, {"url": "https://en.wikipedia.org/wiki/Salt-and-pepper_noise", "anchor_text": "salt and pepper noise"}, {"url": "http://eric-yuan.me/bilateral-filtering/", "anchor_text": "The shape of a Gaussian filter (on the left) and a Bilateral filter (on the right)"}, {"url": "https://en.wikipedia.org/wiki/Gaussian_noise", "anchor_text": "noises that have a normal distribution"}, {"url": "https://en.wikipedia.org/wiki/White_noise", "anchor_text": "white noise"}, {"url": "https://en.wikipedia.org/wiki/Gradient", "anchor_text": "gradient"}, {"url": "https://en.wikipedia.org/wiki/Image_gradient", "anchor_text": "image gradient"}, {"url": "https://en.wikipedia.org/wiki/Sobel_operator", "anchor_text": "Sobel operation"}, {"url": "https://homepages.inf.ed.ac.uk/rbf/HIPR2/morops.htm", "anchor_text": "here"}, {"url": "https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=adaptivethreshold#https://datascienceschool.net/view-notebook/c4121d311aa34e6faa84f62ef06e43b0/", "anchor_text": "OpenCV documentation"}, {"url": "https://www.linkedin.com/in/jiwon-jeong/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----29b3f9151874---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----29b3f9151874---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/opencv?source=post_page-----29b3f9151874---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----29b3f9151874---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----29b3f9151874---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29b3f9151874&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&user=Jiwon+Jeong&userId=1df293b5ca56&source=-----29b3f9151874---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29b3f9151874&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&user=Jiwon+Jeong&userId=1df293b5ca56&source=-----29b3f9151874---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29b3f9151874&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29b3f9151874--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F29b3f9151874&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----29b3f9151874---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----29b3f9151874--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----29b3f9151874--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----29b3f9151874--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----29b3f9151874--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----29b3f9151874--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----29b3f9151874--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----29b3f9151874--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----29b3f9151874--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jiwon.jeong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jiwon.jeong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jiwon Jeong"}, {"url": "https://medium.com/@jiwon.jeong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.4K Followers"}, {"url": "https://www.linkedin.com/in/jiwon-jeong/", "anchor_text": "https://www.linkedin.com/in/jiwon-jeong/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1df293b5ca56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&user=Jiwon+Jeong&userId=1df293b5ca56&source=post_page-1df293b5ca56--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd0a222fc96e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-for-beginners-part-2-29b3f9151874&newsletterV3=1df293b5ca56&newsletterV3Id=d0a222fc96e6&user=Jiwon+Jeong&userId=1df293b5ca56&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}