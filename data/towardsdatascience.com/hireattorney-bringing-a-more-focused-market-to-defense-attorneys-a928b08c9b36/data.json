{"url": "https://towardsdatascience.com/hireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36", "time": 1683016228.0679958, "path": "towardsdatascience.com/hireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36/", "webpage": {"metadata": {"title": "HireAttorney \u2014 bringing a more focused market to defense attorneys | by Yuan Hu | Towards Data Science", "h1": "HireAttorney \u2014 bringing a more focused market to defense attorneys", "description": "I recently consulted for a law firm to identify defendants who are more likely to use their services. Previously, they tried to send emails to all defendants, but the response rate was close to zero\u2026"}, "outgoing_paragraph_urls": [{"url": "https://statistics.berkeley.edu/sites/default/files/tech-reports/666.pdf", "anchor_text": "Using Random Forest to Learn Imbalanced Data(2004)", "paragraph_index": 31}], "all_paragraphs": ["I recently consulted for a law firm to identify defendants who are more likely to use their services.", "Previously, they tried to send emails to all defendants, but the response rate was close to zero. They also tried to identify the defendants with a high likelihood to hire them based on their experience while applying another marketing strategy, but there were two problems with this. One is that it\u2019s time consuming since they need to analyze all information about the defendant manually. Another is that the response rate is still low even if they use their experience to identify the defendants. They either marketed to the wrong person, in which they wasted a lot of marketing money and time, or they overlooked a client and missed a potential fortune.", "So how to identify a high quality market, so that the company has a better use of their time and money and at the same time, they don\u2019t lose any potential clients?", "One solution is to predict the probability that a defendant will hire a private attorney using machine learning, which offers them a quick and accurate way to identify potential clients.", "The data I have is 35 .txt files containing 10 years of historical criminal records. After merging the data into .csv file, I have more than 3M rows, and over 40 variables of mixed data types, including text, categorical and numerical data. Some of the columns are File Date, Case Number, Case Style, Arrest Date, Offense Date, Judge, Defendant\u2019s Info, etc. I also noticed that the dataset is unlabelled.", "Since the dataset is unlabelled, the first step is to create labels based on the attorney\u2019 names.", "This is a semi-automatic approach. I wrote a python function to identify the keywords. It selects the most common words in public attorneys, such as OFFICE, PUBLIC, etc. But as it adds more keywords, it classifies some private attorneys as public ones. In that case, I had to remove those words from the keywords set. I did the process iteratively to minimize the errors. Then the refined keywords set was used to create labels. If the name contains any of the keywords, it is classified as public; otherwise, it\u2019s private.", "When I got the labels, I realized that the dataset is imbalanced. The number of observations for public attorneys is about 5 times as many as that for private attorneys.", "After I created the labels, I did EDA, Data cleaning, and feature engineering. I iterated the process to refine the features.", "The dataset was pretty messy. For example, the dates are in different formats, the same category can have different names, white spaces, empty cells, etc. Here are some examples of how I cleaned the data.", "I normalized all the dates and converted them into a datetime type. For text data, I removed all the leading and trailing spaces, and converted the lower case into upper case. As for categories that have different names but point to the same thing, I combined them into one.", "Feature engineering is one of the most challenging parts of this project. Although there are over 40 variables, except for gender and race, I could use none of the variables directly. I worked closely with the company to understand what factors would affect the defendants\u2019 decision. I selected relevant variables and derived important features that could reflect the defendant\u2019s behavior.", "To be specific, in feature engineering, I focus on three things. First , I removed future information to make sure that the future was not used to predict the past. Some variables, such as Disposition Description, Confinement Type, etc, are not known at the time when the defendants make a decision whether to hire a private attorney or not, and this information will cause data leakage.", "Second, I leveled down the categories for some categorical features which have too many levels. For example, in the feature Arrest Agency, I have 160 categories. But there are only three categories that are most frequent, so I grouped the other categories into one, which leveled it down to 4 categories in total.", "Last and most importantly, I derived the important features that reflect the defendant\u2019 behavior. Here are two examples.", "Area median income reflects the economic condition of the defendants. I extracted the zip code from the defendant\u2019s address, and I collected the Median income data from the US Census. I combined the two to get area median income for my dataset.", "Age is another important feature to reflect the defendants\u2019 behavior. In order to estimate the age of the defendant, I combined the three dates, whichever is available, and then subtracted the DOB of the defendant.", "A proper algorithm should be able to deal with mixed feature types and handle imbalanced outcomes. And it should have a good prediction performance, run fast and interpretable. So I chose a balanced random forest as my final model.", "A standard random forest induces each individual tree from a bootstrap sample, i.e., sample with replacement, of the training data. In learning imbalanced data, there is a high chance that a bootstrap sample contains few or even none of the minority class, resulting in a tree with poor performance for predicting the minority class. To overcome this problem, balanced random forest uses a stratified bootstrap sample within each class, i.e., it draws the same number of cases from each class when constructing each individual tree, so that it learns from each class.", "From the confusion matrix, both the True Positive Rate and True Negative Rate are above 85%, indicating my model performs well for both the majority class and minority class.", "When marketing to the defendants, we suffer from two types of errors.", "The model outputs the probability that a defendant will hire a private attorney, and it makes decisions based on the threshold.", "Then how should we choose the threshold? For instance, if we set the threshold to 0.2, we will \u201coverlook\u201d less, but we reach out to more \u201cwrong person\u201d. Instead, if we set the threshold to 0.9, we will have less errors from \u201cwrong person\u201d, but we \u201coverlook\u201d more. So how should we balance the two types of errors?", "In order to minimize the cost we suffer from the two types of errors when marketing to the defendants, I introduced a model with cost.", "When we plug in the estimated costs of the two types of errors to the model, we get a suggested threshold along with the minimum cost.", "When we input the estimated cost of the \u201cwrong person\u201d, which is $800, and the estimated cost of \u201coverlook\u201d, which is $1000, into the model with cost, the model will calculate different overall cost based on all the thresholds. Then the model selects the threshold that gives the minimum cost. In this example, the best threshold is 0.533 and the minimum cost is $83.", "I also calculated the cost from the coin flipping of suffering from the two types of errors, which is $416, indicating that we have an average saving of more than $300 per case when using my model.", "Due to the sensitive nature of the data, I did look at the model performance across different demographic groups, such as gender and race, and my model is general to each group.", "Attorney distributions in the two groups are different. According to the data, there are more private attorneys for the white race than for other races. But my model has a similar ratio for recommending the private attorney to both groups, which means the model is general to each of the groups, and it\u2019s not biased.", "The same thing happens with gender. My model has a similar ratio for recommending private attorneys to female and male, which means the model is general to both female and male.", "Thanks for reading! Enjoy the rest of your day!", "[1] Chao Chen, Andy Liaw and Leo Breiman, Using Random Forest to Learn Imbalanced Data(2004), Tech Reports on University of California, Berkeley", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa928b08c9b36&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://huyuan.medium.com/?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": ""}, {"url": "https://huyuan.medium.com/?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": "Yuan Hu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F49c84cf8bc99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&user=Yuan+Hu&userId=49c84cf8bc99&source=post_page-49c84cf8bc99----a928b08c9b36---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa928b08c9b36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa928b08c9b36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://statistics.berkeley.edu/sites/default/files/tech-reports/666.pdf", "anchor_text": "Using Random Forest to Learn Imbalanced Data(2004)"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a928b08c9b36---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/predictive-modeling?source=post_page-----a928b08c9b36---------------predictive_modeling-----------------", "anchor_text": "Predictive Modeling"}, {"url": "https://medium.com/tag/feature-engineering?source=post_page-----a928b08c9b36---------------feature_engineering-----------------", "anchor_text": "Feature Engineering"}, {"url": "https://medium.com/tag/imbalanced-data?source=post_page-----a928b08c9b36---------------imbalanced_data-----------------", "anchor_text": "Imbalanced Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa928b08c9b36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&user=Yuan+Hu&userId=49c84cf8bc99&source=-----a928b08c9b36---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa928b08c9b36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&user=Yuan+Hu&userId=49c84cf8bc99&source=-----a928b08c9b36---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa928b08c9b36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa928b08c9b36&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a928b08c9b36---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a928b08c9b36--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a928b08c9b36--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a928b08c9b36--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a928b08c9b36--------------------------------", "anchor_text": ""}, {"url": "https://huyuan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://huyuan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yuan Hu"}, {"url": "https://huyuan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4 Followers"}, {"url": "https://www.linkedin.com/in/yuan-hu-yy/", "anchor_text": "https://www.linkedin.com/in/yuan-hu-yy/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F49c84cf8bc99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&user=Yuan+Hu&userId=49c84cf8bc99&source=post_page-49c84cf8bc99--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F49c84cf8bc99%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhireattorney-bringing-a-more-focused-market-to-defense-attorneys-a928b08c9b36&user=Yuan+Hu&userId=49c84cf8bc99&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}