{"url": "https://towardsdatascience.com/time-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1", "time": 1683009184.5847418, "path": "towardsdatascience.com/time-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1/", "webpage": {"metadata": {"title": "Time Series Modeling using Scikit, Pandas, and Numpy | by Dr. Varshita Sher | Towards Data Science", "h1": "Time Series Modeling using Scikit, Pandas, and Numpy", "description": "Welcome to Part 2 of Time Series Analysis! In this post, we will be working our way through modeling time series data. This is a continuation of my previous post on Time Series Data. In our previous\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/time-series-analysis-using-pandas-in-python-f726d87a97d8", "anchor_text": "previous blog post", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/time-series-analysis-using-pandas-in-python-f726d87a97d8", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.statsmodels.org/devel/generated/statsmodels.tsa.arima_model.ARIMA.html", "anchor_text": "ARIMA", "paragraph_index": 2}, {"url": "https://facebook.github.io/prophet/#:~:text=Prophet%20is%20a%20procedure%20for,several%20seasons%20of%20historical%20data.", "anchor_text": "Prophet", "paragraph_index": 2}, {"url": "https://raw.githubusercontent.com/jenfly/opsd/master/opsd_germany_daily.csv", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://medium.com/swlh/grid-search-in-h2o-6bc3b5ef9dd0", "anchor_text": "previous articles", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/model_evaluation.html#the-scoring-parameter-defining-model-evaluation-rules", "anchor_text": "common scoring metrics", "paragraph_index": 20}, {"url": "https://towardsdatascience.com/time-series-analysis-using-pandas-in-python-f726d87a97d8", "anchor_text": "Part 1", "paragraph_index": 27}, {"url": "https://medium.com/@vishi2020/tackling-the-time-series-take-home-assignment-a-case-study-in-python-b2a3bd78d956", "anchor_text": "Part 3", "paragraph_index": 31}, {"url": "https://www.investopedia.com/terms/a/abandon-rate.asp#:~:text=For%20an%20inbound%20call%20center,direct%20relation%20to%20waiting%20times.", "anchor_text": "abandonment rates", "paragraph_index": 31}, {"url": "https://varshitasher.medium.com/membership", "anchor_text": "my link", "paragraph_index": 32}, {"url": "https://podurama.com", "anchor_text": "https://podurama.com", "paragraph_index": 34}], "all_paragraphs": ["Welcome to Part 2 of Time Series Analysis! In this post, we will be working our way through modeling time series data. This is a continuation of my previous post on Time Series Data.", "In our previous blog post, we talked about what time series data is, how to format such data to maximize its utility, and how to handle missing data. We also learned how to resample time series data by the month, week, year, etc, and calculate rolling means. We dived into concepts such as trends, seasonality, first-order differencing, and autocorrelation. If you are familiar with most of the stuff, you are good to go. In case you need a refresher, you can do a quick google search for these topics or read my previous post here.", "There are other, undoubtedly better, packages available for time series forecastings, such as ARIMA or Facebook\u2019s proprietory software Prophet. However, this article was inspired by a friend\u2019s take-home assignment that required her to use only Scikit, Numpy, and Pandas (or face instant disqualification!).", "We will be working with the publicly available dataset Open Power System Data. You can download the data here. It contains electricity consumption, wind power production, and solar power production for 2006\u20132017.", "After setting the Date column as the index, this is how our dataset looks like:", "Our aim is to predict Consumption (ideally for future unseen dates) from this time series dataset.", "In order to evaluate how good our model is, we would be using R-squared and Root Mean Squared Error (but will be printing all relevant metrics for you to take the final call).", "In order to print all performance metrics relevant to a regression task (such as MAE and R-square), we will be defining the regression_results function.", "As a baseline, we choose a simplistic model, one that predicts today\u2019s consumption value based on", "A question that often comes up during data science interviews is: Which cross-validation technique would you use on time-series data?", "You may be tempted to gravitate towards the all-time-favorite K-Fold Cross-Validation (believe me, up until recently \u2014 don\u2019t ask how recently! \u2014 I did not know there exist CV techniques other than K-fold). Unfortunately, that would not be the correct answer. The reason being, it does not take into account that time-series data has some natural ordering to it and the randomization in standard k-fold cross-validation does not preserve that ordering.", "A better alternative for cross validation on time series data (than K-fold CV) is Forward Chaining strategy.", "In forward chaining, say with 3 folds, the train and validation sets look like:", "where 1, 2, 3, 4 represent the year. This way successive training sets are supersets of those that come before them.", "Luckily for us, sklearn has a provision for implementing such train test split using TimeSeriesSplit.", "The TimeSerieSplit function takes as input the number of splits. Since our training data has 11 unique years (2006 -2016), we would be setting n_splits = 10. This way we have neat training and validation sets:", "Both KNN and RF perform equally well. But I personally prefer RF since this ensemble model (combine multiple \u2018individual\u2019 (diverse) models together and deliver superior prediction power.) can almost work out of the box and that is one reason why they are very popular.", "I discussed the need for grid searching hyperparameters in one of my previous articles.", "An optimal combination of hyperparameters maximizes a model\u2019s performance without leading to a high variance problem (overfitting).", "The Python code for performing grid-search is as follows:", "If you notice the code above, we have defined a custom scorer by setting scoring = rmse_scoreinstead of using one of the common scoring metrics defined in sklearn. We define our custom scorer as follows:", "This is not bad for starters. Let\u2019s see if we can further improve our model.", "Up until now, we have been using values at (t-1)th day to predict values on t date. Now, let us also use values from (t-2)days to predict consumption:", "Great news!! We have significantly brought down the RMSE and MAE values, whereas the R-squared value has also gone up.", "Let us see if adding the value of solar production is beneficial in some way to predicting electricity consumption.", "Voila, the model\u2019s performance is even better now.", "As we can see, the amount of solar production is not as strong a predictor of power consumption as other time-based predictors.", "If you followed the narrative in Part 1 of my previous blog post, you would remember that our dataset has some seasonal element to it, weekly seasonality to be more precise. Thus, it would make more sense to feed as input to the model, consumption value in the week prior to the given date. That means, if the model is trying to predict the consumption value on Jan 8, it must be fed information about the consumption on Jan 1.", "And we did it again.. The errors have been reduced further and r-square increased. We could keep on adding more relevant features but I guess you get the idea now!", "As we rightly hypothesized, the value on (t-7)th day is a much stronger predictor than the value on (t-1)th day.", "In this article, we learned how to model time series data, conduct cross-validation on time series data, and fine-tune our model hyperparameters. We also successfully managed to reduce the RMSE from 85.61 to 54.57 for predicting power consumption.", "In Part 3 of this series, we will be working on a case study analyzing the time series data generated by call centers, essentially working towards analyzing the (dreaded) increment in abandonment rates. Stay tuned\u2026", "I enjoy writing step-by-step beginner\u2019s guides, how-to tutorials, interview questions, decoding terminology used in ML/AI, etc. If you want full access to all my articles (and others on Medium), then you can sign up using my link here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist | Explain like I am 5 | Oxford & SFU Alumni | https://podurama.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F682e3b8db8d1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://varshitasher.medium.com/?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": ""}, {"url": "https://varshitasher.medium.com/?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": "Dr. Varshita Sher"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff8ca36def59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=post_page-f8ca36def59----682e3b8db8d1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F682e3b8db8d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F682e3b8db8d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@vishi2020https://medium.com/@vishi2020", "anchor_text": "Author"}, {"url": "https://towardsdatascience.com/time-series-analysis-using-pandas-in-python-f726d87a97d8", "anchor_text": "previous blog post"}, {"url": "https://towardsdatascience.com/time-series-analysis-using-pandas-in-python-f726d87a97d8", "anchor_text": "here"}, {"url": "https://www.statsmodels.org/devel/generated/statsmodels.tsa.arima_model.ARIMA.html", "anchor_text": "ARIMA"}, {"url": "https://facebook.github.io/prophet/#:~:text=Prophet%20is%20a%20procedure%20for,several%20seasons%20of%20historical%20data.", "anchor_text": "Prophet"}, {"url": "https://raw.githubusercontent.com/jenfly/opsd/master/opsd_germany_daily.csv", "anchor_text": "here"}, {"url": "https://raw.githubusercontent.com/jenfly/opsd/master/opsd_germany_daily.csv'", "anchor_text": "https://raw.githubusercontent.com/jenfly/opsd/master/opsd_germany_daily.csv'"}, {"url": "https://medium.com/swlh/grid-search-in-h2o-6bc3b5ef9dd0", "anchor_text": "previous articles"}, {"url": "https://scikit-learn.org/stable/modules/model_evaluation.html#the-scoring-parameter-defining-model-evaluation-rules", "anchor_text": "common scoring metrics"}, {"url": "https://towardsdatascience.com/time-series-analysis-using-pandas-in-python-f726d87a97d8", "anchor_text": "Part 1"}, {"url": "https://medium.com/@vishi2020/tackling-the-time-series-take-home-assignment-a-case-study-in-python-b2a3bd78d956", "anchor_text": "Part 3"}, {"url": "https://www.investopedia.com/terms/a/abandon-rate.asp#:~:text=For%20an%20inbound%20call%20center,direct%20relation%20to%20waiting%20times.", "anchor_text": "abandonment rates"}, {"url": "https://varshitasher.medium.com/membership", "anchor_text": "my link"}, {"url": "https://towardsdatascience.com/fine-tuning-hubert-for-emotion-recognition-in-custom-audio-data-using-huggingface-c2d516b41cd8", "anchor_text": "Detect emotion in speech data: Fine-tuning HuBERT using HuggingfaceBuilding custom data loader, experiment logging, tips for improving metrics, and GitHub repo if you\u2019d like to follow\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/understanding-python-imports-init-py-and-pythonpath-once-and-for-all-4c5249ab6355", "anchor_text": "Understanding Python imports, __init__.py and pythonpath \u2014 once and for allLearn how to import packages and modules (and the difference between the two)towardsdatascience.com"}, {"url": "https://medium.com/@vishi2020/tackling-the-time-series-take-home-assignment-a-case-study-in-python-b2a3bd78d956", "anchor_text": "Tackling the Time-Series take-home assignment: A Case Study in PythonImproving Customer Support with Call Centre Analyticsmedium.com"}, {"url": "https://towardsdatascience.com/data-scientists-guide-to-efficient-coding-in-python-670c78a7bf79", "anchor_text": "Data scientist\u2019s guide to efficient coding in PythonTips and tricks I use for writing clean codes on a day-to-day basistowardsdatascience.com"}, {"url": "https://medium.com/tag/timeseries-forecasting?source=post_page-----682e3b8db8d1---------------timeseries_forecasting-----------------", "anchor_text": "Timeseries Forecasting"}, {"url": "https://medium.com/tag/timeseries?source=post_page-----682e3b8db8d1---------------timeseries-----------------", "anchor_text": "Timeseries"}, {"url": "https://medium.com/tag/data-science?source=post_page-----682e3b8db8d1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----682e3b8db8d1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/predictive-analytics?source=post_page-----682e3b8db8d1---------------predictive_analytics-----------------", "anchor_text": "Predictive Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F682e3b8db8d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=-----682e3b8db8d1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F682e3b8db8d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=-----682e3b8db8d1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F682e3b8db8d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F682e3b8db8d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----682e3b8db8d1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----682e3b8db8d1--------------------------------", "anchor_text": ""}, {"url": "https://varshitasher.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://varshitasher.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dr. Varshita Sher"}, {"url": "https://varshitasher.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.2K Followers"}, {"url": "https://podurama.com", "anchor_text": "https://podurama.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff8ca36def59&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=post_page-f8ca36def59--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1aea8fe02d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime-series-modeling-using-scikit-pandas-and-numpy-682e3b8db8d1&newsletterV3=f8ca36def59&newsletterV3Id=1aea8fe02d9&user=Dr.+Varshita+Sher&userId=f8ca36def59&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}