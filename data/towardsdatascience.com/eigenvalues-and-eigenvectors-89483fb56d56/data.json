{"url": "https://towardsdatascience.com/eigenvalues-and-eigenvectors-89483fb56d56", "time": 1683010271.9199739, "path": "towardsdatascience.com/eigenvalues-and-eigenvectors-89483fb56d56/", "webpage": {"metadata": {"title": "Eigenvalues and Eigenvectors. Computing and Visualizing | by Ben Denis Shaffer | Towards Data Science", "h1": "Eigenvalues and Eigenvectors", "description": "Eigenvalues and eigenvectors can be found all over mathematics, and especially applied mathematics. Statistics, Machine Learning, Data Science all fall into that bucket. Some time ago I decided to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://people.inf.ethz.ch/arbenz/ewp/Lnotes/chapter4.pdf", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.youtube.com/watch?v=wTUSz-HSaBg", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/qr-matrix-factorization-15bae43a6b2", "anchor_text": "my previous post", "paragraph_index": 6}, {"url": "https://people.inf.ethz.ch/arbenz/ewp/Lnotes/chapter4.pdf", "anchor_text": "here", "paragraph_index": 14}], "all_paragraphs": ["Eigenvalues and eigenvectors can be found all over mathematics, and especially applied mathematics. Statistics, Machine Learning, Data Science all fall into that bucket.", "Some time ago I decided to learn Rcpp and C++ by implementing Principal Component Analysis (PCA). I knew that the solution to the PCA problem was the eigenvalue decomposition of the Sample Variance-Covariance Matrix. I realized that I would need to write my own version of the built-in eigen function in C++ and that is when I realized that beyond a 2x2 case, I didn\u2019t know how eigen actually works. What I discovered was the QR Method that I read about here.", "With a 2x2 matrix, we can solve for eigenvalues by hand. That works because the determinant of a 2x2 matrix is a polynomial of degree 2 so we can factorize and solve it using regular algebra. But HOW do you compute eigenvalues for large matrices? Turns out, that when you can\u2019t factorize and solve polynomials, what you really should be doing is factorizing matrices. By pure coincidence, the Numberphile YouTube channel recently had a video on this idea posted here. Worth checking out if you are into this type of content!", "First, just a quick refresher on what Eigenvalues and Eigenvectors are. Take a square matrix X. If there is a vector v and a scalar \u03bb such that", "then v is an eigenvector of X and \u03bb is the corresponding eigenvalue of X.", "In words, if you think of multiplying v by X as applying a function to v, then for this particular vector v this function is nothing but a stretching/squishing scalar multiplication. Usually multiplying a vector by a matrix equates to taking linear combinations of the components of a vector. But if you take an Eigenvector, you don\u2019t need to do all that computation. Just multiply by the Eigenvalue and you are all good.", "The QR method for computing Eigenvalues and Eigenvectors begins with my beloved QR matrix decomposition. I wrote about it in my previous post. This decomposition allows one to express a matrix X=QR as a product of an orthogonal matrix Q and an upper triangular matrix R. Again, the fact that Q is orthogonal is important.", "The central idea of the QR method for finding the eigenvalues is iteratively applying the QR matrix decomposition to the original matrix X.", "Here I need to mention one mathematical property of Eigenvalues of X. If we take any invertible matrix M then the matrix", "will have the same Eigenvalues as X. Such matrices E and X are formally defined as similar matrices, which simply means that they have the same Eigenvalues. Eigenvectors will be different, however. Also, recall that the Q in QR is orthogonal and therefore inevitable.", "So, the idea of the QR method is to iterate the following steps", "Note: E is similar to X. Their Eigenvalues are the same.", "5. Iterate unit the ith E is essentially diagonal.", "When E is diagonal what you have are the desired Eigenvalues on the diagonal, and V are the Eigenvectors!", "This is the simplest version of the QR method. There are a couple of improved versions that I will not go into, but you can read about them here.", "Next, I want to write a function in R and C++ to implement the method and verify for me that it works.", "Here is what we will do:", "Here are the packages I\u2019ll be using:", "my_eigen is a pretty simple function. The first few lines preform the initial iteration of the QR method. Then a while loop iterates until the diagonal of the E matrix stabilize and no longer changes beyond a small margin. The returned list with values and vectors should be identical to what the eigen function returns. For the QR decomposition step, I am using myc_qr from the myc package.", "Let\u2019s check that it works. I\u2019ll use a symmetric matrix because I want to make sure eigenvalues are not complex numbers.", "Here is the matrix that I\u2019ll use to verify that my function works as expected.", "Here is what the built-in eigen function returns.", "As you can see below when calling the my_eigen function the result is identical.", "When calling the myc_eigen function which is an Rcpp version the result is also the same.", "Additionally, we can verify that the computed decomposition is correct by comparing the result of applying A and \u03bb to an Eigenvector and checking that they are equal.", "And as expected scaling v by \u03bb gives the same vector. Values do seem to diverge a bit towards the 7th significant figure but the solution is acceptably close.", "Just out of interest I wanted to compare how fast these functions are at computing the Eigenvalues. It looks like on a small matrix like the 4x4 one we used above the build-in eigen function is a little slower.", "If we take a larger matrix then of course eigen is much faster. The Rcpp version is my function is only a bit faster than the pure R function, probably because it uses a matrix multiplication function myc_matmult that is notably slower than the %*% operator.", "Obviously implementing the QR method yourself is not motivated by better performance. What we can do however is build a function that keeps track of how values are computed and maybe get a better feeling for how it works.", "Below is a function my_eigen2 which does the same computation as does the my_eigen function, except instead of using a while loop it iterates a given maximum number of times and keeps a record of the updated Eigenvalues. If the computation converges then iterations stop before reaching the given maximum.", "To visualize how the QR methods works I decided to use a 2x2 covariance matrix. This is to make this relevant to PCA and to make it easy to actually visualize.", "First, we let my_eigen2 do the computation and build up the lists of matrices that keep track of how the QR method converges to the answer. After 9 steps the computation converges.", "These are the actual Eigenvalues and Eigenvectors:", "The following code extracts the direction of the two Eigenvectors at each step of the computation and stacked them into a data.frame. We can use these to compute the slopes and then visualize them on top of a density plot.", "Using ggplot and plotly we can produce the following animated visualization", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Predictive Analytics @TBWAChiatNY \\ MS Applied Statistics @UMich \\ EconMath @BU_Tweets \\ Data Science Fundamentals + Applications in Marketing Science \\ R UseR!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F89483fb56d56&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----89483fb56d56--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89483fb56d56--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bdshaff.medium.com/?source=post_page-----89483fb56d56--------------------------------", "anchor_text": ""}, {"url": "https://bdshaff.medium.com/?source=post_page-----89483fb56d56--------------------------------", "anchor_text": "Ben Denis Shaffer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7438041dcdf1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&user=Ben+Denis+Shaffer&userId=7438041dcdf1&source=post_page-7438041dcdf1----89483fb56d56---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89483fb56d56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89483fb56d56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://bdshaff.github.io/bdshaff.github.io/blog/2020-03-23-computing-eigenvalues-and-eigenvectors/", "anchor_text": "https://bdshaff.github.io/bdshaff.github.io/blog/2020-03-23-computing-eigenvalues-and-eigenvectors/"}, {"url": "https://people.inf.ethz.ch/arbenz/ewp/Lnotes/chapter4.pdf", "anchor_text": "here"}, {"url": "https://www.youtube.com/watch?v=wTUSz-HSaBg", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/qr-matrix-factorization-15bae43a6b2", "anchor_text": "my previous post"}, {"url": "https://people.inf.ethz.ch/arbenz/ewp/Lnotes/chapter4.pdf", "anchor_text": "here"}, {"url": "https://bdshaff.github.io/bdshaff.github.io/blog/2020-03-23-computing-eigenvalues-and-eigenvectors/", "anchor_text": "https://bdshaff.github.io/bdshaff.github.io/blog/2020-03-23-computing-eigenvalues-and-eigenvectors/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----89483fb56d56---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----89483fb56d56---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/r?source=post_page-----89483fb56d56---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/linear-algebra?source=post_page-----89483fb56d56---------------linear_algebra-----------------", "anchor_text": "Linear Algebra"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----89483fb56d56---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89483fb56d56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&user=Ben+Denis+Shaffer&userId=7438041dcdf1&source=-----89483fb56d56---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F89483fb56d56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&user=Ben+Denis+Shaffer&userId=7438041dcdf1&source=-----89483fb56d56---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F89483fb56d56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----89483fb56d56--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F89483fb56d56&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----89483fb56d56---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----89483fb56d56--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----89483fb56d56--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----89483fb56d56--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----89483fb56d56--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----89483fb56d56--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----89483fb56d56--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----89483fb56d56--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----89483fb56d56--------------------------------", "anchor_text": ""}, {"url": "https://bdshaff.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bdshaff.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ben Denis Shaffer"}, {"url": "https://bdshaff.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "88 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7438041dcdf1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&user=Ben+Denis+Shaffer&userId=7438041dcdf1&source=post_page-7438041dcdf1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7173725232ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Feigenvalues-and-eigenvectors-89483fb56d56&newsletterV3=7438041dcdf1&newsletterV3Id=7173725232ff&user=Ben+Denis+Shaffer&userId=7438041dcdf1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}