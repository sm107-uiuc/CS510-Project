{"url": "https://towardsdatascience.com/computer-vision-and-the-ultimate-pong-ai-e6d70153fc45", "time": 1683012002.5687628, "path": "towardsdatascience.com/computer-vision-and-the-ultimate-pong-ai-e6d70153fc45/", "webpage": {"metadata": {"title": "Computer vision and the ultimate pong AI | by Robin T. White, PhD | Towards Data Science", "h1": "Computer vision and the ultimate pong AI", "description": "One of my favourite YouTuber\u2019s, CodeBullet, once attempted to create a pong AI to rule them all. Sadly he ran into troubles, not because he isn\u2019t capable but I don\u2019t think his experience at the time\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/channel/UC0e3QhIYukixgh5VVpKHH9Q", "anchor_text": "CodeBullet", "paragraph_index": 0}, {"url": "https://www.youtube.com/watch?v=tcymhYbRvw8&", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://www.ponggame.org/", "anchor_text": "ponggame.org", "paragraph_index": 2}, {"url": "https://pypi.org/project/mss/", "anchor_text": "MSS", "paragraph_index": 3}, {"url": "http://stackoverflow.com/questions/14489013/simulate-python-keypresses-for-controlling-a-game", "anchor_text": "code", "paragraph_index": 6}, {"url": "http://www.gamespp.com/directx/directInputKeyboardScanCodes.html", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://github.com/robintwhite", "anchor_text": "github", "paragraph_index": 15}], "all_paragraphs": ["One of my favourite YouTuber\u2019s, CodeBullet, once attempted to create a pong AI to rule them all. Sadly he ran into troubles, not because he isn\u2019t capable but I don\u2019t think his experience at the time had much in the way of computer vision. He is absolutely hilarious and I highly recommend you watch him (parental advisory is advised) if you are at all considering reading the rest of this post. Also he is a genius at what he does. Love you mate. See his video here.", "This seemed like a really fun and simple task so I had to give it a go. In this post I will outline some of the considerations I took that may help if you wish to work on any similar project, and I think I will try my hand at a few more of these, so if you like this type of thing consider following me.", "The nice thing about using computer vision is that I can just use a already built game and process the images. Having said that, we will be using the same game version as the one CodeBullet was using from ponggame.org. It also has a 2 player mode so I can play against my own AI; which I did, and it was hard\u2026", "First things first, getting the screen. I wanted to make sure my frame rate was as fast as possible and for this I found MSS to be a great python package. With this I was easily maxing out at 60 fps and comparing this to PIL I was only getting about 20 fps. It returns as a numpy array so my life was complete.", "Working our way in order of simplicity, we need to define the paddle locations. This could be done in a few different ways but I thought the most obvious was to mask the area for each paddle and run connected components to find the paddle object. Here is a snippet of that code:", "In the above, \u2018vertices\u2019 is just a list of the coordinates that define the masked region. Once I have the object within each region I can get their centroid position or the bounding box. One thing to note is that OpenCV includes the background as the 0'th object in any connected component list, so in this case I always grabbed the second largest object. The result is below \u2014 the paddle on the right with the green centroid is the player / soon-to-be AI controlled paddle.", "Now that we have our output, we need an input. For this I turned to a useful package and someone else\u2019s code \u2014 thanks StackOverflow. It uses ctypes to simulate keyboard presses and in this case, the game is played using the \u2018k\u2019 and \u2018m\u2019 keys. I got the Scan Codes here. After testing that it worked by just randomly moving up and down, we are good to start tracking.", "Next up is to identify and track the pong. Again, this could have been handled in several ways \u2014 one of which could have been to do object detection by using a template, however instead I again went with connected components and object properties, namely the area of the pong since it is the only object with it\u2019s dimensions. I knew I would run into issues whenever the pong crossed or touched any of the other white objects but I also figured this was fine so long as I could track it the majority of the time. After all, it moves in a straight line. If you watch the video below you will see how the red circle marking the pong flickers. That is because it only finds it about 1 in every 2 frames. At 60 fps this really doesn\u2019t matter.", "At this point we already have a working AI. If we just move the player paddle such that it is at the same y-position as the pong, it does a fairly good job. However, it does run into problems when the pong gets a good bounce going. The paddle is just too slow to keep up and needs to instead predict where the pong will be instead of just moving to where it currently is. This has already been implemented in the clips above but below is a comparison of the two methods.", "The difference isn\u2019t huge but it is definitely a more consistent win with the right AI. To do this I first created a list of the positions for the pong. I kept this list at a length of just 5 for averaging sake, but more or less could be done. Probably don\u2019t want more otherwise it takes longer to figure out it has changed directions. After getting the list of positions I used simple vector averaging to smooth out and obtain the direction vector \u2014 shown by the green arrow. This was also normalized to be a unit vector and then multiplied by a length for visualization purposes.", "Casting the ray is just an extension of this \u2014 making the forward projection longer. I then checked if the future positions were outside the boundary of the top and bottom area. If so, it just projects the position back into the play area. For the left and right sides, it calculates where that intersection will occur with the paddle x-position and fixes the x- and y-position to that point. This makes sure the paddle is targeting to the correct position. Without this it would often move too far. Here is the code for defining the ray that predicts the future position of the pong:", "In the above the perhaps less obvious calculation is determining the intercept of left or right positions for the paddles to target. We do this essentially by similar triangles with the diagram and equation show below. We know the intercept with the x-position of the paddle which is given in boundaries. We can then calculate how far the pong will travel and add that to the current y-position.", "The paddles, although look straight, actually have a rebound surface that is curved. That is, if you hit the ball with the paddle towards the ends it will bounce as if the paddle was angled. I therefore allowed the paddle to hit at the edges which adds some offense to the AI, causing the pong to fly around.", "Although designed for this particular implementation of pong, the same concepts and code could be used for any version \u2014 it just comes down to changing some of the pre-processing steps. Of course, another method is to use machine learning through reinforcement learning or just simple conv net, but I like this classical approach; at least in this instance where I don\u2019t need robust generality or difficult image processing steps. As I mentioned, this version of pong is 2 player, and I honestly cannot beat my own AI\u2026", "If you any part of this post provided some useful information or just a bit of inspiration please follow me for more.", "You can find the source code on my github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Computer Vision and Machine Learning. Applications Development Scientist"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe6d70153fc45&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@robint.white90?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": "Robin T. White, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5eb85d3a614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=post_page-c5eb85d3a614----e6d70153fc45---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6d70153fc45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6d70153fc45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.youtube.com/channel/UC0e3QhIYukixgh5VVpKHH9Q", "anchor_text": "CodeBullet"}, {"url": "https://www.youtube.com/watch?v=tcymhYbRvw8&", "anchor_text": "here"}, {"url": "https://www.ponggame.org/", "anchor_text": "ponggame.org"}, {"url": "https://pypi.org/project/mss/", "anchor_text": "MSS"}, {"url": "http://stackoverflow.com/questions/14489013/simulate-python-keypresses-for-controlling-a-game", "anchor_text": "code"}, {"url": "http://www.gamespp.com/directx/directInputKeyboardScanCodes.html", "anchor_text": "here"}, {"url": "https://unsplash.com/@brett_jordan?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Brett Jordan"}, {"url": "https://unsplash.com/s/photos/done?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/robintwhite", "anchor_text": "github"}, {"url": "https://medium.com/analytics-vidhya/minecraft-mapper-ab4478e98297", "anchor_text": "Minecraft Mapper"}, {"url": "https://medium.com/tag/python?source=post_page-----e6d70153fc45---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e6d70153fc45---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----e6d70153fc45---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/opencv?source=post_page-----e6d70153fc45---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----e6d70153fc45---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6d70153fc45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=-----e6d70153fc45---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6d70153fc45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=-----e6d70153fc45---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6d70153fc45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe6d70153fc45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e6d70153fc45---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e6d70153fc45--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e6d70153fc45--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e6d70153fc45--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e6d70153fc45--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@robint.white90?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Robin T. White, PhD"}, {"url": "https://medium.com/@robint.white90/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5eb85d3a614&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=post_page-c5eb85d3a614--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3f1d8826832f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputer-vision-and-the-ultimate-pong-ai-e6d70153fc45&newsletterV3=c5eb85d3a614&newsletterV3Id=3f1d8826832f&user=Robin+T.+White%2C+PhD&userId=c5eb85d3a614&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}