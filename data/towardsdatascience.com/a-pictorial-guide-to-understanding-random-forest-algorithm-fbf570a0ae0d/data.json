{"url": "https://towardsdatascience.com/a-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d", "time": 1683011920.044806, "path": "towardsdatascience.com/a-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d/", "webpage": {"metadata": {"title": "A pictorial guide to understanding Random Forest Algorithm | by Lars Nielsen | Towards Data Science", "h1": "A pictorial guide to understanding Random Forest Algorithm", "description": "In this article , we will see how the Random Forest algorithm works internally. To truly appreciate it, it might be helpful to understand a bit about Decision-Tree Classifiers. But its not entirely\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In this article , we will see how the Random Forest algorithm works internally. To truly appreciate it, it might be helpful to understand a bit about Decision-Tree Classifiers. But its not entirely required.", "\ud83d\udc49 Note : We are not covering the pre-processing or feature creation steps involved in modelling \u2014 but only see what happens within the algorithm when we call the .fit() and .transform() methods for sklearn\u2019s RandomForestClassifier package does.", "Random Forest ( RF) is a tree based algorithm . It is an ensemble of multiple random trees of different kinds. The final value of the model is the average of all the prediction/estimates created by each individual tree .", "We will be basing our article on sklearn\u2019s RandomForestClassifier module", "For illustration, we will be using a training data similar to the one below.", "\ud83d\udc49 Note :age ,glucose_level, weight, gender, smoking .. \u2026 f98, f99 are all the independent variables or the features.", "Diabetic is the y-variable/dependent variable that we have to predict.", "Predict the patients who are likely to be diabetic.", "With these basic information, lets get started and understand what happens with we pass this training set to the algorithm \u2026", "Once we provide the training data to the RandomForestClassifier model, it (the algorithm) selects a bunch of rows randomly . This process is called Bootstrapping (random replacement). For our example, lets assume that it selects m records.", "\ud83d\udc49 Note 1 : The number of rows to be selected can be provided by the user in the hyper-parameter- (max_samples) like this in your code", "\ud83d\udc49 Note 2 : This only applies if you turn on bootstrapping in your hyper-parameter ( bootstrap = True) . bootstrap is True by default.", "\ud83d\udc49 Note 3: One row might get selected more than once", "Now, RF randomly selects a subset of features / columns . Here for the sake of simplicity and for the example, we are choosing 3 random features.", "Note \ud83d\udc49 You can control this number in your hyper-parameter \u2014 max_features similar to the code below", "Once the 3 random features are selected ( in our example), the algorithm runs a splitting of the m record (from step 1) and does a quick calculation of the before and after values of a metric.", "This metric could be either gini-impurity or the entropy. It is based on the criteria \u2014 gini or entropy you have provided in your hyper-parameter .", "By default, it is set to criteria = 'gini\u2019", "Which ever of the random feature split gives the least combined gini impurity/ entropy value, that feature is selected as the root node .", "The records are split at this node based on the best splitting point.", "The algorithm performs the same process as in Step 2 and Step 4 and selects another set of 3 random features . ( 3 is the number we have specified \u2014 you can choose what you like \u2014 or leave it to the algorithm to choose the best number )", "Based on the criteria ( gini / entropy ), it selects which feature will go into the next node / child node , and further splitting of the records happens here .", "This process continues (Steps 2, 4) of selecting the random feature and splitting of the nodes happens till either of the following conditions happen", "You now have your first \u201cmini-decision tree \u201d.", "Algorithm goes back to your data and does steps 1\u20135 to creates the 2nd \u201cmini-tree\u201d", "Once the default value of 100 trees is reached ( you now have 100 mini decision trees ), the model is said to have completed its fit() process.", "\ud83d\udc49 Note: You can specify the number of trees you want to generate in your hyper-parameter ( n_estimators)", "Now you have a forest of randomly created mini-trees ( hence the name Random Forest )", "Now lets predict the values in an unseen data set ( the test data set )", "For inferencing (more commonly referred to as predicting/scoring ) the test data, the algorithm passes the record through each mini-tree.", "The values from the record traverses through the mini tree based on the variables that each node represents,and reaches a leaf node ultimately. Based on the predetermined value of the leaf-node(during training) where this record ends up, that mini-tree is assigned one prediction output.", "In the same manner, the same record goes through all the 100 mini-decision trees and each of the 100 trees have a prediction output for that record.", "The final prediction value for this record is calculated by taking a simple voting of these 100 mini trees.", "Now we have the prediction for a single record.", "The algorithm iterates through all the records of the test set following the same process and does a calculation of the overall accuracy !", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Making ML and AI available to everyone. One commit at a time. | Quantitative programming | Python | Arduino | Comp Vision | pythoslabs@gmail.com / @PythosL"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffbf570a0ae0d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://pythoslabs.medium.com/?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": ""}, {"url": "https://pythoslabs.medium.com/?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": "Lars Nielsen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6da3ddbb7e05&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&user=Lars+Nielsen&userId=6da3ddbb7e05&source=post_page-6da3ddbb7e05----fbf570a0ae0d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbf570a0ae0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbf570a0ae0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html", "anchor_text": "documentation for RandomForestClassifier"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html"}, {"url": "https://medium.com/tag/random-forest-classifiers?source=post_page-----fbf570a0ae0d---------------random_forest_classifiers-----------------", "anchor_text": "Random Forest Classifiers"}, {"url": "https://medium.com/tag/sklearn?source=post_page-----fbf570a0ae0d---------------sklearn-----------------", "anchor_text": "Sklearn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fbf570a0ae0d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----fbf570a0ae0d---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/python?source=post_page-----fbf570a0ae0d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffbf570a0ae0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&user=Lars+Nielsen&userId=6da3ddbb7e05&source=-----fbf570a0ae0d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffbf570a0ae0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&user=Lars+Nielsen&userId=6da3ddbb7e05&source=-----fbf570a0ae0d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffbf570a0ae0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffbf570a0ae0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fbf570a0ae0d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fbf570a0ae0d--------------------------------", "anchor_text": ""}, {"url": "https://pythoslabs.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://pythoslabs.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lars Nielsen"}, {"url": "https://pythoslabs.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6da3ddbb7e05&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&user=Lars+Nielsen&userId=6da3ddbb7e05&source=post_page-6da3ddbb7e05--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe04c8c1ef754&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-pictorial-guide-to-understanding-random-forest-algorithm-fbf570a0ae0d&newsletterV3=6da3ddbb7e05&newsletterV3Id=e04c8c1ef754&user=Lars+Nielsen&userId=6da3ddbb7e05&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}