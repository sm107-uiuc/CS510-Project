{"url": "https://towardsdatascience.com/introduction-to-sequence-alignments-with-biopython-f3b6375095db", "time": 1683009681.691391, "path": "towardsdatascience.com/introduction-to-sequence-alignments-with-biopython-f3b6375095db/", "webpage": {"metadata": {"title": "Introduction to Sequence Alignments with Biopython | by Wyatt Sharber, PhD | Towards Data Science", "h1": "Introduction to Sequence Alignments with Biopython", "description": "Last week I started playing around with some bioinformatics tools in Python with the library Biopython. In my previous post, I introduced the field of bioinformatics and provided an example of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@wvsharber/introduction-to-genbank-and-bioinformatics-with-python-8a25a0f15e3f", "anchor_text": "In my previous post", "paragraph_index": 0}, {"url": "http://www.drive5.com/muscle", "anchor_text": "download MUSCLE here", "paragraph_index": 8}, {"url": "https://www.ncbi.nlm.nih.gov/projects/msaviewer/", "anchor_text": "NCBI\u2019s Multiple Sequence Alignment Viewer", "paragraph_index": 10}], "all_paragraphs": ["Last week I started playing around with some bioinformatics tools in Python with the library Biopython. In my previous post, I introduced the field of bioinformatics and provided an example of downloading data from GenBank with Biopython\u2019s API interface. Today, I want to move to a typical next step for analyzing DNA sequence data \u2014 the alignment process. I\u2019ll give an introduction to sequence alignments, and then give a brief example of using Biopython to filter some data and run alignment software.", "When working with biological sequence data, either DNA, RNA, or protein, biologists often want to be able to compare one sequence to another in order to make some inferences about the function or evolution of the sequences. Just like you wouldn\u2019t want to use data from data tables where data was in the wrong column for analyses, in order to make robust inferences from sequence data, we need to make sure our sequence data is well organized or \u201caligned.\u201d Unfortunately, sequence data does not come with nice labels, like a date, miles per gallon, or horsepower. Instead, all we have is the position number in the sequence, and that is relative to that sequence only. Luckily, many sequences are highly conserved or similar between related organisms (and all organisms are related to some degree!). If we\u2019re fairly certain that we\u2019ve obtained data from the same sequence from multiple organisms, we can put that data into a matrix that we call an alignment. If you\u2019re only comparing two sequences, it\u2019s called a pairwise alignment. If you\u2019re comparing three or more sequences, it\u2019s called a multiple sequence alignment (MSA).", "Using the positions and the identity of each molecule in the sequence, we can infer the relative placement of each molecule in the matrix. Sometimes there will be differences in the sequence, for example, in a position where most sequences are C, we find a sequence with a G. This is referred to as a single nucleotide polymorphism (SNP). In other times, we find that a sequence is missing a molecule that is present in the rest, or a sequence has an extra molecule. The former is a deletion, while the latter is an insertion, together referred to as \u201cindels.\u201d When aligning sequences with indels, we must account for these extra or missing molecules by adding gaps to the remaining sequences. These small differences are usually the interesting parts of sequence data because the variation is how we can make inferences on the function or evolution of the sequence. Below are a couple of examples of MSAs with SNPS and indels.", "In the two examples above, the sequence length is short, the number of sequences is small, and the similarity between sequences is high. Therefore, it\u2019s really easy to visually align the sequences. However, if you had hundreds of sequences with thousands or tens of thousands of positions to align, you probably wouldn\u2019t want to align it all by hand! Instead, there are programs that use algorithms to align sequences.", "Alignments are quite interesting problems for algorithms. First, you want to minimize the differences between sequences by aligning them. For regions of the sequences that are different, the algorithm has two options: (1) add a gap to the alignment that says \u201cthis area is unique to this sequence and there is nothing like it in the other sequence,\u201d or (2) align dissimilar sequences together, essentially saying \u201cthese are different here, but the surrounding sequence is similar enough to keep the positional structure the same.\u201d If the algorithm\u2019s only objective is to minimize difference, it would just keep adding gaps! Instead, most alignment algorithms have a secondary objective of minimizing the number of gaps as well, and gaps are given a penalty score when they are introduced. With two optimizations to perform across many sequences and many positions within a sequence, the computational time and memory requirements for these programs can be enormous. I\u2019ve waited hours or even days for alignments to finish running!", "Although aligning sequences is time consuming, the result is critically important in genetic and evolutionary studies. Similarities and differences between sequences can tell you about the evolutionary relationship of one organism to another, or the function of one gene compared to another. You can\u2019t make these kinds of inferences without establishing the relationship between sequences. I\u2019ve glossed over some of the finer details and assumptions that go into this process, but, in their essence, alignments are the data frames of the molecular biology world.", "In my previous post, I downloaded sequence data from GenBank from samples of the SARS-CoV-2 virus (aka, COVID-19). I would like to compare these sequences to each other to do some evolutionary analyses, but that first requires an alignment! So, continuing where I left off, I\u2019m going to use Biopython to use the multiple sequence alignment software, MUSCLE, to create my MSA.", "Biopython, the Python library for bioinformatics, has several tools for manipulating and building sequence alignments. The Bio.AlignIO and the Bio.Align modules contain these tools. You can read and write alignment files, convert their types, and use the alignment software interface to create an alignment. Because alignment software is fairly slow, creating Python implementations of that software is not very efficient. Instead, Biopython just uses wrappers that execute the software written in other, faster languages. It\u2019s basically the same as running those software from command line, but Biopython gives you the opportunity to build a workflow entirely within Python. Biopython provides wrappers for nine commonly used alignment softwares (at the time of this article), which you can view by running the following line: import Bio.Align.Applications; dir(Bio.Align.Applications).", "Using the wrappers is very similar to using them in the command line. You instantiate an object with all of your parameter settings for the alignment, and then execute the object. Below, I show how I filtered my SARS-CoV-2 data to only full length sequences, and then use MUSCLE to align the sequences. (Note: You need to have MUSCLE installed first before this will work. You can download MUSCLE here. It will be helpful to rename the executable file to just \u2018muscle.\u2019 Then, you should make sure that muscle is in your $PATH, i.e., in the usr/local/bin directory. Just copy and paste your downloaded and renamed copy into that directory.)", "As I mentioned earlier, running the alignment takes quite a while. There are some services available online that will run your alignments faster than you can on your local machine. These may be useful if you\u2019re short on time. Additionally, it looks like there are some emerging technologies for parallelizing this process that take advantage of systems like Hadoop and Spark, but I want to look into these further before I recommend one.", "After the alignment is done, you can visually inspect it with one of many alignment viewers. Unfortunately, this is not a process easily done from the command line, so Biopython doesn\u2019t try to give you that ability. Yes, you could read in the alignment with the Bio.AlignIO module and scroll through it iteratively by slicing, but that wouldn\u2019t be very efficient. Here\u2019s an example view of an alignment that I opened with NCBI\u2019s Multiple Sequence Alignment Viewer, a browser-based option.", "This is where I\u2019m gonna stop for this week\u2019s post on alignments. Next week, I\u2019ll continue analyzing the SARS-CoV-2 data by utilizing the alignment created here. As usual, please let me know if you have questions or comments! Thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist and plant evolutionary biologist. Seattle, WA, USA."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff3b6375095db&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f3b6375095db--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f3b6375095db--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wvsharber?source=post_page-----f3b6375095db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wvsharber?source=post_page-----f3b6375095db--------------------------------", "anchor_text": "Wyatt Sharber, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff5f584e78ef8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=post_page-f5f584e78ef8----f3b6375095db---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff3b6375095db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff3b6375095db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@wvsharber/introduction-to-genbank-and-bioinformatics-with-python-8a25a0f15e3f", "anchor_text": "In my previous post"}, {"url": "http://www.drive5.com/muscle", "anchor_text": "download MUSCLE here"}, {"url": "https://www.ncbi.nlm.nih.gov/projects/msaviewer/", "anchor_text": "NCBI\u2019s Multiple Sequence Alignment Viewer"}, {"url": "https://medium.com/tag/bioinformatics?source=post_page-----f3b6375095db---------------bioinformatics-----------------", "anchor_text": "Bioinformatics"}, {"url": "https://medium.com/tag/python?source=post_page-----f3b6375095db---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/biopython?source=post_page-----f3b6375095db---------------biopython-----------------", "anchor_text": "Biopython"}, {"url": "https://medium.com/tag/dna?source=post_page-----f3b6375095db---------------dna-----------------", "anchor_text": "Dna"}, {"url": "https://medium.com/tag/sequence-alignment?source=post_page-----f3b6375095db---------------sequence_alignment-----------------", "anchor_text": "Sequence Alignment"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff3b6375095db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=-----f3b6375095db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff3b6375095db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=-----f3b6375095db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff3b6375095db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f3b6375095db--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff3b6375095db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f3b6375095db---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f3b6375095db--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f3b6375095db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f3b6375095db--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f3b6375095db--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f3b6375095db--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f3b6375095db--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f3b6375095db--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f3b6375095db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wvsharber?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wvsharber?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wyatt Sharber, PhD"}, {"url": "https://medium.com/@wvsharber/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff5f584e78ef8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=post_page-f5f584e78ef8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F710da34dfc22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-sequence-alignments-with-biopython-f3b6375095db&newsletterV3=f5f584e78ef8&newsletterV3Id=710da34dfc22&user=Wyatt+Sharber%2C+PhD&userId=f5f584e78ef8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}