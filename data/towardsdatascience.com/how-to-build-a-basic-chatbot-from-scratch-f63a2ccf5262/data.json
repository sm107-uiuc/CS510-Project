{"url": "https://towardsdatascience.com/how-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262", "time": 1683012765.9743428, "path": "towardsdatascience.com/how-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262/", "webpage": {"metadata": {"title": "How To Build a Basic Chatbot from Scratch | by Pratheesh Shivaprasad | Towards Data Science", "h1": "How To Build a Basic Chatbot from Scratch", "description": "Be it a Whatsapp chat, Telegram group, Slack channel, or any product website, I\u2019m sure you have encountered one of these bots popping out of nowhere. You ask some questions and it will try it\u2019s best\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.anaconda.com/anaconda/install/windows/", "anchor_text": "See here", "paragraph_index": 16}, {"url": "https://machinelearningmastery.com/gentle-introduction-bag-words-model/", "anchor_text": "Bag of Words", "paragraph_index": 25}, {"url": "https://towardsdatascience.com/stemming-vs-lemmatization-8b30c1d3795a", "anchor_text": "here", "paragraph_index": 28}, {"url": "https://github.com/iampratheesh/Restaurant-Chatbot", "anchor_text": "link", "paragraph_index": 40}, {"url": "http://linkedin.com/in/pratheesh-s", "anchor_text": "linkedin.com/in/pratheesh-s", "paragraph_index": 52}], "all_paragraphs": ["Be it a Whatsapp chat, Telegram group, Slack channel, or any product website, I\u2019m sure you have encountered one of these bots popping out of nowhere. You ask some questions and it will try it\u2019s best to resolve your queries. Today we\u2019ll try to build a chatbot that could respond to some basic queries and respond in real-time.", "Let us just assume that we\u2019ll be building a chatbot for a restaurant. Our client has certain requirements for the chatbot.", "The bot should be able to:", "In the end, our chatbot will look like this:", "If you have a basic understanding of Natural Language Processing (NLP), Fully Connected layers in Deep Learning, and Flask framework, this project will be a breeze for you. Even if you aren\u2019t familiar with these terms I\u2019ll try my best to explain everything in simple language and link helpful resources wherever possible.", "With that being said, let's start building our chatbot.", "Now it\u2019s time to see what kind of data we\u2019re dealing with here. The data required for building a chatbot is a little different than the conventional datasets we tend to see. Every intelligent machine needs data that it can see and interpret. We won\u2019t be downloading any particular dataset for this project. We already have a small set of data. Let\u2019s have a look at it.", "This is an example of how our data looks like. It is a JSON format file that is normally used to store and transmit data. The three important terms to be noted here are \u201ctag\u201d, \u201cpatterns\u201d and \u201cresponses\u201d.", "Whatever queries a user enters for the chatbot to interpret must be included in \u201cpatterns\u201d.", "After interpreting the user\u2019s query, the chatbot will have to reply to the query and this reply will be randomly selected from the set of predefined replies in \u201cresponses\u201d.", "The \u201ctag\u201d groups a set of similar patterns and responses to a specific category so that it\u2019ll be easier for the model to predict which category a particular pattern represents.", "You can now copy the data given below into a file. I have named my file \u201cintents.json\u201d.", "As you can see the data provided here meets all of the requirements given by our client. I have intentionally set the responses of the tags \u201cmenu\u201d, \u201cbook_table\u201d and \u201cavailable_tables\u201d as an empty list. I\u2019ll explain the reason later in our project.", "With this data, we can now train our own neural network and it will predict and try to classify it into one of the tags from the file. Once the tag is known, a random response will be selected from that tag and shown to the user. You can add any other tags you wish to this data. Just make sure that the syntax isn\u2019t wrong. The more tags, patterns, and responses you provide, the more robust the chatbot will be.", "Now that you're familiar with the data let\u2019s load it onto the kernel using Python. The version that I\u2019m using is Python 3.6.", "Before starting with any code, it\u2019s recommended to set up a virtual environment so that any libraries we\u2019ll be installing won't clash with existing ones or cause any redundancy issues.", "I\u2019ll be creating a virtual environment using conda. (See here on how to install Anaconda.)", "Open your command prompt and enter the command.", "Here \u201csimple_chatbot\u201d is the name of the virtual environment. You can give it any name you like.", "To activate this virtual environment, just enter:", "Once activated, the name of your environment should show up on the left something like this:", "We\u2019ll be using pip to install the following libraries:", "I have also added the version of the libraries just to be safe.", "Now that we\u2019re prepped up, let's dive into the code.", "Now we\u2019ll be importing some libraries needed to load, process, and transform our data and then feed it into a deep learning network. Just remember to keep your JSON file in the same directory as your python file. I\u2019ll be naming my file \u201cmain.py\u201d.", "Now, we have to take the \u201ctag\u201d and \u201cpatterns\u201d out of the file and store it in a list. We\u2019ll also make a collection of unique words in the patterns to create a Bag of Words (BoW) vector.", "In the code above, we have created four empty lists.", "As we loop through the data, we convert all patterns into lower case, tokenize each pattern and then add them to the respective lists. We also add the pattern\u2019s tag into docs_y simultaneously.", "Now that we\u2019ve got the words in a list, it\u2019s time to perform stemming on them. Stemming is basically trying to find the root origin of a word. It removes all the prefixes and suffixes of a word so that the model that we\u2019re building will get a general idea of that word instead of getting trapped in all the intricacies of the same word with different forms. There are different types of stemmers like Porter Stemmer, Snowball Stemmer, Lancaster Stemmer, etc. We\u2019ll be using Lancaster Stemmer in our code. (Learn more about Stemmers here.)", "It\u2019s known that Machine Learning and Deep Learning models only accept numerical inputs. So we have to convert this stemmed list of words into some kind of numerical input so that we can feed it to the neural network. This is where vectorization methods like Bag of Words, TF-IDF, Word2vec, and others come into the picture.", "We\u2019ll be using Bag of Words (BoW) in our code. It basically describes the occurrence of a word within a document. In our case, we\u2019ll be representing each sentence with a list of the length of all unique words collected in the list \u201cwords\u201d. Each position in that list will be a unique word from \u201cwords\u201d. If a sentence consists of a specific word, their position will be marked as 1 and if a word is not present in that position, it\u2019ll be marked as 0.", "With this method though, the model can only understand the occurrence of a word in the sentence. The sequence of the words within the sentence will be lost, hence the name \u201cBag of Words\u201d. Other methods like TF-IDF, Word2Vec tries to capture some of these lost semantics in their own way. I\u2019d recommend you to try out other vectorization methods as well.", "Similarly, for the output, we\u2019ll create a list which will be the length of the labels/tags we have in our JSON file. A \u201c1\u201d in any of those positions indicates the belonging of a pattern in that particular label/tag.", "We will be also saving all the processed data in a pickle file so that it can be used later for processing inputs from the user as well.", "Now that we\u2019re done with data preprocessing, it\u2019s time to build a model and feed our preprocessed data to it. The network architecture is not too complicated. We will be using Fully Connected Layers (FC layers) with two of them being hidden layers and one giving out the target probabilities. Hence, the last layer will be having a softmax activation.", "Feel free to mess around with the architecture and the numbers to get the model that suits your requirements. You could also choose to add a bit more steps into text preprocessing to get more out of the data. The more trial and error cycles you perform better will be your understanding of the architecture.", "All we have to do now is feed the data to this model and begin training. We will set our epochs to 200 and batch size to 8. Again, you can experiment with these numbers and find the right one for your data. After training, we will be saving it on the disk so that we can use the trained model in our Flask application.", "If everything goes right, you should have files named \u201cmodel.tflearn.data\u201d, \u201cmodel.tflearn.index\u201d, and \u201cmodel.tflearn.meta\u201d in the working directory.", "Your \u201cmain.py\u201d file should look something like this:", "Now that we\u2019ve trained our deep learning model, it\u2019s time to integrate it into a web application. The framework we will be using here is Flask. Now explaining how to build a Flask application requires a series of articles on its own so I won\u2019t be doing that here. However, I\u2019ll make sure to include all the resources I referred to while building this application in the \u201cReferences\u201d section down below.", "Here\u2019s a link to my GitHub repository where you can access all the files to build the Flask application. I\u2019d recommend you to copy all the files into your working directory so that it can access the trained model and pickle files.", "We will be using AJAX for asynchronous transfer of data i.e you won\u2019t have to reload your webpage every time you send an input to the model. The web application will respond to your inputs seamlessly. Let\u2019s take a look at the HTML file.", "Have a look at the JavaScript section where we get the input from the user, sends it to the \u201capp.py\u201d file where it\u2019s fed to the trained model and then receives the output back to display it on the app.", "The \u201capp.py\u201d file is where all the routes are mentioned, input data is processed (Stemming and Bag of Words), and fed to the model for output. Let\u2019s have a look at it.", "We first import all the required libraries and then load the pickle file in which we saved the preprocessed data. This will be required to create a BoW vector for the input data. Then we define a function \u201cbag_of_words\u201d where we provide user input and get a BoW vector as an output.", "Remember the tags \u201cmenu\u201d, \u201cbook_table\u201d and \u201cavailable_tables\u201d with empty responses? We did that so we could provide custom responses to questions in those tags.", "For the questions related to what\u2019s on the menu, we would first check what day of the week it is and according to that, the chatbot will recommend special dishes for the day.", "When the user asks to book a table, we decrement the counter \u201cseat_count\u201d by one. Now, of course, this isn\u2019t how bookings work but the whole point of demonstrating this was to show the possibilities we can have with this chatbot. You could connect this bot to a database and conduct bookings accordingly. Or you could add any other additional tasks according to your requirements. Asking for available tables just shows the current value of \u201cseat_count\u201d. Whenever you reset the Flask server, the counter goes back to 50. This was done to show that you don\u2019t have to always depend on the JSON file for a response.", "Once the setup is complete, just run the \u201capp.py\u201d file and the Flask server will be live. It should look something like this:", "The project is finally done and working like it\u2019s supposed to. However, there are tons of stuff you can tweak and fine-tune in here. I\u2019d love to hear what additional features you were able to add to this chatbot or any other modifications you have made to this project. You can go ahead and connect this chatbot to a database or integrate it with any website. Instead of using Bag of Words, you could also use other vectorization methods like TF-IDF, Word2Vec, etc. There is a high chance that these methods will improve the model\u2019s accuracy in predicting the tags.", "As promised I have also listed all the blogs and videos I referred to while building this application. It\u2019ll definitely help you get a deeper understanding of the project and its working.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Python Developer. Machine Learning and Deep Learning Enthusiast. LinkedIn: linkedin.com/in/pratheesh-s"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff63a2ccf5262&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Pratheesh_S?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": "Pratheesh Shivaprasad"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd04fc11ce21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=post_page-d04fc11ce21----f63a2ccf5262---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff63a2ccf5262&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff63a2ccf5262&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://docs.anaconda.com/anaconda/install/windows/", "anchor_text": "See here"}, {"url": "https://machinelearningmastery.com/gentle-introduction-bag-words-model/", "anchor_text": "Bag of Words"}, {"url": "https://towardsdatascience.com/stemming-vs-lemmatization-8b30c1d3795a", "anchor_text": "here"}, {"url": "https://github.com/iampratheesh/Restaurant-Chatbot", "anchor_text": "link"}, {"url": "https://chatbotsmagazine.com/contextual-chat-bots-with-tensorflow-4391749d0077", "anchor_text": "Contextual Chatbots with Tensorflow"}, {"url": "http://youtube.com/playlist?list=PL-osiE80TeTs4UjLw5MM6OjgkjFeUxCYH", "anchor_text": "Flask Tutorials"}, {"url": "https://www.youtube.com/user/schafer5", "anchor_text": "Corey Schafer"}, {"url": "https://codinginfinite.com/chatbot-in-python-flask-tutorial/", "anchor_text": "Building a Chatbot in Python Using Flask"}, {"url": "https://www.youtube.com/watch?v=IZWtHsM3Y5A", "anchor_text": "Submit AJAX Forms with jQuery and Flask"}, {"url": "https://medium.com/tag/chatbots?source=post_page-----f63a2ccf5262---------------chatbots-----------------", "anchor_text": "Chatbots"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f63a2ccf5262---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/flask-framework?source=post_page-----f63a2ccf5262---------------flask_framework-----------------", "anchor_text": "Flask Framework"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f63a2ccf5262---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----f63a2ccf5262---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff63a2ccf5262&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=-----f63a2ccf5262---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff63a2ccf5262&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=-----f63a2ccf5262---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff63a2ccf5262&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff63a2ccf5262&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f63a2ccf5262---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f63a2ccf5262--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Pratheesh_S?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Pratheesh Shivaprasad"}, {"url": "https://medium.com/@Pratheesh_S/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "87 Followers"}, {"url": "http://linkedin.com/in/pratheesh-s", "anchor_text": "linkedin.com/in/pratheesh-s"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd04fc11ce21&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=post_page-d04fc11ce21--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6d65ea666fc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-basic-chatbot-from-scratch-f63a2ccf5262&newsletterV3=d04fc11ce21&newsletterV3Id=6d65ea666fc8&user=Pratheesh+Shivaprasad&userId=d04fc11ce21&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}