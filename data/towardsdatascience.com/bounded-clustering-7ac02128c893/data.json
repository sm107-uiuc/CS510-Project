{"url": "https://towardsdatascience.com/bounded-clustering-7ac02128c893", "time": 1683001545.375055, "path": "towardsdatascience.com/bounded-clustering-7ac02128c893/", "webpage": {"metadata": {"title": "Bounded Clustering. A clustering algorithm for bounded\u2026 | by Dalya Gartzman | Towards Data Science", "h1": "Bounded Clustering", "description": "A clustering algorithm for bounded sized clusters."}, "outgoing_paragraph_urls": [{"url": "https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/BoundedClustering", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Knapsack_problem", "anchor_text": "Knapsack", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-Means Clustering", "paragraph_index": 7}, {"url": "https://core.ac.uk/download/pdf/61217069.pdf", "anchor_text": "this paper", "paragraph_index": 7}, {"url": "https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/BoundedClustering", "anchor_text": "here", "paragraph_index": 11}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "default according to", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Elbow_method_(clustering)", "anchor_text": "Elbow Method", "paragraph_index": 15}, {"url": "https://medium.com/hackernoon/yats-yet-another-tsp-solution-6a71aeabe1f8", "anchor_text": "similar geometric problems", "paragraph_index": 21}, {"url": "https://www.linkedin.com/in/orian-sharoni/", "anchor_text": "Orian Sharoni", "paragraph_index": 22}], "all_paragraphs": ["Imagine the very realistic scenario, in which several families from your town are planning to go on a trip together.", "To save on transportation costs, they wish to charter several minibuses. The fewer the better, of course. To make the transport arrangements efficient and pleasant, they wish for each family to stick together on the same minibus, and partition the families according to geographic locations, to avoid redundant detours.", "To put it mathematically, we have n families, where for each family f the number of family members is s(f), and the number of seats in each minivan is m . A valid partition of the n families in to k minibuses is one where in each minibus the total number of family members does not exceed the minibus`s capacity. A good partition is one where the distance covered by each minivan in minimized. A great partition, is one that optimizes the tradeoff between the minimization of number of minibuses, and minimization of distance covered by each minibus.", "This post contains pseudo code. For the real code you can go here.", "Indeed. The case with one minibus can be easily reduced to Knapsack, making the problem at hand computationally NP-Hard (more precisely, NP-Complete, but who's counting). Therefore, clearly we are not looking for an exact solution, if we want to solve this at scale.", "Let\u2019s break it down into two steps:", "Step (1) will build for us good partitions, whereas step (2) will help us find a great partition.", "As the title suggests, to find a partition for a given k, we will use a variation of the famous K-Means Clustering Algorithm, inspired by this paper.", "Similarly to K-Means, we will implement an iterative algorithm, which alternates between finding the centroid of each cluster (update step), and assigning points to the closest centroid (assignment step). In this variation, the assignment step will also make sure that clusters maintain their bounded size.", "Let\u2019s be more precise, and take it from the top. The classic K-Means algorithm goes roughly like this:", "Now, to account for the bounded clusters variation, we will modify step 2.1, the assignment step, in the following manner:", "You can see the code here.", "One further thing to remember with K-Means, is that the process is prone to instability, and the possibly local minimum in which it will terminate, is highly dependant on the first random guess.Therefore, it is customary to perform several repetitions of the algorithm, and choose the best outcome. The default according to sklearn.cluster.KMeans is 10 repetition, and we will follow suit.", "OK, now that we know how to find a good partition for a fixed number of minibuses, k, how can we find \u201cthe best\u201d k?", "Deciding on the proper tradeoff between minimizing number of minibuses, vs. minimizing distance traveled by each minibus, is not trivial.", "Luckily, some smart people have already thought about it a lot, and the common practice is to use the Elbow Method, which roughly goes like this:", "Let\u2019s see how it looks with our families-going-on-a-roadtrip data:", "Let\u2019s analyze one iteration of our Bounded K-Means clustering. Remember we denote: n number of families, m maximal size of minibus, k number of minibuses.", "If we perform x iterations until convergence in each clustering run, and y runs with different random initial states, we get O(x*y*n*log(n)*k*log(k)).", "Now remember we want to do this for different number of k's. Let\u2019s denote K to be the maximal value we want to try, and z the number different k's , then we get a total of O(x*y*z*n*log(n)*K*log(K)).", "The Elbow Method has a linear complexity in K, which does not change our final outcome \ud83d\ude05.", "My personal story with this problem, is that I really had to solve something similar in my job. My first instinct was to use a greedy local search, which I know works great in similar geometric problems.", "However, I challenged myself to step out of my comfort zone, and asked for advice from some colleagues and peers. Gladly, Orian Sharoni was quick to respond, referring me to the two papers (Bounded K-Means Clustering + Elbow Method) which together wrapped everything up.Took me a few hours more than I thought it would, but the solution I composed was much more elegant, and most likely closer to optimum (haven\u2019t tested it, but my gut tells me so).", "To conclude, as an algorithms developer, especially one working in the high-paced startups scene, it helps to have go-to-methods when I just want to get something done. But then, once in while, it helps even more to explore novel ideas, learn new methods, and expand my mental \u201cgo-to-algorithms\u201d library.", "Hope you enjoyed taking this journey with me, and that you also expanded your mental library today \ud83e\udd13", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7ac02128c893&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7ac02128c893--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7ac02128c893--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dalyag.medium.com/?source=post_page-----7ac02128c893--------------------------------", "anchor_text": ""}, {"url": "https://dalyag.medium.com/?source=post_page-----7ac02128c893--------------------------------", "anchor_text": "Dalya Gartzman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8cb8e88c4f51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&user=Dalya+Gartzman&userId=8cb8e88c4f51&source=post_page-8cb8e88c4f51----7ac02128c893---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ac02128c893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ac02128c893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/BoundedClustering", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Knapsack_problem", "anchor_text": "Knapsack"}, {"url": "https://en.wikipedia.org/wiki/K-means_clustering", "anchor_text": "K-Means Clustering"}, {"url": "https://core.ac.uk/download/pdf/61217069.pdf", "anchor_text": "this paper"}, {"url": "https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/BoundedClustering", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "default according to"}, {"url": "https://en.wikipedia.org/wiki/Elbow_method_(clustering)", "anchor_text": "Elbow Method"}, {"url": "https://medium.com/hackernoon/yats-yet-another-tsp-solution-6a71aeabe1f8", "anchor_text": "similar geometric problems"}, {"url": "https://www.linkedin.com/in/orian-sharoni/", "anchor_text": "Orian Sharoni"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7ac02128c893---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7ac02128c893---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----7ac02128c893---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/transportation?source=post_page-----7ac02128c893---------------transportation-----------------", "anchor_text": "Transportation"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----7ac02128c893---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7ac02128c893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&user=Dalya+Gartzman&userId=8cb8e88c4f51&source=-----7ac02128c893---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7ac02128c893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&user=Dalya+Gartzman&userId=8cb8e88c4f51&source=-----7ac02128c893---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ac02128c893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7ac02128c893--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7ac02128c893&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7ac02128c893---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7ac02128c893--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7ac02128c893--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7ac02128c893--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7ac02128c893--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7ac02128c893--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7ac02128c893--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7ac02128c893--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7ac02128c893--------------------------------", "anchor_text": ""}, {"url": "https://dalyag.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dalyag.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dalya Gartzman"}, {"url": "https://dalyag.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "677 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8cb8e88c4f51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&user=Dalya+Gartzman&userId=8cb8e88c4f51&source=post_page-8cb8e88c4f51--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3fca8ffa74a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbounded-clustering-7ac02128c893&newsletterV3=8cb8e88c4f51&newsletterV3Id=3fca8ffa74a4&user=Dalya+Gartzman&userId=8cb8e88c4f51&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}