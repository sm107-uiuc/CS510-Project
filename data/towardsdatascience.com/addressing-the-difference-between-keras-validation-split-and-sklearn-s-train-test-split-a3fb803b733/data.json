{"url": "https://towardsdatascience.com/addressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733", "time": 1683017552.997052, "path": "towardsdatascience.com/addressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733/", "webpage": {"metadata": {"title": "Addressing the difference between Keras\u2019 validation_split and sklearn\u2019s train_test_split() | by Yousef Nami | Towards Data Science", "h1": "Addressing the difference between Keras\u2019 validation_split and sklearn\u2019s train_test_split()", "description": "I have seen a lot of people reporting that training neural networks with validation_split causes overfitting, and thus many opt to use train_test_split() instead. However, unlike validation_split\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/namiyousef96", "anchor_text": "https://www.linkedin.com/in/namiyousef96", "paragraph_index": 35}], "all_paragraphs": ["I have seen a lot of people reporting that training neural networks with validation_split causes overfitting, and thus many opt to use train_test_split() instead. However, unlike validation_split, train_test_split() does not directly allow the user to \u2018see\u2019 how the network is training, and thus aspiring data scientists tend to solely rely on test accuracy to guide neural network architecture design. This is like shooting in the dark.", "This article will address why many people overfit when using validation_split, and how to prevent it. The key differences between validation_split and train_test_split() will also be discussed. The article will also introduce a method of validating data that combines the advantages of both validation_split and train_test_split() to enable better educated decisions when designing neural networks.", "To illustrate the differences between these two, I will be using a neural network to solve a 3-category classification problem using sklearn\u2019s make_blobs dataset. I\u2019ve added a lot of the noise to the data to make the learning process harder.", "train_test_split() is a method in sklearn that allows users to split their data into training and testing sets.", "What this does, is split the input data, X and y, into 80\u201320 train test splits randomly (the test_size parameter controls the size of the split. Alternatively, one could test train_size!).", "If our data were represented by 100 blue tiles, then after train_test_split(), our data could look like this:", "random_state is a parameter that allows reproducibility. When this is specified, every time the code is run, the data will be split in the same way. If it isn\u2019t specified, then each iteration will be random.", "Then, once training and evaluating the model, one can simply do the following:", "It is thus very clear, due to the disparity between the test accuracy (0.75) and the final training accuracy (~ 0.81 \u2014 see plot) that there is some overfit. This then allows us to modify the model.", "Though this is useful, we hardly know anything about how the model is training\u2026 it could be that we\u2019ve chosen a small batch size, or very high epochs. It could be that our model is performing badly on this one instance. We simply don\u2019t know enough about the nature of the overfitting to make a good enough, educated change to our neural network architecture.", "What we need is to actually see how the test accuracy is changing over time, because that curve will have points that indicate overfit.", "An alternative to using train_test_split() is to specify a validation_split percentage. This allows Keras to handle the train/test splitting of the data entirely on its own.", "This has numerous advantageous when deploying a model, simply because only library required for using the model will be Keras.", "This is done when fitting the model, for example:", "It\u2019s worth noting that unlike train_test_split(), Keras splits the data by order of the index, taking the first 80% of the datapoints (in this case) as training data, and the last 20% as test data. A nice visual is shown below:", "The advantage of doing this is shown by implementing it:", "Since there is now validation data while the model is being trained, it is possible to plot training and test accuracy graphs during training.", "The plot above gives us more insight into how the model is training.", "We see that at epochs ~170, the model starts to lose test accuracy, meaning that we are overfitting. We also notice another thing: the test accuracy is very noisy. This indicates that the batch_size used is too small, or that the optimiser is not well optimised for this problem. This may impact the decisions we make in trying to improve the model.", "However, what is our test accuracy? It would be convenient to get a value, the same way we did when using train_test_split(), using the .evaluate() method.", "This is where a lot of people err. Many do something like this:", "The intention is to both plot the test plots, and to see the final accuracy of the model using the .evaluate method. However, this will naturally lead to overfit, as exhibited by the output accuracy of 0.803, compared to that of the plot, which seems to be closer to 0.78.", "This is because, validation_split and train_test_split() don\u2019t split the data in the same way, and therefore some of the data from X_test is actually being used within .fit, hence the overfit.", "As far as I\u2019m aware, there is no way to ensure that train_test_split() and validation_split split the data in the same way.", "We\u2019ve now seen that using train_test_split() allows you to get an accurate value for the test accuracy, without letting you see the test accuracy curve, whereas validation_split allows you to see your test accuracy curve. Is there a better approach for checking our models before making any changes?", "Note the most important addition: validation_data (see model.fit() in above gist)", "Like validation_split, validation_data enables the test data to be monitored and plotted, however it allows the user to specify what test data to use. In this case, we are not limited by validation_split. Therefore, like I have shown, it\u2019s possible to use train_test_split() before fitting, and then specifying the test portion of that into validation_split for monitoring.", "The above script expands on this idea, and uses KFold validation to check that the model works for different randomised conditions. This is also important, for we can check if our model performs well all the time, or only sometimes. The plots below illustrate this in better detail:", "From the above, we see the importance of a couple of things:", "Now, here is an example of a better model:", "Can you see why the latter model is better?", "In an ideal case, where you have an infinite amount of time, you would repeat the KFold around 30 times to ensure that, even after 30 iterations, you get consistent results.", "If you are new to using Keras, I hope you have found this article helpful in addressing the differences between validation_split, validation_data and train_test_split(). I wish you all the best with your journey in exploring Keras, and building fantastic models and participating in competitions.", "All images produced by author unless specified otherwise.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist and Mechanical Engineer. My philosophy is CL/CD. Connect with me: https://www.linkedin.com/in/namiyousef96"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa3fb803b733&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a3fb803b733--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a3fb803b733--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://namiyousef96.medium.com/?source=post_page-----a3fb803b733--------------------------------", "anchor_text": ""}, {"url": "https://namiyousef96.medium.com/?source=post_page-----a3fb803b733--------------------------------", "anchor_text": "Yousef Nami"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F63d10d93acd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&user=Yousef+Nami&userId=63d10d93acd8&source=post_page-63d10d93acd8----a3fb803b733---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3fb803b733&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3fb803b733&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/JKUTrJ4vK00", "anchor_text": "https://unsplash.com/photos/JKUTrJ4vK00"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----a3fb803b733---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a3fb803b733---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/keras?source=post_page-----a3fb803b733---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/overfitting?source=post_page-----a3fb803b733---------------overfitting-----------------", "anchor_text": "Overfitting"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a3fb803b733---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa3fb803b733&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&user=Yousef+Nami&userId=63d10d93acd8&source=-----a3fb803b733---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa3fb803b733&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&user=Yousef+Nami&userId=63d10d93acd8&source=-----a3fb803b733---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa3fb803b733&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a3fb803b733--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa3fb803b733&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a3fb803b733---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a3fb803b733--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a3fb803b733--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a3fb803b733--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a3fb803b733--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a3fb803b733--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a3fb803b733--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a3fb803b733--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a3fb803b733--------------------------------", "anchor_text": ""}, {"url": "https://namiyousef96.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://namiyousef96.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yousef Nami"}, {"url": "https://namiyousef96.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "238 Followers"}, {"url": "https://www.linkedin.com/in/namiyousef96", "anchor_text": "https://www.linkedin.com/in/namiyousef96"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F63d10d93acd8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&user=Yousef+Nami&userId=63d10d93acd8&source=post_page-63d10d93acd8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F82829698a069&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faddressing-the-difference-between-keras-validation-split-and-sklearn-s-train-test-split-a3fb803b733&newsletterV3=63d10d93acd8&newsletterV3Id=82829698a069&user=Yousef+Nami&userId=63d10d93acd8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}