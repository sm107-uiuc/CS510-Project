{"url": "https://towardsdatascience.com/boost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50", "time": 1682993301.9637172, "path": "towardsdatascience.com/boost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50/", "webpage": {"metadata": {"title": "Boost Your Machine Learning with Amazon EC2, Keras, and GPU Acceleration | by Jonathan Balaban | Towards Data Science", "h1": "Boost Your Machine Learning with Amazon EC2, Keras, and GPU Acceleration", "description": "Deep learning neural networks \u2014 with more than one hidden layer \u2014 require a dumptruck load of data to become effective predictive engines. These models require powerful computing nodes and big RAM\u2026"}, "outgoing_paragraph_urls": [{"url": "https://aws.amazon.com", "anchor_text": "Amazon Web Services (AWS)", "paragraph_index": 1}, {"url": "https://medium.com/@ultimatist/deep-learning-tips-and-tricks-1ef708ec5f53", "anchor_text": "this accompanying piece", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Bash_(Unix_shell)", "anchor_text": "bash", "paragraph_index": 5}, {"url": "https://aws.amazon.com", "anchor_text": "AWS account", "paragraph_index": 6}, {"url": "https://www.docker.com/what-docker", "anchor_text": "Docker container", "paragraph_index": 10}, {"url": "https://aws.amazon.com/ec2/instance-types/p2/", "anchor_text": "P2 instances", "paragraph_index": 21}, {"url": "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html", "anchor_text": "sharing this instance with others", "paragraph_index": 28}, {"url": "https://www.engadget.com/2017/03/02/amazon-admits-that-a-typo-took-the-internet-down-this-week/", "anchor_text": "the internet could shut down again!", "paragraph_index": 33}, {"url": "https://en.wikipedia.org/wiki/Bash_(Unix_shell)", "anchor_text": "bash", "paragraph_index": 36}, {"url": "https://conda.io/docs/user-guide/tasks/manage-environments.html", "anchor_text": "Conda envs", "paragraph_index": 40}, {"url": "https://docs.aws.amazon.com/dlami/latest/devguide/setup-jupyter-configure-client-mac.html", "anchor_text": "per this AWS guide", "paragraph_index": 44}, {"url": "https://twitter.com/ultimetis", "anchor_text": "Twitter", "paragraph_index": 47}, {"url": "https://www.linkedin.com/in/jbalaban/", "anchor_text": "LinkedIn", "paragraph_index": 47}], "all_paragraphs": ["Deep learning neural networks \u2014 with more than one hidden layer \u2014 require a dumptruck load of data to become effective predictive engines. These models require powerful computing nodes and big RAM stores, and loads of data need ample storage and caching capabilities.", "With the price and ease of use that cloud solutions like Amazon Web Services (AWS) bestow, it doesn\u2019t make sense to drop the heavy burden of training on your precious laptop!", "Plus, free up your local machine to browse Twitter or watch data science tutorials while your model converges remotely!", "I\u2019ve also published this accompanying piece about best practices in Keras, for when the environment is set and are ready to train models.", "Disclaimer: certain instances, like the ones we\u2019re setting up in this post, may take up to 24 hours to be approved by the AWS team. If you need a working instance right away, lower performance options are available on demand.", "Note: Throughout the intro, I\u2019ll emphasize buttons to click in bold. Also, I\u2019m on a Mac running High Sierra, so your bash commands will be different on a Windows or Linux machine.", "First, treat yourself to an AWS account. Don\u2019t worry if you\u2019re asked for a payment method; we can configure free or paid versions later on and AWS has great budgeting tools to help you estimate instance cost over time.", "Then, navigate in the top menu bar to Services:Compute:EC2:", "Click Launch Instance. It\u2019s the big blue button!", "You\u2019ll then see the AMI browser window. Click Community AMIs tab on the left, and search for \u2018Keras\u2019:", "At this point, you\u2019ll choose an AMI with Keras, dependencies, and supporting modules built-in. You can set up your environment from scratch \u2014 and if you had very specific needs, I\u2019d recommend building a Docker container\u2014but that\u2019s reinventing the wheel with so many options on the AMI marketplace.", "I used the Deep Learning AMI (Ubuntu) Version 6.0 \u2014 ami-bc09d9c1. However, things will likely work the same for future versions. Use whatever the latest version is; as of 16 May 2018, that\u2019s Ubuntu v9.0.", "Hit Select and you\u2019ll be taken to the Instance Type matrix, a breakdown of all the hardware options you have at your disposal.", "You\u2019ll notice the free tier provides only one core/node/CPU and 1GB of memory. It\u2019s possible to set up the environment for this tutorial with a t2.micro instance, but you can\u2019t build serious models. So, look for something more robust for real modeling; click the orange Amazon EC2 details page link in the popups to get an idea of what price per hour looks like.", "You\u2019ll notice that hovering over the Family links gives a breakdown of what that particular instance family is designed for. Here\u2019s Compute optimized:", "Compute optimized instances have a higher ratio of vCPUs to memory than other families, and the lowest cost per vCPU among all Amazon EC2 instance types. We recommend compute optimized instances for running CPU-bound scale out applications. Examples of such applications include high traffic front end fleets, on-demand batch processing, distributed analytics, web servers, batch processing, and high performance science and engineering applications.", "That sounds great, but there are no GPUs on these instances. So, if you want GPU acceleration, turn to the g2 or g3 families:", "GPU graphics instances provide GPUs along with high CPU performance, large memory and high network speed for applications requiring high-performance graphics acceleration, such as 3D visualizations, graphics-intensive remote workstation, 3D rendering, video encoding, and virtual reality.", "Or even better, the p-series (GPU compute) family, which Amazon built for deep learning platforms:", "GPU compute instances provide general-purpose GPUs along with high CPU performance, large memory and high network speed for applications requiring massive floating point processing power, such as machine learning, high performance databases, computational fluid dynamics, computational finance, seismic analysis, molecular modeling, genomics, and rendering.", "To find the p-class instances, filter by: GPU compute.", "For prices, consult the AWS sales documents, like this one for P2 instances:", "How do I select a type for actual modeling? Things like RAM, storage, and bandwidth are black and white. You either can store/handle the data, or you can\u2019t. With CPU and GPU, you\u2019re deciding between paying less and training slower, or faster for more.", "Sometimes you pay more by being too cheap; the model will cost less per hour, but take more hours to fit!", "We will choose the p2.xlarge instance type for this tutorial. Hit Next: Configure Instance Details. On the Step 3 page, defaults are perfect so hit Next: Add Storage:", "Note on this page that free tier users can bump up to 30GB, per the note. However, if you\u2019re using higher tiers like we are below, keep the value specified, or you can bump up with potential additional storage costs.", "Hit Next: two more times until we get to 6. Configure Security Group. Here we open up ports to talk to our remote Jupyter notebook. Use Add Rule to create a Custom TCP Rule on port range 8888:", "Note that I usually select \u201cMy IP\u201d under Source. If you select \u201cAnywhere\u201d \u2014 as the note in yellow warns \u2014 anyone with your instance\u2019s public IP can run and modify code and files in your instance. Also note that if you switch up your work routine and go to a caf\u00e9, your IP has changed and you must log into AWS and update your rules before you can SSH in.", "I\u2019ll download a new key, called keras.pem, a file I have in my hidden .ssh directory on my Mac. Set up a key if you don\u2019t already have one from previous instances. Or, if you\u2019re sharing this instance with others, make a new key!", "If you see the below screen, go to the provided link and submit a request form so Amazon will let you rent their services!", "Actually, it\u2019s more complicated. Here\u2019s the response I received from my AWS contact:", "These limits cannot be managed by the end-user. The limits are reviewed on a case by case basis to ensure infrastructure safety and availability.", "I\u2019m currently working on your p2.xlarge Instances limit increase request for 2 in the US East (Northern Virginia) region. In this particular case, as mentioned above, I have to collaborate with my Service Team to get approval. Please note that it can take up to 24 hours for the service team to process this request.", "So, Amazon is doing well by closely monitoring and managing demand across their infrastructure. Otherwise, the internet could shut down again!", "Alternatively, different locations/regions have different limits. You should normally select the closest region that offers what you need, but with latency being so low anywhere in the world, we can work around limits by potentially selecting a region with more supply.", "Okay, we should be up and running! Next, we will connect to our instance from our local machine.", "SSH lets us command and control our instance remotely via bash. I\u2019ll fire up Terminal on my Mac:", "Now, go back to the AWS site, EC2 dashboard, find the running p2.xlarge instance, and click Connect:", "Execute the above commands in bash, and you should be able to SSH in. You may need to type yes, then hit enter if SSH asks you to confirm authenticity of the key fingerprint.", "chmod 400 keras.pem changes user permissions on the key file so that it\u2019s not readable or writable by just anyone. AWS will check this and deny entry if the file is not secure!", "Notice how this image\u2019s load sequence gives us nice tips on how to load specific combinations of environments. These are Conda envs and they load various Python versions and support libraries.", "You can also update packages for the latest and greatest, but keep in mind you may break the packaged setups, as some versions of libraries don\u2019t play well together. If you wanted to update Keras, you could run:", "I\u2019ll be using source activate tensorflow_p36 to launch Keras 2 on a TensorFlow backend on Python 3. Note that Keras is a wrapper on TensorFlow, so it makes a complicated setup fast and easy with simple Python code. Then we launch Jupyter notebook, with no browser specified because we don\u2019t need Javascript or other installs on the remote side:", "Note the token you\u2019re assigned; we\u2019ll need that soon!", "Then, per this AWS guide, we open a new tab in terminal (CMD+T) and SSH into our Jupyter tunnel:", "That first port can be your favorite number (mine is 8157). It\u2019s the second one that has to match what\u2019s open on the AWS side.", "Type the token at the top, and select a password so you don\u2019t need to copy tokens every time you log in! You should be ready to rumble:", "I hope this helped! Let me know if you run into any unique issues, as the platforms are constantly changing. And be sure to connect with me on Twitter and LinkedIn!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa43aed049a50&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a43aed049a50--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a43aed049a50--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ultimatist?source=post_page-----a43aed049a50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ultimatist?source=post_page-----a43aed049a50--------------------------------", "anchor_text": "Jonathan Balaban"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F664d460a5ffa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&user=Jonathan+Balaban&userId=664d460a5ffa&source=post_page-664d460a5ffa----a43aed049a50---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa43aed049a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa43aed049a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jjying?utm_source=medium&utm_medium=referral", "anchor_text": "JJ Ying"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://aws.amazon.com", "anchor_text": "Amazon Web Services (AWS)"}, {"url": "https://aws.amazon.com/ec2/", "anchor_text": "Elastic Cloud Compute (EC2)"}, {"url": "https://keras.io", "anchor_text": "GPU-enabled Keras"}, {"url": "http://jupyter.org", "anchor_text": "Jupyter notebook"}, {"url": "https://medium.com/@ultimatist/deep-learning-tips-and-tricks-1ef708ec5f53", "anchor_text": "this accompanying piece"}, {"url": "https://en.wikipedia.org/wiki/Bash_(Unix_shell)", "anchor_text": "bash"}, {"url": "https://aws.amazon.com", "anchor_text": "AWS account"}, {"url": "https://www.docker.com/what-docker", "anchor_text": "Docker container"}, {"url": "https://aws.amazon.com/ec2/instance-types/p2/", "anchor_text": "P2 instances"}, {"url": "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html", "anchor_text": "sharing this instance with others"}, {"url": "https://www.engadget.com/2017/03/02/amazon-admits-that-a-typo-took-the-internet-down-this-week/", "anchor_text": "the internet could shut down again!"}, {"url": "https://en.wikipedia.org/wiki/Bash_(Unix_shell)", "anchor_text": "bash"}, {"url": "https://conda.io/docs/user-guide/tasks/manage-environments.html", "anchor_text": "Conda envs"}, {"url": "https://docs.aws.amazon.com/dlami/latest/devguide/setup-jupyter-configure-client-mac.html", "anchor_text": "per this AWS guide"}, {"url": "http://127.0.0.1:8157", "anchor_text": "http://127.0.0.1:8157"}, {"url": "https://twitter.com/ultimetis", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/jbalaban/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/aws?source=post_page-----a43aed049a50---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/keras?source=post_page-----a43aed049a50---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a43aed049a50---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a43aed049a50---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----a43aed049a50---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa43aed049a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&user=Jonathan+Balaban&userId=664d460a5ffa&source=-----a43aed049a50---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa43aed049a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&user=Jonathan+Balaban&userId=664d460a5ffa&source=-----a43aed049a50---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa43aed049a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a43aed049a50--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa43aed049a50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a43aed049a50---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a43aed049a50--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a43aed049a50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a43aed049a50--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a43aed049a50--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a43aed049a50--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a43aed049a50--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a43aed049a50--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a43aed049a50--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ultimatist?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ultimatist?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jonathan Balaban"}, {"url": "https://medium.com/@ultimatist/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F664d460a5ffa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&user=Jonathan+Balaban&userId=664d460a5ffa&source=post_page-664d460a5ffa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F882034f3032a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fboost-your-machine-learning-with-amazon-ec2-keras-and-gpu-acceleration-a43aed049a50&newsletterV3=664d460a5ffa&newsletterV3Id=882034f3032a&user=Jonathan+Balaban&userId=664d460a5ffa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}