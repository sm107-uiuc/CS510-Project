{"url": "https://towardsdatascience.com/understanding-dimensions-in-pytorch-6edf9972d3be", "time": 1682997113.7652748, "path": "towardsdatascience.com/understanding-dimensions-in-pytorch-6edf9972d3be/", "webpage": {"metadata": {"title": "Understanding dimensions in PyTorch | by Boyan Barakov | Towards Data Science", "h1": "Understanding dimensions in PyTorch", "description": "When I started doing some basic operations with PyTorch tensors like summation, it looked easy and pretty straightforward for one-dimensional tensors: However, once I started to play around with 2D\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@aerinykim/numpy-sum-axis-intuition-6eb94926a5d1", "anchor_text": "an article", "paragraph_index": 9}, {"url": "https://medium.com/u/1d8994ad0efc?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "Aerin Kim \ud83d\ude4f", "paragraph_index": 9}, {"url": "https://medium.com/@aerinykim/numpy-sum-axis-intuition-6eb94926a5d1", "anchor_text": "Numpy Sum Axis Intuition", "paragraph_index": 18}], "all_paragraphs": ["When I started doing some basic operations with PyTorch tensors like summation, it looked easy and pretty straightforward for one-dimensional tensors:", "However, once I started to play around with 2D and 3D tensors and to sum over rows and columns, I got confused mostly about the second parameterdimof torch.sum.", "Let\u2019s start by what the official documentation says:", "torch.sum(input, dim, keepdim=False, dtype=None) \u2192 Tensor", "Returns the sum of each row of the input tensor in the given dimension dim.", "I don\u2019t quite understand this explication. We can sum up over columns so why do one mention that it just \u201creturns the sum of each row\u201d ? This was my first incomprehension.", "However, the more important problem was, as I said, the direction of each dimension. Here\u2019s what I mean. When we describe the shape of a 2D tensor, we say that it contains some rows and some columns. So for a 2x3 tensor we\u2019ve 2 rows and 3 columns:", "We specify at first the rows (2 rows) and then the columns (3 columns), right? That brought me to the conclusion that the first dimension (dim=0) stays for rows and the second one (dim=1) for columns. Following the reasoning that the dimension dim=0 means row-wise, I expected torch.sum(x, dim=0) to result in a 1x2 tensor (1 + 2 + 3 and 4 + 5 + 6 for an outcome of tensor[6, 15]). But it turned out I got something different: a 1x3 tensor.", "I was surprised to see that the reality was the opposite of what I\u2019ve expected because I finally got the result tensor[6, 15] but when passing the parameter dim=1:", "So why is that? I found out an article of Aerin Kim \ud83d\ude4f tackling down the same confusion but for NumPy matrices where we pass a second parameter called axis. NumPy sum is almost identical to what we have in PyTorch except that dim in PyTorch is called axis in NumPy:", "The key to grasp how dim in PyTorch and axis in NumPy work was this paragraph from Aerin\u2019s article:", "The way to understand the \u201caxis\u201d of numpy sum is that it collapses the specified axis. So when it collapses the axis 0 (the row), it becomes just one row (it sums column-wise).", "She explains very well the functioning of the axis parameter on numpy.sum. However, it becomes trickier when we introduce a third dimension. When we look at the shape of a 3D tensor we\u2019ll notice that the new dimension gets prepended and takes the first position (in bold below) i.e. the third dimension becomes dim=0.", "Yes, it\u2019s quite confusing. That\u2019s why I think some basic visualizations of the process of summation over different dimensions will greatly contribute to a better understanding.", "The first dimension (dim=0) of this 3D tensor is the highest one and contains 3 two-dimensional tensors. So in order to sum over it we have to collapse its 3 elements over one another:", "For the second dimension (dim=1) we have to collapse the rows:", "And finally, the third dimension collapses over the columns:", "If you\u2019re like me, recently started to learn PyTorch or NumPy, I hope these basic animated examples will help you to get a better understanding of how dimensions work, not only for sum but for other methods as well.", "[1] A. Kim, Numpy Sum Axis Intuition", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Blockchain DeFi developer, working on @FujiFinance, interested in Machine Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6edf9972d3be&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bbarakov?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bbarakov?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "Boyan Barakov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F897ba0e94236&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&user=Boyan+Barakov&userId=897ba0e94236&source=post_page-897ba0e94236----6edf9972d3be---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6edf9972d3be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6edf9972d3be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@crissyjarvis?utm_source=medium&utm_medium=referral", "anchor_text": "Crissy Jarvis"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@aerinykim/numpy-sum-axis-intuition-6eb94926a5d1", "anchor_text": "an article"}, {"url": "https://medium.com/u/1d8994ad0efc?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "Aerin Kim \ud83d\ude4f"}, {"url": "https://medium.com/@aerinykim/numpy-sum-axis-intuition-6eb94926a5d1", "anchor_text": "Numpy Sum Axis Intuition"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----6edf9972d3be---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/numpy?source=post_page-----6edf9972d3be---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/tensor?source=post_page-----6edf9972d3be---------------tensor-----------------", "anchor_text": "Tensor"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6edf9972d3be---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----6edf9972d3be---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6edf9972d3be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&user=Boyan+Barakov&userId=897ba0e94236&source=-----6edf9972d3be---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6edf9972d3be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&user=Boyan+Barakov&userId=897ba0e94236&source=-----6edf9972d3be---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6edf9972d3be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6edf9972d3be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6edf9972d3be---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6edf9972d3be--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6edf9972d3be--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6edf9972d3be--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bbarakov?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bbarakov?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Boyan Barakov"}, {"url": "https://medium.com/@bbarakov/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "89 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F897ba0e94236&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&user=Boyan+Barakov&userId=897ba0e94236&source=post_page-897ba0e94236--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdaf75546dc57&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-dimensions-in-pytorch-6edf9972d3be&newsletterV3=897ba0e94236&newsletterV3Id=daf75546dc57&user=Boyan+Barakov&userId=897ba0e94236&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}