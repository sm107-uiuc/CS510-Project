{"url": "https://towardsdatascience.com/beginners-recommendation-systems-with-python-ee1b08d2efb6", "time": 1682996510.492459, "path": "towardsdatascience.com/beginners-recommendation-systems-with-python-ee1b08d2efb6/", "webpage": {"metadata": {"title": "Beginner\u2019s Recommendation Systems with Python | by Dean Sublett | Towards Data Science", "h1": "Beginner\u2019s Recommendation Systems with Python", "description": "Following Ibtesam Ahmed\u2019s Kaggle kernel to build recommender systems for recommending movies."}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/ibtesama/getting-started-with-a-movie-recommendation-system", "anchor_text": "Kaggle kernel on this dataset", "paragraph_index": 2}, {"url": "https://gist.github.com/deansublett/06f010a886831f9dac5b1f9bce4f4229", "anchor_text": "this gist", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/what-i-learned-from-abhishek-thakur-4b905ac0fd55", "anchor_text": "this article", "paragraph_index": 22}, {"url": "https://www.linkedin.com/in/deansublett/", "anchor_text": "https://www.linkedin.com/in/deansublett/", "paragraph_index": 30}], "all_paragraphs": ["Here are some objectives for you:", "A recommendation system (also commonly referred to as a recommendation/recommender engine/platform) seeks to predict a user\u2019s interest in available items (songs on Spotify, for example) and give recommendations accordingly. There are two primary types of recommendation systems:", "Credit to Ibtesam Ahmed for her Kaggle kernel on this dataset. This article is designed to follow her tutorial in a Medium-stylized format.", "As always, we\u2019ll import the necessary packages and the datasets first:", "Those two print statements give us the following output:", "So we\u2019re working with 4,803 movies. Notice that our data are split into two dataframes right now. Refer to this gist to see how to combine and clean up the dataframes. It might be easiest to keep this gist open while following the tutorial.", "We\u2019ll start with two very basic recommendation systems \u2014 we\u2019ll recommend the user a list of the highest rated movies and another list of the most popular movies. But first we\u2019ll want to find the weighted average for each movie\u2019s average rating (the vote_average values). Following Ibtesam\u2019s lead, we\u2019ll use the formula IMDB (formerly) used to calculate weighted ratings for movies.", "Here\u2019s one example of how to get the weighted averages:", "I selected 0.70 as my argument for quantile() to indicate that I was concerned only with movies that received at least as many votes as 70% of the movies of our dataset. Selecting our value for m is a bit arbitrary, so do try some experimentation here.", "Now we\u2019re ready for our first recommendation system. Let\u2019s recommend ten movies with the highest weighted average ratings:", "And we get this lovely graph of our highest rated picks:", "We see that our inaugural system recommended some classics. But what if we want to recommend movies that are popular among TMDB users?", "We can use the popularity feature of our data to recommend movies based on popularity instead:", "And now we can see our recommendations based on popularity scores:", "Ah, just as we expected: a standout performance from Minions. Now what if we want to recommend movies based on their weighted average ratings and their popularity scores?", "In order to avoid the colossal popularity score of Minions skewing our new scoring system, I normalized the values in both the weighted_average and popularity columns. I decided to go with a 50/50 split between the scaled weighted average rating and popularity scores, but again don\u2019t be afraid to experiment with this split:", "Now that we have a new score column that takes into account a movie\u2019s weighted average rating and it\u2019s popularity score, we can see what movies our recommender system will offer us:", "And here are our recommendations based on my 50/50 split:", "These recommenders worked as intended, but we can certainly improve. Now we\u2019ll have to turn to content-based filtering.", "So now we\u2019re interested in using the characteristics of a movie in order to recommend other movies to the user. Again following Ibtesam\u2019s example, we\u2019ll now make recommendations based on the movie\u2019s plot summaries given in the overview column. So if our user gives us a movie title, our goal is to recommend movies that share similar plot summaries.", "Before we can begin any analysis on the plot summaries, we\u2019ll have to convert our text in the overview column to word vectors, and we\u2019ll have to fit a TF-IDF on overview as well:", "And we receive the following output:", "So about 10,000 unique words were used in the plot summaries to describe our 5,000 movies (note that this figure is smaller than Ibtesam\u2019s because I increased the minimum word frequency to 3 with min_df=3). If you\u2019re interested in more, I talk about TF-IDF in this article, too.", "Now that we have a matrix of our words, we can begin calculating similarity scores. This metric will help us pick out movies with plot summaries similar to the movie submitted by the user. Ibtesam opted for the linear kernel, but I wanted to experiment with the sigmoid kernel for fun. Luckily, I arrived at similar results:", "So now that we\u2019ve constructed our content-based filtering system, let\u2019s test it out with timeless favorite, Spy Kids:", "And here are our recommendations per the content-based filtering system:", "So our recommendation system gave us some picks related to Spy Kids, but a few missteps such as In Too Deep and Escobar: Paradise Lost slipped in.", "Based on our results above, we can see that our content-based filtering system has some limitations:", "To sum up, we covered the following:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Trying to Learn Data Science | https://www.linkedin.com/in/deansublett/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fee1b08d2efb6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jds2be?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jds2be?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": "Dean Sublett"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F55dc301e6875&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&user=Dean+Sublett&userId=55dc301e6875&source=post_page-55dc301e6875----ee1b08d2efb6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee1b08d2efb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee1b08d2efb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@myke_simon?utm_source=medium&utm_medium=referral", "anchor_text": "Myke Simon"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/tmdb/tmdb-movie-metadata", "anchor_text": "TMDB 5000 movies dataset"}, {"url": "https://www.kaggle.com/ibtesama/getting-started-with-a-movie-recommendation-system", "anchor_text": "Kaggle kernel on this dataset"}, {"url": "https://gist.github.com/deansublett/06f010a886831f9dac5b1f9bce4f4229", "anchor_text": "this gist"}, {"url": "http://trailerpark.weebly.com/imdb-rating.html", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/what-i-learned-from-abhishek-thakur-4b905ac0fd55", "anchor_text": "this article"}, {"url": "https://www.kaggle.com/tmdb/tmdb-movie-metadata", "anchor_text": "TMDB 5000 movies dataset"}, {"url": "https://www.kaggle.com/ibtesama/getting-started-with-a-movie-recommendation-system", "anchor_text": "Credit to Ibtesam Ahmed\u2019s kernel for this tutorial"}, {"url": "https://gist.github.com/deansublett/06f010a886831f9dac5b1f9bce4f4229", "anchor_text": "Gist of my Colab notebook (this contains all the code referenced in the article)"}, {"url": "https://tryolabs.com/blog/introduction-to-recommender-systems/", "anchor_text": "Intro the Recommender Systems in 2019"}, {"url": "http://infolab.stanford.edu/~ullman/mmds/ch9.pdf", "anchor_text": "Chapter 9: Recommendation Systems"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html", "anchor_text": "TF-IDF scikit-learn documentation"}, {"url": "https://scikit-learn.org/stable/modules/metrics.html#sigmoid-kernel", "anchor_text": "Scikit-learn sigmoid-kernel user guide and more"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ee1b08d2efb6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ee1b08d2efb6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----ee1b08d2efb6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----ee1b08d2efb6---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/beginner?source=post_page-----ee1b08d2efb6---------------beginner-----------------", "anchor_text": "Beginner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fee1b08d2efb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&user=Dean+Sublett&userId=55dc301e6875&source=-----ee1b08d2efb6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fee1b08d2efb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&user=Dean+Sublett&userId=55dc301e6875&source=-----ee1b08d2efb6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee1b08d2efb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fee1b08d2efb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ee1b08d2efb6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ee1b08d2efb6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jds2be?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jds2be?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dean Sublett"}, {"url": "https://medium.com/@jds2be/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "230 Followers"}, {"url": "https://www.linkedin.com/in/deansublett/", "anchor_text": "https://www.linkedin.com/in/deansublett/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F55dc301e6875&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&user=Dean+Sublett&userId=55dc301e6875&source=post_page-55dc301e6875--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1a92e79cb50c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbeginners-recommendation-systems-with-python-ee1b08d2efb6&newsletterV3=55dc301e6875&newsletterV3Id=1a92e79cb50c&user=Dean+Sublett&userId=55dc301e6875&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}