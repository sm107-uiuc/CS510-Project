{"url": "https://towardsdatascience.com/cohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc", "time": 1683013882.943241, "path": "towardsdatascience.com/cohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc/", "webpage": {"metadata": {"title": "Cohen\u2019s Kappa: What it is, when to use it, and how to avoid its pitfalls | by Rosaria Silipo | Towards Data Science", "h1": "Cohen\u2019s Kappa: What it is, when to use it, and how to avoid its pitfalls", "description": "Cohen\u2019s kappa is a metric often used to assess the agreement between two raters. It can also be used to assess the performance of a classification model. For example, if we had two bankers, and we\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data)", "anchor_text": "UCI Machine Learning Repository", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Oversampling_and_undersampling_in_data_analysis#SMOTE", "anchor_text": "SMOTE", "paragraph_index": 8}, {"url": "https://hub.knime.com/knime/spaces/Examples/latest/04_Analytics/10_Scoring/05_Cohen's_Kappa_for_Evaluating_Classification_Models", "anchor_text": "Cohen\u2019s Kappa for Evaluating Classification Models", "paragraph_index": 37}, {"url": "https://thenewstack.io/cohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls/", "anchor_text": "The NewStack", "paragraph_index": 38}], "all_paragraphs": ["Cohen\u2019s kappa is a metric often used to assess the agreement between two raters. It can also be used to assess the performance of a classification model.", "For example, if we had two bankers, and we asked both to classify 100 customers in two classes for credit rating, i.e. good and bad, based on their creditworthiness, we could then measure the level of their agreement through Cohen\u2019s kappa.", "Similarly, in the context of a classification model, we could use Cohen\u2019s kappa to compare the machine learning model predictions with the manually established credit ratings.", "Like many other evaluation metrics, Cohen\u2019s kappa is calculated based on the confusion matrix. However, in contrast to calculating overall accuracy, Cohen\u2019s kappa takes imbalance in class distribution into account and can therefore be more complex to interpret.", "In this article we will guide you through the calculation and interpretation of Cohen\u2019s Kappa values, particularly in comparison with overall accuracy values. We will show that where overall accuracy fails because of a large imbalance in the class distribution, Cohen\u2019s kappa might supply a more objective description of the model performance. Along the way, we will also introduce a few tips to keep in mind when interpreting Cohen\u2019s kappa values!", "Let\u2019s focus on a classification task on bank loans, using the German credit data provided by the UCI Machine Learning Repository. In this dataset, bank customers have been assigned either a \u201cbad\u201d credit rating (30%) or a \u201cgood\u201d credit rating (70%) according to the criteria of the bank. For the purpose of this article, we exaggerated the imbalance in the target class credit rating via bootstrapping, giving us 10% with a \u201cbad\u201d credit rating and 90% with a \u201cgood\u201d credit rating: a highly imbalanced dataset. Exaggerating the imbalance helps us to make the difference between \u201coverall accuracy\u201d and \u201cCohen\u2019s kappa\u201d clearer in this article.", "Let\u2019s partition the data into a training set (70%) and a test set (30%) using stratified sampling on the target column and then train a simple model, a decision tree, for example. Given the high imbalance between the two classes, the model will not perform too well. Nevertheless, let\u2019s use its performance as the baseline for this study.", "Figure 1 shows the confusion matrix and accuracy statistics for this baseline model. The overall accuracy of the model is quite high (87%) and hints at an acceptable performance by the model. However, in the confusion matrix, we can see that the model is able to classify only 9 out of the 30 credit customers with a bad credit rating correctly. This is also visible by the low sensitivity value of class \u201cbad\u201d \u2014 just 30%. Basically, the decision tree is classifying most of the \u201cgood\u201d customers correctly and neglecting the necessary performance on the few \u201cbad\u201d customers. The imbalance in the class a priori probability compensates for such sloppiness in classification. Let\u2019s note for now that Cohen\u2019s kappa value is just 0.244, within its range of [-1,+1].", "Let\u2019s try to improve the model performance by forcing it to acknowledge the existence of the minority class. We train the same model this time on a training set where the minority class has been oversampled using the SMOTE technique, reaching a class proportion of 50% for both classes.", "To provide more detail about the confusion matrix for this model, 18 out of the 30 customers with a \u201cbad\u201d credit rating are detected by the model, leading to a new sensitivity value of 60% over the previous 30%. Cohen\u2019s kappa statistics is now 0.452 for this model, which is a remarkable increase from the previous value 0.244. But what about overall accuracy? For this second model it\u2019s 89%, not very different from the previous value 87%.", "When summarizing we get two very different pictures. According to the overall accuracy, model performance hasn\u2019t changed very much at all. However, according to Cohen\u2019s kappa a lot has changed! Which statement is right?", "From the numbers in the confusion matrix, it seems that Cohen\u2019s kappa has a more realistic view of the model\u2019s performance when using imbalanced data. Why does Cohen\u2019s kappa take more notice of the minority class? How is it actually calculated? Let\u2019s take a look!", "Cohen\u2019s kappa is calculated with the following formula [1]:", "where p_0 is the overall accuracy of the model and p_e is the measure of the agreement between the model predictions and the actual class values as if happening by chance.", "In a binary classification problem, like ours, p_e is the sum of p_e1, the probability of the predictions agreeing with actual values of class 1 (\u201cgood\u201d) by chance, and p_e2, the probability of the predictions agreeing with the actual values of class 2 (\u201cbad\u201d) by chance. Assuming that the two classifiers \u2014 model predictions and actual class values \u2014 are independent, these probabilities, p_e1and p_e2, are calculated by multiplying the proportion of the actual class and the proportion of the predicted class.", "Considering \u201cbad\u201d as the positive class, the baseline model (Figure 1) assigned 9% of the records (false positives plus true positives) to class \u201cbad\u201d, and 91% of the records (true negatives plus false negatives) to class \u201cgood\u201d. Thus p_e is:", "which is the same value as reported in Figure 1.", "Practically, Cohen\u2019s kappa removes the possibility of the classifier and a random guess agreeing and measures the number of predictions it makes that cannot be explained by a random guess. Furthermore, Cohen\u2019s kappa tries to correct the evaluation bias by taking into account the correct classification by a random guess.", "At this point, we know that Cohen\u2019s kappa is a useful evaluation metric when dealing with imbalanced data. However, Cohen\u2019s kappa has some downsides, too. Let\u2019s have a look at them one by one.", "It\u2019s easier to reach higher values of Cohen\u2019s kappa, if the target class distribution is balanced.", "For the baseline model (Figure 1), the distribution of the predicted classes follows closely the distribution of the target classes: 27 predicted as \u201cbad\u201d vs. 273 predicted as \u201cgood\u201d and 30 being actually \u201cbad\u201d vs. 270 being actually \u201cgood\u201d.", "For the improved model (Figure 2), the difference between the two class distributions is greater: 40 predicted as \u201cbad\u201d vs. 260 predicted as \u201cgood\u201d and 30 being actually \u201cbad\u201d vs. 270 being actually \u201cgood\u201d.", "As the formula for maximum Cohen\u2019s kappa shows, the more the distributions of the predicted and actual target classes differ, the lower the maximum reachable Cohen\u2019s kappa value is. The maximum Cohen\u2019s kappa value represents the edge case of either the number of false negatives or false positives in the confusion matrix being zero, i.e. all customers with a good credit rating, or alternatively all customers with a bad credit rating, are predicted correctly.", "where p_max is the maximum reachable overall accuracy of the model given the distributions of the target and predicted classes:", "For the baseline model, we get the following value for p_max:", "Whereas for the improved model it is:", "The maximum value of Cohen\u2019s kappa is then for the baseline model:", "For the improved model it is:", "As the results show, the improved model with a greater difference in the distributions between the actual and predicted target classes can only reach a Cohen\u2019s kappa value as high as 0.853. Whereas the baseline model can reach the value 0.942, despite the worse performance.", "When we calculate Cohen\u2019s kappa, we strongly assume that the distributions of target and predicted classes are independent and that the target class doesn\u2019t affect the probability of a correct prediction. In our example this would mean that a credit customer with a good credit rating has an equal chance of getting a correct prediction as a credit customer with a bad credit rating. However, since we know that our baseline model is biased towards the majority \u201cgood\u201d class , this assumption is violated.", "If this assumption were not violated, like in the improved model where the target classes are balanced, we could reach higher values of Cohen\u2019s kappa. Why is this? We can rewrite the formula of Cohen\u2019s kappa as the function of the probability of the positive class, and the function reaches its maximum when the probability of the positive class is 0.5 [1]. We test this by applying the same improved model (Figure 2) to different test sets, where the proportion of the positive \u201cbad\u201d class varies between 5% and 95%. We create 100 different test sets per class distribution by bootstrapping the original test data, and calculate the average Cohen\u2019s kappa value from the results.", "Figure 3 shows the average Cohen\u2019s kappa values against the positive class probabilities \u2014 and yes! Cohen\u2019s kappa does reach its maximum when the model is applied to balanced data!", "Cohen\u2019s kappa says little about the expected prediction accuracy.", "The numerator of Cohen\u2019s kappa, (p_0 - p_e), tells the difference between the observed overall accuracy of the model and the overall accuracy that can be obtained by chance. The denominator of the formula, (1- p_e), tells the maximum value for this difference.", "For a good model, the observed difference and the maximum difference are close to each other, and Cohen\u2019s kappa is close to 1. For a random model, the overall accuracy is all due to the random chance, the numerator is 0, and Cohen\u2019s kappa is 0. Cohen\u2019s kappa could also theoretically be negative. Then, the overall accuracy of the model would be even lower than what could have been obtained by a random guess.", "Given the explanation above, Cohen\u2019s kappa is not easy to interpret in terms of an expected accuracy, and it\u2019s often not recommended to follow any verbal categories as interpretations. For example, if you have 100 customers and a model with an overall accuracy of 87 %, then you can expect to predict the credit rating correctly for 87 customers. Cohen\u2019s kappa value 0.244 doesn\u2019t provide you with an interpretation as easy as this.", "In this article we have explained how to use and interpret Cohen\u2019s kappa to evaluate the performance of a classification model. While Cohen\u2019s kappa can correct the bias of overall accuracy when dealing with unbalanced data, it has a few shortcomings. So the next time you take a look at the scoring metrics of your model, remember:", "The workflow used for this study is shown in Figure 4. In the workflow we train, apply, and evaluate two decision tree models that predict the creditworthiness of credit customers. In the top branch, we train the baseline model, while in the bottom branch we train the model on the bootstrapped training set using the SMOTE technique. This workflow is downloadable from Cohen\u2019s Kappa for Evaluating Classification Models page on the KNIME Hub.", "As first published in The NewStack.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Rosaria has been mining data since her master degree, through her doctorate and job positions after that . She is now a data scientist and KNIME evangelist."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe42447962bbc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e42447962bbc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e42447962bbc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rosaria-silipo.medium.com/?source=post_page-----e42447962bbc--------------------------------", "anchor_text": ""}, {"url": "https://rosaria-silipo.medium.com/?source=post_page-----e42447962bbc--------------------------------", "anchor_text": "Rosaria Silipo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb562cc4a1e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=post_page-fb562cc4a1e2----e42447962bbc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe42447962bbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe42447962bbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.linkedin.com/in/maarit-widmann-02641a170/", "anchor_text": "Maarit Widmann"}, {"url": "https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data)", "anchor_text": "UCI Machine Learning Repository"}, {"url": "https://en.wikipedia.org/wiki/Oversampling_and_undersampling_in_data_analysis#SMOTE", "anchor_text": "SMOTE"}, {"url": "https://hub.knime.com/knime/spaces/Examples/latest/04_Analytics/10_Scoring/05_Cohen's_Kappa_for_Evaluating_Classification_Models", "anchor_text": "Cohen\u2019s Kappa for Evaluating Classification Models"}, {"url": "https://www-users.york.ac.uk/~mb55/msc/clinimet/week4/kappa_text.pdf", "anchor_text": "https://www-users.york.ac.uk/~mb55/msc/clinimet/week4/kappa_text.pdf"}, {"url": "https://thenewstack.io/cohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls/", "anchor_text": "The NewStack"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe42447962bbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=-----e42447962bbc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe42447962bbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=-----e42447962bbc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe42447962bbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e42447962bbc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe42447962bbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e42447962bbc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e42447962bbc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e42447962bbc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e42447962bbc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e42447962bbc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e42447962bbc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e42447962bbc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e42447962bbc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e42447962bbc--------------------------------", "anchor_text": ""}, {"url": "https://rosaria-silipo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rosaria-silipo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rosaria Silipo"}, {"url": "https://rosaria-silipo.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "563 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb562cc4a1e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=post_page-fb562cc4a1e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F45bf858fbd52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcohens-kappa-what-it-is-when-to-use-it-and-how-to-avoid-its-pitfalls-e42447962bbc&newsletterV3=fb562cc4a1e2&newsletterV3Id=45bf858fbd52&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.amazon.com/Codeless-Deep-Learning-KNIME-architectures-ebook/dp/B08KSCSB5G/?", "anchor_text": "Codeless Deep Learning with KNIME: Build, Train, and Deploy Various Deep Neural Network Architectures Using KNIME Analytics Platform2020"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}