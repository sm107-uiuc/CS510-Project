{"url": "https://towardsdatascience.com/estimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9", "time": 1683005703.2820008, "path": "towardsdatascience.com/estimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9/", "webpage": {"metadata": {"title": "Estimating the effect of social distancing | by Viktor K\u00e4rnstrand | Towards Data Science", "h1": "Estimating the effect of social distancing", "description": "In this post I extend the SIR epidemic model with a stochastic part and explore how the model could be combined with Covid-19 fatality data to estimate the evolution of the infection rate using Bayesian filters. The infection rate estimates should reflect the efficiency of social distancing policy."}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Mathematical_modelling_of_infectious_disease", "anchor_text": "SIR model", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Markov_chain", "anchor_text": "Markov", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Nilpotent", "anchor_text": "nilpotent", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Kalman_filter#Unscented_Kalman_filter", "anchor_text": "Unscented Kalman Filter", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Kalman_filter#Rauch%E2%80%93Tung%E2%80%93Striebel", "anchor_text": "Rauch-Tung-Striebel Smoothing", "paragraph_index": 12}, {"url": "https://users.aalto.fi/~ssarkka/pub/uks-preprint.pdf", "anchor_text": "solution", "paragraph_index": 13}], "all_paragraphs": ["In my last post, I created a GUI to simulate the dynamics of the Covid-19 outbreak using a deterministic SIR model. I then mentioned something about creating a fancy method to estimate the infection rate \u03b2 in the model over time. Today I have taken \u03b2, added it as a state in the SIR model, modeled it as a stochastic process and thereby created a Stochastic SIR model. Then I used something fancy called Unscented Kalman Filtering and something even fancier called Unscented Rauch-Tung-Striebel Smoothing to estimate the state of the process in general, and \u03b2 in particular to see if there is any evidence in the data that social distancing actually works.", "Those of you who are not into math can just skip the technicalities and look at the pretty images. If you are into math, and perhaps into Bayesian estimation in particular, forgive me for any stupid approximations I make. Every time I pretend something is Gaussian or approximately linear it is just me trying to get by. But please weight in here if you have better approximations or methods.", "In my last post, I used the number of reported cases, since there were not many fatalities in Sweden at that time. Looking at the data now it seems that reported cases is not a very reliable metric since it can be affected by policies and behavioral changes. Unfortunately, there are now quite a few fatalities per day, and that data is not subject to the same temporal circumstances and thus I have chosen to use that data for this study.", "Last time I also left out the actual math behind the SIR model, which is actually pretty simple. The three groups Susceptible, Infected and Resistent are coupled as the following differential equation describes:", "It is also worth mentioning that N \u2261 S + I + R is constant. So currently we have a deterministic model where the infection rate \u03b2 and the recovery rate \u03b3 are constants. I will also stick to my dubious claim that \u03b3=0.2, but now we put \u03b2 into the model state and add two equations:", "So we say that we cannot deterministically model \u03b2 but we say that it changes with some velocity and the time derivative of that velocity is white and normally distributed around zero with some standard deviation q. The term white in this context means that the process v(t) has no memory, meaning any knowledge about the state at one time does not add any information when predicting any future state, as opposed to \u03b2 and its time derivative which we say are Markov. Meaning the process has a memory and the current state is sufficient to describe the process going forward, any prior information about the process is redundant.", "Ok, so now we have a stochastic SIR model which is pretty cool. But what are we going to do with it? Well, this model provides us with some information about the dynamics of the outbreak, now we want to fuse that with the data to estimate the current state of the outbreak. Meaning how many Susceptible, Infected and Resistant there currently are in the population, and also what the infection rate is. Ultimately we also would want to go back in time and tell the state of the outbreak in retrospect.", "As it turns out there is this classical method for estimating a process state using measurement data given that you have a linear process model with white Gaussian process noise and that we can describe the measurements with a linear model that has white gaussian measurement errors. Gaussian means normally distributed, and normally distributed white process noise we do have - check. Our model is not exactly linear, but we will have to solve that later. Firstly we have to come up with a measurement model. Here is one now:", "So the number of fatalities on day k is Poisson distributed with a rate that is proportional to the number of infected individuals scaled by \u03bb, the fatality rate. If the number of fatalities is large enough, say >30, then the normal distribution is a fairly good approximation. For the cases where the number of fatalities are <30 we will just have to pretend the approximation is OK. The measurement error in this model is white though, as opposed to if you use any numbers that are aggregated over time which is a common mistake when starting to play with Kalman filters.", "Now, if our model was linear we could basically have used the Kalman Filter by now, but this is not the case so we will have to do something about that. If the model is fairly linear it is an option to just linearize it using the estimate at each time (which is then referred to as the Extended Kalman Filter), but this model is not that nice, it turns out. For all you math nerds out there curiously wondering how I know, it is because the Jacobian of the time derivative is not nilpotent. \ud83e\udd13", "So instead we use something called the Unscented Transform, which essentially means to discretize the distribution into a number of points. These points can then be propagated using the non-linear model and can then be used to calculate the predicted distribution and the very crucial matrix called the Kalman Gain. This version of the Kalman Filter is called the Unscented Kalman Filter and is very good for a number of additional reasons. It does not require a lot of analytical calculations, the model works pretty much as is. It typically also has a better numerical stability than the Extended Kalman Filter.", "Now, all we have to do is to formulate a non-informative prior distribution for our outbreak parameters at day zero. This means that we describe our knowledge of the state parameters as a multivariate normal distribution with some initial guess as mean value and some pretty inflated variances to reflect that we really do not know much about the system at this point. Then we can predict a prior distribution for day one, update that with the data using the Kalman Gain, predict a prior for day two etc. At some point, we get to the last day N that we have data, at which point we will have an unbiased optimal estimate for that day\u2026 Given that we do not remember any of the cheating and approximations that we have made along the way. \ud83e\udd14", "The problem now is that the estimates for all the earlier days k<N are outdated, but we want the utilize all information to estimate the change in \u03b2 that has happened due to increasing government regulations and recommendations. Luckily three clever German-American rocket scientists at Lockheed Missile Company came up with an extension to the Kalman Filter to go back in time and account for information \u201cfrom the future\u201d. These guys where called Rauch, Tung and Striebel and hence the method is called Rauch-Tung-Striebel Smoothing.", "Yet another problem though, this method does not work out of the box with the Unscented Kalman Filter. But not more than ten years ago a Finnish researcher called Simo S\u00e4rkk\u00e4 came up with a solution. So now we have our models, we have the data, we can assert some initial guess, estimate the state for each day using the Unscented Kalman Filter, and when we get to the end we go back using the Unscented Rauch-Tung-Striebel smoother. \ud83d\udc4c", "Before getting to the results I should also mention that I did some pre-smoothing of the data for two reasons. Primarily to mitigate that some weekdays have consistently lower or higher numbers and in general, a higher variability than they should due to shortcomings in the way health care authorities report dates for fatalities. Also because of the fact that the Gaussian assumption is not all that good for low fatality numbers. There are better methods to deal with this, but it had to do for now.", "I should also mention that I actually complicated things a bit by adding another group of infected to the SIR model. The individuals that are infected are transferred to the first group where they can affect others, after which they transition to the second group where they contribute to the fatality predictions. I made this choice because there seems to be a delay between reported cases and fatalities which is not reflected in the standard SIR model. Also, I worked for a while with combining data from reported cases and fatalities and in that case, it was necessary, then it so happened that I did not remove it from the model. The transition rate between these groups is the same as the recovery rate \u03b3 in the examples.", "Also, the fatality rate \u03bb is not known, and there are no reliable estimates out there yet so I will provide examples for 0.5%, 0.2% and 1% mortality. The fatality rate \u03bb can then be calculated from the total mortality rate and the assumed recovery rate \u03b3. The examples contain estimates with standard deviations for \u03b2 over time and also predictions from the 10th of April going forward where there is a best guess illustrated as a continuous line and dashed lines representing one standard deviation off the \u03b2 estimate.", "These results are at least an indication that social distancing policy has had an effect on the infection rate \u03b2, which seems to have dropped from 0.5 to 0.27\u00b10.03 in a month time.It also seems that the fatality peak will be at the end of April given that the actual mortality is around 0.2% and that the infection rate is kept close to 0.2, in which case only approximately 8.000 swedes will lose their lives.", "If, on the other hand, the actual mortality is closer to 1% the peak will happen during the turn from May to June and between 30.000 and 60.000 swedes will lose their lives depending on the continued success of social distancing.", "It is a delicate act of balance that the authorities will have to pull off, with limited data and blunt tools to intervene. And the stakes are apparently high.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Engineer with MSc in Complexity Science interested in Mathematical problems wherever they arise."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc6c1e606c8f9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@viktor.karnstrand?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@viktor.karnstrand?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": "Viktor K\u00e4rnstrand"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6dff6c04871&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&user=Viktor+K%C3%A4rnstrand&userId=6dff6c04871&source=post_page-6dff6c04871----c6c1e606c8f9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6c1e606c8f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6c1e606c8f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@uniqueton?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Anton"}, {"url": "https://unsplash.com/s/photos/statistics?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Mathematical_modelling_of_infectious_disease", "anchor_text": "SIR model"}, {"url": "https://en.wikipedia.org/wiki/Markov_chain", "anchor_text": "Markov"}, {"url": "https://en.wikipedia.org/wiki/Nilpotent", "anchor_text": "nilpotent"}, {"url": "https://en.wikipedia.org/wiki/Kalman_filter#Unscented_Kalman_filter", "anchor_text": "Unscented Kalman Filter"}, {"url": "https://en.wikipedia.org/wiki/Kalman_filter#Rauch%E2%80%93Tung%E2%80%93Striebel", "anchor_text": "Rauch-Tung-Striebel Smoothing"}, {"url": "https://users.aalto.fi/~ssarkka/pub/uks-preprint.pdf", "anchor_text": "solution"}, {"url": "https://medium.com/tag/kalman-filter?source=post_page-----c6c1e606c8f9---------------kalman_filter-----------------", "anchor_text": "Kalman Filter"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----c6c1e606c8f9---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/covid-19?source=post_page-----c6c1e606c8f9---------------covid_19-----------------", "anchor_text": "Covid-19"}, {"url": "https://medium.com/tag/sweden?source=post_page-----c6c1e606c8f9---------------sweden-----------------", "anchor_text": "Sweden"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c6c1e606c8f9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6c1e606c8f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&user=Viktor+K%C3%A4rnstrand&userId=6dff6c04871&source=-----c6c1e606c8f9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6c1e606c8f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&user=Viktor+K%C3%A4rnstrand&userId=6dff6c04871&source=-----c6c1e606c8f9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6c1e606c8f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc6c1e606c8f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c6c1e606c8f9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c6c1e606c8f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@viktor.karnstrand?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@viktor.karnstrand?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Viktor K\u00e4rnstrand"}, {"url": "https://medium.com/@viktor.karnstrand/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6dff6c04871&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&user=Viktor+K%C3%A4rnstrand&userId=6dff6c04871&source=post_page-6dff6c04871--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F6dff6c04871%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Festimating-the-effect-of-social-distancing-in-sweden-c6c1e606c8f9&user=Viktor+K%C3%A4rnstrand&userId=6dff6c04871&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}