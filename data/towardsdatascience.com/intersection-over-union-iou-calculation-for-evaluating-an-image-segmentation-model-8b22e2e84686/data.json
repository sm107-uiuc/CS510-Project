{"url": "https://towardsdatascience.com/intersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686", "time": 1683011484.066699, "path": "towardsdatascience.com/intersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686/", "webpage": {"metadata": {"title": "Intersection over union (IoU) calculation for evaluating an image segmentation model | by Oleksii Sheremet | Towards Data Science", "h1": "Intersection over union (IoU) calculation for evaluating an image segmentation model", "description": "In the simplest case, segmentation is the process of dividing a digital image into several segments. The result of instance segmentation using Mask R-CNN is a mask applied to the desired object and a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/matterport/Mask_RCNN", "anchor_text": "Mask R-CNN", "paragraph_index": 0}, {"url": "https://www.pyimagesearch.com/2016/11/07/intersection-over-union-iou-for-object-detection/", "anchor_text": "Intersection over union", "paragraph_index": 2}, {"url": "https://opencv.org/", "anchor_text": "OpenCV", "paragraph_index": 11}, {"url": "https://www.researchgate.net/profile/Oleksii_Sheremet", "anchor_text": "https://www.researchgate.net/profile/Oleksii_Sheremet", "paragraph_index": 13}], "all_paragraphs": ["In the simplest case, segmentation is the process of dividing a digital image into several segments. The result of instance segmentation using Mask R-CNN is a mask applied to the desired object and a bounding box around this object.", "In a practical task that I was solving, it was necessary to determine the buildings in the Google Earth photos. This task was successfully accomplished using Mask R-CNN for instance segmentation. After training the model, it was necessary to evaluate it quality for prediction the bounding boxes around buildings. I would like to acquaint readers with the approach (with code) I have used to evaluate the quality of predicting the coordinates of bounding boxes.", "Intersection over union (IoU) is known to be a good metric for measuring overlap between two bounding boxes or masks.", "If the prediction is completely correct, IoU = 1. The lower the IoU, the worse the prediction result.", "All code was implemented in Google Colab. Let\u2019s take a closer look. Import libraries and load source image:", "Import libraries and load source image:", "Let\u2019s set the coordinates of the original bounding box and fill the entire content of the photo outside the bounding box with black:", "The coordinates of the second bounding box are obtained as a result of prediction:", "Like in the previous case, fill all the content outside the bounding box with black:", "By filling images with black outside of the bounding boxes, pixels outside the area of interest do not affect the IoU calculation:", "Thus, we get the following result:", "The proposed approach has worked well in practice. It is possible to define overlap between image areas, not necessarily rectangular. You can calculate the coordinates of the contour around the masked object, for example, using OpenCV. Then using these points and the approach described above, you can calculate IoU between the masks.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Doctor of Engineering, Professor. Data Scientist at AI Labs | https://www.researchgate.net/profile/Oleksii_Sheremet"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8b22e2e84686&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dynamic_phlox_coyote_991?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dynamic_phlox_coyote_991?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": "Oleksii Sheremet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f778e21722&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&user=Oleksii+Sheremet&userId=c3f778e21722&source=post_page-c3f778e21722----8b22e2e84686---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b22e2e84686&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b22e2e84686&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/matterport/Mask_RCNN", "anchor_text": "Mask R-CNN"}, {"url": "https://www.pyimagesearch.com/2016/11/07/intersection-over-union-iou-for-object-detection/", "anchor_text": "Intersection over union"}, {"url": "https://www.microsoft.com/uk-ua/microsoft-365/visio/flowchart-software", "anchor_text": "Microsoft Visio"}, {"url": "https://www.microsoft.com/uk-ua/microsoft-365/visio/flowchart-software", "anchor_text": "Microsoft Visio"}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib"}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib"}, {"url": "https://matplotlib.org/", "anchor_text": "matplotlib"}, {"url": "https://opencv.org/", "anchor_text": "OpenCV"}, {"url": "https://github.com/matterport/Mask_RCNN", "anchor_text": "Mask R-CNN for Object Detection and Segmentation"}, {"url": "https://opencv.org/", "anchor_text": "Open Computer Vision Library"}, {"url": "https://www.pyimagesearch.com/2016/11/07/intersection-over-union-iou-for-object-detection/", "anchor_text": "Intersection over Union (IoU) for object detection"}, {"url": "https://medium.com/tag/image-segmentation?source=post_page-----8b22e2e84686---------------image_segmentation-----------------", "anchor_text": "Image Segmentation"}, {"url": "https://medium.com/tag/intersection-over-union?source=post_page-----8b22e2e84686---------------intersection_over_union-----------------", "anchor_text": "Intersection Over Union"}, {"url": "https://medium.com/tag/opencv?source=post_page-----8b22e2e84686---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/python?source=post_page-----8b22e2e84686---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/ipython?source=post_page-----8b22e2e84686---------------ipython-----------------", "anchor_text": "Ipython"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8b22e2e84686&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&user=Oleksii+Sheremet&userId=c3f778e21722&source=-----8b22e2e84686---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8b22e2e84686&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&user=Oleksii+Sheremet&userId=c3f778e21722&source=-----8b22e2e84686---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8b22e2e84686&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8b22e2e84686&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8b22e2e84686---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8b22e2e84686--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8b22e2e84686--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8b22e2e84686--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8b22e2e84686--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dynamic_phlox_coyote_991?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dynamic_phlox_coyote_991?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Oleksii Sheremet"}, {"url": "https://medium.com/@dynamic_phlox_coyote_991/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://www.researchgate.net/profile/Oleksii_Sheremet", "anchor_text": "https://www.researchgate.net/profile/Oleksii_Sheremet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3f778e21722&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&user=Oleksii+Sheremet&userId=c3f778e21722&source=post_page-c3f778e21722--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F19953c66acb8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintersection-over-union-iou-calculation-for-evaluating-an-image-segmentation-model-8b22e2e84686&newsletterV3=c3f778e21722&newsletterV3Id=19953c66acb8&user=Oleksii+Sheremet&userId=c3f778e21722&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}