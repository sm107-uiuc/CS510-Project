{"url": "https://towardsdatascience.com/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c", "time": 1682994039.649858, "path": "towardsdatascience.com/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c/", "webpage": {"metadata": {"title": "Training a Goal-Oriented Chatbot with Deep Reinforcement Learning \u2014 Part II | by Max Brenner | Towards Data Science", "h1": "Training a Goal-Oriented Chatbot with Deep Reinforcement Learning \u2014 Part II", "description": "Learn how to code a DQN agent to be a goal-oriented chatbot"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@maxbrenner110/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-i-introduction-and-dce3af21d383", "anchor_text": "previous part", "paragraph_index": 0}, {"url": "https://github.com/MiuLab/TC-Bot", "anchor_text": "TC-Bot", "paragraph_index": 2}, {"url": "https://github.com/maxbren/GO-Bot-DRL", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/dqn_agent.py", "anchor_text": "dqn_agent.py", "paragraph_index": 2}, {"url": "https://jaromiru.com/2016/09/27/lets-make-a-dqn-theory/", "anchor_text": "coding one,", "paragraph_index": 5}, {"url": "https://becominghuman.ai/lets-build-an-atari-ai-part-1-dqn-df57e8ff3b26", "anchor_text": "coding one a different way", "paragraph_index": 5}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/dialogue_config.py", "anchor_text": "dialogue_config.py", "paragraph_index": 7}, {"url": "https://github.com/keras-team/keras", "anchor_text": "Keras", "paragraph_index": 9}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/constants.json", "anchor_text": "constants.json", "paragraph_index": 10}, {"url": "https://arxiv.org/abs/1511.05952", "anchor_text": "prioritized experience replay", "paragraph_index": 21}, {"url": "https://medium.com/@maxbrenner110/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-iii-dialogue-state-d29c2828ce2a", "anchor_text": "next part", "paragraph_index": 22}], "all_paragraphs": ["Check out the previous part to this tutorial series if you haven\u2019t already where we covered what a goal-oriented chatbot is, the database we are using and the training loop of our dialogue system!", "In this part we will go in depth on the agent which in this case is represented by a DQN.", "This tutorial and the accompanying code are based off TC-Bot by MiuLab. The code for this tutorial can be found here. We will be working from dqn_agent.py in this part.", "The overarching diagram we are following:", "The purpose of a goal-oriented (GO) chatbot agent is to be trained to expertly converse with real users to complete a goal such as finding a reservation or movie ticket that works with the user\u2019s constraints. The agent\u2019s main job is to take a state and produce a close-to-optimal action. Specifically, the agent receives a state which represents the history of the current conversation from the dialogue state tracker (ST) and picks a dialogue response to take.", "Details of DQNs are beyond the scope of this tutorial so check out these resources to find out more: coding one, coding one a different way", "Now lets get to some code!", "Here are the dialogue config constants in dialogue_config.py used by the agent:", "agent_inform_slots are all of the possible key values for the agent\u2019s informs. agent_request_slots are all possible key values for the agent\u2019s requests. The possible agent actions are shown as well.", "We use Keras to build the model of the agent. The model is a single hidden layer neural network. It is pretty simple but gets very good results for this problem.", "The instance variables in this snippet are assigned to constants under \u201cagent\u201d from constants.json", "The policy the agent uses to pick an action given a state depends on whether the the dialogue is in the warm-up stage or training stage. Warm-up is run before training to fill the agent\u2019s memory using usually a random policy. In this case the agent uses a very basic rule-based policy during warm-up. In training, the behavior model is employed to pick an action. In this case, use_rule means warm-up.", "This method returns both the index of the action and the action itself.", "During warm-up a simple rule-based policy is employed.", "First take note of the reset method of the agent that only serves to reset a couple variables for this rule-based policy:", "The policy simply requests the next slot in a list of request slots until it has no more to request, then it takes an action of match found and finally on the last round an action of done.", "We will go into what match found and done mean in parts III and IV.", "Here is an example of a single episode using this simple policy:", "This policy is important for warm starting the agent in a somewhat meaningful way. It is a simple policy but improves results over taking random actions.", "As described in part one of the series dqn_agent.train() is called every some number of episodes during training.", "I\u2019m not going to walk through most of this code as it is pretty basic and many of you should have seen DQN code that looks much like this by now. I will note however, that this code unlike many other DQN training methods does not randomly sample only one batch. Instead it calculates how many batches are in the current memory and then trains the weights on this number of batches. It\u2019s a little odd but it is accurate to the original code from TC-Bot. Mess around with this to see if you can get better results with a different batch sampling technique!", "In summary, this agent picks an action based off of a state where the policy is either a simple list of requests during warm-up or the single hidden layer behavior model during training. The training method is straightforward with only a couple differences from other DQN training methods. Experiment with the model\u2019s architecture, add prioritized experience replay and make a more advanced rule-based policy!", "The next part will cover the ST and the query system! There you will learn about the how the ST updates its history/understanding of the conversation and what the state preparation looks like.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in all things machine learning, procedural and generative"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff84122cc995c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f84122cc995c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f84122cc995c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@maxbrenner110?source=post_page-----f84122cc995c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxbrenner110?source=post_page-----f84122cc995c--------------------------------", "anchor_text": "Max Brenner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe83c3988e008&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&user=Max+Brenner&userId=e83c3988e008&source=post_page-e83c3988e008----f84122cc995c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff84122cc995c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff84122cc995c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@maxbrenner110/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-i-introduction-and-dce3af21d383", "anchor_text": "previous part"}, {"url": "https://github.com/MiuLab/TC-Bot", "anchor_text": "TC-Bot"}, {"url": "https://github.com/maxbren/GO-Bot-DRL", "anchor_text": "here"}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/dqn_agent.py", "anchor_text": "dqn_agent.py"}, {"url": "https://jaromiru.com/2016/09/27/lets-make-a-dqn-theory/", "anchor_text": "coding one,"}, {"url": "https://becominghuman.ai/lets-build-an-atari-ai-part-1-dqn-df57e8ff3b26", "anchor_text": "coding one a different way"}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/dialogue_config.py", "anchor_text": "dialogue_config.py"}, {"url": "https://github.com/keras-team/keras", "anchor_text": "Keras"}, {"url": "https://github.com/maxbren/GO-Bot-DRL/blob/master/constants.json", "anchor_text": "constants.json"}, {"url": "https://github.com/jaromiru", "anchor_text": "Jarom\u00edr"}, {"url": "https://jaromiru.com/2016/09/27/lets-make-a-dqn-theory/", "anchor_text": "here"}, {"url": "http://languagelog.ldc.upenn.edu/nll/?p=34864", "anchor_text": ""}, {"url": "https://arxiv.org/abs/1511.05952", "anchor_text": "prioritized experience replay"}, {"url": "https://medium.com/@maxbrenner110/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-iii-dialogue-state-d29c2828ce2a", "anchor_text": "next part"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f84122cc995c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f84122cc995c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/chatbots?source=post_page-----f84122cc995c---------------chatbots-----------------", "anchor_text": "Chatbots"}, {"url": "https://medium.com/tag/reinforcement-learning?source=post_page-----f84122cc995c---------------reinforcement_learning-----------------", "anchor_text": "Reinforcement Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff84122cc995c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&user=Max+Brenner&userId=e83c3988e008&source=-----f84122cc995c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff84122cc995c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&user=Max+Brenner&userId=e83c3988e008&source=-----f84122cc995c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff84122cc995c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f84122cc995c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff84122cc995c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f84122cc995c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f84122cc995c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f84122cc995c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f84122cc995c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f84122cc995c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f84122cc995c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f84122cc995c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f84122cc995c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f84122cc995c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxbrenner110?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@maxbrenner110?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Max Brenner"}, {"url": "https://medium.com/@maxbrenner110/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "238 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe83c3988e008&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&user=Max+Brenner&userId=e83c3988e008&source=post_page-e83c3988e008--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffb2cbe1972e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-ii-dqn-agent-f84122cc995c&newsletterV3=e83c3988e008&newsletterV3Id=fb2cbe1972e0&user=Max+Brenner&userId=e83c3988e008&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}