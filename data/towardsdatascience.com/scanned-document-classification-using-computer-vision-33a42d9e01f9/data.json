{"url": "https://towardsdatascience.com/scanned-document-classification-using-computer-vision-33a42d9e01f9", "time": 1683002602.559049, "path": "towardsdatascience.com/scanned-document-classification-using-computer-vision-33a42d9e01f9/", "webpage": {"metadata": {"title": "Scanned Document Classification using Computer Vision | by Arpan Das | Towards Data Science", "h1": "Scanned Document Classification using Computer Vision", "description": "In the era of digital economy, sectors like Banking, Insurance, Governance, Medical and Legal sectors still deal with various handwritten notes and scanned documents. In later parts of the business\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/arpan65/Scanned-document-classification-using-deep-learning", "anchor_text": "here", "paragraph_index": 20}], "all_paragraphs": ["In the era of digital economy, sectors like Banking, Insurance, Governance, Medical and Legal sectors still deal with various handwritten notes and scanned documents. In later parts of the business life cycle, it becomes a very tedious job to maintain and classify these documents manually. A simple and meaningful automated binning of these unclassified documents would make it a lot easier to maintain and leverage the information and reduce the manual effort significantly.", "The goal of this case study is to develop a deep learning based solution which can automatically classify the documents.", "Data: For this case study, we will use the RVL-CDIP (Ryerson Vision Lab Complex Document Information Processing) data set which consists of 400,000 grayscale images in 16 classes, with 25,000 images per class. There are 320,000 training images, 40,000 validation images, and 40,000 test images. The images are sized so their largest dimension does not exceed 1000 pixels. The size of this data set is more than 200 GB.", "Business-ML problem mapping: We can map the business problem as a multi-class classification problem. There are 16 classes in the current data set. We need to predict the class of the documents based on only the pixel values of the scanned document which makes the problem hard. But wait, why can\u2019t we use OCR to extract text and apply NLP techniques? Yes, we were also excited about that idea, but low quality scans resulted in a poor quality of text extraction. In the practical business scenarios also we do not have control over the quality of scans, so models rely on OCR may suffer from poor generalization even after proper preprocessing.", "KPI and Business Constraints: The data set is fairly balanced. So we chose accuracy as the primary metric and Micro average F1 score as a secondary metric to penalize wrongly classified data points. We have also used confusion metric to validate the performance of the model. There is a moderate latency requirement and no specific requirements for interpretability.", "Can we get anything from the pixel intensity and size of the documents?", "Let\u2019s try to visualize the mean pixel intensity and size of the documents using a box plot", "From the box plot, we can observe that size of some type of scanned documents is quite different than others, but there are also overlaps. For example, the file size of class 13 and class 9 are much different but the size of class 9 overlaps with class 4 and class 6,7.", "We can observe that for 75% of the cases, the mean pixel intensity of class 4 lies between 160\u2013230 pixels. But for approx 50% cases, it also overlaps with the mean pixel value of class 6. For other classes, mean pixel value overlaps.", "To solve the problem at hand we have trained Convolution Neural networks (CNN) on the augmented data. We have tried to train the model with and without data augmentation, the results are comparable.", "Great! But how to decide the network architecture? How did you train the network as the data can not fit in the memory at once?", "Training a neural network from scratch takes significant time and computational resources to converge, to avoid this we took the help of transfer learning. We started with the weights of pretrained networks trained on ImageNet data set and retrained on our data set. The current SOTA model for this genre of problem uses inter and intra domain transfer learning where an image is divided into four parts header, footer, left body and right body. A pretrained VGG16 model is first used to train over the whole images(inter domain) then this model is used to train the part of images(Intra domain).", "In this experiment, we took a slightly different approach. Instead of intra domain transfer learning using VGG16, we trained two parallel models VGG16 and InceptionResNetV2 and used a stack of these as our final model. Our assumption was that because of the different architectures of these two models they will learn the different aspect of images and stacking them will result in good generalization. But how we choose these models? This basically comes from the cross validation results. We tried various network architectures like VGG16, VGG19, DenseNet, ResNet, InceptionNet and the best two were selected.", "We have used the ImageDataGenerator class of keras to preprocess and load the training data on the go instead of loading the whole data once in the memory.", "OK. But how to deal with the hyperparameters?", "For any CNN the hyper parameters are: learning rate, pooling size, network size, batch size, choice of optimizer, regularization, input size etc.", "Learning rate plays a significant role over the convergence of neural network. The loss functions used in deep learning problems are non convex, which means finding the global minimum is not an easy task in the presence of several local minima and saddle points. If the learning rate is too low it will converge slowly and if the learning rate is too high it will start oscillating. For this case study, we have used a technique called \u2018Cyclic Learning Rate\u2019, which aims to train neural network such a way that the learning rate changes in a cyclic way for each training batch.", "But why does it work? In CLR, we vary the learning rate within a threshold. The periodic higher learning rate helps to overcome if it stuck in the saddle point or local minima.", "For other hyperparameters, we have developed custom utility functions to check which configuration works better. Suppose after 10 epoch we got an accuracy of 47%. We will use this model as a testing baseline at that point and using the utility functions we will check which configuration set(i.e. batch_size/optimizer/learning_rate) will result in better accuracy in future epochs.", "We have achieved an accuracy of 90.7% using the VGG16 model and 88% using the InceptionResNetV2. The proportional stacked model of the above two models obtained a training accuracy of 97% and test accuracy of 91.45%.", "you can find the full implementation here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F33a42d9e01f9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@arpandas65.a3?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arpandas65.a3?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": "Arpan Das"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb3908ae4e107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&user=Arpan+Das&userId=b3908ae4e107&source=post_page-b3908ae4e107----33a42d9e01f9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F33a42d9e01f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F33a42d9e01f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/arpan65/Scanned-document-classification-using-deep-learning", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1506.01186", "anchor_text": "https://arxiv.org/abs/1506.01186"}, {"url": "https://www.researchgate.net/publication/332948719_Segmentation_of_Scanned_Documents_Using_Deep-Learning_Approach", "anchor_text": "https://www.researchgate.net/publication/332948719_Segmentation_of_Scanned_Documents_Using_Deep-Learning_Approach"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----33a42d9e01f9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----33a42d9e01f9---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----33a42d9e01f9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----33a42d9e01f9---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/technology?source=post_page-----33a42d9e01f9---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F33a42d9e01f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&user=Arpan+Das&userId=b3908ae4e107&source=-----33a42d9e01f9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F33a42d9e01f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&user=Arpan+Das&userId=b3908ae4e107&source=-----33a42d9e01f9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F33a42d9e01f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F33a42d9e01f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----33a42d9e01f9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----33a42d9e01f9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arpandas65.a3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arpandas65.a3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arpan Das"}, {"url": "https://medium.com/@arpandas65.a3/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "99 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb3908ae4e107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&user=Arpan+Das&userId=b3908ae4e107&source=post_page-b3908ae4e107--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F175e2755e763&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscanned-document-classification-using-computer-vision-33a42d9e01f9&newsletterV3=b3908ae4e107&newsletterV3Id=175e2755e763&user=Arpan+Das&userId=b3908ae4e107&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}