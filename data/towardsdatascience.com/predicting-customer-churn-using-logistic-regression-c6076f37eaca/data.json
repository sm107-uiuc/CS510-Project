{"url": "https://towardsdatascience.com/predicting-customer-churn-using-logistic-regression-c6076f37eaca", "time": 1683007260.1739829, "path": "towardsdatascience.com/predicting-customer-churn-using-logistic-regression-c6076f37eaca/", "webpage": {"metadata": {"title": "Predicting Customer Churn Using Logistic Regression | by Andrew Cole | Towards Data Science", "h1": "Predicting Customer Churn Using Logistic Regression", "description": "In my previous post, we completed a pretty in-depth walk through of the exploratory data analysis process for a customer churn analysis dataset. Our data, sourced from Kaggle, is centered around\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@andrewcole.817/customer-churn-analysis-eda-a688c8a166ed", "anchor_text": "post", "paragraph_index": 0}, {"url": "https://github.com/andrewcole33/telco_churn_analysis", "anchor_text": "here", "paragraph_index": 1}], "all_paragraphs": ["In my previous post, we completed a pretty in-depth walk through of the exploratory data analysis process for a customer churn analysis dataset. Our data, sourced from Kaggle, is centered around customer churn, the rate at which a commercial customer will leave the commercial platform that they are currently a (paying) customer, of a telecommunications company, Telco. Now that the EDA process has been complete, and we have a pretty good sense of what our data tells us before processing, we can move on to building a Logistic Regression classification model which will allow for us to predict whether a customer is at risk to churn from Telco\u2019s platform.", "The complete GitHub repository with notebooks and data walkthrough can be found here.", "When working with our data that accumulates to a binary separation, we want to classify our observations as the customer \u201cwill churn\u201d or \u201cwon\u2019t churn\u201d from the platform. A logistic regression model will try to guess the probability of belonging to one group or another. The logistic regression is essentially an extension of a linear regression, only the predicted outcome value is between [0, 1]. The model will identify relationships between our target feature, Churn, and our remaining features to apply probabilistic calculations for determining which class the customer should belong to. We will be using the \u2018ScikitLearn\u2019 package in Python.", "As a reminder, in our dataset we have 7043 rows (each representing a unique customer) with 21 columns: 19 features, 1 target feature (Churn). The data is composed of both numerical and categorical features, so we will need to address each of the datatypes respectively.", "We moved our data around a bit during the EDA process, but that pre-processing was mainly for ease of use and digestion, rather than functionality for a model. For the purposes of our Logistic Regression, we must pre-process our data in a different way, particularly to accommodate the categorical features which we have in our data. Let\u2019s take a look at our data info one more time to get a sense of what we are working with.", "We do not have any missing data and our data-types are in order. Note that the majority of our data are of \u2018object\u2019 type, our categorical data. This will be our primary area of focus in the preprocessing step. At the top of the data, we see two columns that are unnecessary, \u2018Unnamed: 0\u2019 and \u2018customerid\u2019. These two columns will be irrelevant to our data, as the former does not have any significant values and the latter is a unique identifier of the customer which is something we do not want. We quickly remove these features from our DataFrame via a quick pandas slice:", "The next step is addressing our target variable, Churn. Currently, the values of this feature are \u201cYes\u201d and \u201cNo\u201d. This is a binary outcome, which is what we want, but our model will not be able to meaningfully interpret this in its current string-form. Instead, we want to replace these variables with numeric binary values:", "Up next, we must deal with our remaining categorical variables. A Dummy Variable is a way of incorporating nominal variables into a regression as a binary value. These variables allow for the computer to interpret the values of a categorical variable as high(1) or low(0) scores. Because the variables are now numeric, the model can assess directionality and significance in our variables instead of trying to figure out what \u201cYes\u201d or \u201cNo\u201d means. When adding dummy variables is performed, it will add new binary features with [0,1] values that our computer can now interpret. Pandas has a simple function to perform this step.", "Note: It is very important to pay attention to the \u201cdrop_first\u201d parameter when categorical variables have more than binary values. We cannot use all values of categorical variables as features because this would raise the issue of multicollinearity (computer will place false significance on redundant information) and break the model. We must leave one of the categories out as a reference category.", "Our new DataFrame features are above and now include dummy variables.", "We must now separate our data into a target feature and predicting features.", "Our data is almost fully pre-processed but there is one more glaring issue to address, scaling. Our data is full of numeric data now, but they are all in different units. Comparing a binary value of 1 for \u2018streamingtv_Yes\u2019 with a continuous price value of \u2018monthlycharges\u2019 will not give any relevant information because they have different units. The variables simply will not give an equal contribution to the model. To fix this problem, we will standardize our data values via rescaling an original variable to have equal range & variance as the remaining variables. For our purposes, we will use Min-Max Scaling [0,1] because the standardize value will lie within the binary range.", "We now conduct our standard train test split to separate our data into a training set and testing set.", "Building the model can be done relatively quickly now, one we choose some parameters:", "Now that our model is built, we must predict our future values.", "At this point, our model is actually completely built even though we don\u2019t see an output. Let\u2019s take a look at evaluating our performance.", "How many times was the classifier correct on the training set?", "Because we\u2019re trying to predict whether a customer will leave or not, what better way to check our model performance than to see how often it was correct! To do so, we will take the residual distance between actual training data and predicted training data, as well as actual test data and predicted test data.", "This is pretty good! On our first pass, an 80% correct rate is a strong number. Remember, 100% accuracy would actually be a problem, as our model would be completely overfit to our data. Let\u2019s check our test data (perform the same code block as above, using y_test and y_hat_test as the residual arguments.", "Again, positive results! Our test and train set sizes are different, so the normalized results are more meaningful here. The fact that our model performs about the same on our train and test sets is a positive sign that our model is performing well.", "A confusion matrix is an extremely strong method of evaluating the performance of our classifier. A confusion matrix is a visual representation which tells us the degree of four important classification metrics:", "One axis of a confusion matrix will represent the ground-truth value, while the other will represent the predicted values. At this step, it is very important to have business domain knowledge. Certain metrics are more prevalent to our model than not. For example, if we were modeling whether a patient has a disease, it would be much worse for a high number of false negatives than a high number of false positives. If there are many false positives, then that just means some patients would need to undergo some unnecessary testing and maybe an annoying doctor visit or two. But, a high false negative means that many patients would actually be sick and diagnosed as healthy, potentially having dire consequences. For our purposes of churn, it is worse for us to predict a customer not churning when that customer actually churns in reality, meaning that our False Negatives are more important to pay attention to.", "We have 224 out of 1761 observations as False Negatives. This is slightly larger than we\u2019d like but it is still a promising number. In order to derive real meaning from the confusion matrix, we must use these four metrics to produce more descriptive metrics:", "2. Recall: Indicates what percentage of the classes we\u2019re interested in were actually captured by the model", "3. Accuracy: Measures the total number of predictions a model gets right, including both true positives and true negatives", "4. F1 Score: Harmonic Mean of Precision and Recall \u2014 a strong indicator of precision and recall (cannot have a high F1 score without strong model underneath)", "These metrics can be calculated by hand in a lengthier route, but fortunately for us, Sklearn has modules which will calculate these for us. All we have to do is pass our target data set and our predicted target data set.", "Our results are encouraging, yet not completely satisfying. Our recall and precision scores are a little bit lower than we would expect, but our accuracy score is the strongest metric and a very good sign, especially on the first try. Remember, building models is an iterative process so strong scores on the first go-around is encouraging!", "Another comprehensive way of evaluating our model performance and an alternative to confusion matrices is the AUC metric and an ROC-curve graph.", "This visual graph will illustrate the true positive rate (recall \u2014 TPR) against the false positive rate (FPR) of our classifier. Best performing models will have an ROC curve that hugs the upper left corner of the graph. This would represent that we correctly classify the positives much more often than we incorrectly classify them. The dotted blue line in the graph below represents a 1:1 linear relationship and is representative of a bad classifier, because the model guesses one incorrectly for every correct guess, making it no better than just flipping a coin!", "The AUC will give us a singular numeric metric to compare instead of a visual representation. An AUC = 1 would represent a perfect classifier, and an AUC = 0.5 represents a classifier which only has 50% precision. This metric quantifies the overall accuracy of our classifier model.", "Code for plotting the ROC Curve:", "These metrics look great! Notice how both our test and train curves hug the upper left corner and have very strong AUC values. With such strong models, we can now turn our eyes to tuning some model parameters/hyperparameters to slowly elevate our scores.", "We built a pretty strong model for our first go around. Building any machine learning model is an iterative process, and classification modeling itself has several types of models. In some following posts, I will explore these other methods, such as Random Forest, Support Vector Modeling, and XGboost, to see if we can improve on this customer churn model!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Using Data Science to drive curiosity."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc6076f37eaca&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@andrewcole.817?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andrewcole.817?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": "Andrew Cole"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb2c8eb9bc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&user=Andrew+Cole&userId=cb2c8eb9bc8&source=post_page-cb2c8eb9bc8----c6076f37eaca---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6076f37eaca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6076f37eaca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@andrewcole.817/customer-churn-analysis-eda-a688c8a166ed", "anchor_text": "post"}, {"url": "https://github.com/andrewcole33/telco_churn_analysis", "anchor_text": "here"}, {"url": "https://unsplash.com/@austindistel?utm_source=medium&utm_medium=referral", "anchor_text": "Austin Distel"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c6076f37eaca---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c6076f37eaca---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/customer-churn?source=post_page-----c6076f37eaca---------------customer_churn-----------------", "anchor_text": "Customer Churn"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----c6076f37eaca---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/logistic-regression?source=post_page-----c6076f37eaca---------------logistic_regression-----------------", "anchor_text": "Logistic Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6076f37eaca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&user=Andrew+Cole&userId=cb2c8eb9bc8&source=-----c6076f37eaca---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6076f37eaca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&user=Andrew+Cole&userId=cb2c8eb9bc8&source=-----c6076f37eaca---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6076f37eaca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc6076f37eaca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c6076f37eaca---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c6076f37eaca--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c6076f37eaca--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c6076f37eaca--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c6076f37eaca--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andrewcole.817?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@andrewcole.817?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrew Cole"}, {"url": "https://medium.com/@andrewcole.817/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "233 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb2c8eb9bc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&user=Andrew+Cole&userId=cb2c8eb9bc8&source=post_page-cb2c8eb9bc8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F39e7de80b84b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-customer-churn-using-logistic-regression-c6076f37eaca&newsletterV3=cb2c8eb9bc8&newsletterV3Id=39e7de80b84b&user=Andrew+Cole&userId=cb2c8eb9bc8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}