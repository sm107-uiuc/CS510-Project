{"url": "https://towardsdatascience.com/advanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d", "time": 1683009871.912425, "path": "towardsdatascience.com/advanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d/", "webpage": {"metadata": {"title": "Advanced Time Series Analysis with ARMA and ARIMA | by Marco Peixeiro | Towards Data Science", "h1": "Advanced Time Series Analysis with ARMA and ARIMA", "description": "In previous articles, we introduced moving average processes MA(q), and autoregressive processes AR(p) as two ways to model time series. Now, we will combine both methods and explore how ARMA(p,q)\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/how-to-model-time-series-in-python-9983ebbf82cf", "anchor_text": "moving average processes MA(q)", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/time-series-forecasting-with-autoregressive-processes-ba629717401", "anchor_text": "autoregressive processes AR(p)", "paragraph_index": 0}, {"url": "https://github.com/marcopeix/time-series-analysis", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://www.datasciencewithmarco.com/offers/tdU2mtVK", "anchor_text": "Applied Time Series Analysis in Python", "paragraph_index": 4}, {"url": "https://github.com/marcopeix/time-series-analysis/tree/master/Advanced%20modelling", "anchor_text": "notebook", "paragraph_index": 33}, {"url": "https://github.com/marcopeix/time-series-analysis/tree/master/data", "anchor_text": "dataset", "paragraph_index": 33}], "all_paragraphs": ["In previous articles, we introduced moving average processes MA(q), and autoregressive processes AR(p) as two ways to model time series. Now, we will combine both methods and explore how ARMA(p,q) and ARIMA(p,d,q) models can help us to model and forecast more complex time series.", "This article will cover the following topics:", "By the end of this article, you should be comfortable with implementing ARMA and ARIMA models in Python and you will have a checklist of steps to take when modelling time series.", "The notebook and dataset are here.", "Learn the latest time series analysis techniques with Applied Time Series Analysis in Python. The course covers both statistical and deep learning models, and you will work with Python and TensorFlow!", "Recall that an autoregressive process of order p is defined as:", "Recall also that a moving average process q is defined as:", "Then, an ARMA(p,q) is simply the combination of both models into a single equation:", "Hence, this model can explain the relationship of a time series with both random noise (moving average part) and itself at a previous step (autoregressive part).", "Let\u2019s how an ARMA(p,q) process behaves with a few simulations.", "Let\u2019s start with a simple example of an ARMA process of order 1 in both its moving average and autoregressive part.", "First, let\u2019s import all libraries that will be required throughout this tutorial:", "Then, we will simulate the following ARMA process:", "We can now plot the first 200 points to visualize our generated time series:", "And you should get something similar to:", "Then, we can take a look at the ACF and PACF plots:", "As you can see, we cannot infer the order of the ARMA process by looking at these plots. In fact, looking closely, we can see some sinusoidal shape in both ACF and PACF functions. This suggests that both processes are in play.", "Similarly, we can simulate an ARMA(2,2) process. In this example, we will simulate the following equation:", "Then, we can visualize the simulated data:", "Looking at the ACF and PACF plots:", "As you can see, both plots exhibit the same sinusoidal trend, which further supports the fact that both an AR(p) process and a MA(q) process is in play.", "ARIMA stands for AutoRegressive Integrated Moving Average.", "This model is the combination of autoregression, a moving average model and differencing. In this context, integration is the opposite of differencing.", "Differencing is useful to remove the trend in a time series and make it stationary.", "It simply involves subtracting a point a t-1 from time t. Realize that you will, therefore, lose the first data point in a time series if you apply differencing once.", "Mathematically, the ARIMA(p,d,q) now requires three parameters:", "and the equations is expressed as:", "Just like with ARMA models, the ACF and PACF cannot be used to identify reliable values for p and q.", "However, in the presence of an ARIMA(p,d,0) process:", "Similarly, in the presence of an ARIMA(0,d,q) process:", "Let\u2019s walk through an example of modelling with ARIMA to get some hands-on experience and better understand some modelling concepts.", "Let\u2019s revisit a dataset that we analyzed previously. This dataset was used to show the Yule-Walker equation can help us estimate the coefficients of an AR(p) process.", "Now, we will use the same dataset, but model the time series with an ARIMA(p,d,q) model.", "You can grab the notebook or download the dataset to follow along.", "First, we import the dataset and display the first five rows:", "Then, let\u2019s plot the entire dataset:", "As you can see, there is both a trend and a change in variance in this time series.", "Let\u2019s plot the ACF and PACF functions:", "As you can see, there is no way of determining the right order for the AR(p) process or MA(q) process.", "The plots above are also a clear indication of non-stationarity. To further prove this point, let\u2019s use the augmented Dicker-Fuller test:", "Here, the p-value is larger than 0.05, meaning the we cannot reject the null hypothesis stating that the time series is non-stationary.", "Therefore, we must apply some transformation and some differencing to remove the trend and remove the change in variance.", "We will hence take the log difference of the time series. This is equivalent to taking the logarithm of the EPS, and then apply differencing once. Note that because we are differencing once, we will get rid of the first data point.", "Now, let\u2019s plot the new transformed data:", "It seems that trend and the change in variance were removed, but we want to make sure that it is the case. Therefore, we apply the augmented Dickey-Fuller test again to test for stationarity.", "This time, the p-value is less than 0.05, we reject the null hypothesis, and assume that the time series is stationary.", "Now, let\u2019s look at the PACF and ACF to see if we can estimate the order of one of the processes in play.", "Examining the PACF above, it seems that there is an AR process of order 3 or 4 in play. However, the ACF is not informative and we see some sinusoidal shape.", "Therefore, how can we make sure that we choose the right order for both the AR(p) and MA(q) processes?", "We will need try different combinations of orders, fit an ARIMA model with those orders, and use a criterion for order selection.", "This brings us to the topic of Akaike\u2019s Information Criterion or AIC.", "This criterion is useful for selecting the order (p,d,q) of an ARIMA model. The AIC is expressed as:", "Where L is the likelihood of the data and k is the number of parameters.", "In practice, we select the model with the lowest AIC compared to other models.", "It is important to note that the AIC cannot be used to select the order of differencing (d). Differencing the data will the change the likelihood (L) of the data. The AIC of models with different orders of differencing are therefore not comparable.", "Also, notice that since we select the model with the lowest AIC, more parameters will increase the AIC score and thus penalize the model. While a model with more parameters could perform better, the AIC is used to find the model with the least number of parameters that will still give good results.", "A final note on AIC is that it can only be used relative to other models. A small AIC value is not a guarantee that the model will have a good performance on unsee data, or that its SSE will be small.", "Now that we know how we will base our decision to select the best order for the ARIMA model, let\u2019s write a function that will test all orders for us.", "The function above will result in a dataframe that will list the orders and the corresponding AIC, starting with the best model on top.", "We will try all combinations with orders (p,q) ranging from 0 to 8, but keeping the differencing order equal to 1.", "Once the function is done running, you should see that the order associated with the lowest AIC is (3,1,3). Therefore, this suggests are ARIMA model with an AR(3) process and a MA(3) process.", "Now, we can print a summary of the best model, which an ARIMA (3,1,3).", "From the summary above, we can see the value for all coefficients and their associated p-values. Notice how the parameter for the MA process at lag 2 does not seem to be statistically significant according to the p-value. Still, let\u2019s keep it in the model for now.", "Hence, from the table above, the time series can be modeled as:", "Where epsilon is noise with a variance of 0.0077.", "The final part of modelling a time series is to study the residuals.", "Ideally, the residuals will be white noise, with no autocorrelation.", "A good way to test this is to use the Ljung-Box test. Note that this test can only be applied to the residuals.", "Here, the null hypothesis for the Ljung-Box test is that there is no autocorrelation. Looking at the p-values above, we can see that they are above 0.05. Therefore, we cannot reject the null hypothesis, and the residuals are indeed not correlated.", "We can further support that by plotting the ACF and PACF of the residuals.", "As you can see, the plots above resemble those of white noise.", "Therefore, this model is ready to be used for forecasting.", "Here is a general procedure that you can follow whenever you are faced with a time series:", "Congratulations! You now understand what an ARMA model is and you understand how to use non-seasonal ARIMA models for advanced time series analysis. You also have a road map for time series analysis that you can apply to make sure that you obtain the best model possible.", "Learn more about time series analysis with the following course:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior data scientist | Author | Instructor. I write hands-on articles with a focus on practical skills."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa7d9b589ed6d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd----a7d9b589ed6d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7d9b589ed6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7d9b589ed6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@loic?utm_source=medium&utm_medium=referral", "anchor_text": "Djim Loic"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/how-to-model-time-series-in-python-9983ebbf82cf", "anchor_text": "moving average processes MA(q)"}, {"url": "https://towardsdatascience.com/time-series-forecasting-with-autoregressive-processes-ba629717401", "anchor_text": "autoregressive processes AR(p)"}, {"url": "https://github.com/marcopeix/time-series-analysis", "anchor_text": "here"}, {"url": "https://www.datasciencewithmarco.com/offers/tdU2mtVK", "anchor_text": "Applied Time Series Analysis in Python"}, {"url": "https://github.com/marcopeix/time-series-analysis/tree/master/Advanced%20modelling", "anchor_text": "notebook"}, {"url": "https://github.com/marcopeix/time-series-analysis/tree/master/data", "anchor_text": "dataset"}, {"url": "https://www.datasciencewithmarco.com/offers/tdU2mtVK", "anchor_text": "Applied Time Series Analysis in Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a7d9b589ed6d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a7d9b589ed6d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a7d9b589ed6d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----a7d9b589ed6d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a7d9b589ed6d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa7d9b589ed6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----a7d9b589ed6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa7d9b589ed6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=-----a7d9b589ed6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa7d9b589ed6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa7d9b589ed6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a7d9b589ed6d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a7d9b589ed6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcopeixeiro?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Peixeiro"}, {"url": "https://medium.com/@marcopeixeiro/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F741c1c8fcfbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=post_page-741c1c8fcfbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9835bccb3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fadvanced-time-series-analysis-with-arma-and-arima-a7d9b589ed6d&newsletterV3=741c1c8fcfbd&newsletterV3Id=9835bccb3d51&user=Marco+Peixeiro&userId=741c1c8fcfbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.manning.com/books/time-series-forecasting-in-python-book", "anchor_text": "Time Series Forecasting in Python2022"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}