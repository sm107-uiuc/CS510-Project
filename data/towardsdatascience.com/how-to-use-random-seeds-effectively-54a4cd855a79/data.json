{"url": "https://towardsdatascience.com/how-to-use-random-seeds-effectively-54a4cd855a79", "time": 1683005344.3485272, "path": "towardsdatascience.com/how-to-use-random-seeds-effectively-54a4cd855a79/", "webpage": {"metadata": {"title": "How to Use Random Seeds Effectively | by Jai Bansal | Towards Data Science", "h1": "How to Use Random Seeds Effectively", "description": "This post is about an aspect of the predictive model-building process that doesn\u2019t typically get much attention: random seeds."}, "outgoing_paragraph_urls": [{"url": "https://github.com/jai-bansal", "anchor_text": "https://github.com/jai-bansal", "paragraph_index": 38}], "all_paragraphs": ["Building a predictive model is a complex process. You need to get the right data, clean it, create useful features, test different algorithms, and finally validate your model\u2019s performance. However, this post covers an aspect of the model-building process that doesn\u2019t typically get much attention: random seeds.", "A random seed is used to ensure that results are reproducible. In other words, using this parameter makes sure that anyone who re-runs your code will get the exact same outputs. Reproducibility is an extremely important concept in data science and other fields. Lots of people have already written about this topic at length, so I won\u2019t discuss it any further in this post.", "Depending on your specific project, you may not even need a random seed. However, there are 2 common tasks where they are used:", "1. Splitting data into training/validation/test sets: random seeds ensure that the data is divided the same way every time the code is run", "2. Model training: algorithms such as random forest and gradient boosting are non-deterministic (for a given input, the output is not always the same) and so require a random seed argument for reproducible results", "In addition to reproducibility, random seeds are also important for bench-marking results. If you are testing multiple versions of an algorithm, it\u2019s important that all versions use the same data and are as similar as possible (except for the parameters you are testing).", "Despite their importance, random seeds are often set without much effort. I\u2019m guilty of this. I typically use the date of whatever day I\u2019m working on (so on March 1st, 2020 I would use the seed 20200301). Some people use the same seed every time, while others randomly generate them.", "Overall, random seeds are typically treated as an afterthought in the modeling process. This can be problematic because, as we\u2019ll see in the next few sections, the choice of this parameter can significantly affect results.", "Now, I\u2019ll demonstrate just how much impact the choice of a random seed can have. I\u2019ll use the well-known Titanic dataset to do this (download link is below).", "The following code and plots are created in Python, but I found similar results in R. The complete code associated with this post can be found in the GitHub repository below:", "First, let\u2019s look at a few rows of this data:", "The Titanic data is already divided into training and test sets. A classic task for this dataset is to predict passenger survival (encoded in the Survived column). The test data does not come with labels for the Survived column, so I\u2019ll be doing the following:", "1. Holding out part of the training data to serve as a validation set", "2. Training a model to predict survival on the remaining training data and evaluating that model against the validation set created in step 1", "Let\u2019s start by looking at the overall distribution of the Survived column.", "When modeling, we want our training, validation, and test data to be as similar as possible so that our model is trained on the same kind of data that it\u2019s being evaluated against. Note that this does not mean that any of these 3 data sets should overlap! They should not. But we want the observations contained in each of them to be broadly comparable. I\u2019ll now split the data using different random seeds and compare the resulting distributions of Survived for the training and validation sets.", "In this case, the proportion of survivors is much lower in the training set than the validation set.", "Here, the proportion of survivors is much higher in the training set than in the validation set.", "Full disclosure, these examples are the most extreme ones I found after looping through 200K random seeds. Regardless, there are a couple of concerns with these results. First, in both cases, the survival distribution is substantially different between the training and validation sets. This will likely negatively affect model training. Second, these outputs are very different from each other. If, as most people do, you set a random seed arbitrarily, your resulting data splits can vary drastically depending on your choice.", "I\u2019ll discuss best practices at the end of the post. Next, I want to show how the training and validation Survival distributions varied for all 200K random seeds I tested.", "~23% of data splits resulted in a survival percentage difference of at least 5% between training and validation sets. Over 1% of splits resulted in a survival percentage difference of at least 10%. The largest survival percentage difference was ~20%. The takeaway here is that using an arbitrary random seed can result in large differences between the training and validation set distributions. These differences can have unintended downstream consequences in the modeling process.", "The previous section showed how random seeds can influence data splits. In this section, I train a model using different random seeds after the data has already been split into training and validation sets (more on exactly how I do that in the next section).", "As a reminder, I\u2019m trying to predict the Survived column. I\u2019ll build a random forest classification model. Since the random forest algorithm is non-deterministic, a random seed is needed for reproducibility. I\u2019ll show results for model accuracy below, but I found similar results using precision and recall.", "First, I\u2019ll create a training and validation set.", "Now I\u2019ll train a couple of models and evaluate accuracy on the validation set.", "I tested 25K random seeds to find these results, but a change in accuracy of >6% is definitely noteworthy! Again, these 2 models are identical except for the random seed.", "The plot below shows how model accuracy varied across all of the random seeds I tested.", "While most models achieved ~80% accuracy, there are a substantial number of models scoring between 79%-82% and a handful of models that score outside of that range. Depending on the specific use case, these differences are large enough to matter. Therefore, model performance variance due to random seed choice should be taken into account when communicating results with stakeholders.", "Now that we\u2019ve seen a few areas where the choice of random seed impacts results, I\u2019d like to propose a few best practices.", "For data splitting, I believe stratified samples should be used so that the proportions of the dependent variable (Survived in this post) are similar in the training, validation, and test sets. This would eliminate the varying survival distributions above and allows a model be trained and evaluated on comparable data.", "The train_test_split function can implement stratified sampling with 1 additional argument. Note that if a model is later evaluated against data with a different dependent variable distribution, performance may be different than expected. However, I believe stratifying by the dependent variable is still the preferred way to split data.", "Here\u2019s how stratified sampling looks in code.", "Using the stratify argument, the proportion of Survived is similar in the training and validation sets. I still use a random seed as I still want reproducible results. However, it\u2019s my opinion that the specific random seed value doesn\u2019t matter in this case.", "That addresses data splitting best practices, but how about model training? While testing different model specifications, a random seed should be used for fair comparisons but I don\u2019t think the particular seed matters too much.", "However, before reporting performance metrics to stakeholders, the final model should be trained and evaluated with 2\u20133 additional seeds to understand possible variance in results. This practice allows more accurate communication of model performance. For a critical model running in a production environment, it\u2019s worth considering running that model with multiple seeds and averaging the result (though this is probably a topic for a separate blog post).", "Hopefully I\u2019ve convinced you to pay a bit of attention to the often-overlooked random seed parameter. Feel free to get in touch if you\u2019d like to see the full code used in this post or have other ideas for random seed best practices!", "If you enjoyed this post, check out some of my other work below!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Whiskey Enthusiast | Board Game Extraordinaire | https://github.com/jai-bansal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F54a4cd855a79&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jai_bansal?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jai_bansal?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": "Jai Bansal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2bf67968ed7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&user=Jai+Bansal&userId=e2bf67968ed7&source=post_page-e2bf67968ed7----54a4cd855a79---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F54a4cd855a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F54a4cd855a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/Pezibear-526143/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1274944", "anchor_text": "Pezibear"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1274944", "anchor_text": "Pixabay"}, {"url": "https://www.kaggle.com/c/titanic/data", "anchor_text": "Titanic: Machine Learning from DisasterStart here! Predict survival on the Titanic and get familiar with ML basicswww.kaggle.com"}, {"url": "https://github.com/jai-bansal/random-seed-blog-post", "anchor_text": "jai-bansal/random-seed-blog-postThis repository contains code supporting a blog post on random seed best practices. The blog post can be found here\u2026github.com"}, {"url": "https://towardsdatascience.com/la-traffic-data-analysis-part-1-53f24e21067d", "anchor_text": "LA Traffic Data Analysis \ud83d\ude97 : Part 1Using open-source data to analyze collision patterns in Los Angelestowardsdatascience.com"}, {"url": "https://medium.com/@jai_bansal/7-tips-for-developing-technical-trainings-for-your-organization-928cf7744d44", "anchor_text": "7 Tips for Developing Technical Trainings for your OrganizationTechniques to bring your next training course idea to lifemedium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----54a4cd855a79---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----54a4cd855a79---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----54a4cd855a79---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/predictive-analytics?source=post_page-----54a4cd855a79---------------predictive_analytics-----------------", "anchor_text": "Predictive Analytics"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----54a4cd855a79---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F54a4cd855a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&user=Jai+Bansal&userId=e2bf67968ed7&source=-----54a4cd855a79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F54a4cd855a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&user=Jai+Bansal&userId=e2bf67968ed7&source=-----54a4cd855a79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F54a4cd855a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F54a4cd855a79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----54a4cd855a79---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----54a4cd855a79--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----54a4cd855a79--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----54a4cd855a79--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----54a4cd855a79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jai_bansal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jai_bansal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jai Bansal"}, {"url": "https://medium.com/@jai_bansal/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "29 Followers"}, {"url": "https://github.com/jai-bansal", "anchor_text": "https://github.com/jai-bansal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2bf67968ed7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&user=Jai+Bansal&userId=e2bf67968ed7&source=post_page-e2bf67968ed7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fecefe8e6b094&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-use-random-seeds-effectively-54a4cd855a79&newsletterV3=e2bf67968ed7&newsletterV3Id=ecefe8e6b094&user=Jai+Bansal&userId=e2bf67968ed7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}