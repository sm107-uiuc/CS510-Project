{"url": "https://towardsdatascience.com/pycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3", "time": 1683018101.592007, "path": "towardsdatascience.com/pycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3/", "webpage": {"metadata": {"title": "PyCaret and Streamlit: How to Create and Deploy Data Science Web App | by Ruben Winastwan | Towards Data Science", "h1": "PyCaret and Streamlit: How to Create and Deploy Data Science Web App", "description": "Building and deploying a machine learning model have never been easier. Right now, we have a lot of frameworks and libraries that enable us to build machine learning models with just a few lines of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009", "anchor_text": "download for free here", "paragraph_index": 2}, {"url": "https://pycaret.readthedocs.io/en/latest/index.html", "anchor_text": "PyCaret official documentation page.", "paragraph_index": 11}, {"url": "https://pycaret.readthedocs.io/en/latest/api/classification.html", "anchor_text": "here", "paragraph_index": 23}, {"url": "https://share.streamlit.io/marcellusruben/wine-classifier/main/app.py", "anchor_text": "here", "paragraph_index": 49}, {"url": "https://github.com/marcellusruben/Wine-Classifier/tree/main", "anchor_text": "here", "paragraph_index": 50}], "all_paragraphs": ["Building and deploying a machine learning model have never been easier. Right now, we have a lot of frameworks and libraries that enable us to build machine learning models with just a few lines of code. Among all of them, PyCaret is one of the best. To create and deploy a web app for our data science project, Streamlit has become very popular lately.", "In this article, we will use these two libraries to create a data science web app. We\u2019re going to use PyCaret to build a wine quality classifier. Next, we\u2019re going to use Streamlit to create and deploy this wine classifier. You\u2019ll be surprised of how easy and quick it is to build the classifier and deploy the web app with these two libraries. So, let\u2019s get started!", "The data that we will use in this article is the Wine Quality dataset, which you can download for free here. This dataset consists of 1599 instances with 12 features. Let\u2019s load the dataset with Pandas.", "As you can see above, we have different features such as fixed acidity, citric acid, pH, and so on. The task of our classifier is to predict whether the wine quality is good or bad. However, the values for quality feature is not what we would\u2019ve expected. We need to transform the value in this feature to be either \u2018good\u2019 or \u2018bad\u2019.", "To do this, we need to set certain rules. If the wine quality is equal or greater than 6, then we can classify the quality of the wine as good, otherwise the quality is bad.", "Now we have the data that we\u2019re looking for! Note that you can also check that there are 855 wines classified as \u2018good\u2019 and 744 wines classified as \u2018bad\u2019. This proportion seems pretty balanced and safe to say that we don\u2019t have an imbalanced dataset issue.", "The dataset is also clean, which means that there is no missing value, no duplicate value, and the data types are all correct.", "Next, let\u2019s build our classifier model using PyCaret.", "PyCaret is a low-code machine learning library that automates all of the machine learning workflows. What it does is that it provides a wrapper for popular machine learning libraries such as scikit-learn, XGBoost, LightGBM, CatBoost, and many more.", "With PyCaret, we can basically build our machine learning model for classification, regression, clustering, anomaly detection, or NLP problems in just a few lines of code.", "If you haven\u2019t installed PyCaret, you can easily do so by typing the following pip command.", "Since we\u2019re going to solve a classification problem, then we need to use pycaret.classification module. If you solve different problems, then you need to use other modules, which you can find out more in PyCaret official documentation page.", "First things first, we need to setup our PyCaret environment with setup() function. This function needs to be called first before we call other functions in PyCaret.", "As you can see, we passed two parameters as the argument for setup() function:", "If you run the code snippet above, you\u2019ll get the following outputs:", "From the output above, you can see that the setup() function will automatically split our data into train set and test set.", "Also, it will automatically infer the data types of your features: whether your feature is a numerical feature or a categorical feature. You need to take a look at the output carefully because there are times when the function infers the data types incorrectly. If you find that one of the feature is inferred incorrectly, you can correct it by doing the following:", "You can use categorical_features or numerical_features parameter to change the data types that are incorrectly inferred by setup() function. You need to pass a list of string of the name of the features that you want to change.", "Next, let\u2019s build our classifier model.", "When we want to build a machine learning model, most of the times we don\u2019t know in advance which models that will give us the best performance according to our metrics. With PyCaret, you\u2019re able to compare the performance of different kinds of classification models with literally single line of code.", "As you can see, it turns out that Random Forest classifier gives us the best performance in 5 out of 7 metrics. Let\u2019s say we want to use F1 score metrics for our wine classifier, then of course Random Forest classifier will give us the best performance.", "Before we go further, let\u2019s see whether we can improve the performance of the models by tuning our setup() function.", "As you can see, we passed several additional parameters there to tune our setup:", "There are a lot of tuning options that you can do inside this setup() function. You can learn more about it here.", "Also note that we use the same session_id as our previous setup() function. This is to make sure that all of the future improvements on the model are solely due to the change that we\u2019ve implemented in this setup() function.", "Let\u2019s compare the models once again with our new setup.", "As you can see, most of the metrics are slightly improved after we tuned the setup. Before we tuned the setup, the F1 score of Extra Tree classifier is 0.8306. After we tuned the setup, the F1 score becomes 0.8375.", "Based on this result, let\u2019s build our Extra Tree classifier. We can do this with a single line of code.", "Next, you can evaluate your model by looking at the visualization of the ROC curve, feature importance, or confusion matrix of your model with also a single line of code.", "As a final check, we can use our Extra Tree classifier to predict the test data that has been generated by PyCaret. As mentioned earlier, soon after we executed the setup() function at the very first step, PyCaret will automatically split our data into training data and test data. All of the model performance and evaluation metrics that we\u2019ve seen above are solely based on the training data.", "To use the model to predict the test data, we can use the predict_model function.", "Finally, let\u2019s save our Extra Tree classifier model.", "And that\u2019s it for model building with PyCaret. After this you should have a pickle file called \u2018extra_tree_model\u2019 in your working directory. We will use this saved model to build a wine classifier web app with Streamlit.", "Now it\u2019s time for us to build our wine classifier web app. In this post, we\u2019re going to use Streamlit to build the web app as it is more beginner friendly than Flask. Plus, you don\u2019t need to have any prior experience with HTML and CSS to use Streamlit.", "If you haven\u2019t installed Streamlit yet, you can do so by typing the following pip command:", "The first thing that we need to do is importing all of the relevant libraries. Note that we\u2019re going to use the Extra Tree classifier model that we\u2019ve saved before using PyCaret. To load the model and to make a prediction using the saved model, we can use load_model and predict_model functions from PyCaret.", "In the code above, we import the libraries, create a function to make a prediction, load the saved model, and create the title and text of our web app.", "Next, we need to let the user to specify the value of our features. Since our features are all numeric features, it will be best to represent them with a slider widget. To create a slider widget, we can use slider() function from Streamlit.", "Note that we passed several parameters to slider() function:", "Next we need to convert all of those user input values into a dataframe. Then, we can use the dataframe as the input of our model\u2019s prediction.", "And that\u2019s it basically! Now your web app is done.", "To check your web app, you need to open your prompt, then go to the working directory of your Python file.", "In the working directory of your Python file, type the following:", "Next, a browser window will pop-up to show you the UI of your web app like the following:", "However, there is still one small problem to solve. Your web app now can only be accessed in your local computer. That means that other people can\u2019t see and use your web app. If you want other people to use your web app, you need to deploy your web app. In this post, I\u2019m going to show you how to deploy your Streamlit web app with Streamlit sharing.", "There are two easy options if you want to deploy your web app: either using Heroku or Streamlit sharing. The problem with Heroku is that if you only have free tier access, they will limit your slug size to around 500MB. Meanwhile, PyCaret itself has a lot of dependencies, which means that the size of your web app will exceed the slug size limit of Heroku.", "Because of that, let\u2019s use Streamlit sharing to deploy the wine classier web app. It\u2019s really easy to deploy your Streamlit web app with Streamlit sharing. Below is the step-by-step on how you can deploy your web app:", "Note that after your web app has been successfully deployed, you\u2019ll see the URL to access your web app with the format as follows:", "You can share this URL to other people so that they can use and play around with your web app.", "You can check the deployed version of wine classifier covered in this article here.", "Also, you can check the complete Notebook and Python file to build the wine classifier web app here.", "And that\u2019s it! Hopefully, this article is somewhat helpful for you.", "I\u2019ve always thought that Heroku would be the easiest available option to deploy your data science web app. However, if you build your web app with Streamlit, then Streamlit sharing would be the easiest and the most convenient way to deploy your web app.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science || Machine Learning || Computer Vision || NLP"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F273d205271a3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----273d205271a3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----273d205271a3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@marcellusruben?source=post_page-----273d205271a3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=post_page-----273d205271a3--------------------------------", "anchor_text": "Ruben Winastwan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5dae9da73c9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&user=Ruben+Winastwan&userId=5dae9da73c9b&source=post_page-5dae9da73c9b----273d205271a3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F273d205271a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F273d205271a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@vlisidis?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Terry Vlisidis"}, {"url": "https://unsplash.com/s/photos/wine?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009", "anchor_text": "download for free here"}, {"url": "https://pycaret.readthedocs.io/en/latest/index.html", "anchor_text": "PyCaret official documentation page."}, {"url": "https://pycaret.readthedocs.io/en/latest/api/classification.html", "anchor_text": "here"}, {"url": "https://www.streamlit.io/sharing", "anchor_text": "this page"}, {"url": "https://share.streamlit.io/", "anchor_text": "this page"}, {"url": "https://share.streamlit.io/marcellusruben/wine-classifier/main/app.py", "anchor_text": "here"}, {"url": "https://github.com/marcellusruben/Wine-Classifier/tree/main", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----273d205271a3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----273d205271a3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deployment?source=post_page-----273d205271a3---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/tag/web-app-development?source=post_page-----273d205271a3---------------web_app_development-----------------", "anchor_text": "Web App Development"}, {"url": "https://medium.com/tag/python?source=post_page-----273d205271a3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F273d205271a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&user=Ruben+Winastwan&userId=5dae9da73c9b&source=-----273d205271a3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F273d205271a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&user=Ruben+Winastwan&userId=5dae9da73c9b&source=-----273d205271a3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F273d205271a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----273d205271a3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F273d205271a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----273d205271a3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----273d205271a3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----273d205271a3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----273d205271a3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----273d205271a3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----273d205271a3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----273d205271a3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----273d205271a3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----273d205271a3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@marcellusruben?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ruben Winastwan"}, {"url": "https://medium.com/@marcellusruben/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "925 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5dae9da73c9b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&user=Ruben+Winastwan&userId=5dae9da73c9b&source=post_page-5dae9da73c9b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F46c6747bd93b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3&newsletterV3=5dae9da73c9b&newsletterV3Id=46c6747bd93b&user=Ruben+Winastwan&userId=5dae9da73c9b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}