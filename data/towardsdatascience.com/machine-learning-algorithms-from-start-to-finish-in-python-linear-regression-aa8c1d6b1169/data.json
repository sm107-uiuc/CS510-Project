{"url": "https://towardsdatascience.com/machine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169", "time": 1683015260.046986, "path": "towardsdatascience.com/machine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169/", "webpage": {"metadata": {"title": "Machine Learning Algorithms from Start to Finish in Python: Linear Regression | by Vagif Aliyev | Towards Data Science", "h1": "Machine Learning Algorithms from Start to Finish in Python: Linear Regression", "description": "Probably one of the most common algorithms around, Linear Regression is a must know for Machine Learning Practitioners. This is usually a beginner\u2019s first exposure to a real Machine Learning\u2026"}, "outgoing_paragraph_urls": [{"url": "http://photo%20by%20analytics%20vidhya/", "anchor_text": "blogpost", "paragraph_index": 34}, {"url": "https://github.com/Vagif12/ML-Algorithms-From-Scratch/blob/main/Linear%20Regression%20from%20Scratch.py", "anchor_text": "this", "paragraph_index": 37}, {"url": "http://Upword.ai", "anchor_text": "Upword.ai", "paragraph_index": 60}], "all_paragraphs": ["Probably one of the most common algorithms around, Linear Regression is a must know for Machine Learning Practitioners. This is usually a beginner\u2019s first exposure to a real Machine Learning algorithm, and knowing how it operates on a deeper level is crucial to gain a better understanding of it.", "So, briefly, let\u2019s break down the real question; What really is Linear Regression?", "Linear Regression is a supervised learning algorithm that aims at taking a linear approach at modelling the relation between a dependent variable and an independent variable. In other words, It aims to fit a linear trendline that best captures the relationship of the data, and, from this line, it can predict what the target values may be.", "Great, I know the definition, but how does it really work? Great question! In order to answer the question, let\u2019s run through a step by step process of how Linear Regression really operates:", "This method of fitting a line is known as Least Squares.", "Note: Feel free to skip this part, as it unfortunately does contain some bizarre-looking LaTeX. However, if you want to really understand what is going on, I suggest to risk it for a biscuit and continue reading!", "The Linear Regression algorithm is the following:", "The following algorithm will basically do the following:", "This is your target vector and will be used to later evaluate your data(more on that later).", "2. Take in a matrix X(the features of the data):", "This is your data\u2019s features, i.e Age, Gender, Sex, Height, etc. This is the data that the algorithm will actually use to make predictions. Note how there is a feature x0. This is called your intercept term and is always equal to 1.", "3. Take is a vector of weights, and transpose them:", "This is the magic bit of the algorithm. All your feature vectors will get multiplied by these weights. This is known as a dot product. Essentially, you will be trying to find the best combination of these values for a given dataset. This is known as optimisation.", "4. And get a vector of outputs:", "This is the prediction vector that is outputted from your data. You can then use this to evaluate your model\u2019s performance by using a cost function.", "This is essentially the whole algorithm denoted mathematically. Now you should have a solid understanding of how Linear Regression functions. But the question is, what is an optimisation algorithm? and how do we pick the optimal weights? and how do we evaluate the performance?", "A cost function is essentially a formula that measures the loss, or the \u201ccost\u201d of your model. If you have ever done any Kaggle competitions, you may have come across some of them. A few common ones include:", "These functions are essential to model training and development as they answer the fundamental question of \u201chow well is my model predicting new instances?\u201d. Keep this in mind, as this ties in with our next topic.", "Optimisation is usually defined as the process of improving something so that it operates at its full potential. This is also applicable in Machine Learning. In the world of ML, optimisation is essentially trying to find the best combination of parameters for a certain dataset. This is essentially the \u201clearning\u201d bit of Machine Learning.", "While may optimisation algorithms exist, I will discuss two of the most common ones: Gradient Descent and The Normal Equation.", "Gradient Descent is an optimisation algorithm that aims to find the minimum of a function. It achieves this goal by iteratively taking steps in the negative direction of the slope. In our example, gradient descent would continuously update the weights by moving in the slope of the tangential line to the function. Well fantastic, sound great. English please? :)", "To better illustrate Gradient Descent, Let\u2019s go through a simple example. Imagine a human is at the top of a mountain, and he/she want to get to the bottom. What they might do is look around and see in what direction they should take a step in in order to get down quicker. Then, they might take a step in that direction and now they are closer to their goal. However, they have to be careful when coming down as they might get stuck at a certain point, so we have to make sure to choose our step sizes accordingly.", "Similarly, The objective of gradient descent is to minimise a function. In our case, it is to minimise the cost of our model. It does this by finding the tangential line to the function and moving in that direction. The size of the \u201cstep\u201d of the algorithm is defined by what is known as a learning rate. This essentially controls how far we move down. With this parameter, we have to be careful of two cases:", "We also have a parameter that controls the number of times the algorithm iterates over the dataset.", "Visually, the algorithm would do something like this:", "Because this algorithm is so essential to Machine Learning, let\u2019s recap what it does:", "Now that you have been introduced to Gradient Descent, let\u2019s introduce the Normal Equation.", "If we were to go back to our example, instead of taking steps iteratively down the mountain, we would be able to immediately get to the bottom. This is the case with the Normal Equation. It leverages linear algebra to produce weights that can produce results just as well as Gradient Descent would, in a fraction of the time.", "Whew, a lot to take in! I suggest you take a break and grab a quick coffee before moving on :)", "This is an important preprocessing step of many Machine Learning Algorithms, especially those that use distance metrics and calculations(like Linear Regression and Gradient Descent). It essentially scales our features so that they are in a similar range. Think of it like a house, and a scaled model of a house. The shape of both are the same(they are both houses), but the size is different(5m != 500m). We do this for the following reasons:", "To demonstrate this, let\u2019s suppose we have three features, named A, B and C:", "Distance of BC before scaling =>", "Distance of AB after scaling =>", "Distance of BC after scaling =>", "We can clearly see that the features are much more comparable and unbiased than they were before scaling. If you want a great tutorial on feature scaling, please check out this blogpost by Analytics Vidhya.", "Whew! That is a lot of information to take in. So, I suggest you take a break, grab a coffee, enjoy life, and when you feel, ready, you can dive in to actually coding this algorithm from scratch.", "Ok, now the moment you have been waiting for; the implementation! Without further ado, let\u2019s begin!", "Note: all the code can be downloaded from this Github repo. However, I recommend you to follow along the tutorial before you do so, because then you will gain a better understanding of what you are actually coding!", "First, let\u2019s do some basic imports:", "Yep, that\u2019s all the imports! All we are using is numpy for the mathematical implementation, matplotlib to plot graphs, and the boston dataset from scikit-learn.", "Next, let\u2019s load our data and define our features and our labels:", "Next, let\u2019s create a custom train_test_split function to split our data into a training and test set:", "We will implement MSE, or Mean Squared Error, a common cost function used for regression tasks:", "In order to make clean, repeatable and efficient code, as well as adhere to software development practices, we will make create a Linear Regression class:", "We will now create a method to add an intercept term:", "We will now scale our features:", "Next, we will randomly initialise the weights:", "We will now code the normal equation from scratch using the following formula:", "Essentially, we split the algorithm into 3 parts:", "So, that\u2019s the Normal Equation! Not too bad! Now, we will implement Batch Gradient Descent using the following formula:", "Let\u2019s define a fit function to fit our data:", "Here, we just check if the user wants Gradient Descent or not, and do our steps accordingly.", "Let\u2019s Build a function to plot our cost function:", "And finally a method that predicts unlabelled instances:", "Now, let\u2019s see which optimisation produced better results. First, let\u2019s try Gradient Descent:", "Let\u2019s plot our function and see how the cost function decreased and if Gradient Descent converged:", "So we can see that at around 1000 iterations was when it began to converge.", "So we can see that the Normal Equation slightly outperformed Gradient Descent. This could be because the dataset is small and we have not picked the best parameters for the learning rate.", "It\u2019s been really fun writing this, and though it\u2019s a bit long, I hope you have learned something today. Stay tuned and keep reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "19 y/o student ex-founder of Snapstudy (acquired), founding engineer at Upword.ai"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faa8c1d6b1169&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://vagifaliyev.medium.com/?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": ""}, {"url": "https://vagifaliyev.medium.com/?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": "Vagif Aliyev"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6b4e6b48584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&user=Vagif+Aliyev&userId=6b4e6b48584&source=post_page-6b4e6b48584----aa8c1d6b1169---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faa8c1d6b1169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faa8c1d6b1169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@julian_ebert?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Julian Ebert"}, {"url": "https://unsplash.com/s/photos/diagonal?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Linear_regression", "anchor_text": "Wikipedia"}, {"url": "https://unsplash.com/@antoine1003?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Antoine Dautry"}, {"url": "https://unsplash.com/s/photos/math?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@lux17?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Lucas Clara"}, {"url": "https://unsplash.com/s/photos/mountain?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent", "anchor_text": "Wikipedia"}, {"url": "https://unsplash.com/@wildlittlethingsphoto?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Helena Lopes"}, {"url": "https://unsplash.com/s/photos/break?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/", "anchor_text": "Analytics Vidhya"}, {"url": "https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/", "anchor_text": "Analytics Vidhya"}, {"url": "https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/", "anchor_text": "Analytics Vidhya"}, {"url": "https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/", "anchor_text": "Analytics Vidhya"}, {"url": "http://photo%20by%20analytics%20vidhya/", "anchor_text": "blogpost"}, {"url": "https://unsplash.com/@cdr6934?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Chris Ried"}, {"url": "https://unsplash.com/s/photos/code?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/Vagif12/ML-Algorithms-From-Scratch/blob/main/Linear%20Regression%20from%20Scratch.py", "anchor_text": "this"}, {"url": "https://unsplash.com/@jupp?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Jonathan Kemper"}, {"url": "https://unsplash.com/s/photos/bye?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----aa8c1d6b1169---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----aa8c1d6b1169---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----aa8c1d6b1169---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----aa8c1d6b1169---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----aa8c1d6b1169---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faa8c1d6b1169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&user=Vagif+Aliyev&userId=6b4e6b48584&source=-----aa8c1d6b1169---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faa8c1d6b1169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&user=Vagif+Aliyev&userId=6b4e6b48584&source=-----aa8c1d6b1169---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faa8c1d6b1169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faa8c1d6b1169&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----aa8c1d6b1169---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----aa8c1d6b1169--------------------------------", "anchor_text": ""}, {"url": "https://vagifaliyev.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://vagifaliyev.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vagif Aliyev"}, {"url": "https://vagifaliyev.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "209 Followers"}, {"url": "http://Upword.ai", "anchor_text": "Upword.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6b4e6b48584&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&user=Vagif+Aliyev&userId=6b4e6b48584&source=post_page-6b4e6b48584--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6f056d3d77d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-algorithms-from-start-to-finish-in-python-linear-regression-aa8c1d6b1169&newsletterV3=6b4e6b48584&newsletterV3Id=6f056d3d77d3&user=Vagif+Aliyev&userId=6b4e6b48584&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}