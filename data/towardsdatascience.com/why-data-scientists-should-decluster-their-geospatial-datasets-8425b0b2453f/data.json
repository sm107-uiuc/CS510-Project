{"url": "https://towardsdatascience.com/why-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f", "time": 1683017514.148196, "path": "towardsdatascience.com/why-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f/", "webpage": {"metadata": {"title": "Why Data Scientists Should Decluster Their Geospatial Datasets | by Fouad Faraj | Towards Data Science", "h1": "Why Data Scientists Should Decluster Their Geospatial Datasets", "description": "Often times several decisions regarding a site or region are made based on statistical analyses of irregularly scattered geospatial data. The values of variables of interest for different\u2026"}, "outgoing_paragraph_urls": [{"url": "https://link.springer.com/article/10.1007%2FBF01031292", "anchor_text": "1", "paragraph_index": 8}, {"url": "https://www.who.int/news-room/fact-sheets/detail/arsenic", "anchor_text": "guidelines", "paragraph_index": 14}, {"url": "https://github.com/13ff6/CellDeclusteringTutorial.git", "anchor_text": "GitHub repository", "paragraph_index": 15}, {"url": "https://link.springer.com/article/10.1007%2FBF01031292", "anchor_text": "Nonparametric estimation of spatial distributions", "paragraph_index": 34}], "all_paragraphs": ["Often times several decisions regarding a site or region are made based on statistical analyses of irregularly scattered geospatial data. The values of variables of interest for different applications are often impacted differently due to heterogeneities throughout a site. For example, meteorological data such as temperature could be influence by proximity to bodies of water, contaminant concentrations would be linked to directions of groundwater flow, natural resources such as ore, hydrocarbon, or forestry could be tied to the geological mediums in the subsurface.", "If areas with anomalously high or low values for a given variable are sampled disproportionately to the average sampling for other areas in a given site, there will likely be a biased difference in the true distribution for that variable. When surveying a site, the areas that contain these anomalous values are often preferentially sampled because they represent areas of interest that we want to better understand. To avoid the biased difference which arises from preferential sampling, samples should be collected at regular gridded intervals or at random. The figure below illustrates how regular and random sampling does not skew the statistics of a site while biased sampling does.", "The bias from the true mean might be due to the infeasibility of regular or random sampling, or more likely because there are targets of interest which leads to the preferential or biased sampling. This preferential or biased sampling is seen in nearly every industry that collects spatial data, especially within the oil and mining industries. To account for the irregular sampling and bias caused by the heterogeneous site-specific effects on the data, declustering has been established as an essential geostatistical tool for analyzing spatial data.", "Declustering biased geospatial data is important for achieving more representative statistics and better approximating the distribution of a spatial variable for any kind of decision making.", "Although there are various different types of declustering such as polygonal declustering, in this tutorial we will only use cell declustering. Below is a video version of this article explaining the concept of cell declustering in greater detail and a running through the same environmental example presented here.", "Following is an introduction to cell declustering and the next section goes through the simple environmental example in Python.", "Cell declustering is the most common declustering algorithm which uses a predefined cell to assign weights to each sample based on the number of samples in each cell and the area which that cell represents. The cell declustering concept is illustrated in the figure below.", "Throughout the tutorial we will often be referring to either the naive or declustered data which are defined as:", "Note that in this simple tutorial we will be abstracting a lot of the math behind declustering, refer to [1] if you are interested and want to learn more about the theory behind the declustering concepts introduced here.", "The most important input required to run cell declustering is the cell size. Typically the cell size should be equal to the coarsest spacing of samples within a dataset but this can sometimes be difficult to judge.", "Varying the cell size has a big impact on the declustering weight each sample will receive. The figure below illustrates three different cell size scenarios ranging from the smallest possible to an adequate size and finally the largest cell size possible. Using either the smallest cell size where each cell is composed or one sample or the largest cell size where one big cell contains all the samples results in the same outcome.", "The best approach for choosing an appropriate cell size is by assessing the declustered mean for various cell sizes and choosing a value which is close to minimizing or maximizing the declustered mean. The figure below illustrates how the declustered mean varies with increasing cell size. Whether the declustered mean increases or decreases from the naive mean will depend on if the clustered, biased samples are greater than or less than the naive mean. The most appropriate cell size is often somewhere near where the declustered mean is maximized or minimized.", "Another important parameter for cell declustering is defining the number of cell offsets. Since the origin of the declustering cells will impact the declustering weight each sample receives, various random origins are used to provide an average weight to each sample. The figure below shows an example of using three and nine random origins. Typically, anywhere from 25 to 100 random origins are used in practice but this depends on the complexity of the dataset.", "After defining the cell size and number of cell offsets, cell declustering can be run to assign each sample a declustering weight.", "The dataset we are going to use is a synthetic arsenic contaminant dataset consisting of 153 groundwater samples scattered in 2D space measuring concentrations of arsenic measured in \u03bcg/L. The World Health Organization (WHO) guidelines state that arsenic concentrations for drinking water should not exceed 10 \u03bcg/L so we will analyze the dataset and verify that the average arsenic concentration is below the healthy limit so that it is safe to drink.", "The script and dataset used in this example are available in this GitHub repository.", "We are eventually going to use the geostatspy library which can be downloaded by entering the line below in the terminal.", "In addition to geostatspy, we will also make use of three standard python libraries which we can import as shown below.", "Now we can load our data into a pandas data frame which we can do by running the code below.", "The above code also gives us an initial look into the dataset to see how it is formatted as shown in the following output.", "We can visualize the dataset using numpy and matplotlib, the figure below shows a plot of all the samples and their arsenic concentration. The clusters of high arsenic concentration in the northwest and southeast are clear signs of preferential sampling which was probably done in an attempt to delineate these anomalous areas of interest.", "Taking the mean of these samples results in an arsenic concentration of 12.60 \u03bcg/L which is above the WHO guidelines for healthy drinking water but this may be an artifact of the biased sampling. Next, we will decluster the dataset to see if we can achieve a more accurate or representative mean.", "We can run the declustering by using the geostatspy package we installed earlier, but there are a few parameters here which require the cell declustering inputs:", "In this example, we will use 200 cells interpolated from 1 m to 750 m and 25 random cell offsets. Also, since our biased clusters are higher than the naive arsenic mean, we will set iminmax equal to 1 so that the weights we obtain use the cell size that minimizes the declustered mean. The declustering code can be seen below.", "We have also set three variable outputs which are:", "Let\u2019s take a look at the declustered means for the tested cell sizes by plottingCsize against Dmean from the above code.", "The weights which are saved are those that achieved the minimum declustered mean. Below is a plot of the samples showing the declustering weights and allowing us to visually check if the sample clusters have a smaller weight compared to the far off samples representing larger amounts of area. As we expect and is shown in the figure below, the sample clusters have smaller weights while samples with fewer points close by have higher weights.", "When performing any kind of statistical analysis, incroporating the declustering weights will yield more representative statistics compared to the naive data. Since locations with higher concentrations of arsenic were oversampled, we expect the declustered statistics to reduce the number of high arsenic samples in our data. The histograms below show how the declustered arsenic accounts for this bias as the counts of lower arsenic concentrations are higher than the naive arsenic thus correcting the bias and achieving more representative statistics.", "It is important to note that the actual values of the samples do not change, this can be observed when comparing the minimum and maximum arsenic concentration of the naive and declustered data as they are the same. The weights control the frequency of each sample. For example, a sample with a value of 5 and a weight of 2 when declustered would be the same as two samples with a value of 5, not one sample with a value of 10. This is why we see differences in statistical parameters such as the quantiles and mean but not the minimum and maximum as shown in the table below.", "As shown in the table above, the mean arsenic concentration for the naive data is 12.60 \u03bcg/L which is over the WHO guidelines. The mean arsenic concentration for the declustered data is only 8.82 \u03bcg/L which is considered safe drinking water by the WHO guidelines. By incorporating declustering to account for the biased sampling in the dataset, money that would have been spent remediating this site can now go elsewhere as there is no threat due to arsenic contamination.", "Declustering is a crucial step when conducting any form of spatial data analysis in which the samples have been preferentially sampled. Currently, scientists and engineers who are unfamiliar with analyzing geospatial data may be making mistakes as they are working with the naive data and are not accounting for any kind of biased sampling.", "The cell declustering parameters used will vary significantly depending on the dataset. While there isn\u2019t a perfectly scientific approach for selecting the optimal parameters for cell declustering, an easily applicable workflow was presented for selecting adequate parameters based on what is typically done in practice.", "It is also worth noting that declustering should not be pursued when samples are taken at regular or random intervals as there will be no bias to correct. While regular or random sampling would make spatial data analysis easier, there are several reasons for which geospatial data may be preferentially sampled such as: (1) To better understand anomalous areas of interest, (2) Lack of resources for which to conduct enough sampling, or (3) Inaccessible sites within the survey grid to name a few.", "Although the example presented here was in 2D, the approach is the same for a 3D dataset but will require more sophisticated libraries than the ones used here. A 3D spatial dataset would be comprised of the easting and northing coordinates but samples would also now vary in elevation. If you are curious, below is an article that visualizes a 3D geospatial dataset from the mining industry which would require declustering.", "[1] A. G. Journel, Nonparametric estimation of spatial distributions (1983), Journal of the International Association for Mathematical Geology 15: 445\u2013468.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Geological engineer with interests in geospatial data processing and numerical analysis for applications in the natural resource and environmental industries."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8425b0b2453f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://fouadfaraj.medium.com/?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": ""}, {"url": "https://fouadfaraj.medium.com/?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": "Fouad Faraj"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4554eb44266&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&user=Fouad+Faraj&userId=b4554eb44266&source=post_page-b4554eb44266----8425b0b2453f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8425b0b2453f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8425b0b2453f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/video-tutorial", "anchor_text": "VIDEO TUTORIAL"}, {"url": "https://link.springer.com/article/10.1007%2FBF01031292", "anchor_text": "1"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/arsenic", "anchor_text": "guidelines"}, {"url": "https://github.com/13ff6/CellDeclusteringTutorial.git", "anchor_text": "GitHub repository"}, {"url": "https://towardsdatascience.com/easy-techniques-for-visualizing-3d-subsurface-borehole-data-b497de12b651", "anchor_text": "Easy techniques for visualizing 3D subsurface borehole dataPlotting continuous and categorical geospatial data scattered in a 3D coordinate system, applied on a mining dataset\u2026towardsdatascience.com"}, {"url": "https://link.springer.com/article/10.1007%2FBF01031292", "anchor_text": "Nonparametric estimation of spatial distributions"}, {"url": "https://medium.com/tag/spatial-data-analysis?source=post_page-----8425b0b2453f---------------spatial_data_analysis-----------------", "anchor_text": "Spatial Data Analysis"}, {"url": "https://medium.com/tag/declustering?source=post_page-----8425b0b2453f---------------declustering-----------------", "anchor_text": "Declustering"}, {"url": "https://medium.com/tag/video-tutorial?source=post_page-----8425b0b2453f---------------video_tutorial-----------------", "anchor_text": "Video Tutorial"}, {"url": "https://medium.com/tag/python-tutorial?source=post_page-----8425b0b2453f---------------python_tutorial-----------------", "anchor_text": "Python Tutorial"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----8425b0b2453f---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8425b0b2453f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&user=Fouad+Faraj&userId=b4554eb44266&source=-----8425b0b2453f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8425b0b2453f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&user=Fouad+Faraj&userId=b4554eb44266&source=-----8425b0b2453f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8425b0b2453f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8425b0b2453f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8425b0b2453f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8425b0b2453f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8425b0b2453f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8425b0b2453f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8425b0b2453f--------------------------------", "anchor_text": ""}, {"url": "https://fouadfaraj.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://fouadfaraj.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Fouad Faraj"}, {"url": "https://fouadfaraj.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "177 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb4554eb44266&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&user=Fouad+Faraj&userId=b4554eb44266&source=post_page-b4554eb44266--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdcee2f01c567&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-data-scientists-should-decluster-their-geospatial-datasets-8425b0b2453f&newsletterV3=b4554eb44266&newsletterV3Id=dcee2f01c567&user=Fouad+Faraj&userId=b4554eb44266&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}