{"url": "https://towardsdatascience.com/building-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39", "time": 1683008754.014911, "path": "towardsdatascience.com/building-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39/", "webpage": {"metadata": {"title": "Building a One Hot Encoding Layer with TensorFlow | by George Novack | Towards Data Science", "h1": "Building a One Hot Encoding Layer with TensorFlow", "description": "One Hot Encoding is a common way of preprocessing categorical features for machine learning models. This type of encoding creates a new binary feature for each possible category and assigns a value\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["One Hot Encoding is a common way of preprocessing categorical features for machine learning models. This type of encoding creates a new binary feature for each possible category and assigns a value of 1 to the feature of each sample that corresponds to its original category. It\u2019s easier to understand visually: in the example below, we One Hot Encode a color feature which consists of three categories (red, green, and blue).", "Sci-kit Learn offers the OneHotEncoder class out of the box to handle categorical inputs using One Hot Encoding. Simply create an instance of sklearn.preprocessing.OneHotEncoder then fit the encoder on the input data (this is where the One Hot Encoder identifies the possible categories in the DataFrame and updates some internal state, allowing it to map each category to a unique binary feature), and finally, call one_hot_encoder.transform() to One Hot Encode the input DataFrame. The great thing about the OneHotEncoder class is that, once it has been fit on the input features, you can continue to pass it new samples, and it will encode the categorical features consistently.", "Recently, I was working with some categorical features that were being passed as inputs to a TensorFlow model, so I decided to try and find a \u201cTensorflow-native\u201d way of One Hot Encoding.", "After a lot of searching, I mostly came across two suggestions for how to do this:", "We already know it works, and One Hot Encoding is One Hot Encoding right, so why bother doing it with TensorFlow?", "While this is a valid suggestion that works well for simple examples and demonstrations, it can lead to some complications in scenarios where you plan to deploy your model as a service so that it can perform inference in a production environment.", "To take a step back, one of the big benefits of using OneHotEncoder with Sci-kit Learn models is that you can include it, along with the model itself, as a step in a Sci-kit Learn Pipeline, essentially bundling One Hot Encoding (and potentially other preprocessing) logic and inference logic as a single deployable artifact.", "So back to our TensorFlow scenario: if you were to use OneHotEncoder to preprocess input features for a TensorFlow model, you would have some additional complexity to deal with, because you would either have to:", "This was the other suggestion I came across. The tf.one_hot operation takes a list of category indices and a depth (for our purposes, essentially a number of unique categories), and outputs a One Hot Encoded Tensor.", "You\u2019ll notice a few key differences though between OneHotEncoder and tf.one_hot in the example above.", "So, in order to include One Hot Encoding logic as part of a TensorFlow model, we\u2019ll need to create a custom layer that converts string categories into category indices, determines the number of unique categories in our input data, then uses the tf.one_hot operation to One Hot Encode the categorical features. We\u2019ll do all of this next.", "The first order of business is to convert string categories into integer indexes in a way that converts the categories consistently (e.g. the string blue should always be converted to the same index).", "The experimental TextVectorization layer can be used to standardize and tokenize sequences of strings, such as sentences, but for our use case, we\u2019ll simply convert individual string categories into integer indices.", "We specify output_sequence_length=1 when creating the layer because we only want a single integer index for each category passed into the layer. Calling the adapt() method fits the layer to the dataset, similar to calling fit() on the OneHotEncoder . After the layer has been fit, it maintains an internal vocabulary of unique categories and maps them consistently to integer indices. You can view the layer\u2019s vocabulary by calling get_vocabulary() after it has been fit.", "Finally, we can now create the Class that will represent a One Hot Encoding Layer in a neural network.", "The class inherits from PreprocessingLayer so that it inherits the base adapt() method. When this layer is initialized, a TextVectorization layer is also initialized, and when adapt() is called, the TextVectorization is fit on the input data, and two class attributes are set:", "The get_config() method allows TensorFlow to save the state of the layer when the model is saved to disk. The values from the layer\u2019s config will be passed to the layer\u2019s __init__() method when the model is loaded into memory. Notice that we\u2019re explicitly setting the vocabulary, depth, and minimum whenever these values are passed in.", "Now we can try the new layer out in a simple Neural Network.", "This simple network just accepts a categorical input, One Hot Encodes it, then concatenates the One Hot Encoded features with the numeric input feature. Notice I\u2019ve added a numeric id column to the DataFrame to illustrate how to split categorical inputs from numeric inputs.", "And that\u2019s it! We now have a working Neural Network layer that can One Hot Encode categorical features! We can also save this model as a JSON config file, deploy it, and reload it into memory to perform inference. Notice that it One Hot Encodes the color category in the same way as before, so we know that the subsequent layers of our model will be provided the same features in the same order as they appeared during training.", "Thanks for reading! Feel free to leave any questions or comments below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff907d686bf39&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f907d686bf39--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f907d686bf39--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://gnovack.medium.com/?source=post_page-----f907d686bf39--------------------------------", "anchor_text": ""}, {"url": "https://gnovack.medium.com/?source=post_page-----f907d686bf39--------------------------------", "anchor_text": "George Novack"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76cce7566b5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&user=George+Novack&userId=76cce7566b5e&source=post_page-76cce7566b5e----f907d686bf39---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff907d686bf39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff907d686bf39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/gnovack/tf-one-hot-encoder/blob/master/OneHotEncoderLayer.ipynb", "anchor_text": "https://github.com/gnovack/tf-one-hot-encoder/blob/master/OneHotEncoderLayer.ipynb"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/one_hot?hl=en", "anchor_text": "https://www.tensorflow.org/api_docs/python/tf/one_hot?hl=en"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/layers/experimental/preprocessing/TextVectorization?hl=en", "anchor_text": "https://www.tensorflow.org/api_docs/python/tf/keras/layers/experimental/preprocessing/TextVectorization?hl=en"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----f907d686bf39---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/maching-learning?source=post_page-----f907d686bf39---------------maching_learning-----------------", "anchor_text": "Maching Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----f907d686bf39---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/one-hot-encoding?source=post_page-----f907d686bf39---------------one_hot_encoding-----------------", "anchor_text": "One Hot Encoding"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff907d686bf39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&user=George+Novack&userId=76cce7566b5e&source=-----f907d686bf39---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff907d686bf39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&user=George+Novack&userId=76cce7566b5e&source=-----f907d686bf39---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff907d686bf39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f907d686bf39--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff907d686bf39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f907d686bf39---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f907d686bf39--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f907d686bf39--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f907d686bf39--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f907d686bf39--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f907d686bf39--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f907d686bf39--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f907d686bf39--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f907d686bf39--------------------------------", "anchor_text": ""}, {"url": "https://gnovack.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://gnovack.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "George Novack"}, {"url": "https://gnovack.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "136 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76cce7566b5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&user=George+Novack&userId=76cce7566b5e&source=post_page-76cce7566b5e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc5cf182bbc89&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39&newsletterV3=76cce7566b5e&newsletterV3Id=c5cf182bbc89&user=George+Novack&userId=76cce7566b5e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}