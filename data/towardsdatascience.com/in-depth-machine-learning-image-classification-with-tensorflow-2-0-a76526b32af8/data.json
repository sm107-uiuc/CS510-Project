{"url": "https://towardsdatascience.com/in-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8", "time": 1683005161.146688, "path": "towardsdatascience.com/in-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8/", "webpage": {"metadata": {"title": "(In-depth) Machine Learning Image Classification With TensorFlow | by Richmond Alake | Towards Data Science", "h1": "(In-depth) Machine Learning Image Classification With TensorFlow", "description": "This is going to be a lengthy article since I go into great detail in regard to the components and processes that are integral to the implementation of an image classification neural network. This\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Frank_Rosenblatt", "anchor_text": "Frank Rosenblatt", "paragraph_index": 10}, {"url": "http://proceedings.mlr.press/v9/glorot10a/glorot10a.pdf", "anchor_text": "paper", "paragraph_index": 32}, {"url": "https://en.wikipedia.org/wiki/Early_stopping", "anchor_text": "early stopping", "paragraph_index": 44}, {"url": "https://keras.io/models/model/#fit", "anchor_text": "Keras documentation", "paragraph_index": 47}, {"url": "https://amzn.to/2wvuowj", "anchor_text": "Hands-On Machine Learning With Scikit-Learn, Keras & TensorFlow", "paragraph_index": 65}], "all_paragraphs": ["This is going to be a lengthy article since I go into great detail in regard to the components and processes that are integral to the implementation of an image classification neural network.", "Feel free to take some breaks, or even skip directly to sections with code.", "This article aims to present practical implementation skills, accompanied by explanations into terms and terminologies involved in machine learning development.", "The content of this article is intended for beginners and intermediate machine learning practitioners.", "Neural networks solve a variety of tasks, such as classification, regression, and plenty more.", "This article examines the process involved in developing a simple neural network for image classification.", "An exploration into the following will be conducted:", "Image classification is a task that is associated with multi-label assignments.", "It involves the extraction of information from an image and then associating the extracted information to one or more class labels. Image classification within the machine learning domain can be approached as a supervised learning task.", "But before we go further, an understanding of a few fundamental terms and the tools and libraries that are utilized are required to understand the implementation details properly", "A Perceptron is a fundamental component of an artificial neural network, and it was invented by Frank Rosenblatt in 1958. A perceptron utilizes operations based on the threshold logic unit.", "Perceptrons can be stacked in single layers format, which is capable of solving linear functions. Multilayer perceptrons are capable of solving even more complex functions and have greater processing power.", "A Multilayer perceptron (MLP) is several layers of perceptrons stacked consecutively one after the other. The MLP is composed of one input layer, and one or more layers of TLUs called hidden layers, and one final layer referred to as the output layer.", "The Fashion-MNIST dataset consists of images of clothing (T-shirts, Trousers, Dresses and more) that originate from Zalando\u2019s image directory. Zalando is a European e-commerce company founded in 2008.", "The researchers in Zalando have created the Fashion-MNIST dataset that contains 70,000 images of clothing. More specifically, it contains 60,000 training examples and 10,000 testing examples, that are all grayscale images with the dimension 28 x 28 categorized into 10 classes.", "The classes correspond to what item of clothing is present in the image. For example, an image of an ankle boot corresponds to the numeric label \u20189\u2019.", "The Keras library has a suite of datasets readily available for use with easy accessibility.", "60,000 training labels, each label corresponding to an item of clothing, for example, the label 9 corresponds to Ankle boots", "Before we proceed, we have to normalize the training image pixel values to values within the range 0 and 1. This is done by dividing each pixel value within the train and test images by 255.", "Below are the class names the images in the fashionMNIST dataset corresponds to.", "The validation partitions of the dataset are derived from the training dataset. 5000 images and labels will be utilized for validation purposes.", "Here is an example of a corresponding clothing name identified with a specific index position.", "Keras provides tools required to implement the classification model. Keras presents a Sequential API for stacking layers of the neural network on top of each other.", "The classification network is a shallow network with 3 hidden layers, an input layer, and 1 output layer. The input layer is built using the \u2018Flatten\u2019 constructor that takes in the input shape as its arguments, in this case [28,28].", "Each image input data is converted or flattened into a 1D array. The Dense layers have a defined number of neurons/units, and the amount of units is passed in as the first argument. Each dense layer also has a second argument that takes in the activation function to be utilized within each layer.", "The first three layers use the ReLU activation function, while the last layer uses a softmax activation.", "A visual statistical summary of the model implemented above is obtainable by calling the \u2018summary\u2019 method available on our model. By calling the summary method, we gain information on the model properties such as layers, layer type, shapes, number of weights in the model, and layers.", "Each layer in the model as a number of perceptrons and each layer has a set of attributed weights and biases.", "The model\u2019s weights initialized randomly. The weights values within the network are initialized using a glorot uniform initializer, which turns out to be the default initializer for Dense layers in Keras.", "The value used to determine the distribution range is derived from the formula:", "\u2018fan_in\u2019 is the number input to layer.", "\u2018fan_out\u2019 is the number of neurons within the layer.", "More information is provided in the official research paper.", "Keras provides the \u2018compile\u2019 method through the model object we have instantiated earlier. The compile function enables the actual building of the model we have implemented behind the scene with some additional characteristics such as the loss function, optimizer, and metrics.", "To train the network, we utilize a loss function that calculates the difference between the predicted values provided by the network and actual values of the training data.", "The loss values accompanied by an optimizer algorithm facilitates the number of changes made to the weights within the network. Supporting factors such as momentum and learning rate schedule, provide the ideal environment to enable the network training to converge, herby getting the loss values as close to zero as possible.", "In a visualization exercise, the function to be solved can be depicted as a hyperbolic curve in n-dimensional parameter space.", "The learning rate is a component that affects the step size that the current parameter values take towards a local/global minima; hence the learning rate directly affects the rate of convergence of a network during training. If the learning rate is too small the network might take several iterations and epochs to converge. On the other hand, if the learning rate is too high, there is a risk of overshooting the minima, and as a result of this our training doesn\u2019t converge. Selecting the appropriate learning rate can be a time staking exercise.", "For more information on gradient descent, refer to the article below:", "TensorBoard provides visual insights into the events that occur during training at each epoch.", "The training visualization provided by TensorBoard is stored in a \u2018runs\u2019 folder directory. We create a function to generate a folder directory and identify each log via a timestamp.", "The Model\u2019s functional API \u2018fit\u2019 method provides the tools to train the implemented network.", "Passing specific arguments into the fit function:", "We\u2019ll also utilize the \u2018callbacks\u2019 argument, which in this instance, calls the TensorBoard callback created.", "The default batch size within Keras when training a neural network is 32. The network is trained for a total of 60 epochs. With the utilization of early stopping, a halt to training is made once no improvement in the validation loss is recorded after 3 epochs. Early stopping can save you hours, especially in the scenario where your network begins to overfit and stops converging.", "In summary, we train the model for a maximum of 60 epochs, where we feed forward all our training data in batches of 32 (batch size) through the network at each epoch.", "An update is made to our network\u2019s weights parameters after it\u2019s seen 32 training images and labels.", "The \u2018fit\u2019 method takes additional arguments that are in the official Keras documentation.", "To run TensorBoard, place the command below in your terminal, and navigate to localhost:6006.", "To evaluate a model requires feed-forwarding through the network data that hasn\u2019t been exposed to the network during training.", "Evaluation of the model before actual utilization is a good indicator of observing how well the model can generalize to unseen data.", "With the evaluation results, you can decide either to fine-tune the network hyperparameters or move forward to production after observing the accuracy of the evaluation over the test dataset.", "To make predictions with the trained model, 5 images from our test dataset are used to emulate real-life scenario-based testing.", "By using the \u2018predict\u2019 method made available through our trained model, we can pass in the batch of practical test images to our model and extract the probability vector for each image.", "The probability vector contains 10 elements, and each element in the vector corresponds to the likelihood of the occurrence of a class from the 10 pieces of clothing classes defined earlier.", "We can create a function to loop through each vector and obtain the highest confidence score, which corresponds to the class that our model predicts the image belongs to.", "Another method we can utilize to gain the classes each image corresponds to is to leverage the \u2018predit_classes\u2019 method.", "The \u2018predict_classes\u2019 method provides a 1-dimensional vector or an array containing the classes each of the images corresponds to.", "Let\u2019s visualize the images within the practical_test_images and the predicted classes from the model.", "The last step involves saving our model for future use.Saving a trained TensorFlow model involves the calling of the \u2018save\u2019 function on the model itself.", "Using a saved model is achievable by calling the \u2018load_model\u2019 function made available via the Keras.models API.", "Through this article we have done the following:", "Following on from here you can explore more neural network architectures you can implement or dive into the TensorFlow and Keras library.", "Below is a link to a GitHub repository that includes all code presented in this article.", "Also below is a book I highly recommend in order to gain a good understanding of practical machine learning. Many readers will probably be familiar with this book or its previous edition", "Hands-On Machine Learning With Scikit-Learn, Keras & TensorFlow", "To connect with me or find more content similar to this article, do the following:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Content Creator with 1M+ views\u2014 Computer Vision Engineer. Interested in gaining and sharing knowledge on Technology and Finance"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa76526b32af8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a76526b32af8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a76526b32af8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://richmondalake.medium.com/?source=post_page-----a76526b32af8--------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=post_page-----a76526b32af8--------------------------------", "anchor_text": "Richmond Alake"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88797ba3f2f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&user=Richmond+Alake&userId=88797ba3f2f6&source=post_page-88797ba3f2f6----a76526b32af8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa76526b32af8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa76526b32af8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@arifriyanto?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Arif Riyanto"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Frank_Rosenblatt", "anchor_text": "Frank Rosenblatt"}, {"url": "https://missinglink.ai/", "anchor_text": "Perceptron image from missinglink.ai"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas"}, {"url": "https://matplotlib.org/", "anchor_text": "Matplotlib"}, {"url": "https://numpy.org/", "anchor_text": "Numpy"}, {"url": "http://proceedings.mlr.press/v9/glorot10a/glorot10a.pdf", "anchor_text": "paper"}, {"url": "https://towardsdatascience.com/understanding-gradient-descent-and-its-variants-cf0df5c45478", "anchor_text": "Understanding Gradient Descent And Its VariantsGain a brief understanding of how the learning process in machine learning models are supported by optimization\u2026towardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Early_stopping", "anchor_text": "early stopping"}, {"url": "https://keras.io/models/model/#fit", "anchor_text": "Keras documentation"}, {"url": "https://github.com/RichmondAlake/tensorflow_2_tutorials/blob/master/02_image_classification_fashionmnist.ipynb", "anchor_text": "RichmondAlake/tensorflow_2_tutorialsPermalink Dismiss GitHub is home to over 40 million developers working together to host and review code, manage\u2026github.com"}, {"url": "https://amzn.to/2wvuowj", "anchor_text": "Hands-On Machine Learning With Scikit-Learn, Keras & TensorFlow"}, {"url": "https://www.youtube.com/channel/UCNNYpuGCrihz_YsEpZjo8TA", "anchor_text": "YouTube channel"}, {"url": "https://www.youtube.com/channel/UCNNYpuGCrihz_YsEpZjo8TA", "anchor_text": "here"}, {"url": "https://medium.com/@richmond.alake", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/richmondalake/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a76526b32af8---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a76526b32af8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----a76526b32af8---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a76526b32af8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a76526b32af8---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa76526b32af8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&user=Richmond+Alake&userId=88797ba3f2f6&source=-----a76526b32af8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa76526b32af8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&user=Richmond+Alake&userId=88797ba3f2f6&source=-----a76526b32af8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa76526b32af8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a76526b32af8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa76526b32af8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a76526b32af8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a76526b32af8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a76526b32af8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a76526b32af8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a76526b32af8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a76526b32af8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a76526b32af8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a76526b32af8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a76526b32af8--------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://richmondalake.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Richmond Alake"}, {"url": "https://richmondalake.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88797ba3f2f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&user=Richmond+Alake&userId=88797ba3f2f6&source=post_page-88797ba3f2f6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F366f35b0b39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fin-depth-machine-learning-image-classification-with-tensorflow-2-0-a76526b32af8&newsletterV3=88797ba3f2f6&newsletterV3Id=366f35b0b39b&user=Richmond+Alake&userId=88797ba3f2f6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}