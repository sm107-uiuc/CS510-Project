{"url": "https://towardsdatascience.com/building-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b", "time": 1682994377.504394, "path": "towardsdatascience.com/building-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b/", "webpage": {"metadata": {"title": "Building and Testing Recommender Systems With Surprise, Step-By-Step | by Susan Li | Towards Data Science", "h1": "Building and Testing Recommender Systems With Surprise, Step-By-Step", "description": "Recommender systems are one of the most common used and easily understandable applications of data science. Lots of work has been done on this topic, the interest and demand in this area remains very\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Recommender_system", "anchor_text": "Recommender systems", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Collaborative_filtering", "anchor_text": "collaborative filtering", "paragraph_index": 1}, {"url": "https://www.analyticsvidhya.com/blog/2015/08/beginners-guide-learn-content-based-recommender-systems/", "anchor_text": "content-based recommendations", "paragraph_index": 1}, {"url": "http://www2.informatik.uni-freiburg.de/~cziegler/BX/", "anchor_text": "Book-Crossing", "paragraph_index": 2}, {"url": "http://surpriselib.com/", "anchor_text": "Surprise library", "paragraph_index": 2}, {"url": "http://nicolas-hug.com/", "anchor_text": "Nicolas Hug", "paragraph_index": 2}, {"url": "http://nbviewer.jupyter.org/github/NicolasHug/Surprise/blob/master/examples/notebooks/KNNBasic_analysis.ipynb", "anchor_text": "notebook", "paragraph_index": 14}, {"url": "https://surprise.readthedocs.io/en/stable/index.html", "anchor_text": "Surprise", "paragraph_index": 18}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Building%20Recommender%20System%20with%20Surprise.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 18}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Building%20Recommender%20System%20with%20Surprise.ipynb", "anchor_text": "Github", "paragraph_index": 18}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/", "paragraph_index": 20}], "all_paragraphs": ["Recommender systems are one of the most common used and easily understandable applications of data science. Lots of work has been done on this topic, the interest and demand in this area remains very high because of the rapid growth of the internet and the information overload problem. It has become necessary for online businesses to help users to deal with information overload and provide personalized recommendations, content and services to them.", "Two of the most popular ways to approach recommender systems are collaborative filtering and content-based recommendations. In this post, we will focus on the collaborative filtering approach, that is: the user is recommended items that people with similar tastes and preferences liked in the past. In another word, this method predicts unknown ratings by using the similarities between users.", "We\u2019ll be working with the Book-Crossing, a book ratings data set to develop recommendation system algorithms, with the Surprise library, which was built by Nicolas Hug. Let\u2019s get started!", "The Book-Crossing data comprises three tables, we will use two of them: The users table and the book ratings table.", "We can see that over 62% of all ratings in the data are 0, and very few ratings are 1 or 2, or 3, low rating books mean they are generally really bad.", "Most of the books in the data received less than 5 ratings, and very few books have many ratings, although the most rated book has received 2,502 ratings.", "Most of the users in the data gave less than 5 ratings, and not many users gave many ratings, although the most productive user have given 13,602 ratings.", "I\u2019m sure you have noticed that the above two plots share the same distribution. The number of ratings per book and the number of ratings per user decay exponentially.", "To reduce the dimensionality of the data set, and avoid running into \u201cmemory error\u201d, we will filter out rarely rated books and rarely rating users.", "To load a data set from the above pandas data frame, we will use the load_from_df() method, we will also need a Reader object, and the rating_scale parameter must be specified. The data frame must have three columns, corresponding to the user ids, the item ids, and the ratings in this order. Each row thus corresponds to a given rating.", "With the Surprise library, we will benchmark the following algorithms:", "We use \u201crmse\u201d as our accuracy metric for the predictions.", "BaselineOnly algorithm gave us the best rmse, therefore, we will train and predict with BaselineOnly and use Alternating Least Squares (ALS).", "We use the train_test_split() to sample a trainset and a testset with given sizes, and use the accuracy metric of rmse. We\u2019ll then use the fit() method which will train the algorithm on the trainset, and the test() method which will return the predictions made from the testset.", "To inspect our predictions in details, we are going to build a pandas data frame with all the predictions. The following code were largely taken from this notebook.", "The above are the best predictions, and they are not lucky guesses. Because Ui is anywhere between 25 to 146, they are not really small, meaning that significant number of users have rated the target book.", "The worst predictions look pretty surprise. Let\u2019s look in more details of the last one ISBN \u201c055358264X\u201d. The book was rated by 47 users, user \u201c26544\u201d rated 10, our BaselineOnly algorithm predicts this user would rate 0.", "It turns out, most of the ratings this book received was 0, in another word, most of the users in the data rated this book 0, only very few users rated 10. Same with the other predictions in \u201cworst predictions\u201d list. It seems that for each prediction, the users are some kind of outsiders.", "That was it! I hope you enjoyed the recommendation (or rather, a rating prediction) journey with Surprise. Jupyter notebook can be found on Github. Happy Holidays!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Changing the world, one post at a time. Sr Data Scientist, Toronto Canada. https://www.linkedin.com/in/susanli/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd4ba702ef80b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://actsusanli.medium.com/?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": "Susan Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a----d4ba702ef80b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4ba702ef80b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4ba702ef80b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Recommender_system", "anchor_text": "Recommender systems"}, {"url": "https://en.wikipedia.org/wiki/Collaborative_filtering", "anchor_text": "collaborative filtering"}, {"url": "https://www.analyticsvidhya.com/blog/2015/08/beginners-guide-learn-content-based-recommender-systems/", "anchor_text": "content-based recommendations"}, {"url": "http://www2.informatik.uni-freiburg.de/~cziegler/BX/", "anchor_text": "Book-Crossing"}, {"url": "http://surpriselib.com/", "anchor_text": "Surprise library"}, {"url": "http://nicolas-hug.com/", "anchor_text": "Nicolas Hug"}, {"url": "http://papers.nips.cc/paper/3208-probabilistic-matrix-factorization.pdf", "anchor_text": "Probabilistic Matrix Factorization"}, {"url": "https://arxiv.org/abs/cs/0702144", "anchor_text": "SlopeOne algorithm"}, {"url": "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.113.6458&rep=rep1&type=pdf", "anchor_text": "co-clustering"}, {"url": "http://nbviewer.jupyter.org/github/NicolasHug/Surprise/blob/master/examples/notebooks/KNNBasic_analysis.ipynb", "anchor_text": "notebook"}, {"url": "https://surprise.readthedocs.io/en/stable/index.html", "anchor_text": "Surprise"}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Building%20Recommender%20System%20with%20Surprise.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Building%20Recommender%20System%20with%20Surprise.ipynb", "anchor_text": "Github"}, {"url": "https://surprise.readthedocs.io/en/stable/index.html", "anchor_text": "Surprise\u2019 documentation"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d4ba702ef80b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d4ba702ef80b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----d4ba702ef80b---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/python?source=post_page-----d4ba702ef80b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/collaborative-filtering?source=post_page-----d4ba702ef80b---------------collaborative_filtering-----------------", "anchor_text": "Collaborative Filtering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd4ba702ef80b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&user=Susan+Li&userId=731d8566944a&source=-----d4ba702ef80b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd4ba702ef80b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&user=Susan+Li&userId=731d8566944a&source=-----d4ba702ef80b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4ba702ef80b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd4ba702ef80b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d4ba702ef80b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d4ba702ef80b--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Susan Li"}, {"url": "https://actsusanli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27K Followers"}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f2b19329694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b&newsletterV3=731d8566944a&newsletterV3Id=1f2b19329694&user=Susan+Li&userId=731d8566944a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}