{"url": "https://towardsdatascience.com/r-and-python-plotting-in-google-sheets-255e974aed91", "time": 1683009903.410718, "path": "towardsdatascience.com/r-and-python-plotting-in-google-sheets-255e974aed91/", "webpage": {"metadata": {"title": "R and Python Plotting in Google Sheets | by Sam Terfa | Towards Data Science", "h1": "R and Python Plotting in Google Sheets", "description": "This is part 2 in my n-part series on using R and Python functions inside Google Sheets formulas. If you haven\u2019t read part 1, Using R and Python in Google Sheets Formulas, I suggest doing so to see\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098", "anchor_text": "Using R and Python in Google Sheets Formulas", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098", "anchor_text": "part 1", "paragraph_index": 2}, {"url": "https://developers.google.com/apps-script/guides/sheets/functions", "anchor_text": "custom Google Apps Script functions", "paragraph_index": 2}, {"url": "https://cloud.google.com/run", "anchor_text": "Google Cloud Run", "paragraph_index": 2}, {"url": "https://imgur.com/", "anchor_text": "imgur.com", "paragraph_index": 2}, {"url": "https://api.imgur.com/", "anchor_text": "via their API", "paragraph_index": 2}, {"url": "https://github.com/samterfa/rpysheets", "anchor_text": "my rpysheets GitHub repo", "paragraph_index": 3}, {"url": "https://code.markedmondson.me/googleCloudRunner/index.html", "anchor_text": "GoogleCloudRunner R package", "paragraph_index": 3}, {"url": "https://github.com/samterfa/rpysheets/tree/master/rsheets_plotting", "anchor_text": "rsheets_plotting", "paragraph_index": 3}, {"url": "https://github.com/samterfa/rpysheets/tree/master/pysheets_plotting", "anchor_text": "pysheets_plotting", "paragraph_index": 3}, {"url": "https://docs.google.com/spreadsheets/d/1a2wOFlatsvrdVWg3STfICgZXYAXxc18MRhrIxSrEwb4/copy", "anchor_text": "this Google Sheets template", "paragraph_index": 3}, {"url": "https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/eval", "anchor_text": "eval() function", "paragraph_index": 4}, {"url": "https://docs.python.org/3/library/functions.html#exec", "anchor_text": "exec()", "paragraph_index": 4}, {"url": "https://docs.python.org/3/library/functions.html#eval", "anchor_text": "eval()", "paragraph_index": 4}, {"url": "https://imgur.com/", "anchor_text": "imgur.com", "paragraph_index": 6}, {"url": "https://imgur.com/register", "anchor_text": "create an imgur account", "paragraph_index": 6}, {"url": "https://api.imgur.com/oauth2/addclient", "anchor_text": "add a client to your account", "paragraph_index": 6}], "all_paragraphs": ["This is part 2 in my n-part series on using R and Python functions inside Google Sheets formulas. If you haven\u2019t read part 1, Using R and Python in Google Sheets Formulas, I suggest doing so to see all the magic available to you. In summary, you can use R and Python code to power custom Google Sheets cell formulas by setting up a simple API in Google Cloud Run and creating Google Apps Script functions to call your API. After the initial set up, it is quick and easy to use R and Python in any Google Sheet.", "As I said previously, I think Google Sheets are amazing. I stand by that statement with the caveat that graphing in Google Sheets is pretty bad. It took the longest time to even have a reasonable linear regression available, and the graph options are pretty limited. However, now you can use R and Python to create beautiful graphs on the fly inside Google Sheets by using techniques developed previously. In fact, many functions that produce image files can be used inside Google Sheets formulas with minimal additional set up.", "The Google Sheets function IMAGE takes the URL of an image as an argument and displays it inside a cell. Based on techniques from part 1, the custom Google Apps Script functions rplot and pyplot make API calls to my /rplot and /pyplot endpoints set up on Google Cloud Run. These API calls run the rscript and pyscript arguments as code, generate a PNG of the output, upload the PNG to imgur.com via their API, and return the URL of the uploaded image.", "The easiest way to get started with using rplot or pyplot inside Google Sheets is to clone my rpysheets GitHub repo and use the GoogleCloudRunner R package to deploy a Google Cloud Run service for the rsheets_plotting directory and the pysheets_plotting directory. Then copy and paste the Google Cloud Run service URLs into this Google Sheets template and play.", "The arguments rscript and pyscript are the work horses of the /rplot and /pyplot endpoints, and each comes with its own endpoint as well. The rscript argument is read in as a string and run using R\u2019s eval() function, while pyscript is read in and run using a mix of Python\u2019s exec() and eval() functions. I am aware that it is dangerous to allow an untrusted source to pass in code to an eval() or exec() function. Depending on your use case, I would consider how you might modify the code I\u2019ve written to safeguard these functions.", "Each variable passed into rscript and pyscript is identified and cast as a dataframe with column names, array, vector, or single value. rscript and pyscript can modify these variables and access built in values as well, but must result in the production of an image. Since R can capture plots as PNG files, this is taken care of behind the scenes, so all that is required is that a plot is attempted. However, since Python does not have a consistent way of capturing plots to PNG that I am aware of, the pyscript code must explicitly save a figure as a PNG file. The first PNG found in the working directory is uploaded to imgur.com behind the scenes.", "For both /rplot and /pyplot, I have utilized imgur.com image hosting. You can use a different image hosting site if you like, but to use what I have done above, you will need an imgur Client ID. To obtain one, create an imgur account, and add a client to your account. Once you have the client ID, you can copy and paste it into the above scripts, or you can instead create a .creds directory with the file imgur.json inside defined in the following way.", "I set up my client with Authorization type \u201cAnonymous usage without user authorization\u201d and simply upload publicly available images for demonstration purposes. You may choose to instead upload to a private album. While every update of a graph on a Google Sheet generates a unique imgur URL for the uploaded image, which is wasteful, each client can upload up to 1,250 images per day which has been enough for me. Should you use this in production, you will want to modify images when they change on update versus uploading a different image each time. Keep in mind that if you want to make money using imgur.com, you have special requirements and it is not free.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | R and Google Cloud Enthusiast"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F255e974aed91&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----255e974aed91--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----255e974aed91--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://samterfa.medium.com/?source=post_page-----255e974aed91--------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=post_page-----255e974aed91--------------------------------", "anchor_text": "Sam Terfa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff927a36747b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&user=Sam+Terfa&userId=f927a36747b7&source=post_page-f927a36747b7----255e974aed91---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F255e974aed91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F255e974aed91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@goumbik?utm_source=medium&utm_medium=referral", "anchor_text": "Lukas Blazek"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098", "anchor_text": "Using R and Python in Google Sheets Formulas"}, {"url": "https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098", "anchor_text": "part 1"}, {"url": "https://developers.google.com/apps-script/guides/sheets/functions", "anchor_text": "custom Google Apps Script functions"}, {"url": "https://cloud.google.com/run", "anchor_text": "Google Cloud Run"}, {"url": "https://imgur.com/", "anchor_text": "imgur.com"}, {"url": "https://api.imgur.com/", "anchor_text": "via their API"}, {"url": "https://github.com/samterfa/rpysheets", "anchor_text": "my rpysheets GitHub repo"}, {"url": "https://code.markedmondson.me/googleCloudRunner/index.html", "anchor_text": "GoogleCloudRunner R package"}, {"url": "https://github.com/samterfa/rpysheets/tree/master/rsheets_plotting", "anchor_text": "rsheets_plotting"}, {"url": "https://github.com/samterfa/rpysheets/tree/master/pysheets_plotting", "anchor_text": "pysheets_plotting"}, {"url": "https://docs.google.com/spreadsheets/d/1a2wOFlatsvrdVWg3STfICgZXYAXxc18MRhrIxSrEwb4/copy", "anchor_text": "this Google Sheets template"}, {"url": "https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/eval", "anchor_text": "eval() function"}, {"url": "https://docs.python.org/3/library/functions.html#exec", "anchor_text": "exec()"}, {"url": "https://docs.python.org/3/library/functions.html#eval", "anchor_text": "eval()"}, {"url": "https://imgur.com/", "anchor_text": "imgur.com"}, {"url": "https://imgur.com/register", "anchor_text": "create an imgur account"}, {"url": "https://api.imgur.com/oauth2/addclient", "anchor_text": "add a client to your account"}, {"url": "https://docs.google.com/spreadsheets/d/1a2wOFlatsvrdVWg3STfICgZXYAXxc18MRhrIxSrEwb4/copy", "anchor_text": "Here is the Google Sheet"}, {"url": "https://github.com/samterfa/rpysheets", "anchor_text": "Here is my GitHub repo"}, {"url": "https://medium.com/tag/r?source=post_page-----255e974aed91---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/python?source=post_page-----255e974aed91---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/google-sheets?source=post_page-----255e974aed91---------------google_sheets-----------------", "anchor_text": "Google Sheets"}, {"url": "https://medium.com/tag/api?source=post_page-----255e974aed91---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----255e974aed91---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F255e974aed91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&user=Sam+Terfa&userId=f927a36747b7&source=-----255e974aed91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F255e974aed91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&user=Sam+Terfa&userId=f927a36747b7&source=-----255e974aed91---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F255e974aed91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----255e974aed91--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F255e974aed91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----255e974aed91---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----255e974aed91--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----255e974aed91--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----255e974aed91--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----255e974aed91--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----255e974aed91--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----255e974aed91--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----255e974aed91--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----255e974aed91--------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sam Terfa"}, {"url": "https://samterfa.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff927a36747b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&user=Sam+Terfa&userId=f927a36747b7&source=post_page-f927a36747b7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5c5d191f9494&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-and-python-plotting-in-google-sheets-255e974aed91&newsletterV3=f927a36747b7&newsletterV3Id=5c5d191f9494&user=Sam+Terfa&userId=f927a36747b7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}