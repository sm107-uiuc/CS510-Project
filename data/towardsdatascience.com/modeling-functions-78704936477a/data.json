{"url": "https://towardsdatascience.com/modeling-functions-78704936477a", "time": 1683003386.784275, "path": "towardsdatascience.com/modeling-functions-78704936477a/", "webpage": {"metadata": {"title": "Modeling Functions. From linear to logistic regression | by Shinichi Okada | Towards Data Science", "h1": "Modeling Functions", "description": "We are going to draw a scatter graph and model a regression line from linear to logistic with Jupyter Notebook. The first one is a linear model. A linear model is express as \ud835\udc66=\ud835\udc5a\ud835\udc65+\ud835\udc50. We are going\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html", "anchor_text": "numpy.array", "paragraph_index": 1}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html?highlight=arange#numpy.arange", "anchor_text": "numpy.arange", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/a-measure-of-linear-relationship-5dd4a995ee7e?source=friends_link&sk=a68b5bc35334e5a501ead9900f0ea5db", "anchor_text": "A Measure of Linear Relationship", "paragraph_index": 1}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "sklearn.linear_model.LinearRegression", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "sklearn.linear_model.LinearRegression", "paragraph_index": 6}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html", "anchor_text": "scipy.stats.linregress", "paragraph_index": 8}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html", "anchor_text": "scipy.optimize.curve_fit", "paragraph_index": 28}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.log.html", "anchor_text": "numpy.log", "paragraph_index": 36}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.log.html", "anchor_text": "numpy.log", "paragraph_index": 40}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.radians.html", "anchor_text": "numpy.radians", "paragraph_index": 42}, {"url": "https://niwa.co.nz/education-and-training/schools/resources/climate/modelling", "anchor_text": "the table below", "paragraph_index": 43}, {"url": "https://lmfit.github.io/lmfit-py/", "anchor_text": "LMFIT", "paragraph_index": 49}, {"url": "https://blog.codewithshin.com/membership", "anchor_text": "becoming a member", "paragraph_index": 50}], "all_paragraphs": ["We are going to draw a scatter graph and model a regression line from linear to logistic with Jupyter Notebook.", "The first one is a linear model. A linear model is express as \ud835\udc66=\ud835\udc5a\ud835\udc65+\ud835\udc50. We are going to use numpy.array or numpy.arange to create data. If you want to read more about a linear relationship, please read A Measure of Linear Relationship. We import Python libraries numpy and matplotlib. We create a year and a co2 array.", "First, we create a scatter plot using matplotlib. Add the title, label, x, and y-axis labels. You need to use show() method. You can plot without it but this will remove unnecessary outputs.", "As you can see in the above graph, you have decimals in the x-axis. We use the first three lines to make them integers in the following codes.", "The easiest way is to use numpy.polyfit. By setting order to 1, it will return an array of linear coefficients. Using it in numpy.poly1d returns an equation using the coefficients.", "The second way to find the regression slope and intercept is to use sklearn.linear_model.LinearRegression. This class requires the x values to be one column. We modify year data using reshape(-1,1). The original year data has 1 by 11 shape. You need to reshape the year data to 11 by 1.", "We import sklearn.linear_model.LinearRegression, reshape the year data, fit our data using LinearRegression().fit(). This will return the slope, coef_ and the y-intercept, intercept_. coef_ returns an array, so we take the first item by using reg.coef_[0]. Let\u2019s print out our regression line equation.", "We draw a scatter plot and our linear regression line together. We use a new x domain from 1975 to 2005 taking 100 samples for the regression line, np.linspace(1975,2005,100). Then using x domain, slope, and y-intercept to draw a regression line.", "Another way to find the regression slope and intercept is to use scipy.stats.linregress. This returns slope, intercept, rvalue, pvalue, stderr.", "To draw a line we need x points. We use np.linspace which is numpy.linspace since we used import numpy as np. Our data is from 1975 to 2000. So let's use 1960 for start, 2005 for stop and 100 for the number of samples.", "Now we put a scatter plot, regression line, and a regression equation together.", "Use the following data to graph a scatter plot and regression line. Find a linear regression equation.", "We use Numpy\u2019s arange to create 10 integers from 0 to 9.", "numpy.polyfit fits a polynomial. It requires x, y, and degree of the fitting polynomial. 2 for a quadratic, 3 for a cubic, etc. It returns an array with polynomial coefficients from a higher power to the constant. For a quadratic function, these are a, b and c in:", "Let\u2019s print out the quadratic regression line.", "Or using coefficients the regression line is:", "We use NumPy's poly1d and polyfitagain. np.poly1d(coefficients) will return a polynomial equation using our coefficient.", "We can find a value for any x. For example, if you want to find y value when x=1:", "We use this to draw our regression line. We use numpy.linspace to define x values from 0 to 10 for 100 samples. And use it in the equ for y values.", "By using the following data, draw a scatter plot and regression line in a graph. Find the quadratic regression equation.", "Could you draw a scatter and regression line? The quadratic equation should be:", "You can use the same method as the quadratic function above. We are going to use plyfit and poly1d. First, we prepare the data. And let\u2019s draw a scatter plot.", "Using polyfit returns coefficients. For a cubic function, a, b, c, and d in:", "Draw a scatter plot and a cubic regression line using the following data. Print the cubic equation.", "Could you plot a scatter and a regression line? The regression line equation should be:", "The second one is practically 0. Try the following to see both are the same 0.3.", "We are going to explore three exponential models.", "Let\u2019s set up the data. And draw a scatter plot.", "We are going to use scipy.optimize.curve_fit. This requires a function, x and y values, and initial values, p0 in array form. Finding proper p0 is a bit of trial and error. You have to test different values. We use p0=(1, 1e-6, 1). It returns optimal values for the parameters and the estimated covariance of popt.", "Our first exponential function uses a, b, and c. We are going to define a function first. This is used in the curve_fit method. For a smooth curve, we set x values using numpy.linspace from 0 to 7 with 100 samples.", "The second function uses a and b. We define the function accordingly.", "The last exponential function uses a and b. We modify the function accordingly.", "TI Nspire\u2019s exponential regression fits the model equation \ud835\udc66=\ud835\udc4e\ud835\udc4f^\ud835\udc65 to the data using a least-squares fit on transformed values x and \ud835\udc59\ud835\udc5b(\ud835\udc66). It returns a different value.", "Using the following data find an exponential function in the form of ab^x. Plot a scatter diagram and draw a regression line.", "Generally, we use the semi-log model for an exponential function:", "We set up our mock data and plot a scatter diagram.", "We are going to take a natural log for the bacteria values by using numpy.log. numpy.log is the natural logarithm. This should show a linear trend. We need to modify the title and y label with ln(bacteria).", "We use numpy.polyfit which we used in a quadratic and cubic function. We use 1 in numpy.polyfit() so that it will return a linear regression. numpy.polyfit returns all coefficients for our equation.", "The log-log model is used for a power function.", "Let\u2019s set up data and plot a scatter diagram.", "We take a natural log for x and y values using numpy.log. We need to modify the x and y labels to ln(x) and ln(y).", "Let\u2019s try a sinusoidal function. We set our data and plot a scatter graph. Since we are going to use scipy.optimize.curve_fit, let's import it as well. We used it in the exponential models. We set up our data and draw a scatter plot.", "We define a function called sinfunc. This takes parameters x, a, b, c, d. We use numpy.radians for c.", "Using the table below, draw a scatter plot and find a cosine regression function.", "You may have different coefficients. I used", "We set up data and plot a scatter diagram. We set the domain from -10 to 10 and range from 0 to 250, using plt.xlim and plt.ylim. We are going to use scipy.optimize.curve_fit for logistic regression.", "We define our logistic function using logifunc. We find the function parameter in popt using curve_fit. For the regression line, we set a new domain for the function, x_data from -10 to 10. We plot the line using plt.plot.", "Sometimes your data may have negative values in y coordinates.", "The minimum value for the data needs to be zero. And ideally, the sigmoid midpoint is also zero. But the above data set satisfies neither of them. Using equation (1\u20132), and adding offset value works for this data set.", "scipy.optimize.curve_fit was useful for many functions. The only problem was to find good initial values in p0. Sometimes different p0 values return different popt. You can try LMFIT.", "Get full access to every story on Medium by becoming a member.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A programmer and technology enthusiast with a passion for sharing my knowledge and experience."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F78704936477a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@shinichiokada", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----78704936477a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----78704936477a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://blog.codewithshin.com/?source=post_page-----78704936477a--------------------------------", "anchor_text": ""}, {"url": "https://blog.codewithshin.com/?source=post_page-----78704936477a--------------------------------", "anchor_text": "Shinichi Okada"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa262a804b78f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&user=Shinichi+Okada&userId=a262a804b78f&source=post_page-a262a804b78f----78704936477a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78704936477a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78704936477a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@clemono2?utm_source=medium&utm_medium=referral", "anchor_text": "Clem Onojeghuo"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html", "anchor_text": "numpy.array"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html?highlight=arange#numpy.arange", "anchor_text": "numpy.arange"}, {"url": "https://towardsdatascience.com/a-measure-of-linear-relationship-5dd4a995ee7e?source=friends_link&sk=a68b5bc35334e5a501ead9900f0ea5db", "anchor_text": "A Measure of Linear Relationship"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "sklearn.linear_model.LinearRegression"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "sklearn.linear_model.LinearRegression"}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html", "anchor_text": "scipy.stats.linregress"}, {"url": "https://towardsdatascience.com/the-subtlety-of-spearmans-rank-correlation-coefficient-29478653bbb9", "anchor_text": "The Subtlety of Spearman\u2019s Rank Correlation CoefficientUntold parts of monotonic relationtowardsdatascience.com"}, {"url": "https://towardsdatascience.com/gentle-introduction-to-chi-square-test-for-independence-7182a7414a95", "anchor_text": "Gentle Introduction to Chi-square test for independenceBeginners guide to Chi-square using Jupyter Notebooktowardsdatascience.com"}, {"url": "https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html", "anchor_text": "scipy.optimize.curve_fit"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.log.html", "anchor_text": "numpy.log"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.log.html", "anchor_text": "numpy.log"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.radians.html", "anchor_text": "numpy.radians"}, {"url": "https://niwa.co.nz/education-and-training/schools/resources/climate/modelling", "anchor_text": "the table below"}, {"url": "http://bit.ly/2tUIZjK'", "anchor_text": "http://bit.ly/2tUIZjK'"}, {"url": "https://lmfit.github.io/lmfit-py/", "anchor_text": "LMFIT"}, {"url": "https://blog.codewithshin.com/membership", "anchor_text": "becoming a member"}, {"url": "https://blog.codewithshin.com/subscribe", "anchor_text": "https://blog.codewithshin.com/subscribe"}, {"url": "https://realpython.com/linear-regression-in-python/", "anchor_text": "https://realpython.com/linear-regression-in-python/"}, {"url": "https://stackoverflow.com/questions/41925157/logisticregression-unknown-label-type-continuous-using-sklearn-in-python", "anchor_text": "https://stackoverflow.com/questions/41925157/logisticregression-unknown-label-type-continuous-using-sklearn-in-python"}, {"url": "https://medium.com/tag/statistics?source=post_page-----78704936477a---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/functions?source=post_page-----78704936477a---------------functions-----------------", "anchor_text": "Functions"}, {"url": "https://medium.com/tag/math?source=post_page-----78704936477a---------------math-----------------", "anchor_text": "Math"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----78704936477a---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/programming?source=post_page-----78704936477a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F78704936477a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&user=Shinichi+Okada&userId=a262a804b78f&source=-----78704936477a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F78704936477a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&user=Shinichi+Okada&userId=a262a804b78f&source=-----78704936477a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F78704936477a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----78704936477a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F78704936477a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----78704936477a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----78704936477a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----78704936477a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----78704936477a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----78704936477a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----78704936477a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----78704936477a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----78704936477a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----78704936477a--------------------------------", "anchor_text": ""}, {"url": "https://blog.codewithshin.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://blog.codewithshin.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shinichi Okada"}, {"url": "https://blog.codewithshin.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa262a804b78f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&user=Shinichi+Okada&userId=a262a804b78f&source=post_page-a262a804b78f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbea6b9a08c54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmodeling-functions-78704936477a&newsletterV3=a262a804b78f&newsletterV3Id=bea6b9a08c54&user=Shinichi+Okada&userId=a262a804b78f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}