{"url": "https://towardsdatascience.com/preparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5", "time": 1683008990.464469, "path": "towardsdatascience.com/preparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5/", "webpage": {"metadata": {"title": "Preparing Open Images Dataset for TensorFlow Object Detection | by Het Pandya | Towards Data Science", "h1": "Preparing Open Images Dataset for TensorFlow Object Detection", "description": "Sometimes, these datasets follow a different format and the model you want to train follows another. Making the data usable by the model becomes a hassle when the data is very large. This what I\u2026"}, "outgoing_paragraph_urls": [{"url": "http://cocodataset.org", "anchor_text": "MS COCO", "paragraph_index": 0}, {"url": "http://www.image-net.org", "anchor_text": "ImageNet", "paragraph_index": 0}, {"url": "https://storage.googleapis.com/openimages/web/index.html", "anchor_text": "Open Images", "paragraph_index": 0}, {"url": "https://github.com/tensorflow/models/tree/master/research/object_detection", "anchor_text": "Tensorflow Object Detection API", "paragraph_index": 2}, {"url": "https://storage.googleapis.com/openimages/web/download_v4.html", "anchor_text": "Open Images V4 Dataset.", "paragraph_index": 2}, {"url": "https://www.tensorflow.org/api_guides/python/python_io#tfrecords_format_details", "anchor_text": "TFRecords", "paragraph_index": 3}, {"url": "http://host.robots.ox.ac.uk/pascal/VOC/", "anchor_text": "PASCAL VOC", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/coco-data-format-for-object-detection-a4c5eaf518c5#:~:text=Pascal%20VOC%20is%20an%20XML,for%20training%2C%20testing%20and%20validation.", "anchor_text": "Here", "paragraph_index": 4}, {"url": "https://github.com/horizons-ml/OIDv4_annotation_tool/blob/master/OIDv4_Dataset_Download_Processing.ipynb", "anchor_text": "notebook", "paragraph_index": 6}, {"url": "https://github.com/AtriSaxena/OIDv4_to_VOC", "anchor_text": "This tool", "paragraph_index": 14}, {"url": "https://github.com/horizons-ml/OIDv4_annotation_tool/blob/master/OIDv4_to_VOC.py", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://github.com/tzutalin/labelImg", "anchor_text": "labelImg", "paragraph_index": 20}], "all_paragraphs": ["Data is one of the strongest pillars to consider while building a deep learning model. The more precise the data is, the more experienced the model is. To train a deep learning model, you need lots of data which you might want to create your own or you can use the public datasets available across the internet such as MS COCO, ImageNet, Open Images, etc.", "Sometimes, these datasets follow a different format and the model you want to train follows another. Making the data usable by the model becomes a hassle when the data is very large. This what I stumbled open while creating my own object detector.", "Object Detection is a branch of computer vision where you locate a particular object in an image. I used the Tensorflow Object Detection API to create my custom Object Detector. To create my detector, I created my data from the Open Images V4 Dataset. The dataset has a collection of 600 classes and around 1.7 million images in total, split into training, validation and test sets. It has been updated to V6 but I decided to go with the V4 because of two tools that we will look at soon.", "To train a Tensorflow Object Detection model, you need to create TFRecords, which uses the following:", "Open Images has both, the images and their annotations. But,all the annotations are clubbed in a single file which gets clumsy when you want data for specific classes. To handle this, I decided to convert the data into PASCAL VOC format. Now, you might ask what is PASCAL VOC? In short, the PASCAL VOC format has an XML file created per image that has the co-ordinates of the bounding boxes of each object in the image. Pretty sorted, right? Here is an amazing reference if you wish to know more about PASCAL VOC.", "Now enough of talking, let\u2019s see this in action!", "But but but! Before we begin, you might want to walk along with me, so here is the notebook from my github repo. LET\u2019S GET STARTED!", "I suggest using google colab because some files that the tools might need are large and may not be useful for future use cases.", "When you run the script for the first time, the tool might ask you to download some files, allow it. Here\u2019s how the prompt will look like", "The tool creates directories per split and again sub-directories for each class in those directories.", "4. Now let\u2019s take a look at the number of files for each class using the following script:", "Hmm.. but I mentioned 98 images, right? It creates a folder named \u2018Label\u2019 that contains the annotations for each image.", "Let\u2019s see what the folder \u2018Label\u2019 contains:", "We get one annotation file per image. But, are we done? Nope! The annotations are not according to the PASCAL VOC format. So, we need an another tool that can convert these annotations into the required format.", "This tool does the final job for us. Clone it. I have modified this tool slightly for classes with more than one word in their names which you can find on my repo here.", "Once done, run the following command to convert the annotation files:", "Here, sourcepath is the location of \u2018Label\u2019 folder for each class and dest_path is where your XML annotations will be stored.", "Once the XML annotations are created, we no longer need the txt annotations. Let\u2019s remove them:", "This removes all the folders named \u2018Label\u2019 in all the class directories.", "Now you have your filtered dataset! \ud83d\ude00", "Tip : Once the dataset is ready, verify the annotations using labelImg. The objects may be wrongly annotated sometimes.", "That\u2019s it folks! Thank you for reading \ud83d\ude0a", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hi, I am a machine learning enthusiast, passionate about counting stars under the sky of Deep Learning and Machine Learning."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc3da6e688eb5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://het-pandya.medium.com/?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": ""}, {"url": "https://het-pandya.medium.com/?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": "Het Pandya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feeb80b946418&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&user=Het+Pandya&userId=eeb80b946418&source=post_page-eeb80b946418----c3da6e688eb5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3da6e688eb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3da6e688eb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@andrewtneel", "anchor_text": "Andrew Neel"}, {"url": "https://unsplash.com", "anchor_text": "Unsplash"}, {"url": "http://cocodataset.org", "anchor_text": "MS COCO"}, {"url": "http://www.image-net.org", "anchor_text": "ImageNet"}, {"url": "https://storage.googleapis.com/openimages/web/index.html", "anchor_text": "Open Images"}, {"url": "https://github.com/tensorflow/models/tree/master/research/object_detection", "anchor_text": "Tensorflow Object Detection API"}, {"url": "https://storage.googleapis.com/openimages/web/download_v4.html", "anchor_text": "Open Images V4 Dataset."}, {"url": "https://www.tensorflow.org/api_guides/python/python_io#tfrecords_format_details", "anchor_text": "TFRecords"}, {"url": "http://host.robots.ox.ac.uk/pascal/VOC/", "anchor_text": "PASCAL VOC"}, {"url": "https://towardsdatascience.com/coco-data-format-for-object-detection-a4c5eaf518c5#:~:text=Pascal%20VOC%20is%20an%20XML,for%20training%2C%20testing%20and%20validation.", "anchor_text": "Here"}, {"url": "https://github.com/horizons-ml/OIDv4_annotation_tool/blob/master/OIDv4_Dataset_Download_Processing.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/EscVM/OIDv4_ToolKi", "anchor_text": "tool"}, {"url": "https://storage.googleapis.com/openimages/2018_04/bbox_labels_600_hierarchy_visualizer/circle.html", "anchor_text": "here"}, {"url": "https://github.com/AtriSaxena/OIDv4_to_VOC", "anchor_text": "This tool"}, {"url": "https://github.com/horizons-ml/OIDv4_annotation_tool/blob/master/OIDv4_to_VOC.py", "anchor_text": "here"}, {"url": "https://github.com/tzutalin/labelImg", "anchor_text": "labelImg"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----c3da6e688eb5---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----c3da6e688eb5---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/object-detection-api?source=post_page-----c3da6e688eb5---------------object_detection_api-----------------", "anchor_text": "Object Detection Api"}, {"url": "https://medium.com/tag/open-images?source=post_page-----c3da6e688eb5---------------open_images-----------------", "anchor_text": "Open Images"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----c3da6e688eb5---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3da6e688eb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&user=Het+Pandya&userId=eeb80b946418&source=-----c3da6e688eb5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc3da6e688eb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&user=Het+Pandya&userId=eeb80b946418&source=-----c3da6e688eb5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc3da6e688eb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc3da6e688eb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c3da6e688eb5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c3da6e688eb5--------------------------------", "anchor_text": ""}, {"url": "https://het-pandya.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://het-pandya.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Het Pandya"}, {"url": "https://het-pandya.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feeb80b946418&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&user=Het+Pandya&userId=eeb80b946418&source=post_page-eeb80b946418--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2ad198496e7e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpreparing-open-images-dataset-for-tensorflow-object-detection-c3da6e688eb5&newsletterV3=eeb80b946418&newsletterV3Id=2ad198496e7e&user=Het+Pandya&userId=eeb80b946418&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}