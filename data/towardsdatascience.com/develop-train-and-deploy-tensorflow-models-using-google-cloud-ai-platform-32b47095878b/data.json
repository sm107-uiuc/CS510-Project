{"url": "https://towardsdatascience.com/develop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b", "time": 1683012532.6086788, "path": "towardsdatascience.com/develop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b/", "webpage": {"metadata": {"title": "Develop, Train and Deploy TensorFlow Models using Google Cloud AI Platform | by MA Raza, Ph.D. | Towards Data Science", "h1": "Develop, Train and Deploy TensorFlow Models using Google Cloud AI Platform", "description": "The TensorFlow ecosystem has become very popular for developing applications involving deep learning. One of the reasons is that it has a strong community and a lot of tools have been developed\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/tensorflow/cloud", "anchor_text": "Tensorflow Cloud", "paragraph_index": 2}, {"url": "https://blog.tensorflow.org/2020/08/train-your-tensorflow-model-on-google.html", "anchor_text": "Train your TensorFlow model on Google Cloud using TensorFlow Cloud", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/deep-learning-course-v1-guide-81a53c238901", "anchor_text": "Model with TensorFlow and Serve on Google Cloud Platform", "paragraph_index": 17}], "all_paragraphs": ["The TensorFlow ecosystem has become very popular for developing applications involving deep learning. One of the reasons is that it has a strong community and a lot of tools have been developed around the core library to support developers. In this tutorial, I will guide you through how to prototype models in google colab, train it on Google Cloud AI Platform, and deploy the finalized model on Google Cloud AI Platform for production. I will include the working Google colab notebooks to recreate the work.", "Google colab is a free resource for prototyping models in TensorFlow and comes with various runtime. Preparing a machine with GPU or TPU could be costly to start with however users can start with free GPU with google colab. Bear in mind, colab has limited resources and might not be suitable for properly training models requiring large compute resources. Nonetheless, colab is a perfect tool for prototyping your models and some initial experimentation.", "Once you are satisfied with your model pipeline, it is time to train the model with the proper number of EPOCHS and full datasets. As you might know, training deep learning models requires a long time and a large cluster of CPU\u2019s GPUs or TPU\u2019s. One option is that users set up their own computing cluster which is costly and time-consuming most of the time. Another option is to use cloud computing to training the model and pay as you go. TensorFlow team has released a package called Tensorflow Cloud to let users train the models on the Google Cloud platform without any hassle. I have followed steps from Train your TensorFlow model on Google Cloud using TensorFlow Cloud blog and will share some issues I have faced to make it work. Some of the pre-requisites are ad defined in the project guidelines for submitting a training job to the GCP platform.", "After creating the GCP project, follow the below steps to config the environment with Google cloud authentication.", "Create the Service Account and set some permissions needed for tensorflow-cloud the package. Download the service account key and add as an environment variable as GOOGLE_APPLICATION_CREDENTIALS. These credentials will be needed to submit the job to the google cloud platform.", "Even after following the above steps, I have to enable service Accounts and cloud_build Status under Cloud Build settings. Below is the snapshot of my project settings.", "The next step is to create GCP_BUCKET to store the data needed for submitting the job to Google Cloud.", "Once we have set up the environment in our google colab and created the GCP_BUCKET, we have to prepare the notebook with training the model. Below are some key points to consider while preparing a notebook.", "Once we are ready with the notebook, we submit the training on Google Cloud platform using tensorflow-cloud package.", "The above code will convert the notebook into identifier-Fg45-a.py and submit the training on the Google Cloud platform in the docker form. After you submit the job, you can see the message like the below figure.", "Wait for a few minutes before the job starts actually training", "By clicking on the provided link, you will see a page like below figure", "You can see the logs by clicking the view logs and will look like the below figure. Logs are helpful to see what sort of Exceptions happened in your code.", "Before submitting the huge job, test your pipeline submission script for few EPOCHS and then submit the complete job", "If all goes well, your model will be trained using the Google AI platform and saved in GCP_BUCKET along with other resources.", "Below is the working notebook to run the training on Google AI Platform using the TensorFlow-Cloud package.", "Once the model is trained and finalized, users would like to deploy the model on a scale-able infrastructure. Google Cloud also provides the necessary infrastructure to deploy TensorFlow models on its platform without a lot of modifications. I will show you how to deploy the model on a google cloud platform. At the end of the training, we save the finalized model in Google Cloud Bucket. Below are the steps to deploy the model.", "Use the below set of commands to configure the model for deployment withing Google colab. I have explained in detail how to deploy the model on Google Cloud in Model with TensorFlow and Serve on Google Cloud Platform.", "I have configured the model to serve as v2 following the same steps in the above tutorial.", "Once the model is deployed and you can see the green tick, it is time to test the model for predictions. Some important points to consider.", "Load the unseen data for predictions", "Below is the working notebook to perform prediction on the deployed model", "In this guide, we have learned about training the deep learning models with TensorFlow 2.3.0 using the Google Cloud AI platform with the help of tensorflow-cloud package and deployed the trained model on the Google Cloud AI platform too. Below are some key lessons", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer | Data Scientist | ML Researcher | Educator"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F32b47095878b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----32b47095878b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----32b47095878b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@amjadraza24?source=post_page-----32b47095878b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=post_page-----32b47095878b--------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3----32b47095878b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32b47095878b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32b47095878b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/tensorflow/cloud", "anchor_text": "Tensorflow Cloud"}, {"url": "https://blog.tensorflow.org/2020/08/train-your-tensorflow-model-on-google.html", "anchor_text": "Train your TensorFlow model on Google Cloud using TensorFlow Cloud"}, {"url": "https://cloud.google.com/ai-platform/docs/getting-started-keras#set_up_your_project", "anchor_text": "A Google Cloud project"}, {"url": "https://cloud.google.com/ai-platform/docs/getting-started-keras#authenticate_your_gcp_account", "anchor_text": "authenticated GCP account"}, {"url": "https://cloud.google.com/ai-platform/", "anchor_text": "Google AI platform"}, {"url": "https://docs.docker.com/engine/install/", "anchor_text": "docker"}, {"url": "https://cloud.google.com/ai-platform/docs/getting-started-keras#create_a_bucket", "anchor_text": "create a cloud storage bucket"}, {"url": "https://cloud.google.com/cloud-build", "anchor_text": "Google Cloud build"}, {"url": "https://towardsdatascience.com/deep-learning-course-v1-guide-81a53c238901", "anchor_text": "Model with TensorFlow and Serve on Google Cloud Platform"}, {"url": "https://blog.tensorflow.org/2020/04/how-to-deploy-tensorflow-2-models-on-cloud-ai-platform.html", "anchor_text": "https://blog.tensorflow.org/2020/04/how-to-deploy-tensorflow-2-models-on-cloud-ai-platform.html"}, {"url": "https://blog.tensorflow.org/2020/08/train-your-tensorflow-model-on-google.html", "anchor_text": "https://blog.tensorflow.org/2020/08/train-your-tensorflow-model-on-google.html"}, {"url": "https://towardsdatascience.com/deep-learning-course-v1-guide-81a53c238901", "anchor_text": "https://scikit-learn.org/stable/modules/preprocessing.html"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----32b47095878b---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----32b47095878b---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----32b47095878b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow-cloud?source=post_page-----32b47095878b---------------tensorflow_cloud-----------------", "anchor_text": "Tensorflow Cloud"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----32b47095878b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F32b47095878b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----32b47095878b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F32b47095878b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=-----32b47095878b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F32b47095878b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----32b47095878b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F32b47095878b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----32b47095878b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----32b47095878b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----32b47095878b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----32b47095878b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----32b47095878b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----32b47095878b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----32b47095878b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----32b47095878b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----32b47095878b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@amjadraza24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "MA Raza, Ph.D."}, {"url": "https://medium.com/@amjadraza24/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "176 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43f78dfb3de3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=post_page-43f78dfb3de3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3cd60c3ab90f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdevelop-train-and-deploy-tensorflow-models-using-google-cloud-ai-platform-32b47095878b&newsletterV3=43f78dfb3de3&newsletterV3Id=3cd60c3ab90f&user=MA+Raza%2C+Ph.D.&userId=43f78dfb3de3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}