{"url": "https://towardsdatascience.com/classifying-social-mobility-with-machine-learning-fe6abcf0dcb2", "time": 1683002219.9828851, "path": "towardsdatascience.com/classifying-social-mobility-with-machine-learning-fe6abcf0dcb2/", "webpage": {"metadata": {"title": "Classifying Social Mobility with Machine Learning | by Giovanna Fernandes | Towards Data Science", "h1": "Classifying Social Mobility with Machine Learning", "description": "This blog post will walk you through an exercise in Machine Learning Classification in Python, using both Pipelines and Grid-search Cross-Validation. As a data scientist, I am deeply interested in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://opportunityinsights.org/data/", "anchor_text": "Opportunity Insights", "paragraph_index": 2}, {"url": "https://opportunityinsights.org/paper/the-opportunity-atlas/", "anchor_text": "The Opportunity Atlas: Mapping the Childhood Roots of Social Mobility", "paragraph_index": 2}, {"url": "https://medium.com/@swethalakshmanan14/how-when-and-why-should-you-normalize-standardize-rescale-your-data-3f083def38ff", "anchor_text": "this", "paragraph_index": 5}, {"url": "https://opportunityinsights.org/data/", "anchor_text": "Neighborhood Characteristics by Census Tract", "paragraph_index": 8}, {"url": "https://opportunityinsights.org/data/", "anchor_text": "All Outcomes by Census Tract, Race, Gender and Parental Income Percentile", "paragraph_index": 13}, {"url": "https://github.com/gioamorim80/Social-Mobility-Classification-Machine-Learning/blob/master/Classfication%20-%20Module%205%20Final%20Project.ipynb", "anchor_text": "here", "paragraph_index": 33}], "all_paragraphs": ["This blog post will walk you through an exercise in Machine Learning Classification in Python, using both Pipelines and Grid-search Cross-Validation. As a data scientist, I am deeply interested in how data can help solve economic, social, and political inequalities, so I decided to use some social-based data for this classification problem.", "The model we are creating will take characteristics (such as income levels, education, racial make up, etc.) on a geographical level as features to try to classify thousands of census tracts across the United States in terms of upward social mobility for children who grow up in these locations. A classification of this type could be helpful in identifying areas of opportunity for low income families, as well as helping inform public policy and resources allocation.", "We will use data made available by Opportunity Insights, a group of researchers and policy analysts based at Harvard University. I\u2019m using data from two different datasets from their project called The Opportunity Atlas: Mapping the Childhood Roots of Social Mobility \u2014 which I highly recommend checking for those interested in the topic.", "In our machine learning process we will clean the data, do some feature engineering and then use Pipelines to find the best type of supervised model to work with. We will then again use a Pipeline together with a Grid-search Cross-Validation to fine tune the hyperparameters of our model in order to improve it. Finally we will access the scorings and results of our model while testing it on unseen data.", "We all data scientists know that data is most times a messy thing!", "Our first step is to load and clean the data and then prepare it for the modeling with some feature engineering. This is many times the most time-consuming step in a data science process, but a good Exploratory Data Analysis should take place before you consider your data ready for modeling. At a minimum, you would want to look at each column content and datatypes, check for any null values and outliers, have a look at the data distribution, and check the correlation between features. For most machine learning models standardization is also paramount (I\u2019ve found this explanation to standardization very clear and useful). However, in our process we will include this step into our pipeline further on.", "In our exercise we will also join the features to another dataframe where we will calculate our target variable through some feature engineering.", "As my very first step, I like to load all the libraries I\u2019ll need at the beginning of my notebook. We will use Pandas, Matplotlib and Seaborn for some visualizations, and rely heavily on several Scikit-Learn libraries that are very useful and cover most of our machine learning needs.", "We have a reasonably sized dataset for a machine learning project, with over 74K rows and 38 columns, mostly numerical. The full description of all columns can be found on the READ ME file for the Neighborhood Characteristics by Census Tract, but most are self explanatory. Let\u2019s have a look at all the columns. We could use df.info() to see datatypes and null values at once, but I like to check the data types separately with df.dtypes and then check the percentage of NaNs in each column with a simple calculation:", "Each row is identified by a census tract, county and state so in order to make the identifier unique we will combine the three into a unique \u2018ID\u2019 column. We will also choose to eliminate the columns with high percentage of NaNs.", "Then, we want to have a look at the main statistics for our numerical data. Since we have 38 columns, pandas will not display all of them if I simply call df.describe(). There are several ways to work around this and be able to visualize all columns statistics, but I personally find the easiest way is to simply split the dataframe and call the describe method twice (or more).", "Finally, before dipping into feature engineering, I will have a look at the overall distribution by calling df.hist().", "There is clear disparity in terms of scale among columns, but as mentioned before, scaling will be included in our pipeline. We also don\u2019t have any categorical features, so the only engineering I\u2019ll perform in our features is to take data which we have measurements over periods of years that are not already share-based, and calculate a percent variance/change in them, as this is more meaningful to us when analyzing the areas characteristics (have areas improved or not over years, and by what measure?).", "Now, we will bring in our data for our target variable. We will load only necessary columns from the dataset All Outcomes by Census Tract, Race, Gender and Parental Income Percentile given that this is a very large file. To calculate social mobility, we will use the columns with income ranks for parents and children by census tract, and then label them as 0 when the difference between parents and children income is equal or less than zero, and 1 for when the difference in income rank is positive (meaning upward social mobility). After all that, I will merge the two dataframes matching the areas by the unique ID column.", "We still have up to 3.6% of null values in some of our columns, but because each row represents one specific geographical area in the US, instead of dropping them I will replace them with the column median value.", "Finally, we will have a look at the correlations, and also the balance of our target outcome.", "Our target is balanced enough so we don\u2019t need to do any balancing methods before we split our data.", "Split data into train, validation and test sets", "It is always necessary to split the data into a train and test sets so that you can use part of your data to train your model, and part of it to test it. I like to also split the train set further into train and validation, so that I use the validation data while I\u2019m fine tuning my model, and leave the unseen test data only for after I feel my model is the best it can be.", "Great, we now have three datasets with balanced outcomes ready to be trained!", "We are working in a supervised binary classification problem thus we could use several different types of models to get our results. We also don\u2019t have a too large dataset, which releases some constraints in terms of processing cost. Because we have such freedom and not too much computational demands we will go through several different types of models and see how well they perform.", "I\u2019ll create a pipeline and run a vanilla model for several different types of models to see how each perform with our data. My pipeline will scale the data and train each of the models in a loop. Then we will check the overall accuracy of each of the models using the validation data sets to compare and decide which one can provide us the the best results for our data with the least tuning.", "Our results show that we are likely looking at a non-linear Support Vector Machine as the best model for our classification problem.", "Now let\u2019s try to improve our model results with some tuning of the hyper-parameters. I want to run another pipeline now on this model with a grid search and cross-validation to test out some values for the C and gamma parameters and find which provide us with the best results for our model.", "I\u2019ve timed it because such grid searches can take a while to fit. In my machine it took about 36 minutes. One thing you can do to avoid running a long grid search like this again if you need to restart your kernel for example, is to save it and then reload it:", "We can now access the best parameters found with grid_svm.best_params_. In our model the best values were C: 10, gamma: 0.01.", "Let\u2019s check our model\u2019s accuracy score with these best parameters, for both the train data as well as the validation data.", "We can analyze our model\u2019s performance further by looking at the precision, recall and F1 scores as well. An easy way to do this is to print a classification report. We can also print the confusion matrix to look at the actual numbers for our True and False Positives and Negatives.", "In this plot, we can see the True Negatives in dark blue and the True Positives in light blue. The light colors show the labels our classification model got wrong. This is in absolute values, and displays the numbers our accuracy, precision, recall and F1 scores are using to generate their values.", "After all the tuning of the hyper-parameters, we can also use the unseen test data to confirm our model\u2019s performance. Running the scores against the test data, we get an accuracy score of 0.8638782751091703. Here\u2019s our classification report and confusion matrix for the test data as well:", "We have similar results, so we can confirm the performance of our model.", "When we are dealing with a social project, with all the complexity of the human and society conditions, it is expected that our model would not be able to predict/classify social mobility with a near-perfect precision. This means that many different factors influence the outcomes of children, beyond the make-up of their neighborhoods growing up. In the social field, one of the biggest challenges is being able to collect the right data. Something like having a motivating teacher along a children\u2019s schooling, for example, could have a relevant impact and even help predict a positive outcome, but it is nearly impossible to measure statistically.", "Considering the challenges and constraints, we believe that our model still does a fairly good job at getting the classification right, and could be helpful in addition to other resources to identify opportunities and challenges for social mobility.", "I hope this process was helpful to anyone learning about supervised machine learning and how to use pipelines and grid search! Please leave your comments and feel free to check out the repository with the complete notebook here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I want to positively impact the world using the power of data."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffe6abcf0dcb2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gio.amorim?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gio.amorim?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": "Giovanna Fernandes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1b24a810b12b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=post_page-1b24a810b12b----fe6abcf0dcb2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe6abcf0dcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe6abcf0dcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@hannahmorgan7?utm_source=medium&utm_medium=referral", "anchor_text": "Hannah Morgan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://opportunityinsights.org/data/", "anchor_text": "Opportunity Insights"}, {"url": "https://opportunityinsights.org/paper/the-opportunity-atlas/", "anchor_text": "The Opportunity Atlas: Mapping the Childhood Roots of Social Mobility"}, {"url": "https://unsplash.com/@andreuuuw?utm_source=medium&utm_medium=referral", "anchor_text": "Andrew Wulf"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@swethalakshmanan14/how-when-and-why-should-you-normalize-standardize-rescale-your-data-3f083def38ff", "anchor_text": "this"}, {"url": "https://opportunityinsights.org/data/", "anchor_text": "Opportunity Insights"}, {"url": "https://opportunityinsights.org/data/", "anchor_text": "Neighborhood Characteristics by Census Tract"}, {"url": "https://opportunityinsights.org/data/", "anchor_text": "All Outcomes by Census Tract, Race, Gender and Parental Income Percentile"}, {"url": "https://unsplash.com/@markusspiske?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Spiske"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@scottwebb?utm_source=medium&utm_medium=referral", "anchor_text": "Scott Webb"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/gioamorim80/Social-Mobility-Classification-Machine-Learning/blob/master/Classfication%20-%20Module%205%20Final%20Project.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fe6abcf0dcb2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/support-vector-machine?source=post_page-----fe6abcf0dcb2---------------support_vector_machine-----------------", "anchor_text": "Support Vector Machine"}, {"url": "https://medium.com/tag/crossvalidation?source=post_page-----fe6abcf0dcb2---------------crossvalidation-----------------", "anchor_text": "Crossvalidation"}, {"url": "https://medium.com/tag/pipeline?source=post_page-----fe6abcf0dcb2---------------pipeline-----------------", "anchor_text": "Pipeline"}, {"url": "https://medium.com/tag/python?source=post_page-----fe6abcf0dcb2---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe6abcf0dcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=-----fe6abcf0dcb2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffe6abcf0dcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=-----fe6abcf0dcb2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffe6abcf0dcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffe6abcf0dcb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fe6abcf0dcb2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fe6abcf0dcb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gio.amorim?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gio.amorim?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Giovanna Fernandes"}, {"url": "https://medium.com/@gio.amorim/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "70 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1b24a810b12b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=post_page-1b24a810b12b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F1b24a810b12b%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclassifying-social-mobility-with-machine-learning-fe6abcf0dcb2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}