{"url": "https://towardsdatascience.com/hotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363", "time": 1683012121.3181021, "path": "towardsdatascience.com/hotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363/", "webpage": {"metadata": {"title": "Hotelling-T\u00b2 based Variable Selection in Partial Least Square (PLS) | by Christian L. Goueguel, PhD | Towards Data Science", "h1": "Hotelling-T\u00b2 based Variable Selection in Partial Least Square (PLS)", "description": "One of the most common challenges encountered in the modeling of spectroscopic data is to select a subset of variables (i.e. wavelengths) out of a large number of variables associated with the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/multivariate-outlier-detection-in-high-dimensional-spectral-data-45878fd0ccb8", "anchor_text": "ROBPCA", "paragraph_index": 4}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0169743916300375", "anchor_text": "Mehmood, 2016", "paragraph_index": 8}], "all_paragraphs": ["One of the most common challenges encountered in the modeling of spectroscopic data is to select a subset of variables (i.e. wavelengths) out of a large number of variables associated with the response variable. It is common for spectroscopic data to have a large number of variables relative to the number of observations. In such a situation, the selection of a smaller number of variables is crucial especially if we want to speed up the computation time and gain in the model\u2019s stability and interpretability. Typically, variable selection methods are classified into two groups:", "\u2022 Filter-based methods: the most relevant variables are selected as a preprocessing step independently of the prediction model.\u2022 Wrapper-based methods: use the supervised learning approach.", "Hence, any PLS-based variable selection is a wrapper method. Wrapper methods need a selection criterion that relies solely on the characteristics of the data at hand.", "Let us consider a regression problem for which the relation between the response variable y (n \u00d7 1) and the predictor matrix X (n \u00d7 p) is assumed to be explained by the linear model y = \u03b2 X, where \u03b2 (p \u00d7 1) is the regression coefficients. Our dataset is comprised of n = 466 observations from various plant materials, and y corresponds to the concentration of calcium (Ca) for each plant. The matrix X is our measured LIBS spectra that includes p = 7151 wavelength variables. Our objective is therefore to find some columns subsets of X with satisfactorily predictive power for the Ca content.", "Let\u2019s first perform robust principal components analysis (ROBPCA) to help visualize our data and detect whether there is an unusual structure or pattern. The obtained scores are illustrated by the scatterplot below in which the ellipses represent the 95% and 99% confidence interval from the Hotelling\u2019s T\u00b2. Most observations are below the 95% confidence level, albeit some observations seem to cluster on the top-right corner of the scores scatterplot.", "However, when looking more closely, for instance using the outlier map, we can see that ultimately there are only three observations that seem to pose a problem. We have two observations flagged as orthogonal outliers and only one as a bad leverage point. Some observations are flagged as good leverage points, whilst most are regular observations.", "It is worth mentioning that in our regression problem, ordinary least square (OLS) fitting is no option since n \u226a p. PLS resolves this by searching for a small set of the so-called latent variables (LVs), that performs a simultaneous decomposition of X and y with the constraint that these components explain as much as possible of the covariance between X and y. The figures below are the results obtained from the PLS model. We obtained an R\u00b2 of 0.85 with an RMSE and MAE of 0.08 and 0.06, respectively, which correspond to a mean absolute percentage error (MAPE) of approximately 7%.", "Similarly to the ROBPCA outlier map, the PLS residual plot has flagged three observations that exhibit high standardized residual value. Another way to check for outliers is to calculate Q-residuals and Hotelling\u2019s T\u00b2 from the PLS model, then define a criterion for which an observation is considered as an outlier or not. High Q-residual value corresponds to an observation which is not well explained by the model, while high Hotelling\u2019s T\u00b2 value expresses an observation that is far from the center of regular observations (i.e, score = 0). The results are plotted below.", "Let\u2019s now perform variable selection from our PLS model, which is carried out by computing the T\u00b2 statistic (for more details see Mehmood, 2016),", "where W is the loading weight matrix and C is the covariance matrix. Thus, a variable is selected based on the following criteria,", "where A is number of LVs from our PLS model, and 1-\ud835\udefc is the confidence level (with \ud835\udefc equals 0.05 or 0.01) from the F-distribution.", "Thus, from 7151 variables in our original dataset, only 217 were selected based on the aforementioned selection criterion. The observed vs. predicted plot is displayed below along with the model\u2019s R\u00b2 and RMSE.", "In the results below, the three observations that were flagged as outliers were removed from the dataset. The mean absolute percentage error is 6%.", "In this article, we successfully performed Hotelling-T\u00b2 based variable selection using partial least squares. We obtained a huge reduction (-97%) in the number of selected variables compared to using the model with the full dataset.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Optics & Spectroscopy | Chemometrics | All views are my own."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F165880272363&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----165880272363--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----165880272363--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@christian.goueguel?source=post_page-----165880272363--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christian.goueguel?source=post_page-----165880272363--------------------------------", "anchor_text": "Christian L. Goueguel, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f4f4293ec31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&user=Christian+L.+Goueguel%2C+PhD&userId=3f4f4293ec31&source=post_page-3f4f4293ec31----165880272363---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F165880272363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F165880272363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@benharritt?utm_source=medium&utm_medium=referral", "anchor_text": "Ben Harritt"}, {"url": "https://towardsdatascience.com/multivariate-outlier-detection-in-high-dimensional-spectral-data-45878fd0ccb8", "anchor_text": "ROBPCA"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S0169743916300375", "anchor_text": "Mehmood, 2016"}, {"url": "https://medium.com/tag/data-science?source=post_page-----165880272363---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----165880272363---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/chemometrics?source=post_page-----165880272363---------------chemometrics-----------------", "anchor_text": "Chemometrics"}, {"url": "https://medium.com/tag/spectroscopy?source=post_page-----165880272363---------------spectroscopy-----------------", "anchor_text": "Spectroscopy"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----165880272363---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F165880272363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%25C2%25B2-based-variable-selection-in-partial-least-square-pls-165880272363&user=Christian+L.+Goueguel%2C+PhD&userId=3f4f4293ec31&source=-----165880272363---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F165880272363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%25C2%25B2-based-variable-selection-in-partial-least-square-pls-165880272363&user=Christian+L.+Goueguel%2C+PhD&userId=3f4f4293ec31&source=-----165880272363---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F165880272363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----165880272363--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F165880272363&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----165880272363---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----165880272363--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----165880272363--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----165880272363--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----165880272363--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----165880272363--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----165880272363--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----165880272363--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----165880272363--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christian.goueguel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christian.goueguel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christian L. Goueguel, PhD"}, {"url": "https://medium.com/@christian.goueguel/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "134 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f4f4293ec31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&user=Christian+L.+Goueguel%2C+PhD&userId=3f4f4293ec31&source=post_page-3f4f4293ec31--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff5ccdb85555f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhotelling-t%C2%B2-based-variable-selection-in-partial-least-square-pls-165880272363&newsletterV3=3f4f4293ec31&newsletterV3Id=f5ccdb85555f&user=Christian+L.+Goueguel%2C+PhD&userId=3f4f4293ec31&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}