{"url": "https://towardsdatascience.com/notify-with-python-41b77d51657e", "time": 1683007530.572942, "path": "towardsdatascience.com/notify-with-python-41b77d51657e/", "webpage": {"metadata": {"title": "Notify with Python. Make life easier with Python built\u2026 | by James Briggs | Towards Data Science", "h1": "Notify with Python", "description": "Working in Python, I often run data processing, transfer, and model training scripts. Now, with any reasonable degree of complexity and/or big data, this can take some time. Although often enough we\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/cash-flow-modelling-with-python-59d3cf8f08a2", "anchor_text": "cash-flow modelling tool", "paragraph_index": 17}, {"url": "https://www.samlogic.net/articles/smtp-commands-reference.htm", "anchor_text": "SMTP commands here", "paragraph_index": 38}, {"url": "https://medium.com/u/8a5a880b2851?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "Jason Farlette", "paragraph_index": 47}, {"url": "https://stackoverflow.com/questions/16512592/login-credentials-not-working-with-gmail-smtp", "anchor_text": "this Stack Overflow question", "paragraph_index": 47}, {"url": "https://www.youtube.com/c/jamesbriggs", "anchor_text": "https://www.youtube.com/c/jamesbriggs", "paragraph_index": 53}], "all_paragraphs": ["Working in Python, I often run data processing, transfer, and model training scripts. Now, with any reasonable degree of complexity and/or big data, this can take some time.", "Although often enough we all have some other work to be done whilst waiting for these processing to complete, occasionally, we don\u2019t.", "For this purpose, I put together a set of Python scripts built for this exact problem. I use these scripts to send process updates, visualizations and completion notifications to my phone.", "So, when we do occasionally have those moments of freedom. We can enjoy them without being worried about model progress.", "Okay so the first thing we need to ask is \u2014 what do we need to know?", "Now of-course, this really depends on the work you are doing. For me I have three main processing tasks that have the potential to take up time:", "For each of these, there are of-course different pieces of information that we need to stay informed about. Let\u2019s take a look at an example of each.", "Update every n epochs, must include key metrics. For example, loss and accuracy for training and validation sets.", "Notification of completion (of-course). For this I like to include:", "Let\u2019s take the example of training a neural network to reproduce a given artistic style.", "For this, we want to see; generated images from the model, loss and accuracy plots, and current training time, and a model name.", "In this scenario, every 100 epochs, an email containing all of the above will be sent. Here is one of those emails:", "This one is slightly less glamorous, but in terms of time consumed, is number one by a long-shot.", "We will use the example of bulk data upload to SQL Server using Python (for those of us without BULK INSERT).", "At the end of the upload script, we include a simple message notifying us of upload completion.", "If errors are occasionally thrown, we could also add a try-except clause to catch the error, and add it to a list to include in our update and/or completion email.", "In the case of financial modelling, everything I run is actually pretty quick, so I can only provide you with an \u2018example\u2019 use-case here.", "We will use the example of a cash-flow modelling tool. In-reality, this process take no more than a 10\u201320 seconds, but for now let\u2019s assume we\u2019re hot-shot Wall Street quants processing a few million (rather than hundred) loans.", "With this email, we may want to include a high-level summary of the analysed portfolio. We can randomly select a few loans and visualize key values over the given time period \u2014 giving us a small sample to cross-check model performance is as expected.", "All of the functionality above filters from a single script called notify.py.", "We will use Outlook in our example code. However, translating this to other providers is incredibly easy, which we will also cover quickly at the end.", "There are two Python libraries we need here, email and smtplib.", "The message itself is built using a MIMEMultipart object from the email module. We also use three MIME sub-classes, which we attach to the MIMEMultipart object:", "In addition to these sub-classes, there are also other parameters, such as the Subject value in MimeMultipart. All of these together gives us the following structure.", "Let\u2019s take a look at putting these all together.", "This script, for the most part, is reasonably straightforward. At the top, we have our imports \u2014 which are the MIME parts we covered before, and Python\u2019s os library.", "Following this define a function called message. This allows us to call the function with different parameters and build an email message object with ease. For example, we can write an email with multiple images and attachments like so:", "First we initialize the MIMEMultipart object, assigning it to msg.", "We then set the email subject using the 'Subject' key.", "The attach method allows us to add different MIME sub-classes to our MIMEMultipart object. With this we can add the email body, using the MIMEText sub-class.", "For both images img and attachments attachment, we can pass either nothing, a single file-path, or a list of file-paths.", "This is handled by first checking if the parameters are None, if they are, we pass. Otherwise, we check the data-type given, is it is not a list, we make it one \u2014 this allows us to use the following for loop to iterate through our items.", "At this point we use the MIMEImage and MIMEApplication sub-classes to attach our images and files respectively. For both we use os.basename to retrieve the filename from the given file-path, which we include as the attachment name.", "Now that we have built our email message object, we need to send it.", "This is where the smtplib module comes in. The code is again, pretty straight-forward, with one exception.", "As we are dealing directly with different email provider\u2019s, and their respective servers, we need different SMTP addresses for each. Fortunately, this is really easy to find.", "Type \u201coutlook smtp\u201d into Google. Without even clicking on a page, we are given the server address smtp-mail.outlook.com, and port number 587.", "We use both of these when initalizing the SMTP object with smtplib.SMTP \u2014 near the beginning of the send function.", "smtp.ehlo() and smtp.starttls() are both SMTP commands. ehlo (Extended Hello) essentially greets the server. starttls informs the server we will be communicating using an encrypted transport level security (TLS) connection. You can learn more about SMTP commands here.", "After this we simply read in our email and password from file, storing both in email and pwd respectively.", "We then login to the SMTP server with smtp.login, and send the email with smtp.sendmail.", "I always send the notifications to myself, but in the case of automated reporting (or for any other reason), you may want to send the email elsewhere. To do this, change the destination_address: smtp.sendmail(email, destination_address, msg.as_string).", "Finally, we terminate the session and close the connection with smtp.quit.", "All of this is placed within a try-except statement. In the case of momentary network connection loss, we will be unable to connect to the server. Resulting in a socket.gaierror.", "Implementing this try-except statement prevents the program from breaking in the case of a lapse in network connection. How you deal with this may differ, depending on how important it is for the email to be sent.", "For me, I use this for ML model training updates and data transfer completion. If an email does not get sent, it doesn\u2019t really matter. So this simple, passive handling of connection loss is suitable.", "Now we have written both parts of our code, we can send emails with just:", "Jason Farlette pointed out that those of you using Gmail may need to \u2018allow access for less secure apps\u2019. Steps for doing so can be found in this Stack Overflow question.", "That is all for email notification and/or automation using Python. Thanks to the email and smptlib libraries this is an incredibly easy process to setup.", "For any processing or training tasks that consume a lot of time, progress updates and notification on completion, is often truly liberating.", "I hope this article has been useful to a few of you out there, as always, let me know if you have any questions or suggestions!", "I\u2019ve also written other \u2018quick fix\u2019 articles for making our lives easier with Python, check out this one for Excel and Python integration:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Freelance ML engineer learning and writing about everything. I post a lot on YT https://www.youtube.com/c/jamesbriggs"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F41b77d51657e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----41b77d51657e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jamescalam.medium.com/?source=post_page-----41b77d51657e--------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "James Briggs"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9d77a4ca1d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&user=James+Briggs&userId=b9d77a4ca1d1&source=post_page-b9d77a4ca1d1----41b77d51657e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41b77d51657e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41b77d51657e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@simonmigaj?utm_source=medium&utm_medium=referral", "anchor_text": "Simon Migaj"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/cash-flow-modelling-with-python-59d3cf8f08a2", "anchor_text": "cash-flow modelling tool"}, {"url": "https://docs.python.org/3/library/email.html", "anchor_text": "email"}, {"url": "https://docs.python.org/3/library/smtplib.html", "anchor_text": "smtplib"}, {"url": "https://www.samlogic.net/articles/smtp-commands-reference.htm", "anchor_text": "SMTP commands here"}, {"url": "https://medium.com/u/8a5a880b2851?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "Jason Farlette"}, {"url": "https://stackoverflow.com/questions/16512592/login-credentials-not-working-with-gmail-smtp", "anchor_text": "this Stack Overflow question"}, {"url": "https://towardsdatascience.com/excel-to-python-79b01638f2d9", "anchor_text": "Excel to PythonBuilding front-end Excel workbooks for Python toolstowardsdatascience.com"}, {"url": "https://medium.com/tag/python?source=post_page-----41b77d51657e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----41b77d51657e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/technology?source=post_page-----41b77d51657e---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/data-science?source=post_page-----41b77d51657e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/software-development?source=post_page-----41b77d51657e---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41b77d51657e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&user=James+Briggs&userId=b9d77a4ca1d1&source=-----41b77d51657e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F41b77d51657e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&user=James+Briggs&userId=b9d77a4ca1d1&source=-----41b77d51657e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41b77d51657e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F41b77d51657e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----41b77d51657e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----41b77d51657e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----41b77d51657e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----41b77d51657e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----41b77d51657e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----41b77d51657e--------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "James Briggs"}, {"url": "https://jamescalam.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.6K Followers"}, {"url": "https://www.youtube.com/c/jamesbriggs", "anchor_text": "https://www.youtube.com/c/jamesbriggs"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9d77a4ca1d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&user=James+Briggs&userId=b9d77a4ca1d1&source=post_page-b9d77a4ca1d1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F75e31c56d187&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnotify-with-python-41b77d51657e&newsletterV3=b9d77a4ca1d1&newsletterV3Id=75e31c56d187&user=James+Briggs&userId=b9d77a4ca1d1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}