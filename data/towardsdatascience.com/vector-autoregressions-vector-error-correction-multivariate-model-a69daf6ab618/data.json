{"url": "https://towardsdatascience.com/vector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618", "time": 1683001335.026179, "path": "towardsdatascience.com/vector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618/", "webpage": {"metadata": {"title": "Time-series Analysis with VAR & VECM: Statistical approach | by Sarit Maitra | Towards Data Science", "h1": "Time-series Analysis with VAR & VECM: Statistical approach", "description": "VECTOR auto-regressive (VAR) integrated model comprises multiple time series and is quite a useful tool for forecasting. It can be considered an extension of the auto-regressive (AR part of ARIMA)\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/granger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6?source=friends_link&sk=af3ee87ac5cac7dc52bcf551d9fcaa88", "anchor_text": "article", "paragraph_index": 2}], "all_paragraphs": ["VECTOR auto-regressive (VAR) integrated model comprises multiple time series and is quite a useful tool for forecasting. It can be considered an extension of the auto-regressive (AR part of ARIMA) model. VAR model involves multiple independent variables and therefore has more than one equations. Each equation uses as its explanatory variables lags of all the variables and likely a deterministic trend. Time series models for VAR are usually based on applying VAR to stationary series with first differences to original series and because of that, there is always a possibility of loss of information about the relationship among integrated series.", "Therefore, differencing the series to make them stationary is one solution, but at the cost of ignoring possibly important (\u201clong run\u201d) relationships between the levels. A better solution is to test whether the levels regressions are trustworthy (\u201ccointegration\u201d.) The usual approach is to use Johansen\u2019s method for testing whether or not cointegration exists. If the answer is \u201cyes\u201d then a vector error correction model (VECM), which combines levels and differences, can be estimated instead of a VAR in levels. So, we shall check if VECM is been able to outperform VAR for the series we have.", "This an extension of my previously published article.", "After necessary cleaning & pre-processing (filling the missing values with previous ones), we finally have the three time series for necessary analysis.", "A quick test is to check if the data is random. Random data will not exhibit a structure in the lag plot.", "The time series plot clearly indicates some kind of relationships among the series. The linear shape of the lag plot suggests that an AR model is a better choice. We also don\u2019t see any outlier in the data. Data here showing linear pattern, indicating the presence of positive auto-correlation.", "\u201cTime series for economic data is generally stochastic or has a trend that is not stationary, meaning that the data has a root unit\u201d", "Through the above function, we can run Augmented Dickey Fuller (ADF) test on all columns, which clearly shows the original series are non-stationary and contain unit root.", "VAR models can also be used for analyzing the relation between the variables involved using Granger Causality tests. Granger causality speci\ufb01es that a variable y1t is causal for a variable y2t if the information in y1t is helpful for improving the forecasts of y2t.", "Granger Causality tests try to determine if one variable(x1) can be used as a predictor of another variable(x2) where the past values of that another variable may or may not help. This means that x1 explains beyond the past values of x2. Two important assumptions here are -", "This means that if x1 and x2 are non-stationary, we have to make them stationary before testing for Granger Causality.", "We will fit the VAR model on X_train to forecast the next 10 observations. These forecasts will be compared against the actuals present in test data (X_test). We shall use multiple forecast accuracy metrics.", "A difference transform is a simple way for removing a systematic structure from the time series. We will remove trend by subtracting the previous value from each value in the series which is the first order differencing. To keep it simple, we will do first order differencing or seasonal differencing.", "If we have an integrated order to n time series and if we take first order to difference and time, we will be left with series integrated order of zero.", "looking at the plot, we could figure out that data set looks like normalized", "Below function plots the auto-correlation plots for the difference in each stock\u2019s price from the price the previous trading day at 75 lags.", "We have shown ACF & PACF of transformed Gold series; likewise, other series can be plotted.", "The Granger causality test is conducted to determine whether one time series is useful in forecasting another. A time series X is said to Granger-cause Y if it can be shown, usually through a series of t-tests and F-tests on lagged values of X (and with lagged values of Y also included), that those X values provide statistically significant information about future values of Y.", "Here, for multivariate Granger causality analysis performed by fitting a VAR to the time series. Considering below is a d-dimensional multivariate time series \u2014", "Granger causality is performed by fitting a VAR model with L time lags as follows:", "where \u03b5 ( t ) is a white Gaussian random vector, and A \u03c4 is a matrix for every \u03c4. A time series X i is called a Granger cause of another time series X j, if at least one of the elements A \u03c4 ( j , i ) for \u03c4 = 1 , \u2026 , L is significantly larger than zero.", "Below output shown for Gold & Oil which differs the test hypothesis till lag 4.", "A VAR(p) process in its basic form is:", "Here yt\u200b\u200b represents a set of variables collected in a vector, c denotes a vector of constants, a is a matrix of autoregressive coefficients and e\u200bt\u200b\u200b is white noise. Since the parameters of a\u200b\u200b are unknown, we have to estimate these parameters. Each variable in the model has one equation. The current (time t) observation of each variable depends on its own lagged values as well as on the lagged values of each other variable in the VAR.", "I have implemented Akaike\u2019s Information Criteria (AIC) through the VAR (p) to determine the lag order value. In the fit function, I have passed a maximum number of lags and the order criterion to use for order selection.", "The forecasts are generated on the training data used by the model.", "So, to bring it back up to its original scale, we need to de-difference to the original input data. Our data is 1st logarithm transformed and then differenced. So, to inverse, we have to first use cumulative sum to de-differentiate and then use exponential. Natural logarithm is the inverse of the exp().", "\u201cLeast squares parameter estimation of dynamic regression models is known to exhibit substantial bias in small samples when the data is fairly persistent\u201d", "VECM imposes additional restriction due to the existence of non-stationary but co-integrated data forms. It utilizes the co-integration restriction information into its specifications. After the cointegration is known then the next test process is done by using error correction method. Through VECM we can interpret long term and short term equations. We need to determine the number of co-integrating relationships. The advantage of VECM over VAR is that the resulting VAR from VECM representation has more efficient coefficient estimates.", "In order to fit a VECM model, we need to determine the number of co-integrating relationships using a VEC rank test.", "We find the \u03bbtrace statistics in the third column, together with the corresponding critical values. The test statistic of 38.25 is lower than the critical value (41.08) and so the null of at most one co-integrating vector cannot be rejected.", "Let us employ an alternative statistic, the maximum-eigenvalue statistic (\u03bbmax).", "The test output reports the results for the \u03bbmax statistics which does not differ much from trace statistic; the critical value (29.28) is still higher than test statistic.", "We will still go ahead and estimate VECM, since it can still valuable for short-run dynamics in absence of co-integration. Let\u2019s estimates the VECM on the prices with 9 lags, 1 co-integrating relationship, and a constant within the co-integration relationship. I have used \u2018cili\u2019 a combination of \u201cci\u201d \u2014 constant within the co-integration relation and \u201cli\u201d \u2014 linear trend within the co-integration relation", "Though we had an indication that, VAR would be best for our data set for price prediction; however, we have shown VECM for experimentation and illustration purpose. This is a simple procedure to explain VAR. However, there are other procedures like impulse response analysis and variance decomposition also can be introduced to experiment if we are able to see how a shock to one variable affects other variable in subsequent periods.", "Time series for economic data is generally stochastic or has a trend that is not stationary, meaning that the data has a root unit. To be able to estimate a model using the data-", "Notice: The programs described here are experimental and should be used with caution. All such use at your own risk.", "(2) Ashley, R. A., & Verbrugge, R. J. (2009). To difference or not to difference: a Monte Carlo investigation of inference in vector autoregression models. International Journal of Data Analysis Techniques and Strategies, 1(3), 242\u2013274.", "(4) Kuo, C. Y. (2016). Does the vector error correction model perform better than others in forecasting stock price? An application of residual income svaluation theory. Economic Modelling, 52, 772\u2013789.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics & Data Science Practice Lead"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa69daf6ab618&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8----a69daf6ab618---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa69daf6ab618&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa69daf6ab618&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://sarit-maitra.medium.com/membership", "anchor_text": "https://sarit-maitra.medium.com/membership"}, {"url": "https://towardsdatascience.com/granger-causality-and-vector-auto-regressive-model-for-time-series-forecasting-3226a64889a6?source=friends_link&sk=af3ee87ac5cac7dc52bcf551d9fcaa88", "anchor_text": "article"}, {"url": "https://www.linkedin.com/in/saritmaitra/", "anchor_text": "here"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----a69daf6ab618---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/tag/data-modeling?source=post_page-----a69daf6ab618---------------data_modeling-----------------", "anchor_text": "Data Modeling"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----a69daf6ab618---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/analytics?source=post_page-----a69daf6ab618---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a69daf6ab618---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa69daf6ab618&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&user=Sarit+Maitra&userId=c611876588a8&source=-----a69daf6ab618---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa69daf6ab618&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&user=Sarit+Maitra&userId=c611876588a8&source=-----a69daf6ab618---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa69daf6ab618&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa69daf6ab618&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a69daf6ab618---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a69daf6ab618--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a69daf6ab618--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a69daf6ab618--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a69daf6ab618--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://sarit-maitra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba440ad8d04d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvector-autoregressions-vector-error-correction-multivariate-model-a69daf6ab618&newsletterV3=c611876588a8&newsletterV3Id=ba440ad8d04d&user=Sarit+Maitra&userId=c611876588a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}