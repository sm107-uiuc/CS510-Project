{"url": "https://towardsdatascience.com/art-with-ai-neural-style-transfer-63d0ef76596a", "time": 1683008991.2993548, "path": "towardsdatascience.com/art-with-ai-neural-style-transfer-63d0ef76596a/", "webpage": {"metadata": {"title": "Art With AI: Neural Style Transfer | by Sivin Varughese | Towards Data Science", "h1": "Art With AI: Neural Style Transfer", "description": "What if you could transform your images into an artwork in the style of famous painters like Vincent Van Gogh or Leonardo da Vinci? Wouldn\u2019t you be surprised to know that Convolutional Neural\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/SivinX11/Neural_Style_Transfer", "anchor_text": "here", "paragraph_index": 20}, {"url": "http://github.com/SivinX11", "anchor_text": "GitHub account", "paragraph_index": 20}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf", "anchor_text": "Image Style Transfer Using Convolutional Neural Networks", "paragraph_index": 22}], "all_paragraphs": ["What if you could transform your images into an artwork in the style of famous painters like Vincent Van Gogh or Leonardo da Vinci? Wouldn\u2019t you be surprised to know that Convolutional Neural Networks can help you not in just learning to classify your image or detecting objects but also to learn the painting or the drawing style of an artist to recreate an image in the artist\u2019s own style? Well, if you are curious to know how you can do that, this article is just for you.", "This Deep Learning technique helps you generate an output image(denoted as G) based on the content image (denoted as C) but drawn or painted in the style of another image(called the style image, denoted as S).", "This technique majorly depends on the way the initial and the deeper layers of ConvNets extract the features from the given style image and implement it on the content image.", "Let\u2019s take a VGG model as an example to illustrate the learning process", "When an image is passed onto the network, and the training is started, each layer would have some activation. Now, if you try to visualize these activations of each layer you\u2019ll find that the initial layers would try to recognize the simple features of the image like edges or borders or shade of a particular color. Whereas the activations of the deeper layers would tend to learn more complex features of the images like shapes, patterns, objects, textures, etc. Approaching the end, the final layers would be able to identify foreground or background objects like cats, dogs, cars, etc.", "This is the basic intuition we use in Neural Style Transfer i.e. to separate the style and content of images. We extract out all the features from the style image, we separate it, and similarly, we separate out the complex features from the content image, this helps us in the generation of the output image.", "The first and the foremost step in this process of building a neural style transfer system is defining the Loss Functions: The content loss and the style loss. The content loss minimization ensures that the difference or error between the deeper layers of the content image and the generated image is the least, and the style loss minimization ensures that the difference or error between all the layers of the style image and the generated image.", "Initially, we define(or initialize) the generated image(g), as a trainable variable, and in fact, it\u2019s the only trainable image as the content(c) and the style image(s) wouldn\u2019t be trained. And the parameters(weights and biases) of the pre-trained model should be frozen.", "The content loss function assists the generated images to incorporate the contents of the content image. When the generated and the content image are fed to the CNN, and activations of different layers are computed, a deeper layer(l)\u2019s output is selected, which is used to find the error between the content and generated image. This loss function basically is the Euclidean distance between these two intermediate layers of the CNN fed with the content image(C) and the generated image(G). And explaining it in simple words, the content loss function gives us the answer to how much the deeper layers of content and generated image are different from each other.", "This is simply the mean squared error between the activations of the layer l of the CNN passed with both the content and the generated image. Note that we only apply the content loss at one and only one layer(l), instead of multiple layers.", "As discussed above, the deeper layers of the convolutional neural networks capture more complex features(or in essence, the content), so it makes sense that if we need the generated image(g) to have the same content as the content image(c), then we will have to minimize the difference between the deeper layers in the feature representation of these two images, or in other words, if two images have very similar features in the deeper layers, it implies that the content in both the images is the same.", "The process of obtaining the style loss is a similar strategy that we applied in the calculation of the content loss, but instead of using the intermediate layer\u2019s raw output, we use the gram matrix of the generated feature maps of the individual layers. And then we apply the loss to all the layers, in contrast to the content loss, which was applied only at a single layer.", "Gram Matrix or Style Matrix is simply a matrix with it\u2019s (i,j)th element is having the output of an element-wise multiplication of the ith and jth feature maps and summing it across the width and height of the image.", "Firstly, at a given layer(l), the mean squared error is calculated between the gram matrices or the style matrices of the feature map representation of the style(s) and generated image(g), which represents the style loss of that layer.", "And secondly, the style loss is applied to each and every layer in the CNN. It is multiplied with an additional weight(wl) which is the weight factor of each layer contributing to the computation of the total loss.", "As discussed above, at any given layer(l), the style loss is calculated by the difference between the correlation of the Gram Matrix or the Style Matrix obtained from the feature maps in that layer(l) of the style image(s) and the generated image(g). And the Gram Matrix, G(l) represents a specific type of correlation between the feature maps of the layer(l). Where Gl(i,j) represents the correlation between the feature maps i and j. Hence, it is quite intuitive that if we minimize the distance between the feature representation of the style(s) and generated image(g), then the generated image would have similar features as the style image because the generated image is the only trainable image and not the style image, hence the generated image starts getting the features of the style image. And as the style loss is applied at all the layers\u2019 feature map representations, it\u2019ll serve the generated image to have even the smallest features of the style image which are identified in the initial layers.", "The total loss or the final loss can be defined as follows:", "The terms \u03b1(alpha) and \u03b2(beta) are hyperparameters and can be tweaked according to user preferences. The more the value of any of hyperparameter, the more will be the contribution of the loss associated with it in the generated image. For example, if a user wants less impact of the style image on the generated image and more of the content image, the user may decrease the hyperparameter \u03b2(beta) and increase the hyperparameter \u03b1(alpha).", "Now after we define the final loss function, the last step of the process remains to minimize this loss using the optimization algorithm.", "The recommended way of optimizing the loss would be using the L-BFGS optimizer. Other methods include using stochastic gradient descent or the use of Adam Optimizer, but that is not recommended because the data is not Stochastic i.e diving the dataset into small mini-batches doesn\u2019t work as the input is a single static image. Also, the L-BFGS Optimizer is faster in learning than compared to Adam Optimizer for the task of neural style transfer.", "So, in a similar way, you can try out different combinations of style and content images, to create various artworks, the Python Notebook is available here, on my GitHub account.", "Now you can keep your creativity running to generate artworks like these:", "Based on the paper: Image Style Transfer Using Convolutional Neural Networks by Leon A. Gatys, Alexander S. Ecker, and Matthias Bethge.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Deep Learning and Machine Learning Enthusiast."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F63d0ef76596a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sivinx11?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sivinx11?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": "Sivin Varughese"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76816c1380b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&user=Sivin+Varughese&userId=76816c1380b4&source=post_page-76816c1380b4----63d0ef76596a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d0ef76596a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d0ef76596a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/SivinX11/Neural_Style_Transfer", "anchor_text": "here"}, {"url": "http://github.com/SivinX11", "anchor_text": "GitHub account"}, {"url": "https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf", "anchor_text": "Image Style Transfer Using Convolutional Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----63d0ef76596a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----63d0ef76596a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artwork?source=post_page-----63d0ef76596a---------------artwork-----------------", "anchor_text": "Artwork"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----63d0ef76596a---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----63d0ef76596a---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63d0ef76596a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&user=Sivin+Varughese&userId=76816c1380b4&source=-----63d0ef76596a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F63d0ef76596a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&user=Sivin+Varughese&userId=76816c1380b4&source=-----63d0ef76596a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F63d0ef76596a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F63d0ef76596a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----63d0ef76596a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----63d0ef76596a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----63d0ef76596a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----63d0ef76596a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----63d0ef76596a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sivinx11?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sivinx11?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sivin Varughese"}, {"url": "https://medium.com/@sivinx11/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76816c1380b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&user=Sivin+Varughese&userId=76816c1380b4&source=post_page-76816c1380b4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F76816c1380b4%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fart-with-ai-neural-style-transfer-63d0ef76596a&user=Sivin+Varughese&userId=76816c1380b4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}