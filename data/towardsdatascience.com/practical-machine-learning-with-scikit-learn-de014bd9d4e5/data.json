{"url": "https://towardsdatascience.com/practical-machine-learning-with-scikit-learn-de014bd9d4e5", "time": 1683018161.447988, "path": "towardsdatascience.com/practical-machine-learning-with-scikit-learn-de014bd9d4e5/", "webpage": {"metadata": {"title": "Practical Machine Learning with Scikit-Learn | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Practical Machine Learning with Scikit-Learn", "description": "Customer churn is an important issue for every business. While looking for ways to expand customer portfolio, businesses also focuses on keeping the existing customers. Thus, it is crucial to learn\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/sakshigoyal7/credit-card-customers", "anchor_text": "dataset", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/why-we-care-about-the-log-loss-50c00c8e777c", "anchor_text": "Log loss", "paragraph_index": 39}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 47}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 47}], "all_paragraphs": ["Customer churn is an important issue for every business. While looking for ways to expand customer portfolio, businesses also focuses on keeping the existing customers. Thus, it is crucial to learn the reasons why existing customers churn (i.e. leaves).", "Churn prediction is a common task in predictive analytics. In this article, we will try to predict whether a customer will leave the credit card services of a bank. The dataset is available on Kaggle.", "We will first try to understand the dataset and explore the relationships among variables. After that, we will create pipelines to transform features to an appropriate format for model training. In the final step, we will combine the feature transformation pipeline and a machine learning model in a new pipeline.", "The first step is to read the dataset into a pandas dataframe.", "I have excluded the redundant columns in the dataset using the usecols parameter.", "There are 20 columns. The screenshot above only includes 7 columns for demonstration purposes. We can view the entire list of columns by using the \u201ccolumns\u201d method.", "We should always check the missing values in the dataframe.", "The isna function of Pandas returns true if a value is missing. We can apply sum functions to count the number of missing values in each column or entire dataframe. Since there is no missing values, we can move on.", "The first column (Attrition_Flag) is the target variable which indicates if a customer is attrited (i.e. churned or left the company).", "Only 16 percent of the customers churned which I think is high. This is the reason why the bank is investigating the issue and trying to understand why these customers churned.", "It makes it easier for analysis to have numbers instead of strings for values of the target variable. Thus, we will replace \u201cattrited customer\u201d values with 1 and \u201cexisting customer\u201d with 0.", "The dataset contains both categorical and numerical features. We will first try to explore the relationship between the categorical features and the target variable.", "The select_dtypes function can be used to filter columns based on the data types.", "One way to analyze categorical features is the group by function of pandas. It gives us an overview of how a numerical values changes based on the groups in a categorical variable.", "The churned customers are indicated by 1 in the attrition flag column. Thus, the higher the average value, the more likely the customer churn is.", "It seems like females are slightly more likely to churn than males. The marital status does not seem to be a significant factor in customer churn.", "Let\u2019s also check the average churn rate based on education level.", "Customers with a doctorate degree has the highest average churn rate.", "We can check the other categorical variables in a similar way.", "One measure that gives us an idea about the relationships between numerical variables is the correlation coefficient.", "The corr function of Pandas creates a dataframe of correlation coefficients between variables. We can check the correlations on the dataframe or visualize them using a heatmap. I prefer the latter because it provides a more structured and informative overview.", "The first row of the heatmap is what we are mostly interested in. It shows the correlation coefficients between the target variable (Attrition_Flag) and other variables.", "I have sorted the correlation coefficients based on the absolute value because we are interested in all correlations, not only the positive ones.", "The correlation coefficient between customer age and churn is very low. We can also check the average age of churned and not-churned customers.", "The difference is so small that we can ignore the customer age variable and not include it in the model.", "\u201cMonths on book\u201d and \u201caverage open to buy\u201d variables also have very small correlation with the target. Scatter plot is a useful plot to compare and analyze numerical variables.", "We do not see any pattern that distinguishes churned and not-churned customers based on these two variables. We can also exclude them from the model.", "In the heatmap, we also see that total transaction amount and total transaction count are highly correlated. We can visualize these two variables on a scatter plot for further analysis.", "Both of these variables are important in separating churned and not-churned customers. However, it would be overdoing to include both because they are highly correlating. We can just use one of them.", "We will use scikit-learn pipelines to do feature preprocessing steps and model training. Before creating the pipelines, we need to drop the features that will not be included in the model.", "The numerical and categorical features require different kinds of preprocessing techniques. Thus, we will create separate pipelines for numerical and categorical features and them combine them in another transformer. The final pipeline will include the combined transformer and a machine learning model.", "Since different transformations will be applied on numerical and categorical features, we will create lists for two different kinds of features.", "The numerical transformer will scale the feature values using the MinMaxScaler and the categorical transformer will encode the categories using the OneHotEncoder.", "We will use the column transformer module to apply the transformers to relevant features.", "The next step is to combine the column transformer with a machine learning model in a new pipeline.", "Note: It is important to note that we do not actually need these feature transformations for a tree based model (e.g. random forests). However, it is better to create a general pipeline in case we want to use other types of machine learning models.", "The clf is pipeline that transforms features by using the transformer pipelines in the column transformer (preprocess) and then train a random forest classifier with these features.", "The next step is to separate training and test sets and train the clf pipeline.", "We now have a pipeline that contains a trained random forest classifier. We can make predictions and evaluate the performance.", "When it comes to a classification task, log loss is one of the most commonly used metrics. Log loss (i.e. cross-entropy loss) evaluates the performance by comparing the actual class labels and the predicted probabilities. The comparison is quantified using cross-entropy.", "The performance is fairly good. However, there is always room for improvement. The model is slightly overfit on the training set since there is a small difference between the losses on training and test sets.", "We can apply hyperparameter tuning and cross validation to improve the performance of our model. We can also try different types of machine learning models.", "We have covered a typical machine learning model creating process. We first tried to explore the data and understand the relationships among variables. Some features were found to be redundant and dropped.", "We have used pipelines to combine feature transformations and model creation. The main advantage of using pipelines is to simplify the preprocessing by combining many different operations in a single pipeline.", "We can use pipelines for model selection as well. For instance, the clf pipeline we have created can be used to try different models. We can iterate over a list of models and use each model in the pipeline.", "Thank you for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fde014bd9d4e5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----de014bd9d4e5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde014bd9d4e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde014bd9d4e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mrthetrain?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Joshua Hoehne"}, {"url": "https://unsplash.com/s/photos/bank?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/sakshigoyal7/credit-card-customers", "anchor_text": "dataset"}, {"url": "https://towardsdatascience.com/why-we-care-about-the-log-loss-50c00c8e777c", "anchor_text": "Log loss"}, {"url": "https://medium.com/tag/data-science?source=post_page-----de014bd9d4e5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----de014bd9d4e5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----de014bd9d4e5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----de014bd9d4e5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----de014bd9d4e5---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fde014bd9d4e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----de014bd9d4e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fde014bd9d4e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----de014bd9d4e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fde014bd9d4e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fde014bd9d4e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----de014bd9d4e5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----de014bd9d4e5--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-scikit-learn-de014bd9d4e5&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}