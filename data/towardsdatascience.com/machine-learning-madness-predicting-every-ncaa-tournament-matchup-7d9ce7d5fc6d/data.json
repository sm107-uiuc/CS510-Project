{"url": "https://towardsdatascience.com/machine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d", "time": 1682993277.568693, "path": "towardsdatascience.com/machine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d/", "webpage": {"metadata": {"title": "Machine Learning Madness: Predicting Every NCAA Tournament Matchup | by Conor Dewey | Towards Data Science", "h1": "Machine Learning Madness: Predicting Every NCAA Tournament Matchup", "description": "It\u2019s that time of the year again. March Madness is here, that means it\u2019s time to fill out your brackets and promptly be disappointed when it\u2019s inevitably busted for all your friends and family to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/mens-machine-learning-competition-2018", "anchor_text": "Google Cloud & NCAA\u00ae Machine Learning Competition", "paragraph_index": 3}, {"url": "https://www.kaggle.com", "anchor_text": "Kaggle", "paragraph_index": 3}, {"url": "https://kenpom.com", "anchor_text": "Ken Pomeroy", "paragraph_index": 6}, {"url": "http://sagarin.com/sports/cbsend.htm", "anchor_text": "Jeff Sagarin", "paragraph_index": 6}, {"url": "https://www.masseyratings.com/cb/compare.htm", "anchor_text": "Massey composite rankings", "paragraph_index": 10}, {"url": "http://sagarin.com/sports/cbsend.htm", "anchor_text": "Sagarin", "paragraph_index": 10}, {"url": "https://kenpom.com", "anchor_text": "Pomeroy", "paragraph_index": 10}, {"url": "http://sonnymoorepowerratings.com/m-basket.htm", "anchor_text": "Moore", "paragraph_index": 10}, {"url": "http://sawhitlock.home.mindspring.com", "anchor_text": "Whitlock", "paragraph_index": 10}, {"url": "https://fivethirtyeight.com/sports/", "anchor_text": "FiveThirtyEight", "paragraph_index": 12}, {"url": "https://www.kaggle.com/lpkirwin/fivethirtyeight-elo-ratings", "anchor_text": "Liam Kirwin\u2019s implementation", "paragraph_index": 12}, {"url": "https://github.com/zachmayer/kaggleNCAA", "anchor_text": "kaggleNCAA", "paragraph_index": 17}, {"url": "https://github.com/conordewey3/Kaggle-March-Madness-Machine-Learning-2018", "anchor_text": "Github", "paragraph_index": 20}, {"url": "https://twitter.com/cdeweyx", "anchor_text": "follow me", "paragraph_index": 21}, {"url": "https://www.conordewey.com/", "anchor_text": "my newsletter", "paragraph_index": 21}, {"url": "https://www.conordewey.com/", "anchor_text": "my website", "paragraph_index": 21}, {"url": "https://www.conordewey.com", "anchor_text": "https://www.conordewey.com", "paragraph_index": 23}], "all_paragraphs": ["It\u2019s that time of the year again. March Madness is here, that means it\u2019s time to fill out your brackets and promptly be disappointed when it\u2019s inevitably busted for all your friends and family to see.", "It\u2019s not all bad news though. The NCAA Division I Men\u2019s Basketball Tournament is one of the most exciting sporting events of the year thanks to the upsets, cinderellas, and unpredictability that come with it. Millions of basketball fans and non-basketball fans alike grab their virtual sharpies every March to participate in this phenomenon with hopes of achieving an improbable perfect bracket. Just how improbable? Given you know a little about basketball, professors put your odds conservatively at 1 in 128 billion.", "Thanks to my upbringing and an excess of Sportscenter growing up, I\u2019ve been an avid college basketball fan for as long as I can remember. Each year I look forward to conducting research and methodically filling out a bracket.", "However, this year I decided to try my hand at modeling the tournament for the first time after recieving an email regarding an upcoming Kaggle competition titled: Google Cloud & NCAA\u00ae Machine Learning Competition. If you aren\u2019t familiar with Kaggle, it\u2019s branded as the \u2018Home for Data Science & Machine Learning\u2019. Kaggle hosts machine learning competitions, collects interesting datasets, and features guides to help you grow as a data scientist.", "The goal of the contest is to utilize past tournament results to build and test models in order to forecast outcomes of all possible match-ups in the 2018 NCAA Division I Men\u2019s Basketball Championship. These outcomes are to be computed probabilistically, for example, Team A has a 55% chance to beat Team B. Each final submission is then evaluated and ranked on the public leaderboard using a metric known as log loss. If you aren\u2019t familiar with log loss, just know that smaller is better. The use of the logarithm provides extreme punishments for being both confident and wrong as seen in the formula below:", "Coming into this project, I had a general idea of what I wanted to do with it. With this being said, I did some research on similar projects from previous years where I discovered a couple insights that proved useful to me.", "First, it seemed like a lot of models went with logistic regression as their primary algorithm due to it\u2019s probabilistic nature and effective, yet simple implementation. Second, many models utilized other highly acclaimed rankings and scoring systems out there like those by Ken Pomeroy and Jeff Sagarin.", "Using prior domain knowledge, along with these insights from research, I decided to take a similar approach to other models out there while making a few interesting changes. My high-level approach can be broken down into several steps:", "Following this approach, my model consists of two different parts. Each of these parts are uniquely weighted and used to generate each team\u2019s composite score. Check out the visualization below for an overview of the various inputs:", "These weights were selected after testing several variations against each other. Over the rest of the article, I will go into each portion of the model in a bit more detail before ultimately simulating this years tournament results.", "One of the resources that I found most useful was a dataset containing Massey composite rankings over time. Massey rankings serve as a destination for checking all the other ranking systems out there. I made the decision to select the highest performing systems available and average out the scores. After fitting and testing separate logistic regression models for each consistently updated system, I found the the highest performing metrics to be Sagarin (SAG), Pomeroy (POM), Moore (MOR), and Whitlock (WLK).", "After compiling a mean score of these rankings, I fit and tested logistic regression on this feature alone and got a log loss of -0.543 which was an improvement over both my baseline seed-based model and an overall average ranking implementation.", "If you\u2019ve ever looked at any of the methodology behind a FiveThirtyEight sports prediction, you\u2019ve probably come across Elo once or twice. Nate Silver and the team there are huge advocates of Elo so after I came across Liam Kirwin\u2019s implementation on Kaggle, I had to look into incorporating it into my model somehow.", "If you aren\u2019t familiar with the Elo rating system, it\u2019s an iterative method for calculating the relative skill levels of players in zero-sum games. You may have heard of it being used for chess or other board/video games, but just know that the applications are endless. Elo is typically calculated using the formula below:", "Calculating the Elo score for each team took some time since the program had to iterate through every game played and adjust the corresponding team\u2019s rating. Once calculated, the Elo-based logistic regression model also performed quite well with a log loss of -0.543 to tie the previous result from the select ranking model.", "Once both of the prior scores were collected, they were rescaled to both fall between 0 and 1 . They were then weighted using the above methodology and subsequently compiled into the final composite score for each team which was ultimately used for our logistic regression model. The model scored a log loss of -0.540 on the training data using cross validation, which was a slight improvement over either portion on it\u2019s own!", "For a better idea of what the composite scores looked like, check out the top ten best teams in this year\u2019s tournament according to the metric:", "All of this is good stuff, but what we really want to see is how all of these scores and probabilities apply to this year\u2019s bracket! Thanks to Zach Mayer\u2019s awesome R package titled kaggleNCAA, this was fairly easy to accomplish. After running my model with 1000 simulations, I got the following results:", "As you can see, in the long term, my model predicts the most likely winner to be Virginia with a 16% chance. Some interesting picks also include Duke (2) and Gonzaga (4) as favorites to reach the Final Four and likely first round upsets from both Florida St. (9) and Loyola-Chicago (11).", "Congrats if you made it this far! Overall, I\u2019m happy to say the undertaking of this project has made me a more competent data scientist. I\u2019m also very excited to check out this year\u2019s tournament and more than anything, I\u2019m eager to tune and improve my model for next year!", "For the code and full Jupyter Notebook, see my Github.", "Thanks for reading! If you enjoyed this post, go ahead and show the clap button some love. Interested in more posts to come? Make sure to follow me and subscribe to my newsletter below to receive any new content. For more on me and what I\u2019m up to, check out my website.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Product at Metabase. Previously growth at Hugo and data science at Squarespace. Writing here now: https://www.conordewey.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7d9ce7d5fc6d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cdeweyx.medium.com/?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": ""}, {"url": "https://cdeweyx.medium.com/?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": "Conor Dewey"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fee856fa71ed0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&user=Conor+Dewey&userId=ee856fa71ed0&source=post_page-ee856fa71ed0----7d9ce7d5fc6d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d9ce7d5fc6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d9ce7d5fc6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/mens-machine-learning-competition-2018", "anchor_text": "Google Cloud & NCAA\u00ae Machine Learning Competition"}, {"url": "https://www.kaggle.com", "anchor_text": "Kaggle"}, {"url": "https://kenpom.com", "anchor_text": "Ken Pomeroy"}, {"url": "http://sagarin.com/sports/cbsend.htm", "anchor_text": "Jeff Sagarin"}, {"url": "https://www.masseyratings.com/cb/compare.htm", "anchor_text": "Massey composite rankings"}, {"url": "http://sagarin.com/sports/cbsend.htm", "anchor_text": "Sagarin"}, {"url": "https://kenpom.com", "anchor_text": "Pomeroy"}, {"url": "http://sonnymoorepowerratings.com/m-basket.htm", "anchor_text": "Moore"}, {"url": "http://sawhitlock.home.mindspring.com", "anchor_text": "Whitlock"}, {"url": "https://fivethirtyeight.com/sports/", "anchor_text": "FiveThirtyEight"}, {"url": "https://www.kaggle.com/lpkirwin/fivethirtyeight-elo-ratings", "anchor_text": "Liam Kirwin\u2019s implementation"}, {"url": "https://github.com/zachmayer/kaggleNCAA", "anchor_text": "kaggleNCAA"}, {"url": "https://github.com/conordewey3/Kaggle-March-Madness-Machine-Learning-2018", "anchor_text": "Github"}, {"url": "https://twitter.com/cdeweyx", "anchor_text": "follow me"}, {"url": "https://www.conordewey.com/", "anchor_text": "my newsletter"}, {"url": "https://www.conordewey.com/", "anchor_text": "my website"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7d9ce7d5fc6d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7d9ce7d5fc6d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/march-madness?source=post_page-----7d9ce7d5fc6d---------------march_madness-----------------", "anchor_text": "March Madness"}, {"url": "https://medium.com/tag/python?source=post_page-----7d9ce7d5fc6d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/big-data?source=post_page-----7d9ce7d5fc6d---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d9ce7d5fc6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&user=Conor+Dewey&userId=ee856fa71ed0&source=-----7d9ce7d5fc6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7d9ce7d5fc6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&user=Conor+Dewey&userId=ee856fa71ed0&source=-----7d9ce7d5fc6d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7d9ce7d5fc6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7d9ce7d5fc6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7d9ce7d5fc6d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7d9ce7d5fc6d--------------------------------", "anchor_text": ""}, {"url": "https://cdeweyx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cdeweyx.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Conor Dewey"}, {"url": "https://cdeweyx.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9K Followers"}, {"url": "https://www.conordewey.com", "anchor_text": "https://www.conordewey.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fee856fa71ed0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&user=Conor+Dewey&userId=ee856fa71ed0&source=post_page-ee856fa71ed0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8f3d998f2747&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d&newsletterV3=ee856fa71ed0&newsletterV3Id=8f3d998f2747&user=Conor+Dewey&userId=ee856fa71ed0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}