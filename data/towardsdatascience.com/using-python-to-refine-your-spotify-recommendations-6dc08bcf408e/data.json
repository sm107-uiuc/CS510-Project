{"url": "https://towardsdatascience.com/using-python-to-refine-your-spotify-recommendations-6dc08bcf408e", "time": 1683018023.9881248, "path": "towardsdatascience.com/using-python-to-refine-your-spotify-recommendations-6dc08bcf408e/", "webpage": {"metadata": {"title": "Using Python to Refine Your Spotify Recommendations | by Merlin Sch\u00e4fer | Towards Data Science", "h1": "Using Python to Refine Your Spotify Recommendations", "description": "Music plays a large role in many people\u2019s lives, it\u2019s hard to imagine a day without it. It's time to combine Python and Spotify to enhance your recommendations."}, "outgoing_paragraph_urls": [{"url": "https://spotipy.readthedocs.io/en/2.16.1/#", "anchor_text": "spotipy", "paragraph_index": 3}, {"url": "https://developer.spotify.com/documentation/general/guides/scopes/", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://github.com/MerlinSchaefer/spotify_app/blob/main/spotifuncs.py", "anchor_text": "here", "paragraph_index": 10}], "all_paragraphs": ["Music plays a large role in many people\u2019s lives, it\u2019s hard to imagine a day without it. I, like many others mainly consume it through streaming on Spotify. If you ever scrolled down to the end of your playlist you have met Spotify\u2019s recommendations. Once in a while they seem spot on, at other times I wonder whether the recommender system took a wrong turn somewhere. But maybe that\u2019s just me and my diverse taste in music.", "If you are satisfied with your recommendations you can still use this article to learn how to use the Spotify API with spotipy and how to successfully go through the authentication process.", "The Spotify API enables you to get user data or recommendations, create or modify playlists, and much more. To use it you need to go through an initial setup with the following steps:", "After this initial setup, you will have to generate an authentification token with the Python library spotipy.", "This can be done by providing some info in the code below. You need to enter your username, Client ID, Client Secret and Redirect URI, which you find when opening your app dashboard.", "You also need to set a scope of authorizations. For our purposes, the scope needs to contain at least \u201cplaylist-modify-public\u201d. If you want to explore your data or do other things you need to add more to your scope.To view all available scopes click here.", "Initially, you may get a prompt asking you to paste the URI you were directed to. You only need to do this once as long as you don\u2019t change scopes or usernames. After successfully getting the Spotipy authentication token you can use the API to start exploring and modifying your Spotify playlists.", "If you want to do more than just get some new songs into your playlist once, I recommend writing a small function with the above steps to shorten the authentification process.", "When you query any data from the API, it will return a pretty large and complex dictionary. These dictionaries also vary a little in structure depending on whether you query saved songs, playlists, recently played tracks, or artists.", "To make life easier I suggest figuring out the structure and then writing a function to extract the relevant data from the dictionary to store it in a DataFrame. The next code block shows the create_df_playlist() function which returns a DataFrame from the sp.playlist()-query results and the append_audio_features() function which appends Spotify\u2019s audio features to all songs in a given DataFrame. These are two functions we will use in our script.", "I wrote a couple of functions while working with the Spotify API which might be helpful if you want to explore it further. You can find all of my functions here. Please note that they are still subject to change. Any help or constructive feedback is also very welcome.", "Now let\u2019s get to the fun stuff.", "In the code below I query playlist data from the API and create a DataFrame from it. I then create a list of all tracks from the playlist to be used as \u201cseed tracks\u201d by Spotify\u2019s recommendation.", "As the API does not allow a long list of seed tracks I divided them up into \u201cpackages\u201d of five tracks. These packages are used to get 25 recommended tracks with audio features. The process is repeated until we got recommendations for every song.", "Now that we have a lot of recommendations it is time to filter them a little bit more.", "There are a couple of approaches that could be used for such a task. I opted for calculating similarity scores between the audio features and selecting the most similar songs based on these scores.Additionally, I also filtered the recommendations again by how similar they were to a \u201cmean song\u201d (the average of all audio features in the playlist DataFrame). I\u2019m not going to discuss this here, as it\u2019s just a small step from everything presented and only works well for playlists with songs of a similar sound/genre.", "The similarity score is calculated through the function below. Note that I am only using the audio features to determine similarity. You could also include popularity or duration if you wanted.", "I found that using cosine similarity works pretty well, however I encourage you to try out other methods, maybe you find an even better one.", "After creating the similarity matrix through the function above, we end up with a matrix that contains one row for each song in our original playlist and one column for each recommended song. I then used np.argmax() on each row to retrieve the index of the recommended song that is most similar to the respective song in the playlist. The recommendations DataFrame is filtered down through the use of these indices. As the last step, I check whether any recommended tracks are already in the playlist and reset the index.", "We now have a DataFrame with recommended songs that can either be filtered more, sampled from, or just added to the playlist.", "To add to a playlist we simply use user_playlist_add_tracks()from spotipy. The function requires your username, the playlist URI and a list of track ids that should be added to the playlist.", "I encourage you to explore spotipy and the Spotify API more. You could find out which artists you listen to most, which songs are your all-time favorites, or build more playlists for yourself and others.", "Enjoy listening to your playlist, whilst coding or otherwise!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at HMS Analytical Software with a psychology background. Interested in all things \u201cdata\u201d, cloud and AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6dc08bcf408e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ms101196.medium.com/?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": ""}, {"url": "https://ms101196.medium.com/?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": "Merlin Sch\u00e4fer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a2c8842187b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=post_page-5a2c8842187b----6dc08bcf408e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dc08bcf408e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dc08bcf408e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sgcreative?utm_source=medium&utm_medium=referral", "anchor_text": "sgcdesignco"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://developer.spotify.com/dashboard/", "anchor_text": "Spotify Developer"}, {"url": "https://spotipy.readthedocs.io/en/2.16.1/#", "anchor_text": "spotipy"}, {"url": "https://developer.spotify.com/documentation/general/guides/scopes/", "anchor_text": "here"}, {"url": "https://unsplash.com/@stereophototyp?utm_source=medium&utm_medium=referral", "anchor_text": "Sara Kurfe\u00df"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/MerlinSchaefer/spotify_app/blob/main/spotifuncs.py", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6dc08bcf408e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/spotify?source=post_page-----6dc08bcf408e---------------spotify-----------------", "anchor_text": "Spotify"}, {"url": "https://medium.com/tag/api?source=post_page-----6dc08bcf408e---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/data?source=post_page-----6dc08bcf408e---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/recommendations?source=post_page-----6dc08bcf408e---------------recommendations-----------------", "anchor_text": "Recommendations"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6dc08bcf408e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=-----6dc08bcf408e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6dc08bcf408e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=-----6dc08bcf408e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dc08bcf408e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6dc08bcf408e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6dc08bcf408e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6dc08bcf408e--------------------------------", "anchor_text": ""}, {"url": "https://ms101196.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ms101196.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Merlin Sch\u00e4fer"}, {"url": "https://ms101196.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "129 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a2c8842187b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=post_page-5a2c8842187b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F18a27e283ce1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-python-to-refine-your-spotify-recommendations-6dc08bcf408e&newsletterV3=5a2c8842187b&newsletterV3Id=18a27e283ce1&user=Merlin+Sch%C3%A4fer&userId=5a2c8842187b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}