{"url": "https://towardsdatascience.com/how-to-make-your-machine-learning-models-more-explainable-f20f75928f37", "time": 1683016917.135149, "path": "towardsdatascience.com/how-to-make-your-machine-learning-models-more-explainable-f20f75928f37/", "webpage": {"metadata": {"title": "How to make your machine learning models more explainable | by Amol Mavuduru | Towards Data Science", "h1": "How to make your machine learning models more explainable", "description": "One of the biggest challenges involved in solving business problems using machine learning is effectively explaining your model to a non-technical audience. For example, if you work as a data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.scikit-yb.org/en/latest/", "anchor_text": "yellowbrick", "paragraph_index": 3}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME", "paragraph_index": 3}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP", "paragraph_index": 3}, {"url": "https://www.scikit-yb.org/en/latest/", "anchor_text": "yellowbrick", "paragraph_index": 17}, {"url": "https://github.com/AmolMavuduru/ExplainableML", "anchor_text": "code", "paragraph_index": 17}, {"url": "https://github.com/AmolMavuduru/ExplainableML", "anchor_text": "GitHub", "paragraph_index": 17}, {"url": "https://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "famous IMDB Movie Review Dataset", "paragraph_index": 18}, {"url": "https://www.kaggle.com/camnugent/california-housing-prices", "anchor_text": "California Housing Prices Dataset", "paragraph_index": 19}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME", "paragraph_index": 21}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP", "paragraph_index": 21}, {"url": "https://github.com/AmolMavuduru/ExplainableML", "anchor_text": "GitHub", "paragraph_index": 21}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME", "paragraph_index": 22}, {"url": "https://www.kaggle.com/camnugent/california-housing-prices", "anchor_text": "California Housing Prices Dataset", "paragraph_index": 23}, {"url": "https://github.com/slundberg/shap#citations", "anchor_text": "SHAP", "paragraph_index": 28}, {"url": "https://proceedings.neurips.cc/paper/2017/hash/8a20a8621978632d76c43dfd28b67767-Abstract.html", "anchor_text": "paper", "paragraph_index": 28}, {"url": "https://shap.readthedocs.io/en/latest/generated/shap.KernelExplainer.html", "anchor_text": "KernelExplainer", "paragraph_index": 29}, {"url": "https://github.com/AmolMavuduru/ExplainableML", "anchor_text": "GitHub repository", "paragraph_index": 35}], "all_paragraphs": ["One of the biggest challenges involved in solving business problems using machine learning is effectively explaining your model to a non-technical audience.", "For example, if you work as a data scientist in an internship or a full-time position at a company, at some point you may have to present the results of your work to management. Similarly, if you decide to start a business based on machine learning, you will have to explain your models to stakeholders and investors in a way that makes sense. In both situations, your audience may lack a detailed understanding of machine learning algorithms. They probably aren\u2019t concerned with the number of layers in your neural network or the number of trees in your random forest. These are the questions that really matter to them:", "If you can answer these questions, your audience will have a better understanding of your work as a data scientist and how it can provide tangible value.", "The goal of this article is to demonstrate how you can answer these questions and leverage frameworks such as yellowbrick, LIME, and SHAP to provide visual explanations of your model\u2019s performance and behavior regardless of how complex it is.", "As data scientists and machine learning practitioners, we take pride in our models and the technical aspects of our work. If you have a really solid understanding of the statistics and math behind your work and the algorithms that you chose or the flashy Python libraries that you used, you may be tempted to impress your stakeholders by making these details the focus of your presentation. By doing this, you are essentially trying to sell the technology first, which is a great strategy for a technical conference, but not a very good strategy for a business pitch or a presentation to management.", "\u201cYou\u2019ve got to start with the customer experience and work backward to the technology. You can\u2019t start with the technology then try to figure out where to sell it.\u201d \u2014 Steve Jobs, Apple\u2019s Worldwide Developers Conference, 1997.", "Instead, you need to sell the business value of your work. In order to do this, think about how you can answer some of the following questions:", "By answering these questions, you are making your work relevant to your audience.", "There are two types of information that you should use when demonstrating your model\u2019s performance to a general audience \u2014 performance metrics and visualizations. Performance metrics will summarize and quantify your model\u2019s performance while visualizations will give your audience the bigger picture including little details that could have been missed when only looking at numerical metrics.", "There are many performance metrics that data scientists like to use, ranging from simple and intuitive metrics like accuracy to more complex metrics like the root-mean-squared logarithmic error (RMSLE) or the weighted F1 score.", "The most important thing to consider when choosing a metric is making sure that it is relevant in the context of the real-world problem that your model is trying to solve. To demonstrate this idea, consider the examples of real-world classification and regression problems listed below.", "For the first problem, the consequences of a false positive (diagnosing someone who doesn\u2019t have diabetes with diabetes) are not as serious as those of a false negative (failing to diagnose someone with diabetes). In this case, metrics such as accuracy and precision may be useful, but the one that is the most important is recall \u2014 which in this case measures the proportion of people with diabetes who were correctly diagnosed with diabetes. A model with a low recall will fail to diagnose many patients who actually have diabetes, leading to delays in treatment and further complications in patients. A model with a high recall will help prevent these negative outcomes.", "For the second problem, let\u2019s make the following assumptions (keep in mind this is a simplified example):", "In this situation, we might be tempted to use a typical regression metric like the R\u00b2 coefficient or the mean absolute error (MAE). But both metrics fail to answer the question that truly matters to the company \u2014 how much will they profit from producing the number of units that your model predicts they will need? We can use the equation below to compute the net profit that the model would produce for a given prediction:", "Obviously, producing only 10 units has less potential for profit than producing 1000 units. For this reason, it might actually be better to scale this metric by computing the net profit margin or the ratio of the net profit to the initial profit generated by selling each unit of the product before taking costs into account:", "This metric is something that company executives and stakeholders can easily interpret because it is relevant to the real-world problem that your model is trying to solve and it provides a clear picture of the value delivered by your model.", "A visualization can often tell you much more than a single metric that summarizes the model\u2019s performance across thousands of data points. While a picture is worth a thousand words, in data science a visualization may literally be worth a thousand numbers.", "You can easily visualize your model\u2019s performance using yellowbrick, a library that extends the Scikit-learn API and allows you to create performance visualizations. I have listed two examples of visualizations (one for classification, and one for regression) that can give your audience a more holistic picture of your model\u2019s performance. You can find the code I used to create these visualizations on GitHub.", "The class prediction error plot, which can be created using the yellowbrick API, is a bar graph with stacked bars showing the classes that were predicted for each actual class in the testing data. This plot is especially useful in multi-class classification problems and allows the audience to get a better view of the classification errors made by your model. In the example below, I created a class prediction error plot for a logistic regression model trained to predict the sentiment (positive or negative) of movie reviews using the famous IMDB Movie Review Dataset.", "A residual plot is basically a scatterplot that shows the range of prediction errors (residuals) for your model for different predicted values. The yellowbrick API allows you to create a residual plot that also plots the distribution of the residuals for both the training and testing set. In the figure below, I created a residual plot for a neural network trained to predict housing prices using the California Housing Prices Dataset.", "To answer this question, especially when dealing with a non-technical audience, you need to explain your model\u2019s predictions in a way that doesn\u2019t involve diving into complex mathematical details about your model.", "LIME and SHAP are two useful Python libraries that you can use to visually explain the predictions generated by your model, which allows your audience to trust the logic that your model is using. In the sections below, I have provided visualizations and the code segments used to produce them. You can find the full code for these examples on GitHub.", "LIME, a Python library created by researchers at the University of Washington, stands for Local Interpretable Model-agnostic Explanations. What this means is that LIME can provide understandable explanations of your model\u2019s predictions on specific instances regardless of how complex the model is.", "In the example below, I used the same neural network previously used to predict housing prices using the California Housing Prices Dataset and visualized the explanations for one particular prediction.", "Here are some of the key features in the visualization above:", "We can also use LIME to explain the predictions of models that work with text data. In the example below, I visualized the explanations for a prediction generated by a logistic regression model used for classifying the sentiment of movie reviews.", "Based on the visualization above we can easily notice the following details:", "These details align with our human expectations of what the model should be doing which allows us to trust it even if we don\u2019t fully understand the math behind it.", "SHAP (SHapley Additive exPlanations) is a similar Python library for model explanations, but it is a bit more complex than LIME both in terms of its usage and the information provided in its visualizations. SHAP borrows ideas from game theory, using the Shapley values defined in this paper to explain the output of machine learning models. Unlike LIME, SHAP also has specific modules for explaining different types of models but it also features model-agnostic explainers that work on all types of categories of models.", "The code below demonstrates how to visualize the predictions of the same neural network in the previous example using the KernelExplainer module, which is designed to explain the output of any function.", "The visualization above is interesting because it not only provides the value predicted by the model but also presents the competing influences of different features as arrows of different directions and lengths pushing the model\u2019s prediction further from a base value.", "SHAP can also be used on text data, but the process is a bit more complicated and the visual explanations for a single prediction are not as intuitive as those that can be created with LIME. The SHAP Explainer module can explain text-classification results by treating the text data as tabular data in the form of word counts or TF-IDF statistics for each word in a text document. In the example below, I used SHAP to create a visualization explaining the previous sentiment prediction generated by the logistic regression model.", "If we compare this visualization to the one produced by LIME for the same movie review, we can see that it gives us similar information, but is less intuitive because it doesn\u2019t highlight words in the text of the movie review. However, it still helps us see the influence of specific words on the model\u2019s prediction.", "SHAP also allows us to view the influence of individual words on the model\u2019s predictions using a bee swarm plot as demonstrated below.", "Based on this plot, we can tell that words such as great, best, and excellent in a movie review cause the model to conclude that a review is positive while words such as worst, bad, awful, waste, and boring cause the model to conclude that a review is negative. This visualization gives us more confidence in this model because it demonstrates that the model is using the same logic that we as humans would likely use when determining if a movie review is positive or negative. This is the key to building trust in machine learning models.", "As I mentioned earlier, please refer to this GitHub repository to find the full code that I used to train the models and create the corresponding visualizations used in this article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff20f75928f37&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f20f75928f37--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f20f75928f37--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://amolmavuduru.medium.com/?source=post_page-----f20f75928f37--------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=post_page-----f20f75928f37--------------------------------", "anchor_text": "Amol Mavuduru"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511816e5976d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&user=Amol+Mavuduru&userId=511816e5976d&source=post_page-511816e5976d----f20f75928f37---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20f75928f37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20f75928f37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@samuelpereira?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Samuel Pereira"}, {"url": "https://unsplash.com/s/photos/conference?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.scikit-yb.org/en/latest/", "anchor_text": "yellowbrick"}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP"}, {"url": "https://www.scikit-yb.org/en/latest/", "anchor_text": "yellowbrick"}, {"url": "https://github.com/AmolMavuduru/ExplainableML", "anchor_text": "code"}, {"url": "https://github.com/AmolMavuduru/ExplainableML", "anchor_text": "GitHub"}, {"url": "https://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "famous IMDB Movie Review Dataset"}, {"url": "https://www.kaggle.com/camnugent/california-housing-prices", "anchor_text": "California Housing Prices Dataset"}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME"}, {"url": "https://github.com/slundberg/shap", "anchor_text": "SHAP"}, {"url": "https://github.com/AmolMavuduru/ExplainableML", "anchor_text": "GitHub"}, {"url": "https://github.com/marcotcr/lime", "anchor_text": "LIME"}, {"url": "https://www.kaggle.com/camnugent/california-housing-prices", "anchor_text": "California Housing Prices Dataset"}, {"url": "https://github.com/slundberg/shap#citations", "anchor_text": "SHAP"}, {"url": "https://proceedings.neurips.cc/paper/2017/hash/8a20a8621978632d76c43dfd28b67767-Abstract.html", "anchor_text": "paper"}, {"url": "https://shap.readthedocs.io/en/latest/generated/shap.KernelExplainer.html", "anchor_text": "KernelExplainer"}, {"url": "https://github.com/AmolMavuduru/ExplainableML", "anchor_text": "GitHub repository"}, {"url": "https://joss.theoj.org/papers/10.21105/joss.01075", "anchor_text": "Yellowbrick: Visualizing the Scikit-Learn Model Selection Process"}, {"url": "https://arxiv.org/abs/1602.04938", "anchor_text": "Why should I trust you?: Explaining the predictions of any classifier"}, {"url": "https://proceedings.neurips.cc/paper/2017/hash/8a20a8621978632d76c43dfd28b67767-Abstract.html", "anchor_text": "A Unified Approach to Interpreting Model Predictions"}, {"url": "https://ai.stanford.edu/~amaas/papers/wvSent_acl2011.pdf", "anchor_text": "Learning Word Vectors for Sentiment Analysis"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S016771529600140X", "anchor_text": "Sparse Spatial Autoregressions"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f20f75928f37---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f20f75928f37---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----f20f75928f37---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f20f75928f37---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff20f75928f37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&user=Amol+Mavuduru&userId=511816e5976d&source=-----f20f75928f37---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff20f75928f37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&user=Amol+Mavuduru&userId=511816e5976d&source=-----f20f75928f37---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20f75928f37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f20f75928f37--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff20f75928f37&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f20f75928f37---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f20f75928f37--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f20f75928f37--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f20f75928f37--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f20f75928f37--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f20f75928f37--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f20f75928f37--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f20f75928f37--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f20f75928f37--------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Amol Mavuduru"}, {"url": "https://amolmavuduru.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "565 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511816e5976d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&user=Amol+Mavuduru&userId=511816e5976d&source=post_page-511816e5976d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f3b67de8f9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-make-your-machine-learning-models-more-explainable-f20f75928f37&newsletterV3=511816e5976d&newsletterV3Id=1f3b67de8f9c&user=Amol+Mavuduru&userId=511816e5976d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}