{"url": "https://towardsdatascience.com/image-classification-using-ssim-34e549ec6e12", "time": 1682994676.0866811, "path": "towardsdatascience.com/image-classification-using-ssim-34e549ec6e12/", "webpage": {"metadata": {"title": "Image Classification using SSIM. As humans, we are generally very good\u2026 | by Iftekher Mamun | Towards Data Science", "h1": "Image Classification using SSIM", "description": "As humans, we are generally very good at finding the difference in a picture. For example, let\u2019s look at the above picture and see how they are different. For one, the fruits, ice-creams and drinks\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow", "paragraph_index": 1}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 1}, {"url": "https://www.kaggle.com/alessiocorrado99/animals10", "anchor_text": "Animals-10", "paragraph_index": 2}, {"url": "https://medium.com/@RaghavPrabhu/a-simple-tutorial-to-classify-images-using-tensorflow-step-by-step-guide-7e0fad26c22", "anchor_text": "Prabhu", "paragraph_index": 2}, {"url": "https://medium.com/datadriveninvestor/building-an-image-classifier-using-tensorflow-3ac9ccc92e7c", "anchor_text": "Amitabha", "paragraph_index": 2}, {"url": "https://opencv.org/", "anchor_text": "OpenCV", "paragraph_index": 7}, {"url": "https://medium.com/u/6ac286c49dad?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "Yish Lim", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/whos-that-pok\u00e9mon-39d1150aedfe", "anchor_text": "blog for Pokemon match", "paragraph_index": 7}, {"url": "https://www.pyimagesearch.com/2014/09/15/python-compare-two-images/", "anchor_text": "the original source code", "paragraph_index": 15}], "all_paragraphs": ["As humans, we are generally very good at finding the difference in a picture. For example, let\u2019s look at the above picture and see how they are different. For one, the fruits, ice-creams and drinks have obviously changed. That was pretty easy, right?", "However, for computers, this is not such an easy task. Computers can only learn from what we train it\u2019s models on. There are great models that can classify batch images really well, like Google\u2019s TensorFlow and Keras.", "Thanks to image classifier libraries like these, computer vision has jumped dramatically. Now we can create complicated models such as this one in kaggle: Animals-10, which contains thousands of pictures of ten different types of animals as well as non-animals already trained and cleaned. All you have to do is create a model and see how well your model can predict each different types of animals. For tutorials on image classification model checkout Prabhu or Amitabha.", "However, I wanted to create an image classifier that can tell how similar two images are. For that, there is no need for any complicated libraries like TensorFlow or image classification models like linked above. There are two ways to find if an image is similar to another image. First is to look at Mean Square Error (MSE) and the second is Structural Similarity Index (SSIM).", "They both look pretty scary but no need to worry. MSE can be calculated fairly easily because of NumPy and SSIM is a built in method part of Sci-Kit\u2019s image library so we can just load it up.", "Before we do all that, let\u2019s define what each is calculating. MSE will calculate the mean square error between each pixels for the two images we are comparing. Whereas SSIM will do the opposite and look for similarities within pixels; i.e. if the pixels in the two images line up and or have similar pixel density values. The only issues is that MSE tends to have arbitrarily high numbers so it is harder to standardize it. While generally the higher the MSE the least similar they are, if the mse between picture sets differ appears randomly, it will be harder for us to tell anything. SSIM on the other hand puts everything in a scale of -1 to 1 (but I was not able to produce a score less than 0). A score of 1 meant they are very similar and a score of -1 meant they are very different. In my opinion this is a better metric of measurement.", "Now let\u2019s focus on the codes and start importing all necessary libraries:", "I am using CV2 (part of OpenCV) to read and edit my images. If you want to, you can also use matplotlib\u2019s imread instead. My friend Yish Lim did it in her blog for Pokemon match similarity and it is pretty awesome.", "Now for the scary part of writing up our MSE formula:", "Since SSIM was already imported through skimage, no need to manually code it. Now we create a function that will take in two images, calculate it\u2019s mse and ssim and show us the values all at once.", "Now the next three steps can be done all at once with a for-loop but let\u2019s break it down in the codes below so it is easier to follow:", "First we load the images that are saved in our directory. Second, we have to make sure they are all the same size as otherwise we will get a dimension error. The issue with this is this can lead to distortion of image so play around till you find the perfect numbers. Next we do one more function so we can see what our pictures look like.", "Now to test and see if our MSE and SSIM is working by comparing one image to itself. If it works, then we should get MSE of 0 and SSIM of 1.", "Now that we know our computer can tell if the pictures being compared are the same, how about we compare different pictures. For simplicity, I will compare three dog pictures to themselves and three cat pictures to themselves.", "Let\u2019s look at what our simple algorithm just compared. As you can see, the MSE varies widely so it is hard to tell what is what. But looking at SSIM, we can see that dog 2 and dog 3 are most similar relative to the other dogs. Visually, I agree, specially with how the ears are. But I would have thought that dog 1 and dog 3 would have had a higher SSIM because of their pose. In reality, before graycycle of the pictures, dog 2 and 3 had similar white fur around the nose area while dog 1 did not. That is most likely the reason for dog 2 and 3 having a higher SSIM value compare to dog 1. For the cats, it is a little more difficult. Cat 1 and cat 2 had similar shape and the picture was taken from similar distance but cat 2 and cat 3 had similar color fur. That is probably why cat 1 and 3 are rated similarly as well as cat 2 and 3 but not cat 1 and cat 2.", "There were only two more tests I wanted to conduct. One was for how a dog may appear to a cat and second was how each animal compares to the gate picture that came with the original source code.", "As expected, dogs and cats are similar, specially compared to an inanimate object such as the Jurassic Park 1 entrance gate (side note: such a great movie!). The only reason dogs and cats having a high SSIM with the gate picture would be because of the size and the grayscale filter it went through.", "OpenCV is not the best when it comes to resizing and reconfiguring images. For that Google\u2019s TensorFlow is the best. However, the issue I had with TensorFlow was I could not load single images into their librarie module. TensorFlow works best with batch pictures.", "For the future, I would like to use the kaggle Animal-10 dataset I mentioned with TensorFlow to run a full image classification lab.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine learning is where it\u2019s at"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F34e549ec6e12&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@imamun?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@imamun?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "Iftekher Mamun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41404f6cc939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&user=Iftekher+Mamun&userId=41404f6cc939&source=post_page-41404f6cc939----34e549ec6e12---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F34e549ec6e12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F34e549ec6e12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.champak.in/wp-content/uploads/2017/09/09_Spot-the-Difference-1.jpg", "anchor_text": "Find the Differences"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://www.kaggle.com/alessiocorrado99/animals10", "anchor_text": "Animals-10"}, {"url": "https://medium.com/@RaghavPrabhu/a-simple-tutorial-to-classify-images-using-tensorflow-step-by-step-guide-7e0fad26c22", "anchor_text": "Prabhu"}, {"url": "https://medium.com/datadriveninvestor/building-an-image-classifier-using-tensorflow-3ac9ccc92e7c", "anchor_text": "Amitabha"}, {"url": "https://opencv.org/", "anchor_text": "OpenCV"}, {"url": "https://medium.com/u/6ac286c49dad?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "Yish Lim"}, {"url": "https://towardsdatascience.com/whos-that-pok\u00e9mon-39d1150aedfe", "anchor_text": "blog for Pokemon match"}, {"url": "https://www.pyimagesearch.com/2014/09/15/python-compare-two-images/", "anchor_text": "the original source code"}, {"url": "https://github.com/imamun93/Image-Similarities-using-SSIM", "anchor_text": "Image-Similarities-using-SSIMMy github link containing the codes.github.com"}, {"url": "https://www.pyimagesearch.com/2014/09/15/python-compare-two-images/", "anchor_text": "How-To: Python Compare Two Images - PyImageSearchWould you have guessed that I'm a stamp collector? Just kidding. I'm not. But let's play a little game of pretend\u2026www.pyimagesearch.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----34e549ec6e12---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----34e549ec6e12---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/data-science?source=post_page-----34e549ec6e12---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/open-source?source=post_page-----34e549ec6e12---------------open_source-----------------", "anchor_text": "Open Source"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----34e549ec6e12---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F34e549ec6e12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&user=Iftekher+Mamun&userId=41404f6cc939&source=-----34e549ec6e12---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F34e549ec6e12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&user=Iftekher+Mamun&userId=41404f6cc939&source=-----34e549ec6e12---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F34e549ec6e12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F34e549ec6e12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----34e549ec6e12---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----34e549ec6e12--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----34e549ec6e12--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----34e549ec6e12--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@imamun?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@imamun?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Iftekher Mamun"}, {"url": "https://medium.com/@imamun/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "158 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F41404f6cc939&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&user=Iftekher+Mamun&userId=41404f6cc939&source=post_page-41404f6cc939--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F41404f6cc939%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-classification-using-ssim-34e549ec6e12&user=Iftekher+Mamun&userId=41404f6cc939&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}