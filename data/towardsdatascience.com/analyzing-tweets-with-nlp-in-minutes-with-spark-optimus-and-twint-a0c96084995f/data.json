{"url": "https://towardsdatascience.com/analyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f", "time": 1682996068.4533818, "path": "towardsdatascience.com/analyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f/", "webpage": {"metadata": {"title": "Analyzing Tweets with NLP in minutes with Spark, Optimus and Twint | by Favio V\u00e1zquez | Towards Data Science", "h1": "Analyzing Tweets with NLP in minutes with Spark, Optimus and Twint", "description": "If you are here it\u2019s likely that you are interested in analyzing tweets (or something similar) and you have a lot of them, or can get them. One of the most annoying things for that is getting a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/7e12c71dfa81?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "TDS Team", "paragraph_index": 50}], "all_paragraphs": ["If you are here it\u2019s likely that you are interested in analyzing tweets (or something similar) and you have a lot of them, or can get them. One of the most annoying things for that is getting a Twitter application, get the authentication and all of that. And then if you are using Pandas, there\u2019s no way to scale that.", "So what about a system that doesn\u2019t have to authenticate with the Twitter API, that can get an unlimited (well almost) amount of tweets and the power to analyze them, with NLP and more. Well you\u2019re in for a treat because that\u2019s exactly what I\u2019m going to show you right now.", "You can follow everything I\u2019m going to show you very easily. Just forklift this MatrixDS project:", "Also there\u2019s a GitHub repo with everything:", "With MatrixDS you can actually run the notebooks, get the data and run the analysis for free, so if you want to learn more please do it.", "Twint utilizes Twitter\u2019s search operators to let you scrape Tweets from specific users, scrape Tweets relating to certain topics, hashtags & trends, or sort out sensitive information from Tweets like e-mail and phone numbers.", "With Optimus, a library I co-created, you can clean your data, prepare it, analyze it, create profilers and plots, and perform machine learning and deep learning, all in a distributed fashion, because on the back-end we have Spark, TensorFlow, Sparkling Water and Keras.", "So let\u2019s first install everything you need, for that when you are in the Matrix project, go to the Analyze Tweets notebook and run (you can also do this from the JupyterLab terminal):", "After that, we need to install Twint, for that run:", "This will download a scr/ folder so we need to do some config:", "Then to import Twint that we need to run:", "Optimus was installed in the first step, so let\u2019s just start it (this will start a Spark cluster for you):", "If you are running this on notebooks you\u2019ll need also to run:", "I\u2019ll start our analysis scrapping tweets about data science, you can change this to whatever you want.", "For doing that we just need to run this:", "Let me explain this code to you. In the last section when we ran the code:", "we started a new Twint configuration. After that we need to pass different options we want to scrape tweets. Here\u2019s the full list of configuring options:", "We are setting the search term, them formatting the response (just to check), getting only 20 tweets with the Limit =1 (they are in increments of 20) and finally making the result compatible with Pandas.", "We are launching the search. The result is:", "Doesn\u2019t look that good but we got what we wanted. TWEETS!", "Sadly there\u2019s no direct connection between Twint and Spark, but we can do it with Pandas and then pass the result to Optimus.", "I created to simple functions that you can see in the actual project that helps you with Pandas and the weird Twint API for this part. So when we run this:", "These are the columns we have from the query we just did. There\u2019s a lot of different things to do with this data, but for this article I\u2019ll only use some of them. So to transform the result from Twint to Pandas we run:", "and you\u2019ll see this Pandas DF:", "We will run a sentiment analysis on some tweets, using Optimus and TextBlob a library for NLP. The first thing we need to do is clean this tweets, for that Optimus is the best choice.", "For saving the data as an Optimus (Spark) DF we need to run:", "We\u2019ll just remove accents and special characters with Optimus (for a real work scenario you need to do much more than this like removing links, images, and stopwords), for that:", "Then we need to collect this tweets from Spark to get them in a Python list, for that:", "Then to analyze the sentiment of these tweets we will use TextBlob sentiment function:", "Well that was extremely easy, but it won\u2019t scale, because in the end we are collecting the data from Spark so the driver\u2019s RAM is the limit. Let\u2019s do it a little better.", "Transforming this code to Spark code it\u2019s simple. This piece of code can help you transform other codes as well. So lets start importing the User Defined Function module from Spark:", "Then we will transform the code from above to a function:", "After that we will register the function as a Spark UDF:", "Then to apply the function to the whole dataframe we need to write:", "This is not actually quality code. Let\u2019s transform this into functions to use it over and over.", "The first part is setting up everything:", "The last part it\u2019s a class that will remove the automatic printing of Twint so we just see the dataframe.", "All of the things from above can be summarize in these functions:", "So to get the tweets and add sentiment we use:", "Lets see the distribution of the sentiments:", "We can do more stuff, here I\u2019ll show you how to create a simple function to get tweets, and also how to build a word cloud from them.", "So to get the tweets from a simple search:", "With this we can get thousands of tweets very easy:", "To generate a word cloud this is all we need to do:", "I added some stopwords that are common in tweets that don\u2019t matter to the analysis. To show it we use:", "Pretty but not that much. If we want good code we need modules so, let\u2019s transform that into a function:", "There\u2019s much more things that you can do with the library. Some other functions:", "Actually you can use it from the terminal. For that just run:", "Then just run go to the twint folder:", "And finally you can run for example:", "Here I\u2019m getting all the tweets (845 so far) from the TDS Team of the year. Here is the CSV file if you want it:", "Let\u2019s get 10k tweets and get their sentiment, because why not. For that:", "This actually took almost 10 minutes so take your precautions. It may be faster to get the tweets from the CLI and then just applying the function. Let\u2019s see how many tweets we have:", "And we have 10.031 tweets with sentiments! You can use them for training other models too.", "Thanks for reading this, hopefully it can help you with your current job and understanding of data science. If you want to know more about me follow me on twitter:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist, physicist and computer engineer. Love sharing ideas, thoughts and contributing to Open Source in Machine Learning and Deep Learning ;)."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa0c96084995f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a0c96084995f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@faviovazquez?source=post_page-----a0c96084995f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@faviovazquez?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "Favio V\u00e1zquez"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8ec6fa4d7d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&user=Favio+V%C3%A1zquez&userId=e8ec6fa4d7d4&source=post_page-e8ec6fa4d7d4----a0c96084995f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0c96084995f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0c96084995f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://matrixds.com/", "anchor_text": "https://matrixds.com/"}, {"url": "https://community.platform.matrixds.com/community/project/5ccc9c4b3175e0603c394444/files", "anchor_text": "MatrixDS | The Data Project WorkbenchMatrixDS is a place to build, share and manage data projects at any scale.community.platform.matrixds.com"}, {"url": "https://github.com/FavioVazquez/twitter_optimus_twint", "anchor_text": "FavioVazquez/twitter_optimus_twintAnalyzing tweets with Twint, Optimus and Apache Spark. - FavioVazquez/twitter_optimus_twintgithub.com"}, {"url": "https://github.com/twintproject/twint.git@origin/master#egg=twint", "anchor_text": "https://github.com/twintproject/twint.git@origin/master#egg=twint"}, {"url": "https://www.theverge.com/2015/11/3/9661180/twitter-vine-favorite-fav-likes-hearts", "anchor_text": "https://www.theverge.com/2015/11/3/9661180/twitter-vine-favorite-fav-likes-hearts"}, {"url": "https://amueller.github.io/word_cloud/auto_examples/masked.html", "anchor_text": "https://amueller.github.io/word_cloud/auto_examples/masked.html"}, {"url": "https://medium.com/u/7e12c71dfa81?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "TDS Team"}, {"url": "https://github.com/FavioVazquez/twitter_optimus_twint/blob/master/TDS.csv", "anchor_text": "FavioVazquez/twitter_optimus_twintAnalyzing tweets with Twint, Optimus and Apache Spark. - FavioVazquez/twitter_optimus_twintgithub.com"}, {"url": "https://twitter.com/faviovaz", "anchor_text": "Favio V\u00e1zquez (@FavioVaz) | TwitterThe latest Tweets from Favio V\u00e1zquez (@FavioVaz). Data Scientist. Physicist and computational engineer. I have a\u2026twitter.comm"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a0c96084995f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/business?source=post_page-----a0c96084995f---------------business-----------------", "anchor_text": "Business"}, {"url": "https://medium.com/tag/technology?source=post_page-----a0c96084995f---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----a0c96084995f---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/programming?source=post_page-----a0c96084995f---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa0c96084995f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&user=Favio+V%C3%A1zquez&userId=e8ec6fa4d7d4&source=-----a0c96084995f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa0c96084995f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&user=Favio+V%C3%A1zquez&userId=e8ec6fa4d7d4&source=-----a0c96084995f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0c96084995f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa0c96084995f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a0c96084995f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a0c96084995f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a0c96084995f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a0c96084995f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a0c96084995f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a0c96084995f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@faviovazquez?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@faviovazquez?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Favio V\u00e1zquez"}, {"url": "https://medium.com/@faviovazquez/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8ec6fa4d7d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&user=Favio+V%C3%A1zquez&userId=e8ec6fa4d7d4&source=post_page-e8ec6fa4d7d4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe5c1070d2e27&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanalyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f&newsletterV3=e8ec6fa4d7d4&newsletterV3Id=e5c1070d2e27&user=Favio+V%C3%A1zquez&userId=e8ec6fa4d7d4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}