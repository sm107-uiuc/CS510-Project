{"url": "https://towardsdatascience.com/creating-machine-learning-models-b48bb72a791f", "time": 1682997252.734779, "path": "towardsdatascience.com/creating-machine-learning-models-b48bb72a791f/", "webpage": {"metadata": {"title": "Creating Machine Learning Models. CREATING AND TESTING MULTIPLE MODELS\u2026 | by Rising Odegua | Towards Data Science", "h1": "Creating Machine Learning Models", "description": "Now that we have successfully done the hard part-data cleaning and wrangling- of every data science project, we will move on to the interesting part, modelling! Different machine learning models\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/exploratory-data-analysis-feature-engineering-and-modelling-using-supermarket-sales-data-part-1-228140f89298", "anchor_text": "part 1", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/feature-engineering-and-data-preparation-using-supermarket-sales-data-part-2-171b7a7a7eb7", "anchor_text": "part 2", "paragraph_index": 1}, {"url": "https://github.com/risenW/medium_tutorial_notebooks/blob/master/supermarket_regression.ipynb", "anchor_text": "Link to full Notebook with code and explanations on GitHub.", "paragraph_index": 43}], "all_paragraphs": ["Now that we have successfully done the hard part-data cleaning and wrangling- of every data science project, we will move on to the interesting part, modelling!", "Although this article can stand alone, it is advisable to go through part 1 and part 2 first.", "Modeling in machine learning is an iterative phase where a data scientist continually train and test machine learning models to discover the best one for the given task.", "Different machine learning models exist and the choice of which one to use generally depends on the problem at hand. No machine learning model works best for all kind of problems. So, your job in this stage is test multiple models and fine tune parameters to squeeze out every bit of accuracy.", "Note: While we generally strive for higher performing models, it is generally wiser and better to go for simpler models that perform almost as well as complex models.", "Save the\u00a0.0001 increase in performance for your machine learning competitions because most of the time in the real world those minute difference do not really matter because we need simpler interpretable models.", "With that in mind, let\u2019s get to work. It is always good to start with a simple base model so you can get a base line to measure performance against.", "Since our data set is small, we\u2019ll use cross validation and for performance metric, we\u2019ll use the mean absolute error. Cross Validation helps measure our model\u2019s true performance.", "We create a cross Validation function as shown below.", "We start our modelling with a simple linear regression, cross validate and print it\u2019s score.", "Linear regression is simple and as such does not have much parameter to tune. So we simply use the default parameters.", "Next, we use another simple but efficient algorithm called decision tree", "The decision tree contains many hyperparameter, but the most important ones we can quickly tune are:", "Next, we try a popular distance based algorithm called k-nearest neighbor", "The KNN contains a few hyperparameter. The most important one to tune is:", "Looking at the MAE(mean absolute error) score of the simple models, we see that the decision tree is the best so far. This will be our base line model. Any model that performs better becomes the next base line to beat.", "Now, we\u2019ll move from simple to advanced models. Many high performing machine learning models are usually based on ensembles. Ensembling is a method that combines multiple machine learning algorithms to obtain better predictive performance than could be achieved by any single one.", "We\u2019ll use some popular ensemble method below and compare their performance.", "The Random forest algorithm is a popular and effective implementation of bagging, that builds multiple trees from a bootstrap sample. It has high predictive power and works very well out of box.", "Random Forest contains may hyperparameter, but the most important ones to tune are:", "The Extra Tree algorithm is another popular implementation of bagging, it is similar to the random forest, but builds its base trees differently and is generally faster. It also has high predictive power sometimes outperforming Random Forest.", "Extra Trees contains similar hyperparameter to Random Forest. Important parameters to tune are:", "The Bagging estimator in sklearn allows you to create bagging ensembles from any chosen model. I.e you can create bagging ensembles from single models like Linear regression or even ensembles like Random Forest or Extra Trees.", "The important hyperparameter to tune here are:", "From the error metrics, our next best model is the bagging regressor, which is based on the Extra Tree Regressor. This becomes our new baseline model.", "Next, let\u2019s try some boosting algorithms.", "Boosting is another popular and effective ensembling technique. In Boosting, multiple models are trained sequentially. The goal is to train models that do better than their predecessors. This means we have to take into account the areas where the previous models performed poorly and improve on those areas.", "We start with the vanilla implementation of boosting called the AdaBoost. This is a old but widely used boosting technique that performs well on regression task, although it is known to overfit alot.", "The important hyperparameter to tune here are:", "Another popular boosting algorithm is the Gradient Boosting.", "The important hyperparameter to tune here are:", "\u201cWhen in doubt use XGBoost\u201d has been one of the most popular quotes from the kaggle platform in recent years.", "XGBoost is efficient, fast and works well out of the box. It is an advance implementation of Gradient Boosting and a very efficient one indeed.", "The important hyperparameter to tune here are:", "LightGBM is a boosting algorithm from Microsoft. It is one of the fastest boosting algorithm out there; efficient out-of-the-box and currently the go-to when it comes to large structured data.", "The important hyperparameter to tune here are:", "Catboost is a recent boosting algorithm. It is fast, efficient and handles categorical features easily (One of its best feature).", "CatBoost can automatically deal with categorical variables and does not require extensive data preprocessing like other machine learning algorithms", "The important hyperparameter to tune here are:", "In this post, we\u2019ve learnt how to take a preprocessed data set and try out different machine learning models. Although this article was based on a regression task, the same steps can be applied for a classification task. Some key takeaways from this post are:", "More advance technique after hand tuning your best model is to use an automatic hyper parameter searching algorithm such as Grid or Random search.", "And remember, keep your model as simple and interpretable as possible.", "If you learnt from these series of posts, don\u2019t forget to clap and share.", "Link to full Notebook with code and explanations on GitHub.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "GDE in Machine Learning, Software Engineer, Data Scientist, Technical Writer, OSS, Advocacy"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb48bb72a791f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@risingdeveloper?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@risingdeveloper?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": "Rising Odegua"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F10cf0dba197a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&user=Rising+Odegua&userId=10cf0dba197a&source=post_page-10cf0dba197a----b48bb72a791f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb48bb72a791f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb48bb72a791f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/exploratory-data-analysis-feature-engineering-and-modelling-using-supermarket-sales-data-part-1-228140f89298", "anchor_text": "part 1"}, {"url": "https://towardsdatascience.com/feature-engineering-and-data-preparation-using-supermarket-sales-data-part-2-171b7a7a7eb7", "anchor_text": "part 2"}, {"url": "https://github.com/risenW/medium_tutorial_notebooks/blob/master/supermarket_regression.ipynb", "anchor_text": "Link to full Notebook with code and explanations on GitHub."}, {"url": "https://twitter.com/risingodegua", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/risingdeveloper", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b48bb72a791f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b48bb72a791f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/ensemble-learning?source=post_page-----b48bb72a791f---------------ensemble_learning-----------------", "anchor_text": "Ensemble Learning"}, {"url": "https://medium.com/tag/boosting-and-bagging?source=post_page-----b48bb72a791f---------------boosting_and_bagging-----------------", "anchor_text": "Boosting And Bagging"}, {"url": "https://medium.com/tag/modelling?source=post_page-----b48bb72a791f---------------modelling-----------------", "anchor_text": "Modelling"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb48bb72a791f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&user=Rising+Odegua&userId=10cf0dba197a&source=-----b48bb72a791f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb48bb72a791f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&user=Rising+Odegua&userId=10cf0dba197a&source=-----b48bb72a791f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb48bb72a791f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb48bb72a791f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b48bb72a791f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b48bb72a791f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b48bb72a791f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b48bb72a791f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b48bb72a791f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@risingdeveloper?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@risingdeveloper?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rising Odegua"}, {"url": "https://medium.com/@risingdeveloper/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F10cf0dba197a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&user=Rising+Odegua&userId=10cf0dba197a&source=post_page-10cf0dba197a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe85fb4405381&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-machine-learning-models-b48bb72a791f&newsletterV3=10cf0dba197a&newsletterV3Id=e85fb4405381&user=Rising+Odegua&userId=10cf0dba197a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}