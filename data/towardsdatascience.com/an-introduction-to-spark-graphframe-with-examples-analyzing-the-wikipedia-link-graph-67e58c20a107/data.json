{"url": "https://towardsdatascience.com/an-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107", "time": 1682995149.5603998, "path": "towardsdatascience.com/an-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107/", "webpage": {"metadata": {"title": "An introduction to Spark GraphFrame with examples analyzing the Wikipedia link graph | by Matt Hagy | Towards Data Science", "h1": "An introduction to Spark GraphFrame with examples analyzing the Wikipedia link graph", "description": "The Spark GraphFrame is a powerful abstraction for processing large graphs using distributed computing. It provides a plethora of common graph algorithms including label propagation and PageRank\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/graphframes/graphframes", "anchor_text": "GraphFrame", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Label_Propagation_Algorithm", "anchor_text": "label propagation", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/PageRank", "anchor_text": "PageRank", "paragraph_index": 0}, {"url": "http://www.dcs.bbk.ac.uk/~dell/teaching/cc/paper/sigmod10/p135-malewicz.pdf", "anchor_text": "Pregel", "paragraph_index": 0}, {"url": "https://databricks.com/", "anchor_text": "Databricks", "paragraph_index": 16}, {"url": "https://medium.com/@matthagy/quickly-learning-the-basics-of-scala-through-structure-and-interpretation-of-computer-programs-ed5bfa90e8dc", "anchor_text": "Quickly learning the basics of Scala through Structure and Interpretation of Computer Programs examples (Part 1)", "paragraph_index": 22}, {"url": "http://matthagy.com", "anchor_text": "matthagy.com", "paragraph_index": 24}], "all_paragraphs": ["The Spark GraphFrame is a powerful abstraction for processing large graphs using distributed computing. It provides a plethora of common graph algorithms including label propagation and PageRank. Further, it provides the foundations for implementing complex graph algorithms, including a robust implementation of the Pregel paradigm for graph processing. Anyone who\u2019s interested in working with large graphs should learn how to apply this powerful tool.", "In this article, I\u2019ll introduce you to the basic of GraphFrame and demonstrate how to use this tool through several examples. These examples consider the link graph between Wikipedia articles and I demonstrate how to analyze this graph by leveraging the GraphFrame abstraction.", "Note that the examples in this post build off some more elementary Spark concepts such a DataFrames. Additionally, it uses basic Scala code to demonstrate algorithms. Only small and simple examples are shown so that one doesn\u2019t need to be well-familiar with these concepts to learn about the power of the GraphFrame abstraction.", "Let\u2019s dive right in and consider how to create a GraphFrame. I\u2019ll start by introducing the Wikipedia link data in a basic Spark RDD. Each element of this RDD is a single Wikipedia article page represented with the following Scala class.", "Note that each link is the title of another page. I.e., each page knows all the other pages that it links to by title.", "We begin with a single RDD pages that contains 19,093,693 Wikipedia article pages. From that, we generate two Spark DataFrames, one consisting of the vertices (i.e., page nodes) and the other consisting of the directed edges.", "Next, we create a GraphFrame using these two DataFrames.", "And that\u2019s all we have to do to access this powerful abstraction. We can now start using some of the builtin graph algorithms to analyze the Wikipedia link graph.", "Let start by computing something simple: the Wikipedia pages with the largest number of outbound links. To this end, we can use the GraphFrame method outDegrees, which is a computed DataFrame that corresponds to the number of outbound edges for each vertex. Since it\u2019s a DataFrame, we can use the orderBy method and limit to select the top 10.", "Interestingly, we can see that many special \u201cWikipedia:\u201d-prefix pages have the highest number of outbound links.", "Next, let\u2019s consider the number of inbound edges for each page and find the top 10 linked-to pages using the corresponding GraphFrame method, inDegrees.", "We can see that locations, including countries and cities, are among the most heavily linked to pages.", "Now let\u2019s explore some more complex graph computations. Let\u2019s consider the most heavily-linked to article, \u201cUnited States\u201d, and find the other articles in the link graph that are furthest away from this article in terms of the number of links you have to follow to arrive at \u201cUnited States\u201d.", "To this end, we can use the GraphFrame method, shortestPaths, which takes a collection of landmark vertices and returns the path length for every vertex in the graph to every landmark vertex.", "It is interesting that there are only three articles that are a full 10 links removed from the \u201cUnited States\u201d article in terms of shortest path length.", "Let\u2019s go one step further and compute the number of pages at each path length. I.e., how many Wikipedia articles are 1 link removed from \u201cUnited States\u201d, how many are 2 links removed, etc.", "(Note, that I\u2019m using the built-in display function of the Databricks notebook. I\u2019ll talk more about the joy of using Databricks in a future post.)", "Here we can see that there are millions of pages that are between 2 and 4 links removed from the \u201cUnited States\u201d article. There are also a vanishingly small number of articles that are six or more links removed. Further, the -1 path length denotes articles that aren\u2019t at all connected to the \u201cUnited States\u201d article at all and there are roughly a million pages that meet this criterion.", "Lastly, no demonstration of GraphFrame would be complete without showing how easily it can be used to perform the PageRank algorithm.", "The page rank of the top 10 articles is:", "It may not be surprising that \u201cUnited States\u201d has the highest vertex rank as we know it\u2019s the most heavily linked-to article.", "I hope these examples have helped to convince you that GraphFrame is a powerful abstraction for performing distributed computation on large graphs. There are additional more advanced concepts that I hope to share in future articles, including how to implement custom graph algorithms using the Pregel compute paradigm with GraphFrame.", "Update: If you\u2019ve found the Scala examples in this article interesting and would like to learn more about this powerful programming language you can check out my article, Quickly learning the basics of Scala through Structure and Interpretation of Computer Programs examples (Part 1).", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer and fmr. Data Scientist and Manager. Ph.D. in Computational Statistical Chemistry. (matthagy.com)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F67e58c20a107&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----67e58c20a107--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----67e58c20a107--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@matthagy?source=post_page-----67e58c20a107--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthagy?source=post_page-----67e58c20a107--------------------------------", "anchor_text": "Matt Hagy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3fe708dd30ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&user=Matt+Hagy&userId=3fe708dd30ed&source=post_page-3fe708dd30ed----67e58c20a107---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67e58c20a107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67e58c20a107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/graphframes/graphframes", "anchor_text": "GraphFrame"}, {"url": "https://en.wikipedia.org/wiki/Label_Propagation_Algorithm", "anchor_text": "label propagation"}, {"url": "https://en.wikipedia.org/wiki/PageRank", "anchor_text": "PageRank"}, {"url": "http://www.dcs.bbk.ac.uk/~dell/teaching/cc/paper/sigmod10/p135-malewicz.pdf", "anchor_text": "Pregel"}, {"url": "https://databricks.com/", "anchor_text": "Databricks"}, {"url": "https://medium.com/@matthagy/quickly-learning-the-basics-of-scala-through-structure-and-interpretation-of-computer-programs-ed5bfa90e8dc", "anchor_text": "Quickly learning the basics of Scala through Structure and Interpretation of Computer Programs examples (Part 1)"}, {"url": "https://medium.com/tag/spark?source=post_page-----67e58c20a107---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/graphframe?source=post_page-----67e58c20a107---------------graphframe-----------------", "anchor_text": "Graphframe"}, {"url": "https://medium.com/tag/data-science?source=post_page-----67e58c20a107---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analysis?source=post_page-----67e58c20a107---------------analysis-----------------", "anchor_text": "Analysis"}, {"url": "https://medium.com/tag/graph?source=post_page-----67e58c20a107---------------graph-----------------", "anchor_text": "Graph"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F67e58c20a107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&user=Matt+Hagy&userId=3fe708dd30ed&source=-----67e58c20a107---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F67e58c20a107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&user=Matt+Hagy&userId=3fe708dd30ed&source=-----67e58c20a107---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F67e58c20a107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----67e58c20a107--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F67e58c20a107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----67e58c20a107---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----67e58c20a107--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----67e58c20a107--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----67e58c20a107--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----67e58c20a107--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----67e58c20a107--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----67e58c20a107--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----67e58c20a107--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----67e58c20a107--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthagy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@matthagy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matt Hagy"}, {"url": "https://medium.com/@matthagy/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "229 Followers"}, {"url": "http://matthagy.com", "anchor_text": "matthagy.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3fe708dd30ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&user=Matt+Hagy&userId=3fe708dd30ed&source=post_page-3fe708dd30ed--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F80fe9ab5a2a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-introduction-to-spark-graphframe-with-examples-analyzing-the-wikipedia-link-graph-67e58c20a107&newsletterV3=3fe708dd30ed&newsletterV3Id=80fe9ab5a2a&user=Matt+Hagy&userId=3fe708dd30ed&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}