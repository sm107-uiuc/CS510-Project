{"url": "https://towardsdatascience.com/an-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7", "time": 1682996594.110083, "path": "towardsdatascience.com/an-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7/", "webpage": {"metadata": {"title": "An \u201cEquation-to-Code\u201d Machine Learning Project Walk-Through in Python\u2014 Part 1 Linear Separable Problem | by Xu LIANG | Towards Data Science", "h1": "An \u201cEquation-to-Code\u201d Machine Learning Project Walk-Through in Python\u2014 Part 1 Linear Separable Problem", "description": "A big gap from an engineer to a machine learning engineer is the ability to convert math equation to real code. Sometimes we really need to implement some basic concepts from scratch to better\u2026"}, "outgoing_paragraph_urls": [{"url": "https://gist.github.com/BrambleXu/738812287e7900428478c9035157db22#file-linear_data-csv", "anchor_text": "data", "paragraph_index": 2}, {"url": "https://gist.github.com/BrambleXu/2640af09b1f43b93c2d951ba91ca3d5c", "anchor_text": "code", "paragraph_index": 2}, {"url": "http://www.ece.utep.edu/research/webfuzzy/docs/kk-thesis/kk-thesis-html/node19.html", "anchor_text": "linear separable problem", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Linear_function_(calculus)?oldformat=true#Properties", "anchor_text": "linear function", "paragraph_index": 7}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html", "anchor_text": "doc", "paragraph_index": 14}, {"url": "https://stats.stackexchange.com/a/10298/116970", "anchor_text": "standardization", "paragraph_index": 15}, {"url": "https://www.wikiwand.com/en/Likelihood_function#/Log-likelihood", "anchor_text": "log likelihood", "paragraph_index": 25}, {"url": "https://www.youtube.com/watch?v=SB2vz57eKgc", "anchor_text": "video", "paragraph_index": 29}, {"url": "https://math.stackexchange.com/questions/25214/what-does-mean", "anchor_text": "here", "paragraph_index": 33}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html", "anchor_text": "numpy.dot()", "paragraph_index": 50}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html", "anchor_text": "numpy.dot()", "paragraph_index": 51}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html#numpy.matmul", "anchor_text": "np.matmul()", "paragraph_index": 52}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html#numpy.matmul", "anchor_text": "np.matmul()", "paragraph_index": 53}, {"url": "https://medium.com/@bramblexu", "anchor_text": "Medium", "paragraph_index": 57}, {"url": "https://bramblexu.com/posts/eb7bd472/", "anchor_text": "a categorized view", "paragraph_index": 57}, {"url": "https://github.com/BrambleXu", "anchor_text": "BrambleXu", "paragraph_index": 57}, {"url": "https://www.linkedin.com/in/xu-liang-99356891/", "anchor_text": "Xu Liang", "paragraph_index": 57}, {"url": "https://bramblexu.com", "anchor_text": "BrambleXu", "paragraph_index": 57}, {"url": "http://linkedin.com/in/xu-liang-99356891/", "anchor_text": "linkedin.com/in/xu-liang-99356891/", "paragraph_index": 59}], "all_paragraphs": ["A big gap from an engineer to a machine learning engineer is the ability to convert math equation to real code. Sometimes we really need to implement some basic concepts from scratch to better understand the magic behind the scenes rather than just import library without further understanding.", "So I decided to write some articles to explain how to convert the math equation to real code. This is part 1, and I will give a classification example using logistic regression for a linear separable problem. And I will try to make the explanation as simple as possible.", "Here are the data and code.", "The content is structured as follows. It looks a little long,", "First, we need to plot this data to see how it looks like. We create a Python file and name it logistic_regression.py.", "After running the script above, you should see the figure below.", "We might think a straight line should separate X and O very well. And this is a linear separable problem.", "We need to find a model for such a problem. The most simple case is using linear function.", "We use \u03b8 to represent the parameter. The \u03b8 mark in the left part means the function f(x) has the parameter theta. \u03b8 in the right part means there are two parameters.", "We can write it as code", "We also can rewrite the linear function as a more simple way, the vector way.", "Here the \u03b8 and x are all column vector.", "The reason why we use transpose of \u03b8 is that we can use matrix multiplication.", "We can write the code below", "You might wonder why we don\u2019t write np.dot(theta.T, x) ? Because the doc says If both vectors are 1-D arrays, it is inner product of vectors (without complex conjugation). So np.dot(theta, x) do the same thing like np.dot(theta.T, x).", "In order to make training converge fast, we use standardization, also called z-score. We do it column-wise.", "We need to add a bias term to our function to make our model have a better generalization. So we increase the parameter from 2 to 3. And add a constant x0=1 in order to align the vector representation.", "In order to make the calculation more simple, we convert x to a matrix.", "The dimension of std_x is (20, 2). After to_matrix(std_x), the dimension of mat_x is (20, 3). As for the dot product part, notice here we change the position of x and theta, the dimension of theta is (3,). So the result of dot production should be (20,3) x (3,)->(20,), which is a 1-D array containing predictions for 20 samples.", "Below is the linear function we talked so far.", "After being familiar with the linear function. We will build a more powerful prediction function based on it, the sigmoid function.", "We use the z to represent the linear function and pass it to sigmoid function. The sigmoid function will give a probability for each data sample. We have two class in our data, one is 1 and another is 0.", "We can see the model predict the sample based on the linear function part.", "We can write the code below", "You can just jump to the final part of this step 7 if you are not interested in the equation explanation.", "Alright, we prepared our data, model (sigmoid), and what else do we need? Yes, a goal function. A goal function can guide us on how to update the parameter in the right way. As for the sigmoid (logistic regression), we usually use log likelihood as the goal function", "Wait, wait\u2026what the hell about these things!", "So we get the final part.", "Don\u2019t forget why we start this. A goal function can guide us how to update the parameter in the right way.", "We need to use this to calculate the loss to update the parameter. More specifically, we need to calculate the derivative of the log-likelihood function. Here I will directly give the final update equation. (If you are interested in how to get this equation, this video should be helpful)", "In step 6, the most important equation is this one. If you cannot understand how to get this, it is totally ok. All we need to do is to write it as real code.", "Step 8 is a little longer, but it is very important. Don\u2019t panic. We will crack it.", "Because we have three parameters, we can write it as three equations.", "The := notation is just like =. You can find the explanation here.", "The most difficult part is the \u03a3 (summation symbol), so I expand the \u03a3 for better understanding.", "I colored the three parts in the equation because we can represent them as matrices. Look at the red and blue part in the first row where we update theta 0.", "We write the red part and blue part as column vectors.", "Because we have 20 data samples, so the dimension of f is (20,1). The dimension of x0 is (20,1). We can write matrix multiplication with transpose.", "The x1 and x2 is also column vector. And we can write to them as an X matrix.", "And theta is a row vector", "A Numpy array-like version might be easy to understand.", "Let\u2019s do a little calculation to make sure the dimension is right.", "Everything seems so right. Let's write the code. Actually, just two line.", "Something strange? Remember what we write before the code?", "Actually, this is not real math notation, this is the Numpy notation. And if you are using TensorFlow or PyTroch, you should be familiar with it.", "(20,) means this is a 1-D array with 20 numbers. It can be a row vector or a column vector because it only has 1 dimension. If we set this as a 2-D array, like (20, 1) or (1, 20), we can easily determine that(20, 1) is a column vector and (1, 20) is a row vector.", "But why not explicitly set the dimension to eliminate ambiguity?", "Well. Believe me, I have the seam question when I first see this. But after some coding practice, I think I know the reason.", "Because it can save our time!", "Honestly, it is frustrating. Why we cannot complete these in just one step?", "Ok, let\u2019s take a look at how the numpy.dot() doc says.", "numpy.dot(): If a is an N-D array and b is a 1-D array, it is a sum product over the last axis of a and b.", "Hmm, actually I cannot get the point. But np.matmul() describes similar calculations with reshapes to (20,1) or (1,20) to perform standard 2d matrix product. Maybe we can get some inspiration.", "np.matmul(): If the first argument is 1-D, it is promoted to a matrix by prepending a 1 to its dimensions. After matrix multiplication the prepended 1 is removed.", "After updating the parameter 2000 times, we should plot the result to see the performance of our model.", "We will make some data points as x1, and calculate x2 based on the parameters we learned.", "Congratulations! I am glad you make it. Hope my article is helpful for you. You can find the whole code below. Leave comments to let me know whether my article is easy to understand. Stay tuned for my next article about the non-linear separable problem.", "Check out my other posts on Medium with a categorized view!GitHub: BrambleXuLinkedIn: Xu LiangBlog: BrambleXu", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m an engineer focusing on NLP and Data Science. I write stuff to repay the engineer community. You can find me on linkedin.com/in/xu-liang-99356891/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffd0e19ed2d7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@bramblexu?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bramblexu?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": "Xu LIANG"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fee86e6752cb4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&user=Xu+LIANG&userId=ee86e6752cb4&source=post_page-ee86e6752cb4----fd0e19ed2d7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd0e19ed2d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd0e19ed2d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://gist.github.com/BrambleXu/738812287e7900428478c9035157db22#file-linear_data-csv", "anchor_text": "data"}, {"url": "https://gist.github.com/BrambleXu/2640af09b1f43b93c2d951ba91ca3d5c", "anchor_text": "code"}, {"url": "https://gist.github.com/BrambleXu/738812287e7900428478c9035157db22#file-linear_data-csv", "anchor_text": "linear_data.csv"}, {"url": "http://www.ece.utep.edu/research/webfuzzy/docs/kk-thesis/kk-thesis-html/node19.html", "anchor_text": "linear separable problem"}, {"url": "https://en.wikipedia.org/wiki/Linear_function_(calculus)?oldformat=true#Properties", "anchor_text": "linear function"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html", "anchor_text": "doc"}, {"url": "https://stats.stackexchange.com/a/10298/116970", "anchor_text": "standardization"}, {"url": "https://www.wikiwand.com/en/Likelihood_function#/Log-likelihood", "anchor_text": "log likelihood"}, {"url": "https://www.youtube.com/watch?v=SB2vz57eKgc", "anchor_text": "video"}, {"url": "https://math.stackexchange.com/questions/25214/what-does-mean", "anchor_text": "here"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html", "anchor_text": "numpy.dot()"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html", "anchor_text": "numpy.dot()"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html#numpy.matmul", "anchor_text": "np.matmul()"}, {"url": "https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html#numpy.matmul", "anchor_text": "np.matmul()"}, {"url": "https://medium.com/@bramblexu", "anchor_text": "Medium"}, {"url": "https://bramblexu.com/posts/eb7bd472/", "anchor_text": "a categorized view"}, {"url": "https://github.com/BrambleXu", "anchor_text": "BrambleXu"}, {"url": "https://www.linkedin.com/in/xu-liang-99356891/", "anchor_text": "Xu Liang"}, {"url": "https://bramblexu.com", "anchor_text": "BrambleXu"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fd0e19ed2d7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fd0e19ed2d7---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----fd0e19ed2d7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/python-programming?source=post_page-----fd0e19ed2d7---------------python_programming-----------------", "anchor_text": "Python Programming"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----fd0e19ed2d7---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffd0e19ed2d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&user=Xu+LIANG&userId=ee86e6752cb4&source=-----fd0e19ed2d7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffd0e19ed2d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&user=Xu+LIANG&userId=ee86e6752cb4&source=-----fd0e19ed2d7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd0e19ed2d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffd0e19ed2d7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fd0e19ed2d7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fd0e19ed2d7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bramblexu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@bramblexu?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Xu LIANG"}, {"url": "https://medium.com/@bramblexu/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "http://linkedin.com/in/xu-liang-99356891/", "anchor_text": "linkedin.com/in/xu-liang-99356891/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fee86e6752cb4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&user=Xu+LIANG&userId=ee86e6752cb4&source=post_page-ee86e6752cb4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd5c245665a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7&newsletterV3=ee86e6752cb4&newsletterV3Id=d5c245665a2&user=Xu+LIANG&userId=ee86e6752cb4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}