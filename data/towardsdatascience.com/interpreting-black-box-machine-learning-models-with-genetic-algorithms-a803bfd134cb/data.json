{"url": "https://towardsdatascience.com/interpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb", "time": 1683017411.5962481, "path": "towardsdatascience.com/interpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb/", "webpage": {"metadata": {"title": "Interpreting Black-Box Machine Learning Models with Genetic Algorithms | by Federico Piccinini | Towards Data Science", "h1": "Interpreting Black-Box Machine Learning Models with Genetic Algorithms", "description": "Modern Machine Learning (ML) algorithms are achieving remarkable results thanks to the continuous development of more and more complex architectures that are able to identify patterns that are beyond\u2026"}, "outgoing_paragraph_urls": [{"url": "http://housinganywhere.com", "anchor_text": "HousingAnywhere", "paragraph_index": 38}, {"url": "https://medium.com/u/4e623cf1c796?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "Massimo Belloni", "paragraph_index": 38}, {"url": "https://www.politesi.polimi.it/retrieve/4a713b2d-a8f6-4781-86b1-35e07ad7ad68/Piccinini_Polimi_Thesis.pdf", "anchor_text": "Enhancing Fraud Detection Through Interpretable Machine Learning", "paragraph_index": 39}, {"url": "https://arxiv.org/abs/1602.04938", "anchor_text": "\u201dwhy should I trust you?\u201d: Explaining the predictions of any classifier", "paragraph_index": 39}, {"url": "https://arxiv.org/abs/1705.07874", "anchor_text": "A Unified Approach to Interpreting Model Predictions", "paragraph_index": 39}], "all_paragraphs": ["Modern Machine Learning (ML) algorithms are achieving remarkable results thanks to the continuous development of more and more complex architectures that are able to identify patterns that are beyond human understanding. However, these results come with a price to be paid: understanding machine learning predictions is becoming increasingly difficult and in some cases even impossible.", "Understanding machine learning predictions is becoming increasingly difficult and in some cases even impossible", "On the other hand, as humans, we naturally trust what we can understand and given that certain application domains require humans to make decisions based on ML predictions (e.g. fraud detection, credit risk assessment), it becomes clear how important interpreting black-box ML models is.", "As humans we naturally trust what we can understand", "This post proposes an approach to model-agnostic (i.e. does not rely on a specific algorithm) ML interpretability which relies on the well-known yet fascinating concept of Genetic Algorithms.", "The underlying idea is, given a specific sample which prediction has to be explained, to generate a new synthetic sample which is as similar as possible to the original one but with a significantly different prediction.We can ideally explain the reason why the model is producing a specific prediction by looking at the differences between the original and the synthetic sample. This approach is frequently referred to in the literature as Adversarial and Counterfactual Explanations.", "Similar input features but different predictions", "Let\u2019s now look at a simple example to clarify the idea. Suppose to have a machine learning classifier which is able to discriminate between frauds and legit items published on an online housing marketplace (you can think of something similar to AirBnB).", "All of a sudden, a new item just published on the platform is identified by the classifier as a possible scam. In this example, the item under consideration represents an entire house in the city of Eindhoven rented for 600\u20ac a month.", "It might not be easy to understand what makes this item suspicious and that\u2019s why ML explanations are needed.", "Let\u2019s now suppose to have a magic tool which is able to generate a new synthetic item that, despite being really similar to the original one, is evaluated by the same classifier as legit.", "As it is possible to see, very similar input features originate completely different outcomes. It now becomes intuitive that the explanation, namely the driving factor(s) of the suspiciousness, can be generated by comparing the two instances as follows:", "So far so good, but how can we generate this new sample to be used for comparison and the consequent explanation? Well, that\u2019s were Genetic Algorithms come in handy.", "Genetic Algorithms (GA) is a heuristics-based optimization technique that simulates Darwin\u2019s evolution theory on a specific domain.", "The key components of the algorithm are:", "With this in mind, a general optimization procedure works as follows:", "To solve our optimization problem, the fitness function must enforce that the final synthetic instance matches the two conditions stated before:", "Overall samples similarity can be divided into:", "The higher the features similarity, the higher the fitness value", "An example of this function can be defined as follow:", "where X, X\u2019 represent respectively the input features of the original instance which prediction has to be explained and the ones belonging to a synthetic sample.", "On the other hand, this contribution to the fitness value of a sample is given by the difference between the prediction to be explained and the one generated by the same ML model over the synthetic sample. Here, the term prediction represents the output of the ML algorithm, namely either a probability if we are dealing with a classifier, or a continuous value if we are solving a regression problem.", "The larger the prediction discrepancy, the higher the fitness value.", "By taking as an example a binary classification problem, this part of the fitness function can be implemented as follows:", "where \u0394max is the theoretical maximum discrepancy achievable given the desired probability for synthetic samples t and p(X\u2019) represents the predicted probability generated by the classifier over the synthetic sample X\u2019.If, for example, we are interested in explaining the prediction of an instance belonging to the positive class, these formulas can be simplified as:", "The final fitness value can be obtained as the combination of the individual components, for example in the shape of a weighted sum:", "Once the optimization procedure is completed, the candidate with the highest fitness value of the final population is used as a counterfactual example to generate the explanation.", "The candidate with the highest fitness value represents the counterfactual instance", "However, the process is not finished yet. In order to make the counterfactual comparison easily comprehensible for humans, instances must be summarised by using just a meaningful subset of features, those that are most important for the explanation.Such importance has been established by using an intuitive heuristic: the more a feature assumes values that are different from the original one in the final population, the more it is important.", "The more a feature has changed, the more important it is", "Mathematically, this concept has been encoded using the following formulas:", "Where X is the original instance, X\u2019 is a synthetic sample, f is a feature, |f| is the cardinality of feature |f|(i.e. the number of different values of that feature), and P represents the population at the end of the evolutionary process. As a result, g is a simple binary function that evaluates to 1 only when a feature assumes different values between the original instance and the synthetic one. The final importance imp is then calculated by counting how many times each feature has changed from its original value and then normalized by a cardinality factor (high cardinality features are more likely to assume different values).Please note, when dealing with high cardinality numerical features, in order to have meaningful importance values, a discretization step of those features may be needed.", "Final explanations are then generated as a list of counterfactual statements, one for each of the most important features. Each statement is composed of the feature\u2019s name, the feature\u2019s value in the original instance, and the feature\u2019s value in the best synthetic sample.", "Let\u2019s now look at a business case where a ML classifier is deployed to perform Fraud Detection in online marketplaces[1]. In this scenario, given the sensitivity of the domain, we are not only interested in the final classification outcome but also in understanding what are the driving factors of the suspiciousness that AI has identified.", "The following is a real example of how ML explanations generated with this approach look:", "To conclude, here is a summary of our process and how we implemented and evaluated this approach with respect to the Fraud Detection business case mentioned above:", "At first, ML explanations proved to enhance human\u2019s ability in understanding predictions, resulting in a faster decision-making process and better accuracy of the decisions made[1];", "On top of that, Adversarial Explanations generated using the evolutionary approach proposed here achieved better performances[1] than LIME[2] and comparable performances to SHAP[3], widely acknowledged as the to-go algorithm when it comes to model-agnostic ML explanations.", "I am thankful to HousingAnywhere for giving me the opportunity to develop this algorithm as part of my Data Science internship in the company. Special thanks to Massimo Belloni for his contribution and the support throughout the whole project.", "[1] F. Piccinini, M. Belloni, E. Della Valle and M. Pechenizkiy, Enhancing Fraud Detection Through Interpretable Machine Learning (2020), Politecnico di Milano & Eindhoven University of Technology[2] M. T. Ribeiro, S. Singh, and C. Guestrin. \u201dwhy should I trust you?\u201d: Explaining the predictions of any classifier (2016). In Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining[3] S. Lundberg, S. Lee, A Unified Approach to Interpreting Model Predictions (2017), NeurIPS", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa803bfd134cb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@federico.piccinini.1?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@federico.piccinini.1?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "Federico Piccinini"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52e46081d270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&user=Federico+Piccinini&userId=52e46081d270&source=post_page-52e46081d270----a803bfd134cb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa803bfd134cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa803bfd134cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@astute?utm_source=medium&utm_medium=referral", "anchor_text": "Rik van der Kroon"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://housinganywhere.com", "anchor_text": "HousingAnywhere"}, {"url": "https://medium.com/u/4e623cf1c796?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "Massimo Belloni"}, {"url": "https://www.politesi.polimi.it/retrieve/4a713b2d-a8f6-4781-86b1-35e07ad7ad68/Piccinini_Polimi_Thesis.pdf", "anchor_text": "Enhancing Fraud Detection Through Interpretable Machine Learning"}, {"url": "https://arxiv.org/abs/1602.04938", "anchor_text": "\u201dwhy should I trust you?\u201d: Explaining the predictions of any classifier"}, {"url": "https://arxiv.org/abs/1705.07874", "anchor_text": "A Unified Approach to Interpreting Model Predictions"}, {"url": "https://medium.com/tag/genetic-algorithm?source=post_page-----a803bfd134cb---------------genetic_algorithm-----------------", "anchor_text": "Genetic Algorithm"}, {"url": "https://medium.com/tag/interpretable-ai?source=post_page-----a803bfd134cb---------------interpretable_ai-----------------", "anchor_text": "Interpretable Ai"}, {"url": "https://medium.com/tag/explainable-ai?source=post_page-----a803bfd134cb---------------explainable_ai-----------------", "anchor_text": "Explainable Ai"}, {"url": "https://medium.com/tag/fraud-detection?source=post_page-----a803bfd134cb---------------fraud_detection-----------------", "anchor_text": "Fraud Detection"}, {"url": "https://medium.com/tag/adversarial-example?source=post_page-----a803bfd134cb---------------adversarial_example-----------------", "anchor_text": "Adversarial Example"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa803bfd134cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&user=Federico+Piccinini&userId=52e46081d270&source=-----a803bfd134cb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa803bfd134cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&user=Federico+Piccinini&userId=52e46081d270&source=-----a803bfd134cb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa803bfd134cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa803bfd134cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a803bfd134cb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a803bfd134cb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a803bfd134cb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a803bfd134cb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@federico.piccinini.1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@federico.piccinini.1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Federico Piccinini"}, {"url": "https://medium.com/@federico.piccinini.1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F52e46081d270&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&user=Federico+Piccinini&userId=52e46081d270&source=post_page-52e46081d270--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F52e46081d270%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finterpreting-black-box-machine-learning-models-with-genetic-algorithms-a803bfd134cb&user=Federico+Piccinini&userId=52e46081d270&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}