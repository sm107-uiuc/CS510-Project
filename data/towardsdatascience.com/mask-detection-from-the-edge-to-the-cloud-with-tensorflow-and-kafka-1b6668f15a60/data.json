{"url": "https://towardsdatascience.com/mask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60", "time": 1683015116.877166, "path": "towardsdatascience.com/mask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60/", "webpage": {"metadata": {"title": "Mask Detection from the edge to the cloud \u2014 with TensorFlow and Kafka | by Fran\u00e7ois Paupier | Towards Data Science", "h1": "Mask Detection from the edge to the cloud \u2014 with TensorFlow and Kafka", "description": "Amidst a time of social distancing, tech renews with its promise of building a safer world. Heat cameras, mask detection mechanisms are not a solution to the COVID pandemic but can help detect areas\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Raspberry_Pi", "anchor_text": "Raspberry Pi", "paragraph_index": 3}, {"url": "https://projects.raspberrypi.org/en/projects/getting-started-with-picamera", "anchor_text": "camera", "paragraph_index": 3}, {"url": "https://coral.ai/products/accelerator/", "anchor_text": "Coral USB accelerator", "paragraph_index": 3}, {"url": "https://github.com/fpaupier/pi-mask-detection/blob/master/detect_mask.py", "anchor_text": "detect_mask.py", "paragraph_index": 9}, {"url": "https://developers.google.com/protocol-buffers", "anchor_text": "protocol buffers.", "paragraph_index": 13}, {"url": "https://mqtt.org/", "anchor_text": "MQTT", "paragraph_index": 19}, {"url": "https://ethical.institute/index.html", "anchor_text": "Resources", "paragraph_index": 22}, {"url": "https://eur-lex.europa.eu/eli/reg/2016/679/oj", "anchor_text": "GDPR", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Fran%C3%A7ois_Rabelais", "anchor_text": "Fran\u00e7ois Rabelais", "paragraph_index": 24}, {"url": "https://en.wikipedia.org/wiki/Gargantua_and_Pantagruel", "anchor_text": "La vie de Gargantua et de Pantagruel", "paragraph_index": 24}], "all_paragraphs": ["Amidst a time of social distancing, tech renews with its promise of building a safer world. Heat cameras, mask detection mechanisms are not a solution to the COVID pandemic but can help detect areas of risk and mitigate clusters\u2019 growth by adjusting local public policy.", "In this article, I outline how to build a system based on a network of IoT devices equipped with camera and face detection AI to identify whether people are wearing their face mask or not within a space and collecting such events.", "The tools used in this project are:", "You'll need a Raspberry Pi 4 with its camera for this project. I also use a Coral USB accelerator for faster inference on the Pi.", "As with any architecture and choice of tools, this is an opinionated one. I slightly elaborate on the pros, cons, limitations, and advantages of the tools I chose at the end of the article. Something\u2019s troubling you? Let\u2019s discuss it in the comments. \ud83d\ude09", "Now, let\u2019s see how we can implement each component of this architecture. Logically, we can break down the system into three distinct parts. The full code is available from my GitHub.", "In this article, we focus on connecting the dots between those components.", "At the edge of our system, a Pi equipped and its camera detects whether an event occurs. I define an event as: \u201csomeone is not wearing their mask.\u201d", "To detect whether someone is wearing their mask, we follow those steps:", "The logic is detailed in the main() function of my detect_mask.py", "Once the Pi records an event, we send it to a server for archiving and further processing.", "Of course, we could have a notification system directly running on the Pi. Still, our goal here is to illustrate a system of several IoT devices reporting events. Further processing is done on the cloud for proper separation of concerns between 1) event collection at the edge and 2) advanced processing in a controlled environment.", "Consider those two repositories for this part:", "Each device publishes its events to a Kafka topic \u2014 \u201calert-topic\u201d \u2014 for asynchronous communication between the Pi and the alert Ingress service. The event message complies with the schema defined using protocol buffers.", "On the cloud, the alert ingress service subscribes to the alert-topic and archives incoming events in PostgreSQL. Then, the ingress service publishes a message the notification service will consume.", "You have archived the events in the cloud, now what? Let\u2019s add a notification service, sending email to an administrator with a summary of the event.", "An interesting follow up would be to build a geo-visualization tool to analyze event per location and time \ud83d\udccd\ud83d\uddfa", "This prototype illustrates the concept and is not a production-ready infrastructure. Key elements to take into account to bring this concept to production are:", "Language choice \u2014 Why Python and Go? Python for the ease of integration with TensorFlow. Go for its strong typing and native support for network related operation.", "Asynchronous message queue choice \u2014 Why Kafka? Many other solutions are more lightweight in terms of memory footprint and could do the trick at the edge (MQTT). But with today\u2019s increasing computing power at the edge, why bothering? A Raspberry Pi 4 has 8Go RAM.", "Schema definition strategy \u2014 Why Protobufs? I got your point; JSON would be more comfortable to work with and would do the trick here. For the sake of a proof of concept like this one, using JSON will save lots of headaches since we\u2019re dealing with a single device. However, schema definition and consistency is a crucial feature of an event-driven architecture protobufs make this easier.", "Such ideas can help locate and mitigate clusters\u2019 growth but potentially pose a severe threat to individuals\u2019 privacy.", "Resources about responsible machine learning become more and more accessible and I invite you to keep those guiding principles in mind when you build AI-based systems.", "Also note that the General Data Protection Regulation (GDPR) strongly regulates personal data collection and processing.", "Science sans conscience n\u2019est que ruine de l\u2019\u00e2me \u2014 Fran\u00e7ois Rabelais in La vie de Gargantua et de Pantagruel", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning \u2014 Data pipeline \u2014 Software Engineering"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1b6668f15a60&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@francois.paupier?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@francois.paupier?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": "Fran\u00e7ois Paupier"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F91f3b6c8ace7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&user=Fran%C3%A7ois+Paupier&userId=91f3b6c8ace7&source=post_page-91f3b6c8ace7----1b6668f15a60---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1b6668f15a60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1b6668f15a60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@b_g?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Benedikt Geyer"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://golang.org/", "anchor_text": "Go"}, {"url": "https://kafka.apache.org/", "anchor_text": "Kafka"}, {"url": "https://developers.google.com/protocol-buffers", "anchor_text": "Protocol buffers"}, {"url": "https://www.sqlite.org/index.html", "anchor_text": "SQLite"}, {"url": "https://www.postgresql.org/", "anchor_text": "PostgreSQL"}, {"url": "https://en.wikipedia.org/wiki/Raspberry_Pi", "anchor_text": "Raspberry Pi"}, {"url": "https://projects.raspberrypi.org/en/projects/getting-started-with-picamera", "anchor_text": "camera"}, {"url": "https://coral.ai/products/accelerator/", "anchor_text": "Coral USB accelerator"}, {"url": "https://github.com/fpaupier/pi-mask-detection", "anchor_text": "github.com/fpaupier/pi-mask-detection"}, {"url": "https://github.com/fpaupier/alertDispatcher", "anchor_text": "github.com/fpaupier/alertDispatcher"}, {"url": "https://github.com/fpaupier/alertIngress", "anchor_text": "github.com/fpaupier/alertIngress"}, {"url": "https://github.com/fpaupier/notifyMask", "anchor_text": "github.com/fpaupier/notifyMask"}, {"url": "https://ai.googleblog.com/2018/04/mobilenetv2-next-generation-of-on.html", "anchor_text": "MobileNet v2"}, {"url": "https://github.com/fpaupier/pi-mask-detection/tree/master/models/mask_detector", "anchor_text": "Model"}, {"url": "https://github.com/fpaupier/pi-mask-detection/blob/master/detect_mask.py", "anchor_text": "detect_mask.py"}, {"url": "https://github.com/fpaupier/alertDispatcher", "anchor_text": "github.com/fpaupier/alertDispatcher"}, {"url": "https://github.com/fpaupier/alertIngress", "anchor_text": "github.com/fpaupier/alertIngress"}, {"url": "https://developers.google.com/protocol-buffers", "anchor_text": "protocol buffers."}, {"url": "https://en.wikipedia.org/wiki/Retention_period", "anchor_text": "retention policy"}, {"url": "https://docs.cloudera.com/csp/2.0.1/schema-registry-overview/topics/csp-schema_registry_overview.html", "anchor_text": "Schema registry"}, {"url": "https://en.wikipedia.org/wiki/Concept_drift", "anchor_text": "drift"}, {"url": "https://mlflow.org/", "anchor_text": "ML Flow"}, {"url": "https://mqtt.org/", "anchor_text": "MQTT"}, {"url": "https://ethical.institute/index.html", "anchor_text": "Resources"}, {"url": "https://eur-lex.europa.eu/eli/reg/2016/679/oj", "anchor_text": "GDPR"}, {"url": "https://en.wikipedia.org/wiki/Fran%C3%A7ois_Rabelais", "anchor_text": "Fran\u00e7ois Rabelais"}, {"url": "https://en.wikipedia.org/wiki/Gargantua_and_Pantagruel", "anchor_text": "La vie de Gargantua et de Pantagruel"}, {"url": "https://medium.com/tag/diy?source=post_page-----1b6668f15a60---------------diy-----------------", "anchor_text": "DIY"}, {"url": "https://medium.com/tag/raspberry-pi?source=post_page-----1b6668f15a60---------------raspberry_pi-----------------", "anchor_text": "Raspberry Pi"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1b6668f15a60---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/cloud-computing?source=post_page-----1b6668f15a60---------------cloud_computing-----------------", "anchor_text": "Cloud Computing"}, {"url": "https://medium.com/tag/software-development?source=post_page-----1b6668f15a60---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1b6668f15a60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&user=Fran%C3%A7ois+Paupier&userId=91f3b6c8ace7&source=-----1b6668f15a60---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1b6668f15a60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&user=Fran%C3%A7ois+Paupier&userId=91f3b6c8ace7&source=-----1b6668f15a60---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1b6668f15a60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1b6668f15a60&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1b6668f15a60---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1b6668f15a60--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1b6668f15a60--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1b6668f15a60--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1b6668f15a60--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@francois.paupier?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@francois.paupier?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Fran\u00e7ois Paupier"}, {"url": "https://medium.com/@francois.paupier/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "242 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F91f3b6c8ace7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&user=Fran%C3%A7ois+Paupier&userId=91f3b6c8ace7&source=post_page-91f3b6c8ace7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cf092654f58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmask-detection-from-the-edge-to-the-cloud-with-tensorflow-and-kafka-1b6668f15a60&newsletterV3=91f3b6c8ace7&newsletterV3Id=7cf092654f58&user=Fran%C3%A7ois+Paupier&userId=91f3b6c8ace7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}