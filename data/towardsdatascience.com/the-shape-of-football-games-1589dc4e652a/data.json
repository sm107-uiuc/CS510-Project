{"url": "https://towardsdatascience.com/the-shape-of-football-games-1589dc4e652a", "time": 1683001366.70057, "path": "towardsdatascience.com/the-shape-of-football-games-1589dc4e652a/", "webpage": {"metadata": {"title": "The shape of football games. Modelling the outcome of football\u2026 | by Francesco Palma | Towards Data Science", "h1": "The shape of football games", "description": "If you are a football fan, you\u2019d die to have Messi join your squad. Would your team win the championship? Would it at least avoid relegation? Since Messi cannot join everybody\u2019s team, we choose to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/giotto-ai/football-tda", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://www.openml.org/d/42197", "anchor_text": "matches", "paragraph_index": 3}, {"url": "https://www.openml.org/d/42198", "anchor_text": "odds", "paragraph_index": 3}, {"url": "https://www.openml.org/d/42188", "anchor_text": "tda features", "paragraph_index": 3}, {"url": "https://www.openml.org/d/42194", "anchor_text": "player stats", "paragraph_index": 3}, {"url": "https://www.openml.org/d/42199", "anchor_text": "player names", "paragraph_index": 3}, {"url": "https://www.kaggle.com/hugomathien/soccer", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://giotto.ai", "anchor_text": "Giotto", "paragraph_index": 24}, {"url": "https://towardsdatascience.com/persistent-homology-with-examples-1974d4b9c3d0", "anchor_text": "post", "paragraph_index": 24}], "all_paragraphs": ["Written by Francesco Palma, Diego Fiori, Dan Titus Salajan, Alessio Baccelli, Matteo D\u2019ospina and Thomas Boys", "If you are a football fan, you\u2019d die to have Messi join your squad. Would your team win the championship? Would it at least avoid relegation? Since Messi cannot join everybody\u2019s team, we choose to use data and simulations to infer the answer. The EA Sport\u2019s Fifa dataset is our proxy for player characteristics and TDA (topological data analysis) the spice to model the probability of the outcome of each match. Using simulations on those probabilities, we generate the most likely final ranking of the Premier League.", "Who do you need to beat Klopp this year?", "Our model allows you to compose your squad, and to measure the overall effect on the team\u2019s end of year position in the leaderboard. Try the model for yourself, the python code is available over here, and data here: matches, odds, tda features, player stats, player names (original source here).", "ASSUMPTION 1: THE OUTPUT OF A FOOTBALL MATCH DEPENDS ONLY ON THE SPECIFIC AND COMBINED ATTRIBUTES OF PLAYERS ON THE FIELD.", "Most coaches will disagree with this assumption because we are omitting the non-negligible influence of things like team-spirit, weather, tiredness due to intra-week matches, injuries, yellow/red cards, substitutions, tactics, personal commitment of individual players, time of the season, special commitment of fans and many other internal and external factors that can influence the outcome of a match.", "Having said so, you might have figured out the first undeniable truth:", "Our model is clearly wrong (as any model is\u2026).", "Whoever has been on the field as a player, coach, fan, steward, bench warmer or gardener knows that when it comes to predict the outcome of a match, the amount of information to be taken into account is wider than the information that can be recorded. A ferocious scream from the stands, a mistaken whistle from the ref\u2019, or the shrimps on the lunch menu may jeopardize the whole outcome of the match. Some respected scientists claim that football is just random or as hard as proving Fermat\u2019s last theorem (except we have 129 pages of mathematical proof for the latter).", "We are of course aware that no predictive model can perfectly predict the outcome of football matches. Our ambition is rather to see whether the agnostic methods of topological data analysis can identify relevant patterns in the minuscule set of seven aggregated characteristics for each team.", "We use the 24 attributes given to each player by EA to engineer attack and defense features. The initial attribute correlation matrix gives directions to build the latter. To generate features for the whole team, we build the following 7 features based on the initial match composition:", "\u00b7 Maximum attack value in the team", "\u00b7 Maximum defense value in the team", "\u00b7 Average attack in the team", "\u00b7 Average defense in the team", "\u00b7 Standard deviation of attack in the team, in percentage", "\u00b7 Standard deviation of defense in the team, in percentage", "We train a model to estimate the probability of each match outcome based on 2591 matches from the past six Premier League seasons. We test on the 380 matches of season 14/15 for which we provide a simulation of the final leaderboard.", "It is the 31st of December 2011, Sir Alex Ferguson is turning 70 and Manchester United, at Old Trafford, is playing against Blackburn Rovers, the very last of the leaderboard. During their last match together, the Rovers suffered an abysmal 7\u20131 defeat. That night, those who were expecting another demonstration from Ferguson\u2019s team would be very surprised. Leading 2\u20130, Blackburn seal the fate of the match 3\u20132 with a victory goal in the last 10 minutes.", "That night the lucky betters were making 28:1 at the bookies.", "Unfortunately, this miracle win at Old Trafford didn\u2019t save Blackburn from relegation. On the other hand, these points would reveal fatal for the red devils in the long-run. The missed opportunity that night lead to an incredible tie at the top of the final leaderboard. City and United both closed the season with 89 points. Thanks to a better goal difference, the citizens won the cup, leaving Manchester United with a bitter after-taste.", "Although this event seems unpredictable for Manchester United, topology makes a clear separation between the case of this match against Blackburn and confrontations against teams of the same caliber. For example we consider Man-Utd vs West Brom and Man-Utd vs Bolton during the same season.", "Let\u2019s try to understand why our match is so special (so you can plan your next trip to the bookies). The first thing we can do is study the space of matches, a match is a point in a space of 14 dimensions (remember each team has 7 features, and a match has 7+7=14 features). We use the two first components of the PCA centered around each of the matches we consider to visualize similar matches.", "What you can\u2019t see with PCA, you can see with TDA", "The three plots are projections of the 14 features used to describe the match down to two, and projections are known to loose information along the way. We use TDA to recover and visualize structure from the original space. The tool we use is a persistence diagram (available in Giotto!). A persistence diagram is a representation of the dataset in terms of the connectivity of points, it is obtained by progressively connecting neighbouring points and measuring the homology of the construction. It is a new way to understand, visualize and extract features from data. If you want to learn more about TDA we recommend this post.", "The three persistence diagrams are computed on the same point clouds as in the case of the PCA. The points in the diagrams are no longer matches, rather they describe relationships between the points in the original space. In our case, it characterises the shape of the point cloud around each of the three selected matches.", "The persistence diagrams inform you about local and global structures", "From the first two first diagrams, we can see that all the connected components (represented by the orange points) are concentrated on the y-axis between [5,10]. Furthermore, the loops (represented by the green points) are concentrated in the box [6,8]x[6,8] and their maximum distance to y=x is one.", "In the last diagram, the orange points are more spread out, the extremal point (0,17) represents a component that is late to connect with the rest of the dataset. On top of that, the green points are also much more spread out on the y=x line, and they are overall way closer to this line.", "The structure of the third diagram is suggestive of an outlier", "Indeed the orange point (0,17) represents the merge between Man. Utd.-Blackburn with the rest of the matches, this means that this match is further away than it is represented in the PCA diagram.", "Persistence diagrams are great, however they cannot be directly inputed in a predictive model. You will need to know how to convert a persistence diagram into a feature for a model.", "We use a trick called the amplitude function to synthesise the information in the diagram.", "A more detailed explanation of how we extracted features from persistence diagrams is also contained in the Python Jupyter Notebook we are sharing.", "The model for individual matches is trained: we are now ready to run some simulations for the whole season. You can choose a squad and see how far they go. As a test for the model, we studied the impact of transferring Messi in every Premier League team.", "No surprise, hiring Messi is always good.", "With Messi on your squad, your chances to be relegated drops by 12% on average, the probability to bring the trophy home increases by 4% on average, and making it to the top4 increases by 14%. The team in the most need of Messi is Queen\u2019s Park Rangers, who would climb 11 positions in the leaderboard. Originally finishing 14th, with an simulated probability of 72%, Leicester City would qualify for the Champions League.", "Below is the original leaderboard for season 14\u201315, paired with the simulated probabilities for:", "with and without Messi in each squad.", "The quality of the leaderboard simulation directly reflects the model\u2019s accuracy in predicting match outcomes. We use a random forest classifier on the 14 features + features from the persistence diagram and we test the framework against some baseline prediction strategies:", "1) Predicting the home team to win always (baseline)", "2) Elo rating computed on team\u2019s performance", "3) Market predictions given by betting odds", "In the above table, we present the accuracy of each stragegy on the test set. Below we compare the predictions in terms of their confusion matrices.", "The results confirm: football is random. Even the bookie betting odds correctly nail it only for 53% of the matches.", "Our results are comparable to those given by the betting odds, with which there is a surprisingly strong correlation. The result is interesting since our model relies on over-simplistic data. Our model has the uncommon capacity to predict draws (which represent 27% of the outcomes).", "The model generalizes well when presented with data from other years and other championships. Without having ever \u201cseen\u201d an Italian match, the same model performed at 52% rate of accuracy in predicting Serie A matches of the season 2015/2016. This would not be possible for team-specific strategies like the Elo rating.", "Maybe the best attribute of the model is its flexibility in building and testing squads. Not only can we mix teams and simulate championships, we can also make smart transfer decisions. For a fixed budget, you can optimize the best portfolio of players based on their costs and benefits.", "Our attempt is to give a simple solution to a complicated ternary classification problem. The topological model achieves nice accuracy on a very limited set of features, and it is comparable to common, although less flexible approaches.", "We have tried it with Messi, now we\u2019re curious, will Ronaldo perform better?", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-founder at L2F | Open-source developer @Giotto_ai | Mathematician interested in everything with a topology"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1589dc4e652a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lapalmafrancesco?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lapalmafrancesco?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": "Francesco Palma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc8c43a758cb0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&user=Francesco+Palma&userId=c8c43a758cb0&source=post_page-c8c43a758cb0----1589dc4e652a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1589dc4e652a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1589dc4e652a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://twitter.com/concarp98/", "anchor_text": "https://twitter.com/concarp98"}, {"url": "https://github.com/giotto-ai/football-tda", "anchor_text": "here"}, {"url": "https://www.openml.org/d/42197", "anchor_text": "matches"}, {"url": "https://www.openml.org/d/42198", "anchor_text": "odds"}, {"url": "https://www.openml.org/d/42188", "anchor_text": "tda features"}, {"url": "https://www.openml.org/d/42194", "anchor_text": "player stats"}, {"url": "https://www.openml.org/d/42199", "anchor_text": "player names"}, {"url": "https://www.kaggle.com/hugomathien/soccer", "anchor_text": "here"}, {"url": "https://www.standard.co.uk", "anchor_text": "https://www.standard.co.uk"}, {"url": "http://www.ox.ac.uk", "anchor_text": "http://www.ox.ac.uk"}, {"url": "https://www.dailymotion.com", "anchor_text": "https://www.dailymotion.com"}, {"url": "https://giotto.ai", "anchor_text": "Giotto"}, {"url": "https://towardsdatascience.com/persistent-homology-with-examples-1974d4b9c3d0", "anchor_text": "post"}, {"url": "https://metro.co.uk/2019/09/26/fifa-deny-world-player-year-award-fixed-lionel-messi-win-10813224/", "anchor_text": "https://metro.co.uk"}, {"url": "https://towardsdatascience.com/persistent-homology-with-examples-1974d4b9c3d0", "anchor_text": "Persistent Homology: A Non-Mathy Introduction with ExamplesUsing Topological Data Analysis (TDA) Tools in Data Sciencetowardsdatascience.com"}, {"url": "https://arxiv.org/abs/1710.04019", "anchor_text": "https://arxiv.org/abs/1710.04019"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1589dc4e652a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1589dc4e652a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/football?source=post_page-----1589dc4e652a---------------football-----------------", "anchor_text": "Football"}, {"url": "https://medium.com/tag/soccer?source=post_page-----1589dc4e652a---------------soccer-----------------", "anchor_text": "Soccer"}, {"url": "https://medium.com/tag/topology?source=post_page-----1589dc4e652a---------------topology-----------------", "anchor_text": "Topology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1589dc4e652a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&user=Francesco+Palma&userId=c8c43a758cb0&source=-----1589dc4e652a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1589dc4e652a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&user=Francesco+Palma&userId=c8c43a758cb0&source=-----1589dc4e652a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1589dc4e652a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1589dc4e652a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1589dc4e652a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1589dc4e652a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1589dc4e652a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1589dc4e652a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1589dc4e652a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lapalmafrancesco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lapalmafrancesco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Francesco Palma"}, {"url": "https://medium.com/@lapalmafrancesco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "206 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc8c43a758cb0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&user=Francesco+Palma&userId=c8c43a758cb0&source=post_page-c8c43a758cb0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4249f00127b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-shape-of-football-games-1589dc4e652a&newsletterV3=c8c43a758cb0&newsletterV3Id=4249f00127b0&user=Francesco+Palma&userId=c8c43a758cb0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}