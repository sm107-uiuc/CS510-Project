{"url": "https://towardsdatascience.com/understanding-fast-rcnn-for-object-detection-7a1c3f63fc66", "time": 1683016097.7989278, "path": "towardsdatascience.com/understanding-fast-rcnn-for-object-detection-7a1c3f63fc66/", "webpage": {"metadata": {"title": "Understanding Fast-RCNN for Object Detection | by Parth Rajesh Dedhia | Towards Data Science", "h1": "Understanding Fast-RCNN for Object Detection", "description": "The Fast-RCNN model was build by overcoming the drawbacks of SPPNet and RCNN. Fast RCNN improves the object detection accuracy as well as training and prediction speed as compared to other contemporary models"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1406.4729.pdf", "anchor_text": "SPPNet", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/1311.2524.pdf", "anchor_text": "RCNN", "paragraph_index": 0}, {"url": "https://datascience.stackexchange.com/a/11703", "anchor_text": "to this answer", "paragraph_index": 12}, {"url": "https://www.youtube.com/watch?v=fNk_zzaMoSs&list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab", "anchor_text": "linear algebra", "paragraph_index": 19}, {"url": "https://www.youtube.com/watch?v=rYz83XPxiZo", "anchor_text": "this video", "paragraph_index": 19}, {"url": "https://arxiv.org/pdf/1311.2524.pdf", "anchor_text": "Rich feature hierarchies for accurate object detection and semantic segmentation,", "paragraph_index": 28}, {"url": "https://arxiv.org/pdf/1406.4729.pdf", "anchor_text": "Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition", "paragraph_index": 29}], "all_paragraphs": ["The Fast-RCNN model was build by overcoming the drawbacks of SPPNet and RCNN. I have written about both, and you should have a look at them before proceeding:", "The blog has the same structure as that of the above two blogs, i.e., a conversation between a student and a teacher.", "We have previously seen R-CNN and SPPNet. Though these models have performed very well, there are some drawbacks to each of them. The following are the drawbacks common to both architectures:", "All of the above drawbacks are resolved in the Fast-RCNN paper. As the name suggests, it\u2019s a relatively fast version of RCNN and makes use of some of the architectural details of SPPNet.", "I was so amazed by the in-depth analysis shown in the R-CNN paper and the novel SPP Layer introduced in the SPPNet layer that I did not notice any of these drawbacks. Can you explain the model architecture that is used\u00a0in\u00a0Fast-RCNN?", "There are three sets of models that the author has provided analysis in the Fast-RCNN paper:", "We will be restricting our discussion to VGG-16 (pre-trained on ImageNet), which is their deepest Network.", "The input image is sent to the VGG-16 and is processed it till the last convolution layer (without the last pooling layer). And after that, the images are sent to the novel Region of Interest (RoI) pooling layer. This pooling layer always outputs a 7 x 7 map for each feature map output from the last convolution layer. This 7 x 7 map is produced by pooling, where the window size changes based on the input image. Incidentally, the flattened feature from this map produces the same size feature vector which is expected by the pre-trained FC-6 layer of the VGG-16. However, the last 1000 way softmax layer is replaced with a 21-way Softmax (unlike SVM in the case of RCNN and SPPNet). Also for the bounding box regressor, the branching happens from the last FC-7 layer instead of the convolution layer feature maps.", "Note: The RoI pooling layer is just a special case of the SPP layer, where only one of the pyramid level is used. In this case (7 x 7). Also, the calculation for each sub-window and stride is taken from the SPPNet paper.", "One of the drawbacks you stated above\u00a0is\u00a0that, the SPP layer can not back-propagate efficiently. Please can you explain how this problem is tackled? Also, how did this architecture solve the other issues like space and time complexity?", "The back-propagation becomes in-efficient in the SPP layer when the region proposals come from different images. However, they propose an efficient method for fine-tuning the network. The use of N=2 input images, and for each image they sample R=128 RoI per image. Moreover, they take 25% of the foreground images with IoU greater than 0.5 with the ground truth bounding box. For IoU between the interval of [0.1, 0.5) with the ground truth box; these proposals are considered as background. The author claim that:", "The lower threshold of 0.1 appears to act as a heuristic for hard example mining", "Note: The back-propagation through the RoI pooling layer has a similar implementation as that with any normal max-pooling layer. The author has just described that mathematically. For a simpler understanding, refer to this answer.", "Since we have seen how the back-propagation happens in this network, let\u2019s also see how the issue of multi-stage training was handled. Instead of training separately, the author did the training of the bounding box regressor and the softmax layer together. They named this loss function the multi-task loss function.", "Verbally, the cross-entropy loss is used for training the last 21-way softmax layer, and the smoothL1 loss handled the training of the dense layer added for the 84 regression unit handling localization of bounding box. The summation of these two losses is used to fine-tune the remaining network, and this happens along with the training of the new softmax and regression layer.", "To affirm, that this new method of training does not hinder the performance, the paper has shown the following analysis.", "The yellow boxes represent the training without a bounding box regressor at train or test time, whereas the red boxes show the results after using the multi-task loss function for training and fine-tuning. The remaining two columns are self-explanatory from the images. The key point to note is that the results are improved using this multi-task loss.", "The loss function used by them does improve the mAP on Pascal VOC 2007. So, is it due to this multi-task training, that the caching of these features is avoided thus saving us the time of generating and writing them to a disk?", "Yes, this observation is correct. Moreover, the author has provided some more information about increasing speed. It was observed that apply Singular Value Decomposition (SVD) to the FC layers, splits the operation into two matrix multiplication and reduces the computation time.", "Singular Value Decomposition: Factorizing a matrix into three matrices where a diagonal matrix is sandwiched between two orthogonal matrices. The diagonal matrix tells the amount of variance present in a particular axis and is in descending order. Hence selecting the top t diagonal values from the diagonal matrix, means selecting the values which contribute the highest in the output\u00a0as\u00a0they\u00a0have\u00a0high\u00a0variance. (If you are not familiar with the intuition of SVD have a look at the series of videos on linear algebra and then check this video)", "Though the model is faster than RCNN and SPPNet, using SVD improves the time with minimal drop in mAP. For the above image, the top 1024 values were selected from the 25088 x 4096 matrix in the FC-6 layer, and the top 256 values were selected from the 4096 x 4096 FC-7 layer. The image below shows how the model performs with other models in terms of speed.", "The above image could be summarized as follows:", "Has the paper provided any analysis of their architecture?", "By implementing the hard mining strategy described a little while ago, the back-propagation becomes efficient to implement. However, which layers to fine-tune in the deep VGG-16 network were also explored and are described below.", "The author found that for VGG-16, fine-tuning all the layers from conv3_1 significantly impacted that the mAP. When fine-tuning the Conv2 layers, the training speed decreased, and fine-tuning the conv1 layers exceeds the GPU memory. However, the results after training the Conv layers show a huge jump in mAP (from 61.4 to 66.9%), as compared to the ones in which they were not trained. Hence, fine-tuning the convolution layer also becomes essential, and this was a major drawback in SPPNet. All the results discussed previously are fine-tuned from conv3_1.", "The author has compared their model with the contemporary models and the Fast-RCNN has outperformed them. I have shown the results for pascal VOC10. The results for pascal VOC 2007 and VOC 2012 and can be seen from the paper.", "Some other observations shared in the paper are:", "Most important details from the paper have been discussed, but a look at the paper is always recommended. Before reading the Fast-RCNN paper, make sure to read RCNN followed by SPPNet.", "R. Girshick, J. Donahue, T. Darrell, J. Malik, Rich feature hierarchies for accurate object detection and semantic segmentation, Computer Vision and Pattern Recognition, 2014", "K. He, X Zhang, S. Ren, J Sun, Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition, ECCV, 2014", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I like reading and implementing the ideas researched in Computer Vision and Deep Learning papers. I post my notes on Medium."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7a1c3f63fc66&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://parthdedhia.medium.com/?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": ""}, {"url": "https://parthdedhia.medium.com/?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": "Parth Rajesh Dedhia"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F69485e9d0ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&user=Parth+Rajesh+Dedhia&userId=69485e9d0ea6&source=post_page-69485e9d0ea6----7a1c3f63fc66---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a1c3f63fc66&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a1c3f63fc66&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1406.4729.pdf", "anchor_text": "SPPNet"}, {"url": "https://arxiv.org/pdf/1311.2524.pdf", "anchor_text": "RCNN"}, {"url": "https://towardsdatascience.com/understanding-regions-with-cnn-features-r-cnn-ec69c15f8ea7", "anchor_text": "Understanding Regions with CNN features (R-CNN)The architectural details of R-CNN and key takeaways from the model design and the paper.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/understanding-sppnet-for-object-detection-and-classification-682d6d2bdfb", "anchor_text": "Understanding SPPNet for Object Detection and ClassificationSPPNet allows variable size input image to CNN and can be used for Classification and Object Detectiontowardsdatascience.com"}, {"url": "https://datascience.stackexchange.com/a/11703", "anchor_text": "to this answer"}, {"url": "https://arxiv.org/pdf/1504.08083.pdf", "anchor_text": "paper"}, {"url": "https://www.youtube.com/watch?v=fNk_zzaMoSs&list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab", "anchor_text": "linear algebra"}, {"url": "https://www.youtube.com/watch?v=rYz83XPxiZo", "anchor_text": "this video"}, {"url": "https://arxiv.org/pdf/1504.08083.pdf", "anchor_text": "the paper"}, {"url": "https://arxiv.org/pdf/1504.08083.pdf", "anchor_text": "paper"}, {"url": "https://arxiv.org/pdf/1504.08083.pdf", "anchor_text": "paper"}, {"url": "https://arxiv.org/pdf/1311.2524.pdf", "anchor_text": "Rich feature hierarchies for accurate object detection and semantic segmentation,"}, {"url": "https://arxiv.org/pdf/1406.4729.pdf", "anchor_text": "Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition"}, {"url": "https://arxiv.org/pdf/1504.08083.pdf", "anchor_text": "Fast R-CNN"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----7a1c3f63fc66---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----7a1c3f63fc66---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7a1c3f63fc66---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/fast-rcnn?source=post_page-----7a1c3f63fc66---------------fast_rcnn-----------------", "anchor_text": "Fast Rcnn"}, {"url": "https://medium.com/tag/convolution-neural-net?source=post_page-----7a1c3f63fc66---------------convolution_neural_net-----------------", "anchor_text": "Convolution Neural Net"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7a1c3f63fc66&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&user=Parth+Rajesh+Dedhia&userId=69485e9d0ea6&source=-----7a1c3f63fc66---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7a1c3f63fc66&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&user=Parth+Rajesh+Dedhia&userId=69485e9d0ea6&source=-----7a1c3f63fc66---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a1c3f63fc66&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7a1c3f63fc66&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7a1c3f63fc66---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7a1c3f63fc66--------------------------------", "anchor_text": ""}, {"url": "https://parthdedhia.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://parthdedhia.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Parth Rajesh Dedhia"}, {"url": "https://parthdedhia.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "77 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F69485e9d0ea6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&user=Parth+Rajesh+Dedhia&userId=69485e9d0ea6&source=post_page-69485e9d0ea6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F21fd8c4a6fae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-fast-rcnn-for-object-detection-7a1c3f63fc66&newsletterV3=69485e9d0ea6&newsletterV3Id=21fd8c4a6fae&user=Parth+Rajesh+Dedhia&userId=69485e9d0ea6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}