{"url": "https://towardsdatascience.com/text-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f", "time": 1682994358.357492, "path": "towardsdatascience.com/text-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f/", "webpage": {"metadata": {"title": "Text Classification with State of the Art NLP Library \u2014 Flair | by Tadej Magajna | Towards Data Science", "h1": "Text Classification with State of the Art NLP Library \u2014 Flair", "description": "Why is this big news for NLP? Flair delivers state-of-the-art performance in solving NLP problems such as named entity recognition (NER), part-of-speech tagging (PoS), sense disambiguation and text\u2026"}, "outgoing_paragraph_urls": [{"url": "http://alanakbik.github.io/papers/coling2018.pdf", "anchor_text": "Contextual String Embeddings for Sequence Labelling", "paragraph_index": 4}, {"url": "https://realpython.com/installing-python/", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://fasttext.cc/docs/en/supervised-tutorial.html", "anchor_text": "FastText format", "paragraph_index": 13}, {"url": "https://www.kaggle.com/uciml/sms-spam-collection-dataset", "anchor_text": "this link on Kaggle", "paragraph_index": 15}, {"url": "https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_5_DOCUMENT_EMBEDDINGS.md", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_8_MODEL_OPTIMIZATION.md", "anchor_text": "described here", "paragraph_index": 26}, {"url": "https://towardsdatascience.com/how-to-beat-automl-hyperparameter-optimisation-with-flair-3b2f5092d9f5", "anchor_text": "In the next publication", "paragraph_index": 31}], "all_paragraphs": ["Why is this big news for NLP? Flair delivers state-of-the-art performance in solving NLP problems such as named entity recognition (NER), part-of-speech tagging (PoS), sense disambiguation and text classification. It\u2019s an NLP framework built on top of PyTorch.", "This article explains how to use existing and build custom text classifiers with Flair.", "Text classification is a supervised machine learning method used to classify sentences or text documents into one or more defined categories. It\u2019s a widely used natural language processing task playing an important role in spam filtering, sentiment analysis, categorisation of news articles and many other business related issues.", "Most current state of the art approaches rely on a technique called text embedding. It transforms text into a numerical representation in high-dimensional space. It allows for a document, sentence, word, a character (depending on what embedding we use) to be expressed as a vector in this high-dimensional space.", "The reason Flair is exciting news for NLP is because a recent paper Contextual String Embeddings for Sequence Labelling from Zalando Research covers an approach that consistently outperforms previous state-of-the-art solutions. It\u2019s implemented and fully supported in Flair and can be used to build text classifiers.", "To install Flair you will need Python 3.6. If you do not have it yet, here\u2019s a guide on how to do that. Then, to install Flair, run:", "This will install all the required packages needed to run Flair. It will also include PyTorch which Flair sits on top of.", "The new release 0.4 comes with two pre-trained models. A sentiment analysis model trained on the IMDB dataset and an \u2018offensive language detection\u2019 model (which currently only supports German).", "Using, downloading and storing the model has all been incorporated into a single method that makes the whole process of using pre-trained models surprisingly straightforward.", "To use the sentiment analysis model simply run:", "When running this for the first time, Flair will download the sentiment analysis model and by default store it into the .flair sub-folder of the home directory. It can take up to a few minutes.", "The code above first loads the required libraries, then loads the sentiment analysis model into memory (downloads it first if needed) and then predicts the sentiment score of sentence \u201cFlair is pretty neat!\u201d on the scale form 0 to 1. The final command prints out: The sentence above is: [Positive (1.0)].", "That\u2019s it! Now you can for example incorporate the code into a REST api and offer a service comparable to Google\u2019s Cloud Natural Language API\u2019s sentiment analysis which can prove to be quite expensive when used in production on high volume of requests.", "To train a custom text classifier we will first need a labelled dataset. Flair\u2019s classification dataset format is based on the Facebook\u2019s FastText format. The format requires one or multiple labels to be defined at the beginning of each line starting with the prefix __label__. The format is as follows:", "For this article we will use Kaggle\u2019s SMS Spam Detection Dataset to build a spam/not-spam classifier with Flair. The dataset is suitable for learning as it only contains 5572 lines and it is small enough to train a model in a few minutes on a CPU.", "We first download the dataset from this link on Kaggle to obtain spam.csv. Then, in the same directory as our dataset, we run our preprocessing snippet below which will do some preprocessing and split our dataset into train, dev and test sets.", "Make sure you have Pandas installed. If not, run pip install pandas first.", "This will remove some duplicates from our dataset, shuffle it (randomise rows) and split the data into train, dev and test sets using the 80/10/10 split.", "If this runs successfully you will end up with train.csv,test.csv and dev.csv formatted in the FastText format ready to be used with Flair.", "To train the model run this snippet in the same directory as the generated dataset.", "When running this code for the first time, Flair will download all required embedding models which can take up to a few minutes. The whole training process will then take another 5 minutes.", "This snippet first loads the required libraries and datasets into a corpus object.", "Next, we create a list of the embeddings (two Flair contextual sting embeddings and a GloVe word embedding). This list is then used as an input for our document embedding object. Stacked and document embedding are one of the most interesting concepts of Flair. They provide means to combine different embeddings together. You can use both traditional word embeddings (like GloVe, word2vec, ELMo) together with Flair contextual sting embeddings. In the example above we use an LSTM based method of combining word and contextual sting embeddings for generating document embeddings. You can read more about it here.", "Finally, the snippet trains the model which produces final-model.pt and best-model.pt files which represent our stored trained model.", "We can now use the exported model to generate predictions by running the following snippet from the same directory:", "The snippet prints out \u2018[ham (1.0)]\u2019 meaning that the model is 100% sure our example message is not spam.", "Unlike Facebook\u2019s FastText or even Google\u2019s AutoML Natural Language platform, doing text classification with Flair is still a relatively low-level task. We have full control of how text embedding and training is done by having an option to set parameters such as learning rate, batch size, anneal factor, loss function, optimiser selection\u2026 In order to achieve optimal performance these hyper parameters need to be tuned. Flair provides us with a wrapper of a well known hyper parameter tuning library Hyperopt (described here) which we can use to tune our hyper parameters for optimal performance.", "In this article, we used the default hyper parameters for the sake of simplicity. With mostly default parameters our Flair model achieved an f1-score of 0.973 after 10 epochs.", "For comparison, we trained a text classification model with FastText and on AutoML Natural Language platform. We first ran FastText with the default parameters and achieved an f1-score of 0.883, meaning that our model outperformed the FastText by a large margin. FastText, however, only needed a few seconds to train as opposed to 5 minutes for our custom Flair model.", "Then we also compared our results to the ones obtained on Google\u2019s AutoML Natural Language platform. The platform first needed 20 minutes to just parse the dataset. After that we started the training process which took almost 3 hours to finish (costing almost $10 of free credits), but achieved an f1-score of 99.211 - a slightly better result than our custom Flair model.", "This article should give you a rough understanding of how to use Flair for text classification.", "In the next publication we explain how to tune Flair\u2019s hyper parameters to achieve optimal performance and beat Google\u2019s AutoML in text classification.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb541d7add21f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b541d7add21f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b541d7add21f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tadejmagajna?source=post_page-----b541d7add21f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tadejmagajna?source=post_page-----b541d7add21f--------------------------------", "anchor_text": "Tadej Magajna"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43246c2d9cb0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&user=Tadej+Magajna&userId=43246c2d9cb0&source=post_page-43246c2d9cb0----b541d7add21f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb541d7add21f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb541d7add21f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://alanakbik.github.io/papers/coling2018.pdf", "anchor_text": "Contextual String Embeddings for Sequence Labelling"}, {"url": "https://realpython.com/installing-python/", "anchor_text": "here"}, {"url": "https://fasttext.cc/docs/en/supervised-tutorial.html", "anchor_text": "FastText format"}, {"url": "https://www.kaggle.com/uciml/sms-spam-collection-dataset", "anchor_text": "this link on Kaggle"}, {"url": "https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_5_DOCUMENT_EMBEDDINGS.md", "anchor_text": "here"}, {"url": "https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_8_MODEL_OPTIMIZATION.md", "anchor_text": "described here"}, {"url": "https://towardsdatascience.com/how-to-beat-automl-hyperparameter-optimisation-with-flair-3b2f5092d9f5", "anchor_text": "In the next publication"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b541d7add21f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----b541d7add21f---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b541d7add21f---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----b541d7add21f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----b541d7add21f---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb541d7add21f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&user=Tadej+Magajna&userId=43246c2d9cb0&source=-----b541d7add21f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb541d7add21f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&user=Tadej+Magajna&userId=43246c2d9cb0&source=-----b541d7add21f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb541d7add21f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b541d7add21f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb541d7add21f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b541d7add21f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b541d7add21f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b541d7add21f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b541d7add21f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b541d7add21f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b541d7add21f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b541d7add21f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b541d7add21f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b541d7add21f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tadejmagajna?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tadejmagajna?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tadej Magajna"}, {"url": "https://medium.com/@tadejmagajna/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "710 Followers"}, {"url": "https://www.linkedin.com/in/tadej-magajna/", "anchor_text": "https://www.linkedin.com/in/tadej-magajna/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F43246c2d9cb0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&user=Tadej+Magajna&userId=43246c2d9cb0&source=post_page-43246c2d9cb0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd9d767fc72fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f&newsletterV3=43246c2d9cb0&newsletterV3Id=d9d767fc72fb&user=Tadej+Magajna&userId=43246c2d9cb0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}