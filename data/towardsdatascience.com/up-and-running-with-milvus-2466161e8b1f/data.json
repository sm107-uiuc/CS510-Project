{"url": "https://towardsdatascience.com/up-and-running-with-milvus-2466161e8b1f", "time": 1683009037.402787, "path": "towardsdatascience.com/up-and-running-with-milvus-2466161e8b1f/", "webpage": {"metadata": {"title": "Up and running with Milvus. A Vector Similarity Search Engine\u2026 | by David Shvimer | Towards Data Science", "h1": "Up and running with Milvus", "description": "For those who don\u2019t yet know, there are many use cases for a technology like this. With the help of machine learning, we can search images, video, and audio. Say we train a CNN that classifies\u2026"}, "outgoing_paragraph_urls": [{"url": "https://milvus.io/", "anchor_text": "website", "paragraph_index": 0}, {"url": "https://milvus.io/scenarios", "anchor_text": "use cases", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "CNN", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Content-based_image_retrieval", "anchor_text": "Content Based Image Retrieval", "paragraph_index": 2}, {"url": "https://github.com/dshvimer/milvus-up-and-running/tree/master/notebook/images", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://raw.githubusercontent.com/milvus-io/milvus/v0.9.1/core/conf/demo/server_config.yaml", "anchor_text": "config file", "paragraph_index": 8}, {"url": "https://www.linkedin.com/in/dshvimer", "anchor_text": "https://www.linkedin.com/in/dshvimer", "paragraph_index": 25}], "all_paragraphs": ["A vector similarity search engine that seems to be production ready. According to the website:", "For those who don\u2019t yet know, there are many use cases for a technology like this. With the help of machine learning, we can search images, video, and audio.", "Say we train a CNN that classifies images. If we take a look at the output of any layer before the final output, we may find N-dimensional feature vectors that are describing the input. As we move through the network the features become more specific. In the beginning we can identify textures, shapes, etc. Towards the end we identify objects like cat ears and dog tails. We can take the output of any of these layers, flatten it by some method, and index it in a search engine! Voila! The layer chosen will have an effect on what is considered \u201csimilar\u201d. This will vary by use case. This example is an application of Content Based Image Retrieval (CBIR).", "A very simple implementation of CBIR using Milvus, in a Dockerized environment. Here is the complete repo and a list of the technologies we will be using. If you want to download the repo and just mess around, it\u2019s ready to go.", "In a new directory, let\u2019s create some more empty directories.", "In the top level directory, create a file named docker-compose.yml with the following contents:", "We have defined two docker containers, one for Milvus, and another for our jupyter notebook. The Milvus container is visible to the notebook via the links attribute. The volumes we declared are so that the Milvus file system shares some folders with our operating system. This lets us configure and monitor Milvus with ease. Since we gave the notebook container a context to build from, we need to create a file named Dockerfile in the notebook directory with the following contents:", "Not the prettiest way to declare dependencies, but that can be optimized later. We should also download some images to play with. Feel free to download the ones I used here: Place them into notebook/images.", "Last step, download the starter Milvus config file and place it into milvus/conf/. Now as long as Docker is installed and running, we rundocker-compose up and we are live!", "If you see the following lines in the console output:", "It means Docker is not configured with enough memory to run Milvus. If we open the config file and search for \u201ccpu_cache_capacity\u201d we see some helpful documentation. \u201cThe sum of \u2018insert_buffer_size\u2019 and \u2018cpu_cache_capacity\u2019 must be less than system memory size.\u201d", "Set both values to 1, and then open Docker\u2019s settings and make sure that it is configured to any value greater than 2GB (MUST BE GREATER THAN). Make sure to apply the settings and restart Docker. Then try docker-compose up again. If something else isn\u2019t working, please let me know in the comments.", "The fun stuff, here we go. Once everything is running, we should have a URL to access our jupyter instance. Let\u2019s create a new notebook and get to coding. One cell at a time.", "Now lets define a helper class to extract the feature vectors:", "Why did I pick ResNet18? Because it has a layer that outputs a flat vector with length 512. Convenient and easy is reasonable when learning something new. There is quite a bit of room to extend this class. We could extract features from multiple layers at once, and input multiple images at once. For the time being, this is good enough.", "Now we can load our images and start looking at similarity:", "In the first example, the puppy and adult golden retriever images get a similarity score ~0.79. When we compare a puppy golden retriever and a pug we get a similarity score ~0.58.", "Let\u2019s do what we came here to do. We start by connecting to Milvus, and creating a collection", "Now we can insert the feature vectors from our images. We need to convert the vectors into python lists:", "If this was successful, we should see a list of ID\u2019s that Milvus uses to identify the images. They are in the same order as our list of images, so lets create a quick lookup table to easily access an image, given some ID:", "We can flush the new items onto the disk and get some info for the collection:", "If we see a list of results that means all is well. We can visualize them with the following snippet", "It was pretty easy to get up and running. Most of the Milvus related code here was from the getting started example available on the website. One of our vectors is about 1KB in size, so we could fit one million feature vectors into 1GB of memory. We didn\u2019t use an index here, which would increase that cost, but it\u2019s still quite an efficient way to index an image. The website docs are great, but I think reading through the config file is a great way to understand what this thing is capable of. We kept it very simple in this post, but here are some ideas for those who want to take it further:", "This was my first post ever. So if you liked it let me know. If something didn\u2019t work or the formatting was off, also let me know! Stay classy out there.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I like to tinker with computers https://www.linkedin.com/in/dshvimer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2466161e8b1f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dshvimer?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshvimer?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": "David Shvimer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0e3a9fe425b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&user=David+Shvimer&userId=e0e3a9fe425b&source=post_page-e0e3a9fe425b----2466161e8b1f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2466161e8b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2466161e8b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@markuswinkler?utm_source=medium&utm_medium=referral", "anchor_text": "Markus Winkler"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://milvus.io/", "anchor_text": "website"}, {"url": "https://milvus.io/scenarios", "anchor_text": "use cases"}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53", "anchor_text": "CNN"}, {"url": "https://en.wikipedia.org/wiki/Content-based_image_retrieval", "anchor_text": "Content Based Image Retrieval"}, {"url": "https://github.com/dshvimer/milvus-up-and-running", "anchor_text": "dshvimer/milvus-up-and-runningContribute to dshvimer/milvus-up-and-running development by creating an account on GitHub.github.com"}, {"url": "https://github.com/dshvimer/milvus-up-and-running/tree/master/notebook/images", "anchor_text": "here"}, {"url": "https://raw.githubusercontent.com/milvus-io/milvus/v0.9.1/core/conf/demo/server_config.yaml", "anchor_text": "config file"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2466161e8b1f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/search?source=post_page-----2466161e8b1f---------------search-----------------", "anchor_text": "Search"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----2466161e8b1f---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/devops?source=post_page-----2466161e8b1f---------------devops-----------------", "anchor_text": "DevOps"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2466161e8b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&user=David+Shvimer&userId=e0e3a9fe425b&source=-----2466161e8b1f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2466161e8b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&user=David+Shvimer&userId=e0e3a9fe425b&source=-----2466161e8b1f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2466161e8b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2466161e8b1f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2466161e8b1f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2466161e8b1f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2466161e8b1f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2466161e8b1f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2466161e8b1f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshvimer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshvimer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "David Shvimer"}, {"url": "https://medium.com/@dshvimer/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "18 Followers"}, {"url": "https://www.linkedin.com/in/dshvimer", "anchor_text": "https://www.linkedin.com/in/dshvimer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0e3a9fe425b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&user=David+Shvimer&userId=e0e3a9fe425b&source=post_page-e0e3a9fe425b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe16abd190405&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fup-and-running-with-milvus-2466161e8b1f&newsletterV3=e0e3a9fe425b&newsletterV3Id=e16abd190405&user=David+Shvimer&userId=e0e3a9fe425b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}