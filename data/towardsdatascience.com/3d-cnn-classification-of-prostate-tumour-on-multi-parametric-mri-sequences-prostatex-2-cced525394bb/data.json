{"url": "https://towardsdatascience.com/3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb", "time": 1682995948.8347762, "path": "towardsdatascience.com/3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb/", "webpage": {"metadata": {"title": "3D CNN Classification of Prostate Cancer on PROSTATEx-2 | by Hugegene | Towards Data Science", "h1": "3D CNN Classification of Prostate Cancer on PROSTATEx-2", "description": "Used 3D CNN on multi-parametric MRI to classfiy prostate cancer. Includes conversion of DICOM to NIFTI, Co-Registration, and 3D CNN."}, "outgoing_paragraph_urls": [{"url": "https://wiki.cancerimagingarchive.net/display/Public/SPIE-AAPM-NCI+PROSTATEx+Challenges#b07aa11d8dd248838322e5d1b67e0909", "anchor_text": "PROSTATEx-2 \u2014 SPIE-AAPM-NCI Prostate MR Gleason Grade Group Challenge", "paragraph_index": 1}, {"url": "https://www.nitrc.org/projects/mricrogl/", "anchor_text": "https://www.nitrc.org/projects/mricrogl/", "paragraph_index": 4}, {"url": "https://github.com/icometrix/dicom2nifti", "anchor_text": "dicom2nifti", "paragraph_index": 5}], "all_paragraphs": ["This article describes using 3D CNN on multi-parametric MRI sequences to perform classification of prostate cancer to be significant or not significant. The contents are as follows:", "The dataset used is taken from PROSTATEx-2 \u2014 SPIE-AAPM-NCI Prostate MR Gleason Grade Group Challenge. The dataset consists of 162 patients, 99 patients as train cases and 63 patients as test cases. An MRI sequence consists of a series of 2D scans that depicts a body part in 3D. Each patient has five modes of MRI sequences:", "As the T2 transverse, ADC, DWI, KTrans are all transverse views of the prostate, they were used together to classify the prostate lesion. The T2 sagittal sequence, which is the side view of the prostate, was not used.", "Each patient may have more than 1 lesion findings in his or her MRI sequences. In the accompanying CSV file, each lesion finding is labelled:", "T2 , ADC, DWI sequences come in Dicom file format and KTrans comes in MHD file format. All Dicom files and MHD files were first converted to NIFTI files using MRIcoGL( https://www.nitrc.org/projects/mricrogl/) that uses dcm2niix to convert DICOM to NIFTI.", "Tips: Open MRIconGL.exe=>Import=>Convert Dicom to NIFITI, dump the root folder of the dataset into the white window space and wait for the conversion to be completed which will take a while. Then organise your Nii files using python scripts(not the best way). Alternatively, you can try dicom2nifti python package to do the conversion with python scripts.", "As the different transverse MRI modes have are on different scales and different positions, a co-registration step was needed to align the different modes. Affine Transformation was used to align the ADC sequence, DWI sequence and Ktrans sequence to the T2 sequence. The four modes were then stacked on top of each other as a NumPy array. The stacked NumPy array is analogous to a three-channel image file where the Red, Blue, and Green channels correspond to the T2, ADC, DWI. However, there is an additional fourth channel which is the Ktrans.", "As each lesion has x,y,z coordinates labels in the sequence, the lesion centre can be identified and are circled in blue. Each legion case will have 30mm by 30mm real-world length cropped with the lesion as the centre. As the resolution of the T2 sequence is not the same for all patients, each pixel of the image represents different millimetres in the real-world length. The number of pixels to be cropped will be given by the formula: 30/pixel_spacing where pixel_spacingis the millimetres that each pixel represents given in the accompanying CSV file. After cropping the required number of pixels at the lesion centres, all cropped images are resized to 60X60 resolution which is the most common resolution after cropping.", "In addition, only the 2 slices below and above the lesion centre z coordinate will be kept. Hence, the cropping and resizing will result in a 5X60X60X4 resolution cube fed to the 3D CNN model. The last channel 4 corresponds the stacked channels on each pixel(T2, ADC, DWI, Ktrans). Cropping to a smaller cubic size will have a more focused region of interest that will help the model to classify better.", "The labels given are the GGG (1\u20135) of each lesion findings. The lesion findings can be further grouped to be of no clinical significance when the GGG is 1 and of clinical significance when the GGG is greater than 1. This can be seen when comparing these findings of PRSTATEx2 to the findings of PROSTATEx as they share the same cases. Each lesion case is then re-labelled to True or False depending on whether they are of clinical significance based on the GGG findings. With binary labels, the task ahead is binary classifications on whether the lesion is of clinical significance.", "The dataset consists of 99 patients\u2019 MRI sequences, but each patient may have more than 1 lesion finding in his or her MRI sequences. A total of 112 findings was present and extracted as described in the pre-processing steps. The 112 findings were split into 78 findings for training and 34 findings for validation.", "The proposed architecture is as shown. The input shape is Batch_SizeX5X60X60X4. The input is put through a series of 1x3x3 and 3x3x3 kernels, followed by a Maxpool3D layer and another series of 1x3x3 kernels to expand the feature spaces. The expanded feature spaces are then flattened, put through 64 dense nodes and finally 2 dense nodes with SoftMax activation. Cross-entropy was used for the loss function with the SoftMax outputs.", "The Confusion Matrix and metric scores on the validation set are as follows:", "The true positives, false negatives, true negatives and false positives are printed on the left. The results show that while it is hard to tell from each mode alone whether the lesion should be positive or negative, the stacked mode shows more white than grey when it is supposed to be positive (true positives and false negatives) and show more grey than white when it is supposed to be negative. This may be a telling sign that multi-parametric MRI may be better than a single mode of MRI scan to classify prostate cancer.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcced525394bb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cced525394bb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cced525394bb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://eugene-chian.medium.com/?source=post_page-----cced525394bb--------------------------------", "anchor_text": ""}, {"url": "https://eugene-chian.medium.com/?source=post_page-----cced525394bb--------------------------------", "anchor_text": "Hugegene"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2f6311f540e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&user=Hugegene&userId=2f6311f540e9&source=post_page-2f6311f540e9----cced525394bb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcced525394bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcced525394bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://wiki.cancerimagingarchive.net/display/Public/SPIE-AAPM-NCI+PROSTATEx+Challenges#b07aa11d8dd248838322e5d1b67e0909", "anchor_text": "PROSTATEx-2 \u2014 SPIE-AAPM-NCI Prostate MR Gleason Grade Group Challenge"}, {"url": "https://www.nitrc.org/projects/mricrogl/", "anchor_text": "https://www.nitrc.org/projects/mricrogl/"}, {"url": "https://github.com/icometrix/dicom2nifti", "anchor_text": "dicom2nifti"}, {"url": "https://medium.com/tag/prostate-cancer?source=post_page-----cced525394bb---------------prostate_cancer-----------------", "anchor_text": "Prostate Cancer"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----cced525394bb---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----cced525394bb---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/mri?source=post_page-----cced525394bb---------------mri-----------------", "anchor_text": "Mri"}, {"url": "https://medium.com/tag/t2?source=post_page-----cced525394bb---------------t2-----------------", "anchor_text": "T2"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcced525394bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&user=Hugegene&userId=2f6311f540e9&source=-----cced525394bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcced525394bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&user=Hugegene&userId=2f6311f540e9&source=-----cced525394bb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcced525394bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cced525394bb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcced525394bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cced525394bb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cced525394bb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cced525394bb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cced525394bb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cced525394bb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cced525394bb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cced525394bb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cced525394bb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cced525394bb--------------------------------", "anchor_text": ""}, {"url": "https://eugene-chian.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://eugene-chian.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hugegene"}, {"url": "https://eugene-chian.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "119 Followers"}, {"url": "https://www.linkedin.com/in/eugene-c-616768142/", "anchor_text": "https://www.linkedin.com/in/eugene-c-616768142/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2f6311f540e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&user=Hugegene&userId=2f6311f540e9&source=post_page-2f6311f540e9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcb798ef7a5f1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F3d-cnn-classification-of-prostate-tumour-on-multi-parametric-mri-sequences-prostatex-2-cced525394bb&newsletterV3=2f6311f540e9&newsletterV3Id=cb798ef7a5f1&user=Hugegene&userId=2f6311f540e9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}