{"url": "https://towardsdatascience.com/deep-learning-on-ancient-dna-df042dc3c73d", "time": 1682995988.849704, "path": "towardsdatascience.com/deep-learning-on-ancient-dna-df042dc3c73d/", "webpage": {"metadata": {"title": "Deep Learning on Ancient DNA. Reconstructing the Human Past with Deep\u2026 | by Nikolay Oskolkov | Towards Data Science", "h1": "Deep Learning on Ancient DNA", "description": "Ancient DNA is fascinating! With the current advances in Next Generation Sequencing (NGS) we can extract DNA from ancient bones, sequence it and understand a lot about the past through various types\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/DNA_sequencing", "anchor_text": "Next Generation Sequencing (NGS)", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Population_genetics", "anchor_text": "Population Genetics", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Svante_P%C3%A4%C3%A4bo", "anchor_text": "Svante P\u00e4\u00e4bo", "paragraph_index": 1}, {"url": "https://www.nytimes.com/1985/04/16/science/intact-genetic-material-extracted-from-an-ancient-egyptian-mummy.html", "anchor_text": "famous work", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Deamination", "anchor_text": "deamination", "paragraph_index": 1}, {"url": "https://ginolhac.github.io/mapDamage/", "anchor_text": "mapDamage tool", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Natural_language_processing", "anchor_text": "Natural Language Processing", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "Time Series", "paragraph_index": 3}, {"url": "http://msb.embopress.org/content/12/7/878", "anchor_text": "Argenmueller et al., Molecular Systems Biology (2016) 12, 878", "paragraph_index": 3}, {"url": "https://www.nature.com/articles/s41588-018-0295-5", "anchor_text": "Zou et al. Nature Genetics 51, pages12\u201318 (2019)", "paragraph_index": 3}, {"url": "http://genome.ucsc.edu/Neandertal/", "anchor_text": "draft Neanderthal genome", "paragraph_index": 5}, {"url": "https://www.nature.com/articles/s41588-018-0295-5", "anchor_text": "Zou et al. Nature Genetics 51, pages12\u201318 (2019)", "paragraph_index": 8}, {"url": "https://medium.com/@sidereal/cnns-architectures-lenet-alexnet-vgg-googlenet-resnet-and-more-666091488df5", "anchor_text": "VGG-like architecture", "paragraph_index": 10}, {"url": "https://www.nature.com/articles/s41586-018-0097-z", "anchor_text": "ancient viruses", "paragraph_index": 15}, {"url": "https://github.com/NikolayOskolkov/DeepLearningAncientDNA", "anchor_text": "Jupyter notebook", "paragraph_index": 16}], "all_paragraphs": ["Ancient DNA is fascinating! With the current advances in Next Generation Sequencing (NGS) we can extract DNA from ancient bones, sequence it and understand a lot about the past through various types of statistical and Population Genetics analyses.", "However, modern contamination is a big issue in Ancient DNA research area. Svante P\u00e4\u00e4bo, the founder of paleogenetics, admitted to have sequenced mostly modern DNA (presumably his own) in his famous work about DNA from a Egyptian mummy that gave rise to the field. Indeed, by just looking at modern and ancient sequences you would never guess which one came from the past. Therefore researchers in this area use advanced statistical analysis such as deamination pattern inference, where mapDamage tool is very handy. However, the problem with deamination analysis is that it is based on averaging across thousands and millions of aligned sequences, therefore it is only feasible if you have a deeply sequenced (a lot of ancient DNA needed) sample and a reference genome to get the sequences aligned to the genome which is not always available.", "This is exactly where we can utilize the power of Machine and Deep Learning for detecting DNA motifs typical for ancient and modern sequences.", "Since DNA sequence is essentially a \u201cbiological text\u201d, it can be analyzed using approaches from Natural Language Processing or Time Series data analysis. Artificial Neural Networks (ANNs) are widely used in both areas and show state-of-the-art performance for Genomics as well. For example, Convolutional Neural Networks (CNNs) are working horses for functional Genomics, see e.g. an excellent review of Argenmueller et al., Molecular Systems Biology (2016) 12, 878, where they detect with high accuracy transcription factor binding sites and splicing sites. For practical implementation of CNNs for Genomics I recommend the fantastic \u201cA Primer on Deep Learning in Genomics\u201d from Zou et al. Nature Genetics 51, pages12\u201318 (2019). The figure below from the paper describes a typical Deep Learning workflow in Genomics.", "Here I show how to build a Convolutional Neural Network (CNN) based classifier for a per-sequence prediction of ancient status of a DNA sequence without mapping to a reference genome. But let us start with looking at Ancient DNA sequences.", "For demonstration purposes I will be using the draft Neanderthal genome which is a low-coverage sequencing effort back in 2010. The file is an alignment (bam-file) of the DNA sequences to a Human Genome hg18, but it does not have to be an alignment, we could equally well use the raw sequences (fastq-file). We can read the sequences in Python using handy pysam module and plot the distribution of lengths of the sequences.", "It is obvious that there is a wide spread of DNA sequence lengths from approximately 20 nucleotides (nt) to 140 nt long sequences (reads in bioinformatics jargon). This is a known fact which tells us that the Ancient DNA is degraded, i.e. it is broken with time into small segments. Therefore the length of a sequence can be very informative for inferring whether it is ancient or not, the shorter the higher is the likelihood that it is ancient. However, in this analysis I am specifically interested in ancient DNA motifs no matter what length of the sequence is. Therefore I will perform the analysis on equally long modern and ancient sequences and leave the sequence length information as a pleasant bonus which everyone can use in addition to the ancient pattern information. Since I am going to use the modern French DNA sample which in 2010 was sequenced with read length equal to 76 nt, I will select only 76 nt long Neanderthal sequences and then an equal amount of modern sequences for training my CNN.", "In total we got almost half a million reads, 50% of the m are ancient. For simplicity I selected only reads from first 10 chromosomes. This amount of data is truly big, compare with ~60 000 examples from canonical MNIST and CIFAR10 Machine Learning data sets widely used for practicing image recognition with CNNs.", "Next we are going to perform standard for all one dimensional CNNs steps such as one-hot encoding of the sequences and splitting the data into training and testing sub-sets. Here I will follow the protocol from Zou et al. Nature Genetics 51, pages12\u201318 (2019):", "Now everything is ready for running CNN, let us do it!", "Finally, it is time to start training a simple binary (ancient vs. non-ancient) 1D CNN classifier. I will crate a simple one-block VGG-like architecture with two Convolutional layers followed by one Max Pooling layer. I will also apply small L1 norm weight regularization to prevent overfitting.", "The training was performed on ~300 000 ancient and modern sequences took approximately 5 hours on my laptop with 4 cores. Let us check how the loss and accuracy curves behave:", "The model is clearly overfitting but still reaches impressive 84% of accuracy on the validation data set (~100 000 sequences). The oscillating behavior of the validation curves is typical for L1 norm regularization. To make it more stable, Dropout is more preferable, we can also increase the batch size or reduce the learning rate. Let us now perform the final evaluation of the model on the hold out test data set with approximately 133 000 sequences:", "The final evaluation of the model shows again 84% of accuracy of prediction of the ancient status. The confusion matrix confirms this number. What about interpretation of the CNN? Saliency maps is an elegant method to demonstrate feature importances of the CNN, i.e. which nucleotides are most informative for the prediction of ancient status for each sequence:", "We clearly see that the ancient vs. non-ancient signal seems to come from the ends of the sequences. This makes a lot of sense as it is known that the ends of the ancient sequences are exposed to deamination and thus degradation which leads to increased frequency of C/T and G/A polymorphisms at the ends of the reads compared to the null-hypothesis of uniformly distributed frequency of all other substitutions. This is what mapDamage captures. However, in contrast to mapDamage, we were able to detect this hidden deamination pattern without comparing the ancient sequences to the reference genome. Moreover we now have a model which predicts \u201cancient or non-ancient\u201d for each read while mapDamage uses statistical inference via averaging across thousands of reads.", "Usually, it is very difficult to extract a lot of Ancient DNA, so every read matters. In other words, we can not afford calculating statistics across a number of reads but we want an ancient status for each and every valuable read. In addition, analysis of ancient microbiome (reads originating from ancient microbes rather than the human/animal host) often comes up with ancient viruses which typically have a dozen of reads aligned to the very short viral genome. In this case it is extremely hard to perform deamination analysis with mapDamage due to the lack of statistical power.", "Here I demonstrate the importance of Deep Learning for Ancient DNA research area. I showed how to create a simple Convolutional Neural Network (CNN) classifier of ancient vs. non-ancient status of each DNA sequence without reference genome. I hope you will find this post useful and get inspired to develop Deep Learning for exciting Ancient DNA research area. Follow me in twitter @NikolayOskolkov and check out the complete Jupyter notebook on my github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf042dc3c73d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nikolay-oskolkov.medium.com/?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8570b484f56c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&user=Nikolay+Oskolkov&userId=8570b484f56c&source=post_page-8570b484f56c----df042dc3c73d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf042dc3c73d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf042dc3c73d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/dl-for-life-sciences", "anchor_text": "Deep Learning for Life Sciences"}, {"url": "https://www.welt.de/wissenschaft/article120803982/Jaeger-Sammler-und-Bauern-lebten-lange-zusammen.html#cs-Vorfahren-in-Europa-2.jpg", "anchor_text": "Image source"}, {"url": "https://en.wikipedia.org/wiki/DNA_sequencing", "anchor_text": "Next Generation Sequencing (NGS)"}, {"url": "https://en.wikipedia.org/wiki/Population_genetics", "anchor_text": "Population Genetics"}, {"url": "https://en.wikipedia.org/wiki/Svante_P%C3%A4%C3%A4bo", "anchor_text": "Svante P\u00e4\u00e4bo"}, {"url": "https://www.nytimes.com/1985/04/16/science/intact-genetic-material-extracted-from-an-ancient-egyptian-mummy.html", "anchor_text": "famous work"}, {"url": "https://en.wikipedia.org/wiki/Deamination", "anchor_text": "deamination"}, {"url": "https://ginolhac.github.io/mapDamage/", "anchor_text": "mapDamage tool"}, {"url": "https://en.wikipedia.org/wiki/Natural_language_processing", "anchor_text": "Natural Language Processing"}, {"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "Time Series"}, {"url": "http://msb.embopress.org/content/12/7/878", "anchor_text": "Argenmueller et al., Molecular Systems Biology (2016) 12, 878"}, {"url": "https://www.nature.com/articles/s41588-018-0295-5", "anchor_text": "Zou et al. Nature Genetics 51, pages12\u201318 (2019)"}, {"url": "http://genome.ucsc.edu/Neandertal/", "anchor_text": "draft Neanderthal genome"}, {"url": "https://www.nature.com/articles/s41588-018-0295-5", "anchor_text": "Zou et al. Nature Genetics 51, pages12\u201318 (2019)"}, {"url": "https://medium.com/@sidereal/cnns-architectures-lenet-alexnet-vgg-googlenet-resnet-and-more-666091488df5", "anchor_text": "VGG-like architecture"}, {"url": "https://www.nature.com/articles/s41586-018-0097-z", "anchor_text": "ancient viruses"}, {"url": "https://github.com/NikolayOskolkov/DeepLearningAncientDNA", "anchor_text": "Jupyter notebook"}, {"url": "https://medium.com/tag/ancient-dna?source=post_page-----df042dc3c73d---------------ancient_dna-----------------", "anchor_text": "Ancient Dna"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----df042dc3c73d---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----df042dc3c73d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----df042dc3c73d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/dl-for-life-sciences?source=post_page-----df042dc3c73d---------------dl_for_life_sciences-----------------", "anchor_text": "Dl For Life Sciences"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf042dc3c73d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&user=Nikolay+Oskolkov&userId=8570b484f56c&source=-----df042dc3c73d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf042dc3c73d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&user=Nikolay+Oskolkov&userId=8570b484f56c&source=-----df042dc3c73d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf042dc3c73d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdf042dc3c73d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----df042dc3c73d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----df042dc3c73d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df042dc3c73d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----df042dc3c73d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----df042dc3c73d--------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "https://nikolay-oskolkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8570b484f56c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&user=Nikolay+Oskolkov&userId=8570b484f56c&source=post_page-8570b484f56c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff4a74ad409c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-on-ancient-dna-df042dc3c73d&newsletterV3=8570b484f56c&newsletterV3Id=f4a74ad409c6&user=Nikolay+Oskolkov&userId=8570b484f56c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}