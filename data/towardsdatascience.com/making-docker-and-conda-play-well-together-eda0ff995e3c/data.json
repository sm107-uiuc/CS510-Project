{"url": "https://towardsdatascience.com/making-docker-and-conda-play-well-together-eda0ff995e3c", "time": 1683018234.064699, "path": "towardsdatascience.com/making-docker-and-conda-play-well-together-eda0ff995e3c/", "webpage": {"metadata": {"title": "Making Docker, Conda and Jupyter play well together | by Borun Chowdhury Ph.D. | Towards Data Science", "h1": "Making Docker, Conda and Jupyter play well together", "description": "A no frills article explaining how to make multi kernel jupyter work inside a single docker container... and why...."}, "outgoing_paragraph_urls": [{"url": "https://github.com/pytorch/pytorch/issues/30966", "anchor_text": "installing tensorflow 2.x breaks tensorboard for pytorch and the \u201csolution\u201d seems to be to not install tensorflow in the same environment as pytorch", "paragraph_index": 5}, {"url": "https://github.com/borundev/machine_learning_docker", "anchor_text": "my repository", "paragraph_index": 9}, {"url": "https://github.com/borundev/jupyter_ml_docker", "anchor_text": "here", "paragraph_index": 9}, {"url": "https://github.com/borundev/machine_learning_docker/tree/master/multiple_conda_environments", "anchor_text": "toy example here that just helps explain this particular point", "paragraph_index": 9}, {"url": "https://github.com/borundev/machine_learning_docker", "anchor_text": "github repository", "paragraph_index": 18}], "all_paragraphs": ["Docker and Docker-Compose are great utilities that support the microservice paradigm by allowing efficient containerization. Within the python ecosystem the package manager Conda also allows some kind of containerization that is limited to python packages. Conda environments are especially handy for data scientists working in jupyter notebooks that have different (and mutually exclusive) package dependencies.", "However, due to the peculiar way in which conda environments are setup, getting them working out of the box in Docker, as it were, is not so straightforward. Furthermore, adding kernelspecs for these environments to jupyter is another very useful but complicated step. This article will clearly and concisely explain how to setup Dockerized containers with Jupyter having multiple kernels.", "To gain from this article you should already know the basics of Docker, Conda and Jupyter. If you don\u2019t and would like to there are excellent tutorials on all three on their websites.", "I like Docker in the context of data science and machine learning research as it is very easy for me to containerize my whole research setup and move it to the various cloud services that I use (my laptop, my desktop, GCP, a barebones cloud we maintain and AWS).", "Requiring multiple conda environments and associated jupyter kernels is something one often needs in Data Science and Machine Learning. For instance when dealing with Python 2 and Python 3 code or when transitioning from Tensorflow 1 to Tensorflow 2.", "One such issue came up recently for me. I work with TensorFlow and PyTorch both for deeplearning and till now I had them both installed in the same conda environment in my docker image. However, turns out that installing tensorflow 2.x breaks tensorboard for pytorch and the \u201csolution\u201d seems to be to not install tensorflow in the same environment as pytorch.", "To reproduce it just try running the tutorial notebook mentioned in the image above after installing tensorflow 2.", "So, in this case the solution is either of the following", "The second one seems more elegant. Nevertheless, the standard way of creating a conda environment and activating it requires an interactive sessions and that is not possible when building a docker image.", "In this article I quickly describe what needs to be done using a simple example and the actual code can be found in my repository. In fact my repository has the actual code that can be used to run the jupyter notebook mentioned above here but that has a lot of other steps that can distract away from the main topic of this article which is how to make Docker and Conda play well together. So I have also made another toy example here that just helps explain this particular point.", "The docker file contains the following main steps:", "Finally I find it very useful to put all my microservices behind the reverse proxy traefik. This has the additional advantage of being able to turn on SSL on all services without individual configuration. In this toy example there is only one microservice but when we have many it is useful to turn them on with prefixes and here is why I used an entry point instead of command in the dockerfile above. I can now complete the command by asking jupyter to start the notebook server while listening on a different path where traefik will redirect the traffic", "Now the notebook can be accessed on https://myserver.com /multiple_conda_environment where you should replace myserver.com with your hostname.", "Now when you run try to create a new notebook you should see a choice between the standard python3 and two additional kernels", "If you go to the actual repository with the full code to run both tensorflow and pytorch you will find that I appropriated the python3 kernel to convert it into a tensorflow kernel and have changed its name to reflect that.", "This is a better solution if you do not care about the extra default kernel floating around that is not going to be used.", "Having your jupyter server run as a container is a must for every data scientist as it allows one to seamlessly move their lab, as it were, from one cloud to another.", "Being able to have multiple kernels in jupyter is likewise a must for every data scientist as well as it allows one to work on multiple projects with mutually exclusive package dependencies.", "Due to the way standard conda environments and their jupyter kernelspecs are installed, making the two play with each other is not straightforward. In this tutorial and the associated github repository I have explained how to make containerized jupyter installations that support multiple kernels.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Formless and shapeless pure consciousness masquerading as a machine learning researcher, a theoretical physicist and a quant."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feda0ff995e3c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://borundev.medium.com/?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": ""}, {"url": "https://borundev.medium.com/?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": "Borun Chowdhury Ph.D."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5932426de083&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&user=Borun+Chowdhury+Ph.D.&userId=5932426de083&source=post_page-5932426de083----eda0ff995e3c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feda0ff995e3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feda0ff995e3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/pytorch/pytorch/issues/30966", "anchor_text": "installing tensorflow 2.x breaks tensorboard for pytorch and the \u201csolution\u201d seems to be to not install tensorflow in the same environment as pytorch"}, {"url": "https://github.com/borundev/machine_learning_docker", "anchor_text": "my repository"}, {"url": "https://github.com/borundev/jupyter_ml_docker", "anchor_text": "here"}, {"url": "https://github.com/borundev/machine_learning_docker/tree/master/multiple_conda_environments", "anchor_text": "toy example here that just helps explain this particular point"}, {"url": "https://github.com/borundev/machine_learning_docker", "anchor_text": "github repository"}, {"url": "https://medium.com/tag/docker?source=post_page-----eda0ff995e3c---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/tag/docker-compose?source=post_page-----eda0ff995e3c---------------docker_compose-----------------", "anchor_text": "Docker Compose"}, {"url": "https://medium.com/tag/conda?source=post_page-----eda0ff995e3c---------------conda-----------------", "anchor_text": "Conda"}, {"url": "https://medium.com/tag/anaconda?source=post_page-----eda0ff995e3c---------------anaconda-----------------", "anchor_text": "Anaconda"}, {"url": "https://medium.com/tag/python?source=post_page-----eda0ff995e3c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feda0ff995e3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&user=Borun+Chowdhury+Ph.D.&userId=5932426de083&source=-----eda0ff995e3c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Feda0ff995e3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&user=Borun+Chowdhury+Ph.D.&userId=5932426de083&source=-----eda0ff995e3c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feda0ff995e3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Feda0ff995e3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----eda0ff995e3c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----eda0ff995e3c--------------------------------", "anchor_text": ""}, {"url": "https://borundev.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://borundev.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Borun Chowdhury Ph.D."}, {"url": "https://borundev.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "84 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5932426de083&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&user=Borun+Chowdhury+Ph.D.&userId=5932426de083&source=post_page-5932426de083--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe7dab1940968&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmaking-docker-and-conda-play-well-together-eda0ff995e3c&newsletterV3=5932426de083&newsletterV3Id=e7dab1940968&user=Borun+Chowdhury+Ph.D.&userId=5932426de083&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}