{"url": "https://towardsdatascience.com/got-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272", "time": 1683013259.937428, "path": "towardsdatascience.com/got-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272/", "webpage": {"metadata": {"title": "Got Writer\u2019s Block? It\u2019s GPT-2 to the Rescue! | by Robert A. Gonsalves | Towards Data Science", "h1": "Got Writer\u2019s Block? It\u2019s GPT-2 to the Rescue!", "description": "In this post, I\u2019ll show you how Artificial Intelligence (AI) and Machine Learning (ML) can be used to help you get a start on that novel you always wanted to write. I\u2019ll begin with a brief background\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/machineray-using-ai-to-create-abstract-art-39829438076a", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/tokenization-for-natural-language-processing-a179a891bad4", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://medium.com/inside-machine-learning/what-is-a-transformer-d07dd1fbec04", "anchor_text": "post", "paragraph_index": 7}, {"url": "http://jalammar.github.io/illustrated-gpt2/", "anchor_text": "here", "paragraph_index": 14}, {"url": "http://www.cs.cmu.edu/~dbamman/booksummaries.html#:~:text=This%20dataset%20contains%20plot%20summaries,author%2C%20title%2C%20and%20genre.", "anchor_text": "Book Summary Dataset", "paragraph_index": 16}, {"url": "https://github.com/robgon-art/PlotJam", "anchor_text": "GitHub", "paragraph_index": 35}, {"url": "https://creativecommons.org/licenses/by-nc-sa/4.0/", "anchor_text": "CC BY-NC-SA license", "paragraph_index": 35}, {"url": "https://robgon.medium.com/membership", "anchor_text": "become a member", "paragraph_index": 39}], "all_paragraphs": ["In this post, I\u2019ll show you how Artificial Intelligence (AI) and Machine Learning (ML) can be used to help you get a start on that novel you always wanted to write. I\u2019ll begin with a brief background on how computers process text using AI. Then I\u2019ll describe how I set up an ML model called GPT-2 to generate new plot summaries, and give instructions on how you can create some new story ideas for yourself.", "This is the second part of my series of articles on how AI can be used for creative endeavors. The first part is on how to use ML to create abstract art, available here.", "Natural Language Processing (NLP) is a field of Linguistics and Computer Science that studies how machines, with their computer languages like Java and Python, can communicate with humans, with their natural languages like English and Swahili. One of the first proponents of teaching computers to understand human language was Alan Turing. He wrote about it in 1950 [1].", "We may hope that machines will eventually compete with men in all purely intellectual fields. But which are the best ones to start with? Even this is a difficult decision. Many people think that a very abstract activity, like the playing of chess, would be best. It can also be maintained that it is best to provide the machine with the best sense organs that money can buy, and then teach it to understand and speak English. \u2014 Alan Turing, Mathematician and Computer Scientist", "One of the first steps in processing text is converting words to numbers. This process is called tokenization. One of the simplest ways to tokenize text is to simply assign unique words and punctuation marks a numerical value in the order they appear in the input sequence. For example, consider the first part of the opening line from \u201cTale of Two Cities\u201d.", "You can see that four of the words, \u201cwas\u201d, \u201cthe\u201d, \u201cof\u201d, and \u201ctimes\u201d, appear twice, and they get the same token value in both instances. In this scheme, capitalized words like \u201cIt\u201d get a different token than \u201cit\u201d in lower case. Also, punctuation marks, like the comma, get their own token. You can read about various tokenization schemes in Srinivas Chakravarthy\u2019s post here.", "Once the words are tokenized, they can be processed by machine learning systems for various tasks. For example, an ML model can be trained to translate text from one language to another. In the example below a transformer has been trained to translate from English to Spanish.", "The input English text is converted to tokens before being fed into the transformer. Inside the transformer, the tokens are encoded into an internal \u201cuniversal\u201d form, then decoded into Spanish tokens, which are converted to Spanish words. For more information about transformers, check out this post by Maxime Allard.", "In 2018, OpenAI created a system called the Generative Pretrained Transformer (GPT) [2]. They explained that large gains in NLP tasks \u2026", "\u2026 can be realized by generative pre-training of a language model on a diverse corpus of unlabeled text, followed by discriminative fine-tuning on each specific task. \u2014 Alec Radford and colleagues from OpenAI", "The team from OpenAI created an improved version of the transformer called GPT-2 in 2019 [3]. In this paper, they said \u2026", "\u2026 a language model with sufficient capacity will begin to learn to infer and perform the tasks demonstrated in natural language sequences in order to better predict them, regardless of their method of procurement. \u2014 Alec Radford and colleagues from OpenAI", "Below is a diagram that shows the major components of GPT-2. Instead of using tokens with single values, GPT-2 uses word embeddings which are arrays of multiple numbers to represent each word. This gives the system the capacity to capture a more complete understanding of the words.", "The GPT-2 model works in three phases:", "Note that the model draws on the input from all three phases when generating text. You can read more about how GPT-2 works in Jay Alammar\u2019s post here.", "PlotJam is a system I created to help creative writers discover new stories. Using a GPT-2 model that was fine-tuned with titles and plot summaries of over 16 thousand English books, PlotJam creates new stories with titles and brief plot summaries. Here is a diagram that shows the main components.", "The source of the fine-tuning text is the Book Summary Dataset from Carnegie Mellon University. I prepped the data by isolating just the genre, title, and the first part of the plot summary for each book.", "Here\u2019s an example of the original data for one of the books:", "Here\u2019s the Python code to preprocess the book summaries.", "Here\u2019s one of the entries from the CMU Book Summary Dataset after preprocessing.", "After the book summary text was preprocessed, I used it to fine-tune the GPT-2 model. I ran the fine-tuning for 10,000 steps, which seems to be enough for the system to generate new plot summaries. Here\u2019s the source code:", "After the model is fine-tuned, it can be used to create new plots by calling the generate function. I pass in a prompt \u201cGENRE:\u201d which will signal the system to create the titles and plots of a story with a random genre.", "Here is the output, showing a new plot synthesized by GPT-2:", "OK. Here it is. The first new story. It\u2019s in the mystery genre with the title \u201cDeadright\u2019 Corner\u201d. And it seems to be a crime story with a young police officer as the protagonist. Not bad.", "The GPT-2 system is designed to \u201cjust start writing\u201d in the style of the data used for fine-tuning. When prompted with the prefix \u201cGENRE:\u201d, it will choose one of the genres it saw in the fine-tuning and then create a title and a brief plot summary. However, there is no guarantee that it will always create a new title and a unique plot. Sometimes it chooses an existing title and it may or may not come up with a plot similar to the published work.", "I filter out clearly recycled stories by post-processing the results to see if the title is unique or not. I check for previously used titles in the CMU dataset, as well as titles from the book review site Goodreads and the IMDB database which has titles for movies and TV shows. Here is a diagram that shows the number of titles in these three datasets.", "You can see that the IMDB database has a huge list of titles compared to the CMU dataset and Goodreads. Here is a code snippet that shows how I accumulate the list of titles to be used for duplicate checking.", "Note that I remove the articles \u201cThe\u201d and \u201cA\u201d from the head of the titles. If GPT-2 comes up with the title \u201cGreat Gatsby\u201d we\u2019ll consider it a dupe and filter it out. Also, note that the list of titles is not exhaustive. There are plenty of published books that don\u2019t have Wikipedia pages, reviews on Goodreads, or have been made into movies or TV shows. So if you see a story plot that you like, please do a little research first before writing your masterpiece to make sure it\u2019s truly unique.", "Sometimes the GPT-2 text generator gets stuck on a particular phrase and repeats it multiple times in a plot summary. You can see some repetition in this example.", "Notice how the phrase \u201cthe individual\u2019s sense of themselves\u201d is repeated three times. I wrote a little function that looks for this artifact to filter out entries that have repetition. Here\u2019s the Python code.", "If the function sees a phrase of a given length in the input one or more times, it gets flagged with repetition. I use the phrase length of five to filter out repetitive plot summaries.", "Here are instructions to run PlotJam. It runs as a Google Colab, a free service for experimenting with AI using a high-end GPU. Note that having a Google account is required.", "You can see that each of the plot variations start with the same genre and title, but are different in how the plot summary unfolds.", "The PlotJam system is based on the \u201clarge\u201d model of GPT-2. This model, with 774 million parameters, runs on the Google Colab system. Future work would be to use the \u201cextra-large\u201d model with 1.6 billion parameters which may have better results. OpenAI recently released a beta version of their GPT-3 model, which they claim has 175 billion parameters. This would probably do an even better job of creating plot summaries.", "I would like to thank Jennifer Lim for her help and feedback on this project.", "All source code for this project is available on GitHub. The sources are released under the CC BY-NC-SA license.", "[2] A. Radford, K. Narasimhan, T. Salimans, and I. Sutskever, \u201cImproving Language Understanding by Generative Pre-Training\u201d, June, 2018", "[3] A. Radford, J. Wu, R. Child, D. Luan, D. Amodei, and I. Sutskever. \u201cLanguage Models are Unsupervised Multitask Learners\u201d, February, 2019", "Here are some \u201ccherry-picked\u201d samples from PlotJam.", "To get unlimited access to all articles on Medium, become a member for $5/month. Non-members can only read three locked stories each month.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Robert A. Gonsalves is an artist, inventor, and engineer in the Boston area who researches and writes about the creative uses of AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe555db9f3272&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e555db9f3272--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e555db9f3272--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://robgon.medium.com/?source=post_page-----e555db9f3272--------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=post_page-----e555db9f3272--------------------------------", "anchor_text": "Robert A. Gonsalves"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc97e6c73c13c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=post_page-c97e6c73c13c----e555db9f3272---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe555db9f3272&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe555db9f3272&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/machineray-using-ai-to-create-abstract-art-39829438076a", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/tokenization-for-natural-language-processing-a179a891bad4", "anchor_text": "here"}, {"url": "https://medium.com/inside-machine-learning/what-is-a-transformer-d07dd1fbec04", "anchor_text": "post"}, {"url": "http://jalammar.github.io/illustrated-gpt2/", "anchor_text": "here"}, {"url": "http://www.cs.cmu.edu/~dbamman/booksummaries.html#:~:text=This%20dataset%20contains%20plot%20summaries,author%2C%20title%2C%20and%20genre.", "anchor_text": "Book Summary Dataset"}, {"url": "https://colab.research.google.com/github/robgon-art/PlotJam/blob/master/PlotJam_Sampling.ipynb", "anchor_text": "PlotJam SamplingUsing GPT-2 to create new plot summariescolab.research.google.com"}, {"url": "https://github.com/robgon-art/PlotJam", "anchor_text": "GitHub"}, {"url": "https://creativecommons.org/licenses/by-nc-sa/4.0/", "anchor_text": "CC BY-NC-SA license"}, {"url": "https://unsplash.com/@hudsoncrafted?utm_source=medium&utm_medium=referral", "anchor_text": "Debby Hudson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://robgon.medium.com/membership", "anchor_text": "become a member"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----e555db9f3272---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e555db9f3272---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/creative-writing?source=post_page-----e555db9f3272---------------creative_writing-----------------", "anchor_text": "Creative Writing"}, {"url": "https://medium.com/tag/gpt-2?source=post_page-----e555db9f3272---------------gpt_2-----------------", "anchor_text": "Gpt 2"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----e555db9f3272---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe555db9f3272&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=-----e555db9f3272---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe555db9f3272&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=-----e555db9f3272---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe555db9f3272&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e555db9f3272--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe555db9f3272&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e555db9f3272---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e555db9f3272--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e555db9f3272--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e555db9f3272--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e555db9f3272--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e555db9f3272--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e555db9f3272--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e555db9f3272--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e555db9f3272--------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://robgon.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Robert A. Gonsalves"}, {"url": "https://robgon.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc97e6c73c13c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=post_page-c97e6c73c13c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F886e4a42bf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgot-writers-block-it-s-plotjam-to-the-rescue-e555db9f3272&newsletterV3=c97e6c73c13c&newsletterV3Id=886e4a42bf8&user=Robert+A.+Gonsalves&userId=c97e6c73c13c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}