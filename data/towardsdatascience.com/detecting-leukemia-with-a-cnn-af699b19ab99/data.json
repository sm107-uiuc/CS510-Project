{"url": "https://towardsdatascience.com/detecting-leukemia-with-a-cnn-af699b19ab99", "time": 1683014620.59266, "path": "towardsdatascience.com/detecting-leukemia-with-a-cnn-af699b19ab99/", "webpage": {"metadata": {"title": "Detecting Leukemia with a CNN. Can CNNs reliably identify cancerous\u2026 | by Aren Carpenter | Towards Data Science", "h1": "Detecting Leukemia with a CNN", "description": "Acute Lymphoblastic Leukemia (ALL) is the most common pediatric cancer and the most frequent cause of death from cancer before 20 years of age. In the 1960s ALL had a survival rate of only 10%, but\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.nejm.org/doi/full/10.1056/NEJMra1400972", "anchor_text": "1", "paragraph_index": 0}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4567699/", "anchor_text": "2", "paragraph_index": 1}, {"url": "https://www.nature.com/articles/bcj201753", "anchor_text": "3", "paragraph_index": 1}, {"url": "https://www.nature.com/articles/bcj201753", "anchor_text": "3", "paragraph_index": 1}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJMra1400972", "anchor_text": "1", "paragraph_index": 2}, {"url": "https://www.nature.com/articles/bcj201753", "anchor_text": "3", "paragraph_index": 2}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJMra1400972", "anchor_text": "1", "paragraph_index": 2}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4335145/", "anchor_text": "4", "paragraph_index": 3}, {"url": "http://piurilabs.di.unimi.it/Papers/cimsa_2005.pdf", "anchor_text": "5", "paragraph_index": 3}, {"url": "https://app.box.com/s/xeclwwd2xep9ntljtgyptmt4k5wone9n", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://blog.betomorrow.com/keras-in-the-cloud-with-amazon-sagemaker-67cf11fb536", "anchor_text": "post", "paragraph_index": 10}, {"url": "https://github.com/Pravez/KerasSageMaker", "anchor_text": "repo", "paragraph_index": 10}, {"url": "https://github.com/ArenCarpenter/Detecting_ALL_with_CNN", "anchor_text": "GitHub", "paragraph_index": 16}, {"url": "https://github.com/ArenCarpenter/Detecting_ALL_with_CNN", "anchor_text": "GitHub repo", "paragraph_index": 22}, {"url": "https://www.linkedin.com/in/aren-carpenter/", "anchor_text": "LinkedIn", "paragraph_index": 22}, {"url": "https://twitter.com/ArenCarpenter", "anchor_text": "Twitter", "paragraph_index": 22}, {"url": "http://arencarpenter.com/", "anchor_text": "website", "paragraph_index": 22}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4335145/", "anchor_text": "Recognition of Acute Lymphoblastic Leukemia Cells in Microscopic Images Using K-Means Clustering and Support Vector Machine Classifier", "paragraph_index": 23}, {"url": "http://piurilabs.di.unimi.it/Papers/cimsa_2005.pdf", "anchor_text": "Automatic Morphological Analysis for Acute Leukemia Identification in Peripheral Blood Microscope Images", "paragraph_index": 24}], "all_paragraphs": ["Acute Lymphoblastic Leukemia (ALL) is the most common pediatric cancer and the most frequent cause of death from cancer before 20 years of age. In the 1960s ALL had a survival rate of only 10%, but advancements in diagnostic testing and refinements to chemotherapies have increased survival rates to 90% in developed countries. [1]", "Researchers are attempting a variety of personalized approaches, mainly using epigenetic screenings and genome-wide association studies (GWAS) to identify potential targets for inhibition, to push survival rates even higher. [2, 3] About 80% of ALL cases are children, but, as Terwilliger and Abdul-Hay note, there is another peak of ALL incidence at 50 years of age and long-term remission rates in the older subset of patients is lower than children, about 30\u201340%. [3]", "ALL is described as the proliferation and differentiation of lymphoid cells in the bone marrow. Important cellular processes, such as the regulation of lymphoid differentiation, cell cycle regulation, growth factor and tumor-suppressor receptor signaling, and epigenetic modification, are perturbed. Additionally, chromosomal translocations are present in about a third of ALL cases. This can cause the overexpression of oncogenes by relocating them to actively transcribed regions or underexpression of tumor-suppressing genes by relocating them to non-transcribed regions of the genome. [1, 3] ALL is commonly polyclonal which further complicates treatment because a number of sub-populations will likely be resistant to any one treatment. [1]", "ALL can be split into 3 distinct subtypes that makes identification difficult, even for experienced practitioners. L1 are small and homogeneous, round with no clefting, and with no obvious nucleoli or vacuoles. These are the most likely to pass as normal lymphoblasts. L2 are larger and heterogeneous, irregular shape and often clefted, and have defined nucleoli and vacuoles. L3 have the shape of L1 but have prominent nucleoli and vacuoles. [4, 5]", "The data consists of 10,000+ images of single-cell microscopy acute lymphoblastic leukemia and normal lymphoblasts with a class imbalance of about 2:1 ALL to normal. Having enough images and computing resources without using all images, I decided to downsample the positive ALL class to manage class imbalance. Thus, training was completed with 4,000 images with a 57:43 class imbalance.", "Images are 450x450 RGB images stored as .bmp files, a raster graphics bitmap which stores images as 2D matrices.", "Data can be found here. It was sourced from the University of Arkansas for Medical Sciences (UAMS) study on ALL microscopy.", "Here are some normal cells from our set. We see spherical, non-clefted cells with homogeneous chromatin and few vacuoles.", "Here are some ALL cells from our set. We see irregularly shaped, clefted cells with heterogeneous chromatin and multiple nucleoli and vacuoles.", "Looking at the average image for each class we see that the interior of the cells have too much variation to identify meaningful differences, but we see clearly that ALL cells are much larger on average than normal cells. This should not be surprising as cancerous cells have unregulated growth.", "I used this post from Paul Breton and the corresponding GitHub repo for guidance on utilizing Keras with Sagemaker.", "I utilized the Keras framework in AWS Sagemaker by specifying neural network architecture and compilation hyperparameters in a separate Python script located in the Model_Scripts directory. Training was accomplished in a ml.m4.xlarge notebook instance allowing for hundreds of epochs in a tractable training time.", "I adopted an iterative approach to modeling based on the CRISP-DM process. A dummy classifier predicting the majority class had an accuracy of 57%. I created a Vanilla model with a single Conv2D layer and a single Dense layer which had an accuracy of 68%, already better than the dummy. I then created successively larger and more complex architectures by adding additional Conv2D layers and blocks of layers separated by MaxPooling layers.", "The most complex had 9 convolutions in 3 blocks of 3 layers, but this was not the most successful model as it appeared to overfit our training data. It became clear that deep, but narrow blocks were achieving higher metrics than wider blocks. The best model was a 2x2x1x1 architecture with 6 total convolutions. Dropout layers and Batch Normalization were added after MaxPooling and Dense layers to combat overfitting, but were not present in the final model.", "I attempted to use recall as a secondary metric for model selection, however this pushed the model to always selecting ALL for images and pushed the model accuracy down to the dummy classifier. I thus decided to drop recall and focus on accuracy. With recall so high and accuracy sacrificed the model would be useless as a tool because all images would have to be reviewed by a human physician anyway, negating the benefits of the model.", "I used binary cross-entropy for the loss function as this is a binary classification problem, and RMSprop and Adam for optimization. The learning rate was set to 0.001 with a decay of 0.0001.", "The best performing model was deployed using AWS Endpoints in order to load in not-yet-seen images from the testing set in order to generate predictions. The deployment is located in the 003_Modeling_AWS notebook under model training in my GitHub.", "Here we see an image the model misclassified as Normal when it was actually ALL. The model is apparently responding to the lack of interior vacuoles and clefting as well as a dense chromatin to classify as normal. The irregular shape should have shown that it was ALL.", "Here we see an image the model misclassified as ALL when it was actually Normal. The model is likely responding to the irregular cell outline as well as the lighter, heterogeneous areas in the interior that suggest vacuoles or unpacked chromatin to classify it as ALL. This is definitely a challenging cell to correctly sort.", "The model achieved an accuracy of 84%, allowing it to be a useful tool for identifying ALL in novel cases. As blood sample microscopy is already the default diagnostic test for ALL, this model could easily be used to verify a human physician or to flag cases that the model is not confident in for further review. As diagnosing ALL is difficult even for humans, having a robust, accurate verification model could improve the speed and rigor of diagnosis. Due to ALL being an acute leukemia, it is especially vital that it is consistently identified early, left untreated it can kill within a few weeks or months.", "There are several potential avenues for improvement for this model. I attempted to use the Adam optimizer, which adds a sense of momentum and bias-correction to the gradient calculated by RMSprop, and Batch Normalization to improve model performance, though it did help modeling thus far. I could also implement Early Stopping and Model Checkpoints to combat overfitting by allowing the model to stop training once a threshold of overfitting has been reached. I experimented with several levels of Dropout, settling on 25%, but further investigation could yield better results.", "Model interpretability is often as or more important than model accuracy, especially for medical diagnostic needs. It is very important in real-world applications that a doctor can see why the model has reached a certain decision. To that end, building an image segmentation model that identifies and marks important features, such as presence and number of vaculoes, non-spherical cells, or clefted edges within an image could greatly improve the model\u2019s usability. Additionally, deploying the model and allowing for live-integration of new imaging would keep the model up-to-date.", "Here is the GitHub repo for this project. You can connect with me on LinkedIn and Twitter, or visit my website for more articles.", "[4] M.M. Amin, S. Kermani, A. Talebi, and M.G. Oghli, Recognition of Acute Lymphoblastic Leukemia Cells in Microscopic Images Using K-Means Clustering and Support Vector Machine Classifier. 2015. Journal of Medical Signals and Sensors 5 (1): 49\u201358.", "[5] F. Scotti, Automatic Morphological Analysis for Acute Leukemia Identification in Peripheral Blood Microscope Images. 2005. Conference on Computational Intelligence for Measurement Systems.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data. BI. Goldman Sachs. 150k readers"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf699b19ab99&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----af699b19ab99--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af699b19ab99--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arencarpenter.medium.com/?source=post_page-----af699b19ab99--------------------------------", "anchor_text": ""}, {"url": "https://arencarpenter.medium.com/?source=post_page-----af699b19ab99--------------------------------", "anchor_text": "Aren Carpenter"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff940c24a2ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&user=Aren+Carpenter&userId=f940c24a2ebf&source=post_page-f940c24a2ebf----af699b19ab99---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf699b19ab99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf699b19ab99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/machine-learning/home", "anchor_text": "Machine Learning"}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJMra1400972", "anchor_text": "1"}, {"url": "https://unsplash.com/photos/wZHDa7cD7Ps", "anchor_text": "Image"}, {"url": "https://unsplash.com/@pawel_czerwinski", "anchor_text": "Pawe\u0142 Czerwi\u0144ski"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4567699/", "anchor_text": "2"}, {"url": "https://www.nature.com/articles/bcj201753", "anchor_text": "3"}, {"url": "https://www.nature.com/articles/bcj201753", "anchor_text": "3"}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJMra1400972", "anchor_text": "1"}, {"url": "https://www.nature.com/articles/bcj201753", "anchor_text": "3"}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJMra1400972", "anchor_text": "1"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4335145/", "anchor_text": "4"}, {"url": "http://piurilabs.di.unimi.it/Papers/cimsa_2005.pdf", "anchor_text": "5"}, {"url": "https://commons.wikimedia.org/wiki/Category:Blood_films_of_acute_lymphoblastic_leukemia#/media/File:Acute_lymphoblastic_leukaemia_smear.jpg", "anchor_text": "James Grellier"}, {"url": "https://creativecommons.org/licenses/by-sa/3.0", "anchor_text": "CC BY-SA 3.0"}, {"url": "https://app.box.com/s/xeclwwd2xep9ntljtgyptmt4k5wone9n", "anchor_text": "here"}, {"url": "https://blog.betomorrow.com/keras-in-the-cloud-with-amazon-sagemaker-67cf11fb536", "anchor_text": "post"}, {"url": "https://github.com/Pravez/KerasSageMaker", "anchor_text": "repo"}, {"url": "https://github.com/ArenCarpenter/Detecting_ALL_with_CNN", "anchor_text": "GitHub"}, {"url": "https://github.com/ArenCarpenter/Detecting_ALL_with_CNN", "anchor_text": "GitHub repo"}, {"url": "https://www.linkedin.com/in/aren-carpenter/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/ArenCarpenter", "anchor_text": "Twitter"}, {"url": "http://arencarpenter.com/", "anchor_text": "website"}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJMra1400972", "anchor_text": "Acute Lymphoblastic Leukemia in Children"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4567699/", "anchor_text": "Childhood Acute Lymphoblastic Leukemia: Progress Through Collaboration"}, {"url": "https://www.nature.com/articles/bcj201753", "anchor_text": "Acute lymphoblastic leukemia: a comprehensive review and 2017 update"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4335145/", "anchor_text": "Recognition of Acute Lymphoblastic Leukemia Cells in Microscopic Images Using K-Means Clustering and Support Vector Machine Classifier"}, {"url": "http://piurilabs.di.unimi.it/Papers/cimsa_2005.pdf", "anchor_text": "Automatic Morphological Analysis for Acute Leukemia Identification in Peripheral Blood Microscope Images"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----af699b19ab99---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/oncology?source=post_page-----af699b19ab99---------------oncology-----------------", "anchor_text": "Oncology"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----af699b19ab99---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/tag/keras?source=post_page-----af699b19ab99---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----af699b19ab99---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf699b19ab99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&user=Aren+Carpenter&userId=f940c24a2ebf&source=-----af699b19ab99---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Faf699b19ab99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&user=Aren+Carpenter&userId=f940c24a2ebf&source=-----af699b19ab99---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faf699b19ab99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----af699b19ab99--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Faf699b19ab99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----af699b19ab99---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----af699b19ab99--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----af699b19ab99--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----af699b19ab99--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----af699b19ab99--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----af699b19ab99--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----af699b19ab99--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----af699b19ab99--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----af699b19ab99--------------------------------", "anchor_text": ""}, {"url": "https://arencarpenter.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arencarpenter.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aren Carpenter"}, {"url": "https://arencarpenter.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "312 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff940c24a2ebf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&user=Aren+Carpenter&userId=f940c24a2ebf&source=post_page-f940c24a2ebf--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F514e15282e8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-leukemia-with-a-cnn-af699b19ab99&newsletterV3=f940c24a2ebf&newsletterV3Id=514e15282e8e&user=Aren+Carpenter&userId=f940c24a2ebf&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}