{"url": "https://towardsdatascience.com/g-computation-in-causal-inference-774099da3631", "time": 1682996575.055423, "path": "towardsdatascience.com/g-computation-in-causal-inference-774099da3631/", "webpage": {"metadata": {"title": "G-computation in Causal Inference | by Yao Yang | Towards Data Science", "h1": "G-computation in Causal Inference", "description": "G-computation algorithm was first introduced by Robins in 1986 [1] to estimate the causal effect of a time-varying exposure in the presence of time-varying confounders that are affected by exposure\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["G-computation algorithm was first introduced by Robins in 1986 [1] to estimate the causal effect of a time-varying exposure in the presence of time-varying confounders that are affected by exposure, a scenario where traditional regression-based methods would fail.", "G-computation or G-formula belongs to the G-method family [2] which also includes inverse probability weighted marginal structural models and g estimation of a structural nested model. They provide consistent estimates of contrasts (e.g. differences, ratios) of average potential outcomes under a less restrictive set of identification conditions than standard regression methods.", "In this post, I\u2019ll explain more in details of how G-computation works in causal analysis.", "Think of an example \u2014 treating HIV, the way to measure the effect of treatment is to test for CD4 count, the more the number of CD4 counts in your blood, the better the treatment effect is. We name the outcome (CD4 count) Y. We have two groups of patients, A=1 means receiving a specific treatment, A=0 means otherwise. We test the patients before any treatment as a baseline and also do a follow-up test A_1. We also have a covariate Z \u2014 elevated HIV viral load, which is constant by design at baseline and measured once during follow up just prior to the second treatment (Z_1). Besides these, we also have an unmeasured common cause (U) of HIV viral load(Z) and CD4(Y).", "To measure the difference, we usually use average causal effect E(Y1-Y0), it is a marginal effect because it averages over all individual-level effects in the population.", "How do we identify the changes in CD4 count (Y) is caused by the treatment (A=1), not something else?", "We use an average effect to measure the difference, however, we cannot acquire all information because some individuals are exposed to treatment and some are not. We are not doing propensity score matching so we cannot guarantee that all the other conditions the individuals have are the same. We need to justify the average effect we take for measuring would be observed in the whole population. This is accomplished by making the following assumptions:", "The consistency rule states that a person\u2019s potential outcome under a hypothetical condition that happened to materialize is precisely the outcome experienced by that person. This allows us to write: P(Yx = y|Z = z,X = x) = P(Y = y|Z = z,X = x), and identify our average causal effect", "Exchangeability implies that potential outcomes under exposures are independent of actual exposures A_0 or A_1. This is the assumption that says \u201cThe data came from a randomized controlled trial\u201d. If this assumption is true, you will observe a random subset of the distribution of Ya=0 in the group where A=0, and a random subset of the distribution of Ya=1 in the group where A=1.", "Positivity is the assumption that any individual has a positive probability of receiving all values of the treatment variable. This assumption is useful so that the effects would exist. The assumption would be met when there are exposed and unexposed individuals within all confounders.", "Under these assumptions, g methods can be used to estimate counterfactual quantities with observational data", "To estimate different component effects of treatment on CD4 count, we implemented the following steps:", "The idea is to use counterfactuals (what the result would be if the patients who received treatments did not receive treatments, and the patients who did not receive treatments did) to create an estimation of average effect to fit into our model of measuring the difference.", "Thanks for reading my posts! In later posts, I\u2019ll explain the other G-method, namely IPWC, and explain how TMLE, G-formula, and IPWC are different and related.", "[1] Robins J. A new approach to causal inference in mortality studies with a sustained exposure period \u2014 application to control of the healthy worker survivor effect. Math Model. 1986;7(9\u201312):1393\u20131512.", "[2] Robins J and Hernan M. Estimation of the causal effects of time-varying exposures. In: Fitzmaurice G, Davidian M, Verbeke G, and Molenberghs G (Eds.) Advances in Longitudinal Data Analysis. Boca Raton, FL: Chapman & Hall. 2009; 553\u2013599.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "The combination of words, numbers, and stories makes life"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F774099da3631&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----774099da3631--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----774099da3631--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yangyao.medium.com/?source=post_page-----774099da3631--------------------------------", "anchor_text": ""}, {"url": "https://yangyao.medium.com/?source=post_page-----774099da3631--------------------------------", "anchor_text": "Yao Yang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a719c20527a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&user=Yao+Yang&userId=5a719c20527a&source=post_page-5a719c20527a----774099da3631---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F774099da3631&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F774099da3631&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/data-science?source=post_page-----774099da3631---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/causal-inference?source=post_page-----774099da3631---------------causal_inference-----------------", "anchor_text": "Causal Inference"}, {"url": "https://medium.com/tag/statistics?source=post_page-----774099da3631---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----774099da3631---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F774099da3631&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&user=Yao+Yang&userId=5a719c20527a&source=-----774099da3631---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F774099da3631&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&user=Yao+Yang&userId=5a719c20527a&source=-----774099da3631---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F774099da3631&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----774099da3631--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F774099da3631&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----774099da3631---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----774099da3631--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----774099da3631--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----774099da3631--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----774099da3631--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----774099da3631--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----774099da3631--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----774099da3631--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----774099da3631--------------------------------", "anchor_text": ""}, {"url": "https://yangyao.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yangyao.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yao Yang"}, {"url": "https://yangyao.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "569 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a719c20527a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&user=Yao+Yang&userId=5a719c20527a&source=post_page-5a719c20527a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7e62ec5a9b17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fg-computation-in-causal-inference-774099da3631&newsletterV3=5a719c20527a&newsletterV3Id=7e62ec5a9b17&user=Yao+Yang&userId=5a719c20527a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}