{"url": "https://towardsdatascience.com/understanding-cross-validation-419dbd47e9bd", "time": 1683003801.7228858, "path": "towardsdatascience.com/understanding-cross-validation-419dbd47e9bd/", "webpage": {"metadata": {"title": "Understanding Cross Validation. How Cross Validation Helps Us Avoid The\u2026 | by Tony Yiu | Towards Data Science", "h1": "Understanding Cross Validation", "description": "I remember the first quantitative model that I ever built. It was a model that tactically shifted money between U.S. stocks and Emerging Market stocks based on various market and economic factors\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/what-in-the-world-are-qq-plots-20d0e41dece1", "anchor_text": "What In The World Are QQ Plots?", "paragraph_index": 15}, {"url": "https://tonester524.medium.com/membership", "anchor_text": "https://tonester524.medium.com/membership", "paragraph_index": 17}], "all_paragraphs": ["I remember the first quantitative model that I ever built. It was a model that tactically shifted money between U.S. stocks and Emerging Market stocks based on various market and economic factors that I had researched.", "I spent a ton of time engineering (over-engineering actually) my features and running backtests until I was sure that I had a world beater. When my model was finally put into production, it spent a year doing basically nothing. Ultimately, I think it produced a slightly negative cumulative return.", "I count myself lucky. Thinking back, I realize that my model was massively overfit and I\u2019m fortunate that the bets it recommended did not blow up and cost my firm significant amounts of money.", "Today we will discuss cross validation, a technique that helps us estimate the out of sample performance of our model and prevent overfitting. But first, let\u2019s talk a bit about what overfitting is and why it occurs.", "Overfitting is when we train our model so much to the existing data that it loses the ability to generalize. Models that generalize well are ones that can adapt reasonably successfully to new data, especially ones that are unlike any of the observations the model has seen up until now. So if an overfit model is unable to generalize, then it\u2019s highly likely to perform erratically (and probably badly) when it gets put into production and truly goes out of sample. The most common causes of overfitting are:", "Cross validation is a technique that allows us to produce test set like scoring metrics using the training set. That is, it allows us to simulate the effects of \u201cgoing out of sample\u201d using just our training data, so we can get a sense of how well our model generalizes.", "Without cross validation, the traditional model training process looks like this:", "We train on the blue part until we feel like our model is ready to face the wild. Then we score it on the test set (the gold part). The drawback of the traditional way is that we only get one shot at things. The moment we test our model on the test set, we\u2019ve compromised our test data. And if our test set results were terrible, what then? Would we really be alright with throwing away all those hours of work or would we just start optimizing our results for the test set?", "If only there were a way to simulate how our model might perform on the test set without actually using the test set. There is! And it\u2019s called cross validation.", "We will focus on a specific type of cross validation called K-folds (so when I merely say cross validation, I mean K-folds cross validation). K-folds cross validation splits our training data into K folds (folds = subsections). We then train and test our model K times so that each and every fold gets a chance to be the pseudo test set, which we call the validation set. Let\u2019s use some visuals to get a better understanding of what\u2019s going on:", "Say we are developing a predictive linear regression model and are using R\u00b2 as our primary scoring metric. We have some data that we have split into a training set and a test set. Our primary concern is the accuracy of the out of sample predictions of our model (how well it generalizes). Thus, we\u2018ve decided to not look at the test set until the very end (so we can give our model an intellectually honest grade).", "But as we tweak and refine our model, we still want to get a sense of how the changes we are making might affect its out of sample performance. So we cross validate:", "The most important thing to remember about how cross validation works is that in each run, the scoring metrics it reports are calculated on just the fold that was held out.", "A few tips when employing cross validation:", "More Data Science Related Posts By Me:", "What In The World Are QQ Plots?", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist. Founder Alpha Beta Blog. Doing my best to explain the complex in plain English. Support my writing: https://tonester524.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F419dbd47e9bd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tonester524.medium.com/?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": "Tony Yiu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F840a3210fbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&user=Tony+Yiu&userId=840a3210fbe7&source=post_page-840a3210fbe7----419dbd47e9bd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F419dbd47e9bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F419dbd47e9bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sbk202?utm_source=medium&utm_medium=referral", "anchor_text": "Sam Balye"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/what-in-the-world-are-qq-plots-20d0e41dece1", "anchor_text": "What In The World Are QQ Plots?"}, {"url": "https://towardsdatascience.com/understanding-the-normal-distribution-with-python-e70bb855b027", "anchor_text": "Understanding The Normal Distribution"}, {"url": "https://towardsdatascience.com/pandas-join-vs-merge-c365fd4fbf49", "anchor_text": "Pandas Join vs. Merge"}, {"url": "https://towardsdatascience.com/understanding-bayes-theorem-7e31b8434d4b", "anchor_text": "Understanding Bayes\u2019 Theorem"}, {"url": "https://medium.com/tag/data-science?source=post_page-----419dbd47e9bd---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----419dbd47e9bd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----419dbd47e9bd---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/statistics?source=post_page-----419dbd47e9bd---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/analytics?source=post_page-----419dbd47e9bd---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F419dbd47e9bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&user=Tony+Yiu&userId=840a3210fbe7&source=-----419dbd47e9bd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F419dbd47e9bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&user=Tony+Yiu&userId=840a3210fbe7&source=-----419dbd47e9bd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F419dbd47e9bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F419dbd47e9bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----419dbd47e9bd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----419dbd47e9bd--------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tony Yiu"}, {"url": "https://tonester524.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "102K Followers"}, {"url": "https://tonester524.medium.com/membership", "anchor_text": "https://tonester524.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F840a3210fbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&user=Tony+Yiu&userId=840a3210fbe7&source=post_page-840a3210fbe7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F78d3e392d884&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cross-validation-419dbd47e9bd&newsletterV3=840a3210fbe7&newsletterV3Id=78d3e392d884&user=Tony+Yiu&userId=840a3210fbe7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}