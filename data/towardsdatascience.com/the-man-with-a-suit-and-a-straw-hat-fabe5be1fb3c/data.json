{"url": "https://towardsdatascience.com/the-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c", "time": 1682996358.042075, "path": "towardsdatascience.com/the-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c/", "webpage": {"metadata": {"title": "The man with a suit and a straw hat | by Aileen | Towards Data Science", "h1": "The man with a suit and a straw hat", "description": "To detect anomaly is to detect outliers. This might seem straightforward but is not always the case. The question is, how do you define an outlier? Let\u2019s first imagine a man wearing a suit. This is\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["To detect anomaly is to detect outliers. This might seem straightforward but is not always the case. The question is, how do you define an outlier?", "Let\u2019s first imagine a man wearing a suit. This is normal. Then imagine a man wearing a straw hat, this is also normal. Now put these two pictures into one, imagine the same man wearing a suit and a straw hat. Being formal and casual at the same time? That seems abnormal.", "This is a common situation of anomaly detection in cases like predictive maintenance. In data scientists\u2019 wording, it is sometimes not a single feature that says about an anomaly, but a combination of multiple features.", "We should not look at the picture in its part but step back to see its entirety.", "There are different ways to detect an anomaly. The most common approach is to create a normal profile of situations, and then classify everything else as abnormal. Here, we will look into a rather different kind of model that learns from a few instances of anomalies \u2014 Isolation Forest. The word \u201cisolation\u201d implies we can find anomaly through the notion of distance. Intuitively, the more abnormal a data point is, the more isolated it is from the rest.", "In real-world applications, most datasets have multiple dimensions. For example, for predictive maintenance, relevant features can be the machine\u2019s vibration, sound, and so on. To simplify, we just consider here a one-dimensional data shown as a few blue circles. Humans can observe easily, the one being most isolated to the right, is an anomaly. But how does a machine go about finding it?", "Let\u2019s use needles as an illustration. Suppose someone is flying above, randomly throwing a needle that will end up standing still on the line. And there is an equal chance for that needle to land in any position from the furthest left to the furthest right sample.", "If the needle lands between 3 and 4, it isolates 4. If the needle lands between 1 and 2, it isolates 1. If the needle lands between 2 and 3, it does not isolate any, and thus we continue throwing more needles until at least one sample is isolated. We replicate the process recursively until the isolation of all samples.", "For each sample, we count the number of needles used until its isolation. And this number is what we call an anomaly score. As the position of the landed needle is uniformly distributed, the more distant a sample is, the more likely it is isolated faster, and hence fewer needles might be needed. Based on the anomaly scores from the existing dataset, we could define a threshold, such that any future data with an anomaly score below this threshold will be classified as an anomaly.", "By the end of the experiment, we would have split all samples apart, each with an assigned anomaly score. As shown in a \u201ctree\u201d below, those with smaller anomaly scores are closer to the root of the tree, since they are isolated at an early stage. Those with larger scores are further apart from the root, as they are isolated later. Therefore, such a tree characterizes the isolation status of all samples, showing roughly how abnormal a specific sample is compared to the others.", "Now, before going to the \u201cforest\u201d, let\u2019s stay a few moments on an essential concept in machine learning \u2014 \u201cvariance\u201d. You might have come across the notion of Bias-Variance tradeoff. But we will skip \u201cbias\u201d for now.", "What might be the problem of using this simple model in practice? The real world data unobserved to us could have different patterns. In other words, the anomaly detection threshold derived from the sample data might not work out well for the population data. That\u2019s when we have a problem of high variance, or as we often put it, the model overfits to the training data.", "One solution to this is instead of building just one tree, we could use multiple trees. That\u2019s where the term \u201cforest\u201d comes in. In the context of the needle experiment, we would repeat the same procedure many times. Since there is randomness in each experiment, by averaging the anomaly scores from different models, we can derive a final model that is more capable of capturing anomalies in the population.", "With isolation forest and a dataset with a few anomalies, we are able to create certain detection rules, that allow us to say something about new sensor values, new financial transactions, or maybe, about the man with a suit and a straw hat.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffabe5be1fb3c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aileen.wenting.jiang?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aileen.wenting.jiang?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": "Aileen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa3e61fe36ffc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&user=Aileen&userId=a3e61fe36ffc&source=post_page-a3e61fe36ffc----fabe5be1fb3c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffabe5be1fb3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffabe5be1fb3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fabe5be1fb3c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fabe5be1fb3c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----fabe5be1fb3c---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fabe5be1fb3c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffabe5be1fb3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&user=Aileen&userId=a3e61fe36ffc&source=-----fabe5be1fb3c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffabe5be1fb3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&user=Aileen&userId=a3e61fe36ffc&source=-----fabe5be1fb3c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffabe5be1fb3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffabe5be1fb3c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fabe5be1fb3c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fabe5be1fb3c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aileen.wenting.jiang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aileen.wenting.jiang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aileen"}, {"url": "https://medium.com/@aileen.wenting.jiang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "295 Followers"}, {"url": "https://www.linkedin.com/in/wentingjiang/", "anchor_text": "https://www.linkedin.com/in/wentingjiang/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa3e61fe36ffc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&user=Aileen&userId=a3e61fe36ffc&source=post_page-a3e61fe36ffc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4a9833d5897a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-man-with-a-suit-and-a-straw-hat-fabe5be1fb3c&newsletterV3=a3e61fe36ffc&newsletterV3Id=4a9833d5897a&user=Aileen&userId=a3e61fe36ffc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}