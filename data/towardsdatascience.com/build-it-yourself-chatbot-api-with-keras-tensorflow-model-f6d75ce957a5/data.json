{"url": "https://towardsdatascience.com/build-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5", "time": 1682995935.190038, "path": "towardsdatascience.com/build-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5/", "webpage": {"metadata": {"title": "Build it Yourself \u2014 Chatbot API with Keras/TensorFlow Model | by Andrej Baranovskij | Towards Data Science", "h1": "Build it Yourself \u2014 Chatbot API with Keras/TensorFlow Model", "description": "We can build our own chatbot without using complex 3rd party products. This post provides description and source code for simple \u201cbuild it yourself\u201d chatbot implementation."}, "outgoing_paragraph_urls": [{"url": "https://github.com/katanaml/katana-assistant", "anchor_text": "GitHub", "paragraph_index": 1}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 2}, {"url": "https://github.com/katanaml/katana-assistant/blob/master/mlmodels/intents.json", "anchor_text": "file", "paragraph_index": 3}, {"url": "https://keras.io/optimizers/", "anchor_text": "optimizer", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/publishing-machine-learning-api-with-python-flask-98be46fb2440", "anchor_text": "wrap", "paragraph_index": 15}], "all_paragraphs": ["Is not that complex to build your own chatbot (or assistant, this word is a new trendy term for chatbot) as you may think. Various chatbot platforms are using classification models to recognize user intent. While obviously, you get a strong heads-up when building a chatbot on top of the existing platform, it never hurts to study the background concepts and try to build it yourself. Why not use a similar model yourself. Chatbot implementation main challenges are:", "Complete source code for this article with readme instructions is available on my GitHub repo (open source).", "This is the list of Python libraries which are used in the implementation. Keras deep learning library is used to build a classification model. Keras runs training on top of TensorFlow backend. Lancaster stemming library is used to collapse distinct word forms:", "Chatbot intents and patterns to learn are defined in a plain JSON file. There is no need to have a huge vocabulary. Our goal is to build a chatbot for a specific domain. Classification model can be created for small vocabulary too, it will be able to recognize a set of patterns provided for the training:", "Before we could start with classification model training, we need to build vocabulary first. Patterns are processed to build a vocabulary. Each word is stemmed to produce generic root, this would help to cover more combinations of user input:", "This is the output of vocabulary creation. There are 9 intents (classes) and 82 vocabulary words:", "Training would not run based on the vocabulary of words, words are meaningless for the machine. We need to translate words into bags of words with arrays containing 0/1. Array length will be equal to vocabulary size and 1 will be set when a word from the current pattern is located in the given position:", "Training data \u2014 X (pattern converted into array [0,1,0,1\u2026, 0]), Y (intents converted into array [1, 0, 0, 0,\u2026,0], there will be single 1 for intents array). Model is built with Keras, based on three layers. According to my experiments, three layers provide good results (but it all depends on training data). Classification output will be multiclass array, which would help to identify encoded intent. Using softmax activation to produce multiclass classification output (result returns an array of 0/1: [1,0,0,\u2026,0] \u2014 this set identifies encoded intent):", "Compile Keras model with SGD optimizer:", "Fit the model \u2014 execute training and construct classification model. I\u2019m executing training in 200 iterations, with batch size = 5:", "Model is built. Now we can define two helper functions. Function bow helps to translate user sentence into a bag of words with array 0/1:", "Check this example \u2014 translating the sentence into a bag of words:", "When the function finds a word from the sentence in chatbot vocabulary, it sets 1 into the corresponding position in the array. This array will be sent to be classified by the model to identify to what intent it belongs:", "It is a good practice to save the trained model into a pickle file to be able to reuse it to publish through Flask REST API:", "Before publishing model through Flask REST API, is always good to run an extra test. Use model.predict function to classify user input and based on calculated probability return intent (multiple intents can be returned):", "To publish the same function through REST endpoint, we can wrap it into Flask API:", "I have explained how to implement the classification part. In the GitHub repo referenced at the beginning of the post, you will find a complete example of how to maintain the context. Context is maintained by logic written in JavaScript and running on Node.js backend. Context flow must be defined in the list of intents, as soon as the intent is classified and backend logic finds a start of the context \u2014 we enter into the loop and ask related questions. How advanced is context handling all depends on the backend implementation (this is beyond Machine Learning scope at this stage).", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff6d75ce957a5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://andrejusb.medium.com/?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b----f6d75ce957a5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6d75ce957a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6d75ce957a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/katanaml/katana-assistant", "anchor_text": "GitHub"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://github.com/katanaml/katana-assistant/blob/master/mlmodels/intents.json", "anchor_text": "file"}, {"url": "https://keras.io/optimizers/", "anchor_text": "optimizer"}, {"url": "https://towardsdatascience.com/publishing-machine-learning-api-with-python-flask-98be46fb2440", "anchor_text": "wrap"}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f6d75ce957a5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----f6d75ce957a5---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/chatbots?source=post_page-----f6d75ce957a5---------------chatbots-----------------", "anchor_text": "Chatbots"}, {"url": "https://medium.com/tag/keras?source=post_page-----f6d75ce957a5---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/python?source=post_page-----f6d75ce957a5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff6d75ce957a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----f6d75ce957a5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff6d75ce957a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&user=Andrej+Baranovskij&userId=bbd1211c851b&source=-----f6d75ce957a5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff6d75ce957a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff6d75ce957a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f6d75ce957a5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f6d75ce957a5--------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://andrejusb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Andrej Baranovskij"}, {"url": "https://andrejusb.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://github.com/katanaml", "anchor_text": "https://github.com/katanaml"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbd1211c851b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&user=Andrej+Baranovskij&userId=bbd1211c851b&source=post_page-bbd1211c851b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd22cc5338107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-it-yourself-chatbot-api-with-keras-tensorflow-model-f6d75ce957a5&newsletterV3=bbd1211c851b&newsletterV3Id=d22cc5338107&user=Andrej+Baranovskij&userId=bbd1211c851b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}