{"url": "https://towardsdatascience.com/deep-few-shot-anomaly-detection-b33f130d1f80", "time": 1683016164.006631, "path": "towardsdatascience.com/deep-few-shot-anomaly-detection-b33f130d1f80/", "webpage": {"metadata": {"title": "Deep Few-shot Anomaly Detection. Harnessing a few labeled anomaly\u2026 | by Guansong Pang | Towards Data Science", "h1": "Deep Few-shot Anomaly Detection", "description": "Existing (deep or shallow) anomaly detection methods are typically designed as unsupervised learning (trained on fully unlabeled data) or semi-supervised learning (trained on exclusively labeled\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Existing (deep or shallow) anomaly detection methods are typically designed as unsupervised learning (trained on fully unlabeled data) or semi-supervised learning (trained on exclusively labeled normal data) due to the lack of large-scale labeled anomaly data. As a result, they are difficult to leverage prior knowledge (e.g., a few labeled anomalies) when such information is available as in many real-world anomaly detection applications. These limited labeled anomalies may originate from a deployed detection system, e.g., a few successfully detected network intrusion records, or they may be from users, such as a small number of fraudulent credit card transactions that are reported by clients and confirmed by the banks. As it is assumed only a very small number of labeled anomalies are available during training, the approaches in this research line may be grouped under the umbrella \u2018few-shot anomaly detection\u2019. However, they also have some fundamental differences from the general few-shot learning. I will discuss more on the differences at the end. In this post, I will share some of our exciting work on leveraging deep learning techniques to address this problem.", "Given a set of large normal (or unlabeled) training data and a very limited number of labeled anomaly data, we aim to properly leverage those small labeled anomaly data and the large normal/unlabeled data to learn an anomaly detection model.", "REPEN [1] is probably the first deep anomaly detection method that is designed to leverage the few labeled anomalies to learn anomaly-informed detection models. The key idea in REPEN is to learn feature representations such that anomalies have a larger nearest neighbor distance in a random data subsample than normal data instances. This random nearest neighbor distance is one of the most effective and efficient anomaly measures, as shown in [2, 3]. REPEN aims to learn feature representations that are tailored to this state-of-the-art anomaly measure. The framework of REPEN is illustrated as follows.", "REPEN is enforced to learn a larger nearest neighbor distance of the anomaly x- than the normal instance x+ in a random data subset x_i, \u2026, x_{i+n-1}. The overall objective is given as", "where Q is the random data subset sampled from the unlabeled/normal training data, f is a neural network-enabled feature learning function, nn_dist returns the nearest neighbor distance of x in the data subset Q.", "As you can see above, REPEN can work when the large training data contains either only normal data or fully unlabeled data. In the latter case and we also do not have the labeled anomaly data, REPEN uses some existing anomaly detectors to produce some pseudo-labeled anomaly data. So, REPEN can also work in an fully unsupervised setting.", "Although the labeled anomaly data is limited, REPEN can achieve very remarkable accuracy performance when compared with its unsupervised version. Some of the impressive results can be found below. The AUC performance increases quickly as the number of labeled anomalies increases from 1 to 80.", "The source code of REPEN is released at", "Unlike REPEN that focuses on feature representation learning for the distance-based anomaly measure, deviation network \u2014 DevNet [4] \u2014 is designed to leverage the limited labeled anomaly data to perform end-to-end anomaly score learning. The key difference can be seen in the figure below, where the former optimizes the representations while the latter optimizes the anomaly scores.", "Specifically, as shown in the framework below, given a set of training data instances, the proposed framework first uses a neural anomaly score learner to assign it an anomaly score, and then defines the mean of the anomaly scores of some normal data instances based on a prior probability to serve as a reference score for guiding the subsequent anomaly score learning. Lastly, the framework defines a loss function, called deviation loss, to enforce statistically significant deviations of the anomaly scores of anomalies from that of normal data objects in the upper tail. In the implementation of DevNet, a Gaussian prior is used to perform a direct optimization of anomaly scores using a Z-Score-based deviation loss.", "The loss function of DevNet is given as follows", "where dev is a Z-score-based deviation function and defined as", "where phi is a neural network-based mapping function that projects input x to a scalar output, mu and sigma are drawn from a Gaussian prior. This loss enables DevNet to push the anomaly scores of normal instances as close as possible to mu while enforce a deviation of at least a between mu and the anomaly scores of anomalies.", "DevNet is evaluated on a wide range of real-world datasets. Some of the results are given as follows. DevNet shows significantly improved performance over several state-of-the-art competing methods, including REPEN, deep one-class classifier, few-shot classifier and the unsupervised method iForest. More interesting results can be found in [4].", "The source code of DevNet and the datasets are released at", "In few-shot anomaly detection, the limited anomaly examples may come from different anomaly classes, and thus, exhibit completely different manifold/class features. This is fundamentally different from the general few-shot learning (mostly classification tasks), in which the limited examples are class-specific and assumed to share the same manifold/class structure. So, in few-shot anomaly detection, caution must be taken to deal with unknown anomalies that are from some novel type of anomaly classes. Two pieces of work [5, 6] are designed to address this problem. I will discuss these two studies later.", "In addition to the two methods introduced above, there are a few other papers addressing the same problem. Please see the survey paper [7] for detail.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Assistant Professor of Computer Science at Singapore Management University. Write about machine learning for abnormality, rarity, and irregularity."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb33f130d1f80&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@guansong-pang?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@guansong-pang?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": "Guansong Pang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1e6e5ed9fb39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&user=Guansong+Pang&userId=1e6e5ed9fb39&source=post_page-1e6e5ed9fb39----b33f130d1f80---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb33f130d1f80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb33f130d1f80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://github.com/GuansongPang/deep-outlier-detection", "anchor_text": "GuansongPang/deep-outlier-detectionThis repository presents you a deep outlier detection (or anomaly detection) algorithm, which uses triplet networks to\u2026github.com"}, {"url": "https://github.com/GuansongPang/deviation-network", "anchor_text": "GuansongPang/deviation-networkBy Guansong Pang, Chunhua Shen, Anton van den Hengel. Deep anomaly detection with deviation networks (KDD19). Deviation\u2026github.com"}, {"url": "https://medium.com/tag/anomaly-detection?source=post_page-----b33f130d1f80---------------anomaly_detection-----------------", "anchor_text": "Anomaly Detection"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----b33f130d1f80---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b33f130d1f80---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b33f130d1f80---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----b33f130d1f80---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb33f130d1f80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&user=Guansong+Pang&userId=1e6e5ed9fb39&source=-----b33f130d1f80---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb33f130d1f80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&user=Guansong+Pang&userId=1e6e5ed9fb39&source=-----b33f130d1f80---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb33f130d1f80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb33f130d1f80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b33f130d1f80---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b33f130d1f80--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b33f130d1f80--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b33f130d1f80--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b33f130d1f80--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@guansong-pang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@guansong-pang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Guansong Pang"}, {"url": "https://medium.com/@guansong-pang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "83 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1e6e5ed9fb39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&user=Guansong+Pang&userId=1e6e5ed9fb39&source=post_page-1e6e5ed9fb39--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4e654856ab84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-few-shot-anomaly-detection-b33f130d1f80&newsletterV3=1e6e5ed9fb39&newsletterV3Id=4e654856ab84&user=Guansong+Pang&userId=1e6e5ed9fb39&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}