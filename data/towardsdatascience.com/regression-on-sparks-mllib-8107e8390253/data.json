{"url": "https://towardsdatascience.com/regression-on-sparks-mllib-8107e8390253", "time": 1683006990.907816, "path": "towardsdatascience.com/regression-on-sparks-mllib-8107e8390253/", "webpage": {"metadata": {"title": "Regression on Sparks MLlib. A short example using MLlib API | by Israel Rodrigues | Towards Data Science", "h1": "Regression on Sparks MLlib", "description": "I want to share a (very) small development of a PoC (proof of concept) about using MLlib on Spark + Scala. In this case, we want to use MLlib to perform some machine learning algorithms over some\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/leonardopena/top50spotify2019", "anchor_text": "Leonardo\u2019s dataset on kaggle.com", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/crisp-dm-methodology-leader-in-data-mining-and-big-data-467efd3d3781", "anchor_text": "CRIPS-DM\u2019s first two steps", "paragraph_index": 4}, {"url": "https://issues.apache.org/jira/browse/SPARK-13197", "anchor_text": "special treatment in Spark", "paragraph_index": 9}, {"url": "https://prezi.com/tozutehrcojn/?utm_campaign=share&utm_medium=copy", "anchor_text": "https://prezi.com/tozutehrcojn/?utm_campaign=share&utm_medium=copy", "paragraph_index": 22}, {"url": "https://issues.apache.org/jira/browse/SPARK-13197", "anchor_text": "https://issues.apache.org/jira/browse/SPARK-13197", "paragraph_index": 23}], "all_paragraphs": ["I want to share a (very) small development of a PoC (proof of concept) about using MLlib on Spark + Scala. In this case, we want to use MLlib to perform some machine learning algorithms over some data. We will use a (very) small dataset, for example, Leonardo\u2019s dataset on kaggle.com. With data and an objective (using MLlib on Spark + Scala), let\u2019s create this PoC.", "After a fast review of the data, the conclusion is: most columns are numerical. All these numerical columns are open to prediction, but there\u2019s one, whos names make it the chosen one: Popularity. We could \u2018perform\u2019 that \u2018machine learning example\u2019 to predict values for Popularity.", "Popularity is a result (target variable) that is independent of other results, but (most probably) dependent on certain characteristics (variables/features). To predict (a future) results on Popularity, which is a numerical\u00a0target, using the characteristics received, which are also numerical, we can employ linear regression.", "Let\u2019s get a bit theoretical, so we can dress these affirmations with a tide. We want a short, practical way to give verifiable results out of an example of something (PoC). And the interest is in the greatly demanded TIC areas, which are Big Data (represented by data engineers) and Data Science (represented by Data Scientist).", "Having that frame, and employing CRIPS-DM\u2019s first two steps[3] on the selected dataset, we ideated a hypothesis that is: \u201cthe popularity of a song is, to some degree, the consequence of other features of that song\u201d. Predicting a target variable out of other features, when you have (previous) data indicating that target variable, is called supervised learning.", "As the data understanding step shows us, most of the columns have no-categorical values, but continuous-numerical ones, including the target variable. That endorses the idea of using an algorithm (CRIPS-DM\u2019s Modeling step) such as linear regression, to predict (calculate) the popularity of a song.", "In linear regression, we calculate the dependent variable(target value/result) by: adding the results of multiplying a specific (calculated) coefficient to the independent variable (features/variables) associated with that coefficient (B1*X1+B2*X2+\u2026), plus the interception point, plus a random error. All of these are numerical values.", "Summarizing, we have mentioned both in an informal day-to-day way and in a technical way, what is the motivation, objectives and how are we going to achieve those objectives. Let\u2019s get started.", "The linear regression algorithm, in MLlib, receives as parameter libsvm data. So the first step is to turn the CSV file to libsvm. That step is called data preparation on CRIPS-DM\u2019s methodology.", "We\u2019re going to drop the string (data type for several letters) columns and also the id one and, when doing so, we\u2019re going to face the issue that: dots inside a column name need special treatment in Spark[4]. So first we remove the dots, then drop the columns and finally use MLlib\u2019s assembler.transform function to turn the data into libsvm format.", "Now it\u2019s time to create the model, with some very few lines. But before that, let\u2019s first randomly divide the data between training and test, and then, use the training data to fit the model.", "We keep the model from model_data function in a val, and use it to create a prediction column on our test data. Our first model has an RMSD of 4 (points of popularity), and it makes predictions on test data as follows:", "The CRISP-DM Evaluation step is defined to ensure the correctness of the model. Depending on the business situation and the magnitude of the error, these results could be considered an acceptable result or not.", "To improve this result, we can: standardize (mean 0 and standard deviation 1) our data, we can convert the categorical values to factors (rock = 1, pop = 2,\u2026), we should use a larger dataset, we can drop the outliners, we can create specific studies on a discriminant variable (for example a model of popularity by music genre),\u00a0amount\u00a0others.", "But, for evaluation, there is something important to take into consideration: the experiment should be replicable.", "The command used to split data into test and training datasets doesn\u2019t allow us to take the exact same rows for each side, on each experiment. So each time we execute the experiment, we are going to have (slightly) different results. That\u2019s undesirable, as we won\u2019t be able to correctly measure the improvement, or lack of improvement, of the model.", "What we can do is: reduce the (average) RMSD of the model(s). The single best thing to do (for reducing the RMSD of the model) is to remove the outliners of the dataset (in this case).", "We have to take into consideration that: we can improve the results by reducing the RMSD, but we can not reduce it to zero, as it would mean that the model is overfitted.", "Overfitting happens when the model is perfect for a given dataset, which usually implies that the error level with any other dataset will be larger, than a no-overfitted model.", "A good way to evaluate if a model is overfitted is to check the error levels between training and testing datasets and to cross-validate the error taking different data samples.", "Of course, we\u2019ll accept a level of error to avoid overfitting, but neither accept underfitting. It is hard to get to a good middle point. We could keep the search for the perfect middle point, but we won\u2019t in this story, as the objective was \u201cusing MLlib on Spark + Scala\u201d, and it\u2019s been achieved.", "Thanks for reading this story :).", "You can find a (very) small presentation of this story on Prezi: https://prezi.com/tozutehrcojn/?utm_campaign=share&utm_medium=copy", "[4] Jayadevan M. on issues.apache.org, \u201cWhen trying to select from the data frame which contains the columns with . in it, it is throwing exception\u201d (2016), URL: https://issues.apache.org/jira/browse/SPARK-13197", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8107e8390253&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8107e8390253--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8107e8390253--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lwjirl?source=post_page-----8107e8390253--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lwjirl?source=post_page-----8107e8390253--------------------------------", "anchor_text": "Israel Rodrigues"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F506528f39f95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&user=Israel+Rodrigues&userId=506528f39f95&source=post_page-506528f39f95----8107e8390253---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8107e8390253&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8107e8390253&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@thisisengineering?utm_source=medium&utm_medium=referral", "anchor_text": "ThisisEngineering RAEng"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/leonardopena/top50spotify2019", "anchor_text": "Leonardo\u2019s dataset on kaggle.com"}, {"url": "https://creativecommons.org/licenses/by-sa/3.0/", "anchor_text": "Kenneth Jensens image"}, {"url": "https://towardsdatascience.com/crisp-dm-methodology-leader-in-data-mining-and-big-data-467efd3d3781", "anchor_text": "CRIPS-DM\u2019s first two steps"}, {"url": "https://medium.com/@lwjirl", "anchor_text": "Israel Rodrigues"}, {"url": "https://issues.apache.org/jira/browse/SPARK-13197", "anchor_text": "special treatment in Spark"}, {"url": "https://medium.com/@lwjirl", "anchor_text": "Israel Rodrigues"}, {"url": "https://medium.com/@lwjirl", "anchor_text": "Israel Rodrigues"}, {"url": "https://medium.com/@lwjirl", "anchor_text": "Israel Rodrigues"}, {"url": "https://commons.wikimedia.org/wiki/User:Gufosowa", "anchor_text": "Gufosowa"}, {"url": "https://prezi.com/tozutehrcojn/?utm_campaign=share&utm_medium=copy", "anchor_text": "https://prezi.com/tozutehrcojn/?utm_campaign=share&utm_medium=copy"}, {"url": "https://unsplash.com/@thisisengineering", "anchor_text": "ThisisEngineering RAEng"}, {"url": "https://unsplash.com/photos/GzDrm7SYQ0g", "anchor_text": "https://unsplash.com/photos/GzDrm7SYQ0g"}, {"url": "https://en.wikipedia.org/wiki/Cross-industry_standard_process_for_data_mining#/media/File:CRISP-DM_Process_Diagram.png", "anchor_text": "https://es.wikipedia.org/wiki/Cross_Industry_Standard_Process_for_Data_Mining#/media/Archivo:CRISP-DM_Process_Diagram.png"}, {"url": "https://towardsdatascience.com/@lwjirl?source=post_page-----467efd3d3781----------------------", "anchor_text": "Israel Rodrigues"}, {"url": "https://towardsdatascience.com/crisp-dm-methodology-leader-in-data-mining-and-big-data-467efd3d3781", "anchor_text": "https://towardsdatascience.com/crisp-dm-methodology-leader-in-data-mining-and-big-data-467efd3d3781"}, {"url": "https://issues.apache.org/jira/browse/SPARK-13197", "anchor_text": "https://issues.apache.org/jira/browse/SPARK-13197"}, {"url": "https://commons.wikimedia.org/wiki/User:Gufosowa", "anchor_text": "Gufosowa"}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)#/media/File:K-fold_cross_validation_EN.svg", "anchor_text": "https://es.wikipedia.org/wiki/Cross_Industry_Standard_Process_for_Data_Mining#/media/Archivo:CRISP-DM_Process_Diagram.png"}, {"url": "https://medium.com/tag/big-data?source=post_page-----8107e8390253---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8107e8390253---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/spark?source=post_page-----8107e8390253---------------spark-----------------", "anchor_text": "Spark"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8107e8390253---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8107e8390253&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&user=Israel+Rodrigues&userId=506528f39f95&source=-----8107e8390253---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8107e8390253&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&user=Israel+Rodrigues&userId=506528f39f95&source=-----8107e8390253---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8107e8390253&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8107e8390253--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8107e8390253&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8107e8390253---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8107e8390253--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8107e8390253--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8107e8390253--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8107e8390253--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8107e8390253--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8107e8390253--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8107e8390253--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8107e8390253--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lwjirl?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lwjirl?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Israel Rodrigues"}, {"url": "https://medium.com/@lwjirl/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "38 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F506528f39f95&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&user=Israel+Rodrigues&userId=506528f39f95&source=post_page-506528f39f95--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F506528f39f95%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-on-sparks-mllib-8107e8390253&user=Israel+Rodrigues&userId=506528f39f95&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}