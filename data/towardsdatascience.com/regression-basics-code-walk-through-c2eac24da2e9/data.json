{"url": "https://towardsdatascience.com/regression-basics-code-walk-through-c2eac24da2e9", "time": 1683011912.365029, "path": "towardsdatascience.com/regression-basics-code-walk-through-c2eac24da2e9/", "webpage": {"metadata": {"title": "Regression Basics: Code Walk-Through | by Jewel Britton | Towards Data Science", "h1": "Regression Basics: Code Walk-Through", "description": "This article guides you through the basics of regression by showing code and thorough explanations of a full data project using a Kaggle used car dataset. The project utilizes Linear Regression\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/nehalbirla/vehicle-dataset-from-cardekho", "anchor_text": "Kaggle used car dataset", "paragraph_index": 0}, {"url": "https://github.com/jewelbritton/Car-Price-Prediction", "anchor_text": "available on Github", "paragraph_index": 0}, {"url": "https://www.kaggle.com/nehalbirla/vehicle-dataset-from-cardekho", "anchor_text": "Kaggle", "paragraph_index": 1}, {"url": "https://github.com/jewelbritton/Car-Price-Prediction", "anchor_text": "full code on Github", "paragraph_index": 39}, {"url": "https://towardsdatascience.com/classification-basics-walk-through-with-the-iris-data-set-d46b0331bf82", "anchor_text": "check out a guided walk-through of the iris data set to learn the basics of classification", "paragraph_index": 40}], "all_paragraphs": ["This article guides you through the basics of regression by showing code and thorough explanations of a full data project using a Kaggle used car dataset. The project utilizes Linear Regression, Ridge CV, Lasso CV, and Elastic Net CV models to predict sale price. Full code is available on Github.", "The used car dataset is available for download from Kaggle as a CSV file. The information is provided by cardekho, an Indian used car website. Once you have downloaded the CSV file, you can utilize the Pandas library to view and analyze the data.", "The file path inside the quotes will be different depending on where you save the file. On a Mac you can find the file path by right clicking on the file and holding the Option key. An option to \u2018Copy \u2018file.csv\u2019 as Pathname\u2019 should appear, and then you can paste this in the brackets like I have below.", "Now the CSV is saved as a Pandas DataFrame. To see what kind of data we are working with, we can use the code below to view the first 5 rows of the data frame that we just created. If we want to see a specific amount of rows, we can put a number in the brackets to view that many rows (cars.head(10) would show the first 10 rows).", "This allows us to see what the data frame contains, the columns and some examples of the used car details included. Each row is a unique car, and the columns represent the different features of the car. In this project we will use the features to predict the \u2018selling_price\u2019 of each car. To do this, we will use regression, but first we should explore the data and clean it as needed.", "There is not any missing values! Yay. If there is a missing value, it is difficult to model the information correctly. Usually there are lots of missing values in datasets, and in order to model the data we will either delete the row with the missing values or replace that instance with another value (mean, previous value\u2026).", "The next step in exploring the data is to see what types of data are stored in the columns. This is helpful for noticing if a column that appears to be filled with numbers is incorrectly coded as an \u2018object\u2019. If this is the case you can easily change the data type so that the computer correctly understands the information you are providing.", "float = numbers with decimals (1.678)int = integer or whole number without decimals (1, 2, 3)obj = object, string, or words (\u2018hello\u2019)The 64 after these data types refers to how many bits of storage the value occupies. You will often seen 32 or 64.", "The data types all look correct based on the first few rows of the data frame we have seen so far.", "This table gives us an overview of statistical information regarding the numerical data columns. Since only three of the columns are integers or floats, we only see these three listed on the chart. If the numerical data had incorrectly been coded as \u2018objects\u2019 we would not be able to view the statistical information on the columns.", "Using this table, we can see different values such as the mean, min, max and standard deviation. This table is useful for giving a quick overview of the data in the columns, and may allow us to identify outliers. For instance, when I was first looking at this table I thought that an average price of $500,000 for a used car was incredibly high. But then I looked at the data source and realized that the data is for an Indian company, and 500,000 rupees is about $6,600. Much more reasonable!", "Another thing that stood out from this table is that the minimum value for km_driven was 1 kilometer. That seemed very low for a used car, so I wanted to investigate this car further. To do this, we can sort the data frame by lowest to highest number of kilometers driven.", "The car at the top is the one with 1km on it, and since the car has had at least two owners and is from 2014, it does not seem realistic that it would only have 1 kilometer on it. This may be an outlier, or the data could have been entered incorrectly, so to be safe I will delete this row.", "Using the Seaborn library, we can also visualize the correlations between different features. The correlations will only register for the columns with numerical data, but it is still helpful to investigate correlations the relationships between these features.", "The information we gain from this correlation chart makes sense intuitively, and may confirm some of our beliefs \u2014 which is always good to see. Year and selling price are relatively positively correlated, so as year increases so will the sale price. Year and kilometers driven are negatively correlated, so as the car gets older there will be more kilometers driven on it.", "Now that we have taken a closer look at the data and the statistics that surround it, we can prepare our data for modeling.", "The \u2018name\u2019 column in the data frame is very specific, and when we are modeling on a relatively limited data set it is sometimes better to be more vague. This allows the model to make predictions based on more past samples. To investigate the variety of car names in the data, we can use the code below to count how many of each car name is included.", "There are over 1400 different car names included, and many have less that 30 examples. Our model will have a hard time predicting sale price if there is only a couple examples of each car. In order to make this a more general feature, we can just include the brand of the car. Luckily the brand name is the first word in each of the rows, so we can create a new feature with just the car brand names.", "Since this column now just has the brand name there is a lot less than 1400 different values, and many have over 30 different cars. At this point you could still choose to delete the rows that have car brands that only have 1 or 2 cars (Force, Isuzu, Kian, Daewoo\u2026), but I will leave these in for now. We have already limited the variety dramatically so our model should be stronger now.", "The last step before we can model on the features is to create binary columns for the features that are not numerical. It is hard for the computer to understand the difference in meaning between all the car names, so binarizing simply tells the computer \u201cyes this is a Volvo,\u201d or \u201cno, this is not a Volvo.\u201d", "Binarizing creates a specific column for each car brand, and then each row will have a 0 (not that car brand) or a 1 (it is that car brand). This process of creating binary columns for each feature is also called \u2018dummifying\u2019 the variable, and can be done easily with code in Pandas.", "With the dummy/binary columns, the data frame now looks like this \u2014 filled with columns of 0s and 1s, except for the three numerical columns. Although there are many more columns, this process makes it possible for the model to understand the information you are providing it with.", "Now (finally) we can model our data to predict the sale price of these used cars.", "First, we need to define our X and y variables. Y is what we are predicting (sale price) and X is everything we are using to help us make this prediction.", "Next we need to create a training and test group for our model. We can use the code below to randomly select 70% of the data as the train group for our model to train on, and 30% will remain as our test group to test the quality of our model.", "Finally, we will need to standardize all the X values so that they are on a consistent scale. This will not change the proportionate relationship between the numbers.", "The first model we will try is a simple Linear Regression. It is important to assess the cross validation score, training score, and test score to reflect on how the model is performing.", "Since the training score was much better than the test, it indicates that the model was overfitting to the training data. This means that the model has a very hard time predicting on unseen data \u2014 not good! Also, the mean cross validation score is a very large negative number. In theory we want all three of these scores to be as close to 1.0 as possible, but since the scores are so bad for this model, we can try some other regression models that also regularize the data.", "Ridge regression is one way to regularize the variables, and is often helpful when dealing with collinearity. Ridge is typically useful when there is a large number of features, and many/all of them impact the target variable in a similar strength. When doing any regression problem it is good practice to try out any and all of these models to see what performs the best. With the RidgeCV model we can also set a range of alpha values to try and the model will chose the best.", "Now all three scores are roughly the same, within a few decimals. Since these scores are much better than the Linear Regression scores, so we can assume that the regularization was helpful for modeling.", "Another way we can regularize our features is by using Lasso. This regularization is often helpful for reducing collinearity when there are many features that have almost no impact on the target variable. Lasso will level these out to zero, and only keep the features that strongly impact the predictions. Again, it is always best to try all models and see which ends up working best for your model.", "The Lasso scores are very similar to Ridge, but the mean CV score is slightly higher. A good metric for comparing models is either the mean CV or the test score.", "The last model we will test is Elastic Net CV, which creates a combination of Lasso and Ridge regularizations.", "All three of the regularized models scored relatively similar, but by a small margin (.001), Lasso CV performed the best when comparing mean cross validation scores. Let\u2019s look a bit closer at the Lasso model and how it made its predictions.", "Viewing the coefficients can show us which features had the most (or least) impact on how the model made predictions. The chart below shows the features that had the largest positive impact on the sale price of a car. For instance, being a BMW, Mercedes, or Audi would cause the sale price to increase \u2014 as would being a newer car. By changing the ascending to \u2018False\u2019, we could also view the features that negatively impact price.", "Another way we could evaluate our model is by looking at what the model predicted compared to what the actual value was. This shows us where our model is making mistakes, and how wrong its predictions were. We can view this in a data frame, or we can transfer this information to a graph that contrasts the actual and predicted values.", "From these values we can see that our model does a decent job of creating accurate predictions, but there are many outliers that don\u2019t seem to conform to our model.", "One last way we can evaluate our model\u2019s performance is by calculating the root MSE. This is the sum of all the squared residuals, and then the square root of that value. This tells us how far off our predictions are on average.", "The root MSE for this model was 327,518.584, which would be the equivalent of $4,370. While we always want to minimize this value, being able to predict a used car\u2019s price within about $4,000 is not a bad accomplishment. Using this model, the car company could reasonably price their cars based only on details such as the brand, kilometers driven, fuel type, and year.", "Hopefully this was a helpful data project walk-though that guided you through some of the fundamentals of EDA, regression, and modeling in Python. Check out the full code on Github for more details.", "If you\u2019re ready for the next step, check out a guided walk-through of the iris data set to learn the basics of classification.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Architectural Designer turned Data Scientist pursuing the vast applications of data to improve our built environment. MSc Geographic Data Science @ Birkbeck UoL"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc2eac24da2e9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jewelbritton9?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jewelbritton9?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": "Jewel Britton"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdd800d2dd48e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&user=Jewel+Britton&userId=dd800d2dd48e&source=post_page-dd800d2dd48e----c2eac24da2e9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc2eac24da2e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc2eac24da2e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@danielcgold?utm_source=medium&utm_medium=referral", "anchor_text": "Dan Gold"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/nehalbirla/vehicle-dataset-from-cardekho", "anchor_text": "Kaggle used car dataset"}, {"url": "https://github.com/jewelbritton/Car-Price-Prediction", "anchor_text": "available on Github"}, {"url": "https://www.kaggle.com/nehalbirla/vehicle-dataset-from-cardekho", "anchor_text": "Kaggle"}, {"url": "https://github.com/jewelbritton/Car-Price-Prediction", "anchor_text": "full code on Github"}, {"url": "https://towardsdatascience.com/classification-basics-walk-through-with-the-iris-data-set-d46b0331bf82", "anchor_text": "check out a guided walk-through of the iris data set to learn the basics of classification"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c2eac24da2e9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/regression?source=post_page-----c2eac24da2e9---------------regression-----------------", "anchor_text": "Regression"}, {"url": "https://medium.com/tag/exploratory-data-analysis?source=post_page-----c2eac24da2e9---------------exploratory_data_analysis-----------------", "anchor_text": "Exploratory Data Analysis"}, {"url": "https://medium.com/tag/basics?source=post_page-----c2eac24da2e9---------------basics-----------------", "anchor_text": "Basics"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----c2eac24da2e9---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc2eac24da2e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&user=Jewel+Britton&userId=dd800d2dd48e&source=-----c2eac24da2e9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc2eac24da2e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&user=Jewel+Britton&userId=dd800d2dd48e&source=-----c2eac24da2e9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc2eac24da2e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc2eac24da2e9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c2eac24da2e9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c2eac24da2e9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jewelbritton9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jewelbritton9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jewel Britton"}, {"url": "https://medium.com/@jewelbritton9/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "40 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdd800d2dd48e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&user=Jewel+Britton&userId=dd800d2dd48e&source=post_page-dd800d2dd48e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F418e40807beb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fregression-basics-code-walk-through-c2eac24da2e9&newsletterV3=dd800d2dd48e&newsletterV3Id=418e40807beb&user=Jewel+Britton&userId=dd800d2dd48e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}