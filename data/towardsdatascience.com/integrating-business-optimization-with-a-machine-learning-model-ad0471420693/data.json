{"url": "https://towardsdatascience.com/integrating-business-optimization-with-a-machine-learning-model-ad0471420693", "time": 1683000132.4184341, "path": "towardsdatascience.com/integrating-business-optimization-with-a-machine-learning-model-ad0471420693/", "webpage": {"metadata": {"title": "Integrating business optimization with a machine learning model | by Tirthajyoti Sarkar | Towards Data Science", "h1": "Integrating business optimization with a machine learning model", "description": "We illustrate the concept of integrating a business metric optimization with a machine learning pipeline. Demo with code is shown."}, "outgoing_paragraph_urls": [{"url": "https://www.forbes.com/sites/allbusiness/2018/10/20/machine-learning-artificial-intelligence-could-transform-business/", "anchor_text": "bringing once-in-a-lifetime transformative changes", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/boosting-algorithm-adaboost-b6737a9ee60c", "anchor_text": "AdaBoost classifier", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/AdaBoost", "anchor_text": "AdaBoost", "paragraph_index": 11}, {"url": "http://www.learnbymarketing.com/481/decision-tree-flavors-gini-info-gain/", "anchor_text": "Gini index", "paragraph_index": 11}, {"url": "https://machinelearningmastery.com/boosting-and-adaboost-for-machine-learning/", "anchor_text": "ensemble techniques like Boosting", "paragraph_index": 12}, {"url": "https://www.investopedia.com/terms/e/eva.asp", "anchor_text": "economic value added", "paragraph_index": 19}, {"url": "https://github.com/tirthajyoti/Machine-Learning-with-Python/blob/master/Business_optimization/Self_optimizing_ML_simple_example.ipynb", "anchor_text": "code for this demo from the Github repo here", "paragraph_index": 35}, {"url": "https://en.wikipedia.org/wiki/Marginal_return", "anchor_text": "Marginal Rate of Return", "paragraph_index": 41}, {"url": "https://github.com/tirthajyoti/Machine-Learning-with-Python/blob/master/Business_optimization/Self_optimizing_ML_simple_example.ipynb", "anchor_text": "Github repo", "paragraph_index": 45}, {"url": "https://towardsdatascience.com/optimization-with-scipy-and-application-ideas-to-machine-learning-81d39c7938b8", "anchor_text": "one of my previous articles", "paragraph_index": 49}, {"url": "https://github.com/tirthajyoti?tab=repositories", "anchor_text": "GitHub", "paragraph_index": 50}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "add me on LinkedIn", "paragraph_index": 50}, {"url": "https://twitter.com/tirthajyotiS", "anchor_text": "follow me on Twitter.", "paragraph_index": 50}], "all_paragraphs": ["Machine learning (ML) is in serious demand. This branch of AI is upending traditional and modern business practices and bringing once-in-a-lifetime transformative changes.", "However, scholarly discussions and online articles about ML algorithms, tools, and techniques, often focus exclusively on their implementation, performance, deployment, and scalability.", "The business side of ML is also discussed at length, but often those discussions are somewhat distant from the core algorithm or the ML pipeline. It is not easy to find a simple illustration of an ML pipeline which integrates the dual goal of achieving decent ML performance and satisfying a fairly common and intuitive business objective.", "However, large corporations are constantly doing this very integration in their operations \u2014 applying ML and tuning the pipeline to propel it toward satisfying the overall business objective (or a subset thereof).", "For young data science and ML practioners, hwoever, it is not very intuitive, how to demonstrate this idea with a simple enough example \u2014 perhaps a few lines of code.", "In this article, we show one such example.", "For the case illustration, we will imagine a very simple scenario \u2014 a brand new startup company generates revenue by offering ML-based predictive analytics.", "In particular, they receive a data stream and predict a binary class as output \u2014 \u2018Yes\u2019 or \u2018No\u2019. At the core of their service, they use a decision tree-based classification model with an ensemble technique \u2014 using AdaBoost classifier.", "Higher the accuracy of their prediction, higher the revenue.", "Of course, one can make a random prediction (without any model underneath) and still get about 50% prediction right. So, they only get paid for higher accuracy above a certain threshold, which can be as low as 50%. For example, if their prediction accuracy is 75% for some a job, then they get paid a revenue proportional to 75% \u2014 50% = 25%.", "But how do they achieve higher accuracy?", "An easy and intuitive answer is by tuning the hyperparameters of the algorithm. There are quite a few hyperparameters in an algorithm like AdaBoost \u2014 mostly related to the underlying base estimator. For a decision tree, these can be the minimum number of samples per leaf, maximum tree depth, splitting criterion like Gini index, etc. However, to keep this case illustration simple, we choose the most intuitive hyperparameter \u2014 the number of tree estimators applied to the boosting.", "At their core, ensemble techniques like Boosting work by keeping the base estimator relatively simple and low accuracy (slightly above 50% is fine). They achieve a robust generalization power by employing a large number of such simple base estimators in parallel and averaging their predictions and dynamically updating focus on the examples that the estimators got wrong in the previous iteration.", "It should be, therefore, no surprise that a higher number of base estimators may lead to greater generalization power \u2014 higher accuracy on the customer data (the true unknown test set).", "Previously, we established the simple scenario that revenue is directly proportional to the level of accuracy in the predictions for the customer-supplied data.", "So, it seems that the strategy to maximize ML model accuracy, and thereby, maximize the revenue of the company, is to keep the individual base estimators real simple \u2014 choosing the maximum depth of trees something like 2 or 3 \u2014 and employing a large number of them.", "It seems a straightforward strategy. But, it may not be an optimum one.", "Revenue is not profit. In all likelihood, the young startup company would like to maximize profit and not just focus on revenue because that shows their long-term viability and help get them more investment and more customers.", "Let\u2019s drill down to the profit aspect a bit.", "Profit is the king (in most business situations anyway) and a very good indicator of the economic value added for most types of business. Nobody likes it better when they can earn a decent revenue with a low operating cost.", "We understand the relationship between the ML model and the revenue. But, how is the operating cost related to the model?", "In a real-life scenario, it can be pretty complicated. But for the sake of case illustration, we can simply assume that the cost is proportional to the total compute time for model fitting and prediction.", "This is not very hard to imagine, as the case would be similar if the young startup firm had rented some kind of cloud service to host and run their ML algorithms e.g. AWS EC2, which is billed based on the total compute time.", "Now, do you remember the hyperparameter of interest \u2014 number of base estimators for the Boosting algorithm? The bad news is that bigger this number, larger is the computational load for the algorithm, and higher the compute time for model fitting and prediction.", "Thereby, we identify the key relationships \u2014 between a single hyperparameter of the ML algorithm and two business metrics \u2014 revenue and cost.", "And what is profit? It is the good old definition,", "This is somewhat different than traditional discussions on ML algorithmic choice, isn\u2019t it? You may have done the following many times,", "And, all of these are still critically important.", "But, from a business perspective, it could well be the case that the only thing you will be judged on, is how much profit your ML algorithm could generate. If it is a large positive number, higher management, most likely, won\u2019t grill you on the algorithmic details. If it is negative, all hell may break loose!", "So, we must do the following balancing act,", "We constructed an extremely simplistic scenario, but at least, it shows that there is a fair chance that an algorithmic choice can be strongly coupled to a key business metric.", "And what do good engineers do when they have a model parameter, which, impacts two outputs (accuracy and cost in our case) simultaneously?", "They try to find the optimum setting of that model parameter which will maximize the business metric \u2014 profit in this case.", "Let\u2019s see how this can be done through a simple code demo.", "Code is, in fact, tedious to follow and can be distracting. Ideas and pictures are much better :-)", "Therefore, I\u2019ll let you fork and copy the code for this demo from the Github repo here. But the main idea is as follows,", "The hyperparameter of interest \u2014 the number of decision tree estimators \u2014 has been coded as an argument to an objective function, which an optimizer algorithm can minimize. The objective function value is computed taking into account both the Boosting algorithm accuracy on the validation set and a simple cost term proportional to the time it takes for model fitting and prediction.", "Here is how the training and validation set accuracy varies with the number of decision tree estimators.", "And here is the computation time (model fit and prediction),", "Clearly, the accuracy starts at a low value for a small number of estimators but saturates after that number reaches a certain level. On the other hand, the computational load keeps on increasing.", "Therefore, it does not make sense to keep increasing the number of estimators as the marginal rate of return (in terms of improving accuracy) peaks at a certain level and then goes down.", "Ah\u2026 there it is\u2026 the famous Marginal Rate of Return, which is so near and dear to business folks.", "Machine learning scientists, engineers, and business development teams finally have a common concept to ponder over, a common metric to plot and make decisions with.", "To illustrate this behavior more clearly, we make up an objective function \u2014 which integrates both the accuracy and computing cost in a single scalar output by combining the validation set accuracy and the compute time in a linear function with proper weights. The MRR behavior can be clearly seen if we plot the objective function,", "It is easy to see that the coefficient of accuracy is a positive number in this equation whereas the coefficient of the compute time is a negative number to reflect the true nature of the objective \u2014 cost subtracted from the revenue.", "In the Github repo, I also show how to solve the optimization by calling a function from the Scipy package. For this particular example, the objective function is extremely simple and a simple plot will show the evolution to determine that the optimum number of trees to include in the ML algorithm is around 10 or 11. So, the use of a Scipy function is really not needed.", "But the same idea can be extended to a more complicated objective function which encompasses a plethora of ML hyperparameters. And then, the full power of optimization algorithms can be brought to bear to solve the business-centric optimization.", "See this article for Scipy optimization algorithms discussion,", "In this article, we talked about business-centric optimization. A simple demo was discussed to illustrate the idea clearly \u2014 that often, the choice of ML algorithms and their settings, need to be guided by an overarching goal of business metric optimization. In this endeavor, wrapping the core ML algorithm with an optimization loop could be extremely handy for quick decision making.", "In fact, in one of my previous articles, I talked about how this idea does not need to be restricted to a single type of machine learning, or even a single type of analytics process but can span over a variety of quantitive disciplines \u2014 ML model, statistical estimation, stochastic simulation, etc. \u2014 all feeding to a common optimization engine.", "If you have any questions or ideas to share, please contact the author at tirthajyoti[AT]gmail.com. Also, you can check the author\u2019s GitHub repositories for other fun code snippets in Python, R, or MATLAB and machine learning resources. If you are, like me, passionate about machine learning/data science, please feel free to add me on LinkedIn or follow me on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Sr. Director of AI/ML platform | Stories on Artificial Intelligence, Data Science, and ML | Speaker, Open-source contributor, Author of multiple DS books"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fad0471420693&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad0471420693--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad0471420693--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----ad0471420693--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=post_page-----ad0471420693--------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a----ad0471420693---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad0471420693&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad0471420693&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.forbes.com/sites/allbusiness/2018/10/20/machine-learning-artificial-intelligence-could-transform-business/", "anchor_text": "bringing once-in-a-lifetime transformative changes"}, {"url": "https://www.forbes.com/sites/allbusiness/2018/10/20/machine-learning-artificial-intelligence-could-transform-business/#7815726cc6c3", "anchor_text": "The Machine Learning Revolution: How Artificial Intelligence Could Transform Your BusinessWith a technology as impactful as machine learning (ML), it can be difficult to avoid hyperbole. Sure, billions of\u2026www.forbes.com"}, {"url": "https://towardsdatascience.com/boosting-algorithm-adaboost-b6737a9ee60c", "anchor_text": "AdaBoost classifier"}, {"url": "https://en.wikipedia.org/wiki/AdaBoost", "anchor_text": "AdaBoost"}, {"url": "http://www.learnbymarketing.com/481/decision-tree-flavors-gini-info-gain/", "anchor_text": "Gini index"}, {"url": "https://machinelearningmastery.com/boosting-and-adaboost-for-machine-learning/", "anchor_text": "ensemble techniques like Boosting"}, {"url": "https://www.researchgate.net/journal/1932-4545_IEEE_Transactions_on_Biomedical_Circuits_and_Systems", "anchor_text": "IEEE Transactions on Biomedical Circuits and Systems"}, {"url": "https://www.investopedia.com/terms/e/eva.asp", "anchor_text": "economic value added"}, {"url": "https://towardsdatascience.com/accuracy-precision-recall-or-f1-331fb37c5cb9", "anchor_text": "accuracy/precision/recall? F1 score"}, {"url": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5", "anchor_text": "ROC curve and AUC"}, {"url": "https://github.com/tirthajyoti/Machine-Learning-with-Python/blob/master/Business_optimization/Self_optimizing_ML_simple_example.ipynb", "anchor_text": "code for this demo from the Github repo here"}, {"url": "https://en.wikipedia.org/wiki/Marginal_return", "anchor_text": "Marginal Rate of Return"}, {"url": "https://github.com/tirthajyoti/Machine-Learning-with-Python/blob/master/Business_optimization/Self_optimizing_ML_simple_example.ipynb", "anchor_text": "Github repo"}, {"url": "https://towardsdatascience.com/optimization-with-scipy-and-application-ideas-to-machine-learning-81d39c7938b8", "anchor_text": "Optimization with SciPy and application ideas to machine learningWe show how to perform optimization with the most popular scientific analysis package in Python \u2014 SciPy, and discuss\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/optimization-with-scipy-and-application-ideas-to-machine-learning-81d39c7938b8", "anchor_text": "one of my previous articles"}, {"url": "https://github.com/tirthajyoti?tab=repositories", "anchor_text": "GitHub"}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "add me on LinkedIn"}, {"url": "https://twitter.com/tirthajyotiS", "anchor_text": "follow me on Twitter."}, {"url": "https://www.linkedin.com/in/tirthajyoti-sarkar-2127aa7/", "anchor_text": "Tirthajyoti Sarkar - Sr. Principal Engineer - Semiconductor, AI, Machine Learning - ON\u2026Making data science/ML concepts easy to understand through writing: https://medium.com/@tirthajyoti Open-source and fun\u2026www.linkedin.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ad0471420693---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/technology?source=post_page-----ad0471420693---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ad0471420693---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ad0471420693---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/business?source=post_page-----ad0471420693---------------business-----------------", "anchor_text": "Business"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad0471420693&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----ad0471420693---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad0471420693&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=-----ad0471420693---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad0471420693&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad0471420693--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fad0471420693&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ad0471420693---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad0471420693--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ad0471420693--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ad0471420693--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ad0471420693--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ad0471420693--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ad0471420693--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ad0471420693--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ad0471420693--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tirthajyoti?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tirthajyoti Sarkar"}, {"url": "https://medium.com/@tirthajyoti/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12.5K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb9d97d4b61a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=post_page-cb9d97d4b61a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb285331282ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintegrating-business-optimization-with-a-machine-learning-model-ad0471420693&newsletterV3=cb9d97d4b61a&newsletterV3Id=b285331282ca&user=Tirthajyoti+Sarkar&userId=cb9d97d4b61a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}