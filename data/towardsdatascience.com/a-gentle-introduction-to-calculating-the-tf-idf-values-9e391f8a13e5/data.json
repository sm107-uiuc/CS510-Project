{"url": "https://towardsdatascience.com/a-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5", "time": 1683011007.827472, "path": "towardsdatascience.com/a-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5/", "webpage": {"metadata": {"title": "A Gentle Introduction To Calculating The TF-IDF Values | by Ann Sebastian | Towards Data Science", "h1": "A Gentle Introduction To Calculating The TF-IDF Values", "description": "As you skimmed through the title and subtitle above, you have already formed the idea that this post is fairly technical. Most likely, you are going to skim through this post first, glance at the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Word2vec", "anchor_text": "word embedding", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1801.06146", "anchor_text": "language models", "paragraph_index": 4}, {"url": "https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge", "anchor_text": "a large collection of research documents", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Rumi", "anchor_text": "Rumi", "paragraph_index": 7}, {"url": "https://twitter.com/TerribleMaps/status/1129765180987117569", "anchor_text": "tweet", "paragraph_index": 23}, {"url": "https://twitter.com/TerribleMaps", "anchor_text": "Terrible Maps", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Division_by_zero", "anchor_text": "divide by 0", "paragraph_index": 27}, {"url": "https://en.wikipedia.org/wiki/Norm_(mathematics)", "anchor_text": "Wikipedia", "paragraph_index": 41}, {"url": "https://github.com/annts/tf-id_demystified/blob/master/tf_idf_demo.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 51}, {"url": "https://medium.com/@tylerneylon/how-to-write-mathematics-on-medium-f89aa45c42a0", "anchor_text": "How to write mathematics on medium", "paragraph_index": 52}], "all_paragraphs": ["As you skimmed through the title and subtitle above, you have already formed the idea that this post is fairly technical. Most likely, you are going to skim through this post first, glance at the titles before deciding whether you want to read the entire article. Maybe, the formula and the code will entice you to read this article. Or, maybe it will cause you to put off reading this post. As you can see, you have a great mechanism to process text quite efficiently.", "In the field of Natural Language Processing, we are in trying to get the algorithms to understand the text. Most algorithms are mathematical functions.So, they need a representation of text as numbers to work effectively.This article drills down into a pretty old mechanism to represent text as numbers called TF-IDF a.k.a Term Frequency Inverse Document Frequency.", "Intuitively, to understand what text is about, we look for words that occur frequently. Term frequency covers that aspect by capturing the number of times each word occurs in the text. However, in this article, there are 200+ occurrences of the word \u2018the\u2019 and only 55 occurrences of the word TF (which includes the code used as well). To downgrade the relative importance of words that occur all too frequently, an inverse weighting is introduced to scale down the words that occur too frequently. This inverse weighting is referred to as Inverse Document Frequency. Together, TF-IDF captures the relative importance of words in a set of documents or a collection of texts.", "There are many great articles written on the intuition behind TF-IDF and not many written on how to derive the exact values for TF-IDF. The focus of this article is to piece together various calculations involved and provide how to derive each step with python code so that you can derive it on the texts you are working with.", "In the field of Natural Language Processing, discoveries of word embedding in 2013 and language models in 2018 have changed the landscape and led to many exciting developments in NLP. So, it seems a bit strange that here in 2020, I have chosen to write 2000+ words about TF IDF which was first formulated in the 1970s. Here are my 2 reasons on why I think it is good to understand the underlying calculations.", "We will be using a beautiful poem by the mystic poet and scholar Rumi as our example corpus. First, we will calculate TF IDF values for the poem using TF IDF Vectorizer from the sklearn package. Then, we will pull apart the various components and work through various steps involved in calculating TF-IDF values. Mathematical calculations and Python code will be provided for each step.", "To illustrate the concept of TF-IDF, we need a corpus. A corpus is a collection of documents. In a typical Natural Language Processing problem, a corpus can vary from a list of call center logs/ transcripts, a list of social media feedback to a large collection of research documents.", "To illustrate the various steps involved, we need to keep the corpus as small as possible so that the matrices fit neatly on a page. I chanced upon this quote / beautiful poem from the 13th-century Persian poet and Sufi mystic Rumi (Jal\u0101l ad-D\u012bn Muhammad R\u016bm\u012b) and it fits our use case perfectly. So, we will be using this poem as our list of documents with each sentence considered as a document.", "Isn\u2019t that a really beautiful poem? It\u2019s good to uplift ourselves as we power through code and a little math.", "We represent the 8 sentences above as a list of strings in Python.", "We will be decimating the beautiful poem into mysterious decimals in this step. But, hey, after all, we are trying to demystify these decimals by understanding the calculations involved in TF-IDF. As mentioned before, it is quite easy to derive through sklearn package.", "In the matrix below, each row represents a sentence from the above poem. Each column represents a unique word in the poem in alphabetical order. As you can see, there are lot of zeros in the matrix. So, a memory-efficient sparse matrix is used for representing this. I have converted it to a data frame for ease of visualization.", "Let us interpret the numbers we have received so far. As you may have noticed, the words \u201cyou were born\u201d are repeated throughout the poem. So, we anticipate that these words will not be getting high TF-IDF scores. If you look at the values for those three words, you can see that most often they get between 0.2 and 0.3.", "Let us look at Document 0\u2014 You were born with potential. The word potential stands out. If you look at the various TF-IDF values in the first row in the matrix, you will see that the word potential has the highest TF-IDF value.", "Let us look at Document 4 (row 5): You were born with wings. Again, same as before, the word \u201cwings\u201d has the highest value in that sentence.", "Notice that the word \u201cwings\u201d appears also in Document 6. TF-IDF value for the word \u201cwings\u201d in Document 6 is different to TF-IDF value for the word \u201cwings\u201d in Document 4. In Document 6, the word \u201cwings\u201d is deemed less important than the word \u201chave\u201d in Document 6.", "The objective of this article is to look at how the above TF-IDF values can be calculated from scratch. We will be focusing on applying the calculations on the words wings and potential in particular, to derive the values highlighted in red in the matrix displayed above.", "We will break apart the various components and then put them back together. We will do this in three steps:", "The term frequency is pretty straight forward. It is calculated as the number of times the words/terms appear in a document.", "For the sentences, \u201cyou were born with potential\u201d and \u201cyou were born with wings\u201d, the following are the term frequency values.", "Extending the same, to all 8 sentences in the poem, we get the following word count matrix. As before, rows represent sentences and columns represent words in the poem ordered alphabetically. Count Vectorizer returns a sparse matrix that is converted to a data frame for the ease of visualization.", "The above is calculated by the following code.", "Let us find out term frequency for the words potential and wings.", "However, if we just take the term frequency as a measure of importance, we fall into one major pitfall as represented by the tweet below from Terrible Maps representing the most frequent word in each state in the United States.", "We need a mechanism to tone down the relative importance of the words that occur all too frequently in all the documents. Enter the Inverse Document Frequency. Intuitively, if a word appears in all documents, then it may not play such a big part in differentiating between the documents.", "Document Frequency(term t) = number of documents with the term t/ total number of documents = d(t)/n", "Inverse Document Frequency = total number of documents / number of documents with the term t = n / d(t)", "If a word appears in all the documents, we want it at the bottom of the range of 0\u20131. So, a logarithmic scale intuitively makes sense to be used here as log 1 is 0. However, there are some practical considerations such as avoiding the infamous divide by 0 error, 1 is added to the denominator.", "Inverse Document frequency for the default settings in TF IDF vectorizer in sklearn is calculated as below (default settings have smooth_idf=True that adds \u201c1\u201d to the numerator and denominator as if an extra document was seen containing every term in the collection exactly once, which prevents zero divisions).", "Let us identify the individual values for the words \u2014 potential and wings.", "Applying the formula for Inverse Document Frequency, we get", "IDF values for the poem can be obtained by running the following Python code.", "We obtain the values as shown below and we can cross-check the values from our calculations for the words potential and wings. Note that there is only one IDF value for a word in the corpus.", "As the name implies TF-IDF is a combination of Term Frequency(TF) and Inverse Document Frequency(IDF), obtained by multiplying the 2 values together. The sklearn implementation then applies normalization on the product between TF and IDF. Let us look at each of those steps in detail.", "In multiplying the 2 matrices together, we take an element-wise multiplication of Term Frequency Matrix and Inverse Document Frequency. Consider the first sentence \u2014 \u201cYou were born with potential\u201d. To find the product of TF and IDF for this sentence, it is calculated as below.", "This can be done by the following code for the entire data frame:", "Applying it to the corpus, we get the following matrix:", "You may notice that the product of TF and IDF can be above 1. Now, the last step is to normalize these values so that TF-IDF values always scale between 0 and 1.", "In day to day life, when we want to normalize the values so that we can compare them easily, we use percentages or proportions. So, we could hypothetically calculate a proportion of TF-IDF values across various words in a sentence. Please note that both TF and IDF are non-negative values as the lowest value possible for Term Frequency and Inverse Document Frequency is 0. So, taking out proportions would be equivalent to what is known as L1 normalization. In L1 normalization each element in a vector(think various TF-IDF values of a sentence) is divided by sum of absolute values all elements. There is an option to L1 normalize the values in sklearn, but that is not the default setting.", "In sklearn, the default normalization applied is L2 normalization. Easiest way to think about L2 normalization is to think about the length of a line or Pythagoras theorem with one of the corners of the triangle at the origin.", "In the diagram above, the length of the line is 5. In this case, the line is a 1D vector. When vectors are n-dimensional, the length of the vector is similar to the length of a line but extended to n dimensions. So, if a vector v is composed of n-elements, the length of the vector is calculated as", "In L2 normalization, we are essentially dividing the vector by the length of the vector. For a more mathematical explanation of L1 and L2 norm, please refer to Wikipedia.", "To apply L2 norm, for each of the sentences we need to calculate the square root of the sum of squares of the product of TF and IDF.", "It can be done in Python as below:", "Finally, we are ready to calculate the final TF-IDF scores!", "This can be calculated with the following code.", "When you run the above code, you get the results as below, which is same as the matrix in the Looking Ahead to the Output section above.", "So, far we have done the following", "The main limitation of TF IDF is that word order which is an important part of understanding the meaning of a sentence is not considered in TF-IDF.", "Also, document length can introduce a lot of variance in the TF IDF values.", "The following are the assumptions and conventions used in this post.", "Jupyter notebook used for calculating TF-IDF values is available in GitHub.", "[3] How to write mathematics on medium", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Going on a data science career journey, sharing the lessons learned, insights gained and concepts applied."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9e391f8a13e5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ann.t.sebastian?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ann.t.sebastian?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": "Ann Sebastian"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f0f2691dbc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&user=Ann+Sebastian&userId=1f0f2691dbc0&source=post_page-1f0f2691dbc0----9e391f8a13e5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e391f8a13e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e391f8a13e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/geralt-9301/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1327493", "anchor_text": "Gerd Altmann"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=1327493", "anchor_text": "Pixabay"}, {"url": "https://pixabay.com/users/jarmoluk-143740/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=436501", "anchor_text": "Michal Jarmoluk"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=436501", "anchor_text": "Pixabay"}, {"url": "https://en.wikipedia.org/wiki/Word2vec", "anchor_text": "word embedding"}, {"url": "https://arxiv.org/abs/1801.06146", "anchor_text": "language models"}, {"url": "https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge", "anchor_text": "a large collection of research documents"}, {"url": "https://en.wikipedia.org/wiki/Rumi", "anchor_text": "Rumi"}, {"url": "https://twitter.com/TerribleMaps/status/1129765180987117569", "anchor_text": "tweet"}, {"url": "https://twitter.com/TerribleMaps", "anchor_text": "Terrible Maps"}, {"url": "https://en.wikipedia.org/wiki/Division_by_zero", "anchor_text": "divide by 0"}, {"url": "https://en.wikipedia.org/wiki/Norm_(mathematics)", "anchor_text": "Wikipedia"}, {"url": "https://github.com/annts/tf-id_demystified/blob/master/tf_idf_demo.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://scikit-learn.org/stable/modules/feature_extraction.html", "anchor_text": "scikit-learn documentation"}, {"url": "https://developers.google.com/machine-learning/guides/text-classification/step-2-5", "anchor_text": "Text Classification Framework"}, {"url": "https://medium.com/@tylerneylon/how-to-write-mathematics-on-medium-f89aa45c42a0", "anchor_text": "How to write mathematics on medium"}, {"url": "https://medium.com/tag/nlp-machine-learning?source=post_page-----9e391f8a13e5---------------nlp_machine_learning-----------------", "anchor_text": "Nlp Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9e391f8a13e5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----9e391f8a13e5---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e391f8a13e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&user=Ann+Sebastian&userId=1f0f2691dbc0&source=-----9e391f8a13e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9e391f8a13e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&user=Ann+Sebastian&userId=1f0f2691dbc0&source=-----9e391f8a13e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9e391f8a13e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9e391f8a13e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9e391f8a13e5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9e391f8a13e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ann.t.sebastian?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ann.t.sebastian?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ann Sebastian"}, {"url": "https://medium.com/@ann.t.sebastian/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "33 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f0f2691dbc0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&user=Ann+Sebastian&userId=1f0f2691dbc0&source=post_page-1f0f2691dbc0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb41aaa15e23a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-gentle-introduction-to-calculating-the-tf-idf-values-9e391f8a13e5&newsletterV3=1f0f2691dbc0&newsletterV3Id=b41aaa15e23a&user=Ann+Sebastian&userId=1f0f2691dbc0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}