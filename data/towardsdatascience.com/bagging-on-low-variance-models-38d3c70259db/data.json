{"url": "https://towardsdatascience.com/bagging-on-low-variance-models-38d3c70259db", "time": 1683015053.820847, "path": "towardsdatascience.com/bagging-on-low-variance-models-38d3c70259db/", "webpage": {"metadata": {"title": "Bagging on Low Variance Models. \u2018A curious case of bagging on simple\u2026 | by Akshay Amrit | Towards Data Science", "h1": "Bagging on Low Variance Models", "description": "Bagging (also known as bootstrap aggregation) is a technique in which we take multiple samples repeatedly with replacement according to uniform probability distribution and fit a model on it. It\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/akshayamrit/Bagging-on-low-variance-models/blob/master/pima_indians_diabetes.data.csv", "anchor_text": "Pima Indians Diabetes Dataset", "paragraph_index": 7}, {"url": "https://github.com/akshayamrit/Bagging-on-low-variance-models/blob/master/kc_house_data.csv", "anchor_text": "King County House Pricing Dataset", "paragraph_index": 11}, {"url": "https://github.com/akshayamrit/Bagging-on-low-variance-models", "anchor_text": "GitHub", "paragraph_index": 22}, {"url": "https://www.analyticsvidhya.com/blog/2018/06/comprehensive-guide-for-ensemble-models/", "anchor_text": "A Comprehensive Guide to Ensemble Learning (with Python codes)", "paragraph_index": 23}], "all_paragraphs": ["Bagging (also known as bootstrap aggregation) is a technique in which we take multiple samples repeatedly with replacement according to uniform probability distribution and fit a model on it. It combines multiple predictions to give a better prediction by majority vote or taking the aggregate of the predictions. This technique is effective on models which tend to overfit on the dataset (high variance models). Bagging reduces the variance without making the predictions biased. This technique acts as a base to many ensemble techniques so understanding the intuition behind it is crucial.", "If this technique is so good, why do we use it only on models which show high variance? What happens when we use it with models which have low variance? Let us try to understand the underlying issue with the help of a demonstration.", "We will be using bagging on decision tree to prove that bagging improves the accuracy for high variance models and compare it to bagging on simple linear regression which is biased depending on the dataset. Simple linear regression is biased when the predictor is not perfectly correlated to the target variable.", "We will be talking about Bias and Variance throughout the article so let us get an idea of what it is first.", "High bias refers to the oversimplification of the model. i.e. When we are unable to capture the true relation of the data. Our objective of creating a model is to capture the true nature of the data and predict based on the trend, which makes high bias an undesired phenomenon.", "High variance refers to the situation when we are overcomplicating our model. i.e. The situation where, in the process of capturing the true nature of the model, we are creating a model which learns the training data so well that its accuracy deteriorates on any other dataset. This situation is also undesired as our objective is to make predictions for unseen data.", "When we are creating a model, we want to strike a balance between bias and variance. Bias and Variance are opposite of each other so whenever we try to reduce the variance, we are increasing the bias of the model at the same time. This dilemma of overfitting/underfitting is called Bias-Variance Tradeoff. This image gives a good idea of their relation witch each other.", "Decision Tree classifies the target variable, and, with default settings, it does not stop unless it classifies every category perfectly. This makes the tree overfit on the data provided and the accuracy of the model on test dataset will be low. Let us verify this using a dataset. We will use Pima Indians Diabetes Dataset.", "As we have discussed earlier, bagging should decrease the variance in our predictions without increasing the bias. The direct effect of this property can be seen on the change in accuracy of the predictions. Bagging will make the difference between training accuracy and test accuracy smaller. We might not always observe a change in the training accuracy, but the test accuracy will always be better in this case. Let us check the effect of bagging on our dataset.", "This result proves our point! Bagging improves the performance of high variance models!", "Everything we talked about till now in this article is known and intuitive but what happens when we try to use bagging on a low variance model like Simple Linear Regression? Let us explore this scenario with a demonstration of what happens with each bagged model. We can intuitively claim that as bagging only effects high variance models, it should have no effect on biased models. We will verify whether our assumption is correct in the rest of the article.", "We will work with King County House Pricing Dataset. We are using only one variable to make the visualization easier. Let us look at the scatter plot between price and sqft_living to get a general idea of their relationship and build a simple linear regression model on it.", "Accuracy of the simple linear regression model in this case:", "Before discussing \u2018a curious case of bagging on simple linear regression\u2019, let us quickly check whether the accuracy after bagging simple linear regressions improves or even keeps the performance of the model constant.", "Despite bagging 200 simple linear regression models, the RMSE (Root Mean Squared Error) went down by 2.7! Biased nature of simple linear regression is the reason behind this. We observe a very small change in the RMSE because our model was able to capture the trend of the dataset quite well. The correlation between sqft_living and price was 0.7 and the simple linear regression model captures the linear relation between the variables. If the correlation for simple linear regression was lower, the difference in RMSE would have been larger. Let us discuss why in the next section.", "Simple Linear Regression is a conditionally biased model. i.e. when there is clear linear relationship between the variables, this model can be considered stable. In this scenario, the accuracy of the model will not decrease even if we use bagging on it. When this relationship between the variables changes, simple linear regression tries to create a straight line to capture the trend of the data. In this scenario, the bias of individual bagged models increases.", "As the correlation between our variables is 0.7, it is not perfectly correlated but it is good enough that the use of simple linear regression makes sense here. This is the reason because of which the RMSE did not take a huge dip when we used bagging on it. The bagging technique creates multiple linear regression models and takes the mean of their predictions. All these points will lie on the regression line which can be produced by taking the mean of intercepts and coefficients of every model. Let us visualize the predictions of mean regression lines in comparison to the final bagged predictions.", "Every grey line present in this graph represents individual simple linear regression models. Their bias is higher than the regression line which could have been obtained from the original dataset directly as many duplicate points are present in bootstrap samples. This gives some points more leverage than the rest. This led to the deviation of mean regression line from the regression line which we could have obtained without bagging.", "This means that our assumption that bagging has no effect on high bias model was incorrect! Bagging does effect models with high bias, but it reduces its accuracy instead. Does that mean bagging of models which have high bias will always give us worse results than the ones which we could have obtained from the original model? Let us look at a few more graphs to conclude.", "We observed that the range, standard deviation shrinks as we increase the number of bootstrap samples. The median RMSE also moves closer to the RMSE of the simple linear regression line. It indicates that the bagged predictions are getting closer to the simple linear regression predictions without deviating much.", "The following points can be concluded from this article:", "The focus of this article is to demonstrate what happens when we use a model which has low variance in bagging. The objective is to give the reader an intuition about which model works well with bagging.", "Please note that some of the code given in the article might not work as those functions are not present in python. I had to code bagging from scratch to demonstrate the bias of every model so if you are looking for the code, refer this link \u2014 GitHub", "[1] Aishwarya Singh, A Comprehensive Guide to Ensemble Learning (with Python codes)(2018) [2] Daniel T. Larose-Chantal D. Larose,7.5 Bias-Variance Tradeoff ,Data Mining and Predictive Analytics [3] Trevor Hastie Et Al, 8.7 Bagging, The Elements of Statistical Learning [4] Bradley Boehmke Et Al, 10 Bagging, Hands on Machine Learning", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PGP in Data Science Student at Praxis Business School | MIT Manipal"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F38d3c70259db&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----38d3c70259db--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----38d3c70259db--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@akshayamrit?source=post_page-----38d3c70259db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@akshayamrit?source=post_page-----38d3c70259db--------------------------------", "anchor_text": "Akshay Amrit"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7fe0f40bf174&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&user=Akshay+Amrit&userId=7fe0f40bf174&source=post_page-7fe0f40bf174----38d3c70259db---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F38d3c70259db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F38d3c70259db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://github.com/akshayamrit/Bagging-on-low-variance-models/blob/master/pima_indians_diabetes.data.csv", "anchor_text": "Pima Indians Diabetes Dataset"}, {"url": "https://github.com/akshayamrit/Bagging-on-low-variance-models/blob/master/kc_house_data.csv", "anchor_text": "King County House Pricing Dataset"}, {"url": "https://github.com/akshayamrit/Bagging-on-low-variance-models", "anchor_text": "GitHub"}, {"url": "https://www.analyticsvidhya.com/blog/2018/06/comprehensive-guide-for-ensemble-models/", "anchor_text": "A Comprehensive Guide to Ensemble Learning (with Python codes)"}, {"url": "https://medium.com/tag/ensemble-learning?source=post_page-----38d3c70259db---------------ensemble_learning-----------------", "anchor_text": "Ensemble Learning"}, {"url": "https://medium.com/tag/bagging?source=post_page-----38d3c70259db---------------bagging-----------------", "anchor_text": "Bagging"}, {"url": "https://medium.com/tag/bias-variance-tradeoff?source=post_page-----38d3c70259db---------------bias_variance_tradeoff-----------------", "anchor_text": "Bias Variance Tradeoff"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----38d3c70259db---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----38d3c70259db---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F38d3c70259db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&user=Akshay+Amrit&userId=7fe0f40bf174&source=-----38d3c70259db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F38d3c70259db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&user=Akshay+Amrit&userId=7fe0f40bf174&source=-----38d3c70259db---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F38d3c70259db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----38d3c70259db--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F38d3c70259db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----38d3c70259db---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----38d3c70259db--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----38d3c70259db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----38d3c70259db--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----38d3c70259db--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----38d3c70259db--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----38d3c70259db--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----38d3c70259db--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----38d3c70259db--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@akshayamrit?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@akshayamrit?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Akshay Amrit"}, {"url": "https://medium.com/@akshayamrit/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7fe0f40bf174&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&user=Akshay+Amrit&userId=7fe0f40bf174&source=post_page-7fe0f40bf174--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F7fe0f40bf174%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbagging-on-low-variance-models-38d3c70259db&user=Akshay+Amrit&userId=7fe0f40bf174&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}