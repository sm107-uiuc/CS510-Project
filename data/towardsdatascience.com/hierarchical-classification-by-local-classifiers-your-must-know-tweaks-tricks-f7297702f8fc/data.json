{"url": "https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc", "time": 1683007628.65648, "path": "towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc/", "webpage": {"metadata": {"title": "Hierarchical Classification by Local Classifiers: Your Must-Know Tweaks & Tricks | by Noa Weiss | Towards Data Science", "h1": "Hierarchical Classification by Local Classifiers: Your Must-Know Tweaks & Tricks", "description": "Have you got a hierarchical classification task that\u2019s just begging for a machine learning model? Have you decided opting for an ensemble of local classifiers, and even decided on the best\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "hierarchical classification", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "the best local-classifier structure for that very task", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "previous", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "posts", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "previous", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "ones", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/hierarchical-performance-metrics-and-where-to-find-them-7090aaa07183", "anchor_text": "check out my next post", "paragraph_index": 28}], "all_paragraphs": ["Have you got a hierarchical classification task that\u2019s just begging for a machine learning model? Have you decided opting for an ensemble of local classifiers, and even decided on the best local-classifier structure for that very task? Is your keyboard all warmed up, fingers ready and raring to go? Well, just a minute now. You might wanna sit back down.", "If you\u2019ve read my previous posts on the subject of hierarchical classification, you have definitely got all the basics down. However, there are some important final details you should make yourself acquainted with. Whether it\u2019s how to choose your training examples and feature sets, how to avoid error propagation, or ways to handle classification inconsistencies \u2014 this is one post you want to read before implementing your first real-life hierarchical model.", "The topic of hierarchical local classifiers is a lengthy one, and understanding the intricacies described below requires you to be familiar with:", "If that\u2019s not the case, go ahead and read about them. It\u2019s okay. We\u2019ll wait.", "Throughout this post, as in my previous ones, I\u2019ll be giving examples based on this taxonomy of common house pets:", "Are you building your very own hierarchical ensemble model? Have you defined your data taxonomy, picked out your favorite local-classifier structure, rolled up your sleeves, and you\u2019re all set to go ahead and get that model cracking?", "You\u2019re almost there, champ. But before you turn that data sciencing engine on, there are just a few more points you should take the time to consider.", "\u201cUmm\u2026 Why is my model output insisting this example is a Siamese Poodle?\u201d", "As you already know (and if you don\u2019t, why don\u2019t you go ahead and click here), local classifier ensemble models can spit out some inconsistent results.", "Depending on your use case, you might not want your test set example tagged as both \u201cUnicorn\u201d and \u201cFrench Bulldog\u201d, nor do you want the parent-node classifier saying nay while one of its child-nodes votes aye. Inconsistency between different levels of the ensemble is something we highly prefer to avoid. How should we do that, then?", "There are a few methods \u2014 some of them unnecessarily complicated. I\u2019ll save you some trouble and describe the simplest and most intuitive ones, that make the most sense considering the problem at hand:", "Solution: Class-prediction top-down approach.During the testing phase, you start from the top of the taxonomy tree, and every time you go down a level, you only consider the local classifiers that are the descendants of the predicted class.A bit too abstract? Let\u2019s look at a couple of examples, then:", "You\u2019re using LCN (Local Classifier per Node), but your problem is a single-label one? Well, first of all, I don\u2019t know why you\u2019d do that \u2014 the LCPN (Local Classifier per Parent Node) structure is just sitting there, waiting \u2014 but if you\u2019re determined to go that way, and you get multiple local classifiers in the same level saying \u201cyes\u201d on the same example, here\u2019s what you do: go with the highest-confidence one.", "Yup, it\u2019s that easy. Both \u201cUnicorn\u201d and \u201cDog\u201d fighting for the title? Ask each classifier for a confidence score, and only consider the answer of the more confident one. A bit like real-life, isn\u2019t it?", "(This solution assumes you\u2019re also using the above-mentioned top-down class prediction, only sending examples to child-classifiers of a parent-classifiers that came out positive. If you\u2019re not, you should).", "\u201cWait! What about error propagation? If one of those parent-node classifiers gives a false positive, how do we avoid propagating that error down the hierarchy?\u201d", "Elementary, my dear reader. We block by confidence. Depending on your use case and the level of certainty it requires, decide on a threshold, and if the confidence score for a prediction doesn\u2019t hit it \u2014 stop the classification process there, and do not send that sample on to that classifier\u2019s child-nodes.", "This solution does come with a price, though: the final prediction would be less specific (e.g., \u201cCat\u201d and not \u201cSphynx cat\u201d), and depending on your specific problem and business needs, your end users might not be happy with that.", "\u201cI\u2019m building a Local Classifier per Node ensemble model. What should the training set for each binary classifier look like?\u201d", "When it comes to the LCN (Local Classifier per Node) approach, it might not be obvious how to train the local classifiers, which are all binary. What examples should we feed it as positive ones? And which ones are negative?", "There are a few different policies, each with its own rational and its own oddities. Lucky for you, I went through the trouble of picking the one that I find makes the most sense for LCN, as the others are both a bit complicated to comprehend, and do not present any clear benefits.", "It is dubbed \u201cthe siblings policy\u201d, and it defines the positive examples for class X as those who belong to class X and to its child-classes, and the negative examples as those that belong to class X\u2019s siblings-classes, and to their own child-classes.", "Example? Sure: Say I want to train my \u201cDog\u201d classifier. In this case, my positive examples would be those that belong to both the general \u201cDog\u201d class (assuming there are some examples where I know they\u2019re dogs, but don\u2019t know which breed), and to all of its specific breeds (Dalmatian, Labrador, etc.). My negative examples, on the other hand, will be all the cats and all the unicorns (which, I must say, sounds like quite the party).", "Got it? Good. Let\u2019s move on to the next tweak.", "\u201cShould I use the same base algorithm for all of the local classifiers in my ensemble? How about the same feature set?\u201d", "There\u2019s plenty of evidence suggesting different algorithms and features for different sub-problems provide better results. Which makes perfect sense. You wouldn\u2019t expect a \u201cdoes it meow\u201d feature to perform well for distinguishing different breeds of dogs, would you?", "If you got this far, you\u2019re ready to go. You got your local classifier structure? Your positive and negative examples? Inconsistencies and error propagation issues are all sorted out? Wait, are you forgetting something?", "Once you\u2019ve got your hierarchical model all set up, you\u2019re gonna want to be able to tell how well it\u2019s doing. And while the performance metrics for a flat classification problem are known by all - when it comes to the hierarchical case, it\u2019s not as straightforward.", "So go ahead and start building your model, but if you also want to be able to measure its performance \u2014 check out my next post. It\u2019s gonna be a blast.", "Noa Weiss is an AI & Machine Learning Consultant based in Tel Aviv.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff7297702f8fc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@noa.weiss?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noa.weiss?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": "Noa Weiss"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F94ed18c37f4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&user=Noa+Weiss&userId=94ed18c37f4b&source=post_page-94ed18c37f4b----f7297702f8fc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7297702f8fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7297702f8fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "hierarchical classification"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "the best local-classifier structure for that very task"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "previous"}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "posts"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "Data Taxonomy & Hierarchical Classification"}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "Hierarchical Local Classifiers and their Different Structures"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "previous"}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "ones"}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "here"}, {"url": "https://www.google.com/search?tbm=isch&q=unicorn+cat", "anchor_text": "Click at your own risk"}, {"url": "https://towardsdatascience.com/hierarchical-performance-metrics-and-where-to-find-them-7090aaa07183", "anchor_text": "check out my next post"}, {"url": "https://link.springer.com/article/10.1007/s10618-010-0175-9", "anchor_text": "A survey of hierarchical classification across different application domains"}, {"url": "https://medium.com/tag/classification?source=post_page-----f7297702f8fc---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f7297702f8fc---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f7297702f8fc---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7297702f8fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&user=Noa+Weiss&userId=94ed18c37f4b&source=-----f7297702f8fc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7297702f8fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&user=Noa+Weiss&userId=94ed18c37f4b&source=-----f7297702f8fc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7297702f8fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff7297702f8fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f7297702f8fc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f7297702f8fc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f7297702f8fc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f7297702f8fc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f7297702f8fc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noa.weiss?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noa.weiss?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Noa Weiss"}, {"url": "https://medium.com/@noa.weiss/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "196 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F94ed18c37f4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&user=Noa+Weiss&userId=94ed18c37f4b&source=post_page-94ed18c37f4b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F59eb191f7cc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc&newsletterV3=94ed18c37f4b&newsletterV3Id=59eb191f7cc5&user=Noa+Weiss&userId=94ed18c37f4b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}