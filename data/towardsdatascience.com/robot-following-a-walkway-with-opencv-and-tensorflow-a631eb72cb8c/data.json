{"url": "https://towardsdatascience.com/robot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c", "time": 1682995330.281575, "path": "towardsdatascience.com/robot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c/", "webpage": {"metadata": {"title": "Robot following a walkway with OpenCV and Tensorflow | by Constantin Toporov | Towards Data Science", "h1": "Robot following a walkway with OpenCV and Tensorflow", "description": "After my robot learned how to follow a line, there is a new challenge appeared. I decided to go outdoor and make the robot move along a walkway. It would be nice if a robot follows the host through a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@const.toporov/raspberry-pi-photo-tank-robot-cf5ca7288adf", "anchor_text": "my robot", "paragraph_index": 0}, {"url": "https://medium.com/@const.toporov/line-following-robot-with-opencv-and-contour-based-approach-417b90f2c298", "anchor_text": "how to follow a line", "paragraph_index": 0}, {"url": "https://devblogs.nvidia.com/deep-learning-self-driving-cars/", "anchor_text": "an article from Nvidia", "paragraph_index": 1}, {"url": "http://www.donkeycar.com/", "anchor_text": "DonkeyCar", "paragraph_index": 3}, {"url": "https://wroscoe.github.io/keras-lane-following-autopilot.html", "anchor_text": "neural network", "paragraph_index": 3}, {"url": "https://github.com/samjabrahams/tensorflow-on-raspberry-pi", "anchor_text": "Sam Abrahams", "paragraph_index": 14}, {"url": "https://github.com/tprlab/pitanq", "anchor_text": "GitHub repo with the complete tank firmware on python", "paragraph_index": 18}, {"url": "https://github.com/tprlab/pitanq-selfwalk", "anchor_text": "Data and code for the neural network", "paragraph_index": 19}, {"url": "https://github.com/tprlab/pi-opencv", "anchor_text": "Prebuilt OpenCV deb packages for Raspbian", "paragraph_index": 20}], "all_paragraphs": ["After my robot learned how to follow a line, there is a new challenge appeared. I decided to go outdoor and make the robot move along a walkway. It would be nice if a robot follows the host through a park like a dog.", "The implementation idea was given by Behavioral cloning. It is a very popular approach for self-driving vehicles when AI learns on provided behavioral input and output and then makes decisions on new input. There is an article from Nvidia where they introduced this method.", "Many good articles are describing this idea:", "Even more exciting implementations are in real life. The best example is DonkeyCar and its neural network.", "Unfortunately a naive approach \u2014 to train a neural network on color photos \u2014 did not succeed. Park photos in a fall are mostly gray, so NN trained on resized and blurred pictures provided anything but reliable results.", "To simplify the task for AI I decided to preprocess the images with computer vision technics. OpenCV library has many abilities and worked fine when I need to detect a white line on the floor.", "This task turned out to be not so easy. The pictures were mostly gray, and the main question was \u201cwhich gray is for the walkway\u201d. Observations discovered the walkway was like \u201cperfect gray\u201d \u2014 with minimal difference between its RGB values.", "Brightness was another criteria. It was hard to determine walkway brightness automatically, so the first picture was used to adjust color parameters. Then color filtering applied based on the parameters, and we have got a mask with the walkway contour.", "The shape of the contour was not precise and depended on color filtering parameters.", "The next step is to make a decision (go straight or turn left/right) based on walkway mask. The general idea of the classification is to look at the right edge of the walkway: if the edge more on the left \u2014 then we need steer left. If there is no edge \u2014 steer right. If the edge goes from the right bottom corner up with a moderate angle \u2014 do nothing, just drive.", "Considering indistinct blob shapes, it was hard to recognize the edge features using just geometry. Then I relied on neural networks to find patterns. So I put the walkway masks in three different folders and trained NN on them.", "Examples of left, right and straight masks:", "In terms of machine learning, this is a task of images classification with three classes. Grayscale images were ideal input data, so even the simplest convolution network shown excellent results. I used Keras over Tensorflow to teach the net.", "Next challenge was to run everything on Raspberry Pi.", "I was using Raspbian 8 Jessie with old Tensorflow, built by Sam Abrahams and OpenCV 3.4 (I had to build it on my own). That version of Tensorflow was pretty old and was not able to work with Keras models.", "Fortunately, recently Google supported Raspberry Pi for Tensorflow, but it requires Raspbian 9 Stretch and python 3. So I had to migrate all robot firmware to the new platform. OpenCV also developed during that year and I had to build OpenCV 4.0.", "Put everything together \u2014 the robot is walking in a park.", "The hardest part is to recognize the road. An absence of lines makes this task difficult. Recognition parameters have to be tweaked depending on light and local conditions. But the greyscale masks are the perfect material to teach even a simple CNN to get predictable results.", "GitHub repo with the complete tank firmware on python", "Data and code for the neural network", "Prebuilt OpenCV deb packages for Raspbian", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Working on artificial intelligence and computer vision applied to sports."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa631eb72cb8c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://const-toporov.medium.com/?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": ""}, {"url": "https://const-toporov.medium.com/?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": "Constantin Toporov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F95bd3440818b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&user=Constantin+Toporov&userId=95bd3440818b&source=post_page-95bd3440818b----a631eb72cb8c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa631eb72cb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa631eb72cb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@const.toporov/raspberry-pi-photo-tank-robot-cf5ca7288adf", "anchor_text": "my robot"}, {"url": "https://medium.com/@const.toporov/line-following-robot-with-opencv-and-contour-based-approach-417b90f2c298", "anchor_text": "how to follow a line"}, {"url": "https://devblogs.nvidia.com/deep-learning-self-driving-cars/", "anchor_text": "an article from Nvidia"}, {"url": "https://medium.com/@ksakmann/behavioral-cloning-make-a-car-drive-like-yourself-dc6021152713", "anchor_text": "One"}, {"url": "https://medium.com/deep-learning-turkey/behavioral-cloning-udacity-self-driving-car-project-generator-bottleneck-problem-in-using-gpu-182ee407dbc5", "anchor_text": "Two"}, {"url": "https://towardsdatascience.com/implementing-neural-network-used-for-self-driving-cars-from-nvidia-with-interactive-code-manual-aa6780bc70f4", "anchor_text": "Three"}, {"url": "http://www.donkeycar.com/", "anchor_text": "DonkeyCar"}, {"url": "https://wroscoe.github.io/keras-lane-following-autopilot.html", "anchor_text": "neural network"}, {"url": "https://github.com/samjabrahams/tensorflow-on-raspberry-pi", "anchor_text": "Sam Abrahams"}, {"url": "https://github.com/tprlab/pitanq", "anchor_text": "GitHub repo with the complete tank firmware on python"}, {"url": "https://github.com/tprlab/pitanq-selfwalk", "anchor_text": "Data and code for the neural network"}, {"url": "https://github.com/tprlab/pi-opencv", "anchor_text": "Prebuilt OpenCV deb packages for Raspbian"}, {"url": "https://github.com/tprlab/pitanq-prod", "anchor_text": "Tank assembly instruction"}, {"url": "http://pitanq.com", "anchor_text": "More info about the tank"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a631eb72cb8c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----a631eb72cb8c---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----a631eb72cb8c---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/raspberry-pi?source=post_page-----a631eb72cb8c---------------raspberry_pi-----------------", "anchor_text": "Raspberry Pi"}, {"url": "https://medium.com/tag/python?source=post_page-----a631eb72cb8c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa631eb72cb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&user=Constantin+Toporov&userId=95bd3440818b&source=-----a631eb72cb8c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa631eb72cb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&user=Constantin+Toporov&userId=95bd3440818b&source=-----a631eb72cb8c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa631eb72cb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa631eb72cb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a631eb72cb8c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a631eb72cb8c--------------------------------", "anchor_text": ""}, {"url": "https://const-toporov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://const-toporov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Constantin Toporov"}, {"url": "https://const-toporov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "219 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F95bd3440818b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&user=Constantin+Toporov&userId=95bd3440818b&source=post_page-95bd3440818b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb4440225bd41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobot-following-a-walkway-with-opencv-and-tensorflow-a631eb72cb8c&newsletterV3=95bd3440818b&newsletterV3Id=b4440225bd41&user=Constantin+Toporov&userId=95bd3440818b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}