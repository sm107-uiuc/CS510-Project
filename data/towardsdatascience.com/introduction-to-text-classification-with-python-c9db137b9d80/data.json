{"url": "https://towardsdatascience.com/introduction-to-text-classification-with-python-c9db137b9d80", "time": 1683015343.811978, "path": "towardsdatascience.com/introduction-to-text-classification-with-python-c9db137b9d80/", "webpage": {"metadata": {"title": "Text Classification with Python | Towards Data Science", "h1": "Introduction to Text Classification with Python", "description": "In this article, I will show you on how to implement a text classifier for predicting disaster tweets using a machine learning method called Naive Bayes."}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/drive/1nIJDAhMHeBrOtkyicQW1Z7Iykb2kB6mA?usp=sharing", "anchor_text": "here", "paragraph_index": 2}], "all_paragraphs": ["Machine Learning has gained its impact in the last few years. There are lots of applications that have made by using it, ranging from marketing, bioinformatics, urban planning, and many more. Machine Learning is a way to learn representations from data, so we can use it for extracting knowledge or predicting a label based on it. One of the applications of this method is text classification.", "Text classification is a task where we classify texts to their belonging class. Before Machine Learning becomes a trend, this work mostly done manually by several annotators. That becomes a problem in future because the data becomes bigger, and it will take so much time just because for doing it. Therefore, we should automate the task and also gain greater accuracy to it at the same time.", "In this article, I will show you how to do a text classification using Python. For the dataset, we will use the dataset from a Kaggle competition called Real or Not? NLP with Disaster Tweets. I also have made the notebook on Google Colab, which you can access it here.", "The article will divide into several sections:", "The first step that we have to do is to prepare and clean the dataset. Cleaning the dataset is an essential step to remove any meaningless words or useless terms like hashtags, mentions, punctuations, and many more.", "To clean the text, we can utilize libraries like re for removing terms with patterns and NLTK to remove words, for example, stop words. I have also explained how to clean text step by step using Python, which you can look here,", "Here is how some texts look like before preprocessing,", "The code for doing the task will look like this,", "Here is the result after cleaning step,", "Also, take notes! Make sure that you download all the packages and the corpus (basically is a collection of words) from NLTK.", "Right after we clean the data, now we can build a text representation so the computer can read the data easily. We will use a Term-Document Matrix as a representation for texts.", "Term-Document Matrix (TDM) is a matrix, which the rows represent each document, the columns represent each term (word), and the cell filled with a number.", "The cell consists of the word count on each document. One of the method we can use for filling it called as Term Frequency \u2014 Inverse Document Frequency (TF-IDF).", "Term Frequency \u2014 Inverse Document Frequency (TF-IDF) is a product between the frequency of a term on a document (Term Frequency) and the inverse frequency of a term on all documents (Inverse Document Frequency).", "Term Frequency (TF) is a formula for calculating the amount of a term in a document. Because the amount varies between words, we apply log with bases 10 to rescale it. It looks like this,", "Inverse Document Frequency (IDF) is a formula for calculating the rarities of words on all documents. If the number is small, the word is frequent. But if it\u2019s bigger, the word is less frequent. This formula will be used as the weighting for the TF, and it looks like this,", "To create a Term-Document Matrix (TDM), we can use a function from sklearn library called TfidfVectorizer. The code will look like this,", "When you write the code, you have to be very careful about which function you will use for each dataset. On train data, make sure that you use the fit_transform method because it will fit based on the number of terms inside the train data and transform it into a matrix.", "Meanwhile, on the test data, make sure that you use the transform method because it will transform the text into a matrix with the same number of train data\u2019s column. If we also use the fit_transform on that, it will create a matrix based on the number of terms on the test data. Therefore, it will not have the same dimension on columns, so make sure you check the methods that you will use.", "If we did it correctly, it will give the matrices have the same column\u2019s dimension, and also a matrix that looks like this,", "After we have the matrix, now we can apply it to the model. The model that we will use is the Naive Bayes.", "Naive Bayes is a machine learning model to solve supervised learning tasks by calculating the probability of a data belongs to a class.", "It is based on the Bayes principle and assumes that each term inside a document is independent each other. The formula for calculating this looks like this,", "Let me explain each part of it,", "Where the Nc is the number of corresponding class on the dataset and N is the number of documents on the dataset.", "Where the T ct corresponds to the amount of that term inside the class, the sum of T ct\u2019 corresponds to the total of terms with given class, B stands for the number of distinct vocabulary on a training dataset, and 1 as the smoothing for the model for avoiding zero.", "That P(t id | c) formula will differ based on how we formulate the problem. The previous one formulates it as a multinomial problem where we count how many the exact terms belongs to a class. We call this model sometimes as Multinomial Naive Bayes.", "There is also a model called Bernoulli Naive Bayes, where the calculation of P(t id | c) is different. It will calculate the proportion of how many documents that include the term by the total of all documents. The formula will look like this,", "Where the Nct corresponds to the total number of documents that contain the term with that class and Nc corresponds to the total number of documents with that class.", "After we calculate each probability, we will choose the best class with the highest probability to it.", "After I explain to you the concepts, let\u2019s move on to the implementation. For this step, I will use the scikit-learn library to do it.", "When we build the model, the important aspect to know is whether the model gives a great result or not especially on unseen data, so we are confident for using it. We can do this by a concept called cross-validation. The code looks like this,", "What is going on the calculate_f1 function?", "Based on that, we get the result that the Bernoulli Naive Bayes model has the best score (0.704) than the Multinomial Naive Bayes (0.681).", "Therefore, we will use the Bernoulli Naive Bayes as our model to predict the real test set data. The code looks like this,", "As we can see above, we fit the model with the real train data and predict the label of the test data. After that, we create a data frame and save the result to CSV format. Finally, you can submit that to Kaggle, and you will know whether the result is good or not.", "I want to give you some recommendations. The Naive Bayes is a good machine learning model for this task, but there is a lot of rooms to improve the result. You can use any other model, like Support Vector Machine, Decision Tree, Recurrent Neural Networks, and many more.", "Also, you can do some feature engineering to remove meaningless information on the data, or you can tune the hyperparameters on your model.", "Finally, we have reached the end of this article. I hope you have learned a lot from it, and if you have thoughts, you can comment down below. Also, if you are interested in my posts, you can follow my medium to catch up on my next articles.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc9db137b9d80&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@irfanalghani11?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@irfanalghani11?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": "Irfan Alghani Khalid"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44601cf05927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=post_page-44601cf05927----c9db137b9d80---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9db137b9d80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9db137b9d80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@alfonsmc10?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Alfons Morales"}, {"url": "https://unsplash.com/s/photos/bookshelf?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://colab.research.google.com/drive/1nIJDAhMHeBrOtkyicQW1Z7Iykb2kB6mA?usp=sharing", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/cleaning-text-data-with-python-b69b47b97b76", "anchor_text": "Cleaning Text Data with PythonAll you need is NLTK and re library.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/create-a-simple-search-engine-using-python-412587619ff5", "anchor_text": "https://towardsdatascience.com/create-a-simple-search-engine-using-python-412587619ff5"}, {"url": "https://www.kaggle.com/c/nlp-getting-started", "anchor_text": "https://www.kaggle.com/c/nlp-getting-started"}, {"url": "https://en.wikipedia.org/wiki/Naive_Bayes_classifier", "anchor_text": "https://en.wikipedia.org/wiki/Naive_Bayes_classifier"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c9db137b9d80---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c9db137b9d80---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c9db137b9d80---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----c9db137b9d80---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/technology?source=post_page-----c9db137b9d80---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9db137b9d80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=-----c9db137b9d80---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9db137b9d80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=-----c9db137b9d80---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9db137b9d80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc9db137b9d80&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c9db137b9d80---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c9db137b9d80--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c9db137b9d80--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c9db137b9d80--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c9db137b9d80--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@irfanalghani11?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@irfanalghani11?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Irfan Alghani Khalid"}, {"url": "https://medium.com/@irfanalghani11/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://www.linkedin.com/in/alghaniirfan/", "anchor_text": "https://www.linkedin.com/in/alghaniirfan/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44601cf05927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=post_page-44601cf05927--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F309de219c913&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-text-classification-with-python-c9db137b9d80&newsletterV3=44601cf05927&newsletterV3Id=309de219c913&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}