{"url": "https://towardsdatascience.com/scale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045", "time": 1683004866.281108, "path": "towardsdatascience.com/scale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045/", "webpage": {"metadata": {"title": "Scale Your Data Pipelines with Airflow and Kubernetes | by Tal Peretz | Towards Data Science", "h1": "Scale Your Data Pipelines with Airflow and Kubernetes", "description": "It doesn\u2019t matter if you are running background tasks, preprocessing jobs or ML pipelines. Writing tasks is the easy part. The hard part is the orchestration\u2014 Managing dependencies among tasks\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/hackernoon/https-medium-com-talperetz24-scaling-effectively-when-kubernetes-met-celery-e6abd7ce4fed", "anchor_text": "Scaling Effectively: when Kubernetes met Celery", "paragraph_index": 2}, {"url": "https://airflow.apache.org/docs/stable/_api/airflow/operators/index.html", "anchor_text": "Operators", "paragraph_index": 5}, {"url": "https://airflow.apache.org/docs/stable/_api/airflow/executors/index.html", "anchor_text": "Executors", "paragraph_index": 5}, {"url": "https://airflow.apache.org/docs/stable/api.html", "anchor_text": "REST API for workflows", "paragraph_index": 6}, {"url": "https://medium.com/bluecore-engineering/were-all-using-airflow-wrong-and-how-to-fix-it-a56f14cb0753", "anchor_text": "We\u2019re All Using Airflow Wrong and How to Fix It", "paragraph_index": 10}, {"url": "https://aws.amazon.com/premiumsupport/knowledge-center/eks-cluster-kubernetes-dashboard/", "anchor_text": "set up Kubernetes Dashboard", "paragraph_index": 15}, {"url": "https://github.com/talperetz/scalable-airflow-template", "anchor_text": "scalable airflow template github repo", "paragraph_index": 16}, {"url": "https://github.com/talperetz/python-cli-template", "anchor_text": "python-cli-template", "paragraph_index": 18}], "all_paragraphs": ["It doesn\u2019t matter if you are running background tasks, preprocessing jobs or ML pipelines. Writing tasks is the easy part. The hard part is the orchestration\u2014 Managing dependencies among tasks, scheduling workflows and monitor their execution is tedious.", "Enter Airflow. Your new workflow management platform.", "A couple of years ago, In Scaling Effectively: when Kubernetes met Celery, I wrote about my own implementation of a workflow engine using Flask, Celery, and Kubernetes. I considered available solutions \u2014 including airflow. With no satisfying solution in sight, I decided to implement my own framework. Since then, airflow had come a long way. Here is why I switched to Airflow:", "When using the right setup, the one we are about to see, Airflow is both scalable and cost-efficient.", "Though the UI is not perfect, it is one of Airflow\u2019s core competencies. And in this case, a picture is worth a thousand words-", "Airflow has plenty of integrations both in the form of Operators and in the form of Executors.", "And an experimental yet indispensable REST API for workflows, which implies you can trigger workflows dynamically.", "With so many companies using Airflow, I can rest assured knowing it is going to continuously improve.", "Using helm and some premade commands, we can destroy and re-deploy the entire infrastructure easily.", "We use kubernetes as the tasks\u2019 engine. Airflow scheduler will run each task on a new pod and delete it upon completion. Allowing us to scale according to workload using the minimal amount of resources.", "Another great advantage of using Kubernetes as the task runner is \u2014 decoupling orchestration from execution. You can read more about it in We\u2019re All Using Airflow Wrong and How to Fix It.", "We use Git-Sync containers. Those will allow us to update the workflows using git alone. No need to redeploy Airflow on each workflow change.", "\u2795 Decoupling of orchestration and execution.\u2796 Extra pods for celery workers redis and flower monitoring.", "\u2795 No extra pods.\u2796 Weak-Decoupling. we\u2019ll have to define execution code and dependencies inside the DAGs.", "\u2795 No extra pods.\u2795 Decoupling of orchestration and execution.\u2796 Unsupported \u2014 currently causes recursion of pod startup.", "It is also recommended to set up Kubernetes Dashboard.", "To fill in the cookiecutter options check out scalable airflow template github repo.", "I use docker images since then I can decouple airflow from the actual tasks it runs. I can change the underlying task without changing anything in airflow configuration, code or deployment.", "When constructing the image I start with python-cli-template \u2014 which provides a fast and intuitive CLI experience.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Engineer \u2022 2x Founder \u2022 I Help startups embed AI in days instead of months"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4d34b0af045&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d34b0af045--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d34b0af045--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@talperetz24?source=post_page-----4d34b0af045--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@talperetz24?source=post_page-----4d34b0af045--------------------------------", "anchor_text": "Tal Peretz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F77f658b1afad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&user=Tal+Peretz&userId=77f658b1afad&source=post_page-77f658b1afad----4d34b0af045---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d34b0af045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d34b0af045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/hackernoon/https-medium-com-talperetz24-scaling-effectively-when-kubernetes-met-celery-e6abd7ce4fed", "anchor_text": "Scaling Effectively: when Kubernetes met Celery"}, {"url": "https://airflow.apache.org/docs/stable/_api/airflow/operators/index.html", "anchor_text": "Operators"}, {"url": "https://airflow.apache.org/docs/stable/_api/airflow/executors/index.html", "anchor_text": "Executors"}, {"url": "https://airflow.apache.org/docs/stable/api.html", "anchor_text": "REST API for workflows"}, {"url": "https://medium.com/bluecore-engineering/were-all-using-airflow-wrong-and-how-to-fix-it-a56f14cb0753", "anchor_text": "We\u2019re All Using Airflow Wrong and How to Fix It"}, {"url": "https://docs.aws.amazon.com/eks/latest/userguide/create-kubeconfig.html", "anchor_text": "kubectl context configured to your EKS cluster"}, {"url": "https://docs.aws.amazon.com/eks/latest/userguide/cluster-autoscaler.html", "anchor_text": "Kubernetes cluster set with autoscaler"}, {"url": "https://docs.aws.amazon.com/AmazonECR/latest/userguide/repository-create.html", "anchor_text": "ECR Repository for the docker image"}, {"url": "https://aws.amazon.com/premiumsupport/knowledge-center/eks-cluster-kubernetes-dashboard/", "anchor_text": "set up Kubernetes Dashboard"}, {"url": "https://github.com/talperetz/scalable-airflow-template", "anchor_text": "scalable airflow template github repo"}, {"url": "https://github.com/talperetz/python-cli-template", "anchor_text": "python-cli-template"}, {"url": "https://blog.twitter.com/engineering/en_us/topics/insights/2018/ml-workflows.html", "anchor_text": "ML Workflows in Twitter"}, {"url": "https://netflixtechblog.com/scheduling-notebooks-348e6c14cfd6", "anchor_text": "Scheduling Notebooks at Netflix"}, {"url": "https://medium.com/datareply/airflow-lesser-known-tips-tricks-and-best-practises-cf4d4a90f8f", "anchor_text": "Airflow Tips & Tricks"}, {"url": "https://medium.com/@talperetz24", "anchor_text": "https://medium.com/@talperetz24"}, {"url": "https://twitter.com/talperetz24", "anchor_text": "https://twitter.com/talperetz24"}, {"url": "https://www.linkedin.com/in/tal-per/", "anchor_text": "https://www.linkedin.com/in/tal-per/"}, {"url": "https://medium.com/tag/airflow?source=post_page-----4d34b0af045---------------airflow-----------------", "anchor_text": "Airflow"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----4d34b0af045---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/kubernetes?source=post_page-----4d34b0af045---------------kubernetes-----------------", "anchor_text": "Kubernetes"}, {"url": "https://medium.com/tag/data?source=post_page-----4d34b0af045---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/software-architecture?source=post_page-----4d34b0af045---------------software_architecture-----------------", "anchor_text": "Software Architecture"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d34b0af045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&user=Tal+Peretz&userId=77f658b1afad&source=-----4d34b0af045---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d34b0af045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&user=Tal+Peretz&userId=77f658b1afad&source=-----4d34b0af045---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d34b0af045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d34b0af045--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4d34b0af045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4d34b0af045---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d34b0af045--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4d34b0af045--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4d34b0af045--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4d34b0af045--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4d34b0af045--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4d34b0af045--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4d34b0af045--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4d34b0af045--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@talperetz24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@talperetz24?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tal Peretz"}, {"url": "https://medium.com/@talperetz24/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "445 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F77f658b1afad&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&user=Tal+Peretz&userId=77f658b1afad&source=post_page-77f658b1afad--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F77f658b1afad%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscale-your-data-pipelines-with-airflow-and-kubernetes-4d34b0af045&user=Tal+Peretz&userId=77f658b1afad&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}