{"url": "https://towardsdatascience.com/multimodal-deep-learning-to-predict-movie-genres-e6855f814a8a", "time": 1683007802.433271, "path": "towardsdatascience.com/multimodal-deep-learning-to-predict-movie-genres-e6855f814a8a/", "webpage": {"metadata": {"title": "Multimodal deep learning to predict movie genres | by Dhruv Verma | Towards Data Science", "h1": "Multimodal deep learning to predict movie genres", "description": "\u2018The Dark Knight\u2019 \u2014 one of my favourite movies. TMDB classifies this movie into four genres \u2014 Drama, Action, Crime, Thriller. A multimodal deep learning model I have trained classifies this movie as\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.themoviedb.org/movie/155-the-dark-knight?language=en-US", "anchor_text": "TMDB", "paragraph_index": 0}, {"url": "https://www.themoviedb.org/?language=en-US", "anchor_text": "TMDB", "paragraph_index": 1}, {"url": "https://www.kaggle.com/rounakbanik/the-movies-dataset/kernels", "anchor_text": "The Movies Dataset", "paragraph_index": 3}, {"url": "https://pypi.org/project/tmdbv3api/", "anchor_text": "tmdbv3api", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "F1 score", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Matthews_correlation_coefficient", "anchor_text": "correlation coefficient", "paragraph_index": 23}, {"url": "https://github.com/dh1105/Multi-modal-movie-genre-prediction", "anchor_text": "https://github.com/dh1105/Multi-modal-movie-genre-prediction", "paragraph_index": 27}], "all_paragraphs": ["\u201cBatman raises the stakes in his war on crime. With the help of Lt. Jim Gordon and District Attorney Harvey Dent, Batman sets out to dismantle the remaining criminal organizations that plague the streets. The partnership proves to be effective, but they soon find themselves prey to a reign of chaos unleashed by a rising criminal mastermind known to the terrified citizens of Gotham as the Joker.\u201d -TMDB", "\u2018The Dark Knight\u2019 \u2014 one of my favourite movies. TMDB classifies this movie into four genres \u2014 Drama, Action, Crime, Thriller. A multimodal deep learning model I have trained classifies this movie as \u2014 Action, Drama, Thriller. Let\u2019s take a look at how this model manages to do this.", "Modality is a particular way of doing or experiencing something. We live our daily lives in a multimodal environment. We see things, hear sounds, smell odours and feel textures. Analogous to this, multimodal deep learning involves multiple modalities used together to predict some output. In this project, I concatenated the features extracted from images and text sequences using a Convolutional Neural Network (CNN) and a Long Short-Term Memory (LSTM) network, respectively. These features were used to try and predict movie genres.", "For this project, I have used Kaggle\u2019s The Movies Dataset. It consists of over 40,000 movies with overviews, the poster URL link on TMDB and genres taken from the TMDB website. After splitting the dataset, the training set consists of 26864 examples; the test set includes of 7463 samples, and the validation set consists of 2986 cases.", "Before preprocessing the data, it was essential to understand how the class distribution of each genre was. Some genres such as \u201cAniplex\u201d, \u201cBROSTA TV\u201d seem to occur only once in the entire dataset. Hence, I removed those. In addition to this, some genres like \u201cTV Movie\u201d and \u201cForeign\u201d are not easily perceived by posters and movie summaries. Hence, those were removed as well. The snippet below shows a list of genres which were removed from the dataset.", "I also scanned the dataset for rows which did not have a genre specified anymore. Over 2471 rows did not have any values in the genre_list column. So these rows were dropped.", "In addition to this, it was essential to see how balanced the dataset was in terms of genre labels. As clear from the graph below, there is a class imbalance in the dataset.", "Data cleaning and preprocessing allow us to remove irrelevant information from the data such as URLs. These familiar words occur very frequently without adding much semantic meaning such as articles in the English language. The text processing involved the following steps:", "The cleaned text is tokenized using the Keras Tokenizer API. This tokenizer is used to convert all texts to sequences to be input into the LSTM network. All sequences are made of the same length by padding them with zeros. This is done to ensure that all inputs have the same dimensions.", "One of the inputs to the model is the movie poster. Hence, I had to download a single poster corresponding to each movie in the dataset. The original dataset contains a URL to the posters stored in TMDB as well. However, the majority of links seem to obsolete, so I had to improvise and make use of the TMDB API. I used python\u2019s tmdbv3api, which wraps around the TMDB API. Using the movie IDs from the original dataset, I found a single poster corresponding to a movie. A point to be noted is that some movies may not have posters available on TMDB.", "The \u2018Movie\u2019 object allows us to search for movies based on the TMDB ID. The posters are downloaded with a simple GET request and saved to my Google Drive. The path corresponding to a movie poster is saved in a list which is added to the dataset as a column.", "In case there are any errors in downloading the posters or the poster_path for a movie does not exist, that movie is dropped from the dataset.", "Here is a glimpse of how the final dataset looks.", "The final preprocessing step is to resize the posters and append them to a NumPy array. This NumPy array is saved to make it easier to access the posters in a valid input format. This process takes a lot of time, and the output NumPy array is around 2\u20133 GB. A considerable amount of RAM is needed to save this array. I would recommend using Google colab for this entire process. The code snippet for converting an image to a NumPy array is below. In case any posters are not found at the specified path in the dataset, the respective rows are dropped.", "So I have finally preprocessed the text inputs and image inputs. Now, on to training the model.", "Each movie is associated with a certain number of genres in the dataset. However, this needs to be made into a one-hot encoded vector where each one would correspond to a genre label. To do this, I used the MultilabelBinarizer class of the scikit-learn library. It results in a sparse matrix where each row vector is one-hot encoded. This means that a row vector will have a 1 in indexes associated with the label it has been classified as and 0 in all other places. Hence, this is a multilabel classification problem. As seen below, there are a total of 18 classes present in the dataset.", "The model comprises of two networks \u2014 a stacked LSTM and a CNN. The text sequences are input to an embedding layer. I used Google\u2019s pre-trained Word2Vec embedding. However, to fine-tune the model, I allowed the embedding layer to be trainable. The embedding layer is followed by two stacked LSTMs whose outputs are fed into a fully connected layer.", "The images are input to a CNN. The CNN consists of consecutive 2D convolutional and max-pooling layers. The output of the last max-pooling layer is flattened and fed into a fully connected layer.", "The fully connected layers of the LSTM and CNN then concatenated and fed forward till the final fully connected layer. The last layer has an output size of 18, each correlating to one genre.", "DataLoader object was initialized with a batch size of 64, which passes inputs to the model. The TensorDataset object is used to wrap the dataset inputs and labels. Each TensorDataset is then provided to the DataLoader object. This will allow us to send batches of the dataset to the model for training, validation and testing.", "The loss I used was binary cross-entropy along with the Adam optimizer. Gradient clipping was also used to prevent exploding gradients. The model was trained for 20 epochs. During the training, I computed the accuracy and loss for every epoch as an average of the accuracy and loss for all batches.", "The final epoch had the following accuracy and loss:", "After training and saving the model, I evaluated the accuracy and loss on the test set:", "The accuracy and loss seem to show that the model is performing reasonably well. However, some better evaluation metrics would be precision, recall, F1 score and the Compute Area Under the Receiver Operating Characteristic Curve (ROC AUC) score due to a class imbalance in the dataset. The output consisting of un-thresholded probabilities of a movie belonging to a genre is converted to a sparse matrix with one-hot encoded row vectors to compute precision, recall and F1 score. This was done using an arbitrary threshold value of 0.5. This value can be further improved by using Matthew\u2019s correlation coefficient. It can also be enhanced by plotting the ROC curve for each class.", "The ROC AUC score was calculated using the non-thresholded outputs of the model.", "Another evaluation metric used was the Hamming Loss. The Hamming loss gives a fraction of wrong labels to the total numbers of labels.", "As evident from the evaluation metrics above, the model seems to be performing well on the test set. The precision, recall and f1-score can probably be boosted further by taking an optimized threshold value for each label rather than an arbitrary value of 0.5. Another way of improving the model would be to evaluate the CNN and LSTM individually to judge the scope of improvement for both.", "Thanks for reading this article! The entire code for this project can is at https://github.com/dh1105/Multi-modal-movie-genre-prediction.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A computer science graduate interested in the applications of deep learning in NLP and vision."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe6855f814a8a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dh1105?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dh1105?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": "Dhruv Verma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb99378296aaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&user=Dhruv+Verma&userId=b99378296aaa&source=post_page-b99378296aaa----e6855f814a8a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6855f814a8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6855f814a8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.themoviedb.org/movie/155-the-dark-knight?language=en-US", "anchor_text": "TMDB"}, {"url": "https://www.themoviedb.org/movie/155-the-dark-knight?language=en-US", "anchor_text": "TMDB"}, {"url": "https://www.themoviedb.org/?language=en-US", "anchor_text": "TMDB"}, {"url": "https://www.kaggle.com/rounakbanik/the-movies-dataset/kernels", "anchor_text": "The Movies Dataset"}, {"url": "https://pypi.org/project/tmdbv3api/", "anchor_text": "tmdbv3api"}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "F1 score"}, {"url": "https://en.wikipedia.org/wiki/Matthews_correlation_coefficient", "anchor_text": "correlation coefficient"}, {"url": "https://github.com/dh1105/Multi-modal-movie-genre-prediction", "anchor_text": "https://github.com/dh1105/Multi-modal-movie-genre-prediction"}, {"url": "https://towardsdatascience.com/multimodal-deep-learning-ce7d1d994f4", "anchor_text": "https://towardsdatascience.com/multimodal-deep-learning-ce7d1d994f4"}, {"url": "https://www.kaggle.com/rounakbanik/the-movies-dataset", "anchor_text": "https://www.kaggle.com/rounakbanik/the-movies-dataset"}, {"url": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5", "anchor_text": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5"}, {"url": "https://medium.com/@kunalgupta4595/predicting-movie-genres-based-on-plot-summaries-bae646e70e04", "anchor_text": "https://medium.com/@kunalgupta4595/predicting-movie-genres-based-on-plot-summaries-bae646e70e04"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e6855f814a8a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----e6855f814a8a---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/lstm?source=post_page-----e6855f814a8a---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----e6855f814a8a---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/multimodal?source=post_page-----e6855f814a8a---------------multimodal-----------------", "anchor_text": "Multimodal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6855f814a8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&user=Dhruv+Verma&userId=b99378296aaa&source=-----e6855f814a8a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe6855f814a8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&user=Dhruv+Verma&userId=b99378296aaa&source=-----e6855f814a8a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe6855f814a8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe6855f814a8a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e6855f814a8a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e6855f814a8a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e6855f814a8a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e6855f814a8a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e6855f814a8a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dh1105?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dh1105?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dhruv Verma"}, {"url": "https://medium.com/@dh1105/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "29 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb99378296aaa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&user=Dhruv+Verma&userId=b99378296aaa&source=post_page-b99378296aaa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F43647226a94f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmultimodal-deep-learning-to-predict-movie-genres-e6855f814a8a&newsletterV3=b99378296aaa&newsletterV3Id=43647226a94f&user=Dhruv+Verma&userId=b99378296aaa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}