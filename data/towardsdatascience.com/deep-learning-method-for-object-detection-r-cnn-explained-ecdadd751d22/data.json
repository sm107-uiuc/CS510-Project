{"url": "https://towardsdatascience.com/deep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22", "time": 1683011944.626078, "path": "towardsdatascience.com/deep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22/", "webpage": {"metadata": {"title": "Deep Learning method for object detection: R-CNN explained | by Gaurav Sinha | Towards Data Science", "h1": "Deep Learning method for object detection: R-CNN explained", "description": "CNN\u2019s have been extensively used to classify images. But to detect an object in an image and to draw bounding boxes around them is a tough problem to solve. To solve this problem, R-CNN algorithm was\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1504.08083", "anchor_text": "Fast-R-CNN", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1506.01497", "anchor_text": "Faster-R-CNN", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1703.06870", "anchor_text": "Mask-R-CNN", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1311.2524", "anchor_text": "R-CNN paper", "paragraph_index": 2}, {"url": "https://www.geeksforgeeks.org/selective-search-for-object-detection-r-cnn/", "anchor_text": "selective search", "paragraph_index": 4}, {"url": "http://www.image-net.org/", "anchor_text": "imagenet", "paragraph_index": 5}], "all_paragraphs": ["CNN\u2019s have been extensively used to classify images. But to detect an object in an image and to draw bounding boxes around them is a tough problem to solve. To solve this problem, R-CNN algorithm was published in 2014. After R-CNN, many of its variants like Fast-R-CNN, Faster-R-CNN and Mask-R-CNN came which improvised the task of object detection. To understand the latest R-CNN variants, it is important to have a clear understanding of R-CNN. Once this is understood, then all other variations can be understood easily.", "This post will assume that the reader has familiarity with SVM, image classification using CNNs and linear regression.", "The R-CNN paper[1] was published in 2014. It was the first paper to show that CNN can lead to high performance in object detection. This algorithm does object detection in the following way:", "Now the post will dive into details explaining how the model is trained and how it predicts the bounding boxes.", "Region proposals are the bounding boxes that may contain an object. These are represented by a tuple of 4 numbers(x,y,h,w). The (x,y) are the coordinates of the centre of the bounding box and (h,w) are the height and width of the bounding box respectively. These region proposals are calculated by an algorithm called selective search[2]. For an image, approximately 2000 region proposals are extracted.", "Pretrained network: To train the CNN for feature extraction, an architecture like VGG-16 is initialized with the pre-trained weights from imagenet data. The output layer having 1000 classes is chopped off. So when a region proposal image(warped to size 224x224) is passed to the network we get a 4096-dimensional feature vector as shown in the above image. In this way, each region proposal is represented by a 4096-dimensional feature vector.", "The next step is to fine-tune the weights of the network with the region proposal images. To understand this a new metric called intersection-over-union or IoU score will be introduced.", "To measure the performance of a classification model, we generally use metrics like accuracy, recall, precision etc. But how to measure the performance of object detection. In object detection we have to evaluate two things:", "The IoU score measures how close the predicted box is to the ground truth. It is the ratio of the area common to ground truth and predicted box to the total area enclosed by both the boxes.", "In the left-most image, it can be seen that the predicted box is not close to the ground truth so the IoU score is only 35% while in the right-most image the predicted box completely overlaps the ground truth box, hence a very high value of 95% is obtained. The IoU value varies from 0 to 1.", "Fine-tuning the network: To fine-tune the model the output layer having 1000 classes is replaced with N+1 classes(softmax layers) and the rest of the model is kept unchanged. N is the number of the distinct classes the objects be classified and plus 1 for the background class.", "Next, data is required for fine-tuning. The region proposals whose IoU > 50% are considered a positive class for that object and rest are considered as background. In the above image of balls, the region proposal with 35% IoU score will be labelled as background while the rest of the boxes will be labelled as ball. These images(region proposals) are warped(resized) to the size compatible with CNN, in case of VGG 16 it is 224x224. Using these images the weights of the network are fine-tuned.", "Once the 4096-dimensional feature is obtained for each region proposal, the next task is to train a binary SVM for each class. For example, if the detection model is to detect three distinct objects \u2014 cat, dog and people, then three SVMs need to be trained for each of the class.", "Data preparation: All the object proposals belonging to a particular class is segregated. The manually labelled ground truth image for the class is considered as a positive class while object proposals having IoU < 30% for that class is considered as negative class. The same thing is done for each class and N SVM models are trained for classifying each region proposal into N classes.", "The region proposal bounding box predicted by selective search[2] algorithm might not be able to capture the entire object. To fine-tune the predicted bounding box, bounding box regression is used.", "Consider the ground truth region proposal G and the predicted region proposal P by the selective search[2] algorithm.", "To make the prediction of G scale-invariant, the following transformations are done such that the target for the regression is t.", "The input to the regression model is the feature from the last pooling layer of the CNN. We train 4 regression models per class with the target as t and input features as last pooling layer feature from CNN to learn regression parameter w.", "Here * is the placeholder for (x,y,w,h) and phi(P) is the last pooling layer feature corresponding to proposal P. So to predict ground truth G we can use the regression equation to calculate t from the region proposal P and then substitute the value of t and P in transformation equation to obtain G.", "Once different parts of R-CNN are trained, the next part is to do the object detection.", "3. Each region proposal is classified using SVM for each class. generally for N classes, the SVM weights(4096-dimensional) are stacked in the form of a matrix and multiplied with the feature matrix. This results in a matrix which assigns a score to each class to which a region proposal can belong to.", "4. The proposal is assigned the class which receives the maximum score. So all the 2000 region proposals or bounding boxes in the image are labelled with a class label.", "5. Out of those many bounding boxes, a lot of them would be redundant and overlapping bounding boxes which need to be removed. To accomplish that Non-maximum suppression algorithm is used.", "Non-maximum suppression is a greedy algorithm. It works on one class at a time. For a particular class, it picks the box with the maximum score obtained using SVM. Then it calculates IoU score with all other bounding boxes belonging to that class. The boxes having IoU score greater than 70% are removed. In other words, the bounding boxes which have very high overlap are removed. Then the next highest score box is chosen and so on until all the overlapping bounding boxes are removed for that class. This is done for all classes to obtain the result as shown above.", "6. Once the labelled bounding boxes are obtained the next task is to fine-tune the location of the boxes using regression.", "During training,4 regression models were trained for each class. So for a particular bounding box, region proposal image is passed through CNN to obtain features P to be passed to the regression model. The regression model outputs the scale-invariant coordinates ( dx(P), dy(P), dw(P), dh(P) ). These coordinates are combined with the region proposal coordinates ( Px, Py, Pw, Ph ) to obtain the adjusted final coordinates ( Gx, Gy, Gw, Gh) using the formula below.", "Although R-CNN is good at detecting objects, it has its shortcomings.", "These shortcomings are addressed in the later improvements of R-CNN which are Fast-RCNN, Faster-RCNN and Mask-RCNN. Having a good understanding of R-CNN helps to understand other variants of R-CNN easily and intuitively.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Master of Data Science student at the University of British Columbia, Vancouver. I like to use my data science knowledge to solve real-life problems."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fecdadd751d22&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gauravsnh210?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gauravsnh210?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": "Gaurav Sinha"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f2d9eee5987&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&user=Gaurav+Sinha&userId=5f2d9eee5987&source=post_page-5f2d9eee5987----ecdadd751d22---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fecdadd751d22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fecdadd751d22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://machinethink.net/blog/object-detection-with-yolo/", "anchor_text": "Blog by Matthijs Hollemans"}, {"url": "https://arxiv.org/abs/1504.08083", "anchor_text": "Fast-R-CNN"}, {"url": "https://arxiv.org/abs/1506.01497", "anchor_text": "Faster-R-CNN"}, {"url": "https://arxiv.org/abs/1703.06870", "anchor_text": "Mask-R-CNN"}, {"url": "https://arxiv.org/abs/1311.2524", "anchor_text": "R-CNN paper"}, {"url": "https://arxiv.org/abs/1311.2524", "anchor_text": "Original paper"}, {"url": "https://www.geeksforgeeks.org/selective-search-for-object-detection-r-cnn/", "anchor_text": "selective search"}, {"url": "https://www.pinterest.ca/pin/834854849655070162/?autologin=true", "anchor_text": "Pinterest"}, {"url": "http://www.image-net.org/", "anchor_text": "imagenet"}, {"url": "https://www.pyimagesearch.com/2016/11/07/intersection-over-union-iou-for-object-detection/", "anchor_text": "Blog by Adrian Rosebrock"}, {"url": "https://apple.github.io/turicreate/docs/userguide/object_detection/advanced-usage.html", "anchor_text": "Gitbook"}, {"url": "https://blog.mystart.com/my-white-cat-hd-wallpapers-new-tab-theme/", "anchor_text": "MyStart website"}, {"url": "https://www.pinterest.ca/pin/834854849655070162/?autologin=true", "anchor_text": "Pinterest"}, {"url": "https://medium.com/@yusuken/object-detction-1-nms-ed00d16fdcf9", "anchor_text": "Non-maximum suppression blog"}, {"url": "https://arxiv.org/abs/1311.2524", "anchor_text": "Original paper"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ecdadd751d22---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ecdadd751d22---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----ecdadd751d22---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/r-cnn?source=post_page-----ecdadd751d22---------------r_cnn-----------------", "anchor_text": "R Cnn"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----ecdadd751d22---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fecdadd751d22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&user=Gaurav+Sinha&userId=5f2d9eee5987&source=-----ecdadd751d22---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fecdadd751d22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&user=Gaurav+Sinha&userId=5f2d9eee5987&source=-----ecdadd751d22---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fecdadd751d22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fecdadd751d22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ecdadd751d22---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ecdadd751d22--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ecdadd751d22--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ecdadd751d22--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ecdadd751d22--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gauravsnh210?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gauravsnh210?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gaurav Sinha"}, {"url": "https://medium.com/@gauravsnh210/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "41 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f2d9eee5987&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&user=Gaurav+Sinha&userId=5f2d9eee5987&source=post_page-5f2d9eee5987--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7d92b99e6061&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-method-for-object-detection-r-cnn-explained-ecdadd751d22&newsletterV3=5f2d9eee5987&newsletterV3Id=7d92b99e6061&user=Gaurav+Sinha&userId=5f2d9eee5987&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}