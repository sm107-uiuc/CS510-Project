{"url": "https://towardsdatascience.com/introduction-to-bayesian-logistic-regression-7e39a0bae691", "time": 1683003700.7032309, "path": "towardsdatascience.com/introduction-to-bayesian-logistic-regression-7e39a0bae691/", "webpage": {"metadata": {"title": "Introduction to Bayesian Logistic Regression | by Michel Kana, Ph.D | Towards Data Science", "h1": "Introduction to Bayesian Logistic Regression", "description": "A step-by-step guide on fitting a Bayesian logistic model to data using Python and PyJAGS. Everything you need to take off with Bayesian data analysis."}, "outgoing_paragraph_urls": [{"url": "https://rdrr.io/cran/mlmRev/man/Contraception.html", "anchor_text": "1988 Bangladesh Fertility Survey", "paragraph_index": 2}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5640927/", "anchor_text": "source 1", "paragraph_index": 4}, {"url": "https://www.researchgate.net/publication/299436950_Using_Machine_Learning_to_predict_fertility_rates_based_on_economic_indicators", "anchor_text": "source 2", "paragraph_index": 4}, {"url": "https://gist.github.com/michelkana/a61484add9111dab3498824829259ac8", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://pypi.org/project/pyjags/", "anchor_text": "PyJAGS", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Nate_Silver", "anchor_text": "Nate Silver", "paragraph_index": 36}], "all_paragraphs": ["This article introduces everything you need in order to take off with Bayesian data analysis. We provide a step-by-step guide on how to fit a Bayesian logistic model to data using Python. You will be able to understand Bayesian fundamentals for classification without dealing with math.", "Let\u2019s review the concepts underlying Bayesian statistical analysis by walking through a simple classification model.", "The data come from the 1988 Bangladesh Fertility Survey, where 1934 observations were taken from women in urban and rural areas. The authors of the dataset, Mn and Cleland aimed to determine trends and causes of fertility as well as differences in fertility and child mortality.", "We will use the data in order to train a Bayesian logistic regression model that can predict if a given woman uses contraception.", "The dataset is well suited to Bayesian logistic regression because being able to quantify uncertainty when analyzing fertility is the major component of population dynamics that decide the size, structure, and composition of populations (source 1, source 2).", "A copy of the raw data can be found here. There are four attributes for each woman, along with a label indicating if she uses contraceptives. The attributes include:", "The women are grouped into 60 districts.", "A little bit of pre-processing is required. We map the district number 61 to the number 54 so that the districts are in order, as you can see below.", "Predicting whether or not a given woman uses contraceptives is an example of binary classification problem. If we denote attributes of the woman by X and the outcome by Y, then the likelihood of using contraceptives, P(Y=1), would follow the logistic function below.", "The outcome depends on two parameters \u03b20 (intercept) and \u03b21 (slope). The intercept shifts the curve right or left, while the slope controls how steep the S-shaped curve is. If \ud835\udefd1 is positive, then the predicted \ud835\udc43(Y=1) goes from zero for small values of \ud835\udc4b to one for large values of \ud835\udc4b and if \ud835\udefd1 is negative, then has the \ud835\udc43(Y=1) opposite association.", "For example, if \ud835\udefd1 is positive for the age predictor, it means that older women are more likely to use contraceptives than younger ones. The cut-off threshold where age will start increasing the probability of contraceptive usage would be governed by \u03b20. Small values of \u03b20 would indicate that contraceptives usage is a widespread practice in the population.", "Understanding the logistic function is important for motivating the Bayesian approach. You can learn more about classical logistic regression in our article below.", "By fitting our data to the logistic equation, we would be able to estimate fix values for \u03b20 and \ud835\udefd1. However, we will not know how confident we are about these estimates.", "Moreover, \ud835\udefd0 would normally differ from one district to another in real life. \u03b20 could be small in some districts, but large in others. A classical logistic regression model would still provide a single value for all regions, which could lead to wrong conclusions.", "In one of our past articles, we highlighted issues with uncertainty in machine learning and introduced the essential characteristics of Bayesian methods. We gently explained the explicit use of probability for quantifying uncertainty in inferences based on statistical data analysis.", "Following Bayes, ideally, we want to take prior information into consideration when building our model for predicting contraceptive usage. If we only use the logistic equation, there is no direct way to include our prior belief about those parameters we are estimating.", "The Bayesian approach allows us to make a prior good guess of the intercept and slope, based on our real-life domain knowledge and common sense. We can say for example that, from experience, the intercept is drawn from a normal distribution with mean \u03bc=2 and standard deviation \u03c3=1. We can also postulate that the slope for the predictors urban, living.children, and age-mean are 4, -3 and -2 respectively. This prior belief is summarized as follows.", "Given the above distribution, which describes our prior belief, we can generate simulated data using a so-called generative model, as depicted in the image below.", "In this case, the generative model is a Bernoulli distribution with parameters p, which is the probability of a woman using contraceptives. p is the logistic function introduced in the previous section.", "In order to get a better grasp of the concept of generative model, let\u2019s simulate binary response data Y. We do this by using prior parameter values and data.", "In order to experiment with the Bayesian approach a bit more, we will now specify a varying-intercept logistic regression model, where the intercept varies by district, and we will fit it to the simulated contraceptives data.", "We set informative prior distributions on \u03b20, \u03b21, \ud835\udefd2 and \ud835\udefd3, which are explicitly different from the ones we used to generate the simulated contraceptives data. Our goal is to estimate the true parameter values, which were used to simulate the response variable Y.", "When we have data, priors and a generative model, we can apply Bayes theorem to compute the posterior probability distribution of the model parameters conditionally upon the predictors (district, urban, living.children, age-mean) and response (Y).", "Markov chain Monte Carlo (MCMC) is a popular class of algorithms used to find the posterior distribution of the model parameters. Running such algorithms in Python is straightforward thanks to the library PyJAGS. The process starts with defining distributions and priors, from which PyJAGS performs sampling, using the Markov chains to guide the process towards the simulated data we have at hand. You can see how the MCMC works in the code below.", "A good practice is to plot the trace plots of the MCMC sampler for the parameters. The trace plot above suggests that the sampler did converge. The average of each of the 3 Markov chains looks roughly the same. Although there is a little wandering within the chain, there is no evidence of divergent chains.", "Now, we can plot the histograms of the posterior distributions for the parameters. We only show the plot for \u03b20 and for district10 only, as illustrative example.", "We recall that the true distribution for \u03b20 that was used to generate simulated data was as follows.", "As you can see in the plot above, the true \u03b20 parameter for district 10 is contained within the posterior distributions from our model. In fact, this was also the case for all remaining parameters, not shown here. This finding suggests that the Bayesian approach works well, and we can now move forward with fitting the varying-intercept model to the actual training data.", "Below, we run the MCMC sampler once more, this time using training data. We check the convergence by examining the trace plots, as we did with the simulated data. It appears that the samplers also converged here. None of the chains appears to be divergent, because they look uncorrelated, independently random sampled.", "The posterior distribution of model parameters \u03b20 can now be plotted for all districts as follows.", "We know that positive values of \ud835\udefd0 are associated with increased probability that women belonging to the corresponding districts are most likely to use contraceptives. Looking at the plot above, only a few districts have positive \ud835\udefd0 values.", "Negative values are associated with decreased probability that women belonging to the corresponding districts are most likely to use contraceptives. Most districts fall in this group.", "The posterior distributions allow us to compute the mean and standard deviation of \ud835\udefd0 values per district as illustrated in the plot above. Based on these results, we can conclude that the \ud835\udefd0 posteriors are not distributed uniformly across districts. This evidence is in support of the varying-intercept model and lead to the following findings:", "Women belonging to district 16 are most likely to use contraceptives. Women belonging to district 11 are most likely NOT to use contraceptives.", "Bayesian logistic regression has the benefit that it gives us a posterior distribution rather than a single point estimate like in the classical, also called frequentist approach.", "When combined with prior beliefs, we were able to quantify uncertainty around point estimates of contraceptives usage per district. In this article, we also offered few take-out on PyJAGS, an easy to use Python library for Bayesian inference.", "This area opens a wide door for future work, especially because Bayesian statistical analysis is at the core of several technologies ranging from medical diagnosis to election forecasting. The Signal and the Noise 2012's book by Nate Silver is an example of master piece in the art of using probability and statistics as applied to real-world circumstances.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Husband & Dad. Mental health advocate. Top Medium Writer. 20 years in IT. AI Expert @Harvard. Empowering human-centered organizations with high-tech."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7e39a0bae691&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://michel-kana.medium.com/?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": "Michel Kana, Ph.D"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb0b01fe20d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=post_page-cb0b01fe20d2----7e39a0bae691---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e39a0bae691&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e39a0bae691&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://rdrr.io/cran/mlmRev/man/Contraception.html", "anchor_text": "1988 Bangladesh Fertility Survey"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5640927/", "anchor_text": "source 1"}, {"url": "https://www.researchgate.net/publication/299436950_Using_Machine_Learning_to_predict_fertility_rates_based_on_economic_indicators", "anchor_text": "source 2"}, {"url": "https://gist.github.com/michelkana/a61484add9111dab3498824829259ac8", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/why-deep-learning-works-289f17cab01a", "anchor_text": "Why Deep Learning Works: solving a farmer\u2019s problemIn the beginning was the neuron: a gentle review of gradient descent, backpropagation, regression, autoencoder, CNNs\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/bayesian-nightmare-how-to-start-loving-bayes-1622741fa960", "anchor_text": "Bayesian nightmare. Solved!Gentle introduction to Bayesian data analysis by examples and code in Python PyMC3.towardsdatascience.com"}, {"url": "https://pypi.org/project/pyjags/", "anchor_text": "PyJAGS"}, {"url": "https://en.wikipedia.org/wiki/Nate_Silver", "anchor_text": "Nate Silver"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7e39a0bae691---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7e39a0bae691---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----7e39a0bae691---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/statistics?source=post_page-----7e39a0bae691---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----7e39a0bae691---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7e39a0bae691&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=-----7e39a0bae691---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7e39a0bae691&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=-----7e39a0bae691---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7e39a0bae691&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7e39a0bae691&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7e39a0bae691---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7e39a0bae691--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7e39a0bae691--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7e39a0bae691--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7e39a0bae691--------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://michel-kana.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michel Kana, Ph.D"}, {"url": "https://michel-kana.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcb0b01fe20d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=post_page-cb0b01fe20d2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F69e95067d2a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-bayesian-logistic-regression-7e39a0bae691&newsletterV3=cb0b01fe20d2&newsletterV3Id=69e95067d2a1&user=Michel+Kana%2C+Ph.D&userId=cb0b01fe20d2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}