{"url": "https://towardsdatascience.com/supercharging-ms-sql-server-with-python-e3335d11fa17", "time": 1683004143.892693, "path": "towardsdatascience.com/supercharging-ms-sql-server-with-python-e3335d11fa17/", "webpage": {"metadata": {"title": "Supercharging MS SQL Server with Python | by James Briggs | Towards Data Science", "h1": "Supercharging MS SQL Server with Python", "description": "At work, I use SQL a lot. It is not without annoying nuances and limitations, but in the end, it is the foundation of all data professions. For that reason, it is an absolute necessity for anyone\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pypi.org/project/pyodbc/", "anchor_text": "pyodbc", "paragraph_index": 11}, {"url": "https://docs.microsoft.com/en-us/sql/connect/python/pyodbc/step-3-proof-of-concept-connecting-to-sql-using-pyodbc?view=sql-server-ver15", "anchor_text": "here", "paragraph_index": 11}, {"url": "https://github.com/jamescalam/pysqlplus", "anchor_text": "GitHub repo", "paragraph_index": 29}, {"url": "https://www.coursera.org/learn/ds", "anchor_text": "here", "paragraph_index": 31}, {"url": "https://www.youtube.com/c/jamesbriggs", "anchor_text": "https://www.youtube.com/c/jamesbriggs", "paragraph_index": 33}], "all_paragraphs": ["At work, I use SQL a lot. It is not without annoying nuances and limitations, but in the end, it is the foundation of all data professions. For that reason, it is an absolute necessity for anyone working in the land of data. Being competent in SQL is incredibly important.", "Although SQL is great, why settle for great? Why don\u2019t we supercharge SQL?", "The limitations of SQL stem from it being a declarative language, meaning we tell SQL what we want and SQL will fetch that from a specified database. For many data extraction or simple data manipulation tasks, this is all that is needed.", "But what if we want more?", "That is exactly what I will show you how to do in this article.", "This code is the foundation to supercharging MS SQL server. Once this is built we can connect to SQL from Python with just:", "Easy right? There are a few things going on, so let\u2019s dissect the code.", "The first thing to note, we are containing this within a class. I have found this approach logical as in this format we add or remove processes for this specific database. This will make more sense once seeing how this works.", "Myself and my colleagues almost always connect to the same server. So I set this common server name as the default argument for server.", "Your server name can be found in the \u2018Connect to Server\u2019 dialog box or at the top of your window in MS SQL Server Management Studio:", "Next, we establish our connection to SQL:", "This is made incredibly easy thanks to the pyodbc module. We simply pass a connection string to the pyodbc.connect(...) function, more details on this can be found here.", "Finally, I like to create a query string within the Sql class which is updated with every query passed to the class:", "This allows us to keep a log of our code and also doubles as a more readable output to colleagues that may be more comfortable reading SQL code.", "Note that I will exclude the update to self.query sections of the code in the following code snippets, please check the full code in the links provided if needed.", "There are a few essential functions that I find incredibly useful and use almost daily. These all focus on transferring data in or out of a database.", "Let's start with the following directory:", "For our current project, we need to:", "After fleshing out our SQL class a little more this will be as easy as:", "This function is contained inside our SQL class. It allows us to easily push a Pandas dataframe to the SQL database.", "This is particularly useful when needing to upload a lot of files. However, the true power in allowing Python to import data to SQL comes with Python\u2019s flexibility.", "Importing a specific tab across a dozen Excel workbooks into SQL can be a nightmare. But with Python it\u2019s easy. Now we have built a function that allows us to use Python to read those tabs and import them into SQL for us.", "This function is actually used in the union and drop functions. It simply allows us to execute SQL code as simply as possible.", "The response argument gives us the option to extract the output of our query to a DataFrame. Allowing us to extract all unique values from colX in our generic_jan table using just:", "Now we have built the manual function, creating the union function is easy:", "This simply loops through a list of table names we provide via table_list, building a UNION query for all table names given. This is then executed with self.manual(query).", "We have the ability to upload a very large number of tables to SQL Server. This is great but can quickly overpopulate our database. To remedy this, we will create a drop function:", "Again, this function is incredibly simple thanks to the manual function. This allows us to either drop a single table by providing a string to tables or to drop multiple tables by providing a list of table names to tables.", "When combined these incredibly simple functions allow us to massively expand the capabilities of SQL Server by leveraging the strengths of Python.", "If you are interested in seeing more please check out the GitHub repo for pysqlplus. This is a small project and is simply built to enhance interaction with MS SQL Server for my own workplace.", "Nonetheless, I hope it may help some other users find ways to incorporate some Python into their SQL routines. I personally use this almost daily, it is so simple yet incredibly powerful.", "If you are interested in learning more about Python and SQL in the cloud, consider my review on IBMs Fundamentals of Scalable Data Science course available on Coursera here:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Freelance ML engineer learning and writing about everything. I post a lot on YT https://www.youtube.com/c/jamesbriggs"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3335d11fa17&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jamescalam.medium.com/?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": "James Briggs"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9d77a4ca1d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&user=James+Briggs&userId=b9d77a4ca1d1&source=post_page-b9d77a4ca1d1----e3335d11fa17---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3335d11fa17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3335d11fa17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@cadop?utm_source=medium&utm_medium=referral", "anchor_text": "Mathew Schwartz"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@abl?utm_source=medium&utm_medium=referral", "anchor_text": "Axel Antas-Bergkvist"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://gist.github.com/jamescalam/1a13bee1d81439ca4b2511d7e9370f53", "anchor_text": "here"}, {"url": "https://pypi.org/project/pyodbc/", "anchor_text": "pyodbc"}, {"url": "https://docs.microsoft.com/en-us/sql/connect/python/pyodbc/step-3-proof-of-concept-connecting-to-sql-using-pyodbc?view=sql-server-ver15", "anchor_text": "here"}, {"url": "https://unsplash.com/@heyluisa?utm_source=medium&utm_medium=referral", "anchor_text": "Luisa Azevedo"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://gist.github.com/jamescalam/74e18f935e223c4aa486dc517e689d84", "anchor_text": "here"}, {"url": "https://gist.github.com/jamescalam/9532e8813f8161e66f420b0f427e7c87", "anchor_text": "this"}, {"url": "https://gist.github.com/jamescalam/586f79e4d9aba64d6e30d70de72d3f90", "anchor_text": "here"}, {"url": "https://gist.github.com/jamescalam/0ee0dfc9b907e6a59f5d3b2ab2d02d9e", "anchor_text": "here"}, {"url": "https://gist.github.com/jamescalam/b316c1714c30986fff58c22b00395cc0", "anchor_text": "here"}, {"url": "https://unsplash.com/@aows?utm_source=medium&utm_medium=referral", "anchor_text": "adrian"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/jamescalam/pysqlplus", "anchor_text": "GitHub repo"}, {"url": "https://www.coursera.org/learn/ds", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/a-summary-of-the-advanced-data-science-with-ibm-specialization-1-4-5caf48c011df", "anchor_text": "A Review of IBM\u2019s Fundamentals of Scalable Data ScienceMy thoughts, with a breakdown of key concepts from the Fundamentals of Scalable Data Science in IBM\u2019s Advanced Data\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/sql?source=post_page-----e3335d11fa17---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/python?source=post_page-----e3335d11fa17---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/automation?source=post_page-----e3335d11fa17---------------automation-----------------", "anchor_text": "Automation"}, {"url": "https://medium.com/tag/coding?source=post_page-----e3335d11fa17---------------coding-----------------", "anchor_text": "Coding"}, {"url": "https://medium.com/tag/data-analytics?source=post_page-----e3335d11fa17---------------data_analytics-----------------", "anchor_text": "Data Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3335d11fa17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&user=James+Briggs&userId=b9d77a4ca1d1&source=-----e3335d11fa17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3335d11fa17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&user=James+Briggs&userId=b9d77a4ca1d1&source=-----e3335d11fa17---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3335d11fa17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe3335d11fa17&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e3335d11fa17---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e3335d11fa17--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3335d11fa17--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e3335d11fa17--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e3335d11fa17--------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jamescalam.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "James Briggs"}, {"url": "https://jamescalam.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.6K Followers"}, {"url": "https://www.youtube.com/c/jamesbriggs", "anchor_text": "https://www.youtube.com/c/jamesbriggs"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9d77a4ca1d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&user=James+Briggs&userId=b9d77a4ca1d1&source=post_page-b9d77a4ca1d1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F75e31c56d187&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupercharging-ms-sql-server-with-python-e3335d11fa17&newsletterV3=b9d77a4ca1d1&newsletterV3Id=75e31c56d187&user=James+Briggs&userId=b9d77a4ca1d1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}