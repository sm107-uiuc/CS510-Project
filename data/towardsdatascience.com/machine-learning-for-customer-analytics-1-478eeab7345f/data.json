{"url": "https://towardsdatascience.com/machine-learning-for-customer-analytics-1-478eeab7345f", "time": 1682995987.843206, "path": "towardsdatascience.com/machine-learning-for-customer-analytics-1-478eeab7345f/", "webpage": {"metadata": {"title": "Machine learning for Customer Analytics \u2014 1 | by Vivek Vijayaraghavan | Towards Data Science", "h1": "Machine learning for Customer Analytics \u2014 1", "description": "Personal loans are a major revenue generating mechanism for banks and all banks reach out to potential customers to campaign for their loan offerings. Most of these campaigns reach out to a random\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/vivekv73/LogReg", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://github.com/vivekv73/LogReg", "anchor_text": "here", "paragraph_index": 60}], "all_paragraphs": ["Personal loans are a major revenue generating mechanism for banks and all banks reach out to potential customers to campaign for their loan offerings. Most of these campaigns reach out to a random database of customers and hence end up into annoying tele-marketing calls than being efficient means for lead conversion.", "In this article, we will see how we could harness the power of machine learning to target the campaigns towards the right set of customers, thereby increasing conversion propensity. We will be using past data available on the demography, bank details, and transaction patterns of customers who have responded and not responded to a personal loan campaign, as training data to predict the probability if a customer will respond to the campaign.", "In machine learning terminology, this is a classification problem and there are several classification algorithms available to build a prediction model out of which we will be using Logistic regression.", "Logistic Regression is a popular and powerful supervised machine learning technique used to build a model relating the independent predictors (x variable) with the response variable (y) that is categorical in nature. Where the class is known already, it can help find factors distinguishing between records in different classes in terms of the predictor variables in the dataset.", "When the outcome variable has just two classes (Eg: Pass/Fail; Fraudulent/Not Fraudulent; Default/No Default) binomial logistic regression is applied and multinomial logistic regression is applied if we have more than two classes (Eg: Buy/Sell/Hold).", "Logistic regression is a statistical technique and provides a detailed statistical summary in terms of statistical significance of the predictor variables and how each predictor variable impacts the probability of the classes of the Y variable. These unique qualities make this algorithm highly relevant to the Banking & Finance domain to provide detailed and numerical interpretation of the predictor variables.", "We have a dataset that provides details from a bank about a \u2018Personal Loan\u2019 campaign that was executed by the bank. 20,000 customers were targeted with an offer of personal loan at 14% interest rate, out of which 2512 customers responded positively. The dataset and the data dictionary can be downloaded here.", "The flow chart below depicts the high level approach we will pursue to finding a solution to this classification problem using Logistic Regression, starting with defining the problem statement to calculating the accuracy of the built model towards classifying new customers.", "We are going to use Logistic Regression to build a model which will predict propensity (probability) of customers responding to a personal loan campaign. The probabilities from the model will be used to classify the outcome and identify variables that influence the response. The goal is to build a model that identifies customers who are most likely to accept the loan offer in future personal loan campaigns.", "As the first step, we set up the working directory and read the dataset in csv format into R:", "Next, we view the dataset using basic commands in R to understand the columns and their data types, and number of records present.", "Upon viewing and exploring the dataset, we infer:", "Based on data exploration, we also note that the following actions are required to prepare the dataset for further analysis:", "The four unwanted columns have been removed and data types have been corrected for the five variables listed above.", "Let\u2019s check for any missing values in the dataset:", "There are no missing values in the dataset.", "Now that the dataset is ready for modelling, let\u2019s check the baseline customer response rate for the observations in the dataset:", "We can see that the dataset is clearly imbalanced \u2014 only 13% of the customer records have a response (class 1) against no response from the remaining 87% records (class 0). This will have an impact on model performance measures that we will see in detail in the later part of this analysis.", "In this section, I will explore the data set further in the form of data visualization using ggplot2 in R. This will help provide initial insights on the distribution of the numeric variables as well as important features impacting the response variable.", "Histogram plots for important independent numeric variables", "From the histograms we can see that", "Boxplots for important independent numeric variables", "From the box plots, we can visualize and infer:", "Bar plot for important categorical variables", "We can infer from the bar plots that", "Boxplot for numeric variables vs TARGET (y variable)", "When we look at the data visualization from bivariate analysis of numeric variables against the categorical target variable, we get the following insights:", "AGE vs Target (TARGET: responded to loan campaign = 1; Did not respond to loan campaign = 0)", "The median age of customers who responded to the campaign is slightly higher than the age of those who didn\u2019t respond. There is not much differentiation though between the two classes based on Age, an inference we also draw from Length of Relationship with Bank in Months vs TARGET class.", "Customers who had lesser median holding period (Ability to hold money in the account) of around 10 months are the ones who had responded to the personal loan campaign.", "Stacked Bar plot for Categorical x variables vs TARGET (y variable)", "Bivariate analysis of categorical x variables against the TARGET y variable using stacked barplot helps us visualize the following:", "Next, we we will split the dataset into training and test datasets. We will build the model based on the training dataset and test the model performance using the test dataset.", "The prop.table output above confirms that the imbalanced dataset characteristic that we saw in the original dataset is maintained at the same proportions in the development and hold out samples as well.", "The training dataset is now ready to build the model.", "The Generalized Linear Model command glm is used in R to build the model using Logistic Regression.", "Let\u2019s check for multi-collinearity among the x variables through the Variable Inflation Factor (VIF) check based on the model we have generated.", "Feature (x) variables with a VIF value above 4 indicate high degree of multi-collinearity.", "From the table below, we note the following variables have VIF value above 4: NO_OF_L_CR_TXNS, NO_OF_L_DR_TXNS, NO_OF_ATM_DR_TXNS, AMT_MOB_DR, AVG_AMT_PER_MOB_TXN.", "We remove these x variables that have high multi-collinearity from the train and test datasets and re-run the model. This should help identify variables that clearly impact the response variable (TARGET \u2014 y variable) and also build a model that can classify records more accurately.", "This process is repeated until we get a clean VIF output with values below 4.", "We can see that the low p value indicates the model is highly significant i.e. the likelihood of a customer responding to the campaign (TARGET) depends on independent x variables in the dataset.", "Step 3: McFadden or pseudo R\u00b2 interpretation", "Based on the value of McFadden R\u00b2, we can conclude that 8.7% of the uncertainty of the intercept-only model is explained by the full model (current x variables). This value indicates a low goodness of fit. This could be indicative of the fact that more x variables need to be added to explain the variation in the response (y) variable.", "Step 4: Individual coefficients significance and interpretation", "From the summary of the generated model, we infer that there are some x variables that are significant based on their p value. These are the x variables that influence the customer responding to the campaign and are shown in the table below.", "The Odds Ratio and Probability of each x variable is calculated based on the formulae,", "Probability = Odds Ratio / (1 + Odds Ratio)", "Inferences from the Logistic Regression summary:", "Using the model we just built, let\u2019s try predicting the propensities and class for records in the validation sample. Note that we already know the class for these records and will use that input to compare and find out how good the new model is when it comes to classifying new records.", "The model has output propensities for the individual records in the validation set.", "To determine the cut-off value for classifying the records based on the probabilities, we look at the distribution of the probabilities predicted.", "If we look at the distribution, most of the records have probability values below 10%. So, we use a cut-off value of 0.1 to to predict the class for the records.", "The model has predicted the class (TARGET value 0 or 1) for each record. Let\u2019s create the Confusion Matrix to see how well the model has classified the records against the known TARGET values for these records in the validation set.", "The Confusion Matrix provides a clear snapshot of the accuracy of the model.", "Sensitivity is more important than accuracy here as we are more interested in knowing all those records where a customer will respond to a new campaign rather than those records where a customer may not respond at all. The lost opportunity cost in contacting a potential customer, who would avail a loan and thereby pay interest to the bank, due to incorrect classification by the model (sensitivity) is more critical than potentially non-responding customers receiving mailers or calls due to incorrect classification (specificity).", "When we compare the model performance measures between the train and test data (see table below), the model holds good for the test data without a significant drop in performance measures. This indicates that there is no overfit in the model.", "For predicting the class with this model, we have consciously compromised on accuracy to have a better sensitivity i.e. not to lose out on potential customers who will respond to the loan campaign.", "Based on the model built above, we can make the following recommendations to the bank:", "Here, we have used Binomial Logistic Regression technique not only to predict the class of customers responding to the loan campaign but also get a list of statistically significant independent variables that influence the customer response to the campaign. We are also able to predict the probability of a customer responding or not responding based on the model summary. These give powerful insights which will help in improving the response rate from the customers and thereby conversion to availing loans with the bank.", "The original dataset, data dictionary and full code in R are available here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Experienced Operations Management Professional | Process Excellence Evangelist | Customer Analytics Enthusiast"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F478eeab7345f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----478eeab7345f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----478eeab7345f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vivekv73?source=post_page-----478eeab7345f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vivekv73?source=post_page-----478eeab7345f--------------------------------", "anchor_text": "Vivek Vijayaraghavan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a3d68535630&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&user=Vivek+Vijayaraghavan&userId=5a3d68535630&source=post_page-5a3d68535630----478eeab7345f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F478eeab7345f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F478eeab7345f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@photoripey?utm_source=medium&utm_medium=referral", "anchor_text": "Ibrahim Rifath"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/vivekv73/LogReg", "anchor_text": "here"}, {"url": "https://github.com/vivekv73/LogReg", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----478eeab7345f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----478eeab7345f---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/customer-engagement?source=post_page-----478eeab7345f---------------customer_engagement-----------------", "anchor_text": "Customer Engagement"}, {"url": "https://medium.com/tag/logistic-regression?source=post_page-----478eeab7345f---------------logistic_regression-----------------", "anchor_text": "Logistic Regression"}, {"url": "https://medium.com/tag/statistical-modeling?source=post_page-----478eeab7345f---------------statistical_modeling-----------------", "anchor_text": "Statistical Modeling"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F478eeab7345f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&user=Vivek+Vijayaraghavan&userId=5a3d68535630&source=-----478eeab7345f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F478eeab7345f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&user=Vivek+Vijayaraghavan&userId=5a3d68535630&source=-----478eeab7345f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F478eeab7345f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----478eeab7345f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F478eeab7345f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----478eeab7345f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----478eeab7345f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----478eeab7345f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----478eeab7345f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----478eeab7345f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----478eeab7345f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----478eeab7345f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----478eeab7345f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----478eeab7345f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vivekv73?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vivekv73?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vivek Vijayaraghavan"}, {"url": "https://medium.com/@vivekv73/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "47 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5a3d68535630&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&user=Vivek+Vijayaraghavan&userId=5a3d68535630&source=post_page-5a3d68535630--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F5a3d68535630%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-for-customer-analytics-1-478eeab7345f&user=Vivek+Vijayaraghavan&userId=5a3d68535630&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}