{"url": "https://towardsdatascience.com/just-released-bigquery-user-friendly-sql-functions-979fca9cd007", "time": 1683015795.794998, "path": "towardsdatascience.com/just-released-bigquery-user-friendly-sql-functions-979fca9cd007/", "webpage": {"metadata": {"title": "BigQuery truncate table and dynamic SQL | Towards Data Science", "h1": "Just Released: BigQuery User-friendly SQL Functions", "description": "BigQuery receives a further boost this week with the release of 12 new BigQuery SQL features, from truncate table to dynamic SQL"}, "outgoing_paragraph_urls": [{"url": "https://www.ancoris.com/google-bigquery", "anchor_text": "BigQuery", "paragraph_index": 0}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language#alter_table_add_column_statement", "anchor_text": "BigQuery documentation.", "paragraph_index": 2}, {"url": "https://cloud.google.com/bigquery/pricing#free", "anchor_text": "BigQuery free operations", "paragraph_index": 3}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language#create_external_table_statement", "anchor_text": "examples of creating a federated table", "paragraph_index": 10}, {"url": "https://cloud.google.com/bigquery/docs/exporting-data", "anchor_text": "Bigquery supported data formats and compression types", "paragraph_index": 11}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/other-statements#export_data_statement", "anchor_text": "BigQuery EXPORT DATA documentation", "paragraph_index": 12}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting#execute_immediate", "anchor_text": "BigQuery dynamic SQL support", "paragraph_index": 16}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/user-defined-functions#temporary-udf-syntax", "anchor_text": "BigQuery UDFs", "paragraph_index": 18}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions", "anchor_text": "BigQuery SQL functions for manipulating strings", "paragraph_index": 26}, {"url": "https://cloud.google.com/bigquery/docs/information-schema-intro", "anchor_text": "BigQuery INFORMATION_SCHEMA documentation", "paragraph_index": 32}, {"url": "https://cloud.google.com/blog/topics/developers-practitioners/smile-new-user-friendly-sql-capabilities-bigquery", "anchor_text": "Google Cloud Bigquery release notes", "paragraph_index": 36}, {"url": "https://www.ancoris.com/solutions/data_analytics_ai", "anchor_text": "Ancoris Data, Analytics & AI", "paragraph_index": 37}], "all_paragraphs": ["We were excited to see the power of BigQuery receive a further boost this week with the release of 12 new BigQuery SQL features. Google Cloud describes these as \u201cuser-friendly SQL capabilities\u201d. So, let\u2019s take a look at what\u2019s now possible.", "New to BigQuery is the ability to add new columns via the ALTER TABLE DDL statement. This is something data professionals with a background in traditional on-prem database platforms would expect as standard, so nice to see that Google Cloud has acknowledged this.", "We like the syntax for only adding a column if one doesn\u2019t already exist, handy for idempotent deployments. Full support for records too. Learn more from the BigQuery documentation.", "TRUNCATE TABLE is now supported, which will please those from an on-prem background. Unlike a DELETE DML statement in BigQuery which incurs a scan cost, TRUNCATE falls under the growing list of BigQuery free operations. We will certainly be using this one a lot.", "To reduce query scan costs we recommend using TRUNCATE over delete whenever you need to delete the entire contents of a table.", "BigQuery now supports Unicode table naming. Acknowledging multi-language support, table names are no longer just restricted to letters, numbers and underscores.", "Be careful with table naming and try and make sure they are consistent, readable and follow a naming convention within your organisation.", "At Ancoris we love federated (EXTERNAL) tables in BigQuery; they act as a powerful, zero-data-engineering approach to easily ingest files from Google Cloud Storage, including commonly seen formats such as JSON and CSV.", "Great to see that you can now create external tables using a DDL statement.", "Here\u2019s an example to create a table that reads csvs from two different storage URIs:", "To learn more, see these examples of creating a federated table. We plan to do a tech how-to to over the coming weeks to show just what is possible.", "This is a little buried in the release notes, but in our opinion is a really powerful feature. You can now export the results of a BigQuery query to Google Cloud Storage using the new EXPORT DATA SQL command; all of the Bigquery supported data formats and compression types are supported.", "Here\u2019s an example taken from the BigQuery EXPORT DATA documentation.", "Great to see there are no egress costs; you only pay for any BigQuery data scanned and data stored in GCS.", "This appears to reinforce Google Cloud\u2019s aspirations of reducing the need for complex data engineering, something we (and many of our clients) share. If you couple this with, say, a Cloud Function triggered from the target GCS bucket, this could provide a simple mechanism for delivering data into data pipelines outside of BigQuery.", "BigQuery now supports the execution of dynamic SQL. The syntax is very familiar, especially to those from a MS SQL background.", "See BigQuery dynamic SQL support for further examples.", "As a general rule, we are very cautious of using dynamic SQL and we try and avoid it where possible (mainly because of the risk of SQL injection and it tends to make code more difficult to read and debug).", "For those of you not familiar with BigQuery UDFs, these are a scalar function in BigQuery that allow you to operate over data using either SQL or Javascript (and associated Javascript libraries).", "BigQuery now supports authorized UDFs, which allows authorized consumers (via IAM) to query tables in the dataset, even if the user who calls the UDF does not have access to those tables. Those of you from an MS SQL background, this is similar to permissioning say, a table-value function in SQL Server; often these are used as a security layer over (locked down) tables and enforce row/column level security.", "BigQuery will now allow you to select the same (unaliased) column more than once in a query by appending a suffix of _n where n is the number of duplications observed.", "BigQuery already has excellent support for DATE manipulations using SQL. It looks like in this release, Google Cloud has recognised a common business-lead use case; finding the last date for a given period e.g. the last day of the month or last day of the week.", "The new LAST_DAY function has intuitive syntax, and is easy to read:", "Note by default, this will return the next Saturday because weeks start on Sunday in BigQuery.", "To force the week to start on Monday:", "We are used to using data_add and date_sub functions for doing date arithmetic, but you can now do this using the + and \u2014 operators.", "A number (14 in all) of new BigQuery SQL functions for manipulating strings. Here are the ones we particularly like:", "As a team we think this method for concatenating strings is easier to read than the concat function.", "This returns the index of a search value in a string. Note the first character in the string is indexed as 1 and 0 is returned if the string is not found.", "The third argument is the position and denotes where to start the search. The default is 1. If a negative number is supplied, this denotes to start -n chars from the end of the string.", "The last argument is the occurrence and if supplied specifies the occurrence of the string to search for e.g. 2 implies to find the index of the second occurrence of the search value.", "This made our list because we all thought it\u2019s pretty neat. This function returns the phonetic of a word represented as a soundex code (alpha followed by 3 digits). The algorithm was first patented in 1918 and is useful in fuzzy logic matching, for example to detect typos of people\u2019s name:", "INFORMATION_SCHEMA, specified in the ANSI SQL standard, allows users to query the metadata about various objects or entities that contain or reference data, such as tables, views, stored procedures and user-defined functions. Here is the BigQuery INFORMATION_SCHEMA documentation.", "BigQuery has made this easier with the introduction of a number of new objects that cover tables, views, routines (stored procedures, UDFs) and datasets.", "Note the tables are uppercase (BigQuery is case sensitive).", "In summary, a really good addition to the BigQuery SQL arsenal and we will certainly be using this on client projects. Some of these topics we will cover in our upcoming Data how-to series.", "1. Read the Google Cloud Bigquery release notes", "2. Learn more about Ancoris Data, Analytics & AI", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Head of Data, Analytics & AI @ Ancoris. Part of a highly committed team of data scientists, mathematicians & engineers delivering Google Cloud client solutions"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F979fca9cd007&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----979fca9cd007--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----979fca9cd007--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://google-cloud-data.medium.com/?source=post_page-----979fca9cd007--------------------------------", "anchor_text": ""}, {"url": "https://google-cloud-data.medium.com/?source=post_page-----979fca9cd007--------------------------------", "anchor_text": "James Green"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe242c1ce5f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&user=James+Green&userId=e242c1ce5f6d&source=post_page-e242c1ce5f6d----979fca9cd007---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F979fca9cd007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F979fca9cd007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.ancoris.com/google-bigquery", "anchor_text": "BigQuery"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language#alter_table_add_column_statement", "anchor_text": "BigQuery documentation."}, {"url": "https://cloud.google.com/bigquery/pricing#free", "anchor_text": "BigQuery free operations"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language#create_external_table_statement", "anchor_text": "examples of creating a federated table"}, {"url": "https://cloud.google.com/bigquery/docs/exporting-data", "anchor_text": "Bigquery supported data formats and compression types"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/other-statements#export_data_statement", "anchor_text": "BigQuery EXPORT DATA documentation"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting#execute_immediate", "anchor_text": "BigQuery dynamic SQL support"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/user-defined-functions#temporary-udf-syntax", "anchor_text": "BigQuery UDFs"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions", "anchor_text": "BigQuery SQL functions for manipulating strings"}, {"url": "https://cloud.google.com/bigquery/docs/information-schema-intro", "anchor_text": "BigQuery INFORMATION_SCHEMA documentation"}, {"url": "https://cloud.google.com/blog/topics/developers-practitioners/smile-new-user-friendly-sql-capabilities-bigquery", "anchor_text": "Google Cloud Bigquery release notes"}, {"url": "https://www.ancoris.com/solutions/data_analytics_ai", "anchor_text": "Ancoris Data, Analytics & AI"}, {"url": "https://www.linkedin.com/in/google-cloud-platform/", "anchor_text": "author"}, {"url": "https://medium.com/tag/data?source=post_page-----979fca9cd007---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/google?source=post_page-----979fca9cd007---------------google-----------------", "anchor_text": "Google"}, {"url": "https://medium.com/tag/sql?source=post_page-----979fca9cd007---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/bigquery?source=post_page-----979fca9cd007---------------bigquery-----------------", "anchor_text": "Bigquery"}, {"url": "https://medium.com/tag/gcp?source=post_page-----979fca9cd007---------------gcp-----------------", "anchor_text": "Gcp"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F979fca9cd007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&user=James+Green&userId=e242c1ce5f6d&source=-----979fca9cd007---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F979fca9cd007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&user=James+Green&userId=e242c1ce5f6d&source=-----979fca9cd007---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F979fca9cd007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----979fca9cd007--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F979fca9cd007&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----979fca9cd007---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----979fca9cd007--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----979fca9cd007--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----979fca9cd007--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----979fca9cd007--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----979fca9cd007--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----979fca9cd007--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----979fca9cd007--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----979fca9cd007--------------------------------", "anchor_text": ""}, {"url": "https://google-cloud-data.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://google-cloud-data.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "James Green"}, {"url": "https://google-cloud-data.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "216 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe242c1ce5f6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&user=James+Green&userId=e242c1ce5f6d&source=post_page-e242c1ce5f6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F354049f3c33d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fjust-released-bigquery-user-friendly-sql-functions-979fca9cd007&newsletterV3=e242c1ce5f6d&newsletterV3Id=354049f3c33d&user=James+Green&userId=e242c1ce5f6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}