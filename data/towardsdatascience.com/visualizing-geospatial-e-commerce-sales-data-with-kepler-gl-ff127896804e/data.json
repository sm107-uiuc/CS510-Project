{"url": "https://towardsdatascience.com/visualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e", "time": 1683005605.888905, "path": "towardsdatascience.com/visualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e/", "webpage": {"metadata": {"title": "Visualizing Geospatial E-Commerce Sales Data with kepler.gl | by Thomas Trovato | Towards Data Science", "h1": "Visualizing Geospatial E-Commerce Sales Data with kepler.gl", "description": "(originally posted at https://www.dattivo.com/visualizing-geospatial-e-commerce-sales-data-with-kepler-gl/) As a part of an internal research and discovery exercise, we wanted to assess the usability\u2026"}, "outgoing_paragraph_urls": [{"url": "https://kepler.gl", "anchor_text": "kepler.gl", "paragraph_index": 0}, {"url": "https://kepler.gl/demo", "anchor_text": "https://kepler.gl/demo", "paragraph_index": 1}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas", "paragraph_index": 5}, {"url": "https://requests.readthedocs.io/en/master/", "anchor_text": "Requests", "paragraph_index": 5}, {"url": "https://geocoder.readthedocs.io/", "anchor_text": "Geocoder", "paragraph_index": 5}, {"url": "https://kepler.gl/demo", "anchor_text": "https://kepler.gl/demo", "paragraph_index": 9}, {"url": "https://eng.uber.com/keplergl/", "anchor_text": "From Beautiful Maps to Actionable Insights: Introducing kepler.gl, Uber\u2019s Open Source Geospatial Toolbox", "paragraph_index": 24}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas \u2014 Python Data Analysis Library", "paragraph_index": 25}], "all_paragraphs": ["As a part of an internal research and discovery exercise, we wanted to assess the usability and features of visual data analysis tools to examine an online ticket sales dataset for an event being run by one of our clients. Our dataset includes the locations of customers purchasing tickets online for the event, and how far in advance tickets for the event were being purchased. In this situation, a data visualization tool such as kepler.gl\u00b9 was a perfect fit for quickly generating a view of the data that can be easily understood by any observer.", "Kepler.gl is an open source geospatial data analysis and visualization tool developed by Uber.\u00b9 Kepler.gl can be integrated directly into a React-based web application or Jupyter notebook. For this exercise we will be using the \u201cdemo application\u201d at https://kepler.gl/demo.\u00b3", "Please note that although these visualizations have been inspired by a real-life event, the actual visualizations have been put together solely for purpose of demonstrating kepler.gl.", "Before we can perform any geospatial analysis on our order dataset, we first need to geocode the addresses attached to our orders by assigning a latitude and longitude to each order. For our dataset, a MySQL database of customer orders and associated details, we will do this based on the postal code from the customer\u2019s billing address. Many providers offer geocoding APIs with varying price points and request limits, but for this exercise we will use Google\u2019s Geocoding API. For best results (and general readability of the dataset), we\u2019ve \u201cnormalized\u201d the postal codes by converting letters to uppercase and filtering out any spaces, hyphens, or other non-alphanumeric characters.", "After our initial dataset has been exported to a CSV file, the next step is to retrieve the geocoded data. This was accomplished using a Python script, but this can of course be done with any language that allows you to make HTTP requests and/or write to a CSV. First, we import the necessary libraries, and load the geocoded data into a Pandas DataFrame object:", "Pandas\u2074 is a very powerful open source library for Python with many features for data manipulation and analysis. It can quickly and efficiently read and write data in Series or in DataFrame objects, working with CSV, Excel, or text files, as well as database exports. Next, we\u2019ll begin the process of building a postal code \u201cdirectory\u201d, mapping a postal code to its latitude and longitude values. An example of an entry might be: [N6J3T9, 43.3326543, -79.4324534]. We\u2019ll use this to decorate our current dataset, but also keep it on-hand for future use so that we can apply it to any repeated postal codes in future without having to make redundant API calls. To make these requests to Google\u2019s Geocoding API, we use the open source Requests\u2075 library for Python, which offers simple functions for making HTTP requests, to create a Session object for making our multiple requests. We also use the Geocoder\u2076 library, which comes with simple functions to make geocode API requests to many different providers, including Google, Bing, ArcGIS, and more.", "This code will iterate through each of the unique postal codes in our dataset and make a request to obtain its approximate latitude and longitude. We\u2019ll both save the response to our directory file and output it to the console so that we can still copy it to a file in case something goes awry while the script is running. If the script does get interrupted for any reason and we end up with only a partial set of geocoded data, we can simply repeat the process with any already geocoded values filtered out and merge the resulting files together.", "Once we have our geocode data, we can use Pandas to decorate our initial customer data export with it.", "With the data prepared, we\u2019re now ready to import it into kepler.gl.", "Loading data into kepler.gl is simple, with the demo application at https://kepler.gl/demo providing an intuitive way to start viewing your data on a map immediately. When the page first loads, you\u2019ll be prompted to upload your data. Note that the kepler.gl demo runs in your browser, so any uploaded data are not sent to their servers but remain on your local machine.", "Based on the columns in the dataset, kepler.gl will attempt to automatically decide how to render the data. If your dataset has columns labelled \u2018lat\u2019 and \u2018lng\u2019, kepler.gl will automatically recognize them and use those fields to place your data on the map.", "The columns to use for latitude and longitude can also be manually specified when defining your data layer. Click the carat next to the name of the layer to view settings, then click the ellipsis next to \u201cBasic\u201d to select which columns to use for your point locations.", "The map in its current state is showing us the location of each individual ticket purchased, but kepler.gl offers different layer types that we can use to aggregate the data. For this exercise, we\u2019ll use a Hexbin layer, which aggregates datapoints into a hexagon of a specified radius (1km by default).", "A colour on a selected spectrum is assigned to each Hexbin based on a specified metric. This is based on the point count by default but can be changed to any column in your dataset. The colour scale used and the number of steps in the spectrum can also be configured.", "If we switch from a 2D map to a 3D map by toggling the cube icon in the top-right, we can assign a height value to our hexbins based on another field from our dataset. For this example, we\u2019ll have the height represent the number of points per cluster (which, in our case, represent the number of tickets purchased), and have the colour represent how many days in advance of the event date the tickets were purchased. An elevation scale can also be applied, to more easily identify extreme values in the dataset.", "Visually we see represented that although there are customers who will purchase in advance across the province, those further away from the centre of Toronto appear to be more likely to purchase closer to the event date (where darker datapoints indicate that the ticket was purchased on the day of the event). This makes sense since variables such as weather will factor into the customer\u2019s decision-making process.", "Next, we can apply a filter to the dataset based on any of its columns. Click the funnel icon to switch to the Filters tab, then click Add Filter and select a column.", "For numeric or \u201ctime\u201d datatypes (eg formatted as a date and time like 2019\u201312\u201325 12:00:00), you can select the minimum, maximum, and range of values for the column to filter to by clicking and dragging on the displayed range. When filtering by time values, you can also click the play button to show a time lapse animation of the map data (you\u2019ll need to click and drag the edges of the date filter interval at the bottom of the screen for this to be useful). For other datatypes such as strings or dates, specific values can be selected to filter by.", "If we want to compare data across multiple datasets (eg between multiple years of event sales data), we can simply add another layer to our visualization in kepler.gl. At this point, it\u2019s helpful to rename your layers from the Layers tab from the default \u201cPoint\u201d label to more easily differentiate between them in the menus and legend.", "You can display multiple layers on the same map view if you wish, but if we\u2019re trying to do a direct comparison between similar datasets as in this example, it makes more sense for us to view each dataset on its own map. We can do this by clicking the icon in the top right to switch to dual map view, and toggle which layers are visible in each view. Note that filters are applied separately to each layer.", "As mentioned earlier, the initial geocode data retrieval and decoration of the dataset can be accomplished through any number of methods, but we chose to use the mentioned Python libraries in order to assess their utility for future projects. This exercise did not go in-depth into Pandas functionality, but we\u2019d encourage you to look into it to see if it may suit your needs, as it offers a wide variety of features.", "Kepler.gl allows for professional looking data visualizations to be generated very quickly and offers many different types of data visualization. In addition to the points and hexbins demonstrated here, kepler.gl\u2019s available data layers include heatmaps and clusters for aggregate analysis, arcs and lines for visualizing movement, and GeoJSON layers for displaying complex paths or polygons like trip routes. If we need to perform these types of analyses in future, kepler.gl would be an obvious choice. The generated views have a definite \u201cwow\u201d factor when presented for the first time, and can provide clear, actionable insights depending on the data being investigated", "Kepler.gl is also available as a React library that can be integrated into existing frontend projects. For future work, we may investigate implementing the ability to view subsets of recent sales data in a kepler.gl map embedded into a management interface.", "One thing to watch out for: the scale of the colour and height/size of your datapoints will change dynamically based on the subset of data being currently examined. This means that when comparing data from one view to another, you\u2019ll have to keep an eye on the legend to ensure that the conclusions you\u2019re drawing are accurate. For example, two points from different filtered sets of your data may have the same colour, but the range of values for which a particular colour is assigned may vary between the views (eg. A point may appear red for a value less than 16.2 in one view, where in the other view the threshold is 12.0). Unfortunately, there does not currently appear to be a way to standardize this scale when performing timeseries playback or using the dual map view.", "[2] S. He, From Beautiful Maps to Actionable Insights: Introducing kepler.gl, Uber\u2019s Open Source Geospatial Toolbox (2018)", "[4] pandas \u2014 Python Data Analysis Library", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer at Dattivo Software in London, ON"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fff127896804e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff127896804e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff127896804e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thomt17?source=post_page-----ff127896804e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thomt17?source=post_page-----ff127896804e--------------------------------", "anchor_text": "Thomas Trovato"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8954e3f0547&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&user=Thomas+Trovato&userId=8954e3f0547&source=post_page-8954e3f0547----ff127896804e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff127896804e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff127896804e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.dattivo.com/visualizing-geospatial-e-commerce-sales-data-with-kepler-gl/", "anchor_text": "https://www.dattivo.com/visualizing-geospatial-e-commerce-sales-data-with-kepler-gl/"}, {"url": "https://kepler.gl", "anchor_text": "kepler.gl"}, {"url": "https://kepler.gl/demo", "anchor_text": "https://kepler.gl/demo"}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas"}, {"url": "https://requests.readthedocs.io/en/master/", "anchor_text": "Requests"}, {"url": "https://geocoder.readthedocs.io/", "anchor_text": "Geocoder"}, {"url": "https://kepler.gl/demo", "anchor_text": "https://kepler.gl/demo"}, {"url": "https://kepler.gl/", "anchor_text": "kepler.gl"}, {"url": "https://eng.uber.com/keplergl/", "anchor_text": "From Beautiful Maps to Actionable Insights: Introducing kepler.gl, Uber\u2019s Open Source Geospatial Toolbox"}, {"url": "https://kepler.gl/demo", "anchor_text": "kepler.gl/demo"}, {"url": "https://pandas.pydata.org/", "anchor_text": "pandas \u2014 Python Data Analysis Library"}, {"url": "https://requests.readthedocs.io/en/master/", "anchor_text": "Requests: HTTP for Humans \u2014 Requests 2.23.0 documentation"}, {"url": "https://geocoder.readthedocs.io/", "anchor_text": "Geocoder: Simple, Consistent \u2014 geocoder 1.38.1 documentation"}, {"url": "https://medium.com/tag/keplergl?source=post_page-----ff127896804e---------------keplergl-----------------", "anchor_text": "Keplergl"}, {"url": "https://medium.com/tag/python?source=post_page-----ff127896804e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----ff127896804e---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/geospatial?source=post_page-----ff127896804e---------------geospatial-----------------", "anchor_text": "Geospatial"}, {"url": "https://medium.com/tag/ecommerce?source=post_page-----ff127896804e---------------ecommerce-----------------", "anchor_text": "Ecommerce"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff127896804e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&user=Thomas+Trovato&userId=8954e3f0547&source=-----ff127896804e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fff127896804e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&user=Thomas+Trovato&userId=8954e3f0547&source=-----ff127896804e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fff127896804e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ff127896804e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fff127896804e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ff127896804e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ff127896804e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ff127896804e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ff127896804e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ff127896804e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ff127896804e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ff127896804e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ff127896804e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ff127896804e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thomt17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thomt17?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Thomas Trovato"}, {"url": "https://medium.com/@thomt17/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8954e3f0547&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&user=Thomas+Trovato&userId=8954e3f0547&source=post_page-8954e3f0547--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F8954e3f0547%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-geospatial-e-commerce-sales-data-with-kepler-gl-ff127896804e&user=Thomas+Trovato&userId=8954e3f0547&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}