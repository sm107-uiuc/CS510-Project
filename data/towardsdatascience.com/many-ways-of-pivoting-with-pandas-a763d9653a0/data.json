{"url": "https://towardsdatascience.com/many-ways-of-pivoting-with-pandas-a763d9653a0", "time": 1683009284.478615, "path": "towardsdatascience.com/many-ways-of-pivoting-with-pandas-a763d9653a0/", "webpage": {"metadata": {"title": "Many ways of Pivoting with Pandas | by Sruthi Korlakunta | Towards Data Science", "h1": "Many ways of Pivoting with Pandas", "description": "Pandas offers an endless number of data exploration tools that are intuitive to use and are worth having at the tip of your fingers. This article explores one such tool, pivoting. On multiple\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Pandas offers an endless number of data exploration tools that are intuitive to use and are worth having at the tip of your fingers. This article explores one such tool, pivoting. On multiple occasions, data is obtained in its raw state as a linear tabular/unpivoted/stacked form as shown under:", "This is a very convenient form of data to work with, especially when dealing with visualization tools like Tableau, Power BI, Qlik, and the like. Most of the interpretations or pivots such as \u201corders per customer/date/product\u201d are inbuilt to these tools.", "A pivoted form of such a table makes visualization with tools or further processing with pandas tedious. However, there are scenarios where it might be necessary to look at the raw data in a tabular form, where cross-tables or pivots are the most preferable and intuitive forms of presentation for the human eye. This is also a preferred format to extract the data from the source since it condenses the data into fewer lines and avoids repetitive entries. Here is an example of the above data pivoted with excel (Gesamtergebnis means Grand Total, Pardon my German):", "I will compare various forms of pivoting with pandas in this article. Pandas offers the following functions to pivot data: crosstab, pivot, pivot_table, and groupby. For this example, you only need the following libraries:", "Crosstab is the most intuitive and easy way of pivoting with pandas. It automatically counts the number of occurrences of the column value for the corresponding row. You could use the aggregation function (aggfunc) to specify a different aggregation to fill in this pivot.", "I now want to see how much total quantity of each product was ordered by each customer (by his customer ID):", "Crosstab is intuitive in how it works. Since we wanted to see the sum of \u201cQuantity\u201d in the pivot table result, we passed this column to values and aggregation function as \u2018sum\u2019. The kwargs \u2018margin\u2019 and \u2018margin_name\u2019 specify if we want the output to contain a grand total column analogous to excel.", "In crosstab, if you do not specify the values argument, it returns the frequency of occurrence of the column value:", "If you want to group more than one column/rows to the pivot, you only have to pass the columns as a list like this:", "with a keyword argument called \u201cnormalize,\u201d you can choose to express all your values as a percent of the total. Include normalize= \u201cindex\u201d/ \u201ccolumns\u201d/ \u201call\u201d to normalize your values to the total. Here is the output for normalization across columns:", "pandas offers a pretty basic pivot function that can only be used if the index-column combinations are unique. It does not make any aggregations on the value column nor does it simply return a count like crosstab. Take the same example as above:", "The Customer ID PRSDNT ordered the same Product A twice with different order numbers. Since the pivot function does not perform aggregations, it does not know what to fill for \u201cvalue\u201d in that column.", "This would work for a unique combination of index+column like in this example:", "When we have such ambiguous entries, which is most of the time the case in real-world applications, we use the more flexible pivot_table function which allows for aggregations.", "The Pivot table function is similar to a crosstab", "you could also pass multiple aggregation functions to return a set of columns for each aggregation function. Here [sum, len, mean] have been passed, len meaning the count of entries. You can also extend the same to multiple values by passing a list analogous to the index list.", "Whether you use pandas crosstab or a pivot_table is a matter of choice. Note that you don\u2019t need your data to be in a data frame for crosstab. You can crosstab also arrays, series, etc.", "Groupby is a very handy pandas function that you should often use. Let\u2019s check out how we groupby to pivot. We want to get the sum of the quantities ordered by the customer per product:", "In this method, you can specify how you want to aggregate each column. (Example, If you had another column called \u2018weight\u2019 for which you want mean, you could specify that as:", "You could also apply filters to your group with the handy filter function of groupby for ease. Say you want to see only customers and their addresses when they ordered at least 4 or more products:", "The filter takes a lambda function argument which specifies the function that a specific column aggregate should satisfy.", "That\u2019s about basic pivoting with pandas. See you later with some more pandas hacks!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write on tech, books, and lifestyle. | Data analyst | Made human by all the people who love me."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa763d9653a0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@sruthi", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----a763d9653a0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a763d9653a0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sruthi-korlakunta.medium.com/?source=post_page-----a763d9653a0--------------------------------", "anchor_text": ""}, {"url": "https://sruthi-korlakunta.medium.com/?source=post_page-----a763d9653a0--------------------------------", "anchor_text": "Sruthi Korlakunta"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5aba4019abc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&user=Sruthi+Korlakunta&userId=5aba4019abc1&source=post_page-5aba4019abc1----a763d9653a0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa763d9653a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa763d9653a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/kzlxOJwD6i8", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/python?source=post_page-----a763d9653a0---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----a763d9653a0---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/data-engineer?source=post_page-----a763d9653a0---------------data_engineer-----------------", "anchor_text": "Data Engineer"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a763d9653a0---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a763d9653a0---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa763d9653a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&user=Sruthi+Korlakunta&userId=5aba4019abc1&source=-----a763d9653a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa763d9653a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&user=Sruthi+Korlakunta&userId=5aba4019abc1&source=-----a763d9653a0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa763d9653a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a763d9653a0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa763d9653a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a763d9653a0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a763d9653a0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a763d9653a0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a763d9653a0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a763d9653a0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a763d9653a0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a763d9653a0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a763d9653a0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a763d9653a0--------------------------------", "anchor_text": ""}, {"url": "https://sruthi-korlakunta.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sruthi-korlakunta.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sruthi Korlakunta"}, {"url": "https://sruthi-korlakunta.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5aba4019abc1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&user=Sruthi+Korlakunta&userId=5aba4019abc1&source=post_page-5aba4019abc1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2f732574a609&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmany-ways-of-pivoting-with-pandas-a763d9653a0&newsletterV3=5aba4019abc1&newsletterV3Id=2f732574a609&user=Sruthi+Korlakunta&userId=5aba4019abc1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}