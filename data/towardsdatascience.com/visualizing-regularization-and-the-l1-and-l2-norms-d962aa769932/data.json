{"url": "https://towardsdatascience.com/visualizing-regularization-and-the-l1-and-l2-norms-d962aa769932", "time": 1683015576.7844229, "path": "towardsdatascience.com/visualizing-regularization-and-the-l1-and-l2-norms-d962aa769932/", "webpage": {"metadata": {"title": "Visualizing regularization and the L1 and L2 norms | by Chiara Campagnola | Towards Data Science", "h1": "Visualizing regularization and the L1 and L2 norms", "description": "If you\u2019ve taken an introductory Machine Learning class, you\u2019ve certainly come across the issue of overfitting and been introduced to the concept of regularization and norm. I often see this being\u2026"}, "outgoing_paragraph_urls": [{"url": "https://chiaracampagnola.medium.com/membership", "anchor_text": "subscribing", "paragraph_index": 19}], "all_paragraphs": ["If you\u2019ve taken an introductory Machine Learning class, you\u2019ve certainly come across the issue of overfitting and been introduced to the concept of regularization and norm. I often see this being discussed purely by looking at the formulas, so I figured I\u2019d try to give a better insight into why exactly minimising the norm induces regularization \u2014 and how L1 and L2 differ from each other \u2014 using some visual examples.", "Using the example of linear regression, our loss is given by the Mean Squared Error (MSE):", "and our goal is to minimize this loss:", "To prevent overfitting, we want to add a bias towards less complex functions. That is, given two functions that can fit our data reasonably well, we prefer the simpler one. We do this by adding a regularization term, typically either the L1 norm or the squared L2 norm:", "So, for example, by adding the squared L2 norm to the loss and minimizing, we obtain Ridge Regression:", "where \u03bb is the regularization coefficient which determines how much regularization we want.", "Minimizing the norm encourages the function to be less \u201ccomplex\u201d. Mathematically, we can see that both the L1 and L2 norms are measures of the magnitude of the weights: the sum of the absolute values in the case of the L1 norm, and the sum of squared values for the L2 norm. So larger weights give a larger norm. This means that, simply put, minimizing the norm encourages the weights to be small, which in turns gives \u201csimpler\u201d functions.", "Let\u2019s visualize this with an example. Let\u2019s assume that we get some data that looks like this:", "What function should we pick to fit this data? There are many options, here are three examples:", "Here we have a 2nd-degree polynomial fit and two different 8th-degree polynomials, given by the following equations:", "The first two (which are \u201csimpler\u201d functions) will most likely generalise better to new data, while the third one (a more complex function) is clearly overfitting the training data. How is this complexity reflected in the norm?", "As we can see, line [c] has a mean squared error of 0, but its norms are quite high. Lines [a] and [b], instead, have a slightly higher MSE but their norms are much lower:", "From this we can conclude that by adding the L1 or L2 norm to our minimization objective, we can encourage simpler functions with lower weights, which will have a regularization effect and help our model to better generalize on new data.", "We\u2019ve already seen that to reduce the complexity of a function we can either drop some weights entirely (setting them to zero), or make all weights as small as possible, which brings us to the difference between L1 and L2.", "To understand how they operate differently, let\u2019s have a look at how they change depending on the value of the weights.", "On the left we have a plot of the L1 and L2 norm for a given weight w. On the right, we have the corresponding graph for the slope of the norms. As we can see, both L1 and L2 increase for increasing asbolute values of w. However, while the L1 norm increases at a constant rate, the L2 norm increases exponentially.", "This is important because, as we know, when doing gradiant descent we\u2019ll update our weights based on the derivative of the loss function. So if we\u2019ve included a norm in our loss function, the derivative of the norm will determine how the weights get updated.", "We can see that with the L2 norm as w gets smaller so does the slope of the norm, meaning that the updates will also become smaller and smaller. When the weights are close to 0 the updates will have become so small as to be almost negligible, so it\u2019s unlikely that the weights will ever become 0.", "On the other hand, with the L1 norm the slope is constant. This means that as w gets smaller the updates don\u2019t change, so we keep getting the same \u201creward\u201d for making the weights smaller. Therefore, the L1 norm is much more likely to reduce some weights to 0.", "Found this story helpful? Consider subscribing to Medium to support writers!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd962aa769932&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d962aa769932--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d962aa769932--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://chiaracampagnola.medium.com/?source=post_page-----d962aa769932--------------------------------", "anchor_text": ""}, {"url": "https://chiaracampagnola.medium.com/?source=post_page-----d962aa769932--------------------------------", "anchor_text": "Chiara Campagnola"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5f310b8ff4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&user=Chiara+Campagnola&userId=c5f310b8ff4f&source=post_page-c5f310b8ff4f----d962aa769932---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd962aa769932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd962aa769932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://chiaracampagnola.medium.com/membership", "anchor_text": "subscribing"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d962aa769932---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d962aa769932---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/regularization?source=post_page-----d962aa769932---------------regularization-----------------", "anchor_text": "Regularization"}, {"url": "https://medium.com/tag/norms?source=post_page-----d962aa769932---------------norms-----------------", "anchor_text": "Norms"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d962aa769932---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd962aa769932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&user=Chiara+Campagnola&userId=c5f310b8ff4f&source=-----d962aa769932---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd962aa769932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&user=Chiara+Campagnola&userId=c5f310b8ff4f&source=-----d962aa769932---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd962aa769932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d962aa769932--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd962aa769932&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d962aa769932---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d962aa769932--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d962aa769932--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d962aa769932--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d962aa769932--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d962aa769932--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d962aa769932--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d962aa769932--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d962aa769932--------------------------------", "anchor_text": ""}, {"url": "https://chiaracampagnola.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://chiaracampagnola.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chiara Campagnola"}, {"url": "https://chiaracampagnola.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "273 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5f310b8ff4f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&user=Chiara+Campagnola&userId=c5f310b8ff4f&source=post_page-c5f310b8ff4f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F224932738852&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-regularization-and-the-l1-and-l2-norms-d962aa769932&newsletterV3=c5f310b8ff4f&newsletterV3Id=224932738852&user=Chiara+Campagnola&userId=c5f310b8ff4f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}