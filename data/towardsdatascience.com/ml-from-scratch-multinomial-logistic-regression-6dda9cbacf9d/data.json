{"url": "https://towardsdatascience.com/ml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d", "time": 1683009257.651575, "path": "towardsdatascience.com/ml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d/", "webpage": {"metadata": {"title": "ML from Scratch-Multinomial Logistic Regression | by Aman Sharma | Towards Data Science", "h1": "ML from Scratch-Multinomial Logistic Regression", "description": "When it comes to real-world machine learning, around 70% of the problems are classification-based, where, on the basis of the available set of features, your model tries to predict that out of a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Heart+Disease", "anchor_text": "UCI Cleveland Heart Disease dataset", "paragraph_index": 2}, {"url": "https://archive.ics.uci.edu/ml/datasets/Heart+Disease", "anchor_text": "data source", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Logit", "anchor_text": "logit function", "paragraph_index": 27}, {"url": "http://machinelearningmechanic.com/deep_learning/2019/09/04/cross-entropy-loss-derivative.html", "anchor_text": "this source.", "paragraph_index": 49}, {"url": "https://medium.com/@amansharma2910", "anchor_text": "my profile", "paragraph_index": 57}], "all_paragraphs": ["When it comes to real-world machine learning, around 70% of the problems are classification-based, where, on the basis of the available set of features, your model tries to predict that out of a given set of categories(discrete possible outcomes), what category does your target variable might belong to. Today, in this article, we are going to have a look at Multinomial Logistic Regression\u2212 one of the classic supervised machine learning algorithms capable of doing multi-class classification, i.e., predict an outcome for the target variable when there are more than 2 possible discrete classes of outcomes.", "This is a project-based guide, where we will see how to code an MLR model from scratch while understanding the mathematics involved that allows the model to make predictions.", "For the project, we will be working on the famous UCI Cleveland Heart Disease dataset. We will create an ML model from scratch that uses multinomial logistic regression, capable of predicting the severity of heart disease within a patient.", "Before we start working on the actual project, let us first familiarize ourselves with the basic idea behind MLR- what it is, what it does, and how it operates?", "You can think of multinomial logistic regression as logistic regression (more specifically, binary logistic regression) on steroids. While the binary logistic regression can predict binary outcomes (eg.- yes or no, spam or not spam, 0 or 1, etc.), the MLR can predict one out of k-possible outcomes, where k can be any arbitrary positive integer.", "The multinomial regression function is a statistical classification algorithm. What this means is that once we feed the function a set of features, the model performs a series of mathematical operations to normalize the input values into a vector of values that follows a probability distribution.", "Finally, the outcome with the highest probability will be the predicted outcome for the given feature set.", "Now the question is, how exactly does the MLR function convert feature sets to probability values? We will try to understand this while working on our project.", "Before we begin working on the project, let us first import all the necessary modules and packages.", "Now, we will import the dataset. According to the data source, the dataset does not have column names. So we will set the header attribute as None and then we will manually set the column names as per the information available on the source.", "Now that we have imported the dataset, let us try to understand what each of these columns denotes.", "Here, the num column is our target variable, with the values ranging from 0 (no disease present) to 4 (high chances of heart disease).", "Now that we know exactly what our dataset represents, let us move on to the next step.", "Now, let us analyze the data and see if it needs any cleaning or modifications. As the first step of our data preprocessing, we will check if there are any null values that need to be dealt with.", "As we can see, the columns ca and thal have 4 and 2 \u2018?\u2019 values respectively. These are null values that we need to deal with. Since both these columns consist of categorical values, we will replace the null values with the median of the respective columns. We will also type-cast the two columns to \u2018float64\u2019 values.", "Now that we have cleaned our data, let us have a look at the statistical analysis of our dataset.", "Upon observing the data, we can see that the data needs to be scaled since we have values in the range (1, 1e+2). The main reason we are scaling our data is that since we will be using Stochastic Gradient Descent for optimizing our model parameters, scaling can significantly improve the speed and accuracy of our optimizer.", "Here, we will use standard scaling in order to standardize the data. Standardization typically means rescaling data to have a mean of 0 and a standard deviation of 1 (unit variance). The following is the mathematical formula for standard scaling.", "Now, let us implement this within our code. The first step is to split the dataset into target and feature arrays.", "Now, let us define the function for standard scaling.", "We will now perform standardization on our features set.", "As we can see, the standard deviation for each feature column is now 1, as expected of the standard scaling. We have successfully standardized our feature set.", "With this, we have completed the data wrangling process. With the data cleaned and standardized, let us now start working on our model.", "As we saw earlier, the MLR model takes a vector of features as the input and then, on the basis of the features, computes the probabilities for the possible outcomes. So how exactly does the MLR model does that? Let us find out in this section where we will code an MLR model.", "The multinomial regression function consists of two functional layers-", "First, let us see what the linear predictor function does. Given below is the formula for the linear prediction function.", "If you observe carefully, this is similar to the function that we use for the linear regression model. What it basically does is that it maps the score for each possible outcome of our target variable in the range (-\u221e, +\u221e).", "This is somewhat similar to the log odds(logit function), which maps the odds of an event to the range (-\u221e, +\u221e). Hence, the linear predictor function is also known as the logit function.", "Now, we will see the code for the linear predictor function.", "Step 1- Creating random weights and biases for our model (Since we have 5 possible target outcomes and 13 features, k = 5 and m = 13).", "Step 2- Defining the linear predictor function.", "Now, let us test the function for our features matrix. The final output should be a 303 x 5 matrix since we have 303 feature sets in our dataset and 5 possible outcomes for our target variable.", "As we can see, the function worked just fine. Now to the next step, converting logit scores to probability values. This is where the softmax function comes into the picture. Given below is the formula for the softmax algorithm.", "What the softmax function does is that it normalizes the logit scores for each possible outcome in a way such that the normalized outputs follow a probabilistic distribution.", "In layman\u2019s terms, the softmax function converts logit scores of the possible outcomes of a feature set to probability values.", "Now, let us define the softmax function for our model.", "Now that we have defined our softmax function as well, let us combine these two functions into a single multinomial function for our model.", "Now, let us perform logistic regression on our feature set.", "Let us now check the accuracy of our model. Since the weights and biases were randomly generated, we can\u2019t expect our model to be very accurate at the moment.", "As we can see, the initial model accuracy is only about 16%, which is very poor to even consider this model for making any heart disease predictions in real life.", "As a result, we need to optimize our model parameters in order to improve its accuracy.", "Before we proceed any further towards optimizing our model, we should first split our dataset into test and training sets. Training and testing on the same dataset is considered a bad practice, as it can severely affect your model\u2019s real-world performance.", "Let us define train_test_split function for splitting our dataset into training and testing data. We will then run it on our dataset.", "Now that we have separate training and testing datasets, we will keep the testing dataset aside and only use it for testing purposes. All the training and optimization will be performed on the training dataset.", "Now we are just one step away from optimizing our model. Before we jump to optimization, we have a few questions to answer. What exactly is the criterion on the basis of which we are planning to optimize our model? What exactly is even the purpose of optimization?", "The answer is \u2014 We want to optimize the model in order to reduce the information loss generated by our model. Since the criterion for optimization is information loss, we need to define a loss function for our model.", "For the multinomial regression function, generally, we use the cross-entropy-loss function. Given below is the formula for the cross-entropy-loss function.", "Let us now define our cross-entropy loss function.", "Now that we have defined our loss function, we will finally define our optimizer algorithm. Given below is the formula on which the Stochastic Gradient Descent operates.", "For more details on this, please refer to this source. Given below is the code for the SGD algorithm.", "Now that we have the optimizer function ready, we will run it for our model.", "We have reached the last step of our project now.", "We will now test our multinomial logistic regression model with the updated weights and biases that we obtained by running the optimizer function.", "NOTE- The test will be conducted on the test dataset and not the training dataset.", "As we can see, our model showed around 67% accuracy on the test data. While this is a significant improvement over the initial 16% that we got, there\u2019s still enough room for improvement.", "You can further improve the accuracy by playing around with the hyperparameters (learning rate, training epochs, etc.) or by trying the process with a different scaling or optimizer algorithm. Remember, the more you experiment, the more you learn!", "With this, we come to the end of our project.", "For more fun projects like this one, check out my profile.", "I am just a novice in the field of Machine Learning and Data Science so any suggestions and criticism will really help me improve.", "Hit that follow and stay tuned for more ML stuff!", "Link to GitHub repo for the dataset and Jupyter notebook-", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Programming computers to do the work for me and using data to solve problems are my passion. My machine and I are learning. Connect on Twitter @amansharma2910"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6dda9cbacf9d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://amansharma2910.medium.com/?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": "Aman Sharma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84e03a4d7261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&user=Aman+Sharma&userId=84e03a4d7261&source=post_page-84e03a4d7261----6dda9cbacf9d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dda9cbacf9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dda9cbacf9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Heart+Disease", "anchor_text": "UCI Cleveland Heart Disease dataset"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Heart+Disease", "anchor_text": "data source"}, {"url": "https://en.wikipedia.org/wiki/Logit", "anchor_text": "logit function"}, {"url": "https://madalinabuzau.github.io/2016/11/29/gradient-descent-on-a-softmax-cross-entropy-cost-function.html", "anchor_text": "Image Source"}, {"url": "http://machinelearningmechanic.com/deep_learning/2019/09/04/cross-entropy-loss-derivative.html", "anchor_text": "this source."}, {"url": "https://medium.com/@amansharma2910", "anchor_text": "my profile"}, {"url": "https://github.com/amansharma2910/MultinomialLogisticRegression-Scratch_HeartDiseasePrediction", "anchor_text": "amansharma2910/MultinomialLogisticRegression-Scratch_HeartDiseasePredictionIn this project, I have coded an MLR model from scratch that can be used to predict the presence(and severity) of heart\u2026github.com"}, {"url": "https://en.wikipedia.org/wiki/Multinomial_logistic_regression", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Logit#:~:text=In%20statistics%2C%20the%20logit%20(%2F,.", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Softmax_function", "anchor_text": "Wikipedia"}, {"url": "http://machinelearningmechanic.com/deep_learning/2019/09/04/cross-entropy-loss-derivative.html", "anchor_text": "MachineLeariningMechanic.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----6dda9cbacf9d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6dda9cbacf9d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/logistic-regression?source=post_page-----6dda9cbacf9d---------------logistic_regression-----------------", "anchor_text": "Logistic Regression"}, {"url": "https://medium.com/tag/numpy?source=post_page-----6dda9cbacf9d---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6dda9cbacf9d---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6dda9cbacf9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&user=Aman+Sharma&userId=84e03a4d7261&source=-----6dda9cbacf9d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6dda9cbacf9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&user=Aman+Sharma&userId=84e03a4d7261&source=-----6dda9cbacf9d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6dda9cbacf9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6dda9cbacf9d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6dda9cbacf9d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6dda9cbacf9d--------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://amansharma2910.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Aman Sharma"}, {"url": "https://amansharma2910.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "94 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F84e03a4d7261&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&user=Aman+Sharma&userId=84e03a4d7261&source=post_page-84e03a4d7261--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F186d48c6a7d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fml-from-scratch-multinomial-logistic-regression-6dda9cbacf9d&newsletterV3=84e03a4d7261&newsletterV3Id=186d48c6a7d2&user=Aman+Sharma&userId=84e03a4d7261&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}