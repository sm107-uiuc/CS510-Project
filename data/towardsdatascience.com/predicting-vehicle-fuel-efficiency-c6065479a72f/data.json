{"url": "https://towardsdatascience.com/predicting-vehicle-fuel-efficiency-c6065479a72f", "time": 1683013510.181351, "path": "towardsdatascience.com/predicting-vehicle-fuel-efficiency-c6065479a72f/", "webpage": {"metadata": {"title": "Predicting vehicle fuel efficiency | by Ranganath Venkataraman | Towards Data Science", "h1": "Predicting vehicle fuel efficiency", "description": "My previous posts focused on the application of machine learning and neural networks in datasets from the oil industry. These efforts gave me the confidence to successfully implement XGBoost and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@rangys3", "anchor_text": "previous posts", "paragraph_index": 0}, {"url": "https://archive.ics.uci.edu/ml/datasets/Auto%2BMPG", "anchor_text": "Auto MPG dataset from the UCI repository", "paragraph_index": 1}, {"url": "https://github.com/Ranga2904/MPGPredictor_XG_PyTorch", "anchor_text": "GitHub repo", "paragraph_index": 9}], "all_paragraphs": ["My previous posts focused on the application of machine learning and neural networks in datasets from the oil industry. These efforts gave me the confidence to successfully implement XGBoost and artificial neural networks to predict a major safety hazard at the oil refinery where I work. A major success that I\u2019m very proud of!", "In order to exercise some versatility, I wanted to use PyTorch and GridSearchCV in this application and first wanted to practice on a simpler and smaller dataset \u2014 namely the Auto MPG dataset from the UCI repository.", "As before, I\u2019m laying out a step-wise approach to assure systematic application:", "Step 1 = Understand the goal and big picture before diving into modeling.", "Step 2 = load and get high-level insight into data", "Step 3 = further visualization to explore the data. Goal: get an early inkling of the most leveraging features.", "Step 4 = plan for modeling. The key here is to get data ready for training and testing models.", "Step 5 = execute modeling and evaluate performance. Complete sensitivity analysis as desired", "Step 6 = draw conclusions from work to benefit the end-user", "Snippets of code are below with full code in GitHub repo.", "Step 1: our goal is to predict mileage for cars based on various characteristics. Through the modeling effort, we can understand what makes a car efficient and how to achieve target mileage consumption.", "Step 2: reading the input data into Python and using .describe(), .head() functions to get the key statistics and a first look at the data. I also want to name the columns, since this wasn\u2019t available in the raw data.", "A separate check \u2014 not shown here \u2014 shows that the dataset has 6 empty values for the \u2018horsepower\u2019 feature.", "Step 3a) plotting correlations as a Seaborn heatmap", "For modeling purposes, I\u2019ll first use all these features. However, I could drop either cylinders/displacement/car weight (given high correlation coefficients) if I wanted a more compact set of features to prevent any potential overfitting.", "Step 3b) Let\u2019s use barplots to learn more about the categorical numerical features:", "Conclusions to draw from Figure 3 histograms: cars in origin 1 are far more represented, suggesting that mpg results are better suited to that origin \u2014 whatever origin may stand for e.g. country of manufacture. We notice that model years are distributed over 12 years, with 1970, 1976, 1982 more represented than others.", "Should these numerical categorical variables be encoded?", "Conclusions from Figure 4 barplots: there is marginal increase in mpg with car origin number. The correlation is less so, for model year, but for now, I won\u2019t encode these variables. I\u2019m fine with leaving these features in as-is.", "Step 3c) The analysis above got me curious about the dependent variable i.e. the target i.e. what we\u2019re trying to predict. Is that skewed in any direction? Figure 4 below shows right-skewness of the feature, suggesting that we might want to do a log transform of the feature data for use in modeling.", "Step 4: in addition to doing some more data preparation and creating test/ train sets for modeling, I\u2019ll also set up GridSearch CV", "4a) imputing missing data and creating training and testing sets. Also encoding car make, dropping car model \u2014 since the latter is extraneous detail.", "4b) setting up GridSearchCV \u2014 this allows us to loop through hyperparameters to find the optimal combination per the selected scoring metric (mean square error in my case). The GitHub repo has the similar exercise for RandomForest.", "4c) setting up PyTorch \u2014 the code below imports the necessary packages, sets up the neural network with input dimensions, number of nodes in hidden layer, and output node, and then builds the model.", "I\u2019m also declaring mean squared error as the loss metric to optimize, same metric that I\u2019ll use when evaluating XGBoost and RandomForest\u2019s performance on test set.", "Finally, setup the Adam optimization algorithm for maneuvering the gradient descent function as seen in Figure 6 below.", "5) With all setup complete, time to actually run the models and evaluate results.", "5a) I\u2019ll first use GridCV and the previously setup hyperparameter grid to find the best performing XGBoost model (similar exercise for RandomForest is in GitHub repo) based on performance in the training set.", "5b) I\u2019ll then train the created PyTorch neural network", "5c) With model training complete, I can now evaluate performance on testing data.", "Mean Squared Error of the XGBoost model arrived at through hyperparameter tuning is 0.0117 mpg. Given a mean of 23.5 mpg in original dataset, this can be interpreted as accuracy of 99.9%", "Mean Squared Error of PyTorch neural network is 0.107 mpg. Using the approach above, this can be translated to an accuracy of 99.5%.", "6) What have we accomplished for our client? We have a model that predicts fuel mileage for a variety of cars; our client can use this to plan for cars that achieve desired levels of fuel efficiency.", "Additionally we can also inform our client that \u2014 per Figure 7 below \u2014 weight is the most influential variable in predicting mileage, with acceleration being second most. Horsepower, displacement, and acceleration are relatively close to each other in impact.", "With this detail, our client can plan future car production or purchase plans.", "As always, I welcome any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Chemical Engineer, Data and Machine Learning Enthusiast who\u2019s exploring the energy industry with new tools"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc6065479a72f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6065479a72f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6065479a72f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rangys3?source=post_page-----c6065479a72f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rangys3?source=post_page-----c6065479a72f--------------------------------", "anchor_text": "Ranganath Venkataraman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c71c503ed2c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&user=Ranganath+Venkataraman&userId=1c71c503ed2c&source=post_page-1c71c503ed2c----c6065479a72f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6065479a72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6065479a72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mbaumi?utm_source=medium&utm_medium=referral", "anchor_text": "Mika Baumeister"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@rangys3", "anchor_text": "previous posts"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Auto%2BMPG", "anchor_text": "Auto MPG dataset from the UCI repository"}, {"url": "https://github.com/Ranga2904/MPGPredictor_XG_PyTorch", "anchor_text": "GitHub repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c6065479a72f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----c6065479a72f---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/xgboost?source=post_page-----c6065479a72f---------------xgboost-----------------", "anchor_text": "Xgboost"}, {"url": "https://medium.com/tag/gridsearchcv?source=post_page-----c6065479a72f---------------gridsearchcv-----------------", "anchor_text": "Gridsearchcv"}, {"url": "https://medium.com/tag/train-test-split?source=post_page-----c6065479a72f---------------train_test_split-----------------", "anchor_text": "Train Test Split"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6065479a72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&user=Ranganath+Venkataraman&userId=1c71c503ed2c&source=-----c6065479a72f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6065479a72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&user=Ranganath+Venkataraman&userId=1c71c503ed2c&source=-----c6065479a72f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6065479a72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6065479a72f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc6065479a72f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c6065479a72f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6065479a72f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c6065479a72f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c6065479a72f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c6065479a72f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c6065479a72f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c6065479a72f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c6065479a72f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c6065479a72f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rangys3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rangys3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ranganath Venkataraman"}, {"url": "https://medium.com/@rangys3/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "51 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c71c503ed2c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&user=Ranganath+Venkataraman&userId=1c71c503ed2c&source=post_page-1c71c503ed2c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feae1dac92a4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-vehicle-fuel-efficiency-c6065479a72f&newsletterV3=1c71c503ed2c&newsletterV3Id=eae1dac92a4b&user=Ranganath+Venkataraman&userId=1c71c503ed2c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}