{"url": "https://towardsdatascience.com/all-you-need-to-know-about-rnns-e514f0b00c7c", "time": 1682995300.047698, "path": "towardsdatascience.com/all-you-need-to-know-about-rnns-e514f0b00c7c/", "webpage": {"metadata": {"title": "All you need to know about RNNs. A beginner\u2019s guide into the\u2026 | by Suleka Helmini | Towards Data Science", "h1": "All you need to know about RNNs", "description": "Researchers came up with neural networks to model the behaviour of a human brain. But if you actually think about it, normal neural networks don\u2019t really do that much justice to its original\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Researchers came up with neural networks to model the behaviour of a human brain. But if you actually think about it, normal neural networks don\u2019t really do that much justice to its original intention. The reason for this statement is that feedforward vanilla neural networks cannot remember the things it learns. Each iteration you train the network it starts fresh, it doesn\u2019t remember what it saw in the previous iteration when you are processing the current set of data. This is a big disadvantage when identifying correlations and data patterns. This is where Recurrent Neural Networks (RNN)came into the picture. RNNs have a very unique architecture that helps them to model memory units (hidden state) that enable them to persist data, thus being able to model short term dependencies. Due to this reason, RNNs are extensively used in time-series forecasting to identify data correlations and patterns.", "Even though RNNs have been around for some time, everyone seems to have their own confusing way of explaining it\u2019s architecture and no one really explains what happens behind the scenes. So let\u2019s bridge the gap, shall we? This post is aimed at explaining the RNN architecture in a more granular level by going through its functionality.", "If you have blindly made simple RNN models using TensorFlow before and if you have been finding it hard to understand about what the inner workings of a RNN look like, then this article is just for you.", "We will basically be explaining what happens behind the curtains when these two lines of TensorFlow code that are responsible for the declaration of the RNN and initiating the execution is run.", "If you ever searched for architectural information about RNNs, the architecture diagrams you might get are rather confusing if you start looking into them as a beginner. I will use an example approach to explain the RNN architecture.", "Before we get down to business, an important thing to note is that the RNN input needs to have 3 dimensions. Typically it would be batch size, the number of steps and number of features. The number of steps depicts the number of time steps/segments you will be feeding in one line of input of a batch of data that will be fed into the RNN.", "The RNN unit in TensorFlow is called the \u201cRNN cell\u201d. This name itself has created a lot of confusion among people. There are many questions on Stackoverflow that inquire if \u201cRNN cell\u201d refers to one single cell or the whole layer. Well, it\u2019s more like the whole layer. The reason for this is that the connections in RNNs are recurrent, thus following a \u201cfeeding to itself\u201d approach. Basically, the RNN layer is comprised of a single rolled RNN cell that unrolls according to the \u201cnumber of steps\u201d value (number of time steps/segments) you provide.", "As we mentioned earlier the main speciality in RNNs is the ability to model short term dependencies. This is due to the hidden state in the RNN. It retains information from one time step to another flowing through the unrolled RNN units. Each unrolled RNN unit has a hidden state. The current time steps hidden state is calculated using information of the previous time step\u2019s hidden state and the current input. This process helps to retain information on what the model saw in the previous time step when processing the current time steps information. Also, something to note is that all the connections in RNN have weights and biases. The biases can be optional in some architectures. This process will be explained further in later parts of the article.", "Since you now have a basic idea, let\u2019s break down the execution process with an example. Say your batch size is 6, RNN size is 7, the number of time steps/segments you would include in one input line is 5 and the number of features in one time step is 3. If this is the case, your input tensor (matrix) shape for one batch would look something like this:", "The data inside a batch would look something like this:", "Note: The data segmentation method used here is called the sliding window approach and is mostly used when doing time series analysis. You don\u2019t have to worry about the data pre-processing process here.", "When first feeding the data into the RNN. It will have a rolled architecture as shown below:", "But when the RNN starts to process the data it will unroll and produce outputs as shown below:", "When you feed a batch of data into the RNN cell it starts the processing from the 1st line of input. Likewise, the RNN cell will sequentially process all the input lines in the batch of data that was fed and give one output at the end which includes all the outputs of all the input lines.", "In order to process a line of input, the RNN cell unrolls \u201cnumber of steps\u201d times. You can see this in the above figure (Fig 03). Since we defined \u201cnumber of steps\u201d as 5, the RNN cell has been unrolled 5 times.", "The execution process is as follows:", "After processing all time steps in one line of input in the batch, we will have 5 outputs of shape (1,7). So when all these outputs are concatenated together. the shape becomes (1,5,7). When all the input lines of the batch are done processing we get 6 outputs of size (1,5,7). Thus, the final output of the whole batch would be (6,5,7).", "Note: All the hidden state weights, output weights and input weights have the same value throughout all the connections in a RNN.", "Coming back to the 2 lines of code we stated earlier:", "The 1st line basically defines the activation function and the RNN size of the RNN cell that we want to create. The 2nd line executes the processing procedure of the input data by feeding it into the RNN. The processing will happen according to what we discussed earlier. Finally, the output (value with shape (6,5,7) ) of that batch will be assigned to the \u201cval1\u201d variable. The final value of the hidden state will be assigned to the \u201cstate\u201d variable.", "We have now come to the end of the article. In this article, we discussed the data manipulation and representation process inside of a RNN in TensorFlow. With all the provided information, I hope that now you have a good understanding of how RNNs work in TensorFlow.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe514f0b00c7c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sulekahelmini9628?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sulekahelmini9628?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": "Suleka Helmini"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddf3befa5aec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&user=Suleka+Helmini&userId=ddf3befa5aec&source=post_page-ddf3befa5aec----e514f0b00c7c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe514f0b00c7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe514f0b00c7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@laurentnaville_1467602_sink?utm_source=medium&utm_medium=referral", "anchor_text": "Laurent Naville"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "article"}, {"url": "https://medium.com/@jianqiangma/all-about-recurrent-neural-networks-9e5ae2936f6e", "anchor_text": "article"}, {"url": "https://www.coursera.org/lecture/nlp-sequence-models/recurrent-neural-network-model-ftkzt", "anchor_text": "course"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e514f0b00c7c---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/recurrent-neural-network?source=post_page-----e514f0b00c7c---------------recurrent_neural_network-----------------", "anchor_text": "Recurrent Neural Network"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----e514f0b00c7c---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe514f0b00c7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&user=Suleka+Helmini&userId=ddf3befa5aec&source=-----e514f0b00c7c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe514f0b00c7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&user=Suleka+Helmini&userId=ddf3befa5aec&source=-----e514f0b00c7c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe514f0b00c7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe514f0b00c7c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e514f0b00c7c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e514f0b00c7c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sulekahelmini9628?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sulekahelmini9628?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Suleka Helmini"}, {"url": "https://medium.com/@sulekahelmini9628/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddf3befa5aec&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&user=Suleka+Helmini&userId=ddf3befa5aec&source=post_page-ddf3befa5aec--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F428c9c5d4b27&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-you-need-to-know-about-rnns-e514f0b00c7c&newsletterV3=ddf3befa5aec&newsletterV3Id=428c9c5d4b27&user=Suleka+Helmini&userId=ddf3befa5aec&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}