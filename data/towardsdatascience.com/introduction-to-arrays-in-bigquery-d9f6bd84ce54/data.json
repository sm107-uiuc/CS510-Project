{"url": "https://towardsdatascience.com/introduction-to-arrays-in-bigquery-d9f6bd84ce54", "time": 1683006316.440914, "path": "towardsdatascience.com/introduction-to-arrays-in-bigquery-d9f6bd84ce54/", "webpage": {"metadata": {"title": "Introduction to Arrays in BigQuery | by ChiefHustler | Towards Data Science", "h1": "Introduction to Arrays in BigQuery", "description": "Let\u2019s run a simple regex query on it to extract the title and body of all the questions where the title mentions one of the following programming languages: python, rstats, sql: I don\u2019t know about\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["I work with BigQuery on a daily basis, and I have to say its speed and ease of use are mind-blowing.", "Why do I like BigQuery? Three reasons:", "Just to give you an example of the performance, here\u2019s a table with 18.5M rows:", "Let\u2019s run a simple regex query on it to extract the title and body of all the questions where the title mentions one of the following programming languages: python, rstats, sql:", "With that, let\u2019s dive straight into working with arrays in BigQuery.", "You probably guessed it by now, we\u2019re gonna be counting words occurring in StackOverflow questions. But before we get to the practical example, I\u2019d like to cover the basics of working with arrays in BigQuery.", "In the prototyping phase, it can be useful to create small arrays to play with. For example:", "This gives us the following output:", "Notice how the arrays are nested vertically inside each row.", "If we want to turn this nested structure into a regular flat table, we need to unnest the arrays:", "The CROSS JOIN UNNEST code performs what's known as a correlated join, meaning it keeps track of which row each array was associated with, so as not to perform a full cross join needlessly.", "We now get the more familiar flat and repeated structure:", "Let\u2019s say we want to know what is the last language for each programmer. There are two ways to index in an array in BigQuery: 0-based indexing (python style) with OFFSET or 1-based indexing (R style) with ORDINAL.", "We\u2019ll use ORDINAL as an example, along with ARRAY_LENGTH to retrieve the length of each array. Using the same definition of T0 as above:", "With the basics out of the way, let\u2019s jump into a concrete use case for arrays.", "We\u2019d like to have a way to count the frequency of every word in the questions titles, and if possible, a way to capture correlations between words and question tags.", "A key function to turn strings into arrays of words is the split function. Here's an example:", "Interestingly, we see in the image above that we have a string of tags. Let\u2019s turn that into an array as well:", "So each row is going to contain 2 arrays:", "And now we\u2019re going to cross-join/unnest the two arrays at once, and filter out uninteresting words, i.e. words less than 2 characters long and some common stop words:", "This query took 24 seconds to run, and just like that, we have obtained the cartesian product of all related tags and words:", "Now we can easily ask what words are most represented for a given tag, e.g. python (assume the output of the previous step has been saved in table so, inside dataset temp):", "Or we can go the other way around and ask what tags are associated with a particular word, e.g. flask:", "A tf-idf analysis would be useful here to single out what is really specific to python as opposed to other tags. Although outside the scope of this overview, it would make for a great side-project.", "Arrays constitute a great feature of BigQuery, and there are other goodies that I looking forward to writing about. For my money, BigQuery is one of the most impressive big data analytics tool out there!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Growth stocks investor. Data scientist by trade. Passionate about fintech. In residence at Entrepreneur First."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd9f6bd84ce54&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@chiefhustler?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@chiefhustler?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": "ChiefHustler"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa5cb554796e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&user=ChiefHustler&userId=fa5cb554796e&source=post_page-fa5cb554796e----d9f6bd84ce54---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd9f6bd84ce54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd9f6bd84ce54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@sortino?utm_source=medium&utm_medium=referral", "anchor_text": "Joshua Sortino"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/big-data?source=post_page-----d9f6bd84ce54---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/bigquery?source=post_page-----d9f6bd84ce54---------------bigquery-----------------", "anchor_text": "Bigquery"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----d9f6bd84ce54---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/sql?source=post_page-----d9f6bd84ce54---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/gcp?source=post_page-----d9f6bd84ce54---------------gcp-----------------", "anchor_text": "Gcp"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd9f6bd84ce54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&user=ChiefHustler&userId=fa5cb554796e&source=-----d9f6bd84ce54---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd9f6bd84ce54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&user=ChiefHustler&userId=fa5cb554796e&source=-----d9f6bd84ce54---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd9f6bd84ce54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd9f6bd84ce54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d9f6bd84ce54---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d9f6bd84ce54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@chiefhustler?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@chiefhustler?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "ChiefHustler"}, {"url": "https://medium.com/@chiefhustler/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "194 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa5cb554796e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&user=ChiefHustler&userId=fa5cb554796e&source=post_page-fa5cb554796e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F22430265b692&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroduction-to-arrays-in-bigquery-d9f6bd84ce54&newsletterV3=fa5cb554796e&newsletterV3Id=22430265b692&user=ChiefHustler&userId=fa5cb554796e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}