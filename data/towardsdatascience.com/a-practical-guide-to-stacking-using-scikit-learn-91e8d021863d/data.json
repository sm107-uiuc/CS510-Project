{"url": "https://towardsdatascience.com/a-practical-guide-to-stacking-using-scikit-learn-91e8d021863d", "time": 1683016484.961128, "path": "towardsdatascience.com/a-practical-guide-to-stacking-using-scikit-learn-91e8d021863d/", "webpage": {"metadata": {"title": "A Practical Guide to Stacking Using Scikit-Learn | Towards Data Science", "h1": "A Practical Guide to Stacking Using Scikit-Learn", "description": "Stacked generalization, also known as stacking, is a method that trains a meta-model to intelligently combine the predictions of different base-models."}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingClassifier.html", "anchor_text": "StackingClassifier", "paragraph_index": 11}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingRegressor.html#sklearn.ensemble.StackingRegressor", "anchor_text": "StackingRegressor", "paragraph_index": 11}, {"url": "https://github.com/AmolMavuduru/GuideToStacking", "anchor_text": "GitHub", "paragraph_index": 28}], "all_paragraphs": ["In the last two decades, ensemble methods such as random forests and gradient boosting, which combine several instances of the same types of models using voting or weighted averaging to produce strong models, have become extremely popular. However, there is another approach that allows us to reap the benefits of different models by combining their individual predictions using higher-level models.", "Stacked generalization, also known as stacking, is a method that trains a meta-model to intelligently combine the predictions of different base-models.", "The goal of this article is to not only explain how this competition-winning technique works but to also demonstrate how you can implement it with just a few lines of code in Scikit-learn.", "Every machine learning model has advantages and disadvantages due to the bias created by the assumptions behind the model. This is a concept that I mentioned in my previous post about the \u201cno free lunch\u201d theorem for supervised machine learning.", "Different machine learning algorithms may be skilled at solving problems in different ways. If we had multiple algorithms working together to solve a problem, one algorithm\u2019s strengths could potentially mask the other algorithm\u2019s weaknesses and vice versa. This is the idea behind stacking.", "Stacking involves training multiple base-models to predict the target variable in a machine learning problem while at the same time, a meta-model learns to use the predictions of each base model to predict the value of the target variable. The figure below demonstrates this idea.", "The algorithm for correctly training a stacked model follows these steps:", "Note that each part of the model is trained separately, and the meta-model learns to use both the predictions of the base models and the original data to predict the final output.", "For those who are unfamiliar with k-fold cross-validation, it is a technique in which the data for a machine learning problem is split into k-folds or distinct subsets and the model is evaluated iteratively across all the k-folds. In each iteration, one fold is used for evaluation, and the remaining k-1 folds are used for training the model.", "The use of a k-fold cross-validation split ensures that the base models are generating predictions on unseen data because the base models will be retrained on different training sets in each iteration.", "The power of stacking lies in the final step, in which the meta-model can actually learn the strengths and weaknesses of each base model and intelligently combine their predictions to produce the final output.", "The StackingClassifier and StackingRegressor modules were introduced in Scikit-learn 0.22. So make sure you upgrade to the latest version of Scikit-learn to follow along with this example using the following pip command:", "Most of the basic libraries I imported below are commonly used in data science projects and should come as no surprise. However, I also made use of the make_classification function from Scikit-learn to generate some synthetic data and I also used Plotly to build interactive plots. In order to embed the interactive plots, I also made use of Datapane.", "Scikit-learn\u2019s make_classification function is useful for generating synthetic datasets that can be used for testing different algorithms. The dataset I am generating in this scenario is designed to represent a binary classification problem with a realistic level of difficulty based on the following parameters:", "In order to get a baseline level of performance to compare against the stacked model, I trained and evaluated the following base models:", "The models are all stored in a dictionary for code reusability.", "The models were each validated using a repeated five-fold cross-validation strategy where each fold was repeated with a different random set of samples. In each fold, each model was trained on 80 percent of the data and validated on the remaining 20 percent.", "This method results in 10 different accuracy scores for each model which are stored in a dictionary as demonstrated below.", "The function defined below takes the dictionary of cross-validation scores for all of the evaluated models and creates an interactive boxplot with Plotly to compare the performance of each model. The function also creates a Datapane report for embedding the plots as I have done in this article.", "Based on the boxplot above, we can see that all of the base models have average accuracy scores over 87 percent, but the support vector machine performed the best on average. Surprisingly, a simple KNN classifier, which is often described as a \u201clazy learning algorithm\u201d because it just memorizes the training data, clearly outperformed the random forest with 50 decision trees.", "Now let\u2019s see what happens if we train a stacked model. Scikit-learn\u2019s StackingClassifier has a constructor that requires a list of base models, along with the final meta-model that produces the final output. Note that in the code below, this list of base models is formatted as a list of tuples with the model names and model instances.", "The stacked model uses a random forest, an SVM, and a KNN classifier as the base models and a logistic regression model as the meta-model that predicts the output using the data and the predictions from the base models. The code below demonstrates how to create this model with Scikit-learn.", "In the code below, I simply reused the function I defined earlier for obtaining cross-validation scores for models and used it to evaluate the stacked model.", "I reused the plotting function defined earlier to compare the performance of the base models to the stacked model using side-by-side boxplots.", "Based on the plot above, we can clearly see that stacking produced an improvement in performance, with the stacked model outperforming all of the base models and achieving a median accuracy close to 91 percent. This same process can be repeated for regression problems as well, using the StackingRegressor module from Scikit-learn, which behaves in a similar manner.", "Like all other methods in machine learning, stacking has advantages and disadvantages. Here are some of the advantages of stacking:", "Keep in mind that stacking also has the following disadvantages:", "Stacking is a great way to take advantage of the strengths of different models by combining their predictions. This method has been used to win machine learning competitions and thanks to Scikit-learn, it is very easy to implement. However, the performance improvements that come from stacking do come with a price in the form of longer training and inference times.", "You can find the full code used for the practical example on GitHub. If you liked this article, feel free take a look at some of my recent articles on machine learning below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F91e8d021863d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----91e8d021863d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----91e8d021863d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://amolmavuduru.medium.com/?source=post_page-----91e8d021863d--------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=post_page-----91e8d021863d--------------------------------", "anchor_text": "Amol Mavuduru"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511816e5976d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&user=Amol+Mavuduru&userId=511816e5976d&source=post_page-511816e5976d----91e8d021863d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91e8d021863d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91e8d021863d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@greg_rosenke?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Greg Rosenke"}, {"url": "https://unsplash.com/s/photos/stacked?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/what-no-free-lunch-really-means-in-machine-learning-85493215625d", "anchor_text": "What \u201cno free lunch\u201d really means in machine learningDemystifying this often misunderstood theorem.towardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)", "anchor_text": "cross-validation"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingClassifier.html", "anchor_text": "StackingClassifier"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingRegressor.html#sklearn.ensemble.StackingRegressor", "anchor_text": "StackingRegressor"}, {"url": "https://github.com/AmolMavuduru/GuideToStacking", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/what-no-free-lunch-really-means-in-machine-learning-85493215625d", "anchor_text": "What \u201cno free lunch\u201d really means in machine learningDemystifying this often misunderstood theorem.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/why-xgboost-cant-solve-all-your-problems-b5003a62d12a", "anchor_text": "Why XGBoost can\u2019t solve all your problems.A key limitation of XGBoost and other tree-based algorithms.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/fake-news-classification-with-recurrent-convolutional-neural-networks-4a081ff69f1a", "anchor_text": "Fake News Classification with Recurrent Convolutional Neural NetworksIntroductiontowardsdatascience.com"}, {"url": "http://www.cs.utsa.edu/~bylander/cs6243/wolpert92stacked.pdf", "anchor_text": "Stacked Generalization"}, {"url": "http://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html", "anchor_text": "Scikit-learn: Machine Learning in Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----91e8d021863d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----91e8d021863d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----91e8d021863d---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----91e8d021863d---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F91e8d021863d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&user=Amol+Mavuduru&userId=511816e5976d&source=-----91e8d021863d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F91e8d021863d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&user=Amol+Mavuduru&userId=511816e5976d&source=-----91e8d021863d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91e8d021863d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----91e8d021863d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F91e8d021863d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----91e8d021863d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----91e8d021863d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----91e8d021863d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----91e8d021863d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----91e8d021863d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----91e8d021863d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----91e8d021863d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----91e8d021863d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----91e8d021863d--------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://amolmavuduru.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Amol Mavuduru"}, {"url": "https://amolmavuduru.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "565 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F511816e5976d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&user=Amol+Mavuduru&userId=511816e5976d&source=post_page-511816e5976d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f3b67de8f9c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fa-practical-guide-to-stacking-using-scikit-learn-91e8d021863d&newsletterV3=511816e5976d&newsletterV3Id=1f3b67de8f9c&user=Amol+Mavuduru&userId=511816e5976d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}