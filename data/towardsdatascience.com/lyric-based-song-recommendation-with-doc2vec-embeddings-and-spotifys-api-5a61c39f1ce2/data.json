{"url": "https://towardsdatascience.com/lyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2", "time": 1683011190.419489, "path": "towardsdatascience.com/lyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2/", "webpage": {"metadata": {"title": "Lyric-based song recommendation with Doc2Vec embeddings and Spotify\u2019s API | by Adam Reevesman | Towards Data Science", "h1": "Lyric-based song recommendation with Doc2Vec embeddings and Spotify\u2019s API", "description": "Word embeddings are an incredibly useful tool for natural language processing. They are often learned as parameters of a neural network and allow us to map words to numbers. More specifically, they\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1405.4053v2.pdf", "anchor_text": "this paper", "paragraph_index": 10}, {"url": "https://radimrehurek.com/gensim/models/doc2vec.html", "anchor_text": "Gensim", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/an-introduction-to-t-sne-with-python-example-5a3a293108d1", "anchor_text": "t-Distributed Stochastic Neighbor Embedding (t-SNE)", "paragraph_index": 12}, {"url": "https://palletsprojects.com/p/flask/", "anchor_text": "Flask", "paragraph_index": 16}, {"url": "https://github.com/mari-linhares/spotify-flask", "anchor_text": "Spotify-Flask", "paragraph_index": 16}, {"url": "https://github.com/mari-linhares", "anchor_text": "mari-linhares", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Cosine_similarity", "anchor_text": "cosine similarity", "paragraph_index": 18}, {"url": "https://www.linkedin.com/in/adamreevesman/", "anchor_text": "Linkedin", "paragraph_index": 22}, {"url": "https://adamreevesman.com/", "anchor_text": "https://adamreevesman.com/", "paragraph_index": 25}], "all_paragraphs": ["Word embeddings are an incredibly useful tool for natural language processing. They are often learned as parameters of a neural network and allow us to map words to numbers. More specifically, they allow us to map words to high-dimensional vectors. Since word vectors use numbers to represent information, we can use the relationships between them to understand the relationships between the words they represent.", "If we can embed individual words, then we can embed sentences, paragraphs, even entire documents. It turns out that you can create embeddings for just about anything if you find a way to fit it into a model\u2019s architecture.", "By training song embeddings based on lyrics, we can measure the relationships between points in space to understand relationships between songs.", "If we already had trained song embeddings, then we would have an N-dimensional vector corresponding to every song. We could calculate the distance from one song to each of the others. Then, the songs that are \u201cclosest\u201d are the songs that will be recommended.", "All we need to do is get some song lyrics, train embeddings, then build an application that can measure distances and serve recommendations.", "I used the musiXmatch dataset, which is the official lyrics collection of the Million Song Dataset. I chose this dataset because it contains 237,662 songs and is the largest clean lyrics collection available for research.", "Since copyright issues prevent the distribution of the full, original lyrics, the data comes in a bag-of-words format. This means that we don\u2019t get the words in the order they appear. Instead, we get a list of words and the number of times they appeared for each song.", "The bag-of-words format may cause some information loss, but it is a good starting point. There are a few datasets on Kaggle as well that do contain full song lyrics and could be used as well.", "The goal of our modeling is to learn high dimensional embeddings for the songs in our dataset. This can be done with a Distributed Bag of Words Paragraph Vector (PV-DBOW) model, which works in the following way.", "In our case, a paragraph is actually a song. At each iteration of training, a window of text is sampled to create the paragraph matrix. Then, a random word is sampled from that text window. We try to predict that word using the paragraph matrix as input and make updates to the model weights. These weights include those that make up the paragraph vectors.", "If we did have the original lyrics, we could use Distributed Memory Paragraph Vectors (PV-DM). This model could potentially improve our results by taking into account the order in which words appear. More information about paragraph vectors can be found in this paper.", "Gensim is the tool we will use. It is a python library that makes it easy to implement the PV-DBOW model described above. This notebook contains the code used to train and visualize embeddings on lyrics from the musiXmatch dataset.", "t-Distributed Stochastic Neighbor Embedding (t-SNE) is a dimensionality reduction technique that is particularly useful for visualizing high-dimensional data. It estimates a probability distribution based on neighborhoods of points in the high dimensional space and tries to recreate that distribution in a low dimensional space.", "A benefit of t-SNE is that it tends to preserve local relationships. Therefore, we can plot points in low dimensions to get an idea of the relationships in the high dimensional space.", "When applied to the musiXmatch dataset, it looks like this. Each point represents a song and is colored by the artist. The values on the axes are not meaningful on their own, but they do help create a notion of distance between songs.", "The relationships between artists can be reassuring that the model is working as expected. In general, we should expect to see songs by similar artists closer together than songs by artists from different genres.", "Flask is a python library for building web applications. Using Flask, I built an application that allows users to search for music in the musiXmatch dataset and interact with Spotify\u2019s API. Luckily, I found a great resource and didn\u2019t have to reinvent the wheel: Spotify-Flask by mari-linhares.", "After signing in and granting permissions with Spotify\u2019s authentication flow, users can navigate to a page that prompts them to enter a song title, artist, and the number of songs to return. If available, the user\u2019s top artists are suggested to them for inspiration.", "Once an initial song is selected, similar songs are found by measuring the cosine similarity between embeddings. The similar songs are cross-referenced with Spotify\u2019s catalog and the ones that are available are returned to the user.", "If the user likes the songs that are returned, they can save them to a Spotify playlist. If they don\u2019t, then they can try again.", "Song recommendation is just one of the many applications of lyric embeddings. Lyric vectors can be used to uncover new relationships between artists and their music.", "On the other hand, lyric-based song embeddings could be just one small piece of a larger recommendation engine. The current application only uses the lyrics when searching for similar songs, but better recommendations would surely be achieved when taking into account the way a song sounds in addition to what it says.", "I would be pleased to receive feedback on any of the above. Feel free to leave a comment, or reach out via Linkedin/email at areevesman@gmail.com.", "Relevant resources for this project are included below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Engineer at Saama Technologies | MS in Data Science from the University of San Francisco https://adamreevesman.com/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5a61c39f1ce2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@adamreevesman?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamreevesman?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": "Adam Reevesman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3cb46c309812&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&user=Adam+Reevesman&userId=3cb46c309812&source=post_page-3cb46c309812----5a61c39f1ce2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a61c39f1ce2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a61c39f1ce2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1405.4053v2.pdf", "anchor_text": "this paper"}, {"url": "https://radimrehurek.com/gensim/models/doc2vec.html", "anchor_text": "Gensim"}, {"url": "https://towardsdatascience.com/an-introduction-to-t-sne-with-python-example-5a3a293108d1", "anchor_text": "t-Distributed Stochastic Neighbor Embedding (t-SNE)"}, {"url": "https://palletsprojects.com/p/flask/", "anchor_text": "Flask"}, {"url": "https://github.com/mari-linhares/spotify-flask", "anchor_text": "Spotify-Flask"}, {"url": "https://github.com/mari-linhares", "anchor_text": "mari-linhares"}, {"url": "http://52.10.28.182:8081/", "anchor_text": "http://52.10.28.182:8081/"}, {"url": "https://en.wikipedia.org/wiki/Cosine_similarity", "anchor_text": "cosine similarity"}, {"url": "https://www.linkedin.com/in/adamreevesman/", "anchor_text": "Linkedin"}, {"url": "http://52.10.28.182:8081/", "anchor_text": "http://52.10.28.182:8081/"}, {"url": "https://github.com/areevesman/lyric-embeddings/blob/master/train_example.ipynb", "anchor_text": "My notebook for training and visualizing embeddings"}, {"url": "http://millionsongdataset.com/musixmatch/", "anchor_text": "musiXmatch dataset"}, {"url": "https://arxiv.org/pdf/1405.4053v2.pdf", "anchor_text": "Quoc Le and Tomas Mikolov: \u201cDistributed Representations of Sentences and Documents\u201d"}, {"url": "https://radimrehurek.com/gensim/models/doc2vec.html", "anchor_text": "Gensim doc2vec documentation"}, {"url": "https://mlexplained.com/2018/09/14/paper-dissected-visualizing-data-using-t-sne-explained/#:~:text=It%20uses%20the%20local%20relationships,points%20in%20high%2Ddimensional%20space", "anchor_text": "Paper Dissected: \u201cVisualizing Data using t-SNE\u201d Explained"}, {"url": "https://towardsdatascience.com/an-introduction-to-t-sne-with-python-example-5a3a293108d1", "anchor_text": "An Introduction to t-SNE with Python Example"}, {"url": "https://palletsprojects.com/p/flask/", "anchor_text": "Flask\u2019s website"}, {"url": "https://developer.spotify.com/documentation/web-api/", "anchor_text": "Spotify API documentation"}, {"url": "https://github.com/mari-linhares/spotify-flask", "anchor_text": "Spotify-Flask"}, {"url": "https://medium.com/tag/music?source=post_page-----5a61c39f1ce2---------------music-----------------", "anchor_text": "Music"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----5a61c39f1ce2---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----5a61c39f1ce2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----5a61c39f1ce2---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5a61c39f1ce2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5a61c39f1ce2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&user=Adam+Reevesman&userId=3cb46c309812&source=-----5a61c39f1ce2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5a61c39f1ce2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&user=Adam+Reevesman&userId=3cb46c309812&source=-----5a61c39f1ce2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a61c39f1ce2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5a61c39f1ce2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5a61c39f1ce2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5a61c39f1ce2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamreevesman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@adamreevesman?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adam Reevesman"}, {"url": "https://medium.com/@adamreevesman/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "348 Followers"}, {"url": "https://adamreevesman.com/", "anchor_text": "https://adamreevesman.com/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3cb46c309812&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&user=Adam+Reevesman&userId=3cb46c309812&source=post_page-3cb46c309812--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F3cb46c309812%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2&user=Adam+Reevesman&userId=3cb46c309812&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}