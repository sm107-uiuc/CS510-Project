{"url": "https://towardsdatascience.com/predicting-ufc-fights-with-machine-learning-5d66b58e2e3a", "time": 1683002993.432447, "path": "towardsdatascience.com/predicting-ufc-fights-with-machine-learning-5d66b58e2e3a/", "webpage": {"metadata": {"title": "Predicting UFC Fights With Machine Learning | by Charles Pierse | Towards Data Science", "h1": "Predicting UFC Fights With Machine Learning", "description": "As a fan of MMA I often find myself trying to predict the outcome of fights on an upcoming fight card. The problem is that fighting by its nature can be very unpredictable. More so than even boxing\u2026"}, "outgoing_paragraph_urls": [{"url": "http://www.ufcfightpredictor.com/", "anchor_text": "predictor", "paragraph_index": 0}, {"url": "https://github.com/cdpierse/UFC_Fight_Predictor", "anchor_text": "github", "paragraph_index": 0}, {"url": "http://www.ufcstats.com", "anchor_text": "www.ufcstats.com", "paragraph_index": 3}, {"url": "https://medium.com/@yuan_tian/predict-ufc-fights-with-deep-learning-ii-data-collection-and-implementation-in-pytorch-ff7a95062554", "anchor_text": "post", "paragraph_index": 4}, {"url": "https://medium.com/u/98d39400f6fe?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "Yuan Tian", "paragraph_index": 4}, {"url": "https://scrapy.org/", "anchor_text": "Scrapy", "paragraph_index": 8}, {"url": "http://www.ufcstats.com/statistics/events/completed", "anchor_text": "events", "paragraph_index": 10}, {"url": "http://www.ufcstats.com/statistics/fighters", "anchor_text": "fighter stats", "paragraph_index": 12}, {"url": "https://github.com/cdpierse/UFC_Fight_Predictor/tree/master/fight_predictor/scrapers", "anchor_text": "here", "paragraph_index": 14}, {"url": "https://github.com/keras-team/keras-tuner", "anchor_text": "Keras Tuner", "paragraph_index": 21}], "all_paragraphs": ["TL;DR: check out the predictor for yourself and see how it performs for an upcoming UFC fight card or check out the code on github", "As a fan of MMA I often find myself trying to predict the outcome of fights on an upcoming fight card. The problem is that fighting by its nature can be very unpredictable. More so than even boxing, the outcome of an MMA fight can change in a split second, but of course that\u2019s what makes it so interesting.", "All the same I wondered if there was a way to apply modern machine learning techniques to historical fight data and see how a model would perform on new fights.", "Of course like any ML project I needed data to work with. Fortunately I had a good idea of where I might find some having often visited www.ufcstats.com the day after a fight card to get the stats breakdown for a fight.", "So now that I had my data source and a couple of ideas of how I could implement the model I wondered if anyone else had built a project like this and came across this post by Yuan Tian detailing his process for building a fight predictor.", "Yuan\u2019s post was very detailed and insightful and my methodology for scraping the stats page was largely inspired by how he structured his scrapers. Thanks Yuan!", "In Yuan\u2019s predictor he used fight data that would be available before a fight with stats that I called \u201cstatic fight stats\u201d e.g. age, reach, weight, W/L record etc. However, the UFC stats page also detailed fight specific stats for historical bouts such as strikes thrown, takedowns , submission attempts, and guard passes.", "As there weren\u2019t an awful lot of data points on the UFC stats page to begin with I felt discarding these \u201cdynamic fight stats\u201d would be a shame. So I decided to build the predictor as a two way predictive system:", "The scrapers for this project are broken down into two Scrapy spiders that crawl two sections of UFC Fight Stats:", "The Bout scrapers data object is broken down as the following Scrapy Item:", "The Bout spider crawls the events section of UFC Fight Stats and records bout specific stats such as str_stat_f1 (striking stats for fighter 1) for each fighter, many of these will become our dependent variables for the multi target regression problem. Fighter1 and Fighter2 are the names of the fighters involved in a bout and we join the fighter scraper data on these values.", "The Fighter scraper data object is broken down as :", "Each item here is individually scraped from the fighter stats page which details career stats for every fighter involved in a UFC bout (although data from the earlier days of the UFC is less populated).", "I save both of these data objects as tables into a SQLite database and have a small script for generating a combined fight-bouts CSV file where each row is a bout with fighter1 and fighter2\u2019s individual fighter stats appended. This CSV as well as a CSV representation of just the fighters data object will be the two files we use to build both models.", "If you\u2019re interested in seeing the actual scraping logic for each spider take a look at the here.", "As is the case with most ML projects of this kind the real work is done in the preprocessing step and how the data is prepared for the modelling stage.", "This aspect of the project went through numerous iterations. I began in a Jupyter notebook but as the complexity increased and I decided that I wanted to implement it as front end application I changed the design over to classes that contain shared preprocessing methods for both the winner predictor and the stats predictor as well as task specific preprocessing methods.", "A lot of the preprocessing is dedicated to cleaning up values that are missing or in the wrong the format e.g. heights being represented as strings, parsing string fighter records, and getting a fighter\u2019s age at the time of fight.", "One of the trickiest aspects of preprocessing was changing the ordering of fighter1 and fighter2\u2019s stats. The reason I had to shuffle this ordering was as a result of the UFC\u2019s bout data always being ordered such that fighter1 is the winner so I had to figure out a way to randomly select half the dataset and swap fighter1 and fighter2\u2019s stats positions with one another so that the final dataset is neatly broken up such that 50% of fighter1 are the winner, and 50% fighter2 are winners. I\u2019d love to tidy up this logic going forward and if anyone has any suggestions on improvements I\u2019d love to hear \u2018em.", "Another important feature for the processor classes is that they had to be able to handle data processing differently in production as in a production situation the dataframe isn\u2019t neatly constructed like it is for the training step.", "In production fighter stats have to be predicted ad hoc and then inserted into the final dataframe for winner prediction. My solution for this was to create additional child classes for the processors that could handle production specific cases.", "Both models are built using Keras, with relatively straight forward architectures comprised of only a single fully connected hidden layer for each model. I took a mostly heuristic approach to finding the optimal parameters for both but I\u2019m eager to use newer tools optimization tools like Keras Tuner to fine tune its performance.", "The stats model takes a scaled numerical representation of all the stats that are available for both fighters before a fight and it\u2019s output layer is made up of 8 fight specific stats:", "As this is a regression problem the final layer in the stats model has a linear activation (the default activation). For loss I used \u2018mse\u2019 with R\u00b2 as the models' metric to evaluate performance.", "The R\u00b2 for this model comes out usually at about 0.63\u201364 on the validation set, which isn\u2019t too bad, but it\u2019s worth noting that R\u00b2 will always increase as an additional predictor (output) is added and some of this could be attributed to random noise that happens to align by chance. To counter this I\u2019ll be adding adjusted R\u00b2 to penalize the model for every new output added in a new version.", "Like the stats model this follows a basic single fully connected hidden layer architecture. The dependent variable is either a 0 (fighter1) or 1 (fighter2) so I add a simple sigmoid activation on the final layer to predict one of these outcomes.", "This model\u2019s accuracy usually comes out at about 86% although it must be stressed that this accuracy is achieved with perfect information of the dynamic fight stats which in production are predicted values and thus not perfect information, so there is a huge contingency on the predictive power of the stats prediction model.", "As I wanted to serve the model and it\u2019s predictions as a front end service I needed to build some API endpoints to access the model(s) and the list of fighters that predictions can be made for.", "Using Flask this was relatively straight forward. There are two main endpoints, one serves a list of fighter names for generating predictions and the other queues up the prediction pipeline and returns the result.", "The pipeline processes a dataframe for each fighter and then concatenates both into the correct shape and order for stats prediction. Once the stats prediction values are returned they are added as columns with their respective names and positions to the dataframe and passsed to the winner prediction model returning a result which is associated to either fighter 1 or 2.", "All of the API\u2019s functionality is then called by a very simple React front end that provides the user with two searchable dropdowns and a results display that shows the predicted winner and the model\u2019s confidence in its prediction.", "Setting this up in React was easy and I find React to generally be a joy to work with ( I \u2764 hooks).", "There\u2019s an awful lot I\u2019d like to and will be adding to the front end such as a table showing a users\u2019 history of predictions, and a infograph showing basic fighter stats.", "Hopefully this has been informative for both ML enthusiasts and/or fans of MMA in general, as I\u2019ve mentioned there\u2019s a lot of features I\u2019d like to add this project in the future, and I\u2019d love to hear your thoughts. Thanks!", "P.S. Maybe don\u2019t go betting the house down on all of the model\u2019s predicted outcomes just yet.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5d66b58e2e3a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@charlespierse?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@charlespierse?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "Charles Pierse"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1efa9a37c582&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&user=Charles+Pierse&userId=1efa9a37c582&source=post_page-1efa9a37c582----5d66b58e2e3a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d66b58e2e3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d66b58e2e3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@dylan_nolte?utm_source=medium&utm_medium=referral", "anchor_text": "dylan nolte"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://www.ufcfightpredictor.com/", "anchor_text": "predictor"}, {"url": "https://github.com/cdpierse/UFC_Fight_Predictor", "anchor_text": "github"}, {"url": "http://www.ufcstats.com", "anchor_text": "www.ufcstats.com"}, {"url": "https://medium.com/@yuan_tian/predict-ufc-fights-with-deep-learning-ii-data-collection-and-implementation-in-pytorch-ff7a95062554", "anchor_text": "post"}, {"url": "https://medium.com/u/98d39400f6fe?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "Yuan Tian"}, {"url": "https://towardsdatascience.com/regression-models-with-multiple-target-variables-8baa75aacd", "anchor_text": "multi target regression"}, {"url": "https://scrapy.org/", "anchor_text": "Scrapy"}, {"url": "http://www.ufcstats.com/statistics/events/completed", "anchor_text": "events"}, {"url": "http://www.ufcstats.com/statistics/fighters", "anchor_text": "fighter stats"}, {"url": "https://github.com/cdpierse/UFC_Fight_Predictor/tree/master/fight_predictor/scrapers", "anchor_text": "here"}, {"url": "https://github.com/keras-team/keras-tuner", "anchor_text": "Keras Tuner"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5d66b58e2e3a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/react?source=post_page-----5d66b58e2e3a---------------react-----------------", "anchor_text": "React"}, {"url": "https://medium.com/tag/python?source=post_page-----5d66b58e2e3a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5d66b58e2e3a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----5d66b58e2e3a---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d66b58e2e3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&user=Charles+Pierse&userId=1efa9a37c582&source=-----5d66b58e2e3a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5d66b58e2e3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&user=Charles+Pierse&userId=1efa9a37c582&source=-----5d66b58e2e3a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5d66b58e2e3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5d66b58e2e3a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5d66b58e2e3a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5d66b58e2e3a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@charlespierse?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@charlespierse?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Charles Pierse"}, {"url": "https://medium.com/@charlespierse/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "244 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1efa9a37c582&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&user=Charles+Pierse&userId=1efa9a37c582&source=post_page-1efa9a37c582--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F54aad00fd938&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-ufc-fights-with-machine-learning-5d66b58e2e3a&newsletterV3=1efa9a37c582&newsletterV3Id=54aad00fd938&user=Charles+Pierse&userId=1efa9a37c582&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}