{"url": "https://towardsdatascience.com/pedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6", "time": 1682995116.287146, "path": "towardsdatascience.com/pedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6/", "webpage": {"metadata": {"title": "Pedestrian detection in Aerial Images using RetinaNet | by Priya Dwivedi | Towards Data Science", "h1": "Pedestrian detection in Aerial Images using RetinaNet", "description": "Object Detection in Aerial Images is a challenging and interesting problem. With the cost of drones decreasing, there is a surge in amount of aerial data being generated. It will be very useful to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1708.02002", "anchor_text": "Retina Net", "paragraph_index": 0}, {"url": "http://cvgl.stanford.edu/projects/uav_data/", "anchor_text": "Stanford Drone Data set", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1708.02002", "anchor_text": "RetinaNet", "paragraph_index": 1}, {"url": "https://medium.com/@jonathan_hui/understanding-feature-pyramid-networks-for-object-detection-fpn-45b227b9106c", "anchor_text": "Feature pyramid network", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1612.03144", "anchor_text": "paper", "paragraph_index": 1}, {"url": "https://medium.com/@14prakash/the-intuition-behind-retinanet-eb636755607d", "anchor_text": "link", "paragraph_index": 3}, {"url": "https://github.com/priya-dwivedi/keras_retinanet_cs230", "anchor_text": "Github link", "paragraph_index": 3}, {"url": "http://cvgl.stanford.edu/projects/uav_data/", "anchor_text": "Stanford Drone Data", "paragraph_index": 4}, {"url": "https://github.com/fizyr/keras-retinanet", "anchor_text": "this implementation", "paragraph_index": 5}, {"url": "https://github.com/priya-dwivedi/keras_retinanet_cs230", "anchor_text": "Github", "paragraph_index": 7}, {"url": "https://github.com/priya-dwivedi/keras_retinanet_cs230", "anchor_text": "Github repo", "paragraph_index": 9}, {"url": "http://deeplearninganalytics.org/", "anchor_text": "http://deeplearninganalytics.org/", "paragraph_index": 13}, {"url": "https://medium.com/@priya.dwivedi", "anchor_text": "https://medium.com/@priya.dwivedi", "paragraph_index": 14}], "all_paragraphs": ["Object Detection in Aerial Images is a challenging and interesting problem. With the cost of drones decreasing, there is a surge in amount of aerial data being generated. It will be very useful to have models that can extract valuable information from aerial data. Retina Net is the most famous single stage detector and in this blog, I want to test it out on an aerial images of pedestrians and bikers from the Stanford Drone Data set. See a sample image below. This is a challenging problem since most objects are only a few pixels wide, some objects are occluded and objects in shade are even harder to detect. I have read several blogs of object detection on aerial images or cars/planes but there are only a few links for pedestrian detection aerially which is especially challenging.", "RetinaNet is a single stage detector that uses Feature Pyramid Network (FPN) and Focal loss for training. Feature pyramid network is a structure for multiscale object detection introduced in this paper. It combines low-resolution, semantically strong features with high-resolution, semantically weak features via a top-down pathway and lateral connections. The net result is that it produces feature maps of different scale on multiple levels in the network which helps with both classifier and regressor networks.", "The Focal Loss is designed to address the single-stage object detection problems with the imbalance where there is a very large number of possible background classes and just a few foreground classes. This causes training to be inefficient as most locations are easy negatives that contribute no useful signal and the massive amount of these negative examples overwhelm the training and reduces model performance. Focal loss is based on cross entropy loss as shown below and by adjusting the gamma parameter, we can reduce the loss contribution from well classified examples.", "In this blog, I want to talk about how to train a RetinaNet model on Keras. I haven\u2019t done enough justice to the theory behind RetinaNet. I used this link to understand the model and would highly recommend it. My first trained model worked quite well in detecting objects aerially as shown in the video below. I have also open sourced the code on my Github link.", "Stanford Drone Data is a massive data set of aerial images collected by drone over the Stanford campus. The data set is ideal for object detection and tracking problems. It contains about 60 aerial videos. For each video we have bounding box coordinates for the 6 classes \u2014 \u201cPedestrian\u201d, \u201cBiker\u201d, \u201cSkateboarder\u201d, \u201cCart\u201d, \u201cCar\u201d and \u201c Bus\u201d. The data set is very rich in pedestrians and bikers with these 2 classes covering about 85%-95% of the annotations.", "To train the Retina Net, I used this implementation in Keras. It is very well documented and works without bugs. Thanks a lot to Fizyr for open sourcing their implementation!", "The main steps I followed were:", "I converted Stanford annotations in this format and my train and validation annotations are uploaded to my Github.", "So I adjusted the anchors to drop the biggest one of 512 and instead add a small anchor of size 16. This results in a noticeable improvement as shown below:", "Here weights are the COCO weights that can be used to jump start training. The annotations for training and validation are the input data and config.ini has the updated anchor sizes. All the files are on my Github repo too.", "That\u2019s it! The model is slow to train and I trained it overnight. I tested the accuracy of the trained model by checking for mean average precision (MAP) on the test set. As can be seen below the first trained model had a very good MAP of 0.63. The performance is especially good on car and bus classes which are easy to see aerially. The MAP on Biker class is low as this is often confused by pedestrian. I am currently working on further improving accuracy of the Biker class.", "Retina Net is a powerful model that uses Feature Pyramid Networks. It is able to detect objects aerially on a very challenging data set where object sizes are quite small. I was able to train a Retina Net with half a day of work. The first version of the trained model has pretty good performance. I am still exploring how to further adapt Retina Net architecture to have a higher accuracy in aerial detection. That will be covered in my next blog.", "I hope you liked the blog and try training the model yourself too.", "I have my own deep learning consultancy and love to work on interesting problems. I have helped many startups deploy innovative AI based solutions. Check us out at \u2014 http://deeplearninganalytics.org/.", "You can also see my other writings at: https://medium.com/@priya.dwivedi", "If you have a project that we can collaborate on, then please contact me through my website or at info@deeplearninganalytics.org", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9053e8a72c6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438----9053e8a72c6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9053e8a72c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9053e8a72c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1708.02002", "anchor_text": "Retina Net"}, {"url": "http://cvgl.stanford.edu/projects/uav_data/", "anchor_text": "Stanford Drone Data set"}, {"url": "https://arxiv.org/abs/1708.02002", "anchor_text": "RetinaNet"}, {"url": "https://medium.com/@jonathan_hui/understanding-feature-pyramid-networks-for-object-detection-fpn-45b227b9106c", "anchor_text": "Feature pyramid network"}, {"url": "https://arxiv.org/abs/1612.03144", "anchor_text": "paper"}, {"url": "https://medium.com/@14prakash/the-intuition-behind-retinanet-eb636755607d", "anchor_text": "link"}, {"url": "https://github.com/priya-dwivedi/keras_retinanet_cs230", "anchor_text": "Github link"}, {"url": "http://cvgl.stanford.edu/projects/uav_data/", "anchor_text": "Stanford Drone Data"}, {"url": "https://github.com/fizyr/keras-retinanet", "anchor_text": "this implementation"}, {"url": "https://drive.google.com/drive/u/0/folders/1QpE_iRDq1hUzYNBXSBSnmfe6SgTYE3J4", "anchor_text": "here"}, {"url": "https://github.com/priya-dwivedi/keras_retinanet_cs230", "anchor_text": "Github"}, {"url": "https://github.com/priya-dwivedi/keras_retinanet_cs230", "anchor_text": "Github repo"}, {"url": "http://deeplearninganalytics.org/", "anchor_text": "http://deeplearninganalytics.org/"}, {"url": "https://medium.com/@priya.dwivedi", "anchor_text": "https://medium.com/@priya.dwivedi"}, {"url": "https://medium.com/@14prakash/the-intuition-behind-retinanet-eb636755607d", "anchor_text": "Retina Net"}, {"url": "http://cvgl.stanford.edu/projects/uav_data/", "anchor_text": "Stanford Drone Data Set"}, {"url": "https://github.com/fizyr/keras-retinanet", "anchor_text": "Retina Net Keras Implementation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9053e8a72c6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9053e8a72c6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----9053e8a72c6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9053e8a72c6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----9053e8a72c6---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9053e8a72c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&user=Priya+Dwivedi&userId=b040ce924438&source=-----9053e8a72c6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9053e8a72c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&user=Priya+Dwivedi&userId=b040ce924438&source=-----9053e8a72c6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9053e8a72c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9053e8a72c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9053e8a72c6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9053e8a72c6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9053e8a72c6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9053e8a72c6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9053e8a72c6--------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://priya-dwivedi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Priya Dwivedi"}, {"url": "https://priya-dwivedi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.1K Followers"}, {"url": "http://www.deeplearninganalytics.org/", "anchor_text": "http://www.deeplearninganalytics.org/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb040ce924438&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&user=Priya+Dwivedi&userId=b040ce924438&source=post_page-b040ce924438--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F373349a3bfb7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpedestrian-detection-in-aerial-images-using-retinanet-9053e8a72c6&newsletterV3=b040ce924438&newsletterV3Id=373349a3bfb7&user=Priya+Dwivedi&userId=b040ce924438&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}