{"url": "https://towardsdatascience.com/practical-machine-learning-with-keras-19d0e5b2558", "time": 1682997205.963093, "path": "towardsdatascience.com/practical-machine-learning-with-keras-19d0e5b2558/", "webpage": {"metadata": {"title": "Practical Machine Learning with Keras | by Arkajyoti Mukherjee | Towards Data Science", "h1": "Practical Machine Learning with Keras", "description": "In this article, I have tried explaining what is keras and summarized all the ways I build a model in keras, explaining all the practical tips and all the nuances related to it. This article will\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/tensorflow/tensorflow", "anchor_text": "TensorFlow", "paragraph_index": 4}, {"url": "https://github.com/Microsoft/cntk", "anchor_text": "CNTK", "paragraph_index": 4}, {"url": "https://github.com/Theano/Theano", "anchor_text": "Theano", "paragraph_index": 4}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras", "anchor_text": "tf.keras", "paragraph_index": 7}, {"url": "https://keras.io/", "anchor_text": "Keras API specification", "paragraph_index": 7}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks", "anchor_text": "tf.keras.callbacks", "paragraph_index": 28}, {"url": "https://colab.research.google.com/drive/1C2STpQWW7YoQZmLtdlPQ7ndJ9X1erzqa#scrollTo=wcL3bgdvO-C1", "anchor_text": "code", "paragraph_index": 32}, {"url": "https://twitter.com/guywithpajamas", "anchor_text": "here", "paragraph_index": 34}, {"url": "https://www.linkedin.com/in/arkajyoti-mukherjee-03b633154/", "anchor_text": "here", "paragraph_index": 34}, {"url": "https://github.com/arkajyotiMukherjee", "anchor_text": "there", "paragraph_index": 34}], "all_paragraphs": ["In this article, I have tried explaining what is keras and summarized all the ways I build a model in keras, explaining all the practical tips and all the nuances related to it. This article will teach you several common techniques of increasing complexity that is used in model building.", "We will be working with a very famous dataset of handwritten digits called MNIST and make CNN models in these three different methods. I\u2019ll also include basic loading and using data.", "This article won\u2019t teach you the theory or the mathematics behind machine learning. If you are new to machine learning or have just started learning it I\u2019ll provide some resources to help you out.", "Now with that out of the way, let\u2019s begin learning.", "Keras is a high-level neural network API, written in Python and capable of running on top of TensorFlow, CNTK, or Theano (We will be using Keras with Tensorflow as backend).", "Skipping the formal definition, keras is an easy-to-use machine learning library that can be used for doing fast prototyping to building complex custom models for research and production and anything in-between. Keras has a very modular and composable API in the sense Keras models are made by connecting configurable building blocks together (You\u2019ll see in a bit, how easy it is).", "Now that you know somewhat about what is keras, let\u2019s dive straight into the practical implementation of it.", "tf.keras is TensorFlow's implementation of the Keras API specification. This is a high-level API to build and train models that include first-class support for TensorFlow-specific functionality.", "Now that we have our data loaded and all prepared to throw into a machine learning model, we can write our first model. You have done good my friend, have a cat picture as a reward.", "In keras, the models can be broken down into graph of layers with different connections between them. The most common type is a stack of layers, hence the name Sequential.", "Let\u2019s see the different ways to add activations, initializers, and regularizations:", "Let\u2019s build a model to classify the MNIST data. Here we will be showing how to define Convolutional and MaxPool layers. We will be using a standard structure to build a CNN: Conv layers followed by MaxPool layers. Then we flatten the layers with Flatten layer and apply a Fully connected with Dense followed by a final classification layer, which classifies the prediction into the 10 [0\u20139] output classes. You\u2019ll see the structure more clearly when we call model.summary().", "Now that our model is constructed we have to configure the model by calling the compile method. It takes three important parameters:", "We have everything set up for training, let\u2019s train our first keras model. We train a model by calling the fit method on the model. This model takes a few important arguments apart from the training data and labels:", "[Note: For the purpose of the tutorial we have taken validation data and test data to be the same but in practice, you should keep aside some data unseen by the model as test data.]", "To test our model\u2019s performance we can use either get the predictions or evaluate the model directly and getting the loss and accuracy, by using predict and evaluate functions on the model respectively.", "Let\u2019s check what our predictions are for the first test example and also make it into a handy method so we can call it for later models with different indices.", "Congratulations you have made your first keras model, trained it and made evaluations. You deserve another cat picture for motivation because some advance stuff is coming.", "Sequential models are often used in practice but in many special cases, you would like to define some arbitrary models which a simple stack of layers cannot define. We can resort to Keras Functional API in complex models such as:", "Building a model with Functional API follows a set of rules:", "Enough talk, now let\u2019s build one.", "The training and evaluation for the model remain the same so, I\u2019ll just give the code here. In this one, we just didn\u2019t use a validation set instead uses a test set to evaluate the model on unseen data after training.", "Now you know how to make weird and complex connections in your model as you like it, but what if you had to define your own forward pass. We have a solution for that, but first, you should relish this cat image for your hard work.", "We have built our model, defined our own data flow, but we still don\u2019t have complete control over the forward pass of the model. We can build a fully customizable model by subclassing the tf.keras.Model instance.", "There are a few steps involved in it, pay close attention:", "Let\u2019s put theory into action and make out a subclassed model for recognizing MNIST data:", "Let\u2019s train, evaluate and test our model.", "Congratulations now you know the tools to make almost all types of models that are out there. Let\u2019s learn one more really handy things before drawing a conclusion, just after a cat break.", "A callback is an object passed to a model to customize and extend its behavior during training. You can write your own custom callback, or use the built-in tf.keras.callbacks that include:", "The fit method\u2019s callback parameters expect an array of callbacks, there we will pass the callbacks. In this example, we will be using the two most common ones LearningRateScheduler and EarlyStopping.", "Let\u2019s train, evaluate and test our model like before.", "I hope this you found this article useful and a bit entertaining because of the cats. If you know a bit of machine learning beforehand this might be useful to use as this article is solely practical oriented and hopefully now you should go out and make some really awesome projects.", "Here\u2019s the link to the entire code:", "If you have any doubts regarding this article or if I made any mistake feel free to post in the comments. Here\u2019s a chonky cat for reading the whole article.", "You can find me on Twitter here.If you are more of a LinkedIn person, catch me here.Or if Github is your thing, I\u2019m there too.", "Feel free to contact me if you have a problem with Machine Learning, Tensorflow or just hit me up with a cat gif if that\u2019s your thing. I\u2019m no expert but I\u2019ll try my best to help you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Crazy coder with an even more crazy writer inside :3"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F19d0e5b2558&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@arkajyoti31?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arkajyoti31?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": "Arkajyoti Mukherjee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F722f0a2f8544&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&user=Arkajyoti+Mukherjee&userId=722f0a2f8544&source=post_page-722f0a2f8544----19d0e5b2558---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19d0e5b2558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19d0e5b2558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/comfreak-51581/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3010309", "anchor_text": "Comfreak"}, {"url": "https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3010309", "anchor_text": "Pixabay"}, {"url": "https://www.coursera.org/learn/machine-learning", "anchor_text": "https://www.coursera.org/learn/machine-learning"}, {"url": "https://www.coursera.org/specializations/deep-learning", "anchor_text": "https://www.coursera.org/specializations/deep-learning"}, {"url": "https://github.com/tensorflow/tensorflow", "anchor_text": "TensorFlow"}, {"url": "https://github.com/Microsoft/cntk", "anchor_text": "CNTK"}, {"url": "https://github.com/Theano/Theano", "anchor_text": "Theano"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras", "anchor_text": "tf.keras"}, {"url": "https://keras.io/", "anchor_text": "Keras API specification"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks", "anchor_text": "tf.keras.callbacks"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/ModelCheckpoint", "anchor_text": "tf.keras.callbacks.ModelCheckpoint"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/LearningRateScheduler", "anchor_text": "tf.keras.callbacks.LearningRateScheduler"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping", "anchor_text": "tf.keras.callbacks.EarlyStopping"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/TensorBoard", "anchor_text": "tf.keras.callbacks.TensorBoard"}, {"url": "https://www.tensorflow.org/guide/summaries_and_tensorboard", "anchor_text": "TensorBoard"}, {"url": "https://colab.research.google.com/drive/1C2STpQWW7YoQZmLtdlPQ7ndJ9X1erzqa#scrollTo=wcL3bgdvO-C1", "anchor_text": "code"}, {"url": "https://twitter.com/guywithpajamas", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/arkajyoti-mukherjee-03b633154/", "anchor_text": "here"}, {"url": "https://github.com/arkajyotiMukherjee", "anchor_text": "there"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----19d0e5b2558---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----19d0e5b2558---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/keras?source=post_page-----19d0e5b2558---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----19d0e5b2558---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/projects?source=post_page-----19d0e5b2558---------------projects-----------------", "anchor_text": "Projects"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19d0e5b2558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&user=Arkajyoti+Mukherjee&userId=722f0a2f8544&source=-----19d0e5b2558---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19d0e5b2558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&user=Arkajyoti+Mukherjee&userId=722f0a2f8544&source=-----19d0e5b2558---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19d0e5b2558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F19d0e5b2558&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----19d0e5b2558---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----19d0e5b2558--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----19d0e5b2558--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----19d0e5b2558--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----19d0e5b2558--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arkajyoti31?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arkajyoti31?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arkajyoti Mukherjee"}, {"url": "https://medium.com/@arkajyoti31/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "117 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F722f0a2f8544&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&user=Arkajyoti+Mukherjee&userId=722f0a2f8544&source=post_page-722f0a2f8544--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F722f0a2f8544%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-machine-learning-with-keras-19d0e5b2558&user=Arkajyoti+Mukherjee&userId=722f0a2f8544&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}