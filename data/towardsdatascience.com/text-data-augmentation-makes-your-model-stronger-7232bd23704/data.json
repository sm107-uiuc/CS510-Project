{"url": "https://towardsdatascience.com/text-data-augmentation-makes-your-model-stronger-7232bd23704", "time": 1683001057.666473, "path": "towardsdatascience.com/text-data-augmentation-makes-your-model-stronger-7232bd23704/", "webpage": {"metadata": {"title": "Text Data Augmentation makes your model stronger | by Marco Cerliani | Towards Data Science", "h1": "Text Data Augmentation makes your model stronger", "description": "Text classification algorithms are extremely sensitive to the diversity present in training. A robust NLP pipeline must take into account the possibility of the presence of low quality data and try\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/purvank/uber-rider-reviews-dataset", "anchor_text": "Uber Ride Reviews Dataset", "paragraph_index": 3}], "all_paragraphs": ["Text classification algorithms are extremely sensitive to the diversity present in training. A robust NLP pipeline must take into account the possibility of the presence of low quality data and try to override the problem in the best way possible.", "Working with images, the standard approach, to strengthen a classification algorithm and introduce diversity, is to operate data augmentation. Nowadays there are a lot of beautiful and clever techniques which operate automatic image augmentation. Not so common and with ambiguous results are the methods for text data augmentation in NLP tasks.", "In this post, I\u2019ll show a simple and intuitive technique in order to perform text data generation. With Markov Chain rules, we will be able to generate new textual samples to feed our model and test its performance.", "I got the data for our experiments from Kaggle. The Uber Ride Reviews Dataset is a collection of ride reviews published during 2014\u20132017 and scraped from the web. Inside we can find the raw textual reviews, the Ride Rating (1\u20135) given by the user and the Ride Sentiment (if the rating is above 3: sentiment is 1, otherwise 0). As you can see, this is an unbalanced classification problem where the distribution of Ride Reviews is skewed in favor of positive rates.", "Firstly, our aim is to predict the sentiment of the reviews fitting and trying different architectures. The most interesting point happens at the second stage, where we want to put our models under pressure; i.e. we make them predict some fake data randomly generated with Markov Chain. We want to test if our models are stable enough to achieve adequate performance predicting data coming from train (after adding some noise). If all it\u2019s OK, our models shouldn\u2019t have a problem to produce good results on this fake data and hopefully improve performance on test, on the contrary, we need to revisit the train process.", "Before starting the training procedure, we have to generate our fake data. All begin studying the distribution of review lengths in train.", "We have to store this information because our new reviews will have a similar length distribution. The generation process is composed of two phases. The first one, where we \u201cbuild the chains\u201d, i.e. we receive as input a collection of texts (in our case the training corpus) and automatically take note for each word every possible following words present in the corpus. In the second phase, we can simply create new reviews based on the previous chains\u2026 we choose at random, from the whole vocabulary of the starting corpus, a word (the beginning of our review) and choose the following new one at random entering in its chain. At the end of this decision, we are ready to restart the process from the new word selected. Generally speaking, we are simulating a Markov Chain process where, in order to build a new review, a word is chosen based only on the previous one.", "I have ensembled the two phases in a unique function (Generator). This function receives as input the textual reviews, with the relative labels, and the desired prefixed number of new instances to generate (for each class). The original length distribution is useful because we can sample from it the plausible lengths of our reviews.", "We need texts with labels as input because we split the generating process into different subprocess: reviews coming from a particular class are selected to generate new reviews for the same class; so we need to differentiate the building chains and sampling process in order to produce truthful samples for our predictive models.", "We split our initial dataset in train and test. We\u2019ve used the train as a corpus to feed our generator and create new reviews. We generate 200 (100 for each class) reviews to form a new separate test set and 600 (300 for each class) which will strengthen our train set. Our arsenal of models is composed of a Layer Perceptron Neural Network, a Logistic Regression and a Random Forest. The training process is divided into two stages. Firstly, we fit all the models with the original training and check for the performances in test and separately on our fake test data. We expect that all the models outperform the fake test data because they are generated from the training. Secondly, we repeat the fit of our models with the strengthen train and check the performance on our test sets.", "At the first stage, the best model on the test data is the Neural Network (AUC, precision, recall and f1 are reported as performance metrics) but surprisingly, the Logistic Regression and the Random Forest fail on the fake test! This says to us that our models are not well fitted. We try again fitting the models but this time we use the reinforced training set. At this point, the performance on the original test increase for all the models and now they start to generalize well also on the fake data.", "In this post, I assemble an easy procedure to generate fake text data. This technique is useful to us when we fit an NLP classifier and we want to test its strength. If our model isn\u2019t able to classify well fake data coming from train, it\u2019s appropriate to revisit the training process, adjusting the hyperparameters or directly adding some of these data in train.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7232bd23704&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7232bd23704--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7232bd23704--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----7232bd23704--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----7232bd23704--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----7232bd23704---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7232bd23704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7232bd23704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@julsssy?utm_source=medium&utm_medium=referral", "anchor_text": "Julienne Erika Alviar"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/purvank/uber-rider-reviews-dataset", "anchor_text": "Uber Ride Reviews Dataset"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7232bd23704---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7232bd23704---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----7232bd23704---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/data-augmentation?source=post_page-----7232bd23704---------------data_augmentation-----------------", "anchor_text": "Data Augmentation"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----7232bd23704---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7232bd23704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&user=Marco+Cerliani&userId=c843902314c7&source=-----7232bd23704---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7232bd23704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&user=Marco+Cerliani&userId=c843902314c7&source=-----7232bd23704---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7232bd23704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7232bd23704--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7232bd23704&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7232bd23704---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7232bd23704--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7232bd23704--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7232bd23704--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7232bd23704--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7232bd23704--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7232bd23704--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7232bd23704--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7232bd23704--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-data-augmentation-makes-your-model-stronger-7232bd23704&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}