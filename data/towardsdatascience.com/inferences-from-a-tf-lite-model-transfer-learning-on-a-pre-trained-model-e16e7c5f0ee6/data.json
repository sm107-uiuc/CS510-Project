{"url": "https://towardsdatascience.com/inferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6", "time": 1683009276.144873, "path": "towardsdatascience.com/inferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6/", "webpage": {"metadata": {"title": "Inferences from a TF Lite model \u2014 Transfer Learning on a Pre-trained Model | by Renu Khandelwal | Towards Data Science", "h1": "Inferences from a TF Lite model \u2014 Transfer Learning on a Pre-trained Model", "description": "In this article, you will learn to use a pre-trained model, apply transfer learning, convert the model to TF Lite, apply optimization, and make inferences from the TFLite model. Freezing all the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@arshren/a-basic-introduction-to-tensorflow-lite-59e480c57292", "anchor_text": "A Basic Introduction to TensorFlow Lite", "paragraph_index": 1}, {"url": "https://github.com/arshren/TFLite/blob/master/Transfer%20Learning%20with%20TFLite-Copy1.ipynb", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://keras.io/api/applications/", "anchor_text": "pre-trained models", "paragraph_index": 7}, {"url": "https://github.com/arshren/TFLite/blob/master/Transfer%20Learning%20with%20TFLite-Copy1.ipynb", "anchor_text": "Github code for TF Lite inferences", "paragraph_index": 33}], "all_paragraphs": ["In this article, you will learn to use a pre-trained model, apply transfer learning, convert the model to TF Lite, apply optimization, and make inferences from the TFLite model.", "A Basic Introduction to TensorFlow Lite", "I have downloaded the dataset and unzipped the file as per the following structure.", "Python code to extract the data and create the data as per the below structure is available here.", "Setting key parameters for the training", "Rescale and Apply different Augmentation to the training image", "Generate batches of normalized data for train and validation data set", "You can use any of the pre-trained models. I have used DenseNet121, which has 427 layers.", "Freezing all the weights of the base pre-trained model and adding a few layers on the top of the pre-trained model", "You can see that the pre-trained model\u2019s weights are non-trainable, and only the added layers weights are trainable.", "You can make a few layers of the pre-trained model weights to be trainable to help learn the custom dataset for better accuracy.", "you can see the number of trainable parameters has increased and this will also increase the training time.", "Compile and train the model on the custom dataset", "After the model is compiled and trained, we can now start converting the model to TF Lite, as shown below.", "Converting the Pre-Trained Transfer Learned model to TF Lite", "After you have trained the Model, you will now need to save the Model.", "The saved Model serializes the architecture of the Model, the weights and the biases, and training configuration in a single file. The saved model can be easily used for sharing or deploying the models.", "A SavedModel contains a complete TensorFlow program, including weights and computation.", "saved_model is a meta graph saved on the export_dir, which is converted to the TFLite Model using lite.TFLiteConverter.", "Writing the flat buffer TFLIte model to a binary file, which is currently 61 MB in size.", "Models at Edge needs to be light-weight and have low latency to run inferences. Lightweight and low latency model is achieved by reducing the amount of computation required to predict, which is achieved by applying Quantized Optimization to the TF Lite model.", "Quantization reduces the precision of the numbers used to represent different parameters of the TensorFlow model to make the model light-weight.", "Quantization is applied to weight and activations.", "Here we have optimized the model for speed and then converted 32-bit floating points to 16-bit floating points to reduce the size of the model.", "TF Lite model which was 61 MB is now reduced to 30MB after applying optimization.", "The optimized model can be deployed to any of the Edge devices where we need tflite_runtime.interpreter", "Loading the Interpreter with the optimized .tflite model containing the model\u2019s execution graph and allocate the tensors", "Get the input and output tensors.", "Input image for which we want to make the inference needs to match the Input data for the model.", "Read the image, decode to a tensor and preprocess the image to the required size, cast to float16 and add the batch dimension", "Below is the image that we are trying to predict", "Point the input data to the 0th array to input tensor by setting the tensor. Run the inference by invoking the Interpreter", "Interpreting output tensor for our Image classification", "Github code for TF Lite inferences", "Use custom or pre-trained or apply transfer learning on a pre-trained model, save the model, convert the model to TFLite flat buffer file, optimize it for either latency or storage and then make inferences using the TF Lite interpreter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A Technology Enthusiast who constantly seeks out new challenges by exploring cutting-edge technologies to make the world a better place!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe16e7c5f0ee6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arshren.medium.com/?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35----e16e7c5f0ee6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe16e7c5f0ee6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe16e7c5f0ee6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@_louisreed?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Louis Reed"}, {"url": "https://towardsdatascience.com/s/photos/raspberry-pi?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@arshren/a-basic-introduction-to-tensorflow-lite-59e480c57292", "anchor_text": "A Basic Introduction to TensorFlow Lite"}, {"url": "https://www.kaggle.com/c/dogs-vs-cats/data", "anchor_text": "Dogs and Cats dataset"}, {"url": "https://github.com/arshren/TFLite/blob/master/Transfer%20Learning%20with%20TFLite-Copy1.ipynb", "anchor_text": "here"}, {"url": "https://keras.io/api/applications/", "anchor_text": "pre-trained models"}, {"url": "https://www.tensorflow.org/lite/convert/index", "anchor_text": "https://www.tensorflow.org/lite/convert/index"}, {"url": "https://github.com/arshren/TFLite/blob/master/Transfer%20Learning%20with%20TFLite-Copy1.ipynb", "anchor_text": "Github code for TF Lite inferences"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e16e7c5f0ee6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e16e7c5f0ee6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----e16e7c5f0ee6---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/tensorflow-lite?source=post_page-----e16e7c5f0ee6---------------tensorflow_lite-----------------", "anchor_text": "Tensorflow Lite"}, {"url": "https://medium.com/tag/edge-computing?source=post_page-----e16e7c5f0ee6---------------edge_computing-----------------", "anchor_text": "Edge Computing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe16e7c5f0ee6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&user=Renu+Khandelwal&userId=31b07253bc35&source=-----e16e7c5f0ee6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe16e7c5f0ee6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&user=Renu+Khandelwal&userId=31b07253bc35&source=-----e16e7c5f0ee6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe16e7c5f0ee6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe16e7c5f0ee6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e16e7c5f0ee6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e16e7c5f0ee6--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://arshren.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb1cb44d62203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finferences-from-a-tf-lite-model-transfer-learning-on-a-pre-trained-model-e16e7c5f0ee6&newsletterV3=31b07253bc35&newsletterV3Id=b1cb44d62203&user=Renu+Khandelwal&userId=31b07253bc35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}