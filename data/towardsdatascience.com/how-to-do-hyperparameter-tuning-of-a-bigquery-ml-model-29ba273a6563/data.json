{"url": "https://towardsdatascience.com/how-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563", "time": 1682996919.1435149, "path": "towardsdatascience.com/how-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563/", "webpage": {"metadata": {"title": "How to do hyperparameter tuning of a BigQuery ML model | by Lak Lakshmanan | Towards Data Science", "h1": "How to do hyperparameter tuning of a BigQuery ML model", "description": "Note: hyperparameter tuning has now been built into BigQuery ML and for simple tuning needs, you can simply specify a hparam_range. Use the approach in this article for more sophisticated\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/google-cloud/hyperparameter-tuning-directly-within-bigquery-ml-a0affb0991ae", "anchor_text": "has now been built into BigQuery ML", "paragraph_index": 0}, {"url": "https://github.com/GoogleCloudPlatform/bigquery-oreilly-book/blob/master/09_bqml/hyperparam.ipynb", "anchor_text": "full code for the example in GitHub", "paragraph_index": 2}, {"url": "https://www.oreilly.com/library/view/google-bigquery-the/9781492044451/", "anchor_text": "book on BigQuery", "paragraph_index": 2}], "all_paragraphs": ["Note: hyperparameter tuning has now been built into BigQuery ML and for simple tuning needs, you can simply specify a hparam_range. Use the approach in this article for more sophisticated hyperparameter tuning.", "When carrying out machine learning, there are many parameters that we choose rather arbitrarily. These include factors such as the learning rate, the level of L2 regularization, the number of layers and nodes in a neural network, the maximum depth of a boosted tree, the number of factors of a matrix factorization model, etc. It is often the case that choosing a different value for these could result in a better model (as measured by the error on a withheld evaluation dataset). Choosing a good value for these parameters is called hyperparameter tuning.", "Here\u2019s the full code for the example in GitHub. It comes from our forthcoming book on BigQuery.", "Take the K-Means clustering model. The evaluation tab in the BigQuery Cloud Console (as well as SELECT * from ML.EVALUATE) shows the Davies-Bouldin index, which is useful for determining the optimal number of clusters supported by the data (the lower the number, the better the clustering).", "For example, here\u2019s a script to try varying the number of clusters:", "It uses dynamic SQL (EXECUTE IMMEDIATE) to create separate model names for each of the num_clusters that is tried.", "Alternately, we could do this using Python and its multithreading capability to limit the number of concurrent queries:", "where the run() method of the Params class invokes the appropriate training and evaluation queries:", "When searching in the range [3,9], we find that the number of clusters at which the error is minimized is 7.", "In both hyperparameter tuning methods considered so far, we tried out every possible value of a parameter that fell within a range. As the number of possible parameters grows, a grid search becomes increasingly wasteful. It is better to use a more efficient search algorithm and that\u2019s where Cloud AI Platform\u2019s hyperparameter tuning can be helpful. The hyperparameter tuning service can be used for any model (not just TensorFlow). Let\u2019s apply to tuning the feature engineering and number of nodes of a DNN model.", "First, we create a configuration file that specifies the ranges for each of the parameters, the number of concurrent queries, and the total number of trials:", "Note that we have specified minimum and maximum values for each of the parameters and the metric (mean absolute error) to be minimized. We are asking for optimization to happen using just 50 trials whereas a grid search would have required trying out 4x4x90x7 or more than 10,000 options! So, using the AI Platform hyperparameter tuning service results in a 200-fold savings!", "Then, we create a Python program that invokes BigQuery to train and evaluate the model given a single set of these parameters:", "Note that the code above uses a specific value for each of the tunable parameters and returns the mean absolute error, which is the metric being minimized.", "This error value is then written out:", "The training program is submitted to the AI Platform Training service:", "The resulting output, shown in the AI Platform console, contains the best parameters.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "articles are personal observations and not investment advice."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F29ba273a6563&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----29ba273a6563--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29ba273a6563--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lakshmanok.medium.com/?source=post_page-----29ba273a6563--------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=post_page-----29ba273a6563--------------------------------", "anchor_text": "Lak Lakshmanan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F247b0630b5d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&user=Lak+Lakshmanan&userId=247b0630b5d6&source=post_page-247b0630b5d6----29ba273a6563---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29ba273a6563&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29ba273a6563&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/google-cloud/hyperparameter-tuning-directly-within-bigquery-ml-a0affb0991ae", "anchor_text": "has now been built into BigQuery ML"}, {"url": "https://github.com/GoogleCloudPlatform/bigquery-oreilly-book/blob/master/09_bqml/hyperparam.ipynb", "anchor_text": "full code for the example in GitHub"}, {"url": "https://www.oreilly.com/library/view/google-bigquery-the/9781492044451/", "anchor_text": "book on BigQuery"}, {"url": "https://cloud.google.com/ml-engine/docs/tensorflow/machine-types", "anchor_text": "https://cloud.google.com/ml-engine/docs/tensorflow/machine-types"}, {"url": "https://medium.com/tag/python?source=post_page-----29ba273a6563---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/bigquery?source=post_page-----29ba273a6563---------------bigquery-----------------", "anchor_text": "Bigquery"}, {"url": "https://medium.com/tag/sql?source=post_page-----29ba273a6563---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----29ba273a6563---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----29ba273a6563---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29ba273a6563&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&user=Lak+Lakshmanan&userId=247b0630b5d6&source=-----29ba273a6563---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F29ba273a6563&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&user=Lak+Lakshmanan&userId=247b0630b5d6&source=-----29ba273a6563---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F29ba273a6563&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----29ba273a6563--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F29ba273a6563&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----29ba273a6563---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----29ba273a6563--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----29ba273a6563--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----29ba273a6563--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----29ba273a6563--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----29ba273a6563--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----29ba273a6563--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----29ba273a6563--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----29ba273a6563--------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lakshmanok.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lak Lakshmanan"}, {"url": "https://lakshmanok.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F247b0630b5d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&user=Lak+Lakshmanan&userId=247b0630b5d6&source=post_page-247b0630b5d6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F44e3f26acd1a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-do-hyperparameter-tuning-of-a-bigquery-ml-model-29ba273a6563&newsletterV3=247b0630b5d6&newsletterV3Id=44e3f26acd1a&user=Lak+Lakshmanan&userId=247b0630b5d6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}