{"url": "https://towardsdatascience.com/https-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a", "time": 1682993560.78312, "path": "towardsdatascience.com/https-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a/", "webpage": {"metadata": {"title": "Deploying Machine Learning has never been so easy | by Sylvain Truong | Towards Data Science", "h1": "Deploying Machine Learning has never been so easy", "description": "Quickly get your sklearn code up and running in the cloud with Google App Engine \ud83d\ude80"}, "outgoing_paragraph_urls": [{"url": "http://scikit-learn.org/stable/", "anchor_text": "sklearn", "paragraph_index": 1}, {"url": "https://developers.google.com/machine-learning/guides/rules-of-ml/", "anchor_text": "Google\u2019s Rules of ML", "paragraph_index": 2}, {"url": "http://scikit-learn.org/stable/datasets/twenty_newsgroups.html", "anchor_text": "20Newsgroups public dataset", "paragraph_index": 9}, {"url": "https://cloud.google.com/ml-engine/docs/scikit/", "anchor_text": "Google Cloud ML provides sklearn", "paragraph_index": 12}, {"url": "https://stackoverflow.com/questions/50086673/can-a-custom-sklearn-model-be-uploaded-to-gcloud-ml-engine/50111742#comment90054000_50111742", "anchor_text": "not yet supported", "paragraph_index": 12}, {"url": "https://cloud.google.com/sdk/", "anchor_text": "install", "paragraph_index": 16}, {"url": "https://console.cloud.google.com/getting-started", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://github.com/syltruong/sklearn-gae-sample", "anchor_text": "Github", "paragraph_index": 18}, {"url": "http://gunicorn.org/", "anchor_text": "Gunicorn", "paragraph_index": 21}, {"url": "https://unsplash.com/@fo0x?utm_source=medium&utm_medium=referral", "anchor_text": "Artem Pochepetsky", "paragraph_index": 27}, {"url": "https://unsplash.com/@anniespratt?utm_source=medium&utm_medium=referral", "anchor_text": "Annie Spratt", "paragraph_index": 27}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash", "paragraph_index": 27}], "all_paragraphs": ["For data science practitioners, going from a Proof Of Concept to a live working product for the first time can seem daunting. Luckily, ever-growing cloud services are here to help. Making the first step towards deployment is not as hard as it used to be.", "In this post, I will demonstrate how this can be done easily thanks to Google App Engine, with an example based on the sklearn framework.", "When it comes to building Machine Learning apps for a company\u2019s needs, there are certain best practices that engineers may be keen to follow. I personally take my inspiration from Google\u2019s Rules of ML, in particular:", "Rule #4: Keep the model simple and the architecture right", "Coming from a research-oriented academic background, I admit this is a rule I could have easily overlooked. Unlike in a research environment, working in a company confronts Machine Learning engineers to other kinds of stakeholders, mainly:", "The massive growth of Infrastructure as a Service (IaaS) and Platform as a Service (PaaS) providers makes it easier for Machine Learning engineers to deploy live products and ensure estimator pipeline reliability.", "Among the cloud tools you can leverage to deploy models, these are worth mentioning:", "In this post, I am showing how to deploy and serve a simple Machine Learning model, leveraging cloud services.", "I will focus on PaaS Google App Engine, which is a fully-managed versatile tool, allowing engineers to build almost any kind of application. App Engine comes with standard runtimes in most of the popular languages (Java, PHP, Node.js, Python, C#,\u00a0.Net, Ruby, Go). It also supports Docker container deployment for custom runtimes.", "It is about deploying a text classifier based on the 20Newsgroups public dataset available in Python package sklearn.", "This dataset consists of forum text messages, sampled from 20 forums/topics. The topics are equally represented, with each forum message being assigned to exactly one topic.", "The text classifier is designed to a take a list of strings as an input and return, for each string, the top-3 most likely forum topics, along with confidence scores.", "Although Google Cloud ML provides sklearn, it only supports pure sklearn models. Wrapped sklearn models are not yet supported.", "We will therefore use multi-purpose tool App Engine to train a wrapped text classifier, dump its binary representation in Google Cloud Storage, load it from there and deliver predictions.", "We will use Python, the Google Cloud Python SDK, Flask/Gunicorn for app deployment and sklearn for model specification.", "This is an overview of the cloud infrastructure we will build.", "To be able to deploy applications on GCP, you first need to setup a project*. In particular, you would have to install the Google Cloud SDK which allows you to interact with GCP services from the command line.", "*At the time this article was written, Google provided 12-month trials with $300 credits. More information here.", "The full repository is available on Github. It is organised as follows:", "core.py defines a wrapper class for a (Text Vectoriser, Classifier) Pipeline. Its fit method fetches the 20Newsgroups dataset and fits a 20-class classifier on it.", "main.py defines the Flask app. In particular, it features two handlers /fit and /predict as well as an initialisation handler _load_model.", "Desired configuration of the AppEngine service is communicated through the app.yaml file. In particular, you can specify runtime, environment variables, instance resources, as well as anentrypoint. The entrypoint for this project starts a Gunicorn server based on our Flask app.", "Provided you have installed the Google Cloud SDK, you can cd into the project's root directory and call", "If deployment was successful, this is what the return message should look like (note the project name):", "Let\u2019s run some tests shall we? or curl it like Beckham \u26bd\ufe0f", "We use excellent command line tool curl to issue HTTP requests to the endpoint we just deployed.", "We built a simple Python application on top of sklearn and Flask. We used Google App Engine for model deployment and serving, as well as Google Cloud Storage for model binary storing. The example has been kept as generic as possible to be adapted to other use-cases, so there is no excuse for you not to \u2026", "Photo credits: Artem Pochepetsky and Annie Spratt on Unsplash", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "data science @ ServiceNow \u2014 Singapore-based \u2014 Production ML"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbbdb500a39a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@syltruong?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@syltruong?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": "Sylvain Truong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa46494165933&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&user=Sylvain+Truong&userId=a46494165933&source=post_page-a46494165933----bbdb500a39a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbdb500a39a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbdb500a39a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://scikit-learn.org/stable/", "anchor_text": "sklearn"}, {"url": "https://developers.google.com/machine-learning/guides/rules-of-ml/", "anchor_text": "Google\u2019s Rules of ML"}, {"url": "http://scikit-learn.org/stable/datasets/twenty_newsgroups.html", "anchor_text": "20Newsgroups public dataset"}, {"url": "https://cloud.google.com/ml-engine/docs/scikit/", "anchor_text": "Google Cloud ML provides sklearn"}, {"url": "https://stackoverflow.com/questions/50086673/can-a-custom-sklearn-model-be-uploaded-to-gcloud-ml-engine/50111742#comment90054000_50111742", "anchor_text": "not yet supported"}, {"url": "https://cloud.google.com/sdk/", "anchor_text": "install"}, {"url": "https://console.cloud.google.com/getting-started", "anchor_text": "here"}, {"url": "https://github.com/syltruong/sklearn-gae-sample", "anchor_text": "Github"}, {"url": "http://gunicorn.org/", "anchor_text": "Gunicorn"}, {"url": "https://textclassifier-dot-*my-project-name*.appspot.com/fit", "anchor_text": "https://textclassifier-dot-*my-project-name*.appspot.com/fit"}, {"url": "https://unsplash.com/@fo0x?utm_source=medium&utm_medium=referral", "anchor_text": "Artem Pochepetsky"}, {"url": "https://unsplash.com/@anniespratt?utm_source=medium&utm_medium=referral", "anchor_text": "Annie Spratt"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bbdb500a39a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bbdb500a39a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----bbdb500a39a---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/api?source=post_page-----bbdb500a39a---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/python?source=post_page-----bbdb500a39a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbbdb500a39a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&user=Sylvain+Truong&userId=a46494165933&source=-----bbdb500a39a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbbdb500a39a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&user=Sylvain+Truong&userId=a46494165933&source=-----bbdb500a39a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbbdb500a39a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbbdb500a39a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bbdb500a39a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bbdb500a39a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bbdb500a39a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bbdb500a39a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bbdb500a39a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@syltruong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@syltruong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sylvain Truong"}, {"url": "https://medium.com/@syltruong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "390 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa46494165933&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&user=Sylvain+Truong&userId=a46494165933&source=post_page-a46494165933--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb5ca8a3cd78b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-towardsdatascience-com-deploying-machine-learning-has-never-been-so-easy-bbdb500a39a&newsletterV3=a46494165933&newsletterV3Id=b5ca8a3cd78b&user=Sylvain+Truong&userId=a46494165933&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}