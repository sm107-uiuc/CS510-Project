{"url": "https://towardsdatascience.com/learn-bayes-theorem-by-detecting-spam-df092cd68d6a", "time": 1683002610.863014, "path": "towardsdatascience.com/learn-bayes-theorem-by-detecting-spam-df092cd68d6a/", "webpage": {"metadata": {"title": "Learn Bayes Theorem by Detecting SPAM | by GreekDataGuy | Towards Data Science", "h1": "Learn Bayes Theorem by Detecting SPAM", "description": "This tutorial has 2 parts: 1. Deriving Bayes theorem from conditional probability 2. Predicting if an SMS message is a spam P(A|B) = P(A \u2229 B) / P(B) is the probability A occurs, in cases where we\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/conditional-probability-with-a-python-example-fd6f5937cd2", "anchor_text": "conditional probability", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/conditional-probability-with-a-python-example-fd6f5937cd2", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Probability_theory", "anchor_text": "probability theory", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Statistics", "anchor_text": "statistics", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Probability", "anchor_text": "probability", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Event_(probability_theory)", "anchor_text": "event", "paragraph_index": 6}, {"url": "https://www.kaggle.com/uciml/sms-spam-collection-dataset", "anchor_text": "Kaggle", "paragraph_index": 15}, {"url": "http://cs.wellesley.edu/~anderson/writing/naive-bayes.pdf", "anchor_text": "here", "paragraph_index": 27}, {"url": "http://gmail.com", "anchor_text": "gmail.com", "paragraph_index": 30}], "all_paragraphs": ["This tutorial has 2 parts:1. Deriving Bayes theorem from conditional probability2. Predicting if an SMS message is a spam", "I covered conditional probability in more depth here.", "Conditional probability tells us the probability of an event occurring, given another event.", "P(A|B) = P(A \u2229 B) / P(B) is the probability A occurs, in cases where we knowB occurs. It\u2019s calculated as the probability that both A and B occur, divided by the probability that B occurs.", "But what if we wanted to find the reverse, the probability of B, in cases where A occurs?", "Sometimes conditional probability works great for that to. But sometimes it\u2019s easier to use Bayes theorem.", "In probability theory and statistics, Bayes\u2019s theorem (alternatively Bayes\u2019s law or Bayes\u2019s rule) describes the probability of an event, based on prior knowledge of conditions that might be related to the event.", "We start with the formula for conditional probability which can be written either, \u201cA given B\u201d or \u201cB given A\u201d.", "Note that intuitively, P(A\u2229B) and P(B\u2229A) are the same (see below). This means we can use them interchangeably. Keep this in mind for later.", "Multiple both sides by P(B). This will cancel out the P(B) denominator on the right, leaving us with below.", "What we can now see (more easily if we swapped the left and right sides) is that P(A\u2229B)= P(A|B) * P(B) . We\u2019ll plug this back into our 2nd original formula (original below).", "To get this formula (modified below).", "We\u2019ll now use Bayes theorem to try and predict spam in SMS messages.", "Bayesian inference has a long history in spam detection. We\u2019ll get into the basics here with some real data.", "In our case, the probability an SMS is spam, given some word, is equal to the probability of the word, given it is in a spam SMS, multiplied by the probability of spam, all divided by the probability of the word.", "Download the dataset from Kaggle, and inspect it in a dataframe.", "The columns in the original CSV don\u2019t make sense. So we\u2019ll move the useful information into 2 new columns, one of which is a boolean indicating if the SMS is spam.", "That\u2019s a lot. Let\u2019s work with a sample of 25% of the original data.", "Now split the data into 2 separate dataframes, one for spam and one for ham.", "We\u2019ll use sklearn\u2019s TFIDF vectorizer to eyeball some words important in the spam messages, and pick one to plug into our formula.", "We need to pick a word to use in our formula so I\u2019m going to choose the word \u201cwin\u201d, though it would be interesting to try this for other words as well.", "Now we need to calculate the different parts of our formula.", "P(W|S) = probability of the word \u201cwin\u201d being in a spam messageP(S) = probability of a spam message overallP(W) = probability of the word \u201cwin\u201d in a message overall", "Boom. What this tells us is that if an SMS contains the word \u201cwin\u201d, there is a 58% probability that the message is spam.", "In a production spam detection system, we would need to do the above calculation for every word in our corpus, then combine the probabilities.", "We may also want to include other features like combinations of words, message length, punctuation, etc.", "That would turn this into a really long post.", "If you\u2019re interested, there is a PDF article here, explaining a couple approaches to combining results of multiple words.", "I hope this gave you some insight and practical experience using Bayes theorem, even if we just scratched the surface.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Just a developer. Contact: greek.data.guy \u201cat\u201d gmail.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf092cd68d6a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://greekdataguy.medium.com/?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": "GreekDataGuy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd67bf018ae6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&user=GreekDataGuy&userId=d67bf018ae6d&source=post_page-d67bf018ae6d----df092cd68d6a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf092cd68d6a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf092cd68d6a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/conditional-probability-with-a-python-example-fd6f5937cd2", "anchor_text": "conditional probability"}, {"url": "https://towardsdatascience.com/conditional-probability-with-a-python-example-fd6f5937cd2", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Bayes%27_theorem", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Probability_theory", "anchor_text": "probability theory"}, {"url": "https://en.wikipedia.org/wiki/Statistics", "anchor_text": "statistics"}, {"url": "https://en.wikipedia.org/wiki/Probability", "anchor_text": "probability"}, {"url": "https://en.wikipedia.org/wiki/Event_(probability_theory)", "anchor_text": "event"}, {"url": "https://www.kaggle.com/uciml/sms-spam-collection-dataset", "anchor_text": "Kaggle"}, {"url": "http://cs.wellesley.edu/~anderson/writing/naive-bayes.pdf", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----df092cd68d6a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----df092cd68d6a---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/python?source=post_page-----df092cd68d6a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----df092cd68d6a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/bayes-theorem?source=post_page-----df092cd68d6a---------------bayes_theorem-----------------", "anchor_text": "Bayes Theorem"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf092cd68d6a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&user=GreekDataGuy&userId=d67bf018ae6d&source=-----df092cd68d6a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf092cd68d6a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&user=GreekDataGuy&userId=d67bf018ae6d&source=-----df092cd68d6a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf092cd68d6a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdf092cd68d6a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----df092cd68d6a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----df092cd68d6a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df092cd68d6a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----df092cd68d6a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----df092cd68d6a--------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "GreekDataGuy"}, {"url": "https://greekdataguy.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.97K Followers"}, {"url": "http://gmail.com", "anchor_text": "gmail.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd67bf018ae6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&user=GreekDataGuy&userId=d67bf018ae6d&source=post_page-d67bf018ae6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F26b33036e2a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flearn-bayes-theorem-by-detecting-spam-df092cd68d6a&newsletterV3=d67bf018ae6d&newsletterV3Id=26b33036e2a7&user=GreekDataGuy&userId=d67bf018ae6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}