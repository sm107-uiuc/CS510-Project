{"url": "https://towardsdatascience.com/finding-donors-classification-project-with-pyspark-485fb3c94e5e", "time": 1682996742.2727208, "path": "towardsdatascience.com/finding-donors-classification-project-with-pyspark-485fb3c94e5e/", "webpage": {"metadata": {"title": "Finding Donors: Classification Project With PySpark | by Victor Roman | Towards Data Science", "h1": "Finding Donors: Classification Project With PySpark", "description": "The aim of this article is to make a gentle introduction to Classification problems in Machine Learning and go through a comprehensive guide to develop succesfully a class prediction using PySpark\u2026"}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/Census+Income", "anchor_text": "UCI Machine Learning Repository", "paragraph_index": 33}, {"url": "https://medium.com/@rromanss23", "anchor_text": "here", "paragraph_index": 57}], "all_paragraphs": ["The aim of this article is to make a gentle introduction to Classification problems in Machine Learning and go through a comprehensive guide to develop succesfully a class prediction using PySpark.", "So without further a do, let\u2019s jump into it!", "If you want to a deep explanation about Classification problems, its main algorithms and how to deal with them using machine learning techniques, I strongly suggest you to chek out the following article, where I explain this concepts throughfully.", "Classification is a subcategory of supervised learning where the goal is to predict the categorical class labels (discrete, unoredered values, group membership) of new instances based on past observations.", "There are two main types of classification problems:", "The following example is very representative to explain binary classification:", "There are 2 classes, circles and crosses, and 2 features, X1 and X2. The model is able to find the relationship between the features of each data point and its class, and to set a boundary line between them, so when provided with new data, it can estimate the class where it belongs, given its features.", "In this case, the new data point falls into the circle subspace and, therefore, the model will predict its class to be a circle.", "In order to predict the class of certain samples, there are several classification algorithms that can be used. In fact, when developing our machine learning models, we will train and evaluate a certain number of them, and we will keep those with better predicting performance.", "A non-exhaustive list of some of the most used algorithms are:", "When making predictions on events we can get four type of results:", "All of these are represented in the following classification matrix:", "Accuracy measures how often the classifier makes the correct prediction. It\u2019s the ratio of the number of correct predictions to the total number of predictions (the number of test data points).", "Precision tells us what proportion of events we classified as a certain class, actually were that class. It is a ratio of true positives to all positives.", "Recall (sensitivity) tells us what proportion of events that actually were the of a certain class were classified by us as that class. It is a ratio of true positives to all the positives.", "Specifity is the proportion of classes that were correctly identified as negative upon the total of negative classes.", "For classification problems that are skewed in their classification distributions , accuracy by itself is not an appropiate metric. Instead, precision and recall are much more representative.", "These two metrics can be combined to get the F1 score, which is weighted average(harmonic mean) of the precision and recall scores. This score can range from 0 to 1, with 1 being the best possible F1 score(we take the harmonic mean as we are dealing with ratios).", "Finally, the metric that we will use in our project is the Reciever Operation Characteristic or ROC.", "The ROC curve tells us about how good the model can distinguish between two classes. It can get values from 0 to 1 ( \u20ac[0,1] ). The better the model is, the closer to 1 value it will be.", "As can be seen in the image of above, our classification model will draw a separation boundary between the classes and:", "And the distribution of predictions will be the following:", "Trade off Between Sensitivity & Specifity", "When we decrease the threshold, we end up predicting more positive values and increasing sensitivity. Therefore, specifity decreases.", "When we increase the threshold, we end up predicting more negative values and increasing specifity. Therefore, decreasing sensitivity.", "In order to optimize the classification performance,we consider (1- specifity) instead specificity. So, when sensitivity increases, (1-specificity) will also increase. And that is how we calculate the ROC.", "As stated before, the closer to 1 gets the evaluator, the better predictive performance the model will be, and the smaller the overlapping area between classes will be.", "A complete walkthrough of the project can be found in the following article:", "In the present article we will focus on the PySpark implementation of the project.", "As a summary, throughout the project, we will use a number of different supervised algorithms to precisely predict individuals\u2019 income using data collected from the 1994 U.S. Census.", "We will then choose the best candidate algorithm from preliminary results and further optimize this algorithm to best model the data.", "Our goal with this implementation is to build a model that accurately predicts whether an individual makes more than $50,000. As from our previous research we have found out that the individuals who are most likely to donate money to a charity are the ones that make more than $50,000.", "Therefore, we are facing a binary classification problem, where we want to determine wether an individual makes more than $50K a year (class 1) or do not (class 0).", "The dataset for this project originates from the UCI Machine Learning Repository.", "The census dataset consists of approximately 45222 data points, with each datapoint having 13 features.", "We will start by importing the dataset and displaying the firsts rows of the data to make a first approximation to an exploratory data analysis.", "We will now display a summary of the dataset\u2019s information by using the .describe() method.", "Let\u2019s also find out the dataset\u2019s schema.", "As we want to predict wether or not the individual is earning more of $50K per year, we will substitute the label \u2018income\u2019 to \u2018>50K\u2019.", "To do so, we will create a new column which values will be 1 or 0 depending if the individual makes or not more than $50K per year. We will then drop this income column.", "In order to be processed for the training of the models, features in Apache Spark must be transformed into vectors. This process will be done using certain classes that we will explore now.", "First, we will import relevant libraries and methods.", "Now, we will select the categorical features.", "In order to One-Hot encode this categorical features we will first pass them through an indexer and then to an encoder.", "Now, we will join the categorical encoded features with the numerical ones and make a vector with both of them.", "Now, we will set up a pipeline to automatize this stages.", "Finally, we will select a dataset only with the relevant features.", "For this project, we will study the predictive performance of three different classification algorithms:", "We will perform a classic 80/20 split between training and testing data.", "As stated before, our evaluator will be the ROC. We will initialize its class and pass it the predicitons in order to obtain the value.", "The best predictor is the Gradient Boosting Tree. Actually 0.911 is a pretty good value and when display its predictions we will see the following:", "We will try to do this by performing the grid search cross validation technique. With it, we will evaluate the performance of the model with different combinations of previously sets of hyperparameter\u2019s values.", "The hyperparameters that we will tune are:", "We have obtained a tiny improvement in the predictive performance. And the computation time, went almost to the 20 minutes. So, in these cases we should analyze if the improvement is worth the effort.", "Throughout this article we made a machine learning classification project from end-to-end. We also learned and obtained several insights about classification models and the keys to develop one with a good performance, using PySpark, its methods and implementations.", "We also have learned how to tune our algorithms once one good-performing model has been identified.", "On the next articles we will learn how to develop Regression Models in PySpark. So, if you are interested in the topic I strongly suggest you to stay tuned!", "If you liked this post then you can take a look at my other posts on Data Science and Machine Learning here.", "If you want to learn more about Machine Learning, Data Science and Artificial Intelligence follow me on Medium, and stay tuned for my next posts!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Industrial Engineer and passionate about 4.0 Industry. My goal is to encourage people to learn and explore its technologies and their infinite posibilites."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F485fb3c94e5e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rromanss23.medium.com/?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": ""}, {"url": "https://rromanss23.medium.com/?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": "Victor Roman"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F77fd145c8783&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&user=Victor+Roman&userId=77fd145c8783&source=post_page-77fd145c8783----485fb3c94e5e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F485fb3c94e5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F485fb3c94e5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/Wpnoqo2plFA", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/supervised-learning-basics-of-classification-and-main-algorithms-c16b06806cd3", "anchor_text": "Supervised Learning: Basics of Classification and Main AlgorithmsLearn how machines classifytowardsdatascience.com"}, {"url": "https://towardsdatascience.com/classification-project-finding-donors-853db66fbb8c", "anchor_text": "Machine Learning Classification Project: Finding DonorsFind and predict who will donate to a charity with this classification model!towardsdatascience.com"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Census+Income", "anchor_text": "UCI Machine Learning Repository"}, {"url": "https://medium.com/@rromanss23", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----485fb3c94e5e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----485fb3c94e5e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pyspark?source=post_page-----485fb3c94e5e---------------pyspark-----------------", "anchor_text": "Pyspark"}, {"url": "https://medium.com/tag/classification?source=post_page-----485fb3c94e5e---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F485fb3c94e5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&user=Victor+Roman&userId=77fd145c8783&source=-----485fb3c94e5e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F485fb3c94e5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&user=Victor+Roman&userId=77fd145c8783&source=-----485fb3c94e5e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F485fb3c94e5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F485fb3c94e5e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----485fb3c94e5e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----485fb3c94e5e--------------------------------", "anchor_text": ""}, {"url": "https://rromanss23.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rromanss23.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Victor Roman"}, {"url": "https://rromanss23.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F77fd145c8783&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&user=Victor+Roman&userId=77fd145c8783&source=post_page-77fd145c8783--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7e807bd3a047&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffinding-donors-classification-project-with-pyspark-485fb3c94e5e&newsletterV3=77fd145c8783&newsletterV3Id=7e807bd3a047&user=Victor+Roman&userId=77fd145c8783&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}