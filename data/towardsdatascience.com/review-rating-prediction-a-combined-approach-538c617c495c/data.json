{"url": "https://towardsdatascience.com/review-rating-prediction-a-combined-approach-538c617c495c", "time": 1682994432.598646, "path": "towardsdatascience.com/review-rating-prediction-a-combined-approach-538c617c495c/", "webpage": {"metadata": {"title": "Review Rating Prediction: A Combined Approach | by Yereya Berdugo | Towards Data Science", "h1": "Review Rating Prediction: A Combined Approach", "description": "The rise in E \u2014 commerce, has brought a significant rise in the importance of customer reviews. There are hundreds of review sites online and massive amounts of reviews for every product. Customers\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.reviewtrackers.com/online-reviews-survey/", "anchor_text": "survey", "paragraph_index": 0}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4735905/", "anchor_text": "this article", "paragraph_index": 3}, {"url": "https://github.com/Yereya/Amazon-baby-product-project", "anchor_text": "here", "paragraph_index": 3}, {"url": "http://jmcauley.ucsd.edu/data/amazon/", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://www.reviewtrackers.com/online-reviews-survey/", "anchor_text": "same survey", "paragraph_index": 13}], "all_paragraphs": ["The rise in E \u2014 commerce, has brought a significant rise in the importance of customer reviews. There are hundreds of review sites online and massive amounts of reviews for every product. Customers have changed their way of shopping and according to a recent survey, 70 percent of customers say that they use rating filters to filter out low rated items in their searches.", "The ability to successfully decide whether a review will be helpful to other customers and thus give the product more exposure is vital to companies that support these reviews, companies like Google, Amazon and Yelp!.", "There are two main methods to approach this problem. The first one is based on review text content analysis and uses the principles of natural language process (the NLP method). This method lacks the insights that can be drawn from the relationship between costumers and items. The second one is based on recommender systems, specifically on collaborative filtering, and focuses on the reviewer\u2019s point of view. Use of the user\u2019s similarity matrix and applying neighbors analysis are all part of this method. This method ignores any information from the review text content analysis.", "In an effort to obtain more information and to improve the prediction of the review rating, the researchers in this article proposed a framework combining review text content with previous user\u2019s similarity matrix analysis. They then did some experiments on two movie review datasets to examine the efficiency of their hypothesis. The results that they got showed that their framework indeed improved prediction of the review rating. This article will describe my attempt of following the work done in their research through examples from the Amazon reviews dataset. The notebook documenting this work is available here and I encourage running the code on your computer and report the results.", "The dataset used here was made available by Dr. Julian McAuley from the UCSD. It contains product reviews and metadata from Amazon, including 142.8 million reviews spanning May 1996 \u2014 July 2014. The product reviews dataset contains user ID, product ID, rating, helpfulness votes, and review text for each review. The data can be found here.", "In this work my goal was to check the researchers\u2019 thesis. It was not to find the best model for the problem. I will try to prove that combining formerly known data about each user\u2019s similarity to other users, with the sentiment analysis of the review text itself, will help us improve the model prediction of what rating the user\u2019s review will get.", "As a first step, I will perform the RRP based on RTC analysis. The next step will be to apply a neighbors analysis to perform RRP based on the similarity between users. The final step will be to compare the three methods (RRP based on RTC, RRP based on neighbors analysis and the combination of the two) and to check the hypothesis.", "Preprocessing is a key step in any analysis and in this project as well. The head of the primary table is as follows:", "First, I deleted rows with no review text, duplicate lines and extra columns that I will not be used.The second step was to create a column that contains the results from the division of helpful numerator and helpful denominator and then to segment these values into bins. It looked like this:", "The last step was to create a text processor that extracted the meaningful words from the messy review text.", "After being applied this had -1. Removed punctuation2. Converted to lowercase3. Removed Stop words (non-relevant words in the context of training the model)", "The head of the primary table, after all the preprocessing, looks like this:", "The figures below shows how the users helpfulness range is distributed over the product rating:", "One can easily see the bias towards the higher ratings. This phenomenon is well known, and it is also supported in the same survey from above. According to that survey:", "\u201cReviews are increasingly shifting from being a place where consumers air their grievances to being a place to recommend items after a positive experience\u201d.", "Later on, I will explain how the problem of the skewed data was solved (resampling methods).", "In order to check and choose the best model, I constructed a pipeline that did the following steps. The pipeline will first perform a TF-IDF term weighting and vectorizing and will then run the classification algorithm. In general, TF-IDF will process the text using my \u201ctext_process\u201d function from above, and then convert the processed text to a count vector. Afterwards, it will apply a calculation that will assign a higher weight to words of more importance.", "Note that I chose ngram_range = (1, 2) and that the algorithm was Multinomial Na\u00efve Bayes. Those decisions were taken according to the results of a cross-validation test. The cross-validation test that I did is beyond the scope of this article, but you can find it in the notebook. The models checked were:  1. Multinomial logistic regression, as a benchmark 2. Multinomial Na\u00efve Bayes 3. Decision Tree 4. Random forest", "Multinomial Na\u00efve Bayes gave the best accuracy score\u00b9 (0.61) and therefore the predictions made by it were chosen to represent the RRP based on RTC.", "The final part in this step is to export the predictions made by the chosen model to a csv file:", "In this step is the user similarity matrix is constructed and is the basis on which I will calculate the cosine similarity between each user. Some problems occurred when I constructed the matrix using the names of the items but were solved by converting to a unique integers sequence (same as IDENTITY property in SQL).", "Construct the matrix: I used pivot to bring the data to the proper shape and then \u201ccsr_matrix\u201d to convert it to sparse matrix in order to save processing time.", "I used the K-Nearest Neighbors algorithm to produce the neighbors analysis. The KNN model is easy to implement and to interpret. The similarity measure was cosine similarity and the number of the desired neighbors was ten.", "After the training stage I extracted the list of the neighbors and stored it as a NumPy array. That yielded a 2-d array of users and the ten users that are most similar to them.", "The next step was to grab the ten closest neighbors and store them in a dataframe:", "Finally, to calculate the mean score of the reviews that the ten closest reviewers wrote I coded a nested loop that would iterate through each row. The loop would then iterate through every one of the user\u2019s ten neighbors and calculate the mean score that their reviews got.", "As a third step I exported the results from the calculation above and merged them with the predictions from the chosen model. I then had a file that consisted of four columns:  1) The original reviews 2) The scores they got (the ground truth)  3) The predictions from the first step (NLP approach)  4) The predictions from the second step (users similarity approach)The combination of the two methods can be done in many different ways. In this paper I chose the simple arithmetic average, but other methods would work as well.In addition to the four columns above, I now have a fifth column: 5) The arithmetic average of each row in columns 3) and 4)", "The metric used for comparing the models was Root Mean Squared Error (RMSE). It is a very common and good measure for comparing models. In addition, I chose to present the Mean Absolute Error (MAE) because it uses the same scale as the data being measured and therefor can be easily explained. The results\u00b2 are shown below:", "The RMSE for the combined method was lower than the RMSE of each method alone.", "In conclusion, my thesis was proven to be correct. Combining the formerly known data about each user\u2019s similarity to other users with the sentiment analysis of the review text itself, does help improve the model prediction of what rate the user\u2019s review will get", "\u00b9 This paper goal is to compare the methods and to see if the framework offered by the researchers will improve the predictions accuracy. It was not to find the most accurate model for RRP based on RTC.", "\u00b2 Although MAE of 0.66 is not good, the main aim of this work was to check the hypothesis and not necessarily to seek the best RRP model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "On a jurney to connect business insights with supportive data"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F538c617c495c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----538c617c495c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----538c617c495c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@yereya.b?source=post_page-----538c617c495c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yereya.b?source=post_page-----538c617c495c--------------------------------", "anchor_text": "Yereya Berdugo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ab6fc6c2abe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&user=Yereya+Berdugo&userId=4ab6fc6c2abe&source=post_page-4ab6fc6c2abe----538c617c495c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F538c617c495c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F538c617c495c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com", "anchor_text": "pixabay"}, {"url": "https://www.reviewtrackers.com/online-reviews-survey/", "anchor_text": "survey"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4735905/", "anchor_text": "this article"}, {"url": "https://github.com/Yereya/Amazon-baby-product-project", "anchor_text": "here"}, {"url": "http://jmcauley.ucsd.edu/data/amazon/", "anchor_text": "here"}, {"url": "https://pixabay.com", "anchor_text": "pixabay"}, {"url": "https://www.reviewtrackers.com/online-reviews-survey/", "anchor_text": "same survey"}, {"url": "https://unsplash.com/@alandelacruz4?utm_source=medium&utm_medium=referral", "anchor_text": "ALAN DE LA CRUZ"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/data-science?source=post_page-----538c617c495c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----538c617c495c---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/recommender-systems?source=post_page-----538c617c495c---------------recommender_systems-----------------", "anchor_text": "Recommender Systems"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F538c617c495c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&user=Yereya+Berdugo&userId=4ab6fc6c2abe&source=-----538c617c495c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F538c617c495c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&user=Yereya+Berdugo&userId=4ab6fc6c2abe&source=-----538c617c495c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F538c617c495c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----538c617c495c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F538c617c495c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----538c617c495c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----538c617c495c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----538c617c495c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----538c617c495c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----538c617c495c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----538c617c495c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----538c617c495c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----538c617c495c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----538c617c495c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yereya.b?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yereya.b?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yereya Berdugo"}, {"url": "https://medium.com/@yereya.b/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4ab6fc6c2abe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&user=Yereya+Berdugo&userId=4ab6fc6c2abe&source=post_page-4ab6fc6c2abe--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F4ab6fc6c2abe%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Freview-rating-prediction-a-combined-approach-538c617c495c&user=Yereya+Berdugo&userId=4ab6fc6c2abe&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}