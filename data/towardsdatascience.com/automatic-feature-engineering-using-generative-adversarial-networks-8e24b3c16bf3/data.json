{"url": "https://towardsdatascience.com/automatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3", "time": 1682993241.6029649, "path": "towardsdatascience.com/automatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3/", "webpage": {"metadata": {"title": "Automatic feature engineering using Generative Adversarial Networks | by Hamaad Shah | Towards Data Science", "h1": "Automatic feature engineering using Generative Adversarial Networks", "description": "The purpose of deep learning is to learn a representation of high dimensional and noisy data using a sequence of differentiable functions, i.e., geometric transformations, that can perhaps be used\u2026"}, "outgoing_paragraph_urls": [{"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3", "paragraph_index": 2}, {"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3", "paragraph_index": 44}, {"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3", "paragraph_index": 48}, {"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3", "paragraph_index": 52}, {"url": "https://github.com/hamaadshah/gan_keras", "anchor_text": "https://github.com/hamaadshah/gan_keras", "paragraph_index": 53}], "all_paragraphs": ["The purpose of deep learning is to learn a representation of high dimensional and noisy data using a sequence of differentiable functions, i.e., geometric transformations, that can perhaps be used for supervised learning tasks among other tasks. It has had great success in discriminative models while generative models have not fared perhaps quite as well due to the limitations of explicit maximum likelihood estimation (MLE). Adversarial learning as presented in the Generative Adversarial Network (GAN) aims to overcome these problems by using implicit MLE.", "We will use the MNIST computer vision dataset and a synthetic financial transactions dataset for an insurance task for these experiments using GANs. GANs are a remarkably different method of learning compared to explicit MLE. Our purpose will be to show that the representation learnt by a GAN can be used for supervised learning tasks such as image recognition and insurance loss risk prediction. In this manner we avoid the manual process of handcrafted feature engineering by learning a set of features automatically, i.e., representation learning.", "This article can be seen as a follow up to this article: https://goo.gl/TjB2v3", "There are 2 main components to a GAN, the generator and the discriminator, that play an adversarial game against each other. In doing so the generator learns how to create realistic synthetic samples from noise, i.e., the latent space z, while the discriminator learns how to distinguish between a real sample and a synthetic sample.", "The representation learnt by the discriminator can be used for other supervised learning tasks, i.e., automatic feature engineering or representation learning. This can also be viewed through the lens of transfer learning. A GAN can also be used for semi-supervised learning which we will get to in another paper where we will look into using variational autoencoders, ladder networks and adversarial autoencoders for this purpose.", "We will use the MNIST dataset for this purpose where the raw data is a 2 dimensional tensor of pixel intensities per image. The image is our unit of analysis: We will predict the probability of each class for each image. This is a multiclass classification task and we will use the accuracy score to assess model performance on the test fold.", "Some examples of handcrafted feature engineering for the computer vision task perhaps might be using Gabor filters.", "We will use a synthetic dataset where the raw data is a 2 dimensional tensor of historical policy level information per policy-period combination: Per unit this will be a 4 by 3 dimensional tensor, i.e., 4 historical time periods and 3 transactions types. The policy-period combination is our unit of analysis: We will predict the probability of loss for time period 5 in the future \u2014 think of this as a potential renewal of the policy for which we need to predict whether it would make a loss for us or not hence affecting whether we decided to renew the policy and / or adjust the renewal premium to take into account the additional risk. This is a binary class classification task and we will use the AUROC score to assess model performance.", "Some examples of handcrafted feature engineering for the insurance task perhaps might be using column or row averages.", "The synthetic insurance financial transactions dataset was coded in R. All the rest of the work is done in Python.", "Please note the similarities between the raw data for the computer vision task and the raw data for the insurance task. Our main goal here is to learn a good representation of this raw data using automatic feature engineering via GANs.", "We will use the Python machine learning library scikit-learn for data transformation and the classification task. We will code the GANs as scikit-learn transformers such that they can be readily used by scikit-learn pipelines. The GANs will be coded using Keras with the TensorFlow backend. We also use an external GPU, i.e., GTX 1070, on a MacBook Pro.", "Assume that we have a prior belief on where the latent space z lies: p(z). Given a draw from this latent space the generator G, a deep learner, outputs a synthetic sample.", "The discriminator D is another deep learner and it aims to classify if a sample is real or synthetic, i.e., if a sample is from the real data distribution,", "Let us denote the discriminator D as follows.", "Here we assume that the positive examples are from the real data distribution while the negative examples are from the synthetic data distribution.", "A GAN simultaneously trains the discriminator to correctly classify real and synthetic examples while training the generator to create synthetic examples such that the discriminator incorrectly classifies real and synthetic examples. This 2 player minimax game has the following objective function.", "Please note that the above expression is basically the objective function of the discriminator.", "It is clear from how the game has been set up that we are trying to obtain a solution for D such that it maximises V(D, G) while simultaneously we are trying to obtain a solution for G such that it minimizes V(D, G).", "We do not simultaneously train D and G. We train them alternately: Train D and then train G while freezing D. We repeat this for a fixed number of steps.", "If the synthetic samples taken from the generator G are realistic then implicitly we have learnt the synthetic data distribution. In other words, the synthetic data distribution can be seen as a good estimation of the real data distribution. The optimal solution will be as follows.", "To show this let us find the optimal discriminator given a generator G and sample x.", "Let us take a closer look at the discriminator\u2019s objective function for a sample x.", "We have found the optimal discriminator given a generator. Let us focus now on the generator\u2019s objective function which is essentially to minimize the discriminator\u2019s objective function.", "We will note the Kullback\u2013Leibler (KL) divergences in the above objective function for the generator.", "Recall the definition of a lambda divergence.", "If lambda takes the value of 0.5 this is then called the Jensen-Shannon (JS) divergence. This divergence is symmetric and non-negative.", "Keeping this in mind let us take a look again at the objective function of the generator.", "It is clear from the objective function of the generator above that the global minimum value attained is -log(4) which occurs when the following holds.", "When the above holds the Jensen-Shannon divergence between the real data distribution and the synthetic data distribution will be zero. Hence we have shown that the optimal solution is as follows.", "Assuming that the discriminator is allowed to reach its optimum given a generator, then", "can be shown to converge to", "Consider the following objective function which has been previously shown to be convex with respect to", "as we found the global minimum at -log(4).", "Gradient descent is used by the generator to move towards the global minimum given an optimal discriminator. We will show that the gradient of the generator exists given an optimal discriminator, i.e.,", "Note that the following is a supremum of a set of convex functions where the set is indexed by the discriminator:", "Remember that the supremum is the least upper bound.", "Let us recall a few definitions regarding gradients and subgradients. A vector", "is a subgradient of a function", "If f is convex and differentiable then its gradient at a point x is also the subgradient. Most importantly, a subgradient can exist even if f is not differentiable.", "The subgradients of the supremum of a set of convex functions include the subgradient of the function at the point where the supremum is attained. As mentioned earlier, we have already shown that", "is used to make incremental improvements to the objective function of the generator", "given an optimal discriminator D*. Therefore convergence of", "In these experiments we show the ability of the generator to create realistic synthetic examples for the MNIST dataset and the insurance dataset. We use a 2-dimensional latent manifold.", "Finally we show that using the representation learnt by the discriminator we can attain competitive results to using other representation learning methods for the MNIST dataset and the insurance dataset such as a wide variety of autoencoders as shown in this article: https://goo.gl/TjB2v3", "With image data we can perhaps judge qualitatively whether the generated data makes sense. For financial transactions data this is not possible. However let us have a look at an example of a generated transactions lattice. Please note that all financial transactions data has been transformed to lie between 0 and 1.", "If we use the same matplotlib code as applied to the image data to plot the above generated transactions lattice we get the following image. We can see that where we have the maximum value possible for a transaction, i.e., 1, that is colored as black, while where we have the minimum value possible for a transaction, i.e., 0, that is colored as white. Transactions values in between have some gray color.", "Finally let us compare the distributions of actual and generated transactions lattices to see whether generated values are similar to actual values. This is a simple sanity check and it appears that the distributions are fairly similar.", "Another way perhaps is to check if the features learnt by the discriminator are useful for a supervised learning task. This seems to be the case in our insurance data example especially if we compare their performance with autoencoders for the same task here: https://goo.gl/TjB2v3", "The accuracy score for the MNIST classification task with DCGAN: 98.350000%.", "The accuracy score for the MNIST classification task with Deeper CGAN: 99.090000%.", "The AUROC score for the insurance classification task with DCGAN: 92.795883%.", "Compare these results with using autoencoders for representation learning for the same computer vision and insurance tasks here: https://goo.gl/TjB2v3", "The code I\u2019ve written for this article is available on my GitHub here: https://github.com/hamaadshah/gan_keras", "We have shown how to use GANs to learn a good representation of raw data, i.e., 2 dimensional tensors per unit of analysis, that can then perhaps be used for supervised learning tasks in the domain of computer vision and insurance. This moves us away from manual handcrafted feature engineering towards automatic feature engineering, i.e., representation learning. GANs can perhaps be also used for semi-supervised learning which will be the topic of another paper.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Operational Data Team Lead at Trade Nation and guest speaker at the University of Oxford DCE."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8e24b3c16bf3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@littlemarble?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@littlemarble?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": "Hamaad Shah"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd4620e7f535&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&user=Hamaad+Shah&userId=d4620e7f535&source=post_page-d4620e7f535----8e24b3c16bf3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8e24b3c16bf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8e24b3c16bf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3"}, {"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3"}, {"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3"}, {"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3"}, {"url": "https://github.com/hamaadshah/gan_keras", "anchor_text": "https://github.com/hamaadshah/gan_keras"}, {"url": "https://arxiv.org/abs/1511.06434", "anchor_text": "https://arxiv.org/abs/1511.06434"}, {"url": "https://arxiv.org/abs/1406.2661", "anchor_text": "https://arxiv.org/abs/1406.2661"}, {"url": "http://scikit-learn.org/stable/#", "anchor_text": "http://scikit-learn.org/stable/#"}, {"url": "https://towardsdatascience.com/learning-rate-schedules-and-adaptive-learning-rate-methods-for-deep-learning-2c8f433990d1", "anchor_text": "https://towardsdatascience.com/learning-rate-schedules-and-adaptive-learning-rate-methods-for-deep-learning-2c8f433990d1"}, {"url": "https://stackoverflow.com/questions/42177658/how-to-switch-backend-with-keras-from-tensorflow-to-theano", "anchor_text": "https://stackoverflow.com/questions/42177658/how-to-switch-backend-with-keras-from-tensorflow-to-theano"}, {"url": "https://blog.keras.io/building-autoencoders-in-keras.html", "anchor_text": "https://blog.keras.io/building-autoencoders-in-keras.html"}, {"url": "https://keras.io", "anchor_text": "https://keras.io"}, {"url": "https://github.com/fchollet/keras/blob/master/examples/mnist_acgan.py#L24", "anchor_text": "https://github.com/fchollet/keras/blob/master/examples/mnist_acgan.py#L24"}, {"url": "https://en.wikipedia.org/wiki/Kullback", "anchor_text": "https://en.wikipedia.org/wiki/Kullback"}, {"url": "https://goo.gl/TjB2v3", "anchor_text": "https://goo.gl/TjB2v3"}, {"url": "https://see.stanford.edu/materials/lsocoee364b/01-subgradients_notes.pdf", "anchor_text": "https://see.stanford.edu/materials/lsocoee364b/01-subgradients_notes.pdf"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8e24b3c16bf3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----8e24b3c16bf3---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8e24b3c16bf3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/bayesian-machine-learning?source=post_page-----8e24b3c16bf3---------------bayesian_machine_learning-----------------", "anchor_text": "Bayesian Machine Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----8e24b3c16bf3---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8e24b3c16bf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&user=Hamaad+Shah&userId=d4620e7f535&source=-----8e24b3c16bf3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8e24b3c16bf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&user=Hamaad+Shah&userId=d4620e7f535&source=-----8e24b3c16bf3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8e24b3c16bf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8e24b3c16bf3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8e24b3c16bf3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8e24b3c16bf3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@littlemarble?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@littlemarble?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hamaad Shah"}, {"url": "https://medium.com/@littlemarble/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "321 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd4620e7f535&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&user=Hamaad+Shah&userId=d4620e7f535&source=post_page-d4620e7f535--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fd4620e7f535%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautomatic-feature-engineering-using-generative-adversarial-networks-8e24b3c16bf3&user=Hamaad+Shah&userId=d4620e7f535&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}