{"url": "https://towardsdatascience.com/face-unlock-with-2d-data-684b11e5aee1", "time": 1683015139.7327201, "path": "towardsdatascience.com/face-unlock-with-2d-data-684b11e5aee1/", "webpage": {"metadata": {"title": "Face Id with Deep Learning | by Francesco Zuppichini | Towards Data Science | Towards Data Science", "h1": "Face Unlock with 2D Data", "description": "This tutorial shows how to implement face - id (face unlock) with computer vision and deep learning"}, "outgoing_paragraph_urls": [{"url": "https://github.com/FrancescoSaverioZuppichini/Face-Unlock", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://github.com/FrancescoSaverioZuppichini/Face-Unlock/blob/main/face_detection.ipynb", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1604.02878", "anchor_text": "MTCNN", "paragraph_index": 2}, {"url": "https://github.com/timesler/facenet-pytorch", "anchor_text": "repo", "paragraph_index": 4}, {"url": "http://www.robots.ox.ac.uk/~vgg/data/vgg_face2/", "anchor_text": "vgg_face2", "paragraph_index": 11}, {"url": "https://arxiv.org/abs/2006.07733", "anchor_text": "BYOL", "paragraph_index": 27}], "all_paragraphs": ["All the code can be found here. An interactive version of this article can be downloaded from here", "Today we are going to use deep learning to create a face unlock algorithm. To complete our puzzle, we need three main pieces.", "First of all, we need a way to find a face inside an image. We can use an end-end approach called MTCNN (Multi-task Cascaded Convolutional Networks).", "Just a little bit of technical background, it is called Cascaded because it is composed of multiple stages, each stage has its neural network. The following image shows the framework.", "We rely on the MTCNN implementation from facenet-pytorch repo.", "We need images! I have put together a couple of images of myself, Leonardo di Caprio and Matt Demon.", "Following PyTorch best practices, I load up the dataset using ImageFolder. I created the MTCNN instance and pass it to the dataset using the transform parameter.", "My folder structure is the following:", "The MTCNN automatically crops and resizes the input, I use an image_size=160 because the model will utilize was trained with images with that size. I also add 18 pixels of margin, just to be sure we include the whole face.", "Perfect, the dataset returns a tensor. Let\u2019s visualize all the inputs. They have been normalized by the MTCNN image-wise, and the last three images of the last row are selfies of myself :)", "Our data pipeline is ready. To compare faces and find out if two are similar, we need to encode them in a vector space where, if two faces are similar, the two vectors associated with them are also similar (close).", "We can use one model trained on one of the famous face datasets, such as vgg_face2, and use the output of the last layer (latent space) before the classification head as the encoder.", "A model trained on one of these datasets must have learned important features about the inputs. The last layer (just before the fully connected layers) encodes the high-level features. Thus, we can use it to embed our inputs in a vector space where, hopefully, similar images are close to each other.", "In detail, we are going to use a inception resnet trained on the vggface2 dataset. The embeddings space has 512 dimensions.", "Perfect, we had 8 images and we obtained 8 vectors", "To compare our vectors, we can use cosine_similarity to see how much they are close to each other. Cosine similarity will output a value between [-1, 1]. In the naive case, where the two compared vectors are the same, their similarity is 1. So the closest to 1, the similar.", "We can now find all the distances between each pair in our dataset.", "Apparently, I am not very similar to Matt or Leo, but they have something in common!", "We can go further and run PCA on the embeddings and project the images in a 2-D plane", "Take this image with a grain of salt. We are compressing 512 dimensions in 2, so we are losing lots of data.", "Okay, we have a way to find faces, and to see if they are similar to each other, now we can create our face unlock algorithm.", "My idea is to take n images of the allowed person, find the center in the embedding space, select a threshold, and see if the cosine similarity between the center and a new image is less or bigger than it.", "People say I am similar to Rio from Casa de Papel", "The similarity score was higher than the previous image, so I guess it is true!", "Let\u2019s try with a new selfie of myself", "We have seen an attractive way to create a face unlock algorithm using only 2D data (images). It relies on a neural network to encode the cropped faces in a high dimensional vector space where similar faces are close to each other. However, I don\u2019t know how the model was trained and it may be easy to fool it (even if in my experiments the algorithm works well).", "What if the model was trained without data-augmentation? Then, probably, simply flipping of the same person can disrupt the latent representation.", "A more robust training routine would be an unsupervised one (something like BYOL) that relies heavily on data-augmentation.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F684b11e5aee1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@FrancescoZ?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@FrancescoZ?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": "Francesco Zuppichini"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bd9d6f5a0c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&user=Francesco+Zuppichini&userId=1bd9d6f5a0c4&source=post_page-1bd9d6f5a0c4----684b11e5aee1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F684b11e5aee1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F684b11e5aee1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@eterrade?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Eric TERRADE"}, {"url": "https://unsplash.com/s/photos/gioconda?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/FrancescoSaverioZuppichini/Face-Unlock", "anchor_text": "here"}, {"url": "https://github.com/FrancescoSaverioZuppichini/Face-Unlock/blob/main/face_detection.ipynb", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1604.02878", "anchor_text": "MTCNN"}, {"url": "https://arxiv.org/abs/1604.02878", "anchor_text": "https://arxiv.org/abs/1604.02878"}, {"url": "https://github.com/timesler/facenet-pytorch", "anchor_text": "repo"}, {"url": "http://www.robots.ox.ac.uk/~vgg/data/vgg_face2/", "anchor_text": "vgg_face2"}, {"url": "https://www.timesofisrael.com/in-court-nso-group-accuses-facebook-of-lying-disregarding-international-law/", "anchor_text": "https://www.timesofisrael.com/in-court-nso-group-accuses-facebook-of-lying-disregarding-international-law/"}, {"url": "https://en.wikipedia.org/wiki/Elon_Musk#/media/File:Elon_Musk_Royal_Society.jpg", "anchor_text": "https://en.wikipedia.org/wiki/Elon_Musk#/media/File:Elon_Musk_Royal_Society.jpg"}, {"url": "https://falauniversidades.com.br/ator-la-casa-de-papel-elite-afastado-por-depressao-miguel-herran/", "anchor_text": "https://falauniversidades.com.br/ator-la-casa-de-papel-elite-afastado-por-depressao-miguel-herran/"}, {"url": "https://arxiv.org/abs/2006.07733", "anchor_text": "BYOL"}, {"url": "https://gist.github.com/a484f089227c8d76ba015b0d7c9e15d7", "anchor_text": "http://github.com"}, {"url": "https://medium.com/tag/python?source=post_page-----684b11e5aee1---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----684b11e5aee1---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----684b11e5aee1---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----684b11e5aee1---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F684b11e5aee1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&user=Francesco+Zuppichini&userId=1bd9d6f5a0c4&source=-----684b11e5aee1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F684b11e5aee1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&user=Francesco+Zuppichini&userId=1bd9d6f5a0c4&source=-----684b11e5aee1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F684b11e5aee1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F684b11e5aee1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----684b11e5aee1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----684b11e5aee1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----684b11e5aee1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----684b11e5aee1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----684b11e5aee1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@FrancescoZ?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@FrancescoZ?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Francesco Zuppichini"}, {"url": "https://medium.com/@FrancescoZ/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bd9d6f5a0c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&user=Francesco+Zuppichini&userId=1bd9d6f5a0c4&source=post_page-1bd9d6f5a0c4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fcaa89168dd7d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-unlock-with-2d-data-684b11e5aee1&newsletterV3=1bd9d6f5a0c4&newsletterV3Id=caa89168dd7d&user=Francesco+Zuppichini&userId=1bd9d6f5a0c4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}