{"url": "https://towardsdatascience.com/lets-deploy-a-machine-learning-model-be6057f2d304", "time": 1683010003.9209862, "path": "towardsdatascience.com/lets-deploy-a-machine-learning-model-be6057f2d304/", "webpage": {"metadata": {"title": "Let\u2019s Deploy a Machine Learning Model | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "Let\u2019s Deploy a Machine Learning Model", "description": "Data science is too cool to be left in a notebook. We need some way to make models useful for, let\u2019s say, web applications, but how can we do so? Today we\u2019ll train a simple machine learning model and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/betterdatascience/YouTube/tree/master/0002_MLDeploy", "anchor_text": "Source code", "paragraph_index": 1}, {"url": "https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv", "anchor_text": "Iris dataset", "paragraph_index": 10}, {"url": "http://127.0.0.1:5000/.", "anchor_text": "http://127.0.0.1:5000/.", "paragraph_index": 25}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 32}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 34}], "all_paragraphs": ["Data science is too cool to be left in a notebook. We need some way to make models useful for, let\u2019s say, web applications, but how can we do so? Today we\u2019ll train a simple machine learning model and deploy it with Flask, and then make predictions with Python\u2019s requests library.", "If you\u2019re more of a video person, or just want to reinforce your knowledge, feel free to watch our video on the topic. Source code is included:", "Why should I care about deployment? Good question. Let me answer it with another one: what\u2019s the purpose of your model if you\u2019re not going to use it? Or at least make someone else use it? Can\u2019t think of any reason? Good, me neither.", "What is Flask? Flask is a microframework for developing web applications. We won\u2019t use it for that purpose, but we\u2019ll use Flask-RESTful to expose certain functionalities of our model.", "Okay, but what is requests? It\u2019s just another plain simple library that communicates with REST APIs.", "Ugh, what\u2019s a REST API? REST, or Representational State Transfer \u2014 whichever comes more natural to you \u2014 is a set of styles and constraints used for creating web services. Once a Restful API is live, we can make a request to a certain endpoint with certain parameters \u2014 that\u2019s all you should know for now. Doing so executes some backend logic \u2014 making a prediction in our case.", "Here\u2019s the directory structure (feel free to tweak):", "The root directory is called mldeploy, and inside we have two more folders: modeler and models. The first one contains modeler.py file (Python created the other two), and the latter will contain a saved model, once we do the training.", "Finally, app.py will tie all the things together and will use Flask and Flask-RESTful for exposing the predictive part.", "Let\u2019s now make a stupidly simple classifier.", "We\u2019ll use the famous Iris dataset because for this example we couldn\u2019t care less about the machine learning portion of the task. We\u2019re only interested in how a model can be deployed, not built.", "Joblib might be the only unknown here. We can use it to save and load machine learning models, in a nutshell.", "Next, we\u2019ve written a class for model loading, training, saving, and making predictions. There's no data preparation involved, so it all boils down to a couple of lines of code:", "That\u2019s all for the modeler.py. We\u2019ll develop the API itself in the next section.", "We can now approach the deployment part. Let\u2019s open up app.py and perform a couple of imports:", "We\u2019ll also use Joblib here, but this time to load the trained model. On the bottom, we\u2019re importing the previously written Modeler class. Now let\u2019s do some Flask housekeeping:", "Flask-RESTful is structured in a way that each endpoint should be inside of its own class. Inside, we declare functions corresponding to the type of request the end user makes \u2014 most popular being GET and POST.", "POST is used in this example, and once the request is made we\u2019ll fetch the data provided by the user. 4 values are expected: sepal length, sepal width, petal length, and petal width, corresponding to features of our dataset.", "An instance of the Modeler class is then created, and predict() function is called with the mentioned input data. Finally, a JSON representation of the prediction is returned.", "Sounds simple, right? Because it is. Here\u2019s the code:", "Now we need to do a bit more of Flask housekeeping, and that is actually connecting the Predict class to an endpoint \u2014 /predict should do it:", "The final thing code-wise is to make app.py executable:", "Next, we can test if everything works as advertised.", "Let\u2019s run the app.py first. Open the root folder in terminal, and type:", "Or without the \u20183\u2019 if you\u2019re on Windows:", "The API is now running on http://127.0.0.1:5000/. To test if it works properly we\u2019ll use notebooks \u2014 they are a bit more interactive than the code editor.", "From here we can make a POST request to the /predict endpoint with values for sepal length, sepal width, petal length, and petal width. It\u2019s pretty straightforward to do:", "Cool. We can check what\u2019s inside the res variable:", "A status code of 200 means everything went fine, and we\u2019re ready to extract predictions. A call to res.json() does the trick:", "And that\u2019s it! You have to admit \u2014 it was easier than you expected.", "Now you know how to take any machine learning model and deploy it. We did everything on the localhost, sure, but in your production environment, the only major part that would change is the URL.", "The model is now ready to use in the application of some sort, hopefully through a nice GUI. Far better than leaving in the notebooks.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbe6057f2d304&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----be6057f2d304--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be6057f2d304--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----be6057f2d304--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----be6057f2d304--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----be6057f2d304---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6057f2d304&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6057f2d304&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pawel_czerwinski?utm_source=medium&utm_medium=referral", "anchor_text": "Pawe\u0142 Czerwi\u0144ski"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://github.com/betterdatascience/YouTube/tree/master/0002_MLDeploy", "anchor_text": "Source code"}, {"url": "https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv", "anchor_text": "Iris dataset"}, {"url": "http://127.0.0.1:5000/.", "anchor_text": "http://127.0.0.1:5000/."}, {"url": "http://localhost:5000/predict'", "anchor_text": "http://localhost:5000/predict'"}, {"url": "http://127.0.0.1/predict,", "anchor_text": "http://127.0.0.1:5000/predict,"}, {"url": "http://your_url:port/predict.", "anchor_text": "http://your_url:port/predict."}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----be6057f2d304---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----be6057f2d304---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----be6057f2d304---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----be6057f2d304---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/programming?source=post_page-----be6057f2d304---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe6057f2d304&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----be6057f2d304---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe6057f2d304&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----be6057f2d304---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6057f2d304&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be6057f2d304--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbe6057f2d304&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----be6057f2d304---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----be6057f2d304--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----be6057f2d304--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----be6057f2d304--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----be6057f2d304--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----be6057f2d304--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----be6057f2d304--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----be6057f2d304--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----be6057f2d304--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-deploy-a-machine-learning-model-be6057f2d304&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}