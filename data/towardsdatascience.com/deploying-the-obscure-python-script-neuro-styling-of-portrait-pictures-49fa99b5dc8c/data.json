{"url": "https://towardsdatascience.com/deploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c", "time": 1683004398.4153652, "path": "towardsdatascience.com/deploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c/", "webpage": {"metadata": {"title": "Deploying the Obscure Python Script: Neuro-Styling of Portrait Pictures | by Rosaria Silipo | Towards Data Science", "h1": "Deploying the Obscure Python Script: Neuro-Styling of Portrait Pictures", "description": "While surfing on the internet a few months ago, we came across this study[i], promising to train a neural network to alter any image according to your preferred painter\u2019s style. These kinds of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Caravaggio", "anchor_text": "Caravaggio", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Pablo_Picasso", "anchor_text": "Picasso", "paragraph_index": 2}, {"url": "https://keras.io/examples/neural_style_transfer/", "anchor_text": "Python script", "paragraph_index": 3}, {"url": "https://keras.io/applications/#vgg19", "anchor_text": "VGG19", "paragraph_index": 16}, {"url": "http://www.robots.ox.ac.uk/~vgg/research/very_deep/", "anchor_text": "Visual Geometry Group", "paragraph_index": 16}, {"url": "https://www.knime.com/downloads/download-knime", "anchor_text": "installation", "paragraph_index": 17}, {"url": "https://www.knime.com/knime-software/knime-analytics-platform", "anchor_text": "Analytics Platform", "paragraph_index": 17}, {"url": "https://docs.knime.com/latest/python_installation_guide/index.html", "anchor_text": "Installation Guide", "paragraph_index": 17}, {"url": "https://www.knime.com/community/image-processing", "anchor_text": "Image Processing", "paragraph_index": 20}, {"url": "https://www.knime.com/knime-software/knime-webportal", "anchor_text": "WebPortal", "paragraph_index": 21}, {"url": "https://hub.knime.com/", "anchor_text": "Hub", "paragraph_index": 22}, {"url": "https://youtu.be/CRa_SbWgmVk", "anchor_text": "EXAMPLES server", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/Neural_Style_Transfer", "anchor_text": "Neural style transfer", "paragraph_index": 36}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "convolutional neural networks (CNNs)", "paragraph_index": 37}, {"url": "https://keras.io/", "anchor_text": "Keras", "paragraph_index": 39}, {"url": "https://keras.io/examples/neural_style_transfer/", "anchor_text": "Keras Neural Transfer Style Example", "paragraph_index": 40}, {"url": "https://www.youtube.com/playlist?list=PLkDaE6sCZn6Gl29AoE31iwdVwSG-KnDzF", "anchor_text": "Convolutional Neural Networks", "paragraph_index": 42}], "all_paragraphs": ["By Rosaria Silipo and Mykhailo Lisovyi, KNIME", "While surfing on the internet a few months ago, we came across this study[i], promising to train a neural network to alter any image according to your preferred painter\u2019s style. These kinds of studies unleash your imagination (or at least ours).", "What about transforming my current portrait picture to give it a Medusa touch from the famous Caravaggio painting? Wouldn\u2019t that colleague\u2019s portrait look better in a more Picasso-like fashion? Or maybe the Van Gogh starry night as a background for that other dreamy colleague? A touch of Icarus blue for the most adventurous people among us? If you have just a bit of knowledge about art, the nuances that you could give to your own portrait are endless.", "The good news is that the study came with a Python script that can be downloaded and reused.[ii]", "The bad news is that most of us do not have enough knowledge of Python to deploy the solution or adapt it to our image set. Actually, most of us do not even have enough knowledge about the algorithm itself. But it turns out that we don\u2019t need to. We don\u2019t need to know Python, and we don\u2019t need to know the algorithm details to generate neuro-styled images according to a selected painting. All we actually need to do is:", "This really is all the end users need to do. Details about the algorithm are unnecessary as is the full knowledge of the underlying Python script. The end user also should not need to install any additional software and should be able to interact with the application simply, through any web browser.", "Do you know the Medusa painting by Caravaggio? It\u2019s his famous self-portrait. Notice the snakes on Medusa\u2019s head (Fig. 1b). Fig. 1a shows a portrait of Rosaria, one of the authors of this article. What would happen if we restyled Rosaria\u2019s portrait according to Caravaggio\u2019s Medusa (Fig. 1c)?", "To see the result of the neuro-styling, we integrated the Python script \u2014 which neuro-styles the images \u2014 into an application that is web accessible, algorithm agnostic, script unaware, and with a UI fully tailored to the end user\u2019s requests.", "Image Neuro-Styling From a Web Browser", "From a web browser on your computer, tablet or smartphone, the application starts in the most classical way by uploading the image file. Let\u2019s upload the portrait images of both authors, Misha and Rosaria.", "After that, we are asked to select the painting style. Rosaria is a big fan of Caravaggio\u2019s paintings, so she selected \u201cMedusa.\u201d Misha prefers Picasso\u2019s cubism and picked his \u201cPortrait of Dora Maar.\u201d", "At this point, the network starts crunching the numbers: 35 minutes on my own laptop[iii] using just my CPU; 35 seconds on a more powerful machine[iv] with GPU acceleration.", "Now, we land on the application\u2019s final web page. Let\u2019s see the restyling that the network has come up with (Figs. 3\u20134).", "The neuro-styled images are shown below in Figures 3 and 4. Notice that the input images are not deeply altered. They just acquire some of the colors and patterns from the art masterpieces, like Rosaria\u2019s Medusa-style hair or the background wall in Misha\u2019s photo. Just a disclaimer: As interesting as these pictures are, they might not be usable for your passport yet!", "Three easy steps to get from the original image to the same image, styled by a master! No scripting and no tweaking of the underlying algorithm required. All you need to know is where the image file is located and the art style to apply. If you change your mind, you can always go back and change the painting style or the input image.", "To put this application together, we needed just a few features from our tool.", "The task here is to integrate the VGG19 neural network developed by the Visual Geometry Group at the University of Oxford and available in a Python script downloadable from the Keras Documentation pageii to style arbitrary portrait pictures. So, we need a Python integration.", "The integration with Python is available in the core installation[v] of the open source Analytics Platform. You just need to install the Analytics Platform with its core extensions and Python with its Keras package. After both have been installed, you need to point the Analytics Platform to the Python installation via File -> Preferences -> Python page. If you are in doubt about what to do next, follow the instructions in the Python Integration Installation Guide and in the Deep", "After installation, you should see a Python category in the Node Repository panel, covering free scripting, model training, model predictor, plots, and more Python functions (Fig. 5). All Python nodes include a syntax highlighted script editor, two buttons for script testing and debugging, a workspace monitor, and a console to display possible errors.", "Notice that a similar integration is available for R, Java and JavaScript. This whole integration landscape enables you to collaborate and share colleagues\u2019 code and scripts, too.", "The image processing functionalities are available in the Image Processing community extension. After installation, you\u2019ll see the image processing functionalities in the Node Repository, in the category Community Nodes/Image Processing. You can use them to manipulate images, extract features, label, filter noise, manipulate dimensions, and transform the image itself.", "The web component is provided by the WebPortal. All the widget nodes, when encapsulated into components, display their graphical view as an element of a web page. The two web pages shown in Fig. 2 have been built by combining a number of widget nodes into a single component.", "The final workflow implementing the web application described above is shown in Fig. 6 and is available for download from the Hub or in the Analytics Platform from the EXAMPLES serverunder 50_Applications/56_Restyling_Images_using_Deep_Learning.", "The workflow in Fig. 6 starts by reading the input portrait image and the art-style images (component named \u201cUpload input images\u201d). The input image is then resized, normalized and its color channels are reordered. At this point, the Python script \u2014 performing the neuro-styling as described in the Appendix and encapsulated in the component called \u201cStyle transfer in Python\u201d \u2014 takes over and retrains the neural network with the new input image and the selected art-style. The produced image is then denormalized, and the color channels are brought back to the original order. The last node, called \u201cDisplay styled images,\u201d displays the resulting image on the final web page.", "Notice that it was not necessary to alter the Python code. A copy and paste of the original code into the Python node editor with just a few adjustments \u2014 for example, to parameterize the training settings \u2014 was sufficient.", "On an even higher level, the end users, when running the application from their web browser, will not see anything of the underlying Python script, neural network architecture, or even the training parameters. It is the perfect disguise to hide the obscure script and the algorithm\u2019s complexity from the end user.", "Now, the Python script seems to work reasonably well, and most of us who do not know Python might like to use it, too. The Python code in the \u201cStyle Transfer in Python\u201d component worked well for us, but it is hard to recycle for others.", "To improve the reusability of the Python script by other users, we transformed this component into a template and stored it in a central location. Now, new users can just drag and drop the template to generate a linked component inside their workflow.", "Similar templates have been created for the image processing components. You can recognize the linked instances of such templates by the green arrow in the lower left corner of the gray node.", "Deploying the Image Neuro-Styling App in One Click", "The last step is deployment. In other words, how to turn our freshly developed workflow into a productive application accessible from a web browser and work on the current data.", "All we need to do is drag and drop the neuro-styling workflow from the LOCAL workspace in the Analytics Platform to a workspace. The workflow can then be called from any web browser via the WebPortal of the Server. In addition, if any widget nodes have been used, the workflow execution on the WebPortal will result in a sequence of interactive web pages and dashboards.", "Notice that this one-click deployment procedure applies to the deployment of any Python script, making it much easier to use in a productive environment.", "With the excuse of playing around with neuro-styled portraits of Rosaria and Misha and their colleagues, we have shown how easy it is to import, integrate and deploy an obscure Python script \u2014 without needing to know Python.", "We have also shown how to configure the application to let it run from any web browser, where we ask the end user for just the minimum required information and hide all other unnecessary details.", "In order to make the Python script and other parts of the application reusable by others, we have packaged some pieces as templates and inserted them as linked components in many other different applications.", "Neural style transfer is a technique that uses neural networks to extract a painting style from one image and apply it to another. It was first suggested in \u201cA Neural Algorithm of Artistic Style i.\u201d", "The main idea is to make use of the fact that convolutional neural networks (CNNs)[vi] capture different levels of complexity in different layers. First convolutional layers can work as low-level edge detectors, while last convolutional layers can capture objects. As we are interested only in a general object detector, we do not need to train a dedicated network for the purpose of style transfer. Instead, we can use any existing pre-trained multilayer CNN. In this article, we have used the VGG19 neural network developed by the Visual Geometry Group at the University of Oxford and available in a Python script that is downloadable from the Keras Documentation page [ii].", "The styling procedure is defined as an optimization of a custom function. The function has several parts:", "Finally, the optimization of this custom function is performed iteratively using automated differentiation functionalities provided by Keras. The custom function needs to be optimized for every new input image. That means that for every new portrait, we need to run the optimization procedure on the pre-trained CNN again.", "[ii] Keras Neural Transfer Style Example, Keras Documentation page", "[v] Aravindh Mahendran, Andrea Vedaldi, Understanding Deep Image Representations by Inverting Them, [arXiv:1412.0035]", "[vi] Convolutional Neural Networks video series on YouTube, Deeplearning.ai, 2017", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Rosaria has been mining data since her master degree, through her doctorate and job positions after that . She is now a data scientist and KNIME evangelist."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F49fa99b5dc8c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rosaria-silipo.medium.com/?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": ""}, {"url": "https://rosaria-silipo.medium.com/?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": "Rosaria Silipo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb562cc4a1e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=post_page-fb562cc4a1e2----49fa99b5dc8c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F49fa99b5dc8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F49fa99b5dc8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Caravaggio", "anchor_text": "Caravaggio"}, {"url": "https://en.wikipedia.org/wiki/Pablo_Picasso", "anchor_text": "Picasso"}, {"url": "https://keras.io/examples/neural_style_transfer/", "anchor_text": "Python script"}, {"url": "https://keras.io/applications/#vgg19", "anchor_text": "VGG19"}, {"url": "http://www.robots.ox.ac.uk/~vgg/research/very_deep/", "anchor_text": "Visual Geometry Group"}, {"url": "https://www.knime.com/downloads/download-knime", "anchor_text": "installation"}, {"url": "https://www.knime.com/knime-software/knime-analytics-platform", "anchor_text": "Analytics Platform"}, {"url": "https://docs.knime.com/latest/python_installation_guide/index.html", "anchor_text": "Installation Guide"}, {"url": "https://docs.knime.com/2018-12/deep_learning_installation_guide/index.html", "anchor_text": "Installation Guide"}, {"url": "https://www.knime.com/community/image-processing", "anchor_text": "Image Processing"}, {"url": "https://www.knime.com/knime-software/knime-webportal", "anchor_text": "WebPortal"}, {"url": "https://hub.knime.com/", "anchor_text": "Hub"}, {"url": "https://youtu.be/CRa_SbWgmVk", "anchor_text": "EXAMPLES server"}, {"url": "https://en.wikipedia.org/wiki/Neural_Style_Transfer", "anchor_text": "Neural style transfer"}, {"url": "https://en.wikipedia.org/wiki/Convolutional_neural_network", "anchor_text": "convolutional neural networks (CNNs)"}, {"url": "https://keras.io/", "anchor_text": "Keras"}, {"url": "https://keras.io/examples/neural_style_transfer/", "anchor_text": "Keras Neural Transfer Style Example"}, {"url": "https://www.youtube.com/playlist?list=PLkDaE6sCZn6Gl29AoE31iwdVwSG-KnDzF", "anchor_text": "Convolutional Neural Networks"}, {"url": "https://www.dataversity.net/deploying-the-obscure-python-script-neuro-styling-of-portrait-pictures/", "anchor_text": "Dataversity"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F49fa99b5dc8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=-----49fa99b5dc8c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F49fa99b5dc8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=-----49fa99b5dc8c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F49fa99b5dc8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F49fa99b5dc8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----49fa99b5dc8c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----49fa99b5dc8c--------------------------------", "anchor_text": ""}, {"url": "https://rosaria-silipo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rosaria-silipo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rosaria Silipo"}, {"url": "https://rosaria-silipo.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "563 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb562cc4a1e2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=post_page-fb562cc4a1e2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F45bf858fbd52&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploying-the-obscure-python-script-neuro-styling-of-portrait-pictures-49fa99b5dc8c&newsletterV3=fb562cc4a1e2&newsletterV3Id=45bf858fbd52&user=Rosaria+Silipo&userId=fb562cc4a1e2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://www.amazon.com/Codeless-Deep-Learning-KNIME-architectures-ebook/dp/B08KSCSB5G/?", "anchor_text": "Codeless Deep Learning with KNIME: Build, Train, and Deploy Various Deep Neural Network Architectures Using KNIME Analytics Platform2020"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}