{"url": "https://towardsdatascience.com/precision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723", "time": 1683017879.313385, "path": "towardsdatascience.com/precision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723/", "webpage": {"metadata": {"title": "Precision Vs. Recall \u2014 Evaluating Model Performance in Credit Card Fraud Detection | by Mark Bentivegna | Towards Data Science", "h1": "Precision Vs. Recall \u2014 Evaluating Model Performance in Credit Card Fraud Detection", "description": "Real world datasets are rarely balanced with equal representation of each class. Dealing with imbalanced data is a problem that data scientists address very frequently. When evaluating tradeoffs for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/markbentivegna/CreditCardFraudDetection/blob/main/CreditCardFraud.ipynb", "anchor_text": "notebook", "paragraph_index": 0}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "dataset", "paragraph_index": 5}, {"url": "https://github.com/markbentivegna/CreditCardFraudDetection/blob/main/CreditCardFraud.ipynb", "anchor_text": "notebook", "paragraph_index": 8}], "all_paragraphs": ["Real world datasets are rarely balanced with equal representation of each class. Dealing with imbalanced data is a problem that data scientists address very frequently. When evaluating tradeoffs for binary classification one must decide whether the priority is precision or recall. All code can be found in this notebook.", "Precision is the rate of true positives divided by the sum of true positives and false positives, the top row in the figure above. Having a high precision means having a high measure of relevant results returned with limited irrelevant results. Recall, on the other hand, is the number of true positives divided by the sum of true positives and false negatives, the left column in the figure above. A high recall indicates the model is able to successfully identify relevant results without mislabeling them as irrelevant. Depending on use case, one must evaluate whether to prioritize precision or recall.", "For example, when testing patients for COVID-19 it is extremely important to capture as many positive cases as possible to understand the prevalence of the virus within a given area. It is very dangerous to misdiagnose someone as not having the virus when in fact they do because they can spread the disease to others without knowing. In the opposite case, if someone is healthy but diagnosed as having the virus the penalty is they will unnecessarily self-isolate for a few days. False negatives are much more harmful than false positives in this case so we have to prioritize recall.", "On the other hand, when Netflix is recommending content to its users it doesn\u2019t matter if a series the user might like isn\u2019t displayed on the list of suggestions. What is consequential is having a high rate of suggestions that the user has no interest in. The ratio of true positives to true positives and false negatives, or recall, isn\u2019t very important. The recommender network drives value by consistently delivering suggestions the user will enjoy so precision is the priority in this scenario because every suggestion must be a correct prediction to maintain usability.", "Credit card fraud is the unauthorized use of a credit or debit card to make purchases. Credit card companies have an obligation to protect their customers\u2019 finances and they employ fraud detection models to identify unusual financial activity and freeze a user\u2019s credit card if transaction activity is out of the ordinary for a given individual. The penalty for mislabeling a fraud transaction as legitimate is having a user\u2019s money stolen, which the credit card company typically reimburses. On the other hand, the penalty for mislabeling a legitimate transaction as fraud is having the user frozen out of their finances and unable to make payments. There is a very fine tradeoff between these two consequences and we will discuss how to handle this when training a model.", "In this example, I will evaluate the precision-recall tradeoff using a credit card fraud detector. In the dataset included, 99.83% of transactions were authorized by the user but 0.17% are fraud. This dataset is very heavily imbalanced so we must evaluate the merits of prioritizing precision and recall when developing a model. This is a binary classification problem with 0 being authorized and 1 being unauthorized. Having a model that simply predicts 0 for every example will return 99.83% accuracy which is typically excellent for a binary classification predictor but not in this case. Although this na\u00efve model maintains a high classification accuracy it does nothing to solve the problem so we will evaluate precision and recall instead. To address this issue we need to protect user\u2019s finances by trying to flag as many fraud transactions as possible while at the same time not mislabeling too many transactions so users can reliably use their credit cards without the inconvenience of having transactions declined. A quick note about the features used in this dataset, they are heavily masked and scaled so as to not reveal any personal or financial data about the users so the features are not very intuitive.", "One of the key problems we need to evaluate in building our model is sampling. A random split into training and testing data will yield roughly 0.17% of class 1 in the training set. This introduces the problem of undersampling and underfitting the data. This can be addressed by sampling a much more balanced representation of both classes. The more we sample from class 0, the more likely our model is to predict class 0 for unseen data. I use a ratio of 2 to 1, as opposed to 1 to 1, for authorized to fraud transactions to limit the number of false positives we get. As mentioned earlier, false positives are very harmful because they prevent customers from using their credit cards. This 2 to 1 ratio is a great tradeoff because it gives strong representation to fraudulent transactions while at the same time not giving them too much weight. Most solutions to this problem give a more equitable split in training samples but they understate the problem of false positives. Freezing users out of their finances is extremely harmful and needs to be taken into more consideration when developing algorithms to predict credit card fraud.", "For a model, I will use a bagging classifier with AdaBoost as the meta estimator built on a decision tree as the base estimator. A bagging classifier is an ensemble estimator that fits base classifiers on random subsets of the original training data and then \u201cvotes\u201d by predicting the most commonly returned result from each of the base estimators. Our meta estimators are AdaBoost classifiers built on decision trees which fit classifiers on the original dataset and then fit additional copies of the classifier that learn from incorrectly classified instances by adjusting weights to guess them correctly. Using boosting and bagging gives enhanced performance over the base estimator class of decision trees. Essentially, we are training multiple self-correcting classifiers on small, random subsets of the data.", "Each data subset we use when fitting our bagging classifier will consist of 100 and 50 examples respectively for valid and fraud transactions. We then repeat this process 10 times to train our classifier. To see how I did this, please refer to this notebook. Choosing small, unrepresentative subsamples is effective in this case for training a model but we need to understand how this works in the real world. In this case we need our test data sampling to differ significantly from our training data sampling and be representative of the actual use case. Failing to do so limits our ability to understand how our model works in practice. I will use the same 99.8% and 0.2% representation respectively for valid and fraud transactions. Our confusion matrix yields a precision of 0.83 and recall of 0.24. Only 0.58% of legitimate transactions were flagged as fraud and 83% of actual fraud transactions were flagged as such which is excellent in dealing with the problem at hand. We are able to catch a high percentage of fraudulent transactions while at the same time not harming our users with false positives.", "Let\u2019s contrast this method with another, the XGBoost classifier. XGBoost employs the concept of boosting, similar to the previous model, but is optimized for speed and efficiency.", "We train this model on the same subsamples as above and we see very different results. Here, we see a precision of 0.87 meaning we catch nearly 87% of fraud transactions, a slight improvement over our previous model. However, this comes at a very large cost. Out of all authorized transactions, 3.3% are incorrectly flagged as fraud. This means that 1 in 30 transactions will be declined, greatly limiting our users\u2019 abilities to go about their day and access their finances. Does the inconvenience for our customers outweigh the gain of catching a few extra fraudulent transactions before they happen? I don\u2019t think so but this question is subject to debate.", "The precision-recall tradeoff is a very challenging problem data scientists have to solve when working with imbalanced data and some use cases should prioritize precision while others should prioritize recall, there is no universal right or wrong answer. In our use case of fraudulent credit card transactions we give a little more weight to precision than most models do in this case because I think the consequences of false positives are understated.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist with a passion for predictive modeling and big data."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbb24958b2723&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb24958b2723--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb24958b2723--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mark-bentivegna.medium.com/?source=post_page-----bb24958b2723--------------------------------", "anchor_text": ""}, {"url": "https://mark-bentivegna.medium.com/?source=post_page-----bb24958b2723--------------------------------", "anchor_text": "Mark Bentivegna"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5918fb2b620&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&user=Mark+Bentivegna&userId=c5918fb2b620&source=post_page-c5918fb2b620----bb24958b2723---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb24958b2723&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb24958b2723&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/markbentivegna/CreditCardFraudDetection/blob/main/CreditCardFraud.ipynb", "anchor_text": "notebook"}, {"url": "https://www.kaggle.com/mlg-ulb/creditcardfraud", "anchor_text": "dataset"}, {"url": "https://github.com/markbentivegna/CreditCardFraudDetection/blob/main/CreditCardFraud.ipynb", "anchor_text": "notebook"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bb24958b2723---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bb24958b2723---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-science?source=post_page-----bb24958b2723---------------computer_science-----------------", "anchor_text": "Computer Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----bb24958b2723---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/statistics?source=post_page-----bb24958b2723---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb24958b2723&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&user=Mark+Bentivegna&userId=c5918fb2b620&source=-----bb24958b2723---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb24958b2723&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&user=Mark+Bentivegna&userId=c5918fb2b620&source=-----bb24958b2723---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb24958b2723&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb24958b2723--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbb24958b2723&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bb24958b2723---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb24958b2723--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bb24958b2723--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bb24958b2723--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bb24958b2723--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bb24958b2723--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bb24958b2723--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bb24958b2723--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bb24958b2723--------------------------------", "anchor_text": ""}, {"url": "https://mark-bentivegna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mark-bentivegna.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mark Bentivegna"}, {"url": "https://mark-bentivegna.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "31 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5918fb2b620&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&user=Mark+Bentivegna&userId=c5918fb2b620&source=post_page-c5918fb2b620--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5839be65e49d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprecision-vs-recall-evaluating-model-performance-in-credit-card-fraud-detection-bb24958b2723&newsletterV3=c5918fb2b620&newsletterV3Id=5839be65e49d&user=Mark+Bentivegna&userId=c5918fb2b620&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}