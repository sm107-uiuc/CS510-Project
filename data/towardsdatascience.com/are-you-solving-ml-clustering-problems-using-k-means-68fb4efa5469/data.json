{"url": "https://towardsdatascience.com/are-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469", "time": 1683011126.043901, "path": "towardsdatascience.com/are-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469/", "webpage": {"metadata": {"title": "How to find K in K-Means? | by Ankit Goel | Jul, 2020 | Towards Data Science", "h1": "Are you solving ML Clustering problems using K-Means?", "description": "One liner to plot Elbow curve, Silhouette curve, Intercluster distances to get optimal value of number of clusters and learn few Scikit-Learn K-Means model tips."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/u/793eeb87d3ee?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Imad Dabbura", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/k-means-clustering-algorithm-applications-evaluation-methods-and-drawbacks-aa03e644b48a", "anchor_text": "K-means Clustering: Algorithm, Applications, Evaluation Methods, and Drawbacks", "paragraph_index": 1}, {"url": "https://medium.com/u/50e1cd76b649?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Azika Amelia", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/k-means-clustering-from-a-to-z-f6242a314e9a", "anchor_text": "K-Means Clustering: From A to Z", "paragraph_index": 1}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#clustering", "anchor_text": "documentation for clustering", "paragraph_index": 1}, {"url": "https://www.scikit-yb.org/en/latest/", "anchor_text": "Yellowbrick", "paragraph_index": 11}, {"url": "https://www.scikit-yb.org/en/latest/api/cluster/elbow.html", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://www.scikit-yb.org/en/latest/api/cluster/icdm.html#module-yellowbrick.cluster.icdm", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "here", "paragraph_index": 21}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#k-means", "anchor_text": "Scikit-Learn documentation", "paragraph_index": 24}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#clustering-performance-evaluation", "anchor_text": "here", "paragraph_index": 27}, {"url": "https://towardsdatascience.com/are-you-using-pipeline-in-scikit-learn-ac4cd85cb27f", "anchor_text": "here", "paragraph_index": 30}, {"url": "http://www.linkedin.com/in/ankit-goel-9b2b2037", "anchor_text": "www.linkedin.com/in/ankit-goel-9b2b2037", "paragraph_index": 32}], "all_paragraphs": ["K-Means is the most used clustering algorithm in unsupervised Machine Learning problems and it is really useful to find similar data points and to determine the structure of the data. In this article, I assume that you have a basic understanding of K-Means and will focus more on how you can-", "If you are a newbie, there are many great articles on the internet that can help you to understand K-Means. I would recommend going through blogs from Imad Dabbura \u201cK-means Clustering: Algorithm, Applications, Evaluation Methods, and Drawbacks\u201d and Azika Amelia \u201cK-Means Clustering: From A to Z\u201d which covers most of it. You can refer to Scikit-Learn documentation for clustering as well which lay out it pretty nicely.", "Let\u2019s start and see how it can be done.", "To use K-Means, we need to specify the value of K that is the number of clusters we want to group our data into. Most of the time, we are not aware of the number of groups that would be present in our data and it becomes challenging to find the optimal value for K. Thankfully, different ways can help us to find the right value.", "I will go through 4 different ways here.", "To best demonstrate, I will create a dataset using make_blobs API from Scikit-Learn which is used to create multiclass datasets by allocating each class to one or more normally-distributed clusters of points.", "Have a look at the notebook I created which have more details, feel free to download and import it in your environment and play around-", "Here, we created a dataset with 10 centers using make_blobs.", "Although we created 10 random clusters, the plot below shows there is an overlap between some and we will see how Elbow method can tell us the exact number of clusters for which we have maximum gain.", "The elbow method is a heuristic used in determining the number of clusters in a data set. The method consists of plotting the explained variation as a function of the number of clusters, and picking the elbow of the curve as the number of clusters to use.", "The intuition behind the Elbow curve is that the explained variation changes rapidly until the number of groups you have in the data and then it slows down leading to an elbow formation in the graph as shown below. The Elbow point is the number of clusters you should use for your K-Means algorithm.", "Recently I discovered a library named Yellowbrick which can help us to plot the Elbow curve with just 1 line of code. It is a wrapper around Scikit-Learn and hence integrate well with it.", "The above code will generate this nice graph with all details. By default, it uses Distortion Score as a metric that computes the sum of squared distances from each point to its assigned center. You can try other metrics mentioned here as well.", "Some clustering problems might not result in elbow formation and can result in a continuously decreasing graph which makes it difficult to select the value of K. We can use other methods in this case as mentioned in the next sub-section.", "Generally, we don\u2019t have ground truth (label) in clustering problems, evaluation needs to be done using the model itself. The silhouette coefficient calculates the density of the cluster by generating a score for each sample based on the difference between the average intra-cluster distance and the mean nearest-cluster distance for that sample normalized by the maximum value. We can find the optimal value of K by generating plots for different values of K and selecting the one with the best score depending on the cluster\u2019s assignment.", "Below, I plotted Silhouette plots for K = 6, 7, 8, 9 and you can see that we got the highest score for K = 7 as we got using the Elbow method. This also helps us to identify class imbalance as the width of the clusters shows the number of samples in that cluster and if you see the graph for K=9, we have many small clusters.", "I used Yellowbrick to generate the above plot. The code below will generate a single Sillhouette graph for K=7, you can refer my notebook on how you can loop through it to generate multiple plots.", "Although this might not help directly to find the number of clusters. It helps in evaluating the K-Means algorithm as it gives a sense of relative importance of clusters. By default, Yellowbrick uses MDS (multidimensional scaling) as an embedding algorithm to embed into 2-dimensional space. You can read more about it here.", "The above code would generate below plot-", "Another thing we can try is to use other clustering algorithms like Affinity Propagation which doesn\u2019t require you to supply the value of K and make it a part of the learning process. These algorithms might not work for large datasets. So, in some cases, we need to try them on a subset of data and then use the value in K-Means. The Below code predicted 10 clusters that match the number of centers we have used.", "Now, as we evaluated using different methods, the optimal value for K which we got is 7. Let\u2019s apply the K-Means algorithm with K=7 and see how it clusters our data points.", "Scikit-learn provides different configurations for K-Means which we can utilize. You can find the complete list here. I will go through a few of them which can help in improving our model.", "K-Means algorithm depends largely on how you have initialized centroids (center of the clusters). Scikit-Learn provides different values of init which can be used but in general k-means++ stands out from others as it tries to initializes the centroids to be (generally) distant from each other, leading to provably better results.", "K-Means uses Euclidean distance to calculate the distance between points. It is observed that in very high dimensional space, Euclidean distances tend to blow up and don\u2019t work well. So, if you have a large number of features, using dimensionality reduction algorithms like PCA before k-means can overcome this issue and speed up the computation.", "For large datasets, K-Means can take a lot of time to converge. As stated in Scikit-Learn documentation-", "The MiniBatchKMeans is a variant of the KMeans algorithm which uses mini-batches to reduce the computation time, while still attempting to optimise the same objective function. Mini-batches are subsets of the input data, randomly sampled in each training iteration. These mini-batches drastically reduce the amount of computation required to converge to a local solution. In contrast to other algorithms that reduce the convergence time of k-means, mini-batch k-means produces results that are generally only slightly worse than the standard algorithm.", "So, if you have a large dataset, do check out MiniBatchKmeans.", "Most of the people who start Machine Learning knows about metrics like accuracy, precision, and recall. We tend to think that if there is no label then how we can measure the results. Scikit-Learn provides different metrics for clustering like homogeneity, completeness, v-measure, or silhouette coefficient which we discussed here. These metrics can help us to evaluate the model. While some of these follow a semi-supervised learning approach and require you to have target labels for a few data points at least others works without any labels. Do check out all the metrics available in Scikit-Learn for clustering here.", "You must scale the dataset before applying k-means as it can impact the distance calculations.", "Due to the way K-Means works, it is normally suitable for clusters that have even shapes like spherical. If you know you have data that follows uneven shapes then it is better to use other clustering algorithms like DBSCAN that works for uneven clusters.", "K-Means is a powerful and simple algorithm that works for most of the unsupervised Machine Learning problems and provides considerably good results. I hope this article will help you with your clustering problems and would save your time for future clustering project. Also, Are you using Pipeline in Scikit-Learn? If not, do check out my other article here which can help you improve your machine learning workflows.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Recently developed my interest in Data Science and exploring the field to see what all we can achieve. Linkedin- www.linkedin.com/in/ankit-goel-9b2b2037"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F68fb4efa5469&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ankitgoel16?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankitgoel16?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Ankit Goel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76a91f429f35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&user=Ankit+Goel&userId=76a91f429f35&source=post_page-76a91f429f35----68fb4efa5469---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F68fb4efa5469&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F68fb4efa5469&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/u/793eeb87d3ee?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Imad Dabbura"}, {"url": "https://towardsdatascience.com/k-means-clustering-algorithm-applications-evaluation-methods-and-drawbacks-aa03e644b48a", "anchor_text": "K-means Clustering: Algorithm, Applications, Evaluation Methods, and Drawbacks"}, {"url": "https://medium.com/u/50e1cd76b649?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Azika Amelia"}, {"url": "https://towardsdatascience.com/k-means-clustering-from-a-to-z-f6242a314e9a", "anchor_text": "K-Means Clustering: From A to Z"}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#clustering", "anchor_text": "documentation for clustering"}, {"url": "https://github.com/ankitgoel1602/data-science/tree/master/clustering-projects/K-Means%20Example", "anchor_text": "ankitgoel1602/data-scienceThis repository provides an example of how you can apply K-Means and use Yellowbrick to generate Elbow curve\u2026github.com"}, {"url": "https://en.wikipedia.org/wiki/Elbow_method_(clustering)", "anchor_text": "Wikipedia"}, {"url": "https://www.scikit-yb.org/en/latest/", "anchor_text": "Yellowbrick"}, {"url": "https://www.scikit-yb.org/en/latest/api/cluster/elbow.html", "anchor_text": "here"}, {"url": "https://www.scikit-yb.org/en/latest/api/cluster/icdm.html#module-yellowbrick.cluster.icdm", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#k-means", "anchor_text": "Scikit-Learn documentation"}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#clustering-performance-evaluation", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/are-you-using-pipeline-in-scikit-learn-ac4cd85cb27f", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----68fb4efa5469---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----68fb4efa5469---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----68fb4efa5469---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/tag/python?source=post_page-----68fb4efa5469---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-scien?source=post_page-----68fb4efa5469---------------data_scien-----------------", "anchor_text": "Data Scien"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F68fb4efa5469&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&user=Ankit+Goel&userId=76a91f429f35&source=-----68fb4efa5469---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F68fb4efa5469&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&user=Ankit+Goel&userId=76a91f429f35&source=-----68fb4efa5469---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F68fb4efa5469&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F68fb4efa5469&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----68fb4efa5469---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----68fb4efa5469--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----68fb4efa5469--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----68fb4efa5469--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankitgoel16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ankitgoel16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ankit Goel"}, {"url": "https://medium.com/@ankitgoel16/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "130 Followers"}, {"url": "http://www.linkedin.com/in/ankit-goel-9b2b2037", "anchor_text": "www.linkedin.com/in/ankit-goel-9b2b2037"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F76a91f429f35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&user=Ankit+Goel&userId=76a91f429f35&source=post_page-76a91f429f35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff84a21a690ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-you-solving-ml-clustering-problems-using-k-means-68fb4efa5469&newsletterV3=76a91f429f35&newsletterV3Id=f84a21a690ae&user=Ankit+Goel&userId=76a91f429f35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}