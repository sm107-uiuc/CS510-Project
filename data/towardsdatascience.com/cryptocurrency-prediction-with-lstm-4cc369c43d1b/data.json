{"url": "https://towardsdatascience.com/cryptocurrency-prediction-with-lstm-4cc369c43d1b", "time": 1683005869.322986, "path": "towardsdatascience.com/cryptocurrency-prediction-with-lstm-4cc369c43d1b/", "webpage": {"metadata": {"title": "Cryptocurrency Prediction with LSTM | by Soner Y\u0131ld\u0131r\u0131m | Towards Data Science", "h1": "Cryptocurrency Prediction with LSTM", "description": "Although the first redistributed cryptocurrency (bitcoin) was created in 2009, the idea of digital money arised in 1980s. In the recent years, cryptocurrencies have gained tremendeous popularity. As\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/jessevent/all-crypto-currencies", "anchor_text": "cryptocurrency market", "paragraph_index": 1}, {"url": "https://github.com/SonerYldrm/Currency-Prediction-with-RNN", "anchor_text": "here.", "paragraph_index": 30}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/", "paragraph_index": 33}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14", "paragraph_index": 33}], "all_paragraphs": ["Although the first redistributed cryptocurrency (bitcoin) was created in 2009, the idea of digital money arised in 1980s. In the recent years, cryptocurrencies have gained tremendeous popularity. As traditional currencies, the value of cryptocurrencies are changing over time. Using the historical data, I will implement a recurrent neural netwok using LSTM (Long short-term memory) layers to predict the trend of cryptocurrency values in the future.", "There is a huge dataset about cryptocurrency market prices on Kaggle. I will only use a part of it which is historical price data of litecoin.", "As always, we start with importing the libraries:", "After importing the libraries, we can now get the data we need:", "The dataset includes almost 1 million rows. I just need the \u201copen\u201d prince of \u201clitecoin\u201d.", "We now have the historical data of litecoin from April,2013 to November,2018. Let\u2019s take a look at how it changed through time.", "It was in a long time silence following a small peak through the end 2013. Then reached its highest values at the end of 2017. We can make the graph look smoother by applying down-sampling.", "Long short-term memory (LSTM) is a type of recurrent neural network (RNN) and powerful to model sequence data because it maintains an internal state to keep track of the data it has already seen. Common applications of LSTMs include time series analysis and natural language processing.", "LSTM requires the input to be a 3D tensor with shape (batch_size, timesteps, input_dim).", "I will build a model that predicts the value of litecoin at time t using the past 90 values (from t-90 to t-1). Therefore the the number of timesteps is 90. I only use \u201copen\u201d price to make the prediction so the input_dim is 1. The target variable is \u201copen\u201d price of litecoin which can be effected by many other factors. For example, the value of another cryptocurrency may have an effect on litecoin. If we also use a second variable to make the prediction, than the input_dim will be 2.", "I will re-organize the data in a way that a sequence of the values in previous 90 days is used to predict the value at time t. It is also better to normalize the values due to excessive computations done in a neural network.", "The last timestep of the first element is same as the 90th timestep of the original data which is what we planned to do.", "The second element of hist should be just one timestep shifted version of first element. Therefore, the last timestep in the second element should be equal to the first item of the target variable which is the 91st timestep in the original data.", "Hist and target are lists. We need to convert them to numpy arrays and reshape the target variable.", "Let\u2019s check the shapes of hist and target arrays:", "Hist array include 1952 observations each of which includes 90 timesteps (90 days).", "We can now normalize the data which is squeezing all data points in the range 0 to 1 in a way that the maximum value and minimum values will 1 and 0, respectively. Normalizing can be done by applying a simple math equation or just using a function like MinMaxScaler.", "The final step of preprocessing is reshaping the input array to be compatible with LSTM layer.", "Our dataset includes 1951 samples (days). A sample of input consists of the value of litecoin for 90 consecutive days and target variable is the value of litecoin on the following day after the 90-day period.", "I will split the dataset in a way that 1900 samples are used for training and then the model will be used to predict the trend in the following 51 days.", "I will build a model with 3 LSTM layers and 1 dense layer which is the output layer.", "We now need to compile the model. When compiling a model, an optimizer which is used to adjust the weights should be selected. Tensorflow offers many optimizers. Commonly used optimizers in regression tasks are \u201cadam\u201d and \u201crmsprop\u201d. Also, a loss function should be selected. Since this is a regression task, we can select \u201cmean_squared_error\u201d.", "It is time to train the model. We need to specify two hyperparameters here:", "It seems like the model is converged in 30 epochs so there is no need to do additional epochs. The loss is less than 0.002 which I think is pretty good.", "Let\u2019s visualize how loss changes as number of epochs increases.", "It seems like the model has converged after 15 epochs. After that, the loss is bouncing up and down around 0.0018.", "Now it is time to make predictions.", "Our model achieved to determine the trend pretty well. As you may have noticed, the values are much less than the original values because we normalized the values before training the model. We can inverse transform to reflect the real prices but trend will be the same.", "There is always space for improvement. The fuel of a neural network is data so we can build a more robust and accurate model by collecting more data. We can also try to adjust number of nodes in a layer or add additional LSTM layers. We can also try to increase the number of timesteps which was 90 in our model. Another way to improve is to adjust parameters using GridSearchCV.", "Please keep in mind that it is not always good to increase the model accuracy because we may end up having an overfit model.", "You can get the entire jupyter notebook here.", "Thanks for reading. Please let me know if you have any feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Top 10 Writer in AI and Data Science | linkedin.com/in/soneryildirim/ | twitter.com/snr14"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4cc369c43d1b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sonery.medium.com/?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448----4cc369c43d1b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4cc369c43d1b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4cc369c43d1b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@silverhousehd?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Andr\u00e9 Fran\u00e7ois McKenzie"}, {"url": "https://unsplash.com/s/photos/bitcoin?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/jessevent/all-crypto-currencies", "anchor_text": "cryptocurrency market"}, {"url": "https://github.com/SonerYldrm/Currency-Prediction-with-RNN", "anchor_text": "here."}, {"url": "https://medium.com/tag/data-science?source=post_page-----4cc369c43d1b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4cc369c43d1b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4cc369c43d1b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4cc369c43d1b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----4cc369c43d1b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4cc369c43d1b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=-----4cc369c43d1b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4cc369c43d1b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4cc369c43d1b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4cc369c43d1b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4cc369c43d1b--------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sonery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Soner Y\u0131ld\u0131r\u0131m"}, {"url": "https://sonery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "http://linkedin.com/in/soneryildirim/", "anchor_text": "linkedin.com/in/soneryildirim/"}, {"url": "http://twitter.com/snr14", "anchor_text": "twitter.com/snr14"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2cf6b549448&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=post_page-2cf6b549448--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7cdf5377373a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcryptocurrency-prediction-with-lstm-4cc369c43d1b&newsletterV3=2cf6b549448&newsletterV3Id=7cdf5377373a&user=Soner+Y%C4%B1ld%C4%B1r%C4%B1m&userId=2cf6b549448&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}