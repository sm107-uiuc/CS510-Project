{"url": "https://towardsdatascience.com/bayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20", "time": 1683016004.182747, "path": "towardsdatascience.com/bayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20/", "webpage": {"metadata": {"title": "Bayesian A/B Testing with Continuous Variables \u2014 including Python Code | by Frank Hopkins | Towards Data Science", "h1": "Bayesian A/B Testing with Continuous Variables \u2014 including Python Code", "description": "When an experiment on your site has been paused, there is a chance that not all the information needed to either accept or reject your hypotheses has been captured in your MVT platform. If this is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pdfs.semanticscholar.org/dea6/0927efbd1f284b4132eae3461ea7ce0fb62a.pdf", "anchor_text": "Kruschke (2013)", "paragraph_index": 2}, {"url": "https://docs.pymc.io/", "anchor_text": "PYMC3", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Student%27s_t-distribution", "anchor_text": "Student-t distribution.", "paragraph_index": 7}], "all_paragraphs": ["When an experiment on your site has been paused, there is a chance that not all the information needed to either accept or reject your hypotheses has been captured in your MVT platform. If this is the case you will likely have to perform some form of post-hoc significance testing on raw experimentation, user-level data.", "If you are working with a continuous metric \u2014 which are variables that can take on an unlimited range of values between both the lowest and highest points of a given measurement \u2014 the T-test is probably most familiar to you. However, the T-test and more broadly speaking frequentist methods in general, can be flawed in their practical applicability. Firstly, frequentist methods rely on pre-determined power analyses to calculate required sample sizes and subsequently the desired length of time an experiment should run before comparing differences between groups. The problem with this form of inference is it fails to work in a dynamic or ad-hoc setting and if sample size requirements have not been achieved \u2014 you may yield non-significant findings. If you achieve relatively large sample sizes on your site or platform this may not be as much of an issue, but you will still have the trouble of having to translate your findings to stakeholders (and with frequentist statistics, this is problematic at best). Notably, trying to explain confidence intervals and p-values to non-technical personnel can be tricky and the p-value is often (wrongly) interpreted as the probability that the experimental condition \u201cout-performed\u201d the control. Luckily Bayesian equivalents to this form of significance testing provide us with this information, which is incredibly useful in a commercial setting, as this is just the information stakeholders want to know.", "This article will discuss a method described by Kruschke (2013) known as BEST (Bayesian Estimation Supersedes the T-test), which uses pre-determined model parameters in conjunction with our known (posterior) data to generate credible posterior distributions using Markov Chain Monte-Carlo simulations with PYMC3. Whilst I suggest reading Kruschke\u2019s academic paper (linked above) to brush up on the various technicalities and differences between traditional null hypothesis significance testing (NHST) and Bayesian methods (which are nuanced and not \u201cuser-friendly\u201d), this article will focus on how BEST methods can be implemented using a few lines of code in Python. Useful calculations will be presented which generate outputs that are easily translatable in layman to stakeholders.", "Firstly, you\u2019re going to want to import all the necessary packages and modules for analysis:", "For the next bit you will want to import your data (which should be at user level), I have however randomly generated some data in order to highlight both the correct data structure needed for analysis and some of the essential concepts of some of this analysis. I have simulated a page views per browser (pvs_pb) metric for each variant:", "Although it is not generally essential in Bayesian inference to have equally weighted groups, it may be useful to check that traffic has been evenly distributed between control and experimental conditions:", "You can also check the the mean values for our pvs_pb metric, which can be referred to after we have performed out inferential tests:", "You can now use this information about our data as priors in our model to use for simulations. Note that in both this example and methods conducted by Kruschke, data are described by a Student-t distribution. Although this is not always appropriate, utilising a t-distribution can be more informative than a normal distribution, as it describes data as pertaining a tail; which is often the case with continuous metrics extrapolated from web data (that is \u201csuper users\u201d often exist). It is worth pointing out that you may want to tweak the following code if this does not apply to your data.", "To describe a Student-t distribution, you need both mean \u03bc (normal distribution) and standard deviation \u03c3 (uniform distribution) inputs. You will also need to specify the degree of freedom \u03bd, which follows a shifted exponential distribution. The normality of the data is mediated by \u03bd. If \u03bd => 30, then the computed distribution is close to a normal distribution; therefore the value of 1/29 is used as a normality threshold.", "You can now create two separate data-frames for your control and variant, respectively:", "Set the pooled mean and standard deviation and degrees of freedom parameters:", "Fit the model into your data and run the MCMC simulations to calculate a series of posterior distributions:", "You can now visualise the posterior distribution of the group means:", "As you can see no overlap of the posterior distributions exists between both groups. However, we can now plot the posterior distribution for the difference between groups:", "Figure 3 presents us with some useful parameters we can use for analysis. Firstly, we have red lines that represent our highest density intervals (HDI), which encompasses the points with the greatest probability density (that is the samples that are more likely than that outside the parameters passed). Although not to be confused with confidence intervals, this 95% interval can be adjusted to any given range specifided. Secondly, we have our region of practical equivalence (ROPE), which is a pre-determined range of sampled differences between experimental groups. This value will likely be determined by stakeholders and/or analysts beforehand and will be a value we look to exceed. To achieve this we would want the entire ROPE range to fall outside our 95% HDI as this is where the highest probability outcomes exist.", "Finally, we can plot the posterior distribution for the relative difference between experimental conditions:", "As you can see from the code above and Figure 4 we can also determine the probability that the variant beat the control by a certain threshold. It can be determined that there is a ~99.6% probability that the variant is 40% greater than the baseline. This threshold can be changed to whatever is practically important to your stakeholders/wider team, which is both invaluable in a commercial setting and unattainable using frequentist methods.", "It is worth considering that due to the heavy lifting performed by the MCMC simulations, that performing this sort of analysis on larger data-sets than those displayed in this article can be quite computationally taxing. It may therefore to not perform this sort of analysis at regular intervals of your experiment, but to have a time-period in mind for performing the analysis. Furthermore, if you are looking to perform this at regular intervals consider performing the analysis on samples of the data using pandas.", "To conclude, BEST analysis is an extremely useful Bayesian alternative to the T-test and provides some invaluable information and outputs that are not as readily available when performing frequentist analysis. With packages such as PYMC3, generating credible posterior samples is a fairly simple process, providing you are diligent in the selection of both your prior inputs and the distribution used for modeling.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Experimentation Data Scientist, specialising in digital experimentation. Posts ranging from data science to website optimisation and digi-analytics."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F133b74c7bd20&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://frankphopkins.medium.com/?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": ""}, {"url": "https://frankphopkins.medium.com/?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": "Frank Hopkins"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F342a4846c139&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&user=Frank+Hopkins&userId=342a4846c139&source=post_page-342a4846c139----133b74c7bd20---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F133b74c7bd20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F133b74c7bd20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pdfs.semanticscholar.org/dea6/0927efbd1f284b4132eae3461ea7ce0fb62a.pdf", "anchor_text": "Kruschke (2013)"}, {"url": "https://docs.pymc.io/", "anchor_text": "PYMC3"}, {"url": "https://en.wikipedia.org/wiki/Student%27s_t-distribution", "anchor_text": "Student-t distribution."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F133b74c7bd20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&user=Frank+Hopkins&userId=342a4846c139&source=-----133b74c7bd20---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F133b74c7bd20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&user=Frank+Hopkins&userId=342a4846c139&source=-----133b74c7bd20---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F133b74c7bd20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F133b74c7bd20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----133b74c7bd20---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----133b74c7bd20--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----133b74c7bd20--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----133b74c7bd20--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----133b74c7bd20--------------------------------", "anchor_text": ""}, {"url": "https://frankphopkins.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://frankphopkins.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Frank Hopkins"}, {"url": "https://frankphopkins.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "178 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F342a4846c139&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&user=Frank+Hopkins&userId=342a4846c139&source=post_page-342a4846c139--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F890c0dfb5c23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbayesian-a-b-testing-with-continuous-variables-including-python-code-133b74c7bd20&newsletterV3=342a4846c139&newsletterV3Id=890c0dfb5c23&user=Frank+Hopkins&userId=342a4846c139&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}