{"url": "https://towardsdatascience.com/an-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5", "time": 1683014452.901197, "path": "towardsdatascience.com/an-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5/", "webpage": {"metadata": {"title": "Disentangle experimental effects from people variability in R | by Hannah Roos | Towards Data Science", "h1": "Disentangle experimental effects from people variability in R", "description": "As soon as the same individuals \u2014 or things \u2014 get measured more than once, we deal with repeated measures data, a scenario that is very common in data science and experimental research. In these\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cran.r-project.org/web/packages/data.table/data.table.pdf", "anchor_text": "data.table package", "paragraph_index": 3}, {"url": "https://mran.microsoft.com/snapshot/2017-04-22/web/packages/ggpubr/ggpubr.pdf", "anchor_text": "ggpubr package", "paragraph_index": 6}, {"url": "https://mran.microsoft.com/snapshot/2017-07-10/web/packages/Rmisc/Rmisc.pdf", "anchor_text": "Rmisc package", "paragraph_index": 7}, {"url": "http://www.tqmp.org/Content/vol01-1/p042/p042.pdf", "anchor_text": "Cosineau", "paragraph_index": 11}, {"url": "https://cran.r-project.org/web/packages/data.table/index.html", "anchor_text": "data.table", "paragraph_index": 11}, {"url": "http://www.tqmp.org/RegularArticles/vol10-1/p056/p056.pdf", "anchor_text": "O\u2019Brian and Cosineau", "paragraph_index": 18}, {"url": "https://www.researchgate.net/profile/Denis_Cousineau/publication/49619408_Confidence_intervals_in_within-subject_designs_A_simpler_solution_to_Loftus_and_Masson's_method/links/54e4c9300cf22703d5bf6023.pdf", "anchor_text": "Confidence intervals in within-subject designs: A simpler solution to Loftus and Masson\u2019s method", "paragraph_index": 20}, {"url": "https://core.ac.uk/download/pdf/25771913.pdf", "anchor_text": "Representing error bars in within-subject designs in typical software packages", "paragraph_index": 21}], "all_paragraphs": ["As soon as the same individuals \u2014 or things \u2014 get measured more than once, we deal with repeated measures data, a scenario that is very common in data science and experimental research. In these cases, you have the chance to estimate the degree to which individual differences account for variability in the data \u2014 as well as the extent to which the observed data are probably due to an experimental manipulation (which is what most people are interested in!). However, the exploration and presentation of repeated measures data are not as straightforward compared to between-subject designs, thus your within-subject data visualizations are probably more biased than you might think. This step-by-step code-along tutorial will provide you with an easy approach to", "For this purpose, let\u2019s imagine the following experiment: you are interested in the impact of caffeine on atheletic performance and thus are wondering whether coffee makes runners significantly faster compared to only water. Luckily, you have the chance to study 40 participants and measure their individual pace on a 10k run twice: On the first run, some participants drink a double espresso and a bottle of water before the second run \u2014 and vice versa. It is reasonable to assume that individuals metabolize caffeine differently and have varying running abilities by nature.", "To start with, this chunk of code simulates a random tibble of subject data that include the average running pace of each participant after the consumption of coffee vs. the consumption of water. We assume that true running pace after drinking water is about 7 minutes per kilometer with a standard deviation of 2 min/km. Assuming that runners are slightly faster in the coffee drinking condition, we intentionally subtract 0.8 min/km with a little random noise included from each runners\u2019 pace in the water drinking condition.", "As you can see in this example, runners vary greatly in their pace and seem to be a bit slower after drinking water only. However, individual values are more homogeneous within each subject than across different subjects even within the same condition. Even though these are simulated data, this is not uncommon in nature because you can assume that individuals have a \u201ctrue\u201d value (e.g., running pace) that is only partially captured by the observed data which cannot be measured under a situational vaccuum and is thus usually pretty noisy. Now that we have our running data, let\u2019s convert them into a long data format using the data.table package by Dowle et al. (2019) \u2014 it will be crucial for our data visualization later.", "Disclaimer: These are simulated data for illustrative purposes and do not reflect real running data by any means. I have no idea how the average running pace may really look like in such a scenario.", "So how does the data look like for each participant? Do some runners benefit more from coffee than others? Do some runners even show no difference compared to the control condition? Or even more surprisingly\u2014 do some runners not tolerate caffeine and therefore may even run slower? Now that our data is ready for plotting, let\u2019s create a graph to find out by plotting each participant\u2019s running pace by condition.", "Boom! You can see that there seems to be a slight increase in speed for the coffee vs. water condition. Consequently, you can hypothesize that the effect does not go into the opposite direction (e.g. coffee being detrimental to running pace for some individuals), but it seems like some individuals benefit very little from drinking coffee. But can you answer the question to which degree coffee makes runners faster on average? Well \u2014 I can\u2019t by looking at this graph. Therefore, let\u2019s create a plot with the ggpubr package \u2014 it will show individual slopes, but also displays a general trend between both conditions.", "Okay, now it appears that on average, runners need less time to run a kilometer after drinking coffee compared to water. Now that we have a sense for the differences between runners, let\u2019s ignore them and try to plot the general trend only. In publications, you might often see a dotplot displaying errorbars which represent either confidence intervals or the standard error of the mean. This is a graphical representation of the uncertainty around the means. With the Rmisc package created by Ryan Hope, we are going to calculate the 95% confidence interval around the mean and then use the result to include a graphical sense of uncertainty around the the means that is due to the sampling nature of the experiment. Note that in frequentist statistics, a common misconception is that 95% confidence interval errorbars would represent the range of values that contain the true mean with a 95% probability. In contrast, the idea is that if we would repeat this study many times, the CI errorbars would contain the true mean in 95% of the cases (Greenland et al., 2016).", "Okay \u2014 it looks like the errorbars are slightly overlapping which indicates that the effect is not significant (Cumming & Finch, 2005). But we are not done yet.", "Can we really trust this plot? Does this indicate that coffee does not systematically speed up runners\u2019 pace? Not quite. We cannot know by now. What if I told you that a paired-sample t-test revealed a significant difference between the coffee- and water drinking condition (p < .001)? How can that be, given that the plot suggests something different?", "The answer is: we have used techniques to visualize between-subjects data on a repeated measures design. But we are actually not interested in the fact how fast runners are per se and how they differ from each other independently from our experimental manipulation. More specifically, we are interested in the extent each runner\u2019s pace compares to his or her own pace in the other condition. Basically, we have done something similar like using an unpaired t-test for independent samples on a within-subjects study. As we know that this is obviously wrong for statistical inference, we should similarly account for the interindividual variability while plotting the data. In our previous plots we have done just that \u2014 the fact that individuals vary by nature (independently from conditions) was not controlled for. Again, we are interested in comparing each runner to him- or herself, but we have plotted error bars that reflect the difference between the runners.", "Fortunately, there is a pretty easy and straightforward solution to this problem, described by Cosineau (2005). Following this appraoach, we are going to correct for each runners\u2019 baseline pace \u2014 this way we can finally see the difference in pace that is primarily attributed to the coffee- vs. water condition, respectively. Using the fast and powerful data.table syntax, we are going to control for between-subject variability (in this case \u2014 the natural differences in running pace). We simply subtract the subject average pace from each observation and add the grand average pace. This way, we can disentangle the condition-specific part from the subject-specific part of the observed data. This does not mean that our data are not influenced by other systematic effects (e.g., glucose levels, cardiovascular health etc.) or unsystematic effects (e.g., day-to-day performance), but at least we have the chance to get an idea of whether or not coffee is any good for running.", "new value = original value \u2014 individual baseline + overall mean", "Now we are going to use the corrected value (pace-within) to recreate that plot that shows the runners\u2019 pace for each condition by subject.", "Wow! Look at this! Now we have a grasp of the extent to which the benefit of drinking coffee (slope) differs by individual runners. For example, the benefit of drinking coffee compared to water is worst for the individual displayed in orange (according to the relatively flat slope). Although the effect seems to be larger than it actually is (look at the y-axis: the range is pretty small compared to our previous visualization), it appears that some individuals increase in pace after drinking coffee was larger compared to others.", "\u2026And what if we wanted to look at the individual data and the general trends simultaneously?", "Now the boxes showing 75% of the distribution got considerably squeezed \u2014 when we account for individual differences and look at the change in speed attributed to coffee vs. water, the variance previously caused by natural pace differences disappear. Although I would always go for a plot that showcases the distribution of the data, I would not recommend to use such a plot for publication purposes because its interpretation is not really straightforward after between-subject variability was controlled for.", "Finally, if we now plot the general trends of the corrected data, we can see that the error bars do not overlap anymore and became very small, giving us reason to believe that caffeine may have played into the runners\u2019 pace. In our fictive example, maybe coffee consumption should be forbidden in order to ensure fairness between runners and allow for more reasonable comparisons.", "To arrive at this conclusion, we are going to use the summarySEwithin function from the Rmisc-package \u2014 this allows us to calculate errorbars that account for the repeated measures nature of the data as we specify the measure we are interested in (e.g., pace), the variable that specifies the within-subjects condition (e.g., condition), and most importantly the variable that signals that the measurements come from the same participant (e.g., subj). If you are interested in the statistical foundations behind it, make sure to also check out the paper by O\u2019Brian and Cosineau (2014).", "People are different and that\u2019s wonderful. But if we have multiple measures of the same person, we should make us of it in order to explore the phenomenon under study in a more meaningful way.", "[5] D. Cousineau, Confidence intervals in within-subject designs: A simpler solution to Loftus and Masson\u2019s method (2005), Tutorial in Quantitative Methods for Psychology, 1(1), 4\u201345", "[6] F. O\u2019Brien & D. Cousineau, Representing error bars in within-subject designs in typical software packages (2014), The quantitative methods for psychology, 10(1), 56\u201367", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4da065d9bfe5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hannahroos.medium.com/?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": ""}, {"url": "https://hannahroos.medium.com/?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": "Hannah Roos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F45a9e3b70a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&user=Hannah+Roos&userId=45a9e3b70a2&source=post_page-45a9e3b70a2----4da065d9bfe5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4da065d9bfe5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4da065d9bfe5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mzemlickis?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "M\u0101rti\u0146\u0161 Zemlickis"}, {"url": "https://unsplash.com/s/photos/race?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://cran.r-project.org/web/packages/data.table/data.table.pdf", "anchor_text": "data.table package"}, {"url": "https://mran.microsoft.com/snapshot/2017-04-22/web/packages/ggpubr/ggpubr.pdf", "anchor_text": "ggpubr package"}, {"url": "https://mran.microsoft.com/snapshot/2017-07-10/web/packages/Rmisc/Rmisc.pdf", "anchor_text": "Rmisc package"}, {"url": "http://www.tqmp.org/Content/vol01-1/p042/p042.pdf", "anchor_text": "Cosineau"}, {"url": "https://cran.r-project.org/web/packages/data.table/index.html", "anchor_text": "data.table"}, {"url": "http://www.tqmp.org/RegularArticles/vol10-1/p056/p056.pdf", "anchor_text": "O\u2019Brian and Cosineau"}, {"url": "https://cran.r-project.org/web/packages/data.table/data.table.pdf", "anchor_text": "Package \u2018data. table\u2019"}, {"url": "https://mran.microsoft.com/snapshot/2017-04-22/web/packages/ggpubr/ggpubr.pdf", "anchor_text": "Package \u2018ggpubr\u2019"}, {"url": "https://link.springer.com/article/10.1007/s10654-016-0149-3", "anchor_text": "Statistical tests, P values, confidence intervals, and power: a guide to misinterpretations"}, {"url": "https://psycnet.apa.org/record/2005-01817-003", "anchor_text": "Inference by eye \u2014 Confidence intervals and how to read pictures of data"}, {"url": "https://www.researchgate.net/profile/Denis_Cousineau/publication/49619408_Confidence_intervals_in_within-subject_designs_A_simpler_solution_to_Loftus_and_Masson's_method/links/54e4c9300cf22703d5bf6023.pdf", "anchor_text": "Confidence intervals in within-subject designs: A simpler solution to Loftus and Masson\u2019s method"}, {"url": "https://core.ac.uk/download/pdf/25771913.pdf", "anchor_text": "Representing error bars in within-subject designs in typical software packages"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4da065d9bfe5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----4da065d9bfe5---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/confidence-interval?source=post_page-----4da065d9bfe5---------------confidence_interval-----------------", "anchor_text": "Confidence Interval"}, {"url": "https://medium.com/tag/individual-differences?source=post_page-----4da065d9bfe5---------------individual_differences-----------------", "anchor_text": "Individual Differences"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----4da065d9bfe5---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4da065d9bfe5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&user=Hannah+Roos&userId=45a9e3b70a2&source=-----4da065d9bfe5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4da065d9bfe5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&user=Hannah+Roos&userId=45a9e3b70a2&source=-----4da065d9bfe5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4da065d9bfe5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4da065d9bfe5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4da065d9bfe5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4da065d9bfe5--------------------------------", "anchor_text": ""}, {"url": "https://hannahroos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hannahroos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hannah Roos"}, {"url": "https://hannahroos.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "207 Followers"}, {"url": "https://medium.com/@hannahroos/membership", "anchor_text": "https://medium.com/@hannahroos/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F45a9e3b70a2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&user=Hannah+Roos&userId=45a9e3b70a2&source=post_page-45a9e3b70a2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1106a74a6c84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-easy-approach-to-visualize-within-subject-data-meaningfully-4da065d9bfe5&newsletterV3=45a9e3b70a2&newsletterV3Id=1106a74a6c84&user=Hannah+Roos&userId=45a9e3b70a2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}