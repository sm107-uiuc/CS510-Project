{"url": "https://towardsdatascience.com/deploy-ml-models-at-scale-151204549f41", "time": 1682996421.3067992, "path": "towardsdatascience.com/deploy-ml-models-at-scale-151204549f41/", "webpage": {"metadata": {"title": "Deploy ML models at scale. Part 1: API service for ML models | by Prajwal Shreyas | Towards Data Science", "h1": "Deploy ML models at scale", "description": "Let\u2019s assume that you have built a ML model and that you are happy with its performance. Then the next step is to deploy the model into production. In this blog series I will cover how you can deploy\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://www.seelabs.app/face_rec_train'", "anchor_text": "http://0.0.0.0:5005/sentiment", "paragraph_index": 15}], "all_paragraphs": ["Let\u2019s assume that you have built a ML model and that you are happy with its performance. Then the next step is to deploy the model into production. In this blog series I will cover how you can deploy your model for large scale consumption with in a scalable Infrastructure using AWS using docker container service.", "In this blog I will start with the first step of building an API framework for the ML model and running it in you local machine. For the purpose of this blog, let\u2019s consider the Sentiment classification model built here. In order to deploy this model we will follow the below steps:", "In case the model is a built on sklearn, it would be best to save it as a \u2018.pkl\u2019 file. Alternatively if it is a deep learning model then it is recommended to save the model as a \u2018HDF\u2019 file. The main difference between \u2018.pkl\u2019 and \u2018.hdf\u2019 is, pickle requires a large amount of memory to save a data structure to disk, where as HDF is designed to efficiently store large data sets.", "Once you have trained your deep learning model in keras or tensorflow you can save the model architecture and its weights using a .hdf5 file system.", "Step 1: Load the saved model (as per previous section) by one of the following methods depending on the type of file i.e. \u2018hdf5\u2019 or \u2018pkl\u2019.", "Step 2: Import flask and create a flask application object as shown below:", "Step 3: The next step is to build a test API function which returns the \u201cAPI working\u201d string. This can be used to ensure the health of the API when it is deployed in production. Here we use \u2018@app.route\u2019, which is a python decorator ( a decorator is a function that takes another function and extends the behaviour of the latter function without explicitly modifying it)", "Step 4: The next step is to build a \u201cPOST\u201d request api for processing requests to our sentiment model. We are using the path name \u201c/sentiment\u201d. The function reads the json input and converts it into pandas dataframe. It extracts the relevant fields from the json and calls the \u201cget_sentiment_DL\u201d function for processing. \u201cget_sentiment_DL\u201d function contains the trained model which has been loaded via \u2018hdf5\u2019 file. It finally will return back the results of the model in the form of json result.", "Step 5: The detailed model processing steps will be performed by \u201cget_sentiment_DL\u201d function. In the case of our deep learning sentiment model we are passing:", "2. text_data: Input text for sentiment classification", "3. word_idx: Word index from the GloVe file (details of the model here).", "Step 6: Add the below section to run the app. Here Host is set as \u201c0.0.0.0\u201d as we are hosting in our local server. However you can configure it to your network settings. Debug can be set to True at the time of building the API functionality. The Port is set to 5005, however this can be configured as per your requirement.", "To run the API, open a command line window and go to the directory where the code is stored. Run the python script by running the below command (\u201csentiment.py\u201d is the name of the file with the above API implementation).", "On running the above command you will be able to see the below result in your command line window:", "Once the API is running you can test the API by going to your browser and typing \u201c0.0.0.0:5005/apitest\u201d. You will get the below result in you browser.", "You can now pass any data to the API using python as shown below. The address in our case is \u201chttp://0.0.0.0:5005/sentiment\u201d. The results of the model will be returned and stored in \u201cresponse\u201d field.", "In conclusion, we have covered steps to deploy the model into an api service in your local computer.", "The next step is to deploy this in a cloud server as a micro service. In following blog\u2019s I will cover the use of container service such as docker and deploy it in AWS.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist/ ML Engineer \u2014 Experienced in building and deploying large scale ML models to enhance business value."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F151204549f41&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----151204549f41--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----151204549f41--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@prajwalshreyas?source=post_page-----151204549f41--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prajwalshreyas?source=post_page-----151204549f41--------------------------------", "anchor_text": "Prajwal Shreyas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdaf1da2a65fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=post_page-daf1da2a65fa----151204549f41---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F151204549f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F151204549f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.toptal.com/python/python-machine-learning-flask-example", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5", "anchor_text": "here"}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5", "anchor_text": "here"}, {"url": "https://www.seelabs.app/face_rec_train'", "anchor_text": "http://0.0.0.0:5005/sentiment"}, {"url": "https://www.seelabs.app/face_rec_train'", "anchor_text": "http://0.0.0.0:5005/sentiment'"}, {"url": "https://medium.com/tag/python?source=post_page-----151204549f41---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----151204549f41---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/api?source=post_page-----151204549f41---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/flask?source=post_page-----151204549f41---------------flask-----------------", "anchor_text": "Flask"}, {"url": "https://medium.com/tag/docker?source=post_page-----151204549f41---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F151204549f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=-----151204549f41---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F151204549f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=-----151204549f41---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F151204549f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----151204549f41--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F151204549f41&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----151204549f41---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----151204549f41--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----151204549f41--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----151204549f41--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----151204549f41--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----151204549f41--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----151204549f41--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----151204549f41--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----151204549f41--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prajwalshreyas?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prajwalshreyas?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Prajwal Shreyas"}, {"url": "https://medium.com/@prajwalshreyas/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "366 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdaf1da2a65fa&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=post_page-daf1da2a65fa--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F79d4dbc0a15a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeploy-ml-models-at-scale-151204549f41&newsletterV3=daf1da2a65fa&newsletterV3Id=79d4dbc0a15a&user=Prajwal+Shreyas&userId=daf1da2a65fa&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}