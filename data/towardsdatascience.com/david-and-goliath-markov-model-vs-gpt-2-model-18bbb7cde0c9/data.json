{"url": "https://towardsdatascience.com/david-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9", "time": 1683017697.963097, "path": "towardsdatascience.com/david-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9/", "webpage": {"metadata": {"title": "David and Goliath \u2014 Markov Model vs GPT-2 Model | by Monica P. | Towards Data Science", "h1": "David and Goliath \u2014 Markov Model vs GPT-2 Model", "description": "Natural Language Processing (NLP) has had some exciting advancements these last five years, which is credited to technology advancements that have sped up computation which has led to the rise of\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.mturk.com/", "anchor_text": "Amazon Turk", "paragraph_index": 7}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab", "paragraph_index": 12}, {"url": "https://twitter.com/HaikuBotto", "anchor_text": "Haiku poems", "paragraph_index": 13}, {"url": "https://twitter.com/bot_homer", "anchor_text": "Homer Simpson", "paragraph_index": 13}, {"url": "https://colab.research.google.com/drive/1bJ5SFN8QlXDVX8BQNXd4f3ZbWKFC2HC7?usp=sharing", "anchor_text": "here", "paragraph_index": 14}], "all_paragraphs": ["Natural Language Processing (NLP) has had some exciting advancements these last five years, which is credited to technology advancements that have sped up computation which has led to the rise of Deep Learning models in NLP. One of the areas that have advanced in NLP is Natural Language Generation (NLG) which is currently utilized in tasks :", "Early methods of NLG were rule-based involving rules that dictated the outline of the messages and statistical methods to improve paraphrasing, syntax, and semantic similarity. One of the first major advances were in the form of neural networks, and some shallow neural networks that created new ways to represent textual information. It transformed large text into a lower-dimensional space without sacrificing information loss in latent representations available Methods like word2vec, Glove, and Seq2Seq that generate word embeddings in the form of vectors which one can compute distance-based calculations such as Euclidean distance or cosine similarity. Lastly, deep learning models that deploy transformer architecture to help facilitate transfer learning which holds attention mechanisms in their layers have been referred to as the state of the art methods in NLP and NLG [1]. The main difference between the RNNs such as LSTM Networks is the data is passed sequentially versus the Transformer Models utilizes parallel computing and transfers the input sequence in parallel and utilizes encoders and decoders that are then transformed into probabilities with a softmax activation.", "I was curious to compare one of the latest and greatest NLG models, a GPT-2 model versus a much simpler model using Markov principles in creating the next Tweet of a few politicians. I chose to create the next tweet for Joe Biden, Kamala Harris, and Elizabeth Warren. I chose these Twitter accounts because in the last few months they have been tweeting heavily and their tweets are usually on the longer side and are coherent. Utilizing the package Tweepy, I extracted the last 100 tweets as of 12/7/2020 to be utilized as the corpus to feed into the NLG models and to be used as a reference and comparison for NLG evaluations.", "For those who would rather watch a 10-minute video here is the video presentation :", "The Markov model is a stochastic model that depending on the current state which in the case of NLG is the current word-based, then based on the window size or state size it will transition by either randomly or using probabilities to choose the next pair(s) of words to change its state. I used the Markovify package [4] with a window size of 2 meaning it would change states by randomly picking the next word only if it was previously used with the prior word. Since I was dealing with tweets that are under 280 characters, I knew I had to keep the window size smaller because the bigger the number of the state size the harder it would be to find the next common word that is usually used in the sequence of n words. A nice feature I liked in the Markovify package is you could specify the min and max length of the generated text. Seeing how most of their tweets ranged from 100 to 280 characters I decided to input those characteristics as parameters in the Markov model.", "The GPT-2 model from OpenAI [5] was trained on 40-GB worth of text data from 8 million web pages to predict the next word with 1.5 billion parameters. Prior work trained models were trained on a single domain of text for example just news articles but the GPT-2 model was trained on a diverse dataset so it could be a model that could be implemented in a wide range of NLG tasks. The dataset compiled for the GPT-2 was based on outbound links from Reddit after receiving a threshold of a certain engagement. Using GPT-2 release of their smaller model \u2018124M\u2019 which according to Radford et al, is comparable to Bert\u2019s larger models due to a large number of parameters. Unlike the Markovify model, one would need a GPU to leverage the GPT-2 model and to finetune to your own corpus, which was my plan to finetune 3 GPT-2 models one for each reference corpus of the last 100 tweets per politician. One of the reasons I chose to use a GPT-2 model and a Markov model was to compare the NLG tweets between the models and see which model performed better. It would be interesting to see if a simpler model could outperform a GPT-2 model to generate shorter text because from what it looks like from the paper Language Models are Unsupervised Multi Task Learners, the GPT-2 does fairly well with longer outputs of text and there is room for improvement for summarization and question and answering [5].", "This brings me to the evaluation of NLG outputs. There are many different metrics that can measure different things such as grammar, factuality, similarity, coherence, etc. \u00c7elikyilmaz et al, group these NLG evaluation metrics in three categories:", "With the time available for this project I had to choose between Untrained Automatic Evaluation Metrics and/or Machine Learned Evaluation Metrics seeing that Human-Centric Evaluation Methods will be too time-consuming or costly; although, many researchers do leverage Amazon Turk for these Human-Centric Evaluation Methods.", "I chose a Machine Learned Evaluation Metric because it is a blend of the first two categories according to \u00c7elikyilmaz et al [1].", "For example, models that are optimized for perplexity can generate coherent responses but are not diverse since they are optimized for predicting unseen test data. Its equation can be thought of as exponentiation of entropy which is why you optimize for a lower perplexity score versus a higher one [2]. I decided to use the BERTSCORE because it has shown to correlate well with human judgments on sentence-level evaluations[3]. It matches the words in the candidate and reference sentences by cosine similarity after creating contextual word embeddings. You can pass in lists into the Bert score so I passed it a list of the 5 generated tweets from the different 3 model runs and a list to cross-reference which were the 100 reference tweets from each politician.", "The results were a bit surprising to me if I just considered the average of the Bert Score comparing the Markov model to the GPT-2 Runs. However, when I started to look at the standard deviation of them it made more sense after reading Open Ai\u2019s initial release notes [6] when they stated it would take several tries especially if the trained model is not familiar with the content that it is being fine-tuned. However, I was pleasantly surprised how even with a small reference dataset (100 Tweets) it was able to maintain a similar tone and content from the dataset that it was being fine-tuned with on top of its massive historical training on 40-GB worth of training data. [6] Open AI recognizes that among the tries there will be some poor execution which consists of text being repeated, false, or incoherent but will also output some great executions which explain the large standard deviation of the Bert Score.", "Below is the highest-scoring Bert Scored Tweet for each model respectively, the Markov model, GPT-2 after 30 runs, and the GPT-2 after 90 runs for each politician. As you can see the Markov model does not do too bad but the GPT-2 model after many runs does exceptionally well but there are some repeated words. The GPT-2 model\u2019s all 5 generated tweets per politician were better when it was fine-tuned with 90 runs versus 30 runs. There were smaller improvements from the 80th run compared to the 90th run but it does make a difference to fine-tune it longer.", "So in the end which was the better model? It depends on what you are trying to do. A Markovify model is a lot leaner and smaller than a GPT-2 model which requires a GPU to train on. Although I was able to access one for free on Google Colab. It takes a bit more time to generate and train than a Markovify model and it will need some further optimizations since the GPT-2 generated tweets can leave unfinished sentences, repeat words, and have false claims but if you are able to set a threshold based on a natural language generative evaluation metric such as BERT score it can help identify the better-generated text(s) among the others.", "I want to conclude that this project was not to improve or support the creation of fake impersonators, it was a project to determine how different generative text models perform with short text like Tweets and what are some weaknesses and strengths of each one. All of this is for research purposes. I was inspired by some of the fun projects on the Markovify [4] page such as tweet bots such as a Twitter bot that tweeted Haiku poems and another that impersonated Homer Simpson.", "You can find the code for my final project here. If you have any questions/feedback please leave it on Medium below!", "[3] Tianyi Zhang*, Varsha Kishore*, Felix Wu*, Kilian Q. Weinberger, & Yoav Artzi (2020). BERTScore: Evaluating Text Generation with BERT. In International Conference on Learning Representations.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F18bbb7cde0c9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@monipip3?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@monipip3?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": "Monica P."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5c19510969d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&user=Monica+P.&userId=5c19510969d1&source=post_page-5c19510969d1----18bbb7cde0c9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F18bbb7cde0c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F18bbb7cde0c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jamesponddotco?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "James Pond"}, {"url": "https://unsplash.com/s/photos/david-and-goliath?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.mturk.com/", "anchor_text": "Amazon Turk"}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab"}, {"url": "https://twitter.com/HaikuBotto", "anchor_text": "Haiku poems"}, {"url": "https://twitter.com/bot_homer", "anchor_text": "Homer Simpson"}, {"url": "https://colab.research.google.com/drive/1bJ5SFN8QlXDVX8BQNXd4f3ZbWKFC2HC7?usp=sharing", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/perplexity-intuition-and-derivation-105dd481c8f3", "anchor_text": "https://towardsdatascience.com/perplexity-intuition-and-derivation-105dd481c8f3"}, {"url": "https://github.com/jsvine/markovify", "anchor_text": "https://github.com/jsvine/markovify"}, {"url": "https://openai.com/blog/better-language-models/", "anchor_text": "https://openai.com/blog/better-language-models/"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----18bbb7cde0c9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----18bbb7cde0c9---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/markov-chains?source=post_page-----18bbb7cde0c9---------------markov_chains-----------------", "anchor_text": "Markov Chains"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----18bbb7cde0c9---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----18bbb7cde0c9---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F18bbb7cde0c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&user=Monica+P.&userId=5c19510969d1&source=-----18bbb7cde0c9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F18bbb7cde0c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&user=Monica+P.&userId=5c19510969d1&source=-----18bbb7cde0c9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F18bbb7cde0c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F18bbb7cde0c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----18bbb7cde0c9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----18bbb7cde0c9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@monipip3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@monipip3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Monica P."}, {"url": "https://medium.com/@monipip3/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "311 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5c19510969d1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&user=Monica+P.&userId=5c19510969d1&source=post_page-5c19510969d1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe17d893d3d51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdavid-and-goliath-markov-model-vs-gpt-2-model-18bbb7cde0c9&newsletterV3=5c19510969d1&newsletterV3Id=e17d893d3d51&user=Monica+P.&userId=5c19510969d1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}