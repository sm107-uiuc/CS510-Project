{"url": "https://towardsdatascience.com/understanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b", "time": 1683000231.312455, "path": "towardsdatascience.com/understanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b/", "webpage": {"metadata": {"title": "Understanding language modelling(NLP) and Using ULMFIT | by Himanshu Kriplani | Towards Data Science", "h1": "Understanding language modelling(NLP) and Using ULMFIT", "description": "A language model(LM) is a probability distribution over sequences of words. This language models are used as base model[as in Transfer learning] for various Natural language processing task including\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "Universal Language Model Fine-tuning for Text Classification", "paragraph_index": 7}, {"url": "https://arxiv.org/abs/1708.02182", "anchor_text": "state-of-the-art", "paragraph_index": 11}, {"url": "https://arxiv.org/abs/1608.03983", "anchor_text": "achieve state-of-the-art", "paragraph_index": 20}, {"url": "https://www.kaggle.com/c/quora-insincere-questions-classification/overview", "anchor_text": "kaggle", "paragraph_index": 25}], "all_paragraphs": ["A language model(LM) is a probability distribution over sequences of words. This language models are used as base model[as in Transfer learning] for various Natural language processing task including text classification, summarization, text generation and more.", "It is recommended to have a basic idea of deep learning and transfer learning before continuing this blog.", "LMs make it easier to map context. Man to Woman mapping is equivalent to Uncle to Aunt and King to Queen. This mappings are converted to joint probability distribution among vocabulary. This is known as a statistical LM.", "Given such a sequence, say of length m, LM assigns a probability P{w1,w2,\u2026,wm}to the whole sequence.", "Statistical LMs face the problem of data sparsity because of the length of the vocabulary. Whereas a neural language model(NLM) would take only sequence of words as input which solves the problem of data sparsity.", "Without diving into mathematics of langauge models lets understand how ULMFIT works which will give an idea upon Neural Langauge models.", "Universal Language Model FIne-Tuning(ULMFIT) is a transfer learning technique which can help in various NLP tasks. It has been state-of-the-art NLP technique for a long time, but then it was dethroned by BERT[which recently got dethroned by XLNet in text classification]. We will look into BERT in detail in the next part of the blog.", "Deep learning requires a lot of dataset. Specifically when doing transfer learning, we have a large dataset on which our base model is build and we transfer learn the parameters of the neural network to our domain specific dataset. When we have a smaller domain specific dataset, the models overfit. To solve this problem, Jeremy Howard and Sebastian Ruder suggest 3 different techniques in there paper on Universal Language Model Fine-tuning for Text Classification for fine-tuning in transfer learning LMs for NLP specific tasks", "Lets understand stages involved in creating a text classifier using ULMFiT with which we will understand the 3 novel techniques suggested by the authors.", "ULMFiT involves 3 major stages: LM pre-training, LM fine-tuning and Classifier fine-tuning.", "The method is universal in the sense that it meets these practical criteria:", "AWD-LSTM is an state-of-the-art language model, a regular LSTM (with no attention, short-cut connections, or other sophisticated additions) with various tuned dropout hyperparameters. Authors use AWD-LSTM as a LM in there Architecture.", "The LM is trained on a general-domain corpus to capture general features of the language in different layers", "We pre-train LM on a large general-domain corpus and fine-tune it on the target task using novel techniques. So, authors have used Wikitext-103 a dataset of 28k preprocessed articles consisting of 103Million words. In general, the dataset should be so huge that the LM learns all the properties of the langauge. This is the most expensive in terms of compute resources and time too. Hence we do this just once.", "In almost all the cases the target task dataset will have a different distribution w.r.t. the general domain corpus. In this stage, we fine-tune the model on the target task dataset to learn its distributions by using discriminative fine-tuning and slanted triangular learning rates.", "As different layers grasp different information, author suggest to fine-tune each layer to a different extent.", "In Stochastic Gradient Descent we update \u03b8 at each time step t.", "In discriminative fine-tuning, we use \u03b81, \u03b82,\u2026 \u03b8L instead of singel \u03b8 value for respective L layers.", "Using the same learning rate (LR) or an annealed learning rate throughout training is not the best way to achieve this behaviour. Instead, we propose slanted triangular learning rates (STLR)", "In STLR, authors suggest to increase the learning rate linearly and decay it in the following manner.", "STLR has been used to achieve state-of-the-art results in CV", "Fine-tuning being the most vital state of transfer learning needs to be done with maximum care. Because an aggressively done fine-tuning could over-fit our model and vice versa could make our model under-fit. Authors have suggested Gradual unfreezing approach to deal with this major issue.", "We start with unfreezing only the last layer as its contains the most general knowledge. After fine-tuning unfrozen layers for one epoch, we go for next lower layer and repeat till we complete all layers until convergence at the last iteration.", "BPTT for Text Classification (BPT3C) Language models are trained with back-propagation through time (BPTT) to enable gradient propagation for large input sequences. In order to make fine-tuning a classifier for large documents feasible, authors propose BPTT for Text Classification (BPT3C): Divide the document into fixed length batches of size b. At the beginning of each batch, the model is initialized with the final state of the previous batch; Keep track of the hidden states for mean and max-pooling; gradients are back-propagated to the batches whose hidden states contributed to the final prediction. In practice, authors suggest to use variable length backpropagation sequences.", "So, Now we are done with overwhelming theories. Lets dive into the code!!", "We will implement a text classification on quora\u2019s question text to find out insincere questions. The dataset is available at kaggle.", "Code Coming Soon. Till then, Try out yourself.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb557a63a672b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b557a63a672b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b557a63a672b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@himanshukriplani?source=post_page-----b557a63a672b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshukriplani?source=post_page-----b557a63a672b--------------------------------", "anchor_text": "Himanshu Kriplani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7342c82f594f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&user=Himanshu+Kriplani&userId=7342c82f594f&source=post_page-7342c82f594f----b557a63a672b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb557a63a672b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb557a63a672b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1801.06146.pdf", "anchor_text": "Universal Language Model Fine-tuning for Text Classification"}, {"url": "https://arxiv.org/abs/1708.02182", "anchor_text": "state-of-the-art"}, {"url": "https://arxiv.org/abs/1608.03983", "anchor_text": "achieve state-of-the-art"}, {"url": "https://www.kaggle.com/c/quora-insincere-questions-classification/overview", "anchor_text": "kaggle"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b557a63a672b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b557a63a672b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----b557a63a672b---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/ulmfit?source=post_page-----b557a63a672b---------------ulmfit-----------------", "anchor_text": "Ulmfit"}, {"url": "https://medium.com/tag/language-model?source=post_page-----b557a63a672b---------------language_model-----------------", "anchor_text": "Language Model"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb557a63a672b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&user=Himanshu+Kriplani&userId=7342c82f594f&source=-----b557a63a672b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb557a63a672b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&user=Himanshu+Kriplani&userId=7342c82f594f&source=-----b557a63a672b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb557a63a672b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b557a63a672b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb557a63a672b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b557a63a672b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b557a63a672b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b557a63a672b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b557a63a672b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b557a63a672b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b557a63a672b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b557a63a672b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b557a63a672b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b557a63a672b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshukriplani?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshukriplani?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Himanshu Kriplani"}, {"url": "https://medium.com/@himanshukriplani/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7342c82f594f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&user=Himanshu+Kriplani&userId=7342c82f594f&source=post_page-7342c82f594f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fde7091b30759&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-language-modelling-nlp-part-1-ulmfit-b557a63a672b&newsletterV3=7342c82f594f&newsletterV3Id=de7091b30759&user=Himanshu+Kriplani&userId=7342c82f594f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}