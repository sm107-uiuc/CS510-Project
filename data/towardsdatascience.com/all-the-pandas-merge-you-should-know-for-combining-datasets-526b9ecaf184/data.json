{"url": "https://towardsdatascience.com/all-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184", "time": 1683016292.23229, "path": "towardsdatascience.com/all-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184/", "webpage": {"metadata": {"title": "All the Pandas merge() you should know for combining datasets | by B. Chen | Towards Data Science", "h1": "All the Pandas merge() you should know for combining datasets", "description": "Pandas provides various built-in functions for easily combining datasets. Among them, merge() is a high-performance in-memory operation very similar to relational databases like SQL. You can use\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/018-pandas-merge/pandas-merge.ipynb", "anchor_text": "Notebook", "paragraph_index": 2}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "documentation", "paragraph_index": 29}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/018-pandas-merge/pandas-merge.ipynb", "anchor_text": "notebook", "paragraph_index": 30}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github", "paragraph_index": 31}], "all_paragraphs": ["Pandas provides various built-in functions for easily combining datasets. Among them, merge() is a high-performance in-memory operation very similar to relational databases like SQL. You can use merge() any time when you want to do database-like join operations.", "In this article, we\u2019ll be going through some examples of combining datasets using Pandas merge() function. We will cover the following common usages and should help you get started with data combinations.", "Please check out Notebook for the source code.", "When you use merge(), the simplest call must have two arguments: the left DataFrame and the right DataFrame. For example, to combine df_customer and df_info:", "By default, the function will combine data on common columns (It is the column id in our example) and produces only the result that matches in both left and right DataFrames.", "The following is an equivalent statement if you prefer to call merge from the left DataFrame.", "You can specify the common columns for merging. To do so, pass an additional argument on as the name of the common column, here 'id' in our example, to merge() function:", "If you use on , you have to make sure the column you specify must be present in both left and right DataFrames.", "To combine data on multiple common columns, you can pass a list toon:", "It might happen that the column on which you want to merge the DataFrames have different names. For such merges, you will have to specify the left_on as the left DataFrame name and right_on as the right DataFrame name, for example:", "The result will contain both id and customer_id columns.", "They are 4 types of joins available to Pandas merge() function. The logic behind these joins is very much the same that you have in SQL when you join tables. You can perform a type of join by specifying the how argument with the following values:", "And below is how the Venn Diagram looks like for our test dataset", "By default, Pandas merge() is performing the inner join and it produces only the set of records that match in both DataFrame.", "And below is the equivalent SQL query:", "To explicitly specify the inner join, you can set the argument how='inner'", "The left join produces all records from the left DataFrame, and the matched records from the right DataFrame. If there is no match, the left side will contain NaN. You can set the argument how='left' to do left join:", "And below is the equivalent SQL query:", "The right join produces all records from the right DataFrame, and the matched records from the left DataFrame. If there is no match, the right side will contain NaN. You can set the argument how='right' to do right join:", "And below is the equivalent SQL query:", "The outer join produces all records when there is a match in either left or right DataFrame. NaN will be filled for no match on either sides. You can set the argument how='outer' to do outer join:", "And below is the equivalent SQL query:", "The result of merge() might have an increased number of rows if the merge keys are not unique. For example", "Both df_customer and df_order_2 have 4 records. But, you will get a result with 6 records when running the following merge statement:", "This is an example of one-to-many merge. It is a valid scenario in our example, in which a customer can have multiple orders. However, one-to-many might be invalid in some other cases, for example, there are two records with the id value 2 in df_info", "And the merge result will be ended up with 2 different records for the same customer Jenny:", "This is certainly wrong because the same customer cannot have different information. To avoid this problem, we can set the argument validate to '1:1' , so it checks if merges keys are unique in both left and right DataFrames. It will raise a MergeError if the validation fails, for example:", "The argument validate takes one of the following values, so you can use it to validate different merge outputs.", "Pandas merge() function is a simple, powerful, and high-performance in-memory operation very similar to relational databases like SQL.", "I hope this article will help you to save time in combining datasets. I recommend you to check out the documentation for the merge() API and to know about other things you can do.", "Thanks for reading. Please check out the notebook for the source code and stay tuned if you are interested in the practical aspect of machine learning.", "More tutorials can be found on my Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F526b9ecaf184&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----526b9ecaf184---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F526b9ecaf184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F526b9ecaf184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@naffiq?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Galymzhan Abdugalimov"}, {"url": "https://unsplash.com/collections/9038523/marketing?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/018-pandas-merge/pandas-merge.ipynb", "anchor_text": "Notebook"}, {"url": "https://en.wikipedia.org/wiki/Join_(SQL)", "anchor_text": "https://en.wikipedia.org/wiki/Join_(SQL)"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "documentation"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/data-analysis/018-pandas-merge/pandas-merge.ipynb", "anchor_text": "notebook"}, {"url": "https://bindichen.medium.com/pandas-resample-tricks-you-should-know-for-manipulating-time-series-data-7e9643a7e7f3", "anchor_text": "Pandas resample() tricks you should know for manipulating time-series data"}, {"url": "https://towardsdatascience.com/how-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320", "anchor_text": "How to do a Custom Sort on Pandas DataFrame"}, {"url": "https://towardsdatascience.com/when-to-use-pandas-transform-function-df8861aa0dcf", "anchor_text": "When to use Pandas transform() function"}, {"url": "https://towardsdatascience.com/pandas-concat-tricks-you-should-know-to-speed-up-your-data-analysis-cd3d4fdfe6dd", "anchor_text": "Pandas concat() tricks you should know"}, {"url": "https://medium.com/@bindiatwork/difference-between-apply-and-transform-in-pandas-242e5cf32705", "anchor_text": "Difference between apply() and transform() in Pandas"}, {"url": "https://medium.com/@bindiatwork/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac", "anchor_text": "Using Pandas method chaining to improve code readability"}, {"url": "https://towardsdatascience.com/working-with-datetime-in-pandas-dataframe-663f7af6c587", "anchor_text": "Working with datetime in Pandas DataFrame"}, {"url": "https://medium.com/@bindiatwork/all-the-pandas-read-csv-you-should-know-to-speed-up-your-data-analysis-1e16fe1039f3", "anchor_text": "Pandas read_csv() tricks you should know"}, {"url": "https://towardsdatascience.com/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e", "anchor_text": "4 tricks you should know to parse date columns with Pandas read_csv()"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github"}, {"url": "https://medium.com/tag/python?source=post_page-----526b9ecaf184---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pandas?source=post_page-----526b9ecaf184---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/merge?source=post_page-----526b9ecaf184---------------merge-----------------", "anchor_text": "Merge"}, {"url": "https://medium.com/tag/data-science?source=post_page-----526b9ecaf184---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----526b9ecaf184---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F526b9ecaf184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&user=B.+Chen&userId=563d09da62a&source=-----526b9ecaf184---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F526b9ecaf184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&user=B.+Chen&userId=563d09da62a&source=-----526b9ecaf184---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F526b9ecaf184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F526b9ecaf184&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----526b9ecaf184---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----526b9ecaf184--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----526b9ecaf184--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----526b9ecaf184--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----526b9ecaf184--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fall-the-pandas-merge-you-should-know-for-combining-datasets-526b9ecaf184&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}