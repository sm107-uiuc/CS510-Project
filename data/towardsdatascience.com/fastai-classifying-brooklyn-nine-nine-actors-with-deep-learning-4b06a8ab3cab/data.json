{"url": "https://towardsdatascience.com/fastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab", "time": 1682993003.019493, "path": "towardsdatascience.com/fastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab/", "webpage": {"metadata": {"title": "FastAI: Classifying Brooklyn Nine-Nine Actors with Deep Learning | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "FastAI: Classifying Brooklyn Nine-Nine Actors with Deep Learning", "description": "With Season 7 currently airing, there\u2019s no doubt that Brooklyn Nine-Nine is a popular TV show. I won\u2019t go into reasons why, but if you still haven\u2019t watched it and have some time to spare, there\u2019s no\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.imdb.com/title/tt2467372/", "anchor_text": "Brooklyn Nine-Nine", "paragraph_index": 0}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 30}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 32}], "all_paragraphs": ["With Season 7 currently airing, there\u2019s no doubt that Brooklyn Nine-Nine is a popular TV show. I won\u2019t go into reasons why, but if you still haven\u2019t watched it and have some time to spare, there\u2019s no good reason to at least not give it a try.", "But this isn\u2019t a TV Show article \u2014 it\u2019s a Deep Learning one. To be more precise, the article aims to use the power of deep learning to classify images of actors from the show.", "Okay, but, where will you get the images?", "Good question. Basically the idea is to download images from the web \u2014 it\u2019s not that my intentions are to sell this model afterward (who\u2019d even benefit from it?). After downloading we\u2019ll have to do only the basic image manipulation \u2014 cropping.", "Essentially, all images were cropped to be squares, and nothing else has been done preparation-wise. The reason why is that a sophisticated Deep learning library will be used to handle the training process \u2014 FastAI.", "I\u2019ve previously written about it, and if you want to follow along make sure to have it installed and configured properly. This article might come in handy:", "Here\u2019s the list of characters for which I managed to find some amount of decent-quality photos:", "So no Hitchcock and Scully unfortunately, as they are together in most of the shots and I didn\u2019t feel like spending a couple of hours in Photoshop. Anyway, for each of the 6 actors mentioned above, 25 decent-quality photos were saved.", "Not a lot by any standard, that\u2019s why we\u2019ll be using the ResNet pre-trained network to help us out a bit. If you decide to search for images yourself, and then to make the classifier, here\u2019s how you should structure the directory:", "Yes, you\u2019re reading this right. At this point in time, FastAI library requires this structure \u2014 or at least I haven\u2019t managed to get it working otherwise. Let me know if you have.", "Good, now we can proceed with the model training!", "To start out we\u2019ll need to make two imports \u2014 and both of those from the FastAI library (refer to the article above if you don\u2019t have it installed):", "Let\u2019s do a bit of preparation now. We\u2019ll create an ImageDataBunch object with the following params:", "I\u2019ve also set a random seed to 42 so the results can be reproduced by readers. Implemented in code it gives:", "Let\u2019s now see how a couple of images from a single batch would look like:", "Now we can instantiate a cnn_learner:", "Note here how I\u2019m using the pre-trained weights of the ResNet101 network. We have only a few images, and results are generally going to be better if we\u2019re not starting from scratch. ResNet101 already knows how humans \u201clook like\u201d, and it\u2019s recommended to use it for cases like this.", "Good, we have everything we need to start training the model. Let\u2019s train it for 15 epochs to see what happens:", "In the end, we have an accuracy of around 84%, which isn\u2019t too shabby for multi-class classification problem with such limited training data.", "But let\u2019s dive deeper into model evaluation next.", "For this type of problem, it would be nice to look at a confusion matrix to see where our model performed well, and where it didn\u2019t.", "So, we can make an instance of ClassificationInterpretation to gain access to the confusion matrix:", "Good, and now the confusion matrix itself:", "It seems like our model in some cases has problems with these two combinations:", "I mean, for this limited amount of images it can be reasoned why the model is confused, but it still performs pretty decently \u2014 if you take into account how little time and effort FastAI library requires.", "Another pretty cool thing FastAI can do is to show you the images it was most confused with \u2014 conveniently the method is called .plot_top_losses():", "Here I can understand everything except the first one \u2014 it looks like a clear shot to me.", "And there you have it, with such limited data and with only a few lines of code we can develop a Deep learning-powered multi-class classification algorithm with an accuracy of around 84%.", "My goal is to spend more time in the future on this problem, collect more images for sure and maybe code the entire thing in PyTorch. Let me know if that\u2019s something you\u2019d like to read.", "I hope this was fun for you. Thanks for reading.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4b06a8ab3cab&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----4b06a8ab3cab---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b06a8ab3cab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b06a8ab3cab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.imdb.com/title/tt2467372/", "anchor_text": "Brooklyn Nine-Nine"}, {"url": "https://commons.wikimedia.org/wiki/File:Brooklyn_nine-nine_logo.png", "anchor_text": "Wikimedia Commons"}, {"url": "https://towardsdatascience.com/intro-to-fastai-installation-and-building-our-first-classifier-938e95fd97d3", "anchor_text": "Intro to FastAI: Installation and Building our First ClassifierHint: 98% Accuracy on MNIST with only 5 lines of code!towardsdatascience.com"}, {"url": "https://giphy.com/gifs/brooklynninenine-brooklyn-99-captain-holt-hot-damn-f3jZ8moRBbEvNJjOtu", "anchor_text": "Giphy"}, {"url": "https://giphy.com/gifs/KxiRwO7tqXCTDVKobo/html5", "anchor_text": "Giphy"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4b06a8ab3cab---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4b06a8ab3cab---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4b06a8ab3cab---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4b06a8ab3cab---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/python?source=post_page-----4b06a8ab3cab---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b06a8ab3cab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----4b06a8ab3cab---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4b06a8ab3cab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----4b06a8ab3cab---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4b06a8ab3cab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4b06a8ab3cab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4b06a8ab3cab---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4b06a8ab3cab--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffastai-classifying-brooklyn-nine-nine-actors-with-deep-learning-4b06a8ab3cab&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}