{"url": "https://towardsdatascience.com/are-we-confident-our-models-recall-is-precise-133112a6c407", "time": 1683001001.734731, "path": "towardsdatascience.com/are-we-confident-our-models-recall-is-precise-133112a6c407/", "webpage": {"metadata": {"title": "Are We Confident Our Model\u2019s Recall is Precise? | by Ron Itzikovitch | Towards Data Science", "h1": "Are We Confident Our Model\u2019s Recall is Precise?", "description": "Bootstrap estimates & confidence intervals with simple Python code examples"}, "outgoing_paragraph_urls": [{"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code", "paragraph_index": 1}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code", "paragraph_index": 3}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "An introduction to the bootstrap", "paragraph_index": 5}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "Efron & Tibshirani, 1994", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Confidence_interval", "anchor_text": "confidence interval", "paragraph_index": 14}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code", "paragraph_index": 15}, {"url": "https://www.amazon.com/Introduction-Statistical-Learning-Applications-Statistics/dp/1461471370", "anchor_text": "James et al., 2013", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Statistic", "anchor_text": "statistics", "paragraph_index": 17}, {"url": "https://en.wikipedia.org/wiki/Statistic", "anchor_text": "statistic", "paragraph_index": 18}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error", "paragraph_index": 20}, {"url": "https://en.wikipedia.org/wiki/Standard_deviation", "anchor_text": "standard deviation", "paragraph_index": 25}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error", "paragraph_index": 25}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error", "paragraph_index": 25}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error", "paragraph_index": 26}, {"url": "https://en.wikipedia.org/wiki/Confidence_interval", "anchor_text": "confidence interval", "paragraph_index": 26}, {"url": "https://en.wikipedia.org/wiki/Estimator", "anchor_text": "estimator", "paragraph_index": 32}, {"url": "https://en.wikipedia.org/wiki/Estimator", "anchor_text": "estimator", "paragraph_index": 32}, {"url": "https://en.wikipedia.org/wiki/Estimator", "anchor_text": "estimator", "paragraph_index": 33}, {"url": "https://en.wikipedia.org/wiki/Bias_of_an_estimator", "anchor_text": "biased", "paragraph_index": 33}, {"url": "https://en.wikipedia.org/wiki/Expected_value", "anchor_text": "expected value", "paragraph_index": 33}, {"url": "https://en.wikipedia.org/wiki/Bias_of_an_estimator", "anchor_text": "bias", "paragraph_index": 34}, {"url": "https://people.eecs.berkeley.edu/~jordan/sail/readings/archive/efron-improve_cv.pdf", "anchor_text": "Efron, 1983", "paragraph_index": 35}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Efron & Tibshirani, 1997", "paragraph_index": 36}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Efron & Tibshirani, 1997", "paragraph_index": 37}, {"url": "https://www.wolframalpha.com/input/?i=limit+%281-1%2Fn%29%5En+as+n-%3Einfinity", "anchor_text": "see here", "paragraph_index": 38}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Efron & Tibshirani, 1997", "paragraph_index": 40}, {"url": "https://stats.stackexchange.com/a/96750/47999", "anchor_text": "this answer", "paragraph_index": 40}, {"url": "https://stats.stackexchange.com/", "anchor_text": "CrossValidated", "paragraph_index": 40}, {"url": "https://en.wikipedia.org/wiki/Confidence_interval", "anchor_text": "Confidence intervals", "paragraph_index": 47}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJM199009063231003", "anchor_text": "Janerich et al., 1990", "paragraph_index": 48}, {"url": "https://en.wikipedia.org/wiki/Odds_ratio", "anchor_text": "odds ratio", "paragraph_index": 50}, {"url": "https://en.wikipedia.org/wiki/Odds_ratio", "anchor_text": "odds ratio", "paragraph_index": 51}, {"url": "https://en.wikipedia.org/wiki/Odds_ratio", "anchor_text": "odds ratio", "paragraph_index": 52}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code", "paragraph_index": 55}, {"url": "https://en.wikipedia.org/wiki/Percentile", "anchor_text": "percentiles", "paragraph_index": 55}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "Efron & Tibshirani, 1994, ch.13", "paragraph_index": 55}, {"url": "https://www.tau.ac.il/~saharon/Boot/10.1.1.133.8405.pdf", "anchor_text": "Carpenter & Bithell, 2000", "paragraph_index": 59}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "Efron & Tibshirani, 1994, ch.13", "paragraph_index": 59}, {"url": "https://en.wikipedia.org/wiki/Frequentist_inference", "anchor_text": "frequentist", "paragraph_index": 61}, {"url": "https://en.wikipedia.org/wiki/Random_variable", "anchor_text": "random variable", "paragraph_index": 64}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html", "anchor_text": "logistic regression", "paragraph_index": 71}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html", "anchor_text": "make_classification", "paragraph_index": 71}, {"url": "http://rasbt.github.io/mlxtend/user_guide/evaluate/bootstrap_point632_score/", "anchor_text": "bootstrap_point632_score", "paragraph_index": 75}, {"url": "http://rasbt.github.io/mlxtend/installation/", "anchor_text": "mlxtend", "paragraph_index": 75}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code", "paragraph_index": 76}, {"url": "https://www.tau.ac.il/~saharon/Boot/10.1.1.133.8405.pdf", "anchor_text": "Carpenter & Bithell, 2000", "paragraph_index": 77}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Efron & Tibshirani, 1997", "paragraph_index": 77}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "bootstrap_estimate_and_ci", "paragraph_index": 79}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error", "paragraph_index": 79}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code", "paragraph_index": 81}, {"url": "http://Morey, R.D., Hoekstra, R., Rouder, J.N., Lee, M.D. and Wagenmakers, E.J., 2016", "anchor_text": "Morey et al., 2016", "paragraph_index": 84}, {"url": "https://rpsychologist.com/d3/CI/", "anchor_text": "this link", "paragraph_index": 85}, {"url": "https://rpsychologist.com/", "anchor_text": "Kristoffer Magnusson\u2019s blog", "paragraph_index": 85}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.4780120902", "anchor_text": "Vollset, 1993", "paragraph_index": 87}, {"url": "https://www.investopedia.com/terms/r/representative-sample.asp", "anchor_text": "representative sample", "paragraph_index": 89}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code", "paragraph_index": 94}, {"url": "https://en.wikipedia.org/wiki/Random_variable", "anchor_text": "random variables", "paragraph_index": 98}], "all_paragraphs": ["We are going to apply a bootstrap method to estimate a classifier\u2019s Recall, Precision, F1-score, ROC AUC, etc., and construct corresponding confidence intervals.", "There is code you can copy-paste in the \u201cAnd now in Python\u201d section which you can use as you wish.", "To be honest, a lot of the content in this post will be me advocating the use of confidence intervals, specifically ones constructed using bootstrap methods.", "If you know in advance that you don\u2019t need (or simply don\u2019t want) to read about the benefits of using bootstrap methods and confidence intervals, please feel free to skip most of this post\u2019s content and just use the code.", "If you are unsure whether you should read this post or not, the next section might help you decide.", "The preface to \u201cAn introduction to the bootstrap\u201d begins as follows:", "Statistics is a subject of amazingly many uses and surprisingly few effective practitioners. The traditional road to statistical knowledge is blocked, for most, by a formidable wall of mathematics. Our approach here avoids that wall. The bootstrap is a computer based method of statistical inference that can answer many real statistical questions without formulas. Our goal in this book is to arm scientists and engineers, as well as statisticians, with computational techniques that they can use to analyze and understand complicated data sets. \u2014 Efron & Tibshirani, 1994", "In this post I will (humbly) strive to achieve a somewhat similar goal.", "Confidence intervals are sometimes considered to be the lore of statisticians and may seem to be irrelevant when considering the common challenges a data science practitioner must face.", "Throughout this post I will be doing my best to convince you, the data scientist, that:", "I will say that as worthy as these two goals may be, there are some caveats which will be addressed as we go along.", "This is what it\u2019s all about.", "We build a model and we wish to estimate its performance using some metric, say Recall. We want our estimate to be as close as possible to the \u201ctrue\u201d Recall \u2014 the Recall our classifier will have when we release it into the wild, i.e., deploy to production.", "Consider a common estimate, like average height. We would probably not calculate the average height of 5,000 persons and say that it is exactly the same as the average height of 1,000,000 other persons. In much the same way it would not make sense to calculate Recall based on 5,000 data points and expect it to be exactly the same as the Recall for 1,000,000 data points that the classifier will encounter in the future.", "To gain a better understanding of the variability of our Recall (or other metrics) we can apply bootstrap methods to estimate it and construct a confidence interval which will help us assess its variance.", "This post is concerned with introducing the reader to such methods and provides easy-to-use Python code to apply them.", "The bootstrap is a widely applicable and extremely powerful statistical tool that can be used to quantify the uncertainty associated with a given estimator or statistical learning method. \u2014 James et al., 2013", "Generally speaking, bootstrap methods are a collection of techniques based on resampling an existing dataset in order to obtain estimates for various statistics. This is accomplished by using our existing dataset to create new bootstrap datasets by drawing from the original dataset with replacement, i.e., data points can appear more than once in a bootstrap generated dataset.", "We create many such bootstrap datasets and use them to calculate our statistic of interest. This process enables us to obtain a bootstrap distribution which can be used to estimate the distribution of the sample statistic.", "Let us say we would like to find the average number of applications android phone users currently have installed on their devices. To do that we collect data from 1,000 android mobile phone owners, calculate the average number of apps and find that it is 47.038.", "However, we would like to get an estimate of how \u201creliable\u201d or \u201caccurate\u201d this average really is \u2014 or in other words \u2014 we would like to estimate the standard error of the average we found.", "To accomplish the above we apply a bootstrap procedure by doing the following:", "We repeat these two steps 1,000 times \u2014 each time resampling data points from the dataset and calculating the average.", "We observe that the estimates obtained using the bootstrap estimates are very similar to the values we were trying to estimate:", "We now have 1,000 averages we obtained from bootstrap samples. The mean of those averages is 47.035 \u2014 this is our bootstrap estimate for the sample mean (the average number of apps in our dataset) and it is very close to the mean of the true estimates \u2014 47.003.", "We also calculate the standard deviation of those 1,000 bootstrap estimates and get 0.125 \u2014 this is our estimate of the standard error of the sample mean, i.e., it is the estimate for the standard error of the average number of apps we calculated using our dataset.In other words, we can expect the original sample mean (47.038) to differ from the true mean by 0.125, on average.", "The standard error we found can be used to construct a confidence interval. If we assume a normal distribution of the sample mean, the estimates obtained using the bootstrap method allow us to say that there is a 95% probability that the interval [46.79, 47.28] covers (contains) the true average \u2014 the average number of apps of all the android phone users in the world.", "Note: We won\u2019t elaborate on the method used to construct the above confidence interval since we will be using a different approach in this post.", "If we can collect more data that\u2019s awesome, but many times we only have a certain amount of data and we have to make do with that \u2014 we cannot obtain more data from the original population due to time constraints, budget constraints or various other reasons.", "We would like to utilize the available dataset and extract as much information as we can from it, like we did in the above example. Using bootstrap methods allows us to do that (for some purposes).", "When we set out to estimate a parameter, we are often interested in the \u201caccuracy\u201d of our estimator \u2014 we would like to know if our estimator is \u201cstable\u201d, i.e., has low variability.", "In this section we discuss a method for obtaining a bootstrap estimate, not to be confused with methods for constructing bootstrap confidence intervals (discussed later).", "We obtain an estimate by using an estimator, e.g., to estimate the average height of a population we use the average height of the persons in our sample as an estimator (a function of the data) which produces an estimate (a number).", "An estimator can be biased, which means it will tend to overestimate the true parameter, or underestimate it. More specifically it means that the expected value of the estimator will be greater or lesser than that of the parameter it is meant to estimate.", "The .632 estimator and the .632+ estimator are bootstrap estimators that address the concern of biased estimation by correcting for the bias (.632+ being the superior yet computationally heavier method).", "The .632 estimator was introduced by [Efron, 1983] as an estimator for the error rate of a prediction rule in classifying future observations. The paper showed that the .632 estimator performed better than cross-validation and several other estimators.", "However, it was later noted in [Efron & Tibshirani, 1997] that the .632 estimator may suffer from a downward bias when used to estimate the error rate of models which can be highly overfitted. The .632+ estimator corrects for the possible bias issue and produces better estimates.", "Note: The bootstrap estimator is actually a smoothed version of the cross-validation estimator [Efron & Tibshirani, 1997], where \u201csmoothed\u201d in this case means reduced variability.", "When we sample from a uniform distribution of n items, the probability to draw a specific item is 1/n and the probability of not drawing it is 1-(1/n).When we draw n items with replacement (all draws being independent) the probability that a specific item will never be drawn is (1-(1/n))^n which equals 1/e as n approaches infinity (see here).", "As we are sampling with replacement this means that on average n*1/e (approx. n*0.368) of the items will not be selected, or in other words, our sample of n items will contain approx. n*0.632 (63.2%) of the items in the dataset (since we sampled with replacement from a uniform distribution).This result is used to weigh several of the terms the estimator depends upon to correct the bias, hence the name .632 estimator.", "As the formal definition of the .632 and .632+ estimators depends on formal definitions of the no-information error rate, relative overfitting rate, leave-one-out bootstrap and several other terms, I won\u2019t encumber this section with numerous equations and kindly refer the reader to [Efron & Tibshirani, 1997] for a comprehensive derivation of the estimators and their properties. For a shorter and well written explanation, please see this answer on CrossValidated.", "Hopefully someday Medium will support LaTeX and writing a dozen equations with interleaving text will not require using a dozen images.", "Let\u2019s say we have built a classifier and to evaluate its performance we test it on a single data point and we get it right \u2014 Recall is 100%. Great success!", "But this sounds funny, right? testing a classifier on a single data point?So we test it again on 10 data points, and get a Recall of 80%. Still good.However, evaluating performance using only 10 data points seems weird \u2014 what if we tested our classifier on 10 relatively easy examples? If we choose a different set of 10 data points and evaluate it again we could get a different Recall score.", "How about testing our classifier on 100 data points? or 1,000? how many data points are enough? how many data points do we need to determine that our Recall is reliable?", "We don\u2019t need to be well versed in statistics to know that if we calculate a number (e.g., an average) based on a small number of observations, that number could be \u201cinaccurate\u201d. We know this intuitively.", "Say we try to estimate the average height of the people in our town by measuring the height of only 5 people. We know that our estimate could be totally wrong \u2014 we only measured 5 individuals to try and estimate the average height of 100,000 people \u2014 obviously there\u2019s a problem with using such a small sample.", "Confidence intervals provide us with a range of possible values so that we can gain a better understanding of the variability our estimate is likely to have. The use of the word \u201clikely\u201d in this context is intentional since the properties of realized confidence intervals are not fixed, and may vary according to circumstances.", "One domain where confidence intervals are used extensively is epidemiological research. A typical use case can be found in [Janerich et al., 1990] where they studied whether lung cancer is associated with exposure to tobacco smoke within the household.", "The researchers conducted a population-based case\u2013control study of 191 patients (who had lung cancer) and an equal number of persons who did not have lung cancer.", "Abbreviating the methods and results \u2014 to assess whether exposure to tobacco smoke within the household increases the risk of getting lung cancer, the researchers calculated the odds ratio (2.07) and a 95% confidence interval for the odds ratio (1.16 to 3.68).", "This means that in the study they found that the odds of getting lung cancer are about twice as large (2.07) for people who were exposed to tobacco smoke within the household compared to those who weren\u2019t. We do note that the confidence interval suggests that the true odds ratio could also be 1.16, i.e., it is possible that people who were exposed to tobacco smoke within the household were only 1.16 times likelier to get lung cancer compared to those who weren\u2019t exposed.", "Change the sample size (or the 25 smoker-years threshold chosen in the study) and we may also get a confidence interval which includes 1.0, which would mean that the odds ratio is not statistically significant and the odds of getting lung cancer may be the same for both groups in the experiment.", "As we can see, confidence intervals contain information which a single number cannot encompass.", "Bootstrap confidence intervals can be constructed using non-parametric sampling, which means we do not need to make any assumptions regarding the distribution of our parameter of interest (or our data for that matter). Bootstrap confidence intervals can also be constructed using parametric sampling, but we will not use this approach in this post.", "In the code provided later in the post we use the percentiles of the distribution of bootstrap estimates to construct confidence intervals. The motivation to construct confidence intervals based on bootstrap percentiles is that we can use the percentiles of the bootstrap estimates distribution since it (presumably) will be sufficiently similar to the distribution of the parameter we are trying to estimate. This is shown to be quite accurate in some cases, and less in others [Efron & Tibshirani, 1994, ch.13].", "As an example we will construct a 95% confidence interval by using the distribution of bootstrap estimates (figure 2):", "As we can see in figure 2, choosing the lower and upper bounds as we did means that 95% of the bootstrap estimates are within the confidence interval, and we say there is a 95% probability that the confidence interval [46.8, 47.3] covers the parameter we are trying to estimate by using a bootstrap method.", "If we were trying to estimate a classifier\u2019s Recall for example, then we could say that there is a 95% probability that the interval [46.8, 47.3] covers (contains) the true Recall of our classifier.", "We should be aware that there are several methods for constructing bootstrap confidence intervals and the curious reader is encouraged to read [Carpenter & Bithell, 2000] to gain a better understanding of pros and cons of each method. If you require more information regarding the method used in this post it can be found in [Efron & Tibshirani, 1994, ch.13].", "In my humble opinion, constructing a more-or-less \u201caccurate\u201d confidence interval and actually using it is preferable to ignoring the information gained from confidence intervals altogether.", "The confidence intervals we discuss in this post are frequentist confidence intervals. To be certain that we understand what they mean, we will consider the following example:", "Assume we construct a 95% confidence interval for our classifier\u2019s Recall and obtain the interval [0.55, 0.65].", "It DOES NOT mean: There is a 95% probability that the true Recall is in the interval [0.55, 0.65].", "When discussing frequentist confidence intervals (the most common kind of confidence intervals) the true parameter (Recall in our case) is considered to be a fixed number, and not a random variable \u2014 it has only a single fixed value, and that value is either inside the confidence interval, or not. There is no probability associated with it. The probability of 95% refers to the method which we use to construct the interval. The method guarantees that the interval will cover the true parameter in 95% of the cases (on average).", "Consider the following: we calculate Recall 100 times (each time based on a different sample/test set) and construct 100 confidence intervals at a 95% confidence level. 5 of those 100 confidence intervals will not cover the true Recall (on average) \u2014 e.g., one of them could be a confidence interval of [0.55, 0.65] when the true Recall is 0.66, i.e., this confidence interval of [0.55 to 0.65] is one of those 5 confidence intervals which does not cover the true Recall.", "Another example: Let\u2019s say we want to find the average height of a Chinese person. The true average height is some fixed number, e.g., 168.3cm. We cannot measure the height of 1.4 billion people, so we use a sample of 1,000 Chinese people and measure their height \u2014 the average of our sample is 167.3cm and the confidence interval is [166.1cm, 168.5cm]. We now sample another 1,000 people, measure their height and construct another confidence interval. We repeat the above process 100 times. By now we have calculated the average height 100 times (once for each sample) and constructed 100 confidence intervals. On average, 5 of those confidence intervals will not cover (contain) the true average height of 168.3cm.", "Now let\u2019s assume we only have one sample of 1,000 people, because that\u2019s all our budget can afford. There\u2019s a 5% chance that a 95% confidence interval that we will construct based on our single sample will not cover the true average height.", "Note: We can always construct a confidence interval with a higher confidence level, say 99%, at the cost of making the interval wider.", "The width of the confidence interval is of value to us since it enables us to better understand the variability of our estimate. Wider intervals mean higher variability.", "The above graph (figure 3) illustrates the results of running a simulation where Recall was estimated using a bootstrap method (.632), under specific conditions. Changing the parameters will result in slightly different results, but the main result will remain the same \u2014 we can expect to see confidence interval width decrease as sample size increases.", "The data in the figure was generated by applying scikit-learn\u2019s logistic regression classifier which was used to obtain bootstrap estimates and confidence intervals for Recall by fitting it on a binary classification dataset generated using make_classification. For each sample size 1,000 bootstrap iterations were run to obtain the bootstrap estimate and confidence interval for Recall. Random noise was added to the dataset to make the classification task a bit harder, much like in the real world where data is (more often than not) noisy.", "For a data set containing 500 data points the bootstrap Recall estimate was 60.6%, but the 95% confidence interval was [48.9%, 70.8%]. This means that we can\u2019t rejoice in the fact that we got a Recall of 60.6% since there is a 95% chance that the confidence interval covers (contains) the true Recall, which could be 50.0%, rendering our classifier as useful as a coin flip.", "The same classifier was tested on 1,000 data points and produced a bootstrap Recall estimate of 62.9%, with a 95% confidence interval of [54.5%, 71.3%]. Note that now we can be more certain that our classifier is better than a random guessing of the target class due to the fact that the confidence interval does not include the value 50%.", "Note: Bootstrap confidence interval width (as well as other properties) are a function not only of the sample size, but also of the classifier type (linear models, tree based models, etc.), the parameter that is being estimated and the inherent variance of the features in the dataset, to name a few.", "This section presents a function that you can copy-paste and easily use in your code. The function simply wraps the bootstrap_point632_score function from the mlxtend package for ease of use.", "The code includes the bootstrap_estimate_and_ci function as well as a few simple usage examples where we calculate estimates and confidence intervals for Recall, Precision, F1-score, ROC AUC and Accuracy.", "We note that [Carpenter & Bithell, 2000] recommend using 1000\u20132000 bootstrap iterations when calculating bootstrap confidence intervals. If the parameter estimate is all you care about, then 50\u2013200 iterations are usually sufficient [Efron & Tibshirani, 1997].", "For large sample sizes and models that are more computationally expensive using a large number of bootstrap iterations can become very time consuming, and so the default number of iterations (n_splits) is set to 200. You can choose whether to increase that number to achieve more accurate confidence intervals at the cost of longer computation times.", "The bootstrap_estimate_and_ci function returns the bootstrap estimate, the lower and upper bounds of the bootstrap confidence interval and the standard deviation of the bootstrap estimates (which is also the standard error of the sample estimate), e.g. calling the function like so:", "will return four values, where est is the bootstrap estimate for Accuracy, the 95% confidence interval is [low, up] and the standard error of the sample Accuracy is stderr.", "The code includes several examples of calling the function with different arguments and various metrics.", "Even though confidence intervals are common practice (and even mandatory) in various fields, they are also a subject which is:", "Iterating the pros and cons of confidence intervals is out of scope for this post, so I will only briefly highlight several of the known issues:", "The above is by no means a complete list of all possible issues. You can read more about it in [Morey et al., 2016] if you would like to gain a better understanding.", "A beautiful interactive visualization of confidence intervals is available in this link in Kristoffer Magnusson\u2019s blog, and the author\u2019s comments are informative and well written.", "This post does not suggest to use confidence intervals for performing statistical significance tests, and does not encourage to regard them as depicting the absolute \u201ctruth\u201d, but only as an approximation of it. Therefore, the above issues should not be a major concern.", "However, if you do plan to use confidence intervals to perform statistical inference (e.g., analyze medical data to decide on a proper treatment), and especially when dealing with small sample sizes, the world of confidence intervals is one you would probably like to get better acquainted with. As an example, [Vollset, 1993] compares 13 methods of constructing confidence intervals for binomial proportion and describes their characteristics.", "There are many methods for constructing confidence intervals and choosing the \u201ccorrect\u201d method requires understanding the properties of each one.", "We always assume that the sample we have (our dataset) properly and proportionally reflects the key characteristics of the true population, i.e., it is a representative sample. If not, any estimates obtained using such a sample are not reliable and should not be trusted (in most cases).", "Another issue which is not discussed in this post is constructing simultaneous confidence intervals (termed confidence regions) which are a generalization of confidence intervals for the multi-parameter case.", "We did not discuss the case of constructing confidence intervals for several parameters simultaneously in a way which guarantees that those intervals will cover the true parameters with probability X, i.e., it is one thing to construct an X% confidence interval for each parameter individually and another to construct an X% confidence region that will simultaneously cover all parameters at a given confidence level X%.", "We\u2019ve discussed confidence intervals quite extensively, and I hope I\u2019ve done a decent job at conveying the benefits of using them.", "We saw how to apply bootstrap methods to estimate parameters along with their variability, and constructed bootstrap confidence intervals for our estimates.", "We looked at several code examples which showed how bootstrap methods can be used to obtain estimates and construct confidence intervals for Recall, Precision, F1-score, ROC AUC and Accuracy.", "Thank you for taking the time to read through this post !", "If you wish, you are more than welcome to write a response. I\u2019d love to know what you think \u2014 all forms of feedback are welcome!", "Confidence intervals are a valuable tool in many fields, but are sometimes overlooked when we practice data science. By ignoring them we are implicitly saying that it is fine to use confidence intervals to choose a proper treatment for cancer patients or decide if a new drug really lowers the risk of suffering a heart attack, but when trying to build a model on data from other domains confidence intervals are irrelevant \u2014 no one\u2019s health will be at risk if our estimates are \u201cinaccurate\u201d so confidence intervals can be safely ignored.", "Performance metrics such as F1-score, ROC AUC etc. are random variables \u2014 their value can change each time we calculate them since they depend (among other things) on the sample we choose as our test set or validation set, i.e., different samples can result in different values. Confidence intervals can help us estimate just how variable our metrics can be.", "Constructing confidence intervals may (sometimes) cause some mental anguish \u2014 it is never fun to find out that the hard earned F1-score which we achieved might actually be lower than we would want to accept. On the other hand, confidence intervals enable us to know how much we can \u201ctrust\u201d our measurements and what range of values they are \u201clikely\u201d to have.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F133112a6c407&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----133112a6c407--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----133112a6c407--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@roncho12?source=post_page-----133112a6c407--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roncho12?source=post_page-----133112a6c407--------------------------------", "anchor_text": "Ron Itzikovitch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F10fa2c0e33e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&user=Ron+Itzikovitch&userId=10fa2c0e33e8&source=post_page-10fa2c0e33e8----133112a6c407---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F133112a6c407&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F133112a6c407&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/users/995645-995645/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3859795", "anchor_text": "995645"}, {"url": "https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3859795", "anchor_text": "Pixabay"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code"}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "An introduction to the bootstrap"}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "Efron & Tibshirani, 1994"}, {"url": "https://en.wikipedia.org/wiki/Confidence_interval", "anchor_text": "confidence interval"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code"}, {"url": "https://www.amazon.com/Introduction-Statistical-Learning-Applications-Statistics/dp/1461471370", "anchor_text": "James et al., 2013"}, {"url": "https://en.wikipedia.org/wiki/Statistic", "anchor_text": "statistics"}, {"url": "https://en.wikipedia.org/wiki/Statistic", "anchor_text": "statistic"}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error"}, {"url": "https://en.wikipedia.org/wiki/Standard_deviation", "anchor_text": "standard deviation"}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error"}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error"}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error"}, {"url": "https://en.wikipedia.org/wiki/Confidence_interval", "anchor_text": "confidence interval"}, {"url": "https://en.wikipedia.org/wiki/Estimator", "anchor_text": "estimator"}, {"url": "https://en.wikipedia.org/wiki/Estimator", "anchor_text": "estimator"}, {"url": "https://en.wikipedia.org/wiki/Estimator", "anchor_text": "estimator"}, {"url": "https://en.wikipedia.org/wiki/Bias_of_an_estimator", "anchor_text": "biased"}, {"url": "https://en.wikipedia.org/wiki/Expected_value", "anchor_text": "expected value"}, {"url": "https://en.wikipedia.org/wiki/Bias_of_an_estimator", "anchor_text": "bias"}, {"url": "https://people.eecs.berkeley.edu/~jordan/sail/readings/archive/efron-improve_cv.pdf", "anchor_text": "Efron, 1983"}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Efron & Tibshirani, 1997"}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Efron & Tibshirani, 1997"}, {"url": "https://www.wolframalpha.com/input/?i=limit+%281-1%2Fn%29%5En+as+n-%3Einfinity", "anchor_text": "see here"}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Efron & Tibshirani, 1997"}, {"url": "https://stats.stackexchange.com/a/96750/47999", "anchor_text": "this answer"}, {"url": "https://stats.stackexchange.com/", "anchor_text": "CrossValidated"}, {"url": "https://en.wikipedia.org/wiki/Confidence_interval", "anchor_text": "Confidence intervals"}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJM199009063231003", "anchor_text": "Janerich et al., 1990"}, {"url": "https://en.wikipedia.org/wiki/Odds_ratio", "anchor_text": "odds ratio"}, {"url": "https://en.wikipedia.org/wiki/Odds_ratio", "anchor_text": "odds ratio"}, {"url": "https://en.wikipedia.org/wiki/Odds_ratio", "anchor_text": "odds ratio"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code"}, {"url": "https://en.wikipedia.org/wiki/Percentile", "anchor_text": "percentiles"}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "Efron & Tibshirani, 1994, ch.13"}, {"url": "https://en.wikipedia.org/wiki/Percentile", "anchor_text": "percentile"}, {"url": "https://en.wikipedia.org/wiki/Percentile", "anchor_text": "percentile"}, {"url": "https://www.tau.ac.il/~saharon/Boot/10.1.1.133.8405.pdf", "anchor_text": "Carpenter & Bithell, 2000"}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "Efron & Tibshirani, 1994, ch.13"}, {"url": "https://en.wikipedia.org/wiki/Frequentist_inference", "anchor_text": "frequentist"}, {"url": "https://en.wikipedia.org/wiki/Random_variable", "anchor_text": "random variable"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html", "anchor_text": "logistic regression"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html", "anchor_text": "make_classification"}, {"url": "http://rasbt.github.io/mlxtend/user_guide/evaluate/bootstrap_point632_score/", "anchor_text": "bootstrap_point632_score"}, {"url": "http://rasbt.github.io/mlxtend/installation/", "anchor_text": "mlxtend"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code"}, {"url": "https://www.tau.ac.il/~saharon/Boot/10.1.1.133.8405.pdf", "anchor_text": "Carpenter & Bithell, 2000"}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Efron & Tibshirani, 1997"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "bootstrap_estimate_and_ci"}, {"url": "https://en.wikipedia.org/wiki/Standard_error", "anchor_text": "standard error"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code"}, {"url": "https://scikit-learn.org/stable/modules/classes.html#classification-metrics", "anchor_text": "classification metrics"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html#sklearn.metrics.roc_auc_score", "anchor_text": "roc_auc_score"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code"}, {"url": "http://Morey, R.D., Hoekstra, R., Rouder, J.N., Lee, M.D. and Wagenmakers, E.J., 2016", "anchor_text": "Morey et al., 2016"}, {"url": "https://rpsychologist.com/d3/CI/", "anchor_text": "this link"}, {"url": "https://rpsychologist.com/", "anchor_text": "Kristoffer Magnusson\u2019s blog"}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.4780120902", "anchor_text": "Vollset, 1993"}, {"url": "https://www.investopedia.com/terms/r/representative-sample.asp", "anchor_text": "representative sample"}, {"url": "https://gist.github.com/roncho12/60178f12ea4c3a74764fd645c6f2fe13", "anchor_text": "code"}, {"url": "https://en.wikipedia.org/wiki/Random_variable", "anchor_text": "random variables"}, {"url": "https://cindy.informatik.uni-bremen.de/cosy/teaching/CM_2011/Eval3/efron_97.pdf", "anchor_text": "Improvements on cross-validation: the 632+ bootstrap method"}, {"url": "https://projecteuclid.org/download/pdf_1/euclid.ss/1032280214", "anchor_text": "Bootstrap confidence intervals"}, {"url": "https://www.tau.ac.il/~saharon/Boot/10.1.1.133.8405.pdf", "anchor_text": "Bootstrap confidence intervals: when, which, what? A practical guide for medical statisticians"}, {"url": "https://projecteuclid.org/download/pdf_1/euclid.ss/1177013815", "anchor_text": "Bootstrap methods for standard errors, confidence intervals, and other measures of statistical accuracy"}, {"url": "https://pdfs.semanticscholar.org/1937/3f43bb7456627880d50e53ab69e36f4c7607.pdf", "anchor_text": "Cross-validation and the bootstrap: Estimating the error rate of a prediction rule"}, {"url": "https://www.nejm.org/doi/full/10.1056/NEJM199009063231003", "anchor_text": "Lung cancer and exposure to tobacco smoke in the household"}, {"url": "https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf", "anchor_text": "An introduction to the bootstrap"}, {"url": "https://people.eecs.berkeley.edu/~jordan/sail/readings/archive/efron-improve_cv.pdf", "anchor_text": "Estimating the error rate of a prediction rule: improvement on cross-validation"}, {"url": "https://www.amazon.com/Introduction-Statistical-Learning-Applications-Statistics/dp/1461471370", "anchor_text": "An introduction to statistical learning"}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.4780120902", "anchor_text": "Confidence intervals for a binomial proportion"}, {"url": "https://link.springer.com/content/pdf/10.3758%2Fs13423-015-0947-8.pdf", "anchor_text": "The fallacy of placing confidence in confidence intervals"}, {"url": "https://medium.com/tag/data-science?source=post_page-----133112a6c407---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----133112a6c407---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/bootstrap?source=post_page-----133112a6c407---------------bootstrap-----------------", "anchor_text": "Bootstrap"}, {"url": "https://medium.com/tag/statistics?source=post_page-----133112a6c407---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----133112a6c407---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F133112a6c407&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&user=Ron+Itzikovitch&userId=10fa2c0e33e8&source=-----133112a6c407---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F133112a6c407&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&user=Ron+Itzikovitch&userId=10fa2c0e33e8&source=-----133112a6c407---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F133112a6c407&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----133112a6c407--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F133112a6c407&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----133112a6c407---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----133112a6c407--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----133112a6c407--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----133112a6c407--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----133112a6c407--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----133112a6c407--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----133112a6c407--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----133112a6c407--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----133112a6c407--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roncho12?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roncho12?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ron Itzikovitch"}, {"url": "https://medium.com/@roncho12/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "82 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F10fa2c0e33e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&user=Ron+Itzikovitch&userId=10fa2c0e33e8&source=post_page-10fa2c0e33e8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faa3cf2d8ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fare-we-confident-our-models-recall-is-precise-133112a6c407&newsletterV3=10fa2c0e33e8&newsletterV3Id=aa3cf2d8ed&user=Ron+Itzikovitch&userId=10fa2c0e33e8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}