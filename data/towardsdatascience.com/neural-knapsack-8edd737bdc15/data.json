{"url": "https://towardsdatascience.com/neural-knapsack-8edd737bdc15", "time": 1682997447.753463, "path": "towardsdatascience.com/neural-knapsack-8edd737bdc15/", "webpage": {"metadata": {"title": "Neural Knapsack. Solving the knapsack problem using\u2026 | by Shayan Hashemi | Towards Data Science", "h1": "Neural Knapsack", "description": "In some cases of data science, it is needed to run a specific algorithm on the output of the model to get the result. Sometimes it is as simple as finding the index of the maximum output, other\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["In some cases of data science, it is needed to run a specific algorithm on the output of the model to get the result. Sometimes it is as simple as finding the index of the maximum output, other times, more advanced algorithms are needed. You may run the algorithm after running the inference. However, designing a model that can run the algorithm internally have some advantages. Solving the problem of knapsack using neural networks not only helps the model run the knapsack algorithm internally but also allows the model to be trained end to end.", "My lovely computer algorithm teacher explained the knapsack problem to me using this story. Think of a thief on a robbery. There are some items available to be robbed. Each item has its own weight and value. The thief has a knapsack with a determined capacity which indicates the maximum amount of weight that he (or she) can carry. The thief\u2019s profit is calculated via summing over the chosen item\u2019s values. Our goal is to maximize the profit while keeping the sum of chosen items\u2019 weights less than the knapsack\u2019s capacity.", "\u201cGiven a set of items, each with a weight and a value, determine the number of each item to include in a collection so that the total weight is less than or equal to a given limit and the total value is as large as possible. It derives its name from the problem faced by someone who is constrained by a fixed-size knapsack and must fill it with the most valuable items\u201d", "In this article, we try to solve the knapsack problem using neural networks.", "The first step is to prepare data. We use random integers for items\u2019 weights, items\u2019 prices and the capacity of the knapsack. After creating the problem, we use brute force to find the optimum solution.", "Normalizing the input is a part of every machine learning project as it helps the model to generalize better. To normalize each knapsack problem:", "The normalized form of previously created knapsack problem:", "The dataset consists of ten thousand samples for training and two hundred for testing.", "The model we choose for this task is a fairly simple model. It has two inputs and an output. At first, the inputs are concatenated together. The result enters two sequential dense layers activated by sigmoid non-linearity. The output of the second dense layer is the output of the model. Implementation of the model in Keras:", "The following image visualizes the architecture of the model:", "The knapsack problem requires metrics other than the binary classification accuracy for evaluation. The first metric we introduce is called \u201coverpricing\u201d. As its name suggests, it evaluates the average difference between the prices of the chosen items and the optimum solution. It is implemented in Keras framework as follow:", "Another vital metric is the amount of capacity used more than the knapsack\u2019s capacity. The \u201cspace violation\u201d is the positive difference between the sum of the chosen items\u2019 weights and the knapsack\u2019s capacity. It may be implemented in Keras as follow:", "In the supervised approach, we input weights and prices to the model and expect the optimum solution as the output. In this process the model trains using the cross-entropy loss function.", "After training the model with the supervised approach, we got the following results after 512 epochs.", "Unfortunately, there are two fundamental problems with the supervised approach:", "We will try to address these problems in the unsupervised approach.", "We want to train the model without computing the optimum solution. Hence, we need a new loss function. Accordingly, we subsequently define the w, p, c and o as the items\u2019 weights, the items\u2019 prices, the knapsack\u2019s capacity and the model\u2019s output. At first, we need to maximize the sum of chosen items\u2019 prices. It may be calculated via:", "Meanwhile, we want our picks not to surpass the knapsack\u2019s capacity. This value may be formulated via:", "Finally, we want to maximize the TotalPrice while minimizing SpaceViolation. This could be formulated via:", "In order to have control over the SpaceViolation, we add the \u03bb coefficient to the second term. The final loss formula is:", "We can implement the new loss in Keras like this:", "Using this loss function, we train the neural network in an unsupervised fashion.", "Note 1: The \u03bb parameter is named cvc in the Keras implementation of knapsack loss.", "Note 2: Although we receive the optimum solution (y_true) as a function argument, we do not use it for computing the loss. We can\u2019t either omit the argument as it is a Keras constraint to receive both predicted and expected outputs in the loss functions.", "Note3: The capacity of the knapsack is equal to 1 as we normalized the data.", "After training the model with the unsupervised approach, we got the following results after 512 epochs.", "Increasing the value of cvc (\u03bb) will cause in less space violation and overpricing. It will also reduce the binary accuracy if it is increased too much. I found that a reasonable value for it might be 5.75.", "As discussed before, we solved the problem of knapsack using neural networks while the gradient can pass through the network. So our model could be trained end to end using any variation of the back-propagation algorithm.", "This article could be used in recommender systems, especially the ones which recommends multiple items while maintaining space usage (like the banner Ads).", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8edd737bdc15&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@shshemi?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shshemi?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": "Shayan Hashemi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd27d5802c5e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&user=Shayan+Hashemi&userId=d27d5802c5e6&source=post_page-d27d5802c5e6----8edd737bdc15---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8edd737bdc15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8edd737bdc15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Knapsack_problem", "anchor_text": "Wikipedia"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----8edd737bdc15---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/knapsack-problem?source=post_page-----8edd737bdc15---------------knapsack_problem-----------------", "anchor_text": "Knapsack Problem"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----8edd737bdc15---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/tag/supervised-learning?source=post_page-----8edd737bdc15---------------supervised_learning-----------------", "anchor_text": "Supervised Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----8edd737bdc15---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8edd737bdc15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&user=Shayan+Hashemi&userId=d27d5802c5e6&source=-----8edd737bdc15---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8edd737bdc15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&user=Shayan+Hashemi&userId=d27d5802c5e6&source=-----8edd737bdc15---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8edd737bdc15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8edd737bdc15&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8edd737bdc15---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8edd737bdc15--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8edd737bdc15--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8edd737bdc15--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8edd737bdc15--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shshemi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@shshemi?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shayan Hashemi"}, {"url": "https://medium.com/@shshemi/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "17 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd27d5802c5e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&user=Shayan+Hashemi&userId=d27d5802c5e6&source=post_page-d27d5802c5e6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F14351f1eff7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-knapsack-8edd737bdc15&newsletterV3=d27d5802c5e6&newsletterV3Id=14351f1eff7&user=Shayan+Hashemi&userId=d27d5802c5e6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}