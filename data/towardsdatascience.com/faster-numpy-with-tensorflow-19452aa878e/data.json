{"url": "https://towardsdatascience.com/faster-numpy-with-tensorflow-19452aa878e", "time": 1683017029.660309, "path": "towardsdatascience.com/faster-numpy-with-tensorflow-19452aa878e/", "webpage": {"metadata": {"title": "Faster NumPy with TensorFlow. Significantly speed up your NumPy\u2026 | by Dimitris Poulopoulos | Towards Data Science", "h1": "Faster NumPy with TensorFlow", "description": "Significantly speed up your NumPy operations using Tensorflow and its new NumPy API"}, "outgoing_paragraph_urls": [{"url": "https://numpy.org/", "anchor_text": "NumPy", "paragraph_index": 0}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow", "paragraph_index": 3}, {"url": "https://numpy.org/doc/1.16", "anchor_text": "NumPy API", "paragraph_index": 4}, {"url": "https://www.tensorflow.org/api_docs/python/tf/experimental/numpy", "anchor_text": "tf.experimental.numpy", "paragraph_index": 4}, {"url": "https://www.dimpo.me/newsletter", "anchor_text": "Learning Rate", "paragraph_index": 5}, {"url": "https://www.dimpo.me/newsletter", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://www.tensorflow.org/guide/tf_numpy#performance_comparisons", "anchor_text": "benchmark experiment", "paragraph_index": 7}, {"url": "https://www.tensorflow.org/api_docs/python/tf/experimental/numpy", "anchor_text": "tf.experimental.numpy", "paragraph_index": 22}, {"url": "https://www.dimpo.me/newsletter", "anchor_text": "Learning Rate", "paragraph_index": 26}, {"url": "https://www.dimpo.me/newsletter", "anchor_text": "here", "paragraph_index": 26}, {"url": "https://www.linkedin.com/in/dpoulopoulos/", "anchor_text": "Dimitris Poulopoulos", "paragraph_index": 27}, {"url": "https://www.arrikto.com/", "anchor_text": "Arrikto", "paragraph_index": 27}, {"url": "https://www.linkedin.com/in/dpoulopoulos/", "anchor_text": "LinkedIn", "paragraph_index": 28}, {"url": "https://twitter.com/james2pl", "anchor_text": "@james2pl", "paragraph_index": 28}, {"url": "http://www.dimpo.me", "anchor_text": "www.dimpo.me", "paragraph_index": 30}], "all_paragraphs": ["NumPy (Numerical Python) is the most popular Python library in the Data Science world. Countless other Python modules are based on NumPy, as it provides a powerful API for working with arrays and several other operations, covering branches of mathematics like linear algebra and Fourier transform. As an attribution, NumPy was created in 2005 by Travis Oliphant and it is one of the most active open-source projects.", "In this story, we take NumPy a step further, increasing its execution speed using TensorFlow. This allows running NumPy code on GPU, accelerated by TensorFlow, while also allowing access to all of TensorFlow\u2019s APIs.", "But why should we use NumPy? In Python, we have lists that serve the purpose of arrays. You can always write a matrix multiplication algorithm using Python lists and a few for loops. Well, although you can do it doesn't mean you should.", "NumPy aims to provide an array object that is up to 50x faster than traditional Python lists. In NumPy, this object is called ndarray and it\u2019s the basic building block on the library. However, in this story, we take it a step further, increasing the speed of NumPy using TensorFlow.", "As of TF 2.4, TensorFlow implements a subset of the NumPy API, available as tf.experimental.numpy. This allows running NumPy code on GPU, accelerated by TensorFlow, while also allowing access to all of TensorFlow's APIs. So, let\u2019s go through the TF NumPy API step by step.", "Learning Rate is my weekly newsletter for those who are curious about the world of AI and MLOps. You\u2019ll hear from me every Friday with updates and thoughts on the latest AI news, research, repos and books. Subscribe here!", "Before diving into the details, I wanted to convince you that this is something that feels like it could be worth your time. The TensorFlow NumPy implementation uses highly optimized TensorFlow kernels, that can be dispatched on GPUs and TPUs. Also, TensorFlow performs many compiler optimizations, like operation fusion, which translate to performance and memory improvements.", "To compare the performance of raw NumPy against its TensorFlow counterpart, the TensorFlow team designed and ran a simple sigmoid benchmark experiment. The results in the following figure speak for themselves.", "So, if these results excite you, let\u2019s see how you can leverage this API to get similar performance.", "We are ready now to dive deeper into the API, explore how TF interoperates with NumPy, but also see what\u2019s still missing. So, what can we do with TF NumPy API?", "So, let\u2019s see some of these points in action.", "Using the TF implementation of NumPy we can place data and operations on CPUs, GPUs or even TPUs and remote devices. All we need to do is use standard TensorFlow mechanisms, such as the tf.device context manager.", "The last line proves that the operations took place on the GPU, that is if we have a GPU available:", "TensorFlow\u2019s GradientTape can be used to enable auto-differentiation for TensorFlow NumPy code. GradientTape APIs can also return ND array outputs. To watch this in action, let\u2019s define and instantiate a simple model:", "This model is a simple two-layer neural network, with a ReLU activation between the two linearities. Its weights (w1, w2, bias) are not TF variables, but TF ND arrays. The predict method simulates a forward pass through the layers of the network.", "Now we are ready to perform a forward pass through this model, calculate the loss and compute the gradients of the model, which, as we said previously, are not TF tensors, but TF ND arrays:", "The last line computes the gradients of the weights of the models, which we are watching with the gradient tape. We could now perform an update, using an optimizer like the Stochastic Gradient Descent.", "TensorFlow ND arrays can interoperate with NumPy functions and the other way around. However, the conversion of a TF ND array to and from a NumPy ND array may trigger actual data copies, slashing the performance.", "Despite the shortcomings, this is a powerful tool to work around cases where Tensorflow doesn\u2019t still support certain NumPy operations. Moreover, we can pass a TF ND array to functions that expect a NumPy ND array, like matplotlib\u2019s plotting functions.", "As we can see, a TF ND array can be passed to both a NumPy function (e.g., np.sum) and the plot method of matplotlib.", "But what about operator precedence? Well if you add a TF ND array with a NumPy ND array, the TF one takes precedence. Also, if you pass a TF ND array to a TensorFlow function, the return type will be a TensorFlow tensor. Thus, by design, TensorFlow data types have higher precedence than those of NumPy:", "Having said all that, this TensorFlow API is in an experimental phase and not every NumPy operation is supported. So, currently, TF does not support:", "The tf.experimental.numpy module will be available in the stable branch starting from TensorFlow 2.4. For now, we can get it by installing the nightly distribution:", "In this story, we saw how we can use the new TensorFlow NumPy API, to accelerate NumPy code and how TensorFlow can now interoperate with NumPy, as well as with other libraries that are expecting np.ndarray's as input.", "We also saw how to expand what you can do with NumPy, using auto-differentiation, to create and train a Machine Learning model from scratch, on GPU and using TensorFlow-related speed-up tricks, like compilation and auto-vectorization.", "You can test all these now by using the nightly TensorFlow distribution and it will be available in the stable branch starting from TensorFlow 2.4.", "Learning Rate is my weekly newsletter for those who are curious about the world of AI and MLOps. You\u2019ll hear from me every Friday with updates and thoughts on the latest AI news, research, repos and books. Subscribe here!", "My name is Dimitris Poulopoulos and I\u2019m a machine learning engineer working for Arrikto. I have worked on designing and implementing AI and software solutions for major clients such as the European Commission, Eurostat, IMF, the European Central Bank, OECD, and IKEA.", "If you are interested in reading more posts about Machine Learning, Deep Learning, Data Science and DataOps follow me on Medium, LinkedIn or @james2pl on Twitter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning Engineer. I talk about AI, MLOps, and Python programming. More about me: www.dimpo.me"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F19452aa878e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----19452aa878e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19452aa878e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dpoulopoulos.medium.com/?source=post_page-----19452aa878e--------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=post_page-----19452aa878e--------------------------------", "anchor_text": "Dimitris Poulopoulos"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cc87df5b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=post_page-7cc87df5b1----19452aa878e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19452aa878e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19452aa878e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jlxp?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Jean-Louis Paulin"}, {"url": "https://unsplash.com/s/photos/cube?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://numpy.org/", "anchor_text": "NumPy"}, {"url": "https://www.tensorflow.org/", "anchor_text": "TensorFlow"}, {"url": "https://numpy.org/doc/1.16", "anchor_text": "NumPy API"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/experimental/numpy", "anchor_text": "tf.experimental.numpy"}, {"url": "https://www.dimpo.me/newsletter", "anchor_text": "Learning Rate"}, {"url": "https://www.dimpo.me/newsletter", "anchor_text": "here"}, {"url": "https://www.tensorflow.org/guide/tf_numpy#performance_comparisons", "anchor_text": "benchmark experiment"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/experimental/numpy", "anchor_text": "tf.experimental.numpy"}, {"url": "https://www.dimpo.me/newsletter", "anchor_text": "Learning Rate"}, {"url": "https://www.dimpo.me/newsletter", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/dpoulopoulos/", "anchor_text": "Dimitris Poulopoulos"}, {"url": "https://www.arrikto.com/", "anchor_text": "Arrikto"}, {"url": "https://www.linkedin.com/in/dpoulopoulos/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/james2pl", "anchor_text": "@james2pl"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----19452aa878e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----19452aa878e---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----19452aa878e---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/numpy?source=post_page-----19452aa878e---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----19452aa878e---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19452aa878e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=-----19452aa878e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F19452aa878e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=-----19452aa878e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F19452aa878e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----19452aa878e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F19452aa878e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----19452aa878e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----19452aa878e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----19452aa878e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----19452aa878e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----19452aa878e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----19452aa878e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----19452aa878e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----19452aa878e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----19452aa878e--------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dpoulopoulos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dimitris Poulopoulos"}, {"url": "https://dpoulopoulos.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "12.5K Followers"}, {"url": "http://www.dimpo.me", "anchor_text": "www.dimpo.me"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cc87df5b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=post_page-7cc87df5b1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb5ab149102ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffaster-numpy-with-tensorflow-19452aa878e&newsletterV3=7cc87df5b1&newsletterV3Id=b5ab149102ea&user=Dimitris+Poulopoulos&userId=7cc87df5b1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}