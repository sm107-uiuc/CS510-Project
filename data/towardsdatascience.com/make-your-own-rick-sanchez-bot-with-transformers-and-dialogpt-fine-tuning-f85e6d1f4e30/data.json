{"url": "https://towardsdatascience.com/make-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30", "time": 1683008822.053477, "path": "towardsdatascience.com/make-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30/", "webpage": {"metadata": {"title": "Make your own Rick Sanchez (bot) with Transformers and DialoGPT fine-tuning | by Rostyslav Neskorozhenyi | Towards Data Science", "h1": "Make your own Rick Sanchez (bot) with Transformers and DialoGPT fine-tuning", "description": "Teach GPT-2 to write like a mad scientist. By Rostyslav Neskorozhenyi"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Rick_and_Morty", "anchor_text": "Rick and Morty", "paragraph_index": 0}, {"url": "https://huggingface.co/transformers/", "anchor_text": "Transformers", "paragraph_index": 4}, {"url": "https://huggingface.co/transformers/model_doc/bert.html", "anchor_text": "BERT", "paragraph_index": 4}, {"url": "https://huggingface.co/transformers/model_doc/xlnet.html", "anchor_text": "XLNet", "paragraph_index": 4}, {"url": "https://huggingface.co/transformers/model_doc/gpt2.html", "anchor_text": "GPT-2", "paragraph_index": 4}, {"url": "http://jalammar.github.io/illustrated-transformer/", "anchor_text": "article", "paragraph_index": 4}, {"url": "https://huggingface.co/transformers/model_doc/dialogpt.html", "anchor_text": "DialoGPT", "paragraph_index": 5}, {"url": "http://jalammar.github.io/illustrated-gpt2/", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab", "paragraph_index": 6}, {"url": "https://github.com/huggingface/transformers/blob/master/examples/language-modeling/run_language_modeling.py", "anchor_text": "script", "paragraph_index": 11}, {"url": "https://nathancooper.io/i-am-a-nerd/chatbot/deep-learning/gpt2/2020/05/12/chatbot-part-1.html", "anchor_text": "tutorial", "paragraph_index": 11}, {"url": "https://www.kaggle.com/andradaolteanu/sentiment-analysis-rick-and-morty-scripts/", "anchor_text": "article", "paragraph_index": 13}, {"url": "https://github.com/ghhernandes/rickmorty-gan/tree/master/data", "anchor_text": "text dataset", "paragraph_index": 13}, {"url": "https://github.com/Kaggle/kaggle-api", "anchor_text": "link", "paragraph_index": 14}, {"url": "https://www.kaggle.com/andradaolteanu/sentiment-analysis-rick-and-morty-scripts/", "anchor_text": "article", "paragraph_index": 14}, {"url": "https://huggingface.co/blog/how-to-generate", "anchor_text": "link", "paragraph_index": 24}, {"url": "https://colab.research.google.com/drive/15wa925dj7jvdvrz8_z3vU7btqAFQLVlG", "anchor_text": "Google Colab notebook", "paragraph_index": 31}], "all_paragraphs": ["I am a big fan of \u2018Rick and Morty\u2019 and NLP (Natural Language Processing). After watching the last episode of a mad scientist\u2019s and his grandson\u2019s adventures I realized that I have to apply my knowledge in NLP and Machine Learning to create my own Rick (in a form of chat-bot, at least for now).", "The path to creating virtual Rick was not easy. I tried many models and approaches but virtual Rick did not want to find a common language with me for a long time. Rick\u2019s first response to my greeting was \u201cI am not your buddy\u201d (to tell you the truth, in the beginning, he knew only this phrase). But I did not give up and with the help of excellent Transformers library and Microsoft\u2019s Large-scale Pretrained Response Generation Model (DialoGPT) I managed to talk heart-to-heart with Rick. Here is one of our conversations:", "User:Hey, Rick, make me a time machine RickBot: You\u2019re a monster! User:No, I just want to travel in time RickBot: To the past. User:yes RickBot: No time machine, please. User:But I need it RickBot: You don\u2019t need it, Morty. Just do it. User:I want to see ancient Greece RickBot: Oh, geez.", "In this article, I will tell you how to create a virtual character whose statements will be based on a transcript of my favorite animated science fiction sitcom. You can use characters and sitcoms of your choice. I added code to convert a regular text file with dialogs into a format that the model understands.", "As I already mentioned, the Transformers library, which contains the latest NLP models (such as BERT, XLNet, GPT-2) will help us in our task. You can read more about transformers in a beautifully illustrated article by Jay Alammar.", "Not so long ago, Microsoft\u2019s DialoGPT was added to the Transformers model collection. DialoGPT is a GPT-2 model, trained on 147M multi-turn dialogue from Reddit discussion thread (you can learn more about GPT-2 here). This model is ideally suited for creating a virtual character for a fascinating conversation and even in the small implementation option, it can maintain a coherent dialogue, which we will see now.", "We will conduct all our experiments in Google Colab, its resources are enough to train the small DialoGPT model. Firstly, we will connect to Google Drive and install the necessary modules.", "Let\u2019s move to the desired folder in which we will store all our data.", "Try to chat with DialoGPT without fine-tuning.", "User:Hi Rick DialoGPT: Hi Rick User:How are you? DialoGPT: I\u2019m good, how are you? User:I am fine. Where is Morty? DialoGPT: He\u2019s in the basement. User:Who is Morty? DialoGPT: He\u2019s a Morty. User:Who are you? DialoGPT: I am a Morty.", "Not bad but not too impressive. We will fix it with fine-tuning.", "Let\u2019s train our own Rick chatbot. For a start, we will need basic configuration and a dataset. Configuration and training scripts are mostly based on this script from Huggingface and great tutorial from Nathan Cooper.", "Class Args for conversion of Python script arguments to Colab notebook.", "Our dialogues dataset will be based on a dataset used in Andrada Olteanu\u2019s article about Rick and Morty sentiment analysis. Big thanks to her work and also to Gabriel Hernandes, author of original text dataset!", "First of all, we will use a Kaggle module to download the needed dataset. You can read in more detail about the module and how to get a Kaggle API Token by this link. Or you can just download RickAndMortyScripts.csv file from this article and place this file in your working directory.", "Let\u2019s look at the original dataset.", "We will convert this dataset in a way that every response row will contain n previous responses as a context. For our purposes, seven previous responses will be enough.", "Split our dataset into training and test parts.", "Now we will convert our dataset in a format suitable for our model. Basically we will concatenate responses in one string for each row (additionally we will add special \u2018end of string\u2019 token between responses, so the model will understand the end of each response in a string).", "There will be quite a lot of code needed for training our model but don\u2019t worry, everything should work as is, the main thing is to give the model the dataset in the right format.", "And here is the main runner code.", "It is time to train our model!", "Our dataset is quite small so training will not take a lot of time (usually \u2014 about a half an hour).", "The model is ready, so it\u2019s time to chat with Rick. But don\u2019t forget that Rick can be rude, I warned you.", "A variety of methods can be used in responses generation. You can find more details about these methods by this link.", "User:How are you, Rick? RickBot: I\u2019m fine. User:Where is Morty? RickBot: He\u2019s in a hospital. User:Why? RickBot: Well, that depends on who breaks first \u2014 me or the hospital. I mean, you know, the one that keeps giving me pills. User:I don\u2019t understand RickBot: Whoa! Whoa! User:I see, you took your pills RickBot: Hey, I-I\u2019m not proud of this.", "Not bad. I will give examples of a few more dialogues to show how Ricky is our Rick now.", "User:Who are you? RickBot: A musician, I\u2019m not a musician, but I\u2019m pretty close to you. User:What kind of musician are you? RickBot: Who cares? I\u2019m a musician. User:Ok, play a song for me RickBot: Shut up and listen to me, Morty. Listen to me. Listen! I\u2019m the leader of a bunch of different death worlds, and I\u2019m just trying to assemble a band. I\u2019m gonna make this one-piece, and you\u2019re gonna be part of it. User:ok RickBot: Whoa, whoa, hey, who\u2019s this? User:This is Morty RickBot: Geez!!!", "User:What do you think about Elon Musk? RickBot: I think about him a lot. User:But what exactly do you think? RickBot: He\u2019s not a bad guy. He\u2019s just\u2026 not a very charismatic one. User:I think he is charismatic RickBot: He is. User:What else you can say about him? RickBot: You don\u2019t have to say anything. He is the leader of your class. User:ok, thank you RickBot: !!!", "Congratulations! Our virtual Rick is alive (almost)! With the help of fine-tuning of DialoGPT model on a small dataset, we were able to create a virtual character with whom we can make a lot of mad dialogs.", "Using the proposed approach we can create many interesting virtual characters based on an arbitrary dialogs dataset (just a csv file with characters speeches, one speech per line).", "All mentioned code is accessible as a Google Colab notebook.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff85e6d1f4e30&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@slanjr?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@slanjr?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": "Rostyslav Neskorozhenyi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c7f264e81e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&user=Rostyslav+Neskorozhenyi&userId=8c7f264e81e5&source=post_page-8c7f264e81e5----f85e6d1f4e30---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff85e6d1f4e30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff85e6d1f4e30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Rick_and_Morty", "anchor_text": "Rick and Morty"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://huggingface.co/transformers/", "anchor_text": "Transformers"}, {"url": "https://huggingface.co/transformers/model_doc/bert.html", "anchor_text": "BERT"}, {"url": "https://huggingface.co/transformers/model_doc/xlnet.html", "anchor_text": "XLNet"}, {"url": "https://huggingface.co/transformers/model_doc/gpt2.html", "anchor_text": "GPT-2"}, {"url": "http://jalammar.github.io/illustrated-transformer/", "anchor_text": "article"}, {"url": "http://jalammar.github.io/illustrated-transformer/", "anchor_text": "http://jalammar.github.io"}, {"url": "https://huggingface.co/transformers/model_doc/dialogpt.html", "anchor_text": "DialoGPT"}, {"url": "http://jalammar.github.io/illustrated-gpt2/", "anchor_text": "here"}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://github.com/huggingface/transformers/blob/master/examples/language-modeling/run_language_modeling.py", "anchor_text": "script"}, {"url": "https://nathancooper.io/i-am-a-nerd/chatbot/deep-learning/gpt2/2020/05/12/chatbot-part-1.html", "anchor_text": "tutorial"}, {"url": "https://www.kaggle.com/andradaolteanu/sentiment-analysis-rick-and-morty-scripts/", "anchor_text": "article"}, {"url": "https://github.com/ghhernandes/rickmorty-gan/tree/master/data", "anchor_text": "text dataset"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://github.com/Kaggle/kaggle-api", "anchor_text": "link"}, {"url": "https://www.kaggle.com/andradaolteanu/sentiment-analysis-rick-and-morty-scripts/", "anchor_text": "article"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://huggingface.co/blog/how-to-generate", "anchor_text": "link"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://news.knowyourmeme.com/news/elon-musks-rick-and-morty-cameo-is-a-meme-reference", "anchor_text": "news.knowyourmeme.com"}, {"url": "https://giphy.com/", "anchor_text": "Giphy"}, {"url": "https://colab.research.google.com/drive/15wa925dj7jvdvrz8_z3vU7btqAFQLVlG", "anchor_text": "Google Colab notebook"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f85e6d1f4e30---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f85e6d1f4e30---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----f85e6d1f4e30---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/nlp?source=post_page-----f85e6d1f4e30---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/transformers?source=post_page-----f85e6d1f4e30---------------transformers-----------------", "anchor_text": "Transformers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff85e6d1f4e30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&user=Rostyslav+Neskorozhenyi&userId=8c7f264e81e5&source=-----f85e6d1f4e30---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff85e6d1f4e30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&user=Rostyslav+Neskorozhenyi&userId=8c7f264e81e5&source=-----f85e6d1f4e30---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff85e6d1f4e30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff85e6d1f4e30&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f85e6d1f4e30---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f85e6d1f4e30--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@slanjr?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@slanjr?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rostyslav Neskorozhenyi"}, {"url": "https://medium.com/@slanjr/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "134 Followers"}, {"url": "https://www.linkedin.com/in/slanj/", "anchor_text": "https://www.linkedin.com/in/slanj/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c7f264e81e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&user=Rostyslav+Neskorozhenyi&userId=8c7f264e81e5&source=post_page-8c7f264e81e5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3835a199cf2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmake-your-own-rick-sanchez-bot-with-transformers-and-dialogpt-fine-tuning-f85e6d1f4e30&newsletterV3=8c7f264e81e5&newsletterV3Id=3835a199cf2e&user=Rostyslav+Neskorozhenyi&userId=8c7f264e81e5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}