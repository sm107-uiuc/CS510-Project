{"url": "https://towardsdatascience.com/understanding-cnn-convolutional-neural-network-69fd626ee7d4", "time": 1683002318.605365, "path": "towardsdatascience.com/understanding-cnn-convolutional-neural-network-69fd626ee7d4/", "webpage": {"metadata": {"title": "Understanding CNN (Convolutional Neural Network) | by Vincent Tatan | Towards Data Science", "h1": "Understanding CNN (Convolutional Neural Network)", "description": "Our brains are the master at determining objects quickly. When you enter a grocery store, you can separate bananas from other goods such as shoes. My 2 year old niece knew how to differentiate cats\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/hub", "anchor_text": "Tensorflow Hub", "paragraph_index": 35}, {"url": "https://bit.ly/2I8jkWV.?source=post_page---------------------------", "anchor_text": ".", "paragraph_index": 43}, {"url": "http://www.linkedin.com/in/vincenttatan/?source=post_page---------------------------", "anchor_text": "LinkedIn", "paragraph_index": 47}, {"url": "https://medium.com/@vincentkernn?source=post_page---------------------------", "anchor_text": "Medium", "paragraph_index": 47}, {"url": "https://www.youtube.com/user/vincelance1/videos?source=post_page---------------------------", "anchor_text": "Youtube Channel", "paragraph_index": 47}], "all_paragraphs": ["Imagine Google Photos: for all of the pictures you have, how do you label those by objects. Do you want to tag them one by one? Is it possible to do a search on your latest Chicken Maryland snapshots? Enter CNN!", "Image classification defines image objects and labeled these images from labeled examples.", "Our brains are the master at determining objects quickly. When you enter a grocery store, you can separate bananas from other goods such as shoes. My 2 year old niece knew how to differentiate cats and dogs.", "Yet to teach those classifications with computer is very hard.", "Take a look into these images. Within a few glimpse, you should have realized that in the middle of cat images, there are a few actresses from the musical theatre \u201cCats\u201d. There are also a few which are the pictures of cat doodles but not cats. So how do we teach our computers to understand these images?", "In the past, image classification models used raw pixels to classify the images. You can classify cats by color histogram and edge detection which allows you to classify cats by color and ear shape. This method has been successful but until the method encounters more complex variants.", "That\u2019s where the classical image recognition fails because the model does not account for other features. But what are these other features? Do you need to tell the model one by one? You will find it a great hassle if not impossible.", "CNN is a type of neural network model which allows us to extract higher representations for the image content. Unlike the classical image recognition where you define the image features yourself, CNN takes the image\u2019s raw pixel data, trains the model, then extracts the features automatically for better classification.", "Let\u2019s take a look at the following optical illusion to understand how CNN works.", "Consider this image. Do you see a young lady or a grandma? If you start your focus on a dot in the middle of an image, you would see a young lady. However, if you focus on the black strip in the middle-bottom of the image, you will see an old lady. Look at the red boxes on the image.", "This picture provides an insight on how humans recognize images. Because the human brain is designed to capture patterns in order to classify an object, changing the points where you focus your observation also changes your interpretation of the overall image.", "Similar to how the human brain works, CNN distinguishes meaningful features in an image in order to classify the image as a whole.", "A convolution sweeps the window through images then calculates its input and filter dot product pixel values. This allows convolution to emphasize the relevant features.", "Look at this input. We will encase the window elements with a small window, dot multiplies it with the filter elements, and save the output. We will repeat each operation to derive 5 output elements as [0,0,0,1,0]. From this output, we can know that the feature change(1 becomes 0) in sequence 4. The filter has done well to identify the input values. Similarly, this happened for 2D Convolutions as well.", "With this computation, you detect a particular feature from the input image and produce feature maps (convolved features) which emphasizes the important features. These convolved features will always change depending on the filter values affected by the gradient descent to minimize prediction loss.", "Furthermore, The more filters deployed, the more features that CNN will extract. This allows more features found but with the cost of more training time. There is a sweet spot for the number of layers, usually, I will put 6 for 150 x 150 size of image.", "However, what about the corner or side values. They do not have enough adjacent blocks to fit the filter. Should we remove them?", "No, because you would lose important information. Therefore, what you want to do instead is padding; you pad the adjacent feature map output with 0. By inserting 0 to its adjacent, you no longer need to exclude these pixels.", "Essentially, these convolution layers promote weight sharing to examine pixels in kernels and develop visual context to classify images. Unlike Neural Network (NN) where the weights are independent, CNN\u2019s weights are attached to the neighboring pixels to extract features in every part of the image.", "CNN uses max pooling to replace output with a max summary to reduce data size and processing time. This allows you to determine features that produce the highest impact and reduces the risk of overfitting.", "Max pooling takes two hyperparameters: stride and size. The stride will determine the skip of value pools while the size will determine how big the value pools in every skip.", "After each convolutional and max pooling operation, we can apply Rectified Linear Unit (ReLU). The ReLU function mimics our neuron activations on a \u201cbig enough stimulus\u201d to introduce nonlinearity for values x>0 and returns 0 if it does not meet the condition. This method has been effective to solve diminishing gradients. Weights that are very small will remain as 0 after the ReLU activation function.", "Finally, we will serve the convolutional and max pooling feature map outputs with Fully Connected Layer (FCL). We flatten the feature outputs to column vector and feed-forward it to FCL. We wrap our features with softmax activation function which assign decimal probabilities for each possible label which add up to 1.0. Every node in the previous layer is connected to the last layer and represents which distinct label to output.", "The end results? You will be able to classify the dogs and cat images as below.", "Unfortunately, CNN is not immune to overfitting. If not monitored properly, the model can get trained too much that it could not generalize unseen data. Through my experiences, I have made many beginner overfitting mistakes and how I resolve them as following:", "Even though we do not use the test set to train the model, the model could adjust the loss function with the test set. This will base the training on the test dataset and is a common cause of overfitting. Therefore, during the training, we need to use validation sets then ultimately test the finished model with the unseen test set.", "When dataset is small, it is very easy to specialize onto a few set of rules and forget to generalize. For example, if your model only sees boots as shoes, then the next time you show high heels, it would not recognize them as shoes.", "Therefore, in the case of small training data set, you need to artificially boost the diversity and number of training examples. One way of doing this is to add image augmentations and creating new variants. These include translating images and creating dimension changes such as zoom, crop, flips, etc.", "Too many neurons, layers, and training epochs promote memorization and inhibit generalize. The more you train your model, the more likely it becomes too specialized. To counter this, you could reduce the complexity by removing a few hidden layers and neurons per layer.", "Alternatively, you could also use regularization techniques such as Dropout to remove activation unit in every gradient step training. Each epoch training deactivates different neurons.", "Since the number of gradient steps is usually high, all neurons will averagely have same occurrences for dropout. Intuitively, the more you drop out, the less likely your model memorizes.", "You can also easily include images with 3 layers of color channels: Red Green Blue (RGB). During convolution, you use 3 separate convolutions for each color channel and train 3-level stack of filters. This allows you to retrieve 3D feature maps.", "As the use cases become complex, the complexity of the model needs to improve as well. With a few layers of CNN, you could determine simple features to classify dogs and cats. However, at the deep learning stage, you might want to classify more complex objects from images and use more data. Therefore, rather than training them yourself, transfer learning allows you to leverage existing models to classify quickly.", "Transfer learning is a technique that reuses an existing model to the current model. You could produce on top of existing models that were carefully designed by experts and trained with millions of pictures.", "However, there are a few caveats that you need to follow. First, you need to modify the final layer to match the number of possible classes. Second, you will need to freeze the parameters and set the trained model variables to immutable. This prevents the model from changing significantly.", "One famous Transfer Learning that you could use is MobileNet. It is created for mobile devices which have less memory and computational resources. You can find MobileNet in Tensorflow Hub which gathers many pretrained models. You can just simply add your own FCL Layer on top of these models.", "CNN is a tough subject but a rewarding technique to learn. It teaches us how we perceive images and learn useful applications to classify images and videos. After learning CNN, I realized that I could use this for my project at Google to detect phishing attacks.", "I also realized that the knowledge for CNN is very deep. Over the years, there are many improvements in CNN variations including one of the latest \u2014 ResNet \u2014 which even beats human reviewers in ImageNet Classifications.", "For me, I am writing this article to explore my basic understanding of CNN for a project I work at Google. Therefore, feel free to give me any feedback if I made any mistakes or knowledge gaps in my writing. Soli Deo Gloria.", "I sincerely hope this pique your interest to learn deeper about CNN. If you do, here are some resources which you might find very useful:", "I really hope this has been a great read and a source of inspiration for you to develop and innovate.", "Please Comment out below for suggestions and feedback. Just like you, I am still learning how to become a better Data Scientist and Engineer. Please help me improve so that I could help you better in my subsequent article releases.", "Thank you and Happy coding :)", "Vincent Tatan is a Data and Technology enthusiast with relevant working experiences from Google LLC, Visa Inc. and Lazada to implement microservice architectures, business intelligence, and analytics pipeline projects.", "Vincent is a native Indonesian with a record of accomplishments in problem-solving with strengths in Full Stack Development, Data Analytics, and Strategic Planning.", "He has been actively consulting SMU BI & Analytics Club, guiding aspiring data scientists and engineers from various backgrounds, and opening up his expertise for businesses to develop their products.", "Vincent also opens up his 1 on 1 mentorship service on 10to8 to coach how you can land your dream Data Scientist/Engineer Job at Google, Visa or other large tech companies.", "Lastly, please reach out to Vincent via LinkedIn, Medium or Youtube Channel", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I fight phishing with ML @ Google. I use advanced ML algorithms and MLOps to protect Chrome, Gmail and Android users. Please reach out to me on Linkedin."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F69fd626ee7d4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vincentkernn?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": "Vincent Tatan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9848578f8495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&user=Vincent+Tatan&userId=9848578f8495&source=post_page-9848578f8495----69fd626ee7d4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69fd626ee7d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69fd626ee7d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/fYnyfx3UBxk", "anchor_text": "Unsplash"}, {"url": "https://github.com/PetarV-/TikZ/tree/master/2D%20Convolution", "anchor_text": "Source"}, {"url": "https://stackoverflow.com/questions/52741291/creating-a-cnn-model-in-keras-with-feature-maps-from-each-of-the-previous-filter", "anchor_text": "source"}, {"url": "http://cs231n.github.io/convolutional-networks/", "anchor_text": "source"}, {"url": "https://colab.sandbox.google.com/drive/1v0VWuWnmP1Ns-PAUCiksxbzpy3AopXjc", "anchor_text": "Source"}, {"url": "https://www.javatpoint.com/pytorch-data-augmentation-process", "anchor_text": "Source"}, {"url": "https://www.tensorflow.org/hub", "anchor_text": "Tensorflow Hub"}, {"url": "http://yann.lecun.com/exdb/publis/pdf/lecun-99.pdf", "anchor_text": "Yann LeCun\u2019s paper of CNN"}, {"url": "http://cs231n.github.io/convolutional-networks/", "anchor_text": "CS 231 Stanford"}, {"url": "https://developers.google.com/machine-learning/practica/image-classification/convolutional-neural-networks", "anchor_text": "Google ML CNN"}, {"url": "https://bit.ly/2I8jkWV.?source=post_page---------------------------", "anchor_text": "."}, {"url": "https://forms.gle/iyo4oJtqKpQ1MgWy5", "anchor_text": "Please inform him if you need referrals to Google. Google is hiring!"}, {"url": "https://somtrbdynishjjjdkn.10to8.com/", "anchor_text": "Book your appointment with him here"}, {"url": "http://www.linkedin.com/in/vincenttatan/?source=post_page---------------------------", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/@vincentkernn?source=post_page---------------------------", "anchor_text": "Medium"}, {"url": "https://www.youtube.com/user/vincelance1/videos?source=post_page---------------------------", "anchor_text": "Youtube Channel"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----69fd626ee7d4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----69fd626ee7d4---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----69fd626ee7d4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/analytics?source=post_page-----69fd626ee7d4---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/productivity?source=post_page-----69fd626ee7d4---------------productivity-----------------", "anchor_text": "Productivity"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F69fd626ee7d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&user=Vincent+Tatan&userId=9848578f8495&source=-----69fd626ee7d4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F69fd626ee7d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&user=Vincent+Tatan&userId=9848578f8495&source=-----69fd626ee7d4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69fd626ee7d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F69fd626ee7d4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----69fd626ee7d4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----69fd626ee7d4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vincentkernn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vincent Tatan"}, {"url": "https://medium.com/@vincentkernn/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9848578f8495&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&user=Vincent+Tatan&userId=9848578f8495&source=post_page-9848578f8495--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba9496ed2fd5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-cnn-convolutional-neural-network-69fd626ee7d4&newsletterV3=9848578f8495&newsletterV3Id=ba9496ed2fd5&user=Vincent+Tatan&userId=9848578f8495&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}