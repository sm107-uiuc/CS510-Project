{"url": "https://towardsdatascience.com/importing-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6", "time": 1683003540.799961, "path": "towardsdatascience.com/importing-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6/", "webpage": {"metadata": {"title": "Importing DynamoDB Data Using Apache Hive on Amazon EMR | by Yi Ai | Towards Data Science", "h1": "Importing DynamoDB Data Using Apache Hive on Amazon EMR", "description": "This article describes one of the many ways to import data into AWS DynamoDB database. The option explained here uses Amazon EMR and Hive. Using Amazon EMR and Hive you can quickly and efficiently\u2026"}, "outgoing_paragraph_urls": [{"url": "https://serverless.com/", "anchor_text": "Serverless Framework", "paragraph_index": 2}, {"url": "https://docs.aws.amazon.com/emr/latest/ReleaseGuide/EMR_Hive_Optimizing.html", "anchor_text": "EMR document", "paragraph_index": 13}, {"url": "https://github.com/yai333/emr-dynamodb-import", "anchor_text": "GitHub repo", "paragraph_index": 20}], "all_paragraphs": ["This article describes one of the many ways to import data into AWS DynamoDB database. The option explained here uses Amazon EMR and Hive. Using Amazon EMR and Hive you can quickly and efficiently process large amounts of data, such as importing data from Amazon S3 into a DynamoDB table.", "The following diagram shows the architecture of the process.", "Before getting started, Install the Serverless Framework. Open up a terminal and type npm install -g serverless.", "There is a yml file (serverless.yml) in the project directory. Let\u2019s start to define a set of objects in template file as below:", "There are 2 S3 buckets, LogBucket is for EMR logs, S3BucketCsvimport is to store csv files.", "A DynamoDB table to load csv data from S3.", "Adding lambda function configuration to serverless.yml. it will be triggered by S3 new objected created event, the lambda function will then start a EMR job flow to process data importing.", "We also need to create IAM role for the lambda function, so our lambda function has permission to start EMR job flow.", "Let\u2019s add a lambda function to create an AWS EMR cluster and adding the step details such as the location of the hive scripts, arguments etc. We can use the boto3 lib for EMR, in order to create a cluster and submit the job dynamically from lambda function.", "We will create an external Hive table that maps to the csv data file.", "Establish a mapping between Hive and the Features table in DynamoDB.", "Add current date as partition and load table with csv data in S3.", "Using following Hive script to write data from Amazon S3 to DynamoDB.", "Note that Amazon EMR operations on a DynamoDB table count as read/write operations, and are subject to the table\u2019s provisioned throughput settings. for more details please visit EMR document.", "After script deployed, copy a csv file to S3 bucket with created_date={CURRENT_DATE}prefix, eg.", "Then we can go to AWS EMR console and check the progress of the EMR steps.", "It will take several minutes to complete all the steps and cluster will terminate automatically after running above steps.", "Next We can go to AWS DynamoDB console to verify that the data has been loaded into DynamoDB:", "Eventually Importing process took about 6 mins to load 1000 records total 76kb into DynamoDB table with write capacity units 10 and no auto scaling enabled.", "That\u2019s about it, Thanks for reading!", "I hope you have found this article useful, You can find the complete project in my GitHub repo.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AWS Community Builder | AWS AZURE GCP Certified Engineer | A Cloud Technology Enthusiast | AWS Certified Security/Machine Learning/Database Analytics Specialty"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F651d468898c6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----651d468898c6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----651d468898c6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yia333.medium.com/?source=post_page-----651d468898c6--------------------------------", "anchor_text": ""}, {"url": "https://yia333.medium.com/?source=post_page-----651d468898c6--------------------------------", "anchor_text": "Yi Ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22047a0ec61b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&user=Yi+Ai&userId=22047a0ec61b&source=post_page-22047a0ec61b----651d468898c6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F651d468898c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F651d468898c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@clesulie", "anchor_text": "Collins Lesulie"}, {"url": "https://unsplash.com/photos/-OZcGk5lD7U", "anchor_text": "Unsplash"}, {"url": "https://serverless.com/", "anchor_text": "Serverless Framework"}, {"url": "https://serverless.com/", "anchor_text": "Serverless Framework"}, {"url": "https://docs.aws.amazon.com/emr/latest/ReleaseGuide/EMR_Hive_Optimizing.html", "anchor_text": "EMR document"}, {"url": "https://github.com/yai333/emr-dynamodb-import", "anchor_text": "GitHub repo"}, {"url": "https://medium.com/tag/emr?source=post_page-----651d468898c6---------------emr-----------------", "anchor_text": "Emr"}, {"url": "https://medium.com/tag/aws?source=post_page-----651d468898c6---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/hadoop?source=post_page-----651d468898c6---------------hadoop-----------------", "anchor_text": "Hadoop"}, {"url": "https://medium.com/tag/hive?source=post_page-----651d468898c6---------------hive-----------------", "anchor_text": "Hive"}, {"url": "https://medium.com/tag/dynamodb?source=post_page-----651d468898c6---------------dynamodb-----------------", "anchor_text": "Dynamodb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F651d468898c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&user=Yi+Ai&userId=22047a0ec61b&source=-----651d468898c6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F651d468898c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&user=Yi+Ai&userId=22047a0ec61b&source=-----651d468898c6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F651d468898c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----651d468898c6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F651d468898c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----651d468898c6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----651d468898c6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----651d468898c6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----651d468898c6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----651d468898c6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----651d468898c6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----651d468898c6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----651d468898c6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----651d468898c6--------------------------------", "anchor_text": ""}, {"url": "https://yia333.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yia333.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yi Ai"}, {"url": "https://yia333.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "318 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F22047a0ec61b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&user=Yi+Ai&userId=22047a0ec61b&source=post_page-22047a0ec61b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feb2bd512dbe0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimporting-dynamodb-data-using-apache-hive-on-amazon-emr-651d468898c6&newsletterV3=22047a0ec61b&newsletterV3Id=eb2bd512dbe0&user=Yi+Ai&userId=22047a0ec61b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}