{"url": "https://towardsdatascience.com/backtesting-with-python-109cab7ee737", "time": 1683004598.670204, "path": "towardsdatascience.com/backtesting-with-python-109cab7ee737/", "webpage": {"metadata": {"title": "Backtesting with Python. Backtesting Moving Averages | by Jose Manu (CodingFun) | Towards Data Science", "h1": "Backtesting with Python", "description": "In this post, we will perform backtesting with Python on a simple moving average (MA) strategy. In one of my latest posts, I showed how to compute and plot a moving average strategy using Python\u2026"}, "outgoing_paragraph_urls": [{"url": "https://codingandfun.com/moving-average-technical-analysis/", "anchor_text": "In one of my latest posts,", "paragraph_index": 0}, {"url": "https://codingandfun.com/moving-average-technical-analysis/", "anchor_text": "this post", "paragraph_index": 2}, {"url": "https://economictimes.indiatimes.com/markets/stocks/news/moving-average-trading-rules/articleshow/71749811.cms?from=mdr", "anchor_text": "article", "paragraph_index": 10}, {"url": "https://economictimes.indiatimes.com/markets/stocks/news/moving-average-trading-rules/articleshow/71749811.cms?utm_source=contentofinterest&utm_medium=text&utm_campaign=cppst", "anchor_text": "ie we start the trade only after it is confirmed by one more day\u2019s closing", "paragraph_index": 10}, {"url": "https://twitter.com/CodingandF", "anchor_text": "my Twitter account.", "paragraph_index": 24}], "all_paragraphs": ["In this post, we will perform backtesting with Python on a simple moving average (MA) strategy. In one of my latest posts, I showed how to compute and plot a moving average strategy using Python. Now, we will learn to simulate how the moving average strategy performs over the last few months by backtesting our algorithm.", "Let\u2019s first quickly recap what we built in the previous post. Our model was simple, we built a script to calculate and plot a short moving average (20 days) and long moving average (250 days).", "I recommend you have a look at this post to learn more in detail about moving averages and how to build the Python script. In this post, I will only post the code to get the moving averages and the stock prices of the selected stock:", "To perform the backtesting we will:", "It is a very simple strategy. We will have daily close prices for the selected stock. The strategy could also be used with minutes or hourly data but I will keep it simple and perform the backtesting based on daily data.", "Since I do not expect to have many entry points, that is when we buy the stocks, I will ignore the transaction costs for simplicity.", "Remember from our previous post, that if we run the script by passing the name of the stock to analyse as an argument, we will get a Pandas DataFrame called stockprices containing the closing price and moving averages from the last 1,200 days.", "To build our backtesting strategy, we will start by creating a list which will contain the profit for each of our long positions.", "First (1), we create a new column that will contain True for all data points in the data frame where the 20 days moving average cross above the 250 days moving average.", "Of course, we are only interested in the first or second day when the crossover happens (i.e. 20 days MA goes over 250 days MA). Therefore, we locate the first or second date (rows) where the crossover happens (2).", "As well stated in this article, we will use the two-day rule ( ie we start the trade only after it is confirmed by one more day\u2019s closing), and will keep the date as the entry point only if the 20 days MA is above 250 days MA two days in a row.", "This approach will help us to avoid daily trading noise fluctuations. When this happens, we will have the entry points in the column firstbuy where the value equals to True:", "The rule (stockprices[\u2018buy\u2019].shift(2) == False), helps us to find out the first date after the crossover has happened.", "Now we have in the variable buyingpoints (3), the dates where we should enter the market with our long strategy.", "Each of the elements in the array buyingpoints represent the row where we need to go long. Therefore, we can loop through them to get the close price and buy 100 stocks (4).", "Then, we keep the stocks for 20 days (5) and sell the 100 stocks at +20 days close price.", "Finally, we calculate the profit and add the result of the strategy to the longpositionprofit array (6).", "To find out how we did with our strategy, we can print out the long position profit list and calculate the sum:", "Great, our backtesting strategy for Apple, show us that over 1,200 days, we entered a long position and sell after 20 days a total of three times.", "On the first occasion, we got a profit from $307, on the second occasion, $970 and in the last long position, we amounted to a profit of $1,026. That makes a total of $2,100.", "Not bad at all. But what if we just had bought the stock 1,200 days ago and keep until today? We can easily calculate the profit of buying and holding by getting the last available price and the first available price in our stockprices DataFrame.", "Interestingly, by just holding the stock for 1,200 days, our profit would have been $15,906 plus the annual dividends. Much higher than if we had followed the moving average strategy.", "We have used a simple strategy of buying the stock when the 20 days MA crosses above the 250 days MA. Then, we kept the stock for 20 days before selling it.", "There are other strategies that we may have followed. For instance, we could have bought the stocks when the moving average Crossover took place and kept the stock until the end. Or, we could have just sold the stock if the 250 days moving average crosses below the 20 days moving average.", "I will let you know to play around and test these other strategies. Happy to get your feedback on my Twitter account.", "See below the whole Python script for backtesting moving average strategies for any company. Just replace Apple by any other company stockpriceanalysis(\u2018aapl\u2019)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Python for Finance. Learn step by step how to automate cool financial analysis tools."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F109cab7ee737&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----109cab7ee737--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----109cab7ee737--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://codingfun89.medium.com/?source=post_page-----109cab7ee737--------------------------------", "anchor_text": ""}, {"url": "https://codingfun89.medium.com/?source=post_page-----109cab7ee737--------------------------------", "anchor_text": "Jose Manu (CodingFun)"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57de827b2dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&user=Jose+Manu+%28CodingFun%29&userId=57de827b2dd&source=post_page-57de827b2dd----109cab7ee737---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F109cab7ee737&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F109cab7ee737&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://codingandfun.com/moving-average-technical-analysis/", "anchor_text": "In one of my latest posts,"}, {"url": "https://www.pexels.com/@negativespace?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Negative Space"}, {"url": "https://www.pexels.com/photo/party-glass-architecture-windows-34092/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://codingandfun.com/moving-average-technical-analysis/", "anchor_text": "this post"}, {"url": "https://www.investopedia.com/terms/g/goldencross.asp", "anchor_text": "golden cross."}, {"url": "https://economictimes.indiatimes.com/markets/stocks/news/moving-average-trading-rules/articleshow/71749811.cms?from=mdr", "anchor_text": "article"}, {"url": "https://economictimes.indiatimes.com/markets/stocks/news/moving-average-trading-rules/articleshow/71749811.cms?utm_source=contentofinterest&utm_medium=text&utm_campaign=cppst", "anchor_text": "ie we start the trade only after it is confirmed by one more day\u2019s closing"}, {"url": "https://twitter.com/CodingandF", "anchor_text": "my Twitter account."}, {"url": "https://codingandfun.com/backtesting-with-python/", "anchor_text": "https://codingandfun.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----109cab7ee737---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/money?source=post_page-----109cab7ee737---------------money-----------------", "anchor_text": "Money"}, {"url": "https://medium.com/tag/investment?source=post_page-----109cab7ee737---------------investment-----------------", "anchor_text": "Investment"}, {"url": "https://medium.com/tag/finance?source=post_page-----109cab7ee737---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/programming?source=post_page-----109cab7ee737---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F109cab7ee737&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&user=Jose+Manu+%28CodingFun%29&userId=57de827b2dd&source=-----109cab7ee737---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F109cab7ee737&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&user=Jose+Manu+%28CodingFun%29&userId=57de827b2dd&source=-----109cab7ee737---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F109cab7ee737&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----109cab7ee737--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F109cab7ee737&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----109cab7ee737---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----109cab7ee737--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----109cab7ee737--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----109cab7ee737--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----109cab7ee737--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----109cab7ee737--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----109cab7ee737--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----109cab7ee737--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----109cab7ee737--------------------------------", "anchor_text": ""}, {"url": "https://codingfun89.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://codingfun89.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jose Manu (CodingFun)"}, {"url": "https://codingfun89.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57de827b2dd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&user=Jose+Manu+%28CodingFun%29&userId=57de827b2dd&source=post_page-57de827b2dd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa6a80235fd35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbacktesting-with-python-109cab7ee737&newsletterV3=57de827b2dd&newsletterV3Id=a6a80235fd35&user=Jose+Manu+%28CodingFun%29&userId=57de827b2dd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}