{"url": "https://towardsdatascience.com/practical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003", "time": 1683002233.380573, "path": "towardsdatascience.com/practical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003/", "webpage": {"metadata": {"title": "Practical Graph Neural Networks for Molecular Machine Learning | by Laksh | Towards Data Science", "h1": "Practical Graph Neural Networks for Molecular Machine Learning", "description": "Chemical fingerprints [1] have long been the representation used to represent chemical structures as numbers, which are suitable inputs to machine learning models. In short, chemical fingerprints\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-practical-introduction-to-the-use-of-molecular-fingerprints-in-drug-discovery-7f15021be2b1", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Atorvastatin", "anchor_text": "Atorvastatin", "paragraph_index": 3}, {"url": "https://github.com/rusty1s/pytorch_geometric", "anchor_text": "PyTorch-Geometric", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Atomic_number", "anchor_text": "tomic number", "paragraph_index": 8}, {"url": "https://www.linkedin.com/in/laksh-aithani-7b0451148/", "anchor_text": "LinkedIn", "paragraph_index": 23}], "all_paragraphs": ["Chemical fingerprints [1] have long been the representation used to represent chemical structures as numbers, which are suitable inputs to machine learning models. In short, chemical fingerprints indicate the presence or absence of chemical features or substructures, as shown below:", "A brief summary of chemical fingerprints is provided in another of my blog posts here.", "Fingerprints can easily be computed in Python with RDkit [2] like so:", "Above, we computed the fingerprint for Atorvastatin, a drug which generated over $100B in revenue over 2003\u20132013.", "At some point a few years ago, people started to realize [3] that instead of computing a non-differentiable fingerprint, we can compute a differentiable fingerprint. Then, by backpropagation, we can train not only a deep-learning model but also train the fingerprint-generating function itself. The promise would be to learn richer molecular representations.", "The idea is to aggregate features of neighboring nodes together. That is what leads to the name \u2018graph convolution\u2019 as we are convolving (performing some sort of aggregation) over neighboring atoms, for each atom.", "We can implement the Neural graph fingerprint algorithm as proposed above using PyTorch-Geometric [4]. The following implementation allows for batched training (PyTorch-Geometric models a batch of molecules/graphs as one big disconnected graph).", "We will use these atom features:", "a) Atomic number (which determines atom type as well)", "b) The number of hydrogens attached to the atom.", "These are basic features but sufficient for our purposes.", "Finally, we can define the model.", "We can test our model to make sure it works:", "An interesting finding in [3] was that randomly initialized neural fingerprints did as well or better at modeling chemical features than conventional fingerprints.", "If randomly initialized fingerprints do as well as conventional fingerprints, surely if we train the fingerprints through backpropagation [5], they ought to do better?", "This is the hope and promise, but we must make sure we don\u2019t overfit noise in small datasets. Let\u2019s try our neural fingerprint on a real dataset. We\u2019ll use the BACE [6] regression dataset from DeepChem [7].", "We now build a small MLP (multi-layer perceptron) on top of our neural fingerprint. We give it just 1 hidden layer (of dimension 100):", "Define our utility functions for training and validation:", "And finally, our optimizer, and the training loop:", "Note that when we train the model, we train both the neural fingerprint as well as the linear layers on top of it.", "The above dataset had ~1000 molecules and 1 target. Current datasets have 100k+ molecules and several 100 targets. Therefore, large-scale multitask supervised pretraining can be used to obtain very rich representations [8].", "Furthermore, people are starting to use unsupervised graph pretraining techniques [9], following the path of success of unsupervised pretraining in NLP [10].", "We saw that neural fingerprints can be used instead of conventional fingerprints. Randomly initialized neural fingerprints perform as well or better than conventional fingerprints. Trained neural fingerprints have the potential to form richer representations, given enough data and measures are taken to avoid overfitting.", "Connect with me on LinkedIn and let me know if you end up using neural fingerprints.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5e6dee7dc003&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://laksh1997.medium.com/?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": ""}, {"url": "https://laksh1997.medium.com/?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": "Laksh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fb0cb9afbd2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&user=Laksh&userId=1fb0cb9afbd2&source=post_page-1fb0cb9afbd2----5e6dee7dc003---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e6dee7dc003&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e6dee7dc003&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/a-practical-introduction-to-the-use-of-molecular-fingerprints-in-drug-discovery-7f15021be2b1", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Atorvastatin", "anchor_text": "Atorvastatin"}, {"url": "https://github.com/rusty1s/pytorch_geometric", "anchor_text": "PyTorch-Geometric"}, {"url": "https://en.wikipedia.org/wiki/Atomic_number", "anchor_text": "tomic number"}, {"url": "https://www.linkedin.com/in/laksh-aithani-7b0451148/", "anchor_text": "LinkedIn"}, {"url": "http://www.rdkit.org.", "anchor_text": "www.rdkit.org."}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2879048/#", "anchor_text": "J Neurosci"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5e6dee7dc003---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/drug-discovery?source=post_page-----5e6dee7dc003---------------drug_discovery-----------------", "anchor_text": "Drug Discovery"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----5e6dee7dc003---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/graph-neural-networks?source=post_page-----5e6dee7dc003---------------graph_neural_networks-----------------", "anchor_text": "Graph Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5e6dee7dc003&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&user=Laksh&userId=1fb0cb9afbd2&source=-----5e6dee7dc003---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5e6dee7dc003&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&user=Laksh&userId=1fb0cb9afbd2&source=-----5e6dee7dc003---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5e6dee7dc003&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5e6dee7dc003&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5e6dee7dc003---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5e6dee7dc003--------------------------------", "anchor_text": ""}, {"url": "https://laksh1997.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://laksh1997.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Laksh"}, {"url": "https://laksh1997.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "305 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1fb0cb9afbd2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&user=Laksh&userId=1fb0cb9afbd2&source=post_page-1fb0cb9afbd2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F83b5c97f3c22&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpractical-graph-neural-networks-for-molecular-machine-learning-5e6dee7dc003&newsletterV3=1fb0cb9afbd2&newsletterV3Id=83b5c97f3c22&user=Laksh&userId=1fb0cb9afbd2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}