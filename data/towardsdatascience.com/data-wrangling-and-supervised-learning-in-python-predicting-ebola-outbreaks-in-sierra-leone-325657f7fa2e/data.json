{"url": "https://towardsdatascience.com/data-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e", "time": 1683011409.953546, "path": "towardsdatascience.com/data-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e/", "webpage": {"metadata": {"title": "Data wrangling and supervised learning in Python | by Nicolas Diaz Amigo | Towards Data Science", "h1": "Data wrangling and supervised learning in Python", "description": "This article was written by Nicolas Diaz, MPP \u201920 at Harvard Kennedy School, based on a project with Tze Ni Yeoh, Abdulla Saif, Lucas Kitzm\u00fcller and Victor Sheng. Supervised learning is one of the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/nicol%C3%A1s-d%C3%ADaz-amigo-3602ab121/", "anchor_text": "Nicolas Diaz", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/tzeniyeoh/", "anchor_text": "Tze Ni Yeoh", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/abdulla-saif-51072119a/", "anchor_text": "Abdulla Saif", "paragraph_index": 0}, {"url": "http://www.linkedin.com/in/lucaskitzmueller", "anchor_text": "Lucas Kitzm\u00fcller", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/vysheng/", "anchor_text": "Victor Sheng", "paragraph_index": 0}, {"url": "https://github.com/nsdiaz/ebola-prediction-tutorial/", "anchor_text": "here", "paragraph_index": 1}], "all_paragraphs": ["This article was written by Nicolas Diaz, MPP \u201920 at Harvard Kennedy School, based on a project with Tze Ni Yeoh, Abdulla Saif, Lucas Kitzm\u00fcller and Victor Sheng.", "A GitHub with the Jupyter notebooks from this project is available here.", "Supervised learning is one of the most widely used forms of machine learning in the world. This article guides you through some of the most basic steps needed to build a model: importing your data, looking at it, putting it in a consistent format, using a sample from the data to train and test an algorithm and optimizing its parameters.", "The code is displayed in Python, a versatile programming language.", "The challenge that we have chosen as an example is to predict the spread of Ebola by region during the 2014\u20132016 outbreak in Sierra Leone.", "The Western African Ebola virus epidemic (2014\u20132016) caused 11,325 deaths and major socioeconomic disruption, with a majority of fatalities taking place in the coastal nation of Sierra Leone. During the outbreak, national authorities had enough resources to isolate and treat all reported cases and stop further transmission of the virus. Unanticipated local variation in the total number of incidences, however, created insufficient response capacity in certain districts (WHO Situation Report, 2014).", "There is a need for a complementary tool in informing the allocation of resources across districts and increasing response effectiveness in current and future Ebola emergencies.", "First, we import the libraries that we will use throughout this project. Pandas is the main dataframe manipulation library in Python and Sklearn is an intuitive way to run machine learning models. For Pandas, we will change the defaults with set_option for more comfortable displays of large tables.", "Once we have our libraries imported, we load our data with the read_csv() method of Pandas. A number of useful methods allow for a quick inspection of the dataframe: shape, head(), tail() and info.", "Looking at the above variables, we are interested in digging deeper into some of the columns. Applying the value_counts() to specific columns will return how many instances of each class are there.", "We can confirm that all of our rows are from Sierra Leone and that all regions have the same amount of instances, which is what we expected.", "Now, the info method from earlier revealed that a number of our columns contained mostly missing values. We can get rid of these by using the drop() method in our dataframe. The inplace set to True means it will modify our starting dataframe and we don\u2019t have to redefine it. We can use the head() method to see everything is in order.", "We also need to remove rows that won\u2019t be used for our analysis (i.e., when they are an aggregate). We can do this by using conditional selection (!= means different than) and saving it to a new dataframe name, df2. We redefine the dataframe at this point because that way we don\u2019t have to start from scratch if we make a mistake.", "The way our data is currently structured is still not ready for analysis. Right now there are individual rows for each district, for each week, for each one of two sources of data, and each of one of two case definitions (confirmed and probable).", "To run our models, we want to make sure that each row represents each week\u2019s numbers for each district. We can do this through a combination of pivot_tables and some quick dataframe manipulation.", "And let\u2019s see how many rows we have after we have collapsed all the information.", "At this point, we should export our results and give them a name using the to_csv() method in our dataframe. This way we can share our reshaped table with others.", "We don\u2019t show the code here but the next step is joining the confirmed ebola cases dataset with a number of different demographic indicators given by the World Health Organization and the World Bank.", "We have also created new features (or variables) based on geographical limits (which regions border which) and by creating \u201cinteractions\u201d between the border and reported cases. For example, how many cases were there in neighboring states in recent weeks.", "We are now ready to start building our machine learning models. At this point, it\u2019s a good idea to start a new Jupyter notebook and import the data.", "Next, for the purpose of testing how predictive our model is, we will \u201ctake out\u201d a number of weeks so that our model does not get to be trained on them. At the end we will compare our model\u2019s prediction for these three weeks against what really happened. This is called \u201choldout validation\u201d and is a way to make sure we aren\u2019t just overfitting \u2014 that is, that our model is basically \u201cmemorizing\u201d the dataset.", "Our three weeks are at the beginning, the apex and the end of the outbreak.", "We will do a little more column dropping and then we will split our X (predictors) and our y (target variable). For the purposes of this exercise, we will focus on confirmed cases from the \u201csituation report\u201d source.", "Besides separating the three weeks in our holdout set, we also do a train_test_split() to separate 20% of our dataset. This is to get some out of sample statistics about our model performance.", "We now leverage one of the algorithms that we imported called a Random Forest, which is a type of ensemble learner \u2014 that is, an aggregation of multiple decision trees \u2014 that can be used for both regression and classification. We create a variable for our model with the specifications that we want and then we fit() it with our train set. We can use one of the metrics we imported (mean_squared_error) to see how it performs.", "Now, supervised learning algorithms have a number of parameters to select. For example, in the random forest family we can use max_depth to determine how tall our trees can get (that is, how complex we can get with our decision nodes). A priori, there is no right or wrong answer to how talls trees should be in our model. It depends on the nature of our data. And the best way to choose is through cross-validation.", "In the following code we use the GridSearchCV() function of sklearn to tell random forest to go through a number of different options and return the one with the best score through cross-validation. We then create a new instance of our algorithm with those best parameters. Finally, we see its new score.", "For fun, let\u2019s use a different metric this time (neg_mean_absolute_error) to test how our algorithm is doing.", "We can now return to our holdout set and try to generate predictions based on our random forest regressor with the best parameters. After dividing our dataframe into X and y the same way that our training data was, we can use the predict method to generate predictions for every row in our holdout set.", "We can now visualize those results in a separate dataframe and compare them to the actual numbers.", "Our final model took into account a series of variables from each district in Sierra Leone, and information about past number of cases for each district, as well as interaction with bordering districts, in order to predict for any given week, whether there will be an Ebola outbreak and, if so, how many patients can be expected.", "One way to visualize the results of our models was holding out data from three specific weeks during the crisis, and then testing how our predictions compared to what actually happened. We choose one week at the start of the crisis, one week at the peak, and one week as the spread was slowing down.", "As you can see from the visualization above, our model does not produce perfect results. In the case of the third week, some of the northern districts that were given low priority ended up having some of the highest concentration of cases. On the other hand, the middle week in Figure 1 accurately predicts that the highest concentration of cases will be found in regions in the north-western part of Sierra Leone.", "When using data science to inform policy and operational decisions, it is always important to think of the potential of introducing bias because of imperfect data.", "In our case, the under-reporting of Ebola cases during the 2013\u201316 epidemic has been widely acknowledged. Based on staff observations, WHO claimed that \u201cthe numbers of reported cases and deaths vastly underestimate the magnitude of the outbreak\u201d. According to one estimate, the number of actual cases exceeded the number of reported cases by a factor of 2.5.", "As our models are trained on the reported number of Ebola cases, our predictions will, on average, underestimate the actual number of Ebola cases. Further, the level of under-reporting is likely correlated with district characteristics that also matter for considerations of fairness. For example, poorer districts probably have worse monitoring systems, resulting in a higher number of unreported cases.", "Consequently, the gap between the actual and predicted number of Ebola cases will be larger in poorer districts, potentially leading to an allocation of resources that unfairly disadvantages poorer districts. Without further information on how under-reporting varies by districts, we are unable to generate unbiased predictions with biased data. Hence, if our model was to be adopted, we recommend a simultaneous investment into monitoring systems to generate better quality outcome data.", "The biggest problem with our current approach is that the models are making predictions based on the entire period for which the outbreak was happening. In other words, the model could take a look at the data and the peaks of infections and know when to expect numbers to grow and decline. In real life, if we were to apply this model for a new outbreak, then we will only have data up to the week where we're at, but obviously we would not be able to look into the future. If the outbreak followed a similar general growth pattern this wouldn\u2019t be a problem, but that is unlikely to be the case.", "Preparing your data for analysis is the most crucial step in any supervised learning project. In this post we have learned some of the basic code to efficiently set you up for success, as well as the basic elements in a model training, evaluating and optimizing workflow.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I write about digital government, city government, and public sector innovation. Master in Public Policy at Harvard Kennedy School. Originally from Chile."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F325657f7fa2e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nicolas.diaz.amigo?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nicolas.diaz.amigo?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": "Nicolas Diaz Amigo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd70e58dd1da2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&user=Nicolas+Diaz+Amigo&userId=d70e58dd1da2&source=post_page-d70e58dd1da2----325657f7fa2e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F325657f7fa2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F325657f7fa2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.linkedin.com/in/nicol%C3%A1s-d%C3%ADaz-amigo-3602ab121/", "anchor_text": "Nicolas Diaz"}, {"url": "https://www.linkedin.com/in/tzeniyeoh/", "anchor_text": "Tze Ni Yeoh"}, {"url": "https://www.linkedin.com/in/abdulla-saif-51072119a/", "anchor_text": "Abdulla Saif"}, {"url": "http://www.linkedin.com/in/lucaskitzmueller", "anchor_text": "Lucas Kitzm\u00fcller"}, {"url": "https://www.linkedin.com/in/vysheng/", "anchor_text": "Victor Sheng"}, {"url": "https://github.com/nsdiaz/ebola-prediction-tutorial/", "anchor_text": "here"}, {"url": "https://medium.com/tag/data-science?source=post_page-----325657f7fa2e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----325657f7fa2e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/health?source=post_page-----325657f7fa2e---------------health-----------------", "anchor_text": "Health"}, {"url": "https://medium.com/tag/ebola?source=post_page-----325657f7fa2e---------------ebola-----------------", "anchor_text": "Ebola"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----325657f7fa2e---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F325657f7fa2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&user=Nicolas+Diaz+Amigo&userId=d70e58dd1da2&source=-----325657f7fa2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F325657f7fa2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&user=Nicolas+Diaz+Amigo&userId=d70e58dd1da2&source=-----325657f7fa2e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F325657f7fa2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F325657f7fa2e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----325657f7fa2e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----325657f7fa2e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----325657f7fa2e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----325657f7fa2e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----325657f7fa2e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nicolas.diaz.amigo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nicolas.diaz.amigo?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nicolas Diaz Amigo"}, {"url": "https://medium.com/@nicolas.diaz.amigo/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "38 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd70e58dd1da2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&user=Nicolas+Diaz+Amigo&userId=d70e58dd1da2&source=post_page-d70e58dd1da2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fd70e58dd1da2%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-wrangling-and-supervised-learning-in-python-predicting-ebola-outbreaks-in-sierra-leone-325657f7fa2e&user=Nicolas+Diaz+Amigo&userId=d70e58dd1da2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}