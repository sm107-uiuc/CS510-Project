{"url": "https://towardsdatascience.com/cnn-resnets-a-more-liberal-understanding-a0143a3ddac9", "time": 1683000824.4403799, "path": "towardsdatascience.com/cnn-resnets-a-more-liberal-understanding-a0143a3ddac9/", "webpage": {"metadata": {"title": "CNN & ResNets \u2014 a more liberal understanding | by Rrohan.Arrora | Towards Data Science", "h1": "CNN & ResNets \u2014 a more liberal understanding", "description": "If you are familiar with fastai and particularly computer vision in fastai, then you know how we create a convolutional neural network. We use to create the network. If you want to learn about the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.fast.ai/data_block.html", "anchor_text": "data block API", "paragraph_index": 19}], "all_paragraphs": ["If you are familiar with fastai and particularly computer vision in fastai, then you know how we create a convolutional neural network. We use to create the network. If you want to learn about the semantics behind create_cnn, please refer to the link shared in the introduction.", "Now, we have a CNN, and we want to know what is going on in the CNN. What is going on behind the scene is like below:", "Now, instead of matrix multiplication, in convolutional neural networks, convolution happens. Convolution is also a type of matrix multiplication, but it has some other magnetic properties also. Let us go deep inside the convolutional neural network.", "In novices language, think of any image and put the light of torch over the image. Pass the light through small parts of the image starting from top-left to bottom-right in parts. That small lighten up portion of the image is actually the kernel and the process of running torchlight over the whole image is kind of convolution.", "Let us understand the above operation diagrammatically.", "The number of equations formed is below:", "Thus the input image is reduced to a smaller matrix known as a channel representing a certain feature.", "Now, we may understand it in the traditional neural network way like below:", "We may perform the operations in the conventional neural network way, but it takes a lot of memory and time. Instead, we perform it the other way as stated above, and it takes a whole of less time and memory.", "Now, let us consider one more case of a convolutional neural network. What if our input matrix and kernel have the same size? There are two options to deal with such situations:", "In other words, a convolution is just a matrix multiplication where two things happen:", "So when you\u2019ve got multiple things with the same weight, that\u2019s called weight tying.", "Now, that\u2019s much of the theoretical understanding of the convolutional neural networks. Now, let\u2019s understand the convolutional neural networks from a practical point of view.", "Now, let\u2019s evaluate the MNIST dataset and use our convolutional neural network. I used google colab for a practical purpose.", "Fastai provides academic datasets, and we can untar and use that.", "After extracting the data, we have to create the data bunch. So, let us establish that.", "The first thing you say is what kind of item list do you have. So, in this case, it\u2019s the list of images. Then where are you getting the list of file names from? In this case, we have folders.", "So inside an item list is an items attribute and the items attribute is the kind of thing that you gave it. It's the thing that it's going to use to create your items. So in this case, the thing you gave it is a list of file names. That's what it got from the folder.", "When you show images, it usually shows them in RGB. In this case, we want to use a binary color map.", "Once you\u2019ve got an image item list, you then split it into training versus validation. You nearly always want validation. If you don\u2019t, you can use the .no_split method to create an empty validation set. You can't skip it entirely. All this is defined in fastai data block API.", "So that is always the order. First, create your item list, then decide how to split. In this case, we\u2019re going to do it based on folders. The validation folder for MNIST is called testing , and therefore we mention that in the method also.", "Now, we want to label our data, and we want to label the data using the folder in which our data is present.", "So first you create the item list, then you split it, then you label it.", "Now, comes adding transforms. Transformation is the part of data augmentation. There is a very considerable difference between processes that we add for tabular data and transformations that we add for images.", "Since we are doing digit recognition, therefore we do not want to apply a default to the data because it consists of some transformations that we really do not want like flipping the number vertically/horizontally will change the number, zooming the text will change the pixels of image and image will be blurred. Therefore, we will add our transformations, and they are effortless, add random padding and a little amount of cropping.", "Now is the time for the last step, and it is to create the data bunch. Here I am not using image stats for normalization as I am not using a pre-trained model like ResNet34, ResNet56, etc. Also, I will use the batch size of 128.", "What is most interesting is that the training data set now has data augmentation because we have added transforms. plot_multi is a fast.ai function that will plot the result of calling some function on each of the items.", "Now, we are done with the data bunch. Now, we will create the learner and will train it through our own CNN.", "Let us understand the above function.", "That\u2019s all ( \u0361\u1d54 \u035c\u0296 \u0361\u1d54), we have created our convolutional neural network.", "Now is the time to create the learner as defined in the fastai.", "Now, let us understand the ResNet and then I will include that in our model and will see how much the accuracy improves.", "Let X be out input. As per the ResNet, instead of doing like", "Y = X + conv2(conv1(X)) \u2014 This thing is called an identity connection or skip connection.", "ResNet drastically improves the loss function surface. Without ResNets, the loss function has lots of bumps, and with ResNet, it turned down to smooth.", "We can create ResBock like below:", "Let us change our model to include the ResNet blocks. Let\u2019s refactor that a little. Rather than saying conv, batch norm, ReLU all the time, fast.ai already has something called conv_layer which lets you create conv, batch norm, ReLU combinations.", "That\u2019s all. I hope you may have understood the logic behind CNN and ResNets.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "demystifying the theories, construing the results."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa0143a3ddac9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rrohan-arrora.medium.com/?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": ""}, {"url": "https://rrohan-arrora.medium.com/?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": "Rrohan.Arrora"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdbb9cfaeb49a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&user=Rrohan.Arrora&userId=dbb9cfaeb49a&source=post_page-dbb9cfaeb49a----a0143a3ddac9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0143a3ddac9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0143a3ddac9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/analytics-vidhya/image-classification-using-fastai-5ff5b374d414", "anchor_text": "here"}, {"url": "https://unsplash.com/@starburst1977?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Sven Read"}, {"url": "https://unsplash.com/s/photos/convolutional-neural-networks?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://docs.fast.ai/data_block.html", "anchor_text": "data block API"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a0143a3ddac9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a0143a3ddac9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolutional-neural-net?source=post_page-----a0143a3ddac9---------------convolutional_neural_net-----------------", "anchor_text": "Convolutional Neural Net"}, {"url": "https://medium.com/tag/resnet?source=post_page-----a0143a3ddac9---------------resnet-----------------", "anchor_text": "Resnet"}, {"url": "https://medium.com/tag/fastai?source=post_page-----a0143a3ddac9---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa0143a3ddac9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&user=Rrohan.Arrora&userId=dbb9cfaeb49a&source=-----a0143a3ddac9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa0143a3ddac9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&user=Rrohan.Arrora&userId=dbb9cfaeb49a&source=-----a0143a3ddac9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa0143a3ddac9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa0143a3ddac9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a0143a3ddac9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a0143a3ddac9--------------------------------", "anchor_text": ""}, {"url": "https://rrohan-arrora.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rrohan-arrora.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rrohan.Arrora"}, {"url": "https://rrohan-arrora.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "122 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdbb9cfaeb49a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&user=Rrohan.Arrora&userId=dbb9cfaeb49a&source=post_page-dbb9cfaeb49a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1b79de439ecb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcnn-resnets-a-more-liberal-understanding-a0143a3ddac9&newsletterV3=dbb9cfaeb49a&newsletterV3Id=1b79de439ecb&user=Rrohan.Arrora&userId=dbb9cfaeb49a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}