{"url": "https://towardsdatascience.com/mathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4", "time": 1683010713.202744, "path": "towardsdatascience.com/mathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4/", "webpage": {"metadata": {"title": "Mathematics behind the training of Word2vec Model | by Saket Thavanani | Towards Data Science", "h1": "Mathematics behind the training of Word2vec Model", "description": "In my previous article, We went through the basic idea of Word Embedding and its implementation using the genism library. People who are not aware of the basics of word embedding I strongly suggest\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@saketthavananilindan", "anchor_text": "Medium", "paragraph_index": 21}], "all_paragraphs": ["In my previous article, We went through the basic idea of Word Embedding and its implementation using the genism library. People who are not aware of the basics of word embedding I strongly suggest them to have a look at my previous article here.", "The training of Word2Vec Model can be done using two algorithms-", "In this article, we will be covering the mathematics involved behind the SG model.", "This model assumes that a word can be used to predict its surrounding words in a text corpus. The main idea behind this algorithm is that given a center word (Vc) it tries to predict the conditional probability of the neighboring words(Vw) and further tries to maximize that probability of occurrence. The number of neighboring words to consider depends upon the window size m. The figure below explains this idea using window size=2.", "We assume that, given the central word, the context words are generated independently of each other. In this case, the probability formula for the co-occurrence of all the words will be as follows-", "The above probability calculation is just using some random word as a center in the whole corpus. But we will have to traverse across the whole corpus (T) to consider all the words as a center words one at a time and predict its respective surrounding words for a window size of m. The maximum likelihood function can be written as follows-", "As we know it always easy to work with LogLikelihood functions in terms of gradient calculations, therefore we take Log on both sides and convert it into a logarithmic form.", "Now let us define some notations as we will use these from here onwards-", "Vc-Vector representation of the center word.", "Uo-Vector Representation of the context word.", "The conditional probability of generating the context word o for the given central target word c can be obtained using the softmax function. In order to convince yourself to you can think that if two words are the same then the similarity will be one and probability will be 1.", "This softmax converts it into a probability by normalizing it with over the whole vocabulary V. The dot product represents the similarity between two-word vectors.", "Now let\u2019s write the final cost function after substituting the expression for probability.", "Our main objective is to find the vector representation of every single word in the text in a reduced d dimensional space. The trick here is each word w will have two different representations one Vw when word w is a center word and another Uw when word w is a context word. So the parameter \u03f4 about which we discussed before will be 2V x d dimensional vector, where each row represents a different word in the vocabulary with its d dimensional vector representation across the columns.", "Now we have two vector representations for each word. In order to train our model, we will be taking derivatives with respect to Vw and Uw and update these vectors using gradient descent. Vc is basically the same as Vw. We have just changed the notations to avoid any confusion. According to the Matrix \u03f4, we only have two parameters Vc and Uw.", "Step 2: Applying the Chain rule for Term 2.", "Here w is the context word. So, there can be two cases when o is the context word w and when o is not the context word w. So, we will be splitting gradients into two parts to compute the gradient with respect to Uw. Following the same kind of calculations as we did above for Vc we can write the gradient w.r.t Uw using symmetry.", "Now we will update the computed gradients using the gradient descent algorithm for the whole corpus. The pseudo-code for the algorithm is given below", "However, there is one problem in this approach. As we can see, in the denominator in the gradient, we have to take the exponential of the dot product of all our words and this is very time consuming when we have a huge vocabulary. We will need to train billions of weights which is computationally expensive. Therefore, we use a technique called negative sampling to tackle that. In this technique, we only take a small number of words from the vocabulary based upon random selection from unigrams distribution. I am not going into those details for this article.", "I hope this article gave you a basic sense of mathematics that is happening behind the Word2vec model. This article might seem a bit gloomy due to too many pictures embedded in it, but if you go step by step I believe it should be really helpful. It would be great if you guys can give me some feedback so that I can present it in a better way next time.", "If you like my work and want to support me:", "1-The BEST way to support me is by following me on Medium.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Masters Student | University of Toronto | IIT Kharagpur | Data Science, Machine Learning and Deep Learning Enthusiast"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F62d7e0ff76e4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@saketuoft?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@saketuoft?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": "Saket Thavanani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102f526f83de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&user=Saket+Thavanani&userId=102f526f83de&source=post_page-102f526f83de----62d7e0ff76e4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62d7e0ff76e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62d7e0ff76e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/visualization-of-word-embedding-vectors-using-gensim-and-pca-8f592a5d3354", "anchor_text": "Visualization of Word Embedding Vectorsusing Gensim and PCAIn this article, we will learn how to train text data using word embedding and further visualize those vectors using\u2026towardsdatascience.com"}, {"url": "https://unsplash.com/@johnmoeses?utm_source=medium&utm_medium=referral", "anchor_text": "John Moeses Bauan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf", "anchor_text": "1-https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf"}, {"url": "https://medium.com/@saketthavananilindan", "anchor_text": "Medium"}, {"url": "https://www.linkedin.com/in/saket-thavanani-b1a149a0/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----62d7e0ff76e4---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----62d7e0ff76e4---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----62d7e0ff76e4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----62d7e0ff76e4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----62d7e0ff76e4---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62d7e0ff76e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&user=Saket+Thavanani&userId=102f526f83de&source=-----62d7e0ff76e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F62d7e0ff76e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&user=Saket+Thavanani&userId=102f526f83de&source=-----62d7e0ff76e4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F62d7e0ff76e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F62d7e0ff76e4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----62d7e0ff76e4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----62d7e0ff76e4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@saketuoft?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@saketuoft?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saket Thavanani"}, {"url": "https://medium.com/@saketuoft/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "396 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F102f526f83de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&user=Saket+Thavanani&userId=102f526f83de&source=post_page-102f526f83de--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5dae2614ed2d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmathematics-behind-the-training-of-word2vec-model-62d7e0ff76e4&newsletterV3=102f526f83de&newsletterV3Id=5dae2614ed2d&user=Saket+Thavanani&userId=102f526f83de&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}