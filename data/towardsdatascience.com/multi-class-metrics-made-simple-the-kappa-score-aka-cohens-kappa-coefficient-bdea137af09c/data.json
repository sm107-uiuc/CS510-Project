{"url": "https://towardsdatascience.com/multi-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c", "time": 1683002170.557921, "path": "towardsdatascience.com/multi-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c/", "webpage": {"metadata": {"title": "Multi-Class Metrics Made Simple, Part III: the Kappa Score (aka Cohen\u2019s Kappa Coefficient) | by Boaz Shmueli | Towards Data Science", "h1": "Multi-Class Metrics Made Simple, Part III: the Kappa Score (aka Cohen\u2019s Kappa Coefficient)", "description": "The kappa score considers how much better the agreements are over and beyond chance agreements."}, "outgoing_paragraph_urls": [{"url": "https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwiGvcyA3bvmAhWSZt4KHZhFDf4QFjAAegQIBRAB&url=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-part-i-precision-and-recall-9250280bddc2&usg=AOvVaw3IZlPlxiAv7zI8t1IUB5tS", "anchor_text": "Precision and Recall", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/multi-class-metrics-made-simple-part-ii-the-f1-score-ebe8b2c2ca1", "anchor_text": "F1-score", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Jacob_Cohen_(statistician)", "anchor_text": "Jacob Cohen", "paragraph_index": 1}, {"url": "https://medium.com/@shmueli/multi-class-metrics-made-simple-part-i-precision-and-recall-9250280bddc2", "anchor_text": "Precision and Recall", "paragraph_index": 21}, {"url": "https://towardsdatascience.com/multi-class-metrics-made-simple-part-ii-the-f1-score-ebe8b2c2ca1", "anchor_text": "F1-score", "paragraph_index": 21}, {"url": "https://www.rdocumentation.org/packages/psych/versions/1.8.12/topics/cohen.kappa", "anchor_text": "cohen.kappa() function", "paragraph_index": 24}, {"url": "http://www.twitter.com/shmueli", "anchor_text": "www.twitter.com/shmueli", "paragraph_index": 28}], "all_paragraphs": ["In my previous Multi-Class Metrics Made Simple posts, I wrote about Precision and Recall, as well as the F1-score. I received encouraging feedback from many readers. So first, thank you! In this post, I write about another popular measure: the kappa score. You might find the kappa score to be useful in your application.", "The kappa score is an interesting metric. Its origins are in the field of psychology: it is used for measuring the agreement between two human evaluators or raters (e.g., psychologists) when rating subjects (patients). It was later \u201cappropriated\u201d by the machine-learning community to measure classification performance. Also known as Cohen\u2019s kappa coefficient, the kappa score is named after Jacob Cohen, an American statistician and psychologist who wrote the seminal paper on the topic. Other names for this metric include Cohen\u2019s kappa and the kappa statistic. In this post, I simply use kappa score.", "I first explain what is agreement and how the kappa score is used for measuring agreement to provide the intuition behind this metric. I then move on to classification.", "Imagine that we run the piano department in a prestigious music school (Juilliard comes to mind for some reason). It\u2019s admissions season, and 25 nervous candidates are ready to demonstrate their skills on the beautiful Steinway grand piano. We ask two experienced professors \u2014 known as Professor A and Professor B \u2014 to rate each candidate as Accept, Waiting List (WL), or Reject.", "Here are the audition results for the 25 candidates:", "Each candidate now has two ratings, one from each professor. Naturally, the professors agree on some candidates and disagree on others. A high level of agreement between the professors increases our confidence that the ratings are reliable. A low level of agreement means that we cannot trust the ratings. The kappa score measures the degree of agreement between the two evaluators, also known as inter-rater reliability.", "To compute the kappa score, it is convenient to first summarize the ratings in a matrix:", "The columns show the ratings by professor A. The rows show the ratings by Professor B. The value in each cell is the number of candidates with the corresponding ratings by the two professors.", "A na\u00efve way to measure agreement would be to look at the proportion of ratings that are in agreement between the two professors. Let\u2019s call this number Agree. Computing Agree is easy: we just need to look at the sum of the values in the green cells (diagonal) and divide by the total number of students: In our case, 4+2+6=12 of the 25 ratings are in agreement, so:", "That\u2019s it! We just found the perfect metric for agreement. Or did we? Well, our metric is not very sophisticated, since it doesn\u2019t consider that agreements can also happen by chance. That\u2019s where the kappa score comes in; the kappa score considers how much better the agreements are over and beyond chance agreements. Thus, in addition to Agree, the kappa formula also uses the expected proportion of chance agreements; let\u2019s call this number ChanceAgree.", "We already know how to compute Agree. For the moment, let\u2019s assume that we know the value of ChanceAgree. We combine the two numbers to compute the kappa score as follows", "Note that the numerator calculates is the difference between Agree and ChanceAgree. If Agree=1, we have perfect agreement, corresponding to a matrix where all the non-diagonal (pink) cells are 0. In this case, the kappa score is 1, regardless of ChanceAgree. In contrast, if Agree=ChanceAgree, kappa is 0, signifying that the professors\u2019 agreement is by chance. If Agree is smaller than ChanceAgree, the kappa score is negative, denoting that the degree of agreement is lower than chance agreement.", "Back to our example: in our case (as we calculate shortly), ChanceAgree is 0.3024. In other words, we expect about 30% of agreements to occur by chance, which translates to about 7\u20138 students (30% of 25 students). The professors agreed on 12 of the 25 students, and so the kappa score is positive:", "In the next section, I explain how ChanceAgree is calculated.", "To calculate ChanceAgree, we first look at the probability of rating a student as Accept for each professor. Let\u2019s take a look at the rating matrix again; for convenience, we added totals for the rows and columns:", "For Professor A, 4+1+1=6 of the 25 ratings were Accept; for Professor B, the number is 4+6+3=13. The probabilities for rating a student as Accept for Professor A and B are thus:", "The probability that both professors agree on an Accept by chance is equal to the product of ProbA and ProbB:", "Similarly, we calculate the agreement probabilities for WL and Reject:", "Summing up the above three probabilities, we get the probability that agreement on any of the events \u2014 Accept, WL, or Reject \u2014 happened by chance:", "That\u2019s it! We learned how to calculate ChanceAgree. Combined with Agree, we can now measure agreement using the kappa score. But how can we use it to measure classification performance?", "To see how kappa score is used as a metric of classifier performance, let\u2019s look again at the rating matrix:", "Well, you might have guessed it already: it\u2019s pretty similar to a confusion matrix! Compare it to the confusion matrix we used in my other posts (Precision and Recall, F1-score), where we built a classifier that detects the in photos: \u201cCat\u201d, \u201cHen\u201d, or \u201cFish\u201d. Notice the \u201cdeep\u201d similarity? The cell values are exactly the same.", "To use kappa for classification, we can simply think of each rating as a class; in addition, the ratings by Professor A are the true/actual values; the ratings by Professor B are the predicted values (or vice versa \u2014 it doesn\u2019t matter). In this incarnation, the kappa score measures the degree of agreement between the true values and the predicted values, which we use as the classifier\u2019s performance. In our case, we can use the previously calculated kappa score, since the cell values are identical:", "Since 1 means perfect agreement and 0 is chance agreement, we most often get a value that\u2019s somewhere in between. If the value is less than 0, we\u2019re doing worse than chance agreement (disagreement), so something is severely broken in the classifier.", "The kappa score can be calculated using Python\u2019s scikit-learn library (R users can use the cohen.kappa() function, which is part of the psych library).", "Here is how I confirmed my calculation:", "This concludes the post. I hope you found it useful!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I enjoy explaining stuff. PhD candidate at NLPSA, Academia Sinica. www.twitter.com/shmueli"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbdea137af09c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bdea137af09c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bdea137af09c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://shmueli.medium.com/?source=post_page-----bdea137af09c--------------------------------", "anchor_text": ""}, {"url": "https://shmueli.medium.com/?source=post_page-----bdea137af09c--------------------------------", "anchor_text": "Boaz Shmueli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57ee515c83c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&user=Boaz+Shmueli&userId=57ee515c83c5&source=post_page-57ee515c83c5----bdea137af09c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbdea137af09c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbdea137af09c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwiGvcyA3bvmAhWSZt4KHZhFDf4QFjAAegQIBRAB&url=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-part-i-precision-and-recall-9250280bddc2&usg=AOvVaw3IZlPlxiAv7zI8t1IUB5tS", "anchor_text": "Precision and Recall"}, {"url": "https://towardsdatascience.com/multi-class-metrics-made-simple-part-ii-the-f1-score-ebe8b2c2ca1", "anchor_text": "F1-score"}, {"url": "https://en.wikipedia.org/wiki/Jacob_Cohen_(statistician)", "anchor_text": "Jacob Cohen"}, {"url": "https://medium.com/@shmueli/multi-class-metrics-made-simple-part-i-precision-and-recall-9250280bddc2", "anchor_text": "Precision and Recall"}, {"url": "https://towardsdatascience.com/multi-class-metrics-made-simple-part-ii-the-f1-score-ebe8b2c2ca1", "anchor_text": "F1-score"}, {"url": "https://www.rdocumentation.org/packages/psych/versions/1.8.12/topics/cohen.kappa", "anchor_text": "cohen.kappa() function"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bdea137af09c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----bdea137af09c---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/metrics?source=post_page-----bdea137af09c---------------metrics-----------------", "anchor_text": "Metrics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----bdea137af09c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbdea137af09c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&user=Boaz+Shmueli&userId=57ee515c83c5&source=-----bdea137af09c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbdea137af09c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&user=Boaz+Shmueli&userId=57ee515c83c5&source=-----bdea137af09c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbdea137af09c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bdea137af09c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbdea137af09c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bdea137af09c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bdea137af09c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bdea137af09c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bdea137af09c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bdea137af09c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bdea137af09c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bdea137af09c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bdea137af09c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bdea137af09c--------------------------------", "anchor_text": ""}, {"url": "https://shmueli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://shmueli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Boaz Shmueli"}, {"url": "https://shmueli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "740 Followers"}, {"url": "http://www.twitter.com/shmueli", "anchor_text": "www.twitter.com/shmueli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57ee515c83c5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&user=Boaz+Shmueli&userId=57ee515c83c5&source=post_page-57ee515c83c5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F36a7d451b5f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-metrics-made-simple-the-kappa-score-aka-cohens-kappa-coefficient-bdea137af09c&newsletterV3=57ee515c83c5&newsletterV3Id=36a7d451b5f&user=Boaz+Shmueli&userId=57ee515c83c5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}