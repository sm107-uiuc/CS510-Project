{"url": "https://towardsdatascience.com/flag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2", "time": 1682996975.947822, "path": "towardsdatascience.com/flag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2/", "webpage": {"metadata": {"title": "Flag Colours Visualisation \u2014 From Geopandas to Leaflet and back | by Haider Ali Punjabi | Towards Data Science", "h1": "Flag Colours Visualisation \u2014 From Geopandas to Leaflet and back", "description": "Data Visualisation has always interested me, and I am a long time lurker of r/dataisbeautiful. On 1st July 2019, a post about Frequency of Flag Colors by Continent caught the interest of many people\u2026"}, "outgoing_paragraph_urls": [{"url": "https://reddit.com/r/dataisbeautiful", "anchor_text": "r/dataisbeautiful", "paragraph_index": 0}, {"url": "https://www.reddit.com/r/dataisbeautiful/comments/c7lpmw/frequency_of_flag_colors_by_continent_imaginary/", "anchor_text": "a post about Frequency of Flag Colors by Continent", "paragraph_index": 0}, {"url": "https://github.com/HackeSta/atom-icons", "anchor_text": "previous project which used flag colour ratios to make Atom Icons", "paragraph_index": 1}, {"url": "https://stackoverflow.com/a/52879133/4698800", "anchor_text": "StackOverflow Post", "paragraph_index": 4}, {"url": "https://github.com/geopandas/geopandas/issues/387", "anchor_text": "Github Issue", "paragraph_index": 5}, {"url": "https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-0-countries/", "anchor_text": "Natural Earth Data Site", "paragraph_index": 14}, {"url": "http://kuanbutts.com/2018/08/30/geodataframe-to-svg/", "anchor_text": "This blog post helped me a lot in this attempt", "paragraph_index": 21}, {"url": "https://blog.haideralipunjabi.com/posts/country-flag-visualisation/", "anchor_text": "Read this on my blog", "paragraph_index": 26}, {"url": "https://dev.to/haideralipunjabi/flag-colours-visualisation-from-geopandas-to-leaflet-and-back-4ohk", "anchor_text": "Read this on Dev", "paragraph_index": 26}, {"url": "https://instagram.com/haideralipunjabi", "anchor_text": "Instagram", "paragraph_index": 27}, {"url": "https://github.com/haideralipunjabi", "anchor_text": "Github", "paragraph_index": 27}, {"url": "https://facebook.com/haiderali176", "anchor_text": "Facebook", "paragraph_index": 27}, {"url": "https://twitter.com/HAliPunjabi", "anchor_text": "Twitter", "paragraph_index": 27}, {"url": "https://haideralipunjabi.com/", "anchor_text": "Website", "paragraph_index": 27}, {"url": "https://blog.haideralipunjabi.com/", "anchor_text": "Blog", "paragraph_index": 27}], "all_paragraphs": ["Data Visualisation has always interested me, and I am a long time lurker of r/dataisbeautiful. On 1st July 2019, a post about Frequency of Flag Colors by Continent caught the interest of many people. It\u2019s from that post that I got the idea to make this visualisation.", "The idea was simple (execution was not), calculate the ratio of colours of each flag and colour each country on a map using those colours. I had a previous project which used flag colour ratios to make Atom Icons, so I knew I should be able to do this. Unfortunately, I was wrong, and it took me three attempts to visualise it properly.", "Before going into the details of each attempt, here are the sources of data I used.", "In my previous visualisations (simple choropleth maps), I have always used Geopandas. It can export high-quality images very easily.", "The first thing I worked on was to calculate the colour ratios for each country present in the map. I modified the code from the following StackOverflow Post to suit my needs.", "The problem in this attempt came when trying to colour the countries. Geopandas can\u2019t fill a polygon using multiple colours. For a while, I thought about compromising and fill with the most dominant colour only. Achieving that was also difficult, the nearest possible solution I found was this Github Issue.", "I wasn\u2019t able to fill the most dominant colour, so I gave up on using Geopandas.", "After sitting on it for a while, I remembered that LeafletJS uses CSS to style the maps. So, after saving the flag colours data to a JSON file, I started my second attempt at visualising it, now with LeafletJS.", "I had high hopes from LeafletJS, and it was successful, to some extent. I was almost right about Leaflet supporting gradients using CSS.", "Leaflet makes SVG elements which don\u2019t support CSS gradients but their own gradient elements.", "I was easily able to colour the most dominant colour but making a gradient proved to be difficult.", "I had to create elements for each gradient and link it to each SVG path.", "I added the country code to each path using the following code", "and then on the add\\ event of leaflet map, added the following code", "This was able to produce the gradient map like I wanted, but after looking to add attributions, I came across the following disclaimer on the Natural Earth Data Site", "Natural Earth Vector draws boundaries of countries according to defacto status. We show who actually controls the situation on the ground. Please feel free to mashup our disputed area themes to match your particular political outlook.", "To avoid issues later, I decided to add the disputed areas map and fill them with white colour.", "It took a bit of refactoring, but I was able to easily merge the two maps with the following code.", "I thought I was done but exporting the map to a good image proved impossible. I tried many plugins, but none produced a good enough image. A thought came to my mind about copying the SVGs from the developer tools and using Inkscape to produce a good image but Leaflet renders different paths for different zoom levels. Less detailed paths when the map is completely zoomed out and detailed but only the zoomed in portion is rendered otherwise.", "This attempt also failed but gave me another idea. Converting Geopandas DataFrames to SVGs.", "After failing to use LeafletJS, I came back to GeoPandas with another idea. Exporting GeoPandas as SVG and then applying a gradient to it. My initial idea was to add gradients from the Leaflet generated maps but didn\u2019t need to.", "This blog post helped me a lot in this attempt", "I added code from the blog to my code from Attempt 1, and modified it to suit my needs.", "This was able to produce the map", "I added the text and background using Inkscape", "After sharing the map on various sites, many asked about the missing France. I am not good at geography but trusted my code to make sure it didn\u2019t miss a country. So I did some debugging and research and came to know that the shapefile I was using didn\u2019t have ISOA2 data stored for France and Norway. My code uses the ISO A2 data to match flag files with the map so the missing data resulted in missing countries. I hardcoded a couple of if statements to include both the countries and the code above is updated for that.", "Read this on my blogRead this on Dev", "Say Hello: Instagram | Github | Facebook | Twitter | Website | Blog", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F28f6400980f2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----28f6400980f2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28f6400980f2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://haideralipunjabi.medium.com/?source=post_page-----28f6400980f2--------------------------------", "anchor_text": ""}, {"url": "https://haideralipunjabi.medium.com/?source=post_page-----28f6400980f2--------------------------------", "anchor_text": "Haider Ali Punjabi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8409251ef0b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&user=Haider+Ali+Punjabi&userId=8409251ef0b0&source=post_page-8409251ef0b0----28f6400980f2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28f6400980f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28f6400980f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://reddit.com/r/dataisbeautiful", "anchor_text": "r/dataisbeautiful"}, {"url": "https://www.reddit.com/r/dataisbeautiful/comments/c7lpmw/frequency_of_flag_colors_by_continent_imaginary/", "anchor_text": "a post about Frequency of Flag Colors by Continent"}, {"url": "https://github.com/HackeSta/atom-icons", "anchor_text": "previous project which used flag colour ratios to make Atom Icons"}, {"url": "https://naturalearthdata.com/downloads/", "anchor_text": "https://naturalearthdata.com/downloads/"}, {"url": "https://github.com/hjnilsson/country-flags", "anchor_text": "https://github.com/hjnilsson/country-flags"}, {"url": "https://stackoverflow.com/a/52879133/4698800", "anchor_text": "StackOverflow Post"}, {"url": "https://github.com/geopandas/geopandas/issues/387", "anchor_text": "Github Issue"}, {"url": "https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-0-countries/", "anchor_text": "Natural Earth Data Site"}, {"url": "http://kuanbutts.com/2018/08/30/geodataframe-to-svg/", "anchor_text": "This blog post helped me a lot in this attempt"}, {"url": "https://i.imgur.com/2RD4s6k.png", "anchor_text": "https://i.imgur.com/2RD4s6k.png"}, {"url": "http://geopandas.org/", "anchor_text": "GeoPandas"}, {"url": "https://leafletjs.com/", "anchor_text": "LeafletJS"}, {"url": "https://developer.mozilla.org/en-US/docs/Web/SVG/Element/linearGradient", "anchor_text": "linearGradient"}, {"url": "https://github.com/haideralipunjabi/country-flag-visualisation", "anchor_text": "Github Repository"}, {"url": "https://blog.haideralipunjabi.com/posts/country-flag-visualisation/", "anchor_text": "Read this on my blog"}, {"url": "https://dev.to/haideralipunjabi/flag-colours-visualisation-from-geopandas-to-leaflet-and-back-4ohk", "anchor_text": "Read this on Dev"}, {"url": "https://instagram.com/haideralipunjabi", "anchor_text": "Instagram"}, {"url": "https://github.com/haideralipunjabi", "anchor_text": "Github"}, {"url": "https://facebook.com/haiderali176", "anchor_text": "Facebook"}, {"url": "https://twitter.com/HAliPunjabi", "anchor_text": "Twitter"}, {"url": "https://haideralipunjabi.com/", "anchor_text": "Website"}, {"url": "https://blog.haideralipunjabi.com/", "anchor_text": "Blog"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28f6400980f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&user=Haider+Ali+Punjabi&userId=8409251ef0b0&source=-----28f6400980f2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F28f6400980f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&user=Haider+Ali+Punjabi&userId=8409251ef0b0&source=-----28f6400980f2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28f6400980f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----28f6400980f2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F28f6400980f2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----28f6400980f2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----28f6400980f2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----28f6400980f2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----28f6400980f2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----28f6400980f2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----28f6400980f2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----28f6400980f2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----28f6400980f2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----28f6400980f2--------------------------------", "anchor_text": ""}, {"url": "https://haideralipunjabi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://haideralipunjabi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Haider Ali Punjabi"}, {"url": "https://haideralipunjabi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8409251ef0b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&user=Haider+Ali+Punjabi&userId=8409251ef0b0&source=post_page-8409251ef0b0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F8409251ef0b0%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fflag-colours-visualisation-from-geopandas-to-leaflet-and-back-28f6400980f2&user=Haider+Ali+Punjabi&userId=8409251ef0b0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}