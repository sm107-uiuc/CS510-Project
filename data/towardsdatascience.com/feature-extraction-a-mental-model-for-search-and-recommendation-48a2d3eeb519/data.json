{"url": "https://towardsdatascience.com/feature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519", "time": 1683012738.77823, "path": "towardsdatascience.com/feature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519/", "webpage": {"metadata": {"title": "Feature Extraction: a mental model for search and recommendation | by David Shvimer | Towards Data Science", "h1": "Feature Extraction: a mental model for search and recommendation", "description": "I can\u2019t think of a better user experience. Google Lens, Amazon StyleSnap, and Syte all have the right idea. Recently, I wrote about Milvus, a vector similarity search engine. I was able to get a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://lens.google.com/", "anchor_text": "Google Lens", "paragraph_index": 1}, {"url": "https://affiliate-program.amazon.com/resource-center/amazon-influencers-introducing-stylesnap", "anchor_text": "Amazon StyleSnap", "paragraph_index": 1}, {"url": "https://www.syte.ai/", "anchor_text": "Syte", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/up-and-running-with-milvus-2466161e8b1f", "anchor_text": "I wrote about Milvus", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/dogs-vs-cats", "anchor_text": "kaggle", "paragraph_index": 19}, {"url": "https://github.com/dshvimer/feature-extraction", "anchor_text": "GitHub", "paragraph_index": 19}, {"url": "https://towardsdatascience.com/image-similarity-using-triplet-loss-3744c0f67973", "anchor_text": "triplet network", "paragraph_index": 29}, {"url": "https://medium.com/@franky07724_57962/using-keras-pre-trained-models-for-feature-extraction-in-image-clustering-a142c6cdf5b1#:~:text=Let's%20consider%20VGG%20as%20our,model%20with%2019%20weight%20layers.", "anchor_text": "here", "paragraph_index": 31}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#silhouette-coefficient", "anchor_text": "Silhouette Coefficient", "paragraph_index": 31}, {"url": "https://www.linkedin.com/in/dshvimer", "anchor_text": "https://www.linkedin.com/in/dshvimer", "paragraph_index": 36}], "all_paragraphs": ["Image retrieval is such a cool concept.", "I can\u2019t think of a better user experience. Google Lens, Amazon StyleSnap, and Syte all have the right idea.", "Recently, I wrote about Milvus, a vector similarity search engine. I was able to get a quick and dirty image retrieval application working in a matter of minutes. I realized that building cool things was not out of reach, one of those empowered engineer moments. I found myself wanting to learn more about convolutional neural networks (CNNs) and how they work in image retrieval.", "Given some convolutional neural network, how do I choose a layer for feature extraction?", "The answers I found went something like:", "These answers left me unsatisfied. They gave no sense of direction. They left no threads to further investigate. I was scratching my head. I decided to dig deeper, and after some tinkering, I walked away with a method to test feature vector \u201csearch-ability\u201d. More importantly, I gained a stronger intuition for the architecture goals of a CNN.", "VGG16 is a convolutional neural network architecture. It performs very well in image classification and has a relatively simple architecture. To understand it\u2019s structure, I like to think about the network in two halves:", "The first half of the network (black and red) is known as the feature extractor. It is fed an image. It is responsible for extracting useful information from that image. As the data is passed forward, each layer requires less memory than the last to store information about the image.", "Here are the shapes of the intermediate layers in order, notice how the amount of information in each step is reduced:", "Why is that important? A successful network is one that has learned how to take any input, and compress the information in some way that is efficient for the task at hand. When the data is in a compressed form like this, it is referred to as a latent representation or embedding.", "The second half of the network (blue and gold), is responsible for taking some latent representation and performing some sort of task. In the case of VGG16 the task is often classification. This could mean outputting \u201ccat\u201d or \u201cdog\u201d to classify some image. This part of the network learns how to numerically make sense of the latent representations. From here it can classify, draw a bounding box, etc.", "In the context of image retrieval, we do not need the second half, so we will only focus on the first half. The feature extractor.", "My life is easier when I think about machine learning applications as data transformation problems. Those are the types of problems I can wrap my head around.", "Once we have a model, and that model can turn our input image into some latent representation. The results often come in the form of a tensor.", "There is nothing wrong with a tensor, but to make use of it we will need to flatten it into a vector. There are different ways to do this (max pooling, average pooling, or just flattening). Once we flatten our data, we have a vector of floating point numbers (features) that represent the image in some abstract way:", "Similar images will produce similar feature vectors. There are many ways to measure similarity, but the most common are euclidean distance and cosine similarity. The terms may sound unfamiliar, but the math behind them is nothing to be afraid of.", "Given all of this information, image retrieval can be broken down into the following steps:", "In fact, these steps can be applied to search or recommendation systems in general. They are by no means limited to images. Audio, text, video would all follow the same pattern", "Circling back to the task at hand, I wanted to figure out which layer in a CNN would lead to the best search results. I had one idea: a feature extractor that worked well for classification would also work well for search. I decided to test the idea, share the code, and my insights.", "The cats/dogs dataset used is available on kaggle. Once downloaded, I extracted the images into a directory named data.The code for this experiment is available on GitHub. The steps taken were as follows:", "A note on feature extraction with VGG16", "We need access to intermediate layers of our network. By default, the pre-trained VGG16 will only output the final layer. We can work around this by using the generic Model class in keras. In the following snippet we declare a model that outputs the pooling layer of each block.", "Here are the results from training a classifier (KNeighborsClassifier) with 10 fold cross validation. We see each subsequent layer is better than the last at classification. I said \u201cduh\u201d out loud to myself.", "The pre-trained VGG16 model was trained for classification. The imagenet dataset it trained on has cats and dogs in it after all! My experiment essentially confirmed that the first half of the network has learned how to represent information. The second half of the network that was discarded was easily replaced by our classification model.", "So what's the verdict in terms of search?", "The \u2018block5_pool\u2019 layer is going to do a nice job representing our images for search. It will not confuse cats and dogs often. This will result in a high recall score, which is a measure used in evaluating search relevance.", "But, what about intra class similarity?", "How well can the model determine that images of the same dog breed are more similar than images of different dog breeds?", "Well, if the network was never optimized for this task, there\u2019s no guarantee it can tell the difference. We may get lucky if for instance, intra class similarity depends on some attributes like color, shape, or texture. That\u2019s because those features were likely of high importance in the original classification task. If we were looking for more nuanced results, we would need to test with a more granular dataset to be completely confident. More granular might mean labelling each image by breed, color, size, etc.", "Often though, the problem is more nuanced than that. Consider a facial recognition system. Predicting that an image contains a face is not the same thing as recognizing a specific persons face. In these situations, one might consider using a triplet network.", "What if the dataset isn\u2019t labelled?", "Luckily, there's a tool for that! The methods described here demonstrate how to use the Silhouette Coefficient. This a metric used to evaluate how well a dataset will perform in unsupervised learning.", "a higher Silhouette Coefficient score relates to a model with better defined clusters", "Don\u2019t assume that this is the only available way to measure an unlabelled dataset. After all, a whole branch of ML exists that focuses on unsupervised learning.", "It really does vary by use case. At least now I can explain why.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I like to tinker with computers https://www.linkedin.com/in/dshvimer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F48a2d3eeb519&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dshvimer?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshvimer?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": "David Shvimer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0e3a9fe425b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&user=David+Shvimer&userId=e0e3a9fe425b&source=post_page-e0e3a9fe425b----48a2d3eeb519---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48a2d3eeb519&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48a2d3eeb519&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@anetakpawlik?utm_source=medium&utm_medium=referral", "anchor_text": "Aneta Pawlik"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://lens.google.com/", "anchor_text": "Google Lens"}, {"url": "https://affiliate-program.amazon.com/resource-center/amazon-influencers-introducing-stylesnap", "anchor_text": "Amazon StyleSnap"}, {"url": "https://www.syte.ai/", "anchor_text": "Syte"}, {"url": "https://towardsdatascience.com/up-and-running-with-milvus-2466161e8b1f", "anchor_text": "I wrote about Milvus"}, {"url": "https://arxiv.org/abs/1409.1556", "anchor_text": "VGG 16"}, {"url": "https://miro.com/", "anchor_text": "Created by David Shvimer using Miro"}, {"url": "https://miro.com/", "anchor_text": "Created by David Shvimer using Miro"}, {"url": "https://www.kaggle.com/c/dogs-vs-cats", "anchor_text": "kaggle"}, {"url": "https://github.com/dshvimer/feature-extraction", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/image-similarity-using-triplet-loss-3744c0f67973", "anchor_text": "triplet network"}, {"url": "https://github.com/omoindrot/tensorflow-triplet-loss", "anchor_text": "Image from this repo"}, {"url": "https://medium.com/@franky07724_57962/using-keras-pre-trained-models-for-feature-extraction-in-image-clustering-a142c6cdf5b1#:~:text=Let's%20consider%20VGG%20as%20our,model%20with%2019%20weight%20layers.", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/clustering.html#silhouette-coefficient", "anchor_text": "Silhouette Coefficient"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----48a2d3eeb519---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----48a2d3eeb519---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----48a2d3eeb519---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/search?source=post_page-----48a2d3eeb519---------------search-----------------", "anchor_text": "Search"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----48a2d3eeb519---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F48a2d3eeb519&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&user=David+Shvimer&userId=e0e3a9fe425b&source=-----48a2d3eeb519---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F48a2d3eeb519&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&user=David+Shvimer&userId=e0e3a9fe425b&source=-----48a2d3eeb519---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48a2d3eeb519&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F48a2d3eeb519&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----48a2d3eeb519---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----48a2d3eeb519--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshvimer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dshvimer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "David Shvimer"}, {"url": "https://medium.com/@dshvimer/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "18 Followers"}, {"url": "https://www.linkedin.com/in/dshvimer", "anchor_text": "https://www.linkedin.com/in/dshvimer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0e3a9fe425b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&user=David+Shvimer&userId=e0e3a9fe425b&source=post_page-e0e3a9fe425b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe16abd190405&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffeature-extraction-a-mental-model-for-search-and-recommendation-48a2d3eeb519&newsletterV3=e0e3a9fe425b&newsletterV3Id=e16abd190405&user=David+Shvimer&userId=e0e3a9fe425b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}