{"url": "https://towardsdatascience.com/how-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3", "time": 1683006163.887168, "path": "towardsdatascience.com/how-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3/", "webpage": {"metadata": {"title": "How I taught my computer to play Spot it! using OpenCV and Deep Learning | by Hennie de Harder | Towards Data Science", "h1": "How I taught my computer to play Spot it! using OpenCV and Deep Learning", "description": "A hobby of mine is playing board games and because I have some knowledge about CNNs, I decided to build an application that can beat humans in a card game. I wanted to build the model from scratch\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.opencv.org/master/", "anchor_text": "OpenCV", "paragraph_index": 4}, {"url": "https://github.com/henniedeharder/spotit/tree/master/DeepLearningSpotIt", "anchor_text": "GitHub", "paragraph_index": 11}, {"url": "https://medium.com/technologymadeeasy/the-best-explanation-of-convolutional-neural-networks-on-the-internet-fbb8b1ad5df8", "anchor_text": "this post", "paragraph_index": 12}, {"url": "https://github.com/henniedeharder/spotit/tree/master/DeepLearningSpotIt", "anchor_text": "GitHub", "paragraph_index": 22}, {"url": "https://hennie-de-harder.medium.com/subscribe", "anchor_text": "subscribe", "paragraph_index": 27}], "all_paragraphs": ["A hobby of mine is playing board games and because I have some knowledge about CNNs, I decided to build an application that can beat humans in a card game. I wanted to build the model from scratch with my own dataset, to see how well a model from scratch with a small dataset would perform. I chose to start with a not-too-hard game, Spot it! (a.k.a. Dobble).", "In the case you don\u2019t know Spot it! yet, here follows a short game explanation: Spot it! is a simple pattern recognition game in which players try to find an image shown on two cards. Each card in original Spot it! features eight different symbols, with the symbols varying in size from one card to the next. Any two cards have exactly one symbol in common. If you\u2019re the first one who finds that symbol, you win the card. Whoever has collected the most cards when the 55-card deck runs out wins.", "The first step of any data science problem is gathering data. I took some pictures with my phone, six of each card. That makes a total of 330 pictures. Four of them are shown below. You might think: is this enough to build a perfect Convolutional Neural Network? I will get back to that!", "Okay, we have the data, what\u2019s next? This is probably the most important part in order to succeed: processing the images. We need to extract the symbols shown on each card. There are some difficulties here. You can see in the pictures above that some symbols might be harder to extract: the snowman and ghost (third picture) and igloo (fourth picture) have a light color, and the stains (second picture) and exclamation mark (fourth picture) exist of multiple parts. To handle the light color symbols we add contrast to the images. After that we resize and save the image.", "We use the Lab color space for adding contrast. L stands for lightness, a is the color component ranging from green to magenta and b is the color component ranging from blue to yellow. We can extract these components easily with OpenCV:", "Now we add contrast to the Light component, merge the components back together and convert the image back to normal:", "Then we resize and save the image:", "Now the image is processed we can start with detecting the card on the image. It's possible to find the outer contours with OpenCV. Then we need to convert the image to gray scale, choose a threshold (190 in this case) to create a black and white image, and find the contours. In code:", "If we sort the outer contours by area, we can find the contour with the biggest area: this is the card. We can create a white background to extract the symbols.", "Now it's symbol detection time! We can use the last image to detect outer contours again, these contours are the symbols. If we create a square around each symbol we can extract this region. The code is a bit longer:", "Now comes the boring part! It's time to sort the symbols. We need a train, test and validation directory, containing 57 directories each (we have 57 different symbols). The folder structure looks like this:", "It takes some time to put the extracted symbols (over 2500) in the right directories! I have code for creating the subfolders, the test and validation set on GitHub. Maybe it's better to do the sorting with a clustering algorithm next time\u2026", "Afther the boring part comes the cool part. Let\u2019s build and train a CNN. You can find information about CNNs in this post.", "This is a multiclass, single-label classification problem. We want one label for every symbol. That\u2019s why it's necessary to choose a last-layer activation softmax with 57 nodes and a categorical crossentropy loss function.", "The architecture of the final model looks like this:", "For better performance I used data augmentation. Data augmentation is the process of increasing the amount and diversity of input data. This is possible by rotating, shifting, zooming, cropping and flipping existing images. It\u2019s easy to perform data augmentation with Keras:", "In case you wondered, an augmented ghost looks like this:", "Let\u2019s fit the model, save it to use for predictions and check out the results.", "The baseline model I trained was without data augmentation, dropout and had less layers. This model gave the following results:", "You can clearly see this model is overfitting. The results of the final model (from the code in earlier paragraphs) are a lot better. In the image below you can see the accuracy and loss of the train and validation set.", "With the test set this model made only one mistake: it predicted a bomb as a drop. I decided to stick with the model, the accuracy was 0.995 on the test set.", "Now it\u2019s possible to predict the common symbol on two cards. We can use two images, make predictions for each image separately and use an intersection to see what symbol the cards both have. This gives three possibilities:", "The code is on GitHub for predicting all combinations of two images in a directory, the main.py file.", "Is this a perfect performing model? Unfortunately, no! When I took new pictures of cards and let the model predict the common symbol, it had some issues with the snowman. Sometimes it predicted an eye or a zebra as a snowman! That gives some strange results:", "Is this model better than humans? It depends: humans can do it perfectly, but the model is faster! I timed the computer: I gave it the 55 card deck and asked the common symbol for every combination of two cards. That\u2019s a total of 1485 combinations. This took the computer less than 140 seconds. The computer made some mistakes, but it will definitely beat any human when it comes to speed!", "I don\u2019t think it\u2019s really hard to build a 100% performing model. It can e.g. be done by using transfer learning. To understand what the model is doing we could visualize the layers for a test image. Things to try next time!", "I hope you enjoyed reading this post! \u2764", "Don\u2019t forget to subscribe if you\u2019d like to get an email whenever I publish a new article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "\ud83d\udcc8 Data Scientist with a passion for math \ud83d\udcbb Currently working at IKEA and BigData Republic \ud83d\udca1 I share tips & tricks and fun side projects"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fad1f017a3ec3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://hennie-de-harder.medium.com/?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": ""}, {"url": "https://hennie-de-harder.medium.com/?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": "Hennie de Harder"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb96be98b7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&user=Hennie+de+Harder&userId=fb96be98b7b9&source=post_page-fb96be98b7b9----ad1f017a3ec3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad1f017a3ec3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad1f017a3ec3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://docs.opencv.org/master/", "anchor_text": "OpenCV"}, {"url": "https://github.com/henniedeharder/spotit/tree/master/DeepLearningSpotIt", "anchor_text": "GitHub"}, {"url": "https://medium.com/technologymadeeasy/the-best-explanation-of-convolutional-neural-networks-on-the-internet-fbb8b1ad5df8", "anchor_text": "this post"}, {"url": "https://github.com/henniedeharder/spotit/tree/master/DeepLearningSpotIt", "anchor_text": "GitHub"}, {"url": "https://towardsdatascience.com/solving-mtvs-are-you-the-one-is-it-possible-to-never-lose-992488277099", "anchor_text": "Solving MTV\u2019s \u2018Are You The One?\u2019: Is It Possible to Never Lose?Game of love or game of logic?towardsdatascience.com"}, {"url": "https://towardsdatascience.com/solving-nonograms-with-120-lines-of-code-a7c6e0f627e4", "anchor_text": "Solving Nonograms with 120 Lines of CodePuzzles, combinations and solution gifs.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/snake-played-by-a-deep-reinforcement-learning-agent-53f2c4331d36", "anchor_text": "Snake Played by a Deep Reinforcement Learning AgentWith blooperstowardsdatascience.com"}, {"url": "https://hennie-de-harder.medium.com/subscribe", "anchor_text": "subscribe"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ad1f017a3ec3---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/opencv?source=post_page-----ad1f017a3ec3---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----ad1f017a3ec3---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/cnn?source=post_page-----ad1f017a3ec3---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ad1f017a3ec3---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad1f017a3ec3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&user=Hennie+de+Harder&userId=fb96be98b7b9&source=-----ad1f017a3ec3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fad1f017a3ec3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&user=Hennie+de+Harder&userId=fb96be98b7b9&source=-----ad1f017a3ec3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fad1f017a3ec3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fad1f017a3ec3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ad1f017a3ec3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ad1f017a3ec3--------------------------------", "anchor_text": ""}, {"url": "https://hennie-de-harder.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://hennie-de-harder.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Hennie de Harder"}, {"url": "https://hennie-de-harder.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffb96be98b7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&user=Hennie+de+Harder&userId=fb96be98b7b9&source=post_page-fb96be98b7b9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F262470d3fe9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-learned-my-computer-to-play-spot-it-using-opencv-and-deep-learning-ad1f017a3ec3&newsletterV3=fb96be98b7b9&newsletterV3Id=262470d3fe9a&user=Hennie+de+Harder&userId=fb96be98b7b9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}