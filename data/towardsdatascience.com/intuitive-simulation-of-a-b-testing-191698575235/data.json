{"url": "https://towardsdatascience.com/intuitive-simulation-of-a-b-testing-191698575235", "time": 1683012601.188732, "path": "towardsdatascience.com/intuitive-simulation-of-a-b-testing-191698575235/", "webpage": {"metadata": {"title": "Intuitive Simulation of A/B Testing | by Juan Crist\u00f3bal Andrews | Towards Data Science", "h1": "Intuitive Simulation of A/B Testing", "description": "Intuitive and Conceptual Understanding of A/B Tests, Chi-Square, Type I and II Errors, Confidence Intervals, and Statistical Power Through Simulations"}, "outgoing_paragraph_urls": [{"url": "http://linkedin.com/in/crisandrews/", "anchor_text": "linkedin.com/in/crisandrews/", "paragraph_index": 61}], "all_paragraphs": ["Many of us have heard, read, or even performed an A/B Test before, which means we have conducted a statistical test at some point. Most of the time, we have worked with data from first or third-party sources and performed these tests with ease by either using tools ranging from Excel to Statistical Software and even more automated solutions such as Google Optimize.", "If you are like me, you might be curious about how these types of tests work and how concepts such as Type I and Type II Error, Confidence Intervals, Effect Magnitude, Statistical Power, and others interact with each other.", "In this post, I would like to invite you to take a different approach for one specific type of A/B test, which makes use of a particular statistic called Chi-Squared. In particular, I will try to explore and walk through this type of test by taking the great but long road of simulations, avoiding libraries and tables, hopefully managing to explore and build some of the intuition behind it.", "Even though we could use data from our past experiments or even third-party sources such as Kaggle, it would be more convenient for this post to generate our data. It will allow us to compare our conclusions with a known ground truth; otherwise, it will be most likely unknown.", "For this example, we will generate a dummy dataset that will represent six different versions of a signup form and the number of leads we observed on each. For this dummy set to be random and have a winner version that will serve us as ground truth, we will generate this table by simulating some biased dice\u2019s throws.", "For this, we have generated an R function that simulates a biased dice in which we have a 20% probability of lading in 6 while a 16% chance of landing in any other number.", "Think of each Dice number as a representation of a different landing version (1\u20136 or A-F). For each version, we will throw our Dice 300 times, and we will write down its results as follows:", "As commented earlier, this is what we got:", "We can observe from our first ten results that we got one Signup for F, D, and A. In aggregated terms, our table looks like this:", "From now own, think of this table as Dice throws, eCommerce conversions, surveys, or a Landing Page Signup Conversion as we will use here, it does not matter, use whatever is more intuitive for you.", "For us, it will be signups, so we should produce this report:", "We will now aggregate our results, including both our Signup (1) and Did not Signup (0) results, which will allow us to understand better how these differ from our expected values or frequencies; this is also called a Cross Tabulation or Contingency Table.", "Since we know how our Cross Tabulation looks, we can now generate a table simulating how we should expect our results to be like considering the same performance of all versions. It is equivalent to say that each version had the same Signup Conversion or probability in the case of our example or the expected result of a non-biased dice if you prefer.", "We know our test had a higher-performing version not only by visually inspecting the results but because we purposely designed it to be that way.", "This is the moment we have waited for: is it possible for us to prove this solely based on the results we got?.", "The answer is yes, and the first step is to define our Null and Alternative Hypothesis, which we will later try to accept or reject.", "Our alternative hypothesis (H1) is what we want to prove correct, which states that there is, in fact, a relationship between the landing version and the result we observed. In contrast, our null hypothesis states that there is no relationship meaning there is no significant difference between our observed and expected frequencies.", "Our goal is to find how often our observed data is located in a universe where our null hypothesis is correct, meaning, where our observed and expected signup frequencies have no significant difference.", "A useful statistic that\u2019s able to sum up all these values; six columns (one for each version) and two rows (one for each signup state) into a single value is Chi-Square, which is calculated as follows:", "We will not get into details of how this formula can be found neither of its assumptions or requirements (such as Yates Correction), because it is not the subject of this post. On the contrary, we would like to perform a numerical approach through simulations, which should shed some light on these types of hypothesis tests.", "Resuming, if we compute this formula with our data, we get:", "We need to obtain the probability of finding a statistic as extreme as the one we observed, which in this case, is represented by Chi-Square equal to 10.368. This, in terms of probability, is also known as our P-Value.", "For this, we will simulate a Null Distribution as a benchmark. What this means is that we need to generate a scenario in which our Null Distribution is correct, suggesting a situation where there is no relationship between the landing version and the observed signup results (frequencies) we got.", "A solution that rapidly comes to mind is to repeat our experiment from scratch, either by re-collecting results many times or, as in the context of this post, using an unbiased dice to compare how our observed results behave in contrast to these tests. Even though this might seem intuitive at first, in real-world scenarios, this solution might not be the most efficient one since it would require extreme use of resources such as time and budget to repeat this A/B test many times.", "An excellent solution to the problem discussed above is called resampling. What resampling does is make one variable independent of the other by shuffling one of them randomly. If there were an initial relationship between them, this relation would be lost due to the random sampling method.", "In particular, we need to use the original (unaggregated) samples for this scenario. We will later permutate one of the columns several times, which will be Signup status in this case.", "In particular, let us see an example of 2 shuffles for the first \u201c10 samples\u201d shown earlier:", "Let us try it now with the complete (1800) sample set:", "As seen in both permutations of our data, we got utterly different summaries and Chi-Squared values. We will repeat this process a bunch of times to explore what we can obtain at a massive scale.", "Let us simulate 15k permutations of our data.", "As we can observe below, our 15k permutations look like it is distributed with a distinct shape and resembles, as expected, a Chi-Square distribution. With this information, we can now calculate how many of the 15k iterations, we observed a Chi-Squared value as extreme as our initial 10.36 calculation.", "Let us calculate how many times we obtained a Chi-Square value equal to or higher than 10.368 (our calculated score).", "We now have our P-Value, which means that if the Null Hypothesis is correct, saying there is no relationship between Version and Signups, we should encounter a Chi-Square as extreme only a small 6.5% of the time. If we think of this as only dice results, we should expect \u201cresults as biased as ours\u201d even by throwing an unbias dice at most 6.5% of the time.", "Now we need to define our decision limits on which we accept or reject our null hypothesis.", "We calculated our decision limits for 90%, 95%, and 99% confidence intervals, meaning which Chi-Squared values we should expect as a limit on those odds.", "As observed by the classical \u201cChi-Square Distribution Table\u201d, we can find very similar values from the ones we obtained from our simulation, which means our confidence intervals and P-Values should be very accurate.", "As we expected, we can reject the Null Hypothesis and claim that there is a significant relationship between versions and signups. Still, there is a small caveat, and this is our level of confidence. As observed in the calculations above, we can see that our P-Value (6.5%) is just between 90% and 95% confidence intervals, which means, even though we can reject our Null Hypothesis with 90% confidence, we cannot reject it at 95% or any superior confidence level.", "If we claim to have 90% confidence, then we are also claiming there is a 10% chance of wrongly rejecting our null hypothesis (also called Type I Error, False Positive, or Alpha). Note, in reality, such standard arbitrary values (90%,95%, 99%) are used, but we could easily claim we are 93.5% certain since we calculated a 6.5% probability of a Type I Error.", "Interestingly, even though we know for sure there is a relationship between version and signups, we cannot prove this by mere observation, simulations, and neither by doing this hypothesis test with a standard 95% confidence level. This concept of failing to reject our Null Hypothesis even though we know it is wrong is called a false negative or Type II Error (Beta), which is dependent on the Statistical Power of this test, which measures the probability that this does not happen.", "In our hypothesis test, we saw we were unable to reject our Null Hypothesis even at standard values intervals such as 95% confidence or more. This is due to the Statistical Power (or Power) of the test we randomly designed, which is particularly sensitive to our statistical significance criterion discussed above (alpha or Type I error) and both effect magnitude and sample sizes.", "In particular, we can calculate our current statistical Power by answering the following question:", "Let us try answering this question:", "How many times did we observe P-Values as extreme as 5%?", "Which percent of the times did we observe this scenario?", "As calculated above, we observe a Power equivalent to 21.91% (0.219), which is quite low since the gold standard is around 0.8 or even 0.9 (90%). In other words, this means we have a 78.09% (1 \u2014 Power) probability of making a Type II Error or, equivalently, a 78% chance of failing to reject our Null Hypothesis at a 95% confidence interval even though it is false, which is what happened here.", "As mentioned, Power is a function of:", "We designed an experiment with a relatively small effect magnitude since our Dice was only biased in one face (6) with only a slight additional chance of landing in its favor.", "In simple words, our effect magnitude (w) is calculated as follows:", "1) Where our Observed Proportions are calculated as follow:", "Finally, we can obtain our effect size as follows:", "Similarly to our effect size, our sample sizes, even though it seems of enough magnitude (1800), is not big enough to spot relationship (or bias) at 95% confidence since our effect size, as we calculated, was very small. We can expect an inverse relationship between sample sizes and effect magnitude. The more significant the effect, the lower the sample size needed to prove it at a given significance level.", "At this time, it might be more comfortable to think sample sizes of our A/B test as dice or even coin throws. It is somewhat intuitive that with one dice/coin throw, we will be unable to spot a biased dice/coin, but if 1800 throws are not high enough to detect this small effect at a 95% confidence level, this leads us to the following question: how many throws do we need?", "The same principle applies to the sample size of our A/B test. The lesser the effect, such as small variations in conversion from small changes in each version (colors, fonts, buttons), the bigger the sample and, therefore, the time we need to collect the data required to accept or reject our hypothesis. A common problem in many A/B tests concerning website conversion in eCommerce is that tools such as Google Optimize can take many days, if not weeks, and most of the time, we do not encounter a conclusive answer.", "To solve this, first, we need to define the Statistical Power we want. Next, we will try answering this question by iterating different values of N until we minimize the difference between our Expected Power and the Observed Power.", "As seen above, after different iterations of N, we obtained a recommended sample of 8.017 and 10.293 for 0.8 and 0.9 Power values, respectively.", "Let us repeat the experiment from scratch and see which results we get for these new sample size of 8.017 suggested by aiming a commonly used Power of 0.8.", "As expected by our new experiment design of sample size equal to 8017, we were able to reduce our P-Value to 1.9%.", "Additionally, we observe a Statistical Power equivalent to 0.79 (very near our goal), which implies we were able to reduce our Type II Error (non-rejection of our false null hypothesis) to just 21%!", "This allows us to conclude with 95% confidence (in reality 98.1%) that there is, as we always knew, a statistically significant relationship between Landing Version and Signups. Now we need to test, with a given confidence level, which version was the higher performer; this will covered in Part II of this post.", "If you have any questions or comments, do not hesitate to post them below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Marketing & eCommerce Manager | Director @ JetSMART Airlines | Contact: linkedin.com/in/crisandrews/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F191698575235&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----191698575235--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----191698575235--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@juancristbalandrews?source=post_page-----191698575235--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juancristbalandrews?source=post_page-----191698575235--------------------------------", "anchor_text": "Juan Crist\u00f3bal Andrews"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F472ce128a70c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&user=Juan+Crist%C3%B3bal+Andrews&userId=472ce128a70c&source=post_page-472ce128a70c----191698575235---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F191698575235&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F191698575235&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.shutterstock.com/", "anchor_text": "Shutterstock"}, {"url": "https://i.stack.imgur.com/PbEqv.jpg", "anchor_text": "Chi-Square Distribution Table"}, {"url": "http://www.utstat.toronto.edu/~brunner/oldclass/378f16/readings/CohenPower.pdf", "anchor_text": "Cohen, J. (1988)."}, {"url": "https://towardsdatascience.com/intuitive-simulation-of-a-b-testing-part-ii-8902c354947c", "anchor_text": "Intuitive Simulation of A/B Testing \u2014 Part IIIntuitive Understanding of Student\u2019s t-test, Type I and II Errors, Confidence Intervals, and Statistical Power Through\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/ab-testing?source=post_page-----191698575235---------------ab_testing-----------------", "anchor_text": "Ab Testing"}, {"url": "https://medium.com/tag/a-b-testing?source=post_page-----191698575235---------------a_b_testing-----------------", "anchor_text": "A B Testing"}, {"url": "https://medium.com/tag/statistics?source=post_page-----191698575235---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----191698575235---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/chi-square?source=post_page-----191698575235---------------chi_square-----------------", "anchor_text": "Chi Square"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F191698575235&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&user=Juan+Crist%C3%B3bal+Andrews&userId=472ce128a70c&source=-----191698575235---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F191698575235&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&user=Juan+Crist%C3%B3bal+Andrews&userId=472ce128a70c&source=-----191698575235---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F191698575235&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----191698575235--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F191698575235&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----191698575235---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----191698575235--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----191698575235--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----191698575235--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----191698575235--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----191698575235--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----191698575235--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----191698575235--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----191698575235--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juancristbalandrews?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@juancristbalandrews?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Juan Crist\u00f3bal Andrews"}, {"url": "https://medium.com/@juancristbalandrews/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "23 Followers"}, {"url": "http://linkedin.com/in/crisandrews/", "anchor_text": "linkedin.com/in/crisandrews/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F472ce128a70c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&user=Juan+Crist%C3%B3bal+Andrews&userId=472ce128a70c&source=post_page-472ce128a70c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F472ce128a70c%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitive-simulation-of-a-b-testing-191698575235&user=Juan+Crist%C3%B3bal+Andrews&userId=472ce128a70c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}