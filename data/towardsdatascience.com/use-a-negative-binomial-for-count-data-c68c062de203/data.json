{"url": "https://towardsdatascience.com/use-a-negative-binomial-for-count-data-c68c062de203", "time": 1683011838.6482298, "path": "towardsdatascience.com/use-a-negative-binomial-for-count-data-c68c062de203/", "webpage": {"metadata": {"title": "Use a Negative Binomial for Count Data | by Ravi Charan | Towards Data Science", "h1": "Use a Negative Binomial for Count Data", "description": "We compute properties of a Negative Binomial Distribution then discuss its interpretation as an over-dispersed Poisson and Poisson\u2013Gamma mixture"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Gamma_function", "anchor_text": "Gamma function", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Binomial_theorem", "anchor_text": "binomial theorem", "paragraph_index": 13}, {"url": "https://en.wikipedia.org/wiki/Negative_binomial_distribution#Relation_to_the_binomial_theorem", "anchor_text": "Wikipedia", "paragraph_index": 16}, {"url": "https://mathworld.wolfram.com/NegativeBinomialDistribution.html", "anchor_text": "Wolfram", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Poisson_distribution", "anchor_text": "Poisson distribution", "paragraph_index": 20}, {"url": "https://en.wikipedia.org/wiki/Gamma_distribution", "anchor_text": "Gamma distribution", "paragraph_index": 25}, {"url": "https://www.statsmodels.org/devel/generated/statsmodels.discrete.discrete_model.NegativeBinomial.html", "anchor_text": "statsmodels", "paragraph_index": 28}], "all_paragraphs": ["The Negative Binomial distribution is a discrete probability distribution that you should have in your toolkit for count data. For example, you might have data on the number of pages someone visited before making a purchase or the number of complaints or escalations associated with each customer service representative. Given this data, you might want to model the process and, later, see if some covariates affect the parameters. And in many contexts, you might find that a negative binomial distribution is a good fit.", "In this article we\u2019ll introduce the distribution and compute its probability mass function (PMF). We\u2019ll cover its basic properties (mean and variance) by using the binomial theorem. This is in contrast to the usual treatments you will find which either just give you a formula or use more complicated tools to derive the results. Finally, we\u2019ll turn to focus on the distributions\u2019 interpretations.", "Suppose you are going to flip a biased coin that has probability p of coming up heads, which we will call a \u201csuccess.\u201d Furthermore, you are going to flip the coin continuously until at r successes occur. Let k be the number of failures along the way (so k+r coin flips happen in total).", "In the context of our examples, we could imagine:", "Whether you actually think this is true is, as always, up to your prior beliefs and how well the model fits the data. Also, note that the number of failures is closely related to the number of events (k versus k plus r).", "It is relatively straightforward to write down the probability mass function using some combinatorics. The probability that the r-th success happens on the (k+r)-th coin flip is:", "There are (k+r\u20131) choose k orderings of (r\u20131) successes and k failure on the first k+r\u20131 flips. (The number of ways to arrange k A\u2019s and (r\u20131) B\u2019s in a line). Each has the same probability of occurring. This gives the PMF:", "Hopefully you remember some basic facts about combinations and permutations. If not, here is a brief review of facts you can convince yourself of to help you out. Suppose there are 3 A\u2019s and 2 B\u2019s and you want to arrange them into a string like \u201cAAABB\u201d or \u201cABABA\u201d. The number of ways to do this is 5 choose 2 (there are 5 total things and 2 B\u2019s) which is the same as 5 choose 3 (there are 3 A\u2019s). To see this, pretend that each letter is actually a distinct symbols (so the 5 symbols are A1, A2, A3, B1, B2). Then there are 5!=120 ways to arrange the distinct symbols. But there are 3!=6 ways to rearrange the A1 A2 A3 without changing the placements of the A\u2019s, and 2!=2 ways to arrange the B\u2019s. So the total number is 5!/2!3! = 10.", "Now, the trick is, binomials also work for negative numbers on top, or with non-integers. For example, if we expand what we have above, we can add a minus sign to each of the k terms in the numerator:", "The other trick to keep in mind is that we can define binomials with non-integer numbers. Using the fact that the \u0393 function (Gamma function) satisfies, for positive integers n,", "We can write our binomial coefficients in the form", "And this enables us to allow that, in the negative binomial distribution, the parameter r does not have to be an integer. This will be useful because when we estimate our models, we generally don\u2019t have a way to constrain r to be an integer. So a non-integer value for r won\u2019t be a problem. (We will require r to be positive, however). We\u2019ll come back to how to interpret a non-integer value of r.", "We would like to compute the expectation and variance. As a warmup, let\u2019s check that the negative binomial distribution is in fact a probability distribution. For convenience, let q=1\u2013p.", "The crucial point is the third line, where we used the binomial theorem (yes, it works with negative exponents).", "To get the third line, we used the identity", "Where we used the binomial theorem again to get the third to last line.", "Warning: this is the opposite of what you will find on Wikipedia as of this writing. It is what you will find from Wolfram (the makers of Mathematica). This is because Wikipedia thinks about the number of successes before r failures, where as we count failures before r successes. In general, there is a variety of similar ways to parameterize/interpret the distribution, so be careful you have everything straight when looking at formulas in different places.", "Next, we can compute the variance in two steps. First, we repeat the trick from above, using the identity twice this time to get the third line. We again use the binomial theorem to compute the sum and obtain the third-to-last line.", "Again, this is the opposite of what is on Wikipedia.", "We have covered the \u201cdefining interpretation\u201d of the Negative Binomial Distribution: it is the number of failures before r success occur, with the probability of success at each step being p. But there are a few other ways to look at the distribution that can be illuminating and also help interpret the case where r is not an integer.", "The Poisson distribution is a very simple model for count data, which assumes that events happen randomly at a certain rate. Then it models the distribution of how many events will occur in a given time interval. In the context of our examples, it would say that:", "One big problem with the Poisson distribution is that the variance is equal to the mean. This may not fit our data. Let\u2019s say we parameterize our Negative Binomial distribution with a mean \u03bb and stopping parameter r. Then we have", "Now let\u2019s consider what happens if we take the limit as r \u2192\u221e holding \u03bb fixed. (This means that the probability of success goes to 1 as well, in the way defined by p=r/[\u03bb+r]). In this limit, the binomial term approaches (\u2013r) to the power of k divided by k! and r + \u03bb approaches r.", "In the last line, the r to the k-th powers cancel and we have used the definition of the exponential. The result is that we recover the Poission distribution.", "Therefore, we can interpret the Negative Binomial Distribution as a generalization of the Poisson distribution. If the distribution is in fact Poission, we will see a large r and p close to 1. This makes sense because as p approaches 1, the variance approaches the mean. When p is smaller than one, the variance is higher than that of a Poisson distribution with the same mean, so we can see that the Negative Binomial distribution generalizes Poisson by increasing the variance.", "The Negative Binomial Distribution also arises as a mixture of Poisson random variables. For example, suppose that our customer service representatives each receive complaints at a given rate (they never change their behavior), but that rate varies between representatives. If that rate is randomly distributed according to a Gamma distribution, we get a Negative Binomial Distribution for the ensemble.", "The intuition behind this is as follows. We initially said the Negative Binomial Distribution was the count of failures before r successes when we do coin flips. Instead, replace the coin flip with two Poisson processes. Process one (the \u201csuccess\u201d process) has rate p and process two, the \u201cfailure\u201d process, has rate (1-p). This means that instead of thinking of the Negative Binomial Distribution as counting coin flips, we think that there are independent processes generating \u201csuccess\u201d and \u201cfailure\u201d independently and we just count how many failures before a certain number of successes.", "Now, the Gamma Distribution is the distribution of waiting times for Poisson processes. Let T be the waiting time for r successes from the \u201csuccess\u201d process. T is Gamma distributed. Then the number of failures has a mean of (1\u2013p)T and is Poisson distributed.", "The last few points worth pointing out. First of all, there is no analytic way to fit the Negative Binomial Distribution to data. Instead, use the Maximum Likelihood Estimator and numerical estimation. You can use the statsmodels package to do this in Python.", "Also, it is possible to do Negative Binomial regression, modeling the effects of covariates. We\u2019ll save that for a future article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist, Mathematician. Formerly @MIT, @McKinsey, currently teaching computers to read"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc68c062de203&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c68c062de203--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c68c062de203--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rmcharan?source=post_page-----c68c062de203--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rmcharan?source=post_page-----c68c062de203--------------------------------", "anchor_text": "Ravi Charan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F393ce2bbf82c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&user=Ravi+Charan&userId=393ce2bbf82c&source=post_page-393ce2bbf82c----c68c062de203---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc68c062de203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc68c062de203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@loic?utm_source=medium&utm_medium=referral", "anchor_text": "Djim Loic"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Gamma_function", "anchor_text": "Gamma function"}, {"url": "https://en.wikipedia.org/wiki/Binomial_theorem", "anchor_text": "binomial theorem"}, {"url": "https://en.wikipedia.org/wiki/Negative_binomial_distribution#Relation_to_the_binomial_theorem", "anchor_text": "Wikipedia"}, {"url": "https://mathworld.wolfram.com/NegativeBinomialDistribution.html", "anchor_text": "Wolfram"}, {"url": "https://en.wikipedia.org/wiki/Poisson_distribution", "anchor_text": "Poisson distribution"}, {"url": "https://en.wikipedia.org/wiki/Gamma_distribution", "anchor_text": "Gamma distribution"}, {"url": "https://www.statsmodels.org/devel/generated/statsmodels.discrete.discrete_model.NegativeBinomial.html", "anchor_text": "statsmodels"}, {"url": "https://medium.com/tag/statistics?source=post_page-----c68c062de203---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----c68c062de203---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c68c062de203---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----c68c062de203---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----c68c062de203---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc68c062de203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&user=Ravi+Charan&userId=393ce2bbf82c&source=-----c68c062de203---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc68c062de203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&user=Ravi+Charan&userId=393ce2bbf82c&source=-----c68c062de203---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc68c062de203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c68c062de203--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc68c062de203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c68c062de203---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c68c062de203--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c68c062de203--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c68c062de203--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c68c062de203--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c68c062de203--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c68c062de203--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c68c062de203--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c68c062de203--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rmcharan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rmcharan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ravi Charan"}, {"url": "https://medium.com/@rmcharan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "599 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F393ce2bbf82c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&user=Ravi+Charan&userId=393ce2bbf82c&source=post_page-393ce2bbf82c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F6bca6dd641ca&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fuse-a-negative-binomial-for-count-data-c68c062de203&newsletterV3=393ce2bbf82c&newsletterV3Id=6bca6dd641ca&user=Ravi+Charan&userId=393ce2bbf82c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}