{"url": "https://towardsdatascience.com/text-classification-supervised-unsupervised-learning-approaches-9fd5e01a036", "time": 1683010276.4286752, "path": "towardsdatascience.com/text-classification-supervised-unsupervised-learning-approaches-9fd5e01a036/", "webpage": {"metadata": {"title": "NLP Machine Learning Methods | Towards Data Science", "h1": "Text Classification: Supervised & Unsupervised Learning Approaches", "description": "A guide on classifier models, LDA & model deployment."}, "outgoing_paragraph_urls": [{"url": "https://git-lfs.github.com/", "anchor_text": "Git Large File Storage", "paragraph_index": 1}, {"url": "https://gist.github.com/puchokagnese/c8c4d5434508bd7704d3cfddb1049dd4", "anchor_text": "approach", "paragraph_index": 1}, {"url": "https://spacy.io/", "anchor_text": "spaCy", "paragraph_index": 1}, {"url": "https://github.com/AngShengJun/dsicapstone/tree/master/p03_dataclean_eda", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://www.ted.com/talks/hans_rosling_the_best_stats_you_ve_ever_seen", "anchor_text": "Hans Rosling", "paragraph_index": 3}, {"url": "https://www.imagemagick.org/script/index.php", "anchor_text": "ImageMagick", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/unsupervised-nlp-topic-models-as-a-supervised-learning-input-cf8ee9e5cf28", "anchor_text": "Marc Kelechava\u2019s", "paragraph_index": 8}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "flask", "paragraph_index": 15}, {"url": "https://gunicorn.org/", "anchor_text": "gunicorn", "paragraph_index": 16}, {"url": "https://github.com/AngShengJun/dsicapstone/tree/master/p05_deployment", "anchor_text": "Github", "paragraph_index": 17}, {"url": "https://enigmatic-reef-60524.herokuapp.com/", "anchor_text": "site", "paragraph_index": 25}, {"url": "https://github.com/AngShengJun/dsicapstone", "anchor_text": "here", "paragraph_index": 27}], "all_paragraphs": ["One and a half years ago, I chanced upon Python and Anaconda as a tool for Data Science (DS) while taking part in a Data Hackathon. The myriad of Python libraries underscored Python\u2019s versatility as a toolkit for data science. Sadly, I didn\u2019t possess the necessary skillset to utilize Python back then. Since then, I took online courses in Python and SQL, and gradually developed an interest in the field of DS. Seeking to expedite the transition into DS, I enrolled in the Data Science Immersive (DSI) program by General Assembly. The DSI is a 3 months intensive boot camp aimed at equipping students with basic data science knowledge and skillsets through experiential learning on a series of projects. In this article, I hope to share a few learning points as a beginner in DS through my capstone project on the classification of terrorist bombing attacks through motive (intel) text.", "There are several datasets relating to Global Terrorism available on Kaggle. For capstone, I used the dataset spanning 1970 to 2017. Due to the size of the dataset, I used Git Large File Storage to manage the pushing of files to Github. The dataset is encoded in ISO-8859\u20131 format, which one needs to specify for reading the file. Thankfully, this is among the few topics discussed on Kaggle. However, what if one comes across another format but is unsure of its encoding? This approach by Agnese Poikane-Puchok should come in handy. The dataset contains 181,691 entries and 135 variables describing the details of a particular terrorist incident. Being an NLP project, the main feature of interest is the motive text that described the context, perpetrator, goals, and source of information for any terrorist incident. I used spaCy to visualize the recognised entities and phrase structure within the motive texts. The consistency in phrasing helps build confidence in using it as input for text classification. It also showcased the importance of good data quality. Nevertheless, as the motive text is a feature that is introduced post-1997, only 32,521 entries have adequate textual data for text classification after data cleaning.", "The other variables used in EDA helped provide an understanding of global terrorism trends from most active groups to most favoured forms of attack and underlying motivations of terror groups. The other visualizations and the rationale for the choice of variables for EDA can be accessed here (README: p03_dataclean_ed, Jupyter notebook: P5.0 Data Cleaning, EDA, Feature engineering.ipynb). Some of the visuals that are directly related to feature engineering for text classification are extracted for illustration here.", "Inspired by the work of Hans Rosling, I explored using animation as a means of visualizing terrorist incidents from both spatial and temporal perspectives. I initially used ImageMagick for .gif generation but was unable to troubleshoot the technical issue (the generated .gif file self-deletes) and hence, fallback on third-party software for the .gif file. Visualising the proportion of various attack modes over the years, bombing remains the favored form of attack, accounting for ~50% of all attack modes.", "I would build a classifier model that takes the motive text as input and outputs a binary classification (bomb or non-bomb attack). I featured engineered bombing attacks as the positive class and all other attacks as the negative class. The class is relatively balanced with bombing attacks at 48%. The data is split 80\u201320 into Train/Test data. The Train data is then further split 80\u201320 into the train and validate subsets. For the classifier models, I explored Logistic Regression and Naive Bayes models. The results (based on validate(hold out) data set) are summarized below. The Logistic Regression model is the better performing model based on Sensitivity (intent is to reduce false negatives, which is predicted non-bombing attacks when they are actual bombings) and ROC AUC.", "Selecting the Logistic Regression model as the production model, I explored model tuning such as reviewing and removing words that lead to false-negative classifications and removing overlapping words. The results are summarized below.", "Topic modeling and Topic classification are commonly used by businesses to derive insights (e.g. customer sentiment) from unstructured data. A little primer on the difference between the two:", "LDA is a topic modeling method. While it is useful in uncovering word clusters (topics) from documents, it wasn\u2019t integrated with the text classifier model. The review and manual labeling of the data for topic classification is untenable due to the dataset. Also, I do not possess the necessary subject matter expertise to determine the potential topic that a given particular terrorist incident could belong to, based on the motive text.", "Marc Kelechava\u2019s article on using LDA topic models as classification model input served as an inspiration and provided valuable insights on how one might integrate topic models into a text classifier model. Behind every cluster of words for a topic, are the probability distributions of topics from each motive text entry. If a model trained on the topic distributions can generalize on unseen data, we can infer that the model has identified topics clusters (underlying motives in this context) that remain appliable to new unseen data.", "One key step lies in the extraction of the feature vectors for the topics. In my case, the optimum number of topics is 41.", "The model generalizes with a higher Sensitivity and ROC AUC on the test data set! The next question would naturally be \u201cWhat would be the model performance if one combines the tokens from CountVectorizer and the TPD from LDA?\u201d", "As the output from CountVectorizer is a sparse matrix of token counts, one need to do some conversion to enable the joining of the LDA output. There are many ways to do so. This is what I did:", "After this, the model prediction is relatively straightforward. The comparison of the various approaches is summarized below. While the model using combined TPD and tokens didn\u2019t perform as well as the one using CountVectorizer, it has potential.", "Heeding instructors\u2019 encouragement to try model deployment, I jumped right into it. Model deployment can be an exciting venture and a hairy business at the same time, especially for a beginner like myself. For model deployment, I used Heroku. It is a Platform as a Service (PaaS) that enables developers to build, run, and operate applications in the cloud. The step-by-step walkthrough below outlines some of the discoveries along my learning journey. Hopefully, it would come in handy for those seeking to deploy their models. Follow along and tailor the code to suit your own project needs.", "Consider how you want the deployed model to operate. For my capstone, the classifier model takes in a list of cleaned text, with custom stopwords removed. Upon the Instructor\u2019s guidance, I pickle the CountVectorizer, custom stopwords, and the production model. In Jupyter:", "To host your application (the model that you want to deploy), you will need flask and virtualenv as well. Install them using Anaconda Navigator or Anaconda prompt. Then set up a project directory space for hosting the project locally first. In my case, I already had the master directory for holding various projects, so the codes are slightly different. For my project needs, I created and named the virtual environment capstone. In Anaconda Prompt:", "Install gunicorn (for Heroku), freeze the python modules for your environment like so:", "Depending on one\u2019s project needs, one may consider configuring the requirements list. As I didn\u2019t use a majority of the modules, I manually trimmed the packages down (to reduce deployment times downstream). Please refer to the requirements.txt file on Github for details.", "Create an nltk.txt file in the root folder, populate it with the nltk modules used. This is for Heroku-python nltk use.", "Create a folder called templates to hold the html form.", "Move the index.html into this folder. Copy the pickle files into the root directory of the project virtualenv folder (i.e. capstone), hereafter termed as the root directory.", "Create python scripts in the root directory. These scripts are dependent on one\u2019s model and functional flow. Refer to Requiredfn.py and service.py (where I hold the application model) on Github for more details.", "To run the service, in Anaconda Prompt, enter the following sequentially. An URL should display where one may access the webpage and tune the webpage as needed in real-time.", "Create a Procfile in the root directory (no extensions!). Procfile only needs one line. The filename is the name of the python script that contains the flask application with a flask name app.", "Log in to Heroku, create the application and deploy like so using Anaconda Prompt", "The currently deployed model is simplistic in the sense it accepts only a single input (the motive text). In actual operations, it is not expected that the classification of intelligence falls squarely on the model. For the deployed model\u2019s input, I used an equal mix of motive texts related to both bombing and non-bombing attacks. Please head over to this site to try it out. Some may wonder why not create an input space for user input? Two considerations: 1) the current model set-up enables the linking of the entries to the ground-truth, and 2) considering the sensitivity of the subject matter, I would want to avoid gamification.", "I hope this has been an informative read and is useful for your project needs. I intend on extending the capstone on the following areas soon:", "The thought process on capstone topic selection to code for capstone and materials for model deployment is hosted on my GitHub here.", "Afternote (5Jul2020): I do recognize the generated .gif is somewhat small and hard to read, and am trying to figure out a way to maintain the resolution size of the generated .gif (world map animation). If you have an idea to do so, appreciate if you could suggest a way to do so. Thanks.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Engineer | Analyst | Matcha & Coffee lover | Iaidoka"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9fd5e01a036&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://shengjunang.medium.com/?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": ""}, {"url": "https://shengjunang.medium.com/?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": "ShengJun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F190a3dbe3c6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&user=ShengJun&userId=190a3dbe3c6e&source=post_page-190a3dbe3c6e----9fd5e01a036---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9fd5e01a036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9fd5e01a036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://archive.ics.uci.edu/ml/datasets.php", "anchor_text": "UCI"}, {"url": "https://www.kaggle.com/START-UMD/gtd", "anchor_text": "Global Terrorism Dataset (GTD)"}, {"url": "https://git-lfs.github.com/", "anchor_text": "Git Large File Storage"}, {"url": "https://gist.github.com/puchokagnese/c8c4d5434508bd7704d3cfddb1049dd4", "anchor_text": "approach"}, {"url": "https://spacy.io/", "anchor_text": "spaCy"}, {"url": "https://github.com/AngShengJun/dsicapstone/tree/master/p03_dataclean_eda", "anchor_text": "here"}, {"url": "https://www.ted.com/talks/hans_rosling_the_best_stats_you_ve_ever_seen", "anchor_text": "Hans Rosling"}, {"url": "https://www.imagemagick.org/script/index.php", "anchor_text": "ImageMagick"}, {"url": "https://towardsdatascience.com/unsupervised-nlp-topic-models-as-a-supervised-learning-input-cf8ee9e5cf28", "anchor_text": "Marc Kelechava\u2019s"}, {"url": "https://gitforwindows.org/", "anchor_text": "Git"}, {"url": "https://devcenter.heroku.com/articles/heroku-cli#download-and-install", "anchor_text": "Heroku Command Line Interface"}, {"url": "https://flask.palletsprojects.com/en/1.1.x/", "anchor_text": "flask"}, {"url": "https://gunicorn.org/", "anchor_text": "gunicorn"}, {"url": "https://github.com/AngShengJun/dsicapstone/tree/master/p05_deployment", "anchor_text": "Github"}, {"url": "https://enigmatic-reef-60524.herokuapp.com/", "anchor_text": "site"}, {"url": "https://github.com/AngShengJun/dsicapstone", "anchor_text": "here"}, {"url": "https://medium.com/tag/text-classification?source=post_page-----9fd5e01a036---------------text_classification-----------------", "anchor_text": "Text Classification"}, {"url": "https://medium.com/tag/nlp?source=post_page-----9fd5e01a036---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9fd5e01a036---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9fd5e01a036---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/word-cloud?source=post_page-----9fd5e01a036---------------word_cloud-----------------", "anchor_text": "Word Cloud"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9fd5e01a036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&user=ShengJun&userId=190a3dbe3c6e&source=-----9fd5e01a036---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9fd5e01a036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&user=ShengJun&userId=190a3dbe3c6e&source=-----9fd5e01a036---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9fd5e01a036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9fd5e01a036&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9fd5e01a036---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9fd5e01a036--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9fd5e01a036--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9fd5e01a036--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9fd5e01a036--------------------------------", "anchor_text": ""}, {"url": "https://shengjunang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://shengjunang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "ShengJun"}, {"url": "https://shengjunang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "140 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F190a3dbe3c6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&user=ShengJun&userId=190a3dbe3c6e&source=post_page-190a3dbe3c6e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa250f90c3a7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftext-classification-supervised-unsupervised-learning-approaches-9fd5e01a036&newsletterV3=190a3dbe3c6e&newsletterV3Id=a250f90c3a7f&user=ShengJun&userId=190a3dbe3c6e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}