{"url": "https://towardsdatascience.com/data-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45", "time": 1683014091.183984, "path": "towardsdatascience.com/data-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45/", "webpage": {"metadata": {"title": "Data to Text generation with T5; Building a simple yet advanced NLG model | by Mathew Alexander | Towards Data Science", "h1": "Data to Text generation with T5; Building a simple yet advanced NLG model", "description": "The Data to text generation capability of NLG models is something that I have been exploring since the inception of sequence to sequence models in the field of NLP. The earlier attempts to tackle\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/simplenlg/simplenlg", "anchor_text": "simple NLG", "paragraph_index": 0}, {"url": "https://webnlg-challenge.loria.fr/challenge_2017/", "anchor_text": "web NLG 2017", "paragraph_index": 2}, {"url": "https://arxiv.org/pdf/1910.10683.pdf", "anchor_text": "T5", "paragraph_index": 4}, {"url": "https://gitlab.com/shimorina/webnlg-dataset/-/tree/master/release_v3.0", "anchor_text": "data", "paragraph_index": 7}, {"url": "https://gitlab.com/webnlg/corpus-reader", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://docs.python.org/3/library/xml.etree.elementtree.html#module-xml.etree.ElementTree", "anchor_text": "xml.etree.ElementTree", "paragraph_index": 10}, {"url": "https://github.com/huggingface/transformers", "anchor_text": "hugging face", "paragraph_index": 12}, {"url": "https://github.com/MathewAlexander/T5_nlg.git", "anchor_text": "repo", "paragraph_index": 23}], "all_paragraphs": ["The Data to text generation capability of NLG models is something that I have been exploring since the inception of sequence to sequence models in the field of NLP. The earlier attempts to tackle this problem were not showing any promising results. The non- ML Rule-based approaches like simple NLG did not seem to scale well as they require a well-formatted input and can only perform tasks such as changing the tense of the sentence. But in the age of language models, where new variants of transformers are getting released every two weeks, a task like this is not a far-fetched dream anymore.", "In this blog, I will discuss how I approached the Data-to-text generation problem with advanced deep learning models.", "The openAI GPT-2 seemed like a good option as it had compelling text generation capabilities. But training it on the web NLG 2017 data didn\u2019t get me anywhere. The model didn\u2019t converge at all. The conditional, as well as the unconditional text generation capabilities of GPT-2, are reasonably good, but you would hardly find a business use case that can be addressed with these tasks.", "Furthermore, finetuning them on the domain-specific data at times resulted in the generation of the sentences which were out of context", "With openAI(Not so open) not releasing the code of GPT-3, I was left with second best in the series, which is T5.", "Google\u2019s T5 is a Text-To-Text Transfer Transformer which is a shared NLP framework where all NLP tasks are reframed into a unified text-to-text-format where the input and output are always text strings.", "It is quite different from the BERT-style models that can only output either a class label or a span of the input. The T5 allows us to use the same model along with the loss function and hyperparameters on any NLP task.", "I used the data of the RDF-to-text generation task from WebNLG Challenge 2020 to train the T5.", "Given the four RDF triples shown in (a), the aim is to generate a text such as (b)", "Trane, which was founded on January 1st, 1913 in La Crosse, Wisconsin, is based in Ireland. It has 29,000 employees.", "To preprocess the data, one can make use of The XML WebNLG data reader in Python here, or use the xml.etree.ElementTree module as given in the code below. (I ended up using the latter as I was too ignorant to read the entire challenge documentation \ud83d\ude10)", "In the code, you can see that we keep the normal triplets as it is and join multiple triplets with \u201c&&\u201d.It can be thought of as a separator when multiple rows of a table are fed into the model at once.", "As always, google\u2019s TensorFlow implementation being really tough to interpret, I went ahead with the hugging face\u2019s PyTorch implementation and chose the T5 base model. The entire model training was performed in google colab.", "Load the preprocessed data and randomly shuffle the rows to have triplets with different lengths (1 triplet to 7triplets) distributed across the data frame and hence to generalize the loss quickly.Trimming off a few data points and so that a batch would not leave any remainder, hence some lines of codes can be avoided (Okay, this might be a hackish way of doing it ).", "Loading the pre-trained models, tokenizers, and moving the model into GPU.", "Initiating the Adafactor optimizer with recommended T5 settings.", "It took me about 3\u20134 hours in Colab GPU to run four epochs.", "The configuration file for the t5 base model can be downloaded and placed on the same directory as the saved model. Make sure to rename it to config.json", "Make sure that the given path has both saved model and the configuration file. Also, remember to move the model and input tensors to GPU if you have one for performing the inference.", "Now let\u2019s take a look at the generated text outputs for different inputs.", "We discussed how we can build an advanced NLG model that generates text from structured data. The text-to-text architecture of the T5 made it easy to feed structured data(which can be a combination of text and numerical data) into the model. I used the native PyTorch code on top of the huggingface\u2019s transformer to fine-tune it on the WebNLG 2020 dataset.", "Unlike GPT-2 based text generation, here we don\u2019t just trigger the language generation, We control it !!", "However, this is a basic implementation of the approach and a relatively less complex dataset is used to test the model. When the model was tested with data points with more than two triplets, it seems to be ignoring some of the information present in the data input. Further research and a lot of experimentation need to be done in order to fix this.", "You can find the code in this repo", "Feel free to ask any questions! Thank you!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb5cce5a6df45&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mathew-alexander.medium.com/?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": ""}, {"url": "https://mathew-alexander.medium.com/?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": "Mathew Alexander"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F317ecbaef643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&user=Mathew+Alexander&userId=317ecbaef643&source=post_page-317ecbaef643----b5cce5a6df45---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5cce5a6df45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5cce5a6df45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/simplenlg/simplenlg", "anchor_text": "simple NLG"}, {"url": "https://imgflip.com/memegenerator", "anchor_text": "imageflip"}, {"url": "https://webnlg-challenge.loria.fr/challenge_2017/", "anchor_text": "web NLG 2017"}, {"url": "https://imgflip.com/memegenerator", "anchor_text": "imageflip"}, {"url": "https://arxiv.org/pdf/1910.10683.pdf", "anchor_text": "T5"}, {"url": "https://ai.googleblog.com/2020/02/exploring-transfer-learning-with-t5.html", "anchor_text": "google blog"}, {"url": "https://gitlab.com/shimorina/webnlg-dataset/-/tree/master/release_v3.0", "anchor_text": "data"}, {"url": "https://webnlg-challenge.loria.fr/challenge_2020/", "anchor_text": "WebNLG"}, {"url": "https://gitlab.com/webnlg/corpus-reader", "anchor_text": "here"}, {"url": "https://docs.python.org/3/library/xml.etree.elementtree.html#module-xml.etree.ElementTree", "anchor_text": "xml.etree.ElementTree"}, {"url": "https://github.com/huggingface/transformers", "anchor_text": "hugging face"}, {"url": "https://imgflip.com/memegenerator", "anchor_text": "imageflip"}, {"url": "https://github.com/MathewAlexander/T5_nlg.git", "anchor_text": "repo"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b5cce5a6df45---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----b5cce5a6df45---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----b5cce5a6df45---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b5cce5a6df45---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/naturallanguagegeneration?source=post_page-----b5cce5a6df45---------------naturallanguagegeneration-----------------", "anchor_text": "Naturallanguagegeneration"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb5cce5a6df45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&user=Mathew+Alexander&userId=317ecbaef643&source=-----b5cce5a6df45---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb5cce5a6df45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&user=Mathew+Alexander&userId=317ecbaef643&source=-----b5cce5a6df45---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb5cce5a6df45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb5cce5a6df45&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b5cce5a6df45---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b5cce5a6df45--------------------------------", "anchor_text": ""}, {"url": "https://mathew-alexander.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mathew-alexander.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mathew Alexander"}, {"url": "https://mathew-alexander.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "80 Followers"}, {"url": "https://www.linkedin.com/in/mathew-alexander-2a5092119", "anchor_text": "https://www.linkedin.com/in/mathew-alexander-2a5092119"}, {"url": "https://github.com/MathewAlexander", "anchor_text": "https://github.com/MathewAlexander"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F317ecbaef643&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&user=Mathew+Alexander&userId=317ecbaef643&source=post_page-317ecbaef643--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb9ed0f3ff3cc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdata-to-text-generation-with-t5-building-a-simple-yet-advanced-nlg-model-b5cce5a6df45&newsletterV3=317ecbaef643&newsletterV3Id=b9ed0f3ff3cc&user=Mathew+Alexander&userId=317ecbaef643&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}