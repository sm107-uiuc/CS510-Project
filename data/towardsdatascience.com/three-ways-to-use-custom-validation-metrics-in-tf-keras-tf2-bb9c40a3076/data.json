{"url": "https://towardsdatascience.com/three-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076", "time": 1683014483.021387, "path": "towardsdatascience.com/three-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076/", "webpage": {"metadata": {"title": "Three ways to use custom validation metrics in tf.keras / TF2 | by Christian Freischlag | Towards Data Science", "h1": "Three ways to use custom validation metrics in tf.keras / TF2", "description": "Keras offers a bunch of metrics to validate the test data set like accuracy, MSE or AUC. However, sometimes you need a custom metric to validate your model. In this post, I will show three different\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.tensorflow.org/api_docs/python/tf/keras/metrics", "anchor_text": "tf.keras.metrics", "paragraph_index": 1}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "scikit-learn", "paragraph_index": 6}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/Callback", "anchor_text": "callback", "paragraph_index": 7}, {"url": "https://stackoverflow.com/questions/59305514/tensorflow-how-to-use-tf-keras-metrics-in-multiclass-classification", "anchor_text": "Stackoverflow", "paragraph_index": 9}, {"url": "http://digital-thinking.de/keras-three-ways-to-use-custom-validation-metrics-in-keras/", "anchor_text": "digital-thinking.de", "paragraph_index": 12}, {"url": "http://digital-thinking.de", "anchor_text": "digital-thinking.de", "paragraph_index": 14}], "all_paragraphs": ["Keras offers a bunch of metrics to validate the test data set like accuracy, MSE or AUC. However, sometimes you need a custom metric to validate your model. In this post, I will show three different approaches to implement your metrics and use it within Keras.", "While in the beginning there were only a few metrics included in Keras, today there are a lot of different ones available. For the Keras version bundled with TensorFlow 2 all the metrics can be found in tf.keras.metrics.", "The Tensoflow Addons library makes some additional metrics available. Before starting to implement it on your own better check, if your metric is available there. To use tensorflow addons just install it via pip:", "If you didn\u2019t find your metrics there we can now look at the three options. Functions, Callbacks and Metrics objects.", "The easiest way of defining metrics in Keras is to simply use a function callback. The function takes two arguments. The first parameter is the ground truth (y_true) and the second is the prediction from the model (y_pred). While running the validation, these arguments are Tensors, so we have to use the Keras Backend for calculation.", "Using this function with Keras models:", "If you want to evaluate the model on a separate data set every N epochs you can use a custom callback. In this case, the AUC score from scikit-learn is used.", "To train the model with this evaluation setup, the instance of the object is passed to Keras as a callback.", "And the result looks like this:", "And finally, it\u2019s possible to extend the metric object itself. (Credits to Geeocode from Stackoverflow)", "There is only one notable difference to the first example. The result function returns and the update_state method must be overridden (this is were the calculation happens). It also takes one additional argument (sample_weight). And finally the result tensor is returned by re result method.", "We have seen three different ways of implementing a custom validation metric. Hopefully, that helped to decide which way works for your use case and don\u2019t forget to check, whether your metric is already available in the large amount of predefined ones in tf.keras.metrics.", "This post was initially published on digital-thinking.de (Dec 19 2018)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML/Data and Tech enthusiast | digital-thinking.de | Lead Machine Learning Engineer @Chrono24"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbb9c40a3076&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@christian.freischlag?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christian.freischlag?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": "Christian Freischlag"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7bf9b5093a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&user=Christian+Freischlag&userId=b7bf9b5093a4&source=post_page-b7bf9b5093a4----bb9c40a3076---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb9c40a3076&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb9c40a3076&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@valeon", "anchor_text": "Mitchel Boot"}, {"url": "https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/metrics", "anchor_text": "tf.keras.metrics"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "scikit-learn"}, {"url": "https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/Callback", "anchor_text": "callback"}, {"url": "https://stackoverflow.com/questions/59305514/tensorflow-how-to-use-tf-keras-metrics-in-multiclass-classification", "anchor_text": "Stackoverflow"}, {"url": "http://digital-thinking.de/keras-three-ways-to-use-custom-validation-metrics-in-keras/", "anchor_text": "digital-thinking.de"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bb9c40a3076---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----bb9c40a3076---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/keras?source=post_page-----bb9c40a3076---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb9c40a3076&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&user=Christian+Freischlag&userId=b7bf9b5093a4&source=-----bb9c40a3076---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbb9c40a3076&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&user=Christian+Freischlag&userId=b7bf9b5093a4&source=-----bb9c40a3076---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbb9c40a3076&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbb9c40a3076&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bb9c40a3076---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bb9c40a3076--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bb9c40a3076--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bb9c40a3076--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bb9c40a3076--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christian.freischlag?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@christian.freischlag?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Christian Freischlag"}, {"url": "https://medium.com/@christian.freischlag/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "192 Followers"}, {"url": "http://digital-thinking.de", "anchor_text": "digital-thinking.de"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb7bf9b5093a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&user=Christian+Freischlag&userId=b7bf9b5093a4&source=post_page-b7bf9b5093a4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2f0157628cac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthree-ways-to-use-custom-validation-metrics-in-tf-keras-tf2-bb9c40a3076&newsletterV3=b7bf9b5093a4&newsletterV3Id=2f0157628cac&user=Christian+Freischlag&userId=b7bf9b5093a4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}