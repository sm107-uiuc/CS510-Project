{"url": "https://towardsdatascience.com/5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e", "time": 1683014450.434119, "path": "towardsdatascience.com/5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e/", "webpage": {"metadata": {"title": "5 Most Useful Window Functions In SQL You Should Know | by Terence Shin | Towards Data Science", "h1": "5 Most Useful Window Functions In SQL You Should Know", "description": "In my last article, I explained what SQL window functions are and how they can be used. In this article, I\u2019m going to share what I think are the 5 MOST useful window (analytics) functions. I highly\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/sql-window-analytic-functions-explained-in-4-minutes-6171c6983263", "anchor_text": "In my last article", "paragraph_index": 0}, {"url": "https://www.linkedin.com/in/terenceshin/", "anchor_text": "https://www.linkedin.com/in/terenceshin/", "paragraph_index": 24}], "all_paragraphs": ["In my last article, I explained what SQL window functions are and how they can be used. In this article, I\u2019m going to share what I think are the 5 MOST useful window (analytics) functions.", "I highly recommend that you try to understand these if you work with data in your job (i.e. data analysts, product analysts, data scientists, data engineers, etc\u2026). They will certainly come in handy!", "With that said, let\u2019s dive right into it.", "To help you understand how these 5 window functions work, I\u2019m going to use the following table as an example:", "What does it do? ROW_NUMBER simply returns the number of each row, starting at 1 for the first record.", "When is it Useful?Row number is extremely useful when you want to get the first or last record of a specific table. For example, if you have a table of customer purchases and you want to get the first purchase for each customer, you can PARTITION BY customer (name/id) and ORDER BY purchase date. Then you can filter the table WHERE row number = 1.", "Example:Using my example above, let\u2019s say I want to apply a row number to each row, split by gender and from the highest GPA to lowest. Then I could perform the following query to get the following result:", "Notice that because ORDERed BY GPA desc, the female and male with the highest GPA have a row number = 1.", "What does it do?SUM() and COUNT() are aggregate functions that either SUMs the values in a column or COUNTs the values in a column that are not null.", "When is it Useful?By using SUM() or COUNT() in a window function, you can calculate cumulative sums or cumulative counts. This is extremely useful if you want to create graphs that show the growth of a specific metric (i.e. number of orders, revenue, etc\u2026) over time.", "Example:While this example doesn\u2019t necessarily do justice, it will give you an understanding of how it works.", "Notice how the column, GPA_sum, calculates the cumulative GPA (GPA for the given row plus the GPA for all previous rows).", "What does it do?Just as you would use MIN()/MAX() in an aggregate function, you can also use it in a window function.", "When is it Useful?Min/Max is useful if you want to compare each row with the highest/lowest value.", "Example:In the example below, we can use this to compare each student\u2019s GPA with the highest GPA per gender. You can take this a step further and create a new column that calculates the difference between the two.", "What does it do? / When is it Useful?LEAD() and LAG() are useful when you want to compare the values of previous rows or later rows.", "Example:Let\u2019s say I wanted to compare each student\u2019s GPA with the next student\u2019s GPA that is just below his/hers. I can use the LAG() function to achieve this.", "Notice how the first row is empty because there\u2019s no previous row for it to refer to.", "What does it do?DENSE_RANK is similar to ROW_NUMBER except that it returns the same rank (number) for equal values.", "When is it Useful?DENSE_RANK is useful when you want to rank your data based on a particular variable or variables.", "Example:If we wanted to rank the students from the lowest GPA to the highest, we could use the following code to achieve this.", "Notice that Martin and Jason have the same GPA, and so, they have the same Dense_rank equal to 4.", "By reading this article, you should not only know what a window function is, but you should also have a good grasp of its versatility and functionality. There are so many more ways that you can use window functions, but these five have definitely been the most useful in my career!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science @ KOHO, Saturn Cloud | MSc, MBA | https://www.linkedin.com/in/terenceshin/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F35ea50ecd49e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://terenceshin.medium.com/?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": ""}, {"url": "https://terenceshin.medium.com/?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": "Terence Shin"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F360a9d4d19ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&user=Terence+Shin&userId=360a9d4d19ab&source=post_page-360a9d4d19ab----35ea50ecd49e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35ea50ecd49e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35ea50ecd49e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@fabrizioverrecchia?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Fabrizio Verrecchia"}, {"url": "https://unsplash.com/s/photos/window?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/sql-window-analytic-functions-explained-in-4-minutes-6171c6983263", "anchor_text": "In my last article"}, {"url": "https://docs.google.com/document/d/1UV6pvCi9du37cYAcKNtuj-2rkCfbt7kBJieYhSRuwHw/edit#heading=h.m63uwvt9w358", "anchor_text": "my free data science resource"}, {"url": "https://medium.com/@terenceshin", "anchor_text": "follow me on Medium"}, {"url": "https://www.linkedin.com/in/terenceshin/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/data-science?source=post_page-----35ea50ecd49e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----35ea50ecd49e---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/work?source=post_page-----35ea50ecd49e---------------work-----------------", "anchor_text": "Work"}, {"url": "https://medium.com/tag/education?source=post_page-----35ea50ecd49e---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/technology?source=post_page-----35ea50ecd49e---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F35ea50ecd49e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&user=Terence+Shin&userId=360a9d4d19ab&source=-----35ea50ecd49e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F35ea50ecd49e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&user=Terence+Shin&userId=360a9d4d19ab&source=-----35ea50ecd49e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F35ea50ecd49e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F35ea50ecd49e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----35ea50ecd49e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----35ea50ecd49e--------------------------------", "anchor_text": ""}, {"url": "https://terenceshin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://terenceshin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terence Shin"}, {"url": "https://terenceshin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "120K Followers"}, {"url": "https://www.linkedin.com/in/terenceshin/", "anchor_text": "https://www.linkedin.com/in/terenceshin/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F360a9d4d19ab&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&user=Terence+Shin&userId=360a9d4d19ab&source=post_page-360a9d4d19ab--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa05efe3d278a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F5-most-useful-window-functions-in-sql-you-should-know-35ea50ecd49e&newsletterV3=360a9d4d19ab&newsletterV3Id=a05efe3d278a&user=Terence+Shin&userId=360a9d4d19ab&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}