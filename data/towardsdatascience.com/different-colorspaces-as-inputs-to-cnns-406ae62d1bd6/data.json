{"url": "https://towardsdatascience.com/different-colorspaces-as-inputs-to-cnns-406ae62d1bd6", "time": 1683007118.289354, "path": "towardsdatascience.com/different-colorspaces-as-inputs-to-cnns-406ae62d1bd6/", "webpage": {"metadata": {"title": "Different Colorspaces as Inputs to CNNs | by Vardan Agarwal | Towards Data Science", "h1": "Different Colorspaces as Inputs to CNNs", "description": "Find out if using different colorspaces in CNN's through a custom data generator leads to better results or not and finally create an ensemble model of it."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/beyond-the-standard-cnn-in-tensorflow-2-a7562d25ca2d?source=friends_link&sk=ed5924d636edd0ebde712b9f22d534b0", "anchor_text": "article", "paragraph_index": 8}, {"url": "https://gist.github.com/vardanagarwal/d1c957ee1ff7b370b6135684392e10a3", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://gist.github.com/vardanagarwal/918cdaa53a331051007c4dda6fd843f0", "anchor_text": "here", "paragraph_index": 16}], "all_paragraphs": ["I had just finished a rant in another article where I forgot that OpenCV used BGR format and the output was checked in RGB for a CNN and how it had wasted a lot of time when I got an idea, what if passed images in different colorspaces to CNN\u2019s and how will it affect the model? That is what we are going to find out in this article.", "If you are not interested in the process and just want to know the results you can jump straight down to the results with the normal CNN section.", "If you want to code along, then you would require Tensorflow and OpenCV. You can pip install them using the code shown below, or you use Google Colab like me, where no set up will be required along with free GPU.", "Deciding which colorspaces to use was a pretty easy task. I just opened the documentation for OpenCV and choose all the unique ones in which it was possible to convert. I will just list them and provide additional reading links if anyone is interested in knowing more about them.", "Before beginning, I want to be clear that my aim was not to create a very high-tech state of the art CNN architecture to get the best accuracy but to compare all the colorspaces.", "The dataset chosen was the cats vs dogs one. First, we start we importing all the required libraries.", "The next part is to load the dataset and store all the filenames which will then be passed to the image data generator and define all the constants which will be used.", "A normal custom data generator is created with an extra argument of colorspace, which defines which colorspace to convert to. cv2.cvtColor is used for that purpose. The images are resized to their required sizes and normalized by dividing by 255 for all except for the Hue matrice of HSV which is divided by 180. NumPy arrays are created for the images and labels and they are yielded.", "A basic CNN is created using Conv2D, max pooling, batch normalization, and dropout layers which are eventually flattened, a dense layer gives output with a sigmoid activation function. The model is compiled using Adam. If you want to create advanced CNN\u2019s which may give better results, you can refer to my previous article. Just fit the model with the required values, and we are done.", "If we observe the training accuracy and loss all the colorspaces except HSV give better results which are pretty similar. However, it can also be observed that our model is overfitting so HSV can not just be discredited straightaway. Also, for the validation set, the images in HSV can learn much faster than their counterparts, but for a large number of epochs the results even out and choosing a particular one is very difficult.", "Again as stated above the transfer learning model used is a pretty simple one. A pre-trained MobileNetV2 is used whose layers are set to non-trainable and a global average pooling layer is followed by a dense layer for output.", "Only BGR and XYZ colorspaces give good results while HSV gives the poorest results. But why did this happen? Well we use pre-trained layers that were accustomed to seeing RGB style inputs and XYZ is pretty similar to RGB so only they give good results, whereas HSV is a cylindrical system and is the farthest off RGB in terms of similarity, hence gave the worst results.", "So we make the whole pre-trained network trainable by changing base_model.trainable = True and let\u2019s see what happens now.", "Even now BGR and XYZ colorspaces perform great from the start however, they are caught up by all the other colorspaces except HSV which again performed the worst. There is hardly much to choose from among all the colorspaces except HSV so let\u2019s create an ensemble model and see whether that improves performance.", "If we can achieve an improvement in performance then we will also know that different colorspaces were getting different images classified as right or wrong, which would mean that changing the colorspace had some impact on the models. We will create a pretty simple ensemble model by taking the mean of the predicted probabilities of all the models, converting it to an integer, and evaluating it against the true labels.", "So to conclude it can be said that changing the colorspace may or may not improve accuracy especially if you are checking randomly and have not assigned a random seed to repeat results because there were a lots of ups and downs. However, if you want just a little more accuracy you can try other colorspaces or even go for ensemble model.", "You can find the links to gist link to colab files here and here if you want to play with them.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F406ae62d1bd6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vardanagarwal16?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": "Vardan Agarwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0b122513e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&user=Vardan+Agarwal&userId=e0b122513e3b&source=post_page-e0b122513e3b----406ae62d1bd6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F406ae62d1bd6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F406ae62d1bd6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ruvimnogaphoto?utm_source=medium&utm_medium=referral", "anchor_text": "Ruvim Noga"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://unsplash.com/@efekurnaz?utm_source=medium&utm_medium=referral", "anchor_text": "Efe Kurnaz"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Color_spaces_with_RGB_primaries", "anchor_text": "Additional reading"}, {"url": "https://en.wikipedia.org/wiki/HSL_and_HSV", "anchor_text": "Additional Reading"}, {"url": "https://en.wikipedia.org/wiki/YCbCr", "anchor_text": "Additional Reading"}, {"url": "https://www.xrite.com/blog/lab-color-space", "anchor_text": "Additional Reading"}, {"url": "https://en.wikipedia.org/wiki/CIELUV", "anchor_text": "Additional Reading"}, {"url": "https://en.wikipedia.org/wiki/CIE_1931_color_space", "anchor_text": "Additional Reading"}, {"url": "https://towardsdatascience.com/beyond-the-standard-cnn-in-tensorflow-2-a7562d25ca2d?source=friends_link&sk=ed5924d636edd0ebde712b9f22d534b0", "anchor_text": "article"}, {"url": "https://gist.github.com/vardanagarwal/d1c957ee1ff7b370b6135684392e10a3", "anchor_text": "here"}, {"url": "https://gist.github.com/vardanagarwal/918cdaa53a331051007c4dda6fd843f0", "anchor_text": "here"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----406ae62d1bd6---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/opencv?source=post_page-----406ae62d1bd6---------------opencv-----------------", "anchor_text": "Opencv"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----406ae62d1bd6---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----406ae62d1bd6---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----406ae62d1bd6---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F406ae62d1bd6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&user=Vardan+Agarwal&userId=e0b122513e3b&source=-----406ae62d1bd6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F406ae62d1bd6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&user=Vardan+Agarwal&userId=e0b122513e3b&source=-----406ae62d1bd6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F406ae62d1bd6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F406ae62d1bd6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----406ae62d1bd6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----406ae62d1bd6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vardanagarwal16?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vardan Agarwal"}, {"url": "https://medium.com/@vardanagarwal16/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "399 Followers"}, {"url": "https://www.linkedin.com/in/vardan-agarwal-6bb123168/", "anchor_text": "https://www.linkedin.com/in/vardan-agarwal-6bb123168/"}, {"url": "https://www.buymeacoffee.com/vardan", "anchor_text": "https://www.buymeacoffee.com/vardan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe0b122513e3b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&user=Vardan+Agarwal&userId=e0b122513e3b&source=post_page-e0b122513e3b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4ce0157411b4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdifferent-colorspaces-as-inputs-to-cnns-406ae62d1bd6&newsletterV3=e0b122513e3b&newsletterV3Id=4ce0157411b4&user=Vardan+Agarwal&userId=e0b122513e3b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}