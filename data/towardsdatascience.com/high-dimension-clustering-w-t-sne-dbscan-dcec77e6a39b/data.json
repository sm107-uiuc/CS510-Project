{"url": "https://towardsdatascience.com/high-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b", "time": 1683006317.345032, "path": "towardsdatascience.com/high-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b/", "webpage": {"metadata": {"title": "High Dimension Clustering w/ t-SNE & DBSCAN | by Doug Foo | Towards Data Science", "h1": "High Dimension Clustering w/ t-SNE & DBSCAN", "description": "Clustering is a set of unsupervised machine learning methods used to group data together based on its features. Ie, using Country info (demographics, social indicators, economic indicators etc) +\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/analytics-vidhya/learning-pandas-via-covid-analysis-79228efb5413", "anchor_text": "Pandas using COVID", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "Curse of Dimensionality", "paragraph_index": 13}, {"url": "http://foostack.ai", "anchor_text": "foostack.ai", "paragraph_index": 32}], "all_paragraphs": ["Clustering is a set of unsupervised machine learning methods used to group data together based on its features. Ie, using Country info (demographics, social indicators, economic indicators etc) + COVID data, can we determine if Japan is more like India or United States or Poland?", "We will evaluate using K-Means and DBSCAN clustering models along with PCA and t-SNE dimension reduction methods. Review my prior article on Pandas using COVID datasets from last month.", "As expected, good data is always the #1 issue. COVID-19 is 2\u20133 months old, and the datasets have growing pains. Typical things I had to manage:", "Each issue has a solution/hacks \u2014 some of which we\u2019ll cover. Key point \u2014 you must have an embedded Data QA process as part of your workflow/pipeline.", "Below is how we get started w/ the COVID data from John Hopkins:", "I wanted a day over day (DoD) change in cases, but data consistency is an issue (some days they reported no cases and clumped them into the following day, making DoD jumpy..). Taking a 3-day, 7-day, 21-day average will help smooth out daily rates.", "Pandas has a rolling window function to make calculating n-day windows easy:", "This helps smooths out those weekend days when a lazy health department commissioner in a small country like San Marino reports 0 cases on Sat/Sun and waits till Monday to report! I created 3\u20137\u201314 rolling averages for my target dataset.", "I wanted more features like population & population density, number of rails & flights, inflation rates, hospital beds, etc to add to my analysis. WorldBank.org has a long list of indicators that are easy to fetch and merge into our dataset using some functions I hacked up:", "Using add_metric(..) we can run a chain of calls to add a bunch of different indicators to my dataset:", "I added 25 features \u2014 rich enough to cluster countries together? Running a correlation matrix is a nice way to visualize our features and potentially identify flaws:", "But this is like a science experiment so we need hypothesize, test, validate and likely try again!", "Most ML models require \u2018scaled\u2019 inputs, ie \u2014 normalized ranges of values. Having a population in millions but other values in decimals or %\u2019s causes model skew.", "Clustering models don\u2019t work with large #\u2019s of dimensions (large = 3+). The Curse of Dimensionality details it \u2014 tldr; the data gets sparse and the distance algorithms to determine points \u201cnear\u201d to each other stop working well.", "Our 25-dimension dataset can be collapsed to 2 dimensions while retaining key feature information by using PCA (Principal Component Analysis) or t-SNE (t-Distributed Stochastic Neighbor Embedding). Visuals below of 25 \u21922 dimensional reduction:", "PCA is an old tried and true method vs t-SNE which is the latest thing (you can see why from the plots above). Explaining PCA & t-SNE is beyond this article. But refer to Pranay Dave\u2019s [9] nice 1-liners describing some of the differences:", "\u201cPCA essentially works by separating points as far as possible based on highest varying field.\u201d", "\u201cTSNE essentially works by grouping points as close as possible based on characteristics of the point\u201d", "Clustering takes your data and systematically determines similarities and groups them into \u201cclusters\u201d. K-Means is the tried and true model, while DBSCAN is one of the new kids on the block.", "I created my own 1-liners for K-Means vs DBSCAN (feel free to quote me):", "\u201cK-Means requires choice of k-clusters, trying various cluster centers at random until a globally optimal distance to neighboring points is found for each cluster.\u201d", "\u201cDBSCAN starts a new cluster at a random point and recursively assimilates neighbors within \u03b5-range \u2014 iterating with more new clusters until all points are assimilated.\u201d", "As one can see below \u2014 using data post t-SNE processing \u2014 both K-Means and DBSCAN work, but DBSCAN can remove noisy points and isolate clusters a little better. The fine tuning of hyperparams for both models requires testing (trial and error).", "We\u2019ll walk thru the last 2 steps \u2014 tuning of t-SNE and DBSCAN parameters and the final visualizations next.", "SKLearn\u2019s t-SNE function has 1 hyper-parameter to tune: perplexity! What a silly name, but it's fitting since its a vague (perplexing) way to tune the # of local vs global points. Apparently visual trial and error is the best way to pick the right settings [6].", "I tried a range of values 10\u201390 stepping by 10\u2019s. Hmm.. which one to pick.. I guess you want one w/ visible segmentation/clusters of some sort. I have to think there is a better way than this eyeball method, but 30 looks good.", "The 2 hyper-parameters are eps and min_samp that tune the size # number of clusters. Setting eps sets the radius or max distance that a cluster can look for neighbor points. The min_samp param defines the min # of points within the eps range required to qualify as a cluster. Together they determine the # of clusters and shape of cluster.", "Note DBSCAN does not need to claim every point \u2014 some that are outliers without min_samp neighbors or within eps range of another cluster are removed (shown as non-colored pts). This is one key feature/benefit compared to vs K-Means.", "After using t-SNE for dimension reduction method via perplexity tuning, then apply DBSCAN w/ hyper-parameters eps and min_samples \u2014 we apply country labels and zoom in to see what countries clustering together. We can observe (adding all labels is noisy so I added a random set):", "The choice of dimensions/features to embed t-SNE is probably more important than the tuning of parameters. Given more time, I would focus on making sure we have the right features for our model inputs.", "Try all of these and drop a comment with your results. If you have Data Robot or H2O, your life will be highly simplified :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech Manager by Day, ML Hacker by Night \u2014 founder: foostack.ai"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdcec77e6a39b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://doug-foo.medium.com/?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": ""}, {"url": "https://doug-foo.medium.com/?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": "Doug Foo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1eddac375cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&user=Doug+Foo&userId=1eddac375cb9&source=post_page-1eddac375cb9----dcec77e6a39b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdcec77e6a39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdcec77e6a39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/analytics-vidhya/learning-pandas-via-covid-analysis-79228efb5413", "anchor_text": "Pandas using COVID"}, {"url": "https://en.wikipedia.org/wiki/Curse_of_dimensionality", "anchor_text": "Curse of Dimensionality"}, {"url": "https://medium.com/analytics-vidhya/learning-pandas-via-covid-analysis-79228efb5413", "anchor_text": "Doug Foo"}, {"url": "https://github.com/dougfoo/machineLearning/blob/master/covid/COVID-global-clustering.ipynb", "anchor_text": "GitHub"}, {"url": "https://github.com/CSSEGISandData/COVID-19.git", "anchor_text": "GitHub"}, {"url": "https://usafacts.org/visualizations/coronavirus-covid-19-spread-map/", "anchor_text": "USAfacts.org"}, {"url": "https://data.worldbank.org/indicator", "anchor_text": "WorldBank"}, {"url": "https://towardsdatascience.com/the-art-of-effective-visualization-of-multi-dimensional-data-6c7202990c57?source=bookmarks---------1------------------", "anchor_text": "DJ Sarkar"}, {"url": "https://distill.pub/2016/misread-tsne/", "anchor_text": "Chris Olah"}, {"url": "https://medium.com/@dmitriy.kavyazin/principal-component-analysis-and-k-means-clustering-to-visualize-a-high-dimensional-dataset-577b2a7a5fe2", "anchor_text": "Dmitriy Kavyazin"}, {"url": "https://www.youtube.com/watch?v=ayZQj4llUSU&t=1824s", "anchor_text": "Youtube"}, {"url": "https://towardsdatascience.com/pca-vs-tsne-el-cl\u00e1sico-9948181a5f87", "anchor_text": "Pranav Dave"}, {"url": "https://medium.com/tag/clustering?source=post_page-----dcec77e6a39b---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dcec77e6a39b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/dimensionality-reduction?source=post_page-----dcec77e6a39b---------------dimensionality_reduction-----------------", "anchor_text": "Dimensionality Reduction"}, {"url": "https://medium.com/tag/dbscan?source=post_page-----dcec77e6a39b---------------dbscan-----------------", "anchor_text": "Dbscan"}, {"url": "https://medium.com/tag/data-science?source=post_page-----dcec77e6a39b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdcec77e6a39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&user=Doug+Foo&userId=1eddac375cb9&source=-----dcec77e6a39b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdcec77e6a39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&user=Doug+Foo&userId=1eddac375cb9&source=-----dcec77e6a39b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdcec77e6a39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdcec77e6a39b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dcec77e6a39b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dcec77e6a39b--------------------------------", "anchor_text": ""}, {"url": "https://doug-foo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://doug-foo.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Doug Foo"}, {"url": "https://doug-foo.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "http://foostack.ai", "anchor_text": "foostack.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1eddac375cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&user=Doug+Foo&userId=1eddac375cb9&source=post_page-1eddac375cb9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F195f71a45f20&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhigh-dimension-clustering-w-t-sne-dbscan-dcec77e6a39b&newsletterV3=1eddac375cb9&newsletterV3Id=195f71a45f20&user=Doug+Foo&userId=1eddac375cb9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}