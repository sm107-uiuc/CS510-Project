{"url": "https://towardsdatascience.com/4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461", "time": 1683007039.068116, "path": "towardsdatascience.com/4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461/", "webpage": {"metadata": {"title": "4 Simple Ways to Import Word and PDF Data into Python when Pandas Fails | by Kat Li | Towards Data Science", "h1": "4 Simple Ways to Import Word and PDF Data into Python when Pandas Fails", "description": "Being a part of the data science/analytics team, you\u2019ll probably encounter many file types to import and analyze in Python. In the ideal world, all our data reside in the cloud-based databases (e.g\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/YiLi225/Import_PDF_Word_Python", "anchor_text": "my Github repo", "paragraph_index": 2}, {"url": "https://github.com/mhammond/pywin32", "anchor_text": "Win32com \u2192 work with MS Word .doc files", "paragraph_index": 6}, {"url": "https://github.com/YiLi225/Import_PDF_Word_Python", "anchor_text": "fully-baked code snippet is linked here", "paragraph_index": 8}, {"url": "https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw", "anchor_text": "\u201cData Talks with Kat\u201d", "paragraph_index": 10}, {"url": "https://github.com/euske/pdfminer", "anchor_text": "Pdfminer (in lieu of PyPDF2) \u2192 work with PDF text", "paragraph_index": 12}, {"url": "https://github.com/mstamy2/PyPDF2", "anchor_text": "PyPDF2", "paragraph_index": 13}, {"url": "https://github.com/YiLi225/Import_PDF_Word_Python", "anchor_text": "Github repo", "paragraph_index": 13}, {"url": "https://github.com/madmaze/pytesseract", "anchor_text": "Pdf2image + Pytesseract \u2192 work with PDF scanned-in images", "paragraph_index": 17}, {"url": "https://github.com/Belval/pdf2image", "anchor_text": "pdf2image", "paragraph_index": 19}, {"url": "https://github.com/madmaze/pytesseract", "anchor_text": "pytesseract", "paragraph_index": 19}, {"url": "https://github.com/YiLi225/Import_PDF_Word_Python", "anchor_text": "my Github here", "paragraph_index": 22}, {"url": "https://blog.timextender.com/reversing-the-80-20-rule-in-data-wrangling", "anchor_text": "the 80\u201320 rule in data wrangling", "paragraph_index": 23}, {"url": "https://yilistats.medium.com/membership", "anchor_text": "my link", "paragraph_index": 27}, {"url": "https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw", "anchor_text": "\u201cData Talks with Kat\u201d", "paragraph_index": 28}], "all_paragraphs": ["Being a part of the data science/analytics team, you\u2019ll probably encounter many file types to import and analyze in Python. In the ideal world, all our data reside in the cloud-based databases (e.g., SQL, NoSQL) that are easy to query and extract. In the real world, however, we rarely get neat tabular data. Also, if we need additional data (being structured or unstructured) to augment the analysis, we will inevitably be working with raw data files that come in different formats.", "Recently, my team started a project that, as the first step, involves integrating raw data files in formats .csv, .xlsx, .pdf, .docx, and .doc. My first reaction: the mighty pandas! which certainly handles the .csv and .xlsx, but regarding the .pdf and .docx, we will have to explore possibilities beyond the pandas.", "In this blog, I will be sharing my tips and tricks to help you easily import PDF and Word documents (into Python) in case it comes up in your own work, especially in your NLP Natural Language Processing projects. All sample data files are publicly accessible, and file copies along with the corresponding download links are available in my Github repo.", "As one of the most commonly used documentation tools, the MS Word oftentimes is people\u2019s top choice for writing and sharing text. For word documents with the .docx extension, Python module docx is a handy tool, and the following shows how to import .docx paragraphs with just 2 lines of code,", "Now let\u2019s print out the output information,", "As we can see, the return is a list of strings/sentences, and thus we can leverage the string processing techniques and regular expression to get the text data ready for further analysis (e.g., NLP).", "2. Win32com \u2192 work with MS Word .doc files", "Despite the ease of use, the python-docx module cannot take in the aging .doc extension, and believe it or not, .doc file is still the go-to word processor for lots of stakeholders (despite the .docx being around for over a decade). If under this circumstance, converting file types is not an option, we can turn to the win32com.client package with a couple of tricks.", "The basic technique is first to launch a Word application as an active document and then to read the content/paragraphs in Python. The function docReader( ) defined below showcases how (and the fully-baked code snippet is linked here),", "After running this function, we should see the same output as in section 1. Two tips: (1) we set word.Visible = False to hide the physical file so that all the processing work is done in the background; (2) the argument doc_file_name requires a full file path, not just the file name. Otherwise, the function Documents.Open( ) wouldn\u2019t recognize the file, even with setting the working directory to the current folder.", "Join our YouTube community \ud83c\udfa6 \u201cData Talks with Kat\u201d \ud83d\ude04", "Now, let\u2019s move onto the PDF files,", "3. Pdfminer (in lieu of PyPDF2) \u2192 work with PDF text", "When it comes to processing PDF files in Python, the well-known module PyPDF2 will probably be the initial attempt of most analysts, including myself. Hence, I coded it up using PyPDF2 (full code available in my Github repo), which gave the text output, as shown below,", "Hmmm, apparently this doesn\u2019t seem right because all the white spaces are missing! Without the proper spaces, there\u2019s no way for us to parse the strings correctly.", "Indeed, this example reveals one caveat of the function extractText( ) in PyPDF2: it doesn\u2019t perform well for PDFs containing complicated text or non-printable space characters. Therefore, let\u2019s switch to the pdfminer and explore how to get this pdf text imported,", "Now, the output looks way better, and can be easily cleaned up with text mining techniques,", "4. Pdf2image + Pytesseract \u2192 work with PDF scanned-in images", "To make things even complicated for data scientists (of course), PDFs can (and often) be created from scanned images in lieu of a text document; hence, they cannot be rendered as plain text by pdf readers, regardless of how neatly they are organized.", "In this case, the best technique I found is first explicitly to extract out the images, and then to read and parse those images in Python. We will implement this idea with the modules pdf2image and pytesseract. If the latter sounds unfamiliar, the pytesseract is an OCR optical character recognition tool for Python, which can recognize and read the text embedded in images. Now, here\u2019s the basic function,", "In the output, you should see the text of the scanned image shown below:", "Mission accomplished! As a bonus, you now know how to extract data from images as well, i.e., the image_to_string( ) in the pytesseract module!", "Note: for the pytesseract module to run successfully, you may need to perform additional configuration steps, including installing the poppler and tesseract packages. Again, please feel free to grab a more robust implementation and a detailed list of configs in my Github here.", "To conclude, there\u2019s a data science joke mentioned by Greg Horton, in his piece talking about the 80\u201320 rule in data wrangling:", "Data Scientists spent 80% of their time dealing with data preparation problems and the other 20% complaining about how long it takes to deal with data preparation problems.", "By going through different ways of scraping text from Word and PDF files, I hope this blog will make your 80% a bit easier/less boring so that you don\u2019t pull your hair out, and also reduce the other 20% so that you can spend more time reading interesting Medium articles.", "Final tip: Once done working with a file, it always is a good coding practice to close the connection so that other applications can access the file. This is why you saw the close() method at the end of each function above. \ud83d\ude03", "Want more data science and programming tips? Use my link to sign up to Medium and gain full access to all my content.", "Also subscribe to my newly created YouTube channel \u201cData Talks with Kat\u201d,", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F43cf81599461&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----43cf81599461--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----43cf81599461--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yilistats.medium.com/?source=post_page-----43cf81599461--------------------------------", "anchor_text": ""}, {"url": "https://yilistats.medium.com/?source=post_page-----43cf81599461--------------------------------", "anchor_text": "Kat Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7657f76e72be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&user=Kat+Li&userId=7657f76e72be&source=post_page-7657f76e72be----43cf81599461---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F43cf81599461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F43cf81599461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/photo/words-text-scrabble-blocks-695571/", "anchor_text": "Photo by Skitterphoto from Pexels"}, {"url": "https://github.com/YiLi225/Import_PDF_Word_Python", "anchor_text": "my Github repo"}, {"url": "https://python-docx.readthedocs.io/en/latest/user/documents.html", "anchor_text": "Python-docx \u2192 work with MS Word .docx files"}, {"url": "https://github.com/mhammond/pywin32", "anchor_text": "Win32com \u2192 work with MS Word .doc files"}, {"url": "https://github.com/YiLi225/Import_PDF_Word_Python", "anchor_text": "fully-baked code snippet is linked here"}, {"url": "https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw", "anchor_text": "\u201cData Talks with Kat\u201d"}, {"url": "https://github.com/euske/pdfminer", "anchor_text": "Pdfminer (in lieu of PyPDF2) \u2192 work with PDF text"}, {"url": "https://github.com/mstamy2/PyPDF2", "anchor_text": "PyPDF2"}, {"url": "https://github.com/YiLi225/Import_PDF_Word_Python", "anchor_text": "Github repo"}, {"url": "https://github.com/madmaze/pytesseract", "anchor_text": "Pdf2image + Pytesseract \u2192 work with PDF scanned-in images"}, {"url": "https://github.com/Belval/pdf2image", "anchor_text": "pdf2image"}, {"url": "https://github.com/madmaze/pytesseract", "anchor_text": "pytesseract"}, {"url": "https://github.com/YiLi225/Import_PDF_Word_Python", "anchor_text": "my Github here"}, {"url": "https://blog.timextender.com/reversing-the-80-20-rule-in-data-wrangling", "anchor_text": "the 80\u201320 rule in data wrangling"}, {"url": "https://yilistats.medium.com/membership", "anchor_text": "my link"}, {"url": "https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw", "anchor_text": "\u201cData Talks with Kat\u201d"}, {"url": "https://towardsdatascience.com/6-sql-tricks-every-data-scientist-should-know-f84be499aea5", "anchor_text": "6 SQL Tricks Every Data Scientist Should KnowSQL tricks to make your analytics work more efficienttowardsdatascience.com"}, {"url": "https://medium.com/tag/python?source=post_page-----43cf81599461---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----43cf81599461---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nlp?source=post_page-----43cf81599461---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/programming?source=post_page-----43cf81599461---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/text-mining?source=post_page-----43cf81599461---------------text_mining-----------------", "anchor_text": "Text Mining"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F43cf81599461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&user=Kat+Li&userId=7657f76e72be&source=-----43cf81599461---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F43cf81599461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&user=Kat+Li&userId=7657f76e72be&source=-----43cf81599461---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F43cf81599461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----43cf81599461--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F43cf81599461&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----43cf81599461---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----43cf81599461--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----43cf81599461--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----43cf81599461--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----43cf81599461--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----43cf81599461--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----43cf81599461--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----43cf81599461--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----43cf81599461--------------------------------", "anchor_text": ""}, {"url": "https://yilistats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yilistats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Kat Li"}, {"url": "https://yilistats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "https://www.youtube.com/@DataTalksWithKat", "anchor_text": "https://www.youtube.com/@DataTalksWithKat"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7657f76e72be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&user=Kat+Li&userId=7657f76e72be&source=post_page-7657f76e72be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F37afe5b5308f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2F4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461&newsletterV3=7657f76e72be&newsletterV3Id=37afe5b5308f&user=Kat+Li&userId=7657f76e72be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}