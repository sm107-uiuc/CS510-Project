{"url": "https://towardsdatascience.com/heart-arrhythmia-detection-using-deep-learning-a659848f2742", "time": 1683003986.9508648, "path": "towardsdatascience.com/heart-arrhythmia-detection-using-deep-learning-a659848f2742/", "webpage": {"metadata": {"title": "Heart arrhythmia detection using Deep Learning | by Cristiano Aguiar | Towards Data Science", "h1": "Heart arrhythmia detection using Deep Learning", "description": "A common problem that Deep Learning is helping to solve lately involves time series classification. A classic approach to this kind of problem is generating features from the signals we have and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://stanfordmlgroup.github.io/projects/ecg/", "anchor_text": "this article", "paragraph_index": 2}, {"url": "https://physionet.org/content/mitdb/1.0.0/", "anchor_text": "MIT-BIH Arrhythmia Database", "paragraph_index": 3}, {"url": "https://physionet.org/content/mitdb/1.0.0/", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://github.com/MIT-LCP/wfdb-python", "anchor_text": "Python WFDB", "paragraph_index": 5}, {"url": "https://github.com/csaguiar/arrhythmia-detection", "anchor_text": "repo", "paragraph_index": 19}], "all_paragraphs": ["A common problem that Deep Learning is helping to solve lately involves time series classification. A classic approach to this kind of problem is generating features from the signals we have and training a machine learning model.", "The process of handcrafting features might take a great chunk of your project schedule. For that matter, employing a combination of a Convolutional Neural Network with a Long Short-Term Memory Recurrent Neural Network. This architecture has proven to be effective in order to reduce the amount of time spent on feature engineering.", "In this article, we're going to train a couple of models to detect irregular heart rhythms. The idea is to show step by step how to build a sequence model for time series classification. If you want a deep understanding of this problem, I highly recommend this article from the Stanford ML Group.", "For this experiment, we'll be using the MIT-BIH Arrhythmia Database that contains 48 half-hour excerpts of two-channel ambulatory ECG recordings, obtained from 47 subjects. The dataset is annotated by a cardiologist, all the labels and a full explanation of how the data were collected can be found here.", "For the purpose of this experiment, let's consider only two classes: normal beats and abnormal beats. Invalid beats were discarded from the labels. These are considered labels, the ones not on these lists are marked as normal.", "Each record is composed of a signal and its annotations. Both files are read with the library Python WFDB. The record can be read using:", "The annotation contains each beat annotation. Each sample in our model will be a beat label as target and a sequence surrounding this beat as input (3 seconds each side).", "Now let's define two functions that will help us to process the records. One to simply classify the record, given the list above, into a normal vs. abnormal beat. Another function will build a sample for our CNN/LSTM 1D model.", "To better understand the second function, we need to understand how the input for the CNN or LSTM model is formatted. You'll have to input a three dimensional array with the shape (batch_size, sequence_size, number_of_features). In this case, each sample would be (1, sequence_size, 1) since we have only one feature in our model. Later, you're going to see that for CNN with LSTM we also need to define another dimension (subsequences).", "Next, the following code will build a list of sequences (inputs) list of labels (target) and a map for each patient. The idea is to stratify for training and validation based on the rate of abnormal beats.", "Let's try different models to train our classifiers. The main purpose here is to show how to setup the keras layers, the architectures aren't very well designed. The first one is a CNN only model.", "This model looks like something below:", "To train the model let's call the fit method from keras:", "With this architecture, we can accomplish an accuracy of 0.82 in the validation set. It might not mean an amazing model, especially because of the loss over epochs that doesn't improve.", "Another common architecture used for sequential models is CNN with LSTM. The idea is to have a CNN layer working as a feature extraction layer and an LSTM to interpret the sequence of subsequences.", "This kind of architecture looks like this:", "Building a model using the Sequential API doesn't change much from what was done above.", "With this architecture, the accuracy on the validation set was 0.8.", "Next step, you can improve those models by reducing overfit through dropout layers or kernel regularizations.", "The code for this experiment is in the repo for this post.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate for Data Science, Engineering, Software Development and everything in between."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa659848f2742&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a659848f2742--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a659848f2742--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://blog.cristiano.io/?source=post_page-----a659848f2742--------------------------------", "anchor_text": ""}, {"url": "https://blog.cristiano.io/?source=post_page-----a659848f2742--------------------------------", "anchor_text": "Cristiano Aguiar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F574a3e71cb4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&user=Cristiano+Aguiar&userId=574a3e71cb4d&source=post_page-574a3e71cb4d----a659848f2742---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa659848f2742&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa659848f2742&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@simonmigaj?utm_source=medium&utm_medium=referral", "anchor_text": "Simon Migaj"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://stanfordmlgroup.github.io/projects/ecg/", "anchor_text": "this article"}, {"url": "https://physionet.org/content/mitdb/1.0.0/", "anchor_text": "MIT-BIH Arrhythmia Database"}, {"url": "https://physionet.org/content/mitdb/1.0.0/", "anchor_text": "here"}, {"url": "https://github.com/MIT-LCP/wfdb-python", "anchor_text": "Python WFDB"}, {"url": "https://github.com/csaguiar/arrhythmia-detection", "anchor_text": "repo"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a659848f2742---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----a659848f2742---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/long-short-term-memory?source=post_page-----a659848f2742---------------long_short_term_memory-----------------", "anchor_text": "Long Short Term Memory"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa659848f2742&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&user=Cristiano+Aguiar&userId=574a3e71cb4d&source=-----a659848f2742---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa659848f2742&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&user=Cristiano+Aguiar&userId=574a3e71cb4d&source=-----a659848f2742---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa659848f2742&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a659848f2742--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa659848f2742&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a659848f2742---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a659848f2742--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a659848f2742--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a659848f2742--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a659848f2742--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a659848f2742--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a659848f2742--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a659848f2742--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a659848f2742--------------------------------", "anchor_text": ""}, {"url": "https://blog.cristiano.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://blog.cristiano.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Cristiano Aguiar"}, {"url": "https://blog.cristiano.io/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "29 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F574a3e71cb4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&user=Cristiano+Aguiar&userId=574a3e71cb4d&source=post_page-574a3e71cb4d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9e160214b5d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fheart-arrhythmia-detection-using-deep-learning-a659848f2742&newsletterV3=574a3e71cb4d&newsletterV3Id=9e160214b5d3&user=Cristiano+Aguiar&userId=574a3e71cb4d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}