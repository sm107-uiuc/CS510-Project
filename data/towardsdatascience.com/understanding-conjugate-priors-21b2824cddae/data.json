{"url": "https://towardsdatascience.com/understanding-conjugate-priors-21b2824cddae", "time": 1683004584.514087, "path": "towardsdatascience.com/understanding-conjugate-priors-21b2824cddae/", "webpage": {"metadata": {"title": "Understanding Conjugate Priors. Bayesian Approach to Machine Learning\u2026 | by Saptashwa Bhattacharyya | Towards Data Science", "h1": "Understanding Conjugate Priors", "description": "In this post, I will give a comprehensive introduction to the concept of conjugate priors including some examples. Concept of conjugate prior is extremely useful because, conjugate priors reduce the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Beta_distribution", "anchor_text": "Beta distribution", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Conjugate_prior", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://pypi.org/project/celluloid/", "anchor_text": "Celluloid", "paragraph_index": 8}, {"url": "https://docs.pymc.io/", "anchor_text": "PyMC3", "paragraph_index": 9}, {"url": "http://deeplearning.net/software/theano/", "anchor_text": "Theano", "paragraph_index": 9}, {"url": "https://arxiv.org/abs/1111.4246", "anchor_text": "No-U-Turn sampler", "paragraph_index": 12}, {"url": "https://docs.pymc.io/api/inference.html", "anchor_text": "documentation", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/latent-variables-expectation-maximization-algorithm-fb15c4e0f32c", "anchor_text": "Expectation Maximization algorithm", "paragraph_index": 15}, {"url": "https://people.eecs.berkeley.edu/~jordan/courses/260-spring10/other-readings/chapter9.pdf", "anchor_text": "Notes on Conjugate Priors", "paragraph_index": 16}], "all_paragraphs": ["In this post, I will give a comprehensive introduction to the concept of conjugate priors including some examples. Concept of conjugate prior is extremely useful because, conjugate priors reduce the Bayesian updating to only modifying some parameters in the prior distribution. They are also necessary to learn and understand Machine Learning from Bayesian approach. Jupyter notebook used for this post can be found in my GitHub (link below). What you may expect to learn from this post \u2014", "So without any delay let\u2019s begin:", "In Bayesian probability theory, if the posterior distribution is in the same family of the prior distribution, then the prior and posterior are called conjugate distributions, and the prior is called the conjugate prior to the likelihood function. Initially, you may think okay that\u2019s cool but how exactly that helps us?", "In Bayesian approach our goal is to obtain the posterior distribution. Calculation of evidence can cause a pain on the backside in real life problems. Let\u2019s say, we are dealing with images and our objective is to generate a new image from a given set of images. It would be really difficult to model distribution of images, which is our P(D). Also, we can think of P(D) as a normalization constant and, it can be written as \u2014 \u2014 \u222b P(D|\u03b8) P(\u03b8) d\u03b8. Imagine this integral in the context of a neural network where \u03b8s are the parameters, i.e. the weights of the network, and if it is a relatively deep network, there will be millions of \u03b8s. So the integral would be intractable. Conjugate prior is here to rescue us from this misery. We can obtain exact posterior distribution if our prior distribution (in case of the example above, it will be the distribution of weights) is conjugate prior for the likelihood function. Let\u2019s see with a mischievous example:", "As my friend Kitty has a not so friendly cat Nuo, patting her leads to either getting grumpy with probability p or start purring with probability (1-p). As this kind of behavior is not so well known to me, I assume a prior distribution on p with a Beta distribution, Beta(2, 2). If in one evening Nuo got grumpy 6 times and purred only 2 times, what are the parameters for posterior distribution over p? Each time patting Nuo can be considered as a single experiment with either of the two fixed outcomes. This is actually known as Bernoulli trial, similar to tossing a coin. As Beta distribution is conjugate to Bernoulli likelihood, we can already tell the posterior distribution would follow the Beta distribution (as shown in the derivation below). Let\u2019s try to find the parameters\u2026", "As we can see, for Bernoulli Likelihood we have outcome 1 for N1 times and 0 for N0 times. Selecting a Beta Prior with parameters a, b gives us Beta distribution with parameters (N1 + a, N0+b) as posterior. Thus, choosing conjugate prior helps us to compute the posterior distribution just by updating the parameters of prior distribution and, we don\u2019t need to care about the evidence at all. Given our problem, we will have a posterior distribution which will be a Beta distribution with parameters (6+2, 2+2). Once we know the parameters of Beta distribution we can also calculate the Maximum a Posteriori which occurs at x = 0.7, as you can see in the figure below. Also, notice how the initial prior (Beta Distribution with parameters 2, 2) has changed to the updated posterior once we have used the likelihood. This is the key idea in Bayesian statistics, i.e., after seeing the data how our initial belief about the model has changed! For a detailed list of conjugate distributions check here.", "Let\u2019s extend the previous silly example with a more realistic example where, we will use the fact that Binomial distribution is conjugate to the Beta distribution. For a single trial (ex: coin flip) the binomial distribution is equivalent to Bernoulli distribution. We will see how our knowledge of posterior updates as we gather more data. Let\u2019s assume that we use a biased coin where our probability of success (heads) for Bernoulli trial is 0.4. We consider new observations as binomial distribution with k heads out of N trials. Starting with a simple Beta prior \u2014 \u03b2(1, 1) (which is equivalent to uniform prior), in the figure below, we see how more data helps us to update and reduce uncertainty of the posterior distribution.", "Let\u2019s see part of codes that I used to create the simple animation \u2014", "First, we create a numpy array of Bernoulli trials using scipy.stats.bernoulli.rvs and then count the number of success (heads) and failures. Based on this number, we update the Beta distribution starting from a uniform prior. Celluloid module was used for creating the matplotlib animation.", "PyMC3 is a Python package for Bayesian statistical modeling built on top of Theano. It allows users to fit Bayesian models using various numerical methods including the Markov chain Monte Carlo (MCMC). Let\u2019s start by building the coin flip model in PyMC3.", "Here, we start with using Bernoulli likelihood, with the Beta prior with parameters (1, 1). In the observed variable of the Bernoulli function we will take the input data. It is a way of telling PyMC3 that we want to condition for the unknown given the known (observations).", "We create the Bernoulli trials and, this will be our input data. Given this observed data, we then tell PyMC3 to generate 15,000 samples from the posterior We return the generated samples and the observed data. With this, we are ready to call the function and generate samples \u2014", "We create a list with number of observations (Bernoulli trials) and loop over this to collect all the generated samples and the corresponding observations and, store them in a dictionary. While executing this code-block you will see the number of samples generated using the No-U-Turn sampler(NUTS) is 62,000. The default sampler is NUTS in PyMC3 and it uses 4 cores (maximum number of CPUs) in parallel to create 15000 samples each. First 2000 samples (500 samples in each core) were used to tune the NUTS sampler which, later on will be eventually discarded. Check the documentation for more. Once the process of sample generation has finished, we can visualize the evolution of the posterior plot with increasing number of trials (observations) \u2014", "We can clearly see that with increasing number of trials, the uncertainty in the posterior distribution is becoming less. Let\u2019s plot the histogram of the generated samples and compare with a true beta distribution (calculated using Scipy) \u2014", "Here, we have discussed conjugate prior and gone through some simple examples to solidify our understanding on why it is indeed important. Hopefully this will help you to at least get started with Bayesian Machine Learning.", "P.S: I covered another and probably the most important concept in Bayesian machine learning known as Latent variables and Expectation Maximization algorithm on a separate post.", "[1] Notes on Conjugate Priors \u2014 Professor M. Jordan; University of California, Berkeley.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F21b2824cddae&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----21b2824cddae--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----21b2824cddae--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://saptashwa.medium.com/?source=post_page-----21b2824cddae--------------------------------", "anchor_text": ""}, {"url": "https://saptashwa.medium.com/?source=post_page-----21b2824cddae--------------------------------", "anchor_text": "Saptashwa Bhattacharyya"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9a3c3c477239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=post_page-9a3c3c477239----21b2824cddae---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F21b2824cddae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F21b2824cddae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Beta_distribution", "anchor_text": "Beta distribution"}, {"url": "https://en.wikipedia.org/wiki/Conjugate_prior", "anchor_text": "here"}, {"url": "https://pypi.org/project/celluloid/", "anchor_text": "Celluloid"}, {"url": "https://docs.pymc.io/", "anchor_text": "PyMC3"}, {"url": "http://deeplearning.net/software/theano/", "anchor_text": "Theano"}, {"url": "https://arxiv.org/abs/1111.4246", "anchor_text": "No-U-Turn sampler"}, {"url": "https://docs.pymc.io/api/inference.html", "anchor_text": "documentation"}, {"url": "https://docs.pymc.io/api/plots.html", "anchor_text": "PyMC3 traceplot"}, {"url": "https://towardsdatascience.com/latent-variables-expectation-maximization-algorithm-fb15c4e0f32c", "anchor_text": "Expectation Maximization algorithm"}, {"url": "https://people.eecs.berkeley.edu/~jordan/courses/260-spring10/other-readings/chapter9.pdf", "anchor_text": "Notes on Conjugate Priors"}, {"url": "https://github.com/suvoooo/Machine_Learning/blob/master/Conjugate_prior/Conjugate_Prior.ipynb", "anchor_text": "Link to my Notebook!"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----21b2824cddae---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----21b2824cddae---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----21b2824cddae---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/python?source=post_page-----21b2824cddae---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----21b2824cddae---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F21b2824cddae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=-----21b2824cddae---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F21b2824cddae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=-----21b2824cddae---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F21b2824cddae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----21b2824cddae--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F21b2824cddae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----21b2824cddae---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----21b2824cddae--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----21b2824cddae--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----21b2824cddae--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----21b2824cddae--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----21b2824cddae--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----21b2824cddae--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----21b2824cddae--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----21b2824cddae--------------------------------", "anchor_text": ""}, {"url": "https://saptashwa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://saptashwa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Saptashwa Bhattacharyya"}, {"url": "https://saptashwa.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.3K Followers"}, {"url": "https://www.linkedin.com/in/saptashwa", "anchor_text": "https://www.linkedin.com/in/saptashwa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9a3c3c477239&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=post_page-9a3c3c477239--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F423a8008308d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-conjugate-priors-21b2824cddae&newsletterV3=9a3c3c477239&newsletterV3Id=423a8008308d&user=Saptashwa+Bhattacharyya&userId=9a3c3c477239&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}