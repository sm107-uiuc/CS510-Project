{"url": "https://towardsdatascience.com/how-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2", "time": 1683000605.739295, "path": "towardsdatascience.com/how-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2/", "webpage": {"metadata": {"title": "How to get a fuller picture of a model\u2019s accuracy | by Allison Stafford | Towards Data Science", "h1": "How to get a fuller picture of a model\u2019s accuracy", "description": "Using a single train-test split gives you a single snapshot of the performance of a machine learning model or algorithm. It\u2019s like evaluating a football team (American or otherwise) based on a single\u2026"}, "outgoing_paragraph_urls": [{"url": "http://statweb.stanford.edu/~tibs/sta306bfiles/cvwrong.pdf", "anchor_text": "Hastie and Tibshirani", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html#sklearn.model_selection.cross_val_score", "anchor_text": "docs", "paragraph_index": 12}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation", "anchor_text": "user guide", "paragraph_index": 12}, {"url": "https://github.com/allisonhonold/k_fold_cross_validation_blog", "anchor_text": "GitHub repository", "paragraph_index": 20}], "all_paragraphs": ["Using a single train-test split gives you a single snapshot of the performance of a machine learning model or algorithm. It\u2019s like evaluating a football team (American or otherwise) based on a single game. If you really want to know how well a team performs in general, you\u2019re going to want more than just this snapshot. Likewise, we shouldn\u2019t evaluate our algorithms on a single random split. Luckily, there\u2019s a better way. I bring you k-fold cross validation.", "Today, I\u2019m using Gareth James\u2019s classic Advertising data set where we have 200 records of TV, radio, and newspaper advertising spend and the resulting sales figure.", "I created a linear regression model to predict sales based on TV*Radio, and validated it on the test data set:", "AWESOME!! The model is killing it!", "This one score fails to show you the true predictive power of the model. In this situation, you\u2019re judging the football team based on a single game. You don\u2019t know if this is a \u2018lucky\u2019 train_test_split. In this case, yes. I cheated. Choosing a new random_state (71464) brings our model accuracy down to 0.80.", "There is a better way to optimize a model without being at the whim of your random state. A way that provides insight into the distribution of scores and reduces the risk of overfitting to your testing data set.", "When you run cross_val_score with a cross validation splitting strategy (cv) set to an integer, it does the following:", "You can then use the scores to get an estimate of the mean, standard deviation, and 95% confidence interval for your model\u2019s accuracy.", "How to use k-fold cross validation", "The basic use of scikit-learn\u2019s cross_val_score includes the following parameters:", "Note: There is no one \u2018right\u2019 number of folds. You want to consider the size of the data set in each fold. Ideally, the folds would be equal-size, especially important in very small data sets \u2014 so consider choosing a k-value that evenly divides your data set. Stanford\u2019s Hastie and Tibshirani point to k=5 or k=10 as typical k-values.", "Also note: cross_val_score does not automatically shuffle. If you want to run it multiple times (a la bootstrapping), make sure to include a shuffle.", "As always, check out the docs and user guide for more information.", "Going back to the Advertising data set, with the same single factor linear regression model (tv spend * radio spend), there are only a few changes needed to implement k-fold cross_val_score.", "Here, you get a lot more than the single snapshot: the mean and standard deviation of the accuracy over repeated trials. In this case I printed the approximate 95% confidence interval. Now that\u2019s worth getting excited about.", "When using preprocessing, cross validation takes a little more additional code, but still completely doable and worth it for this better understanding of a model\u2019s accuracy.", "As usual, when using preprocessing, you should not include your validation data, so that this data is \u2018new\u2019 to the model in the testing phase as opposed to leaking in via preprocessing. In order to avoid this while using k-fold cross validation, you\u2019ll want to use a Pipeline to pass these data transformations to cross_val_score in the first parameter. Although this adds some complexity to the code, it is fairly straightforward and is essential to producing a valid assessment of model performance.", "In this example, I am using the same Advertising data set with multiple regression. The features include TV spend, radio spend, newspaper spend, and TV spend * radio spend, and the model is predicting the product sales. With the pipeline, fed into the cross_val_score, the function will first split the data into train and validate, and then transform the training data set using the transformers in the order indicated by make_pipeline, in this case using StandardScaler() before fitting to LinearRegression().", "You see here that the mean model accuracy increases with the addition of these features, and that the 95% accuracy confidence interval also widens. This model\u2019s accuracy varies more with changes in the training dataset as compared to my more simple model above.", "K-fold cross validation is an excellent way to provide insight into the true quality of your team, accuracy of your machine learning model, by providing a broader evaluation, as opposed to a single, highly-tuned trial. It allows you to get the most out of your training set, while still saving bias from slipping in via overfitting to the testing set.", "Feel free to check out the GitHub repository for this blog.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist with a background in business, education, and environmental science."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe3e6f45becb2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@allison.stafford?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allison.stafford?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": "Allison Stafford"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87b1f621568d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&user=Allison+Stafford&userId=87b1f621568d&source=post_page-87b1f621568d----e3e6f45becb2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3e6f45becb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3e6f45becb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.flickr.com/photos/kjarrett/7818669582", "anchor_text": "Kevin Jarrett"}, {"url": "https://pixabay.com/users/htuuli-2596972/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2878336", "anchor_text": "htuuli"}, {"url": "https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=2878336", "anchor_text": "Pixabay"}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html", "anchor_text": "Scikit-learn Developers"}, {"url": "http://statweb.stanford.edu/~tibs/sta306bfiles/cvwrong.pdf", "anchor_text": "Hastie and Tibshirani"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html#sklearn.model_selection.cross_val_score", "anchor_text": "docs"}, {"url": "https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation", "anchor_text": "user guide"}, {"url": "https://www.flickr.com/photos/edanley/3246241416", "anchor_text": "Eric Danley"}, {"url": "https://github.com/allisonhonold/k_fold_cross_validation_blog", "anchor_text": "GitHub repository"}, {"url": "https://machinelearningmastery.com/k-fold-cross-validation/", "anchor_text": "A Gentle Introduction to k-fold Cross-ValidationCross-validation is a statistical method used to estimate the skill of machine learning models. It is commonly used in\u2026machinelearningmastery.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e3e6f45becb2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e3e6f45becb2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/model-selection?source=post_page-----e3e6f45becb2---------------model_selection-----------------", "anchor_text": "Model Selection"}, {"url": "https://medium.com/tag/python3?source=post_page-----e3e6f45becb2---------------python3-----------------", "anchor_text": "Python3"}, {"url": "https://medium.com/tag/scikit-learn?source=post_page-----e3e6f45becb2---------------scikit_learn-----------------", "anchor_text": "Scikit Learn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3e6f45becb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&user=Allison+Stafford&userId=87b1f621568d&source=-----e3e6f45becb2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe3e6f45becb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&user=Allison+Stafford&userId=87b1f621568d&source=-----e3e6f45becb2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe3e6f45becb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe3e6f45becb2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e3e6f45becb2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e3e6f45becb2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allison.stafford?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@allison.stafford?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Allison Stafford"}, {"url": "https://medium.com/@allison.stafford/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "386 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F87b1f621568d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&user=Allison+Stafford&userId=87b1f621568d&source=post_page-87b1f621568d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb4bbbb8c248&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-get-a-fuller-picture-of-a-models-accuracy-e3e6f45becb2&newsletterV3=87b1f621568d&newsletterV3Id=b4bbbb8c248&user=Allison+Stafford&userId=87b1f621568d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}