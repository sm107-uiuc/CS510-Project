{"url": "https://towardsdatascience.com/do-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff", "time": 1683007517.715785, "path": "towardsdatascience.com/do-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff/", "webpage": {"metadata": {"title": "Do my Repeat Customers Tend to Spend More on Their 2nd Purchase? | by Alon Rechavia | Towards Data Science", "h1": "Do my Repeat Customers Tend to Spend More on Their 2nd Purchase?", "description": "Today I woke up on my \u201cTableau-is-a-wonderful-tool-for-analytics-in-addition-to-visualizing-data\u201d side, and as a part of the ongoing mode to challenge my students (Naya College, Israel), I came up\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.naya-college.co.il/", "anchor_text": "Naya College", "paragraph_index": 0}, {"url": "https://www.tableau.com/about/blog/LOD-expressions", "anchor_text": "Top 15 LOD Expressions article by Bethany Lyons", "paragraph_index": 1}, {"url": "http://www.workout-wednesday.com/week-24-do-customers-spend-more-on-their-first-or-second-purchase/", "anchor_text": "Workout Wednesday week 24 challenge, composed by Ann Jackson", "paragraph_index": 1}, {"url": "https://help.tableau.com/current/pro/desktop/en-us/order_of_operations.htm#about-the-order-of-operations-aka-query-pipeline", "anchor_text": "Order of Operations", "paragraph_index": 17}, {"url": "https://www.linkedin.com/in/alonrechavia/", "anchor_text": "Linkedin profile", "paragraph_index": 18}, {"url": "http://linkedin.com/in/alonrechavia/", "anchor_text": "linkedin.com/in/alonrechavia/", "paragraph_index": 20}], "all_paragraphs": ["Today I woke up on my \u201cTableau-is-a-wonderful-tool-for-analytics-in-addition-to-visualizing-data\u201d side, and as a part of the ongoing mode to challenge my students (Naya College, Israel), I came up with an idea, that engages directly with the most challenging analytical topic in Tableau Desktop to teach \u2014 Level of Detail (LOD).", "In Short, their task was to calculate the customer ratio out of the total, who spent more money on the second purchase, and to present the answer as a single text number, with no dimension at the view. The inspiration to this derives from the well-known Top 15 LOD Expressions article by Bethany Lyons (who addressed a similar business question of repeat customers), and from the Workout Wednesday week 24 challenge, composed by Ann Jackson, which her focus was on Tableau Prep and also visualizing differently the answer.", "The following calculations are based on the EU Superstore dataset sample given by Tableau. It goes as follows:", "1. Calculating the first and second purchase date per Customer \u2014 The LOD expressions allow to aggregate data for dimensions, that not necessarily within the view. Let\u2019s start with classifying what is the 1st purchase. This is the syntax for the 1st purchase, we\u2019ll call it 1st Purchase Date:", "We should check ourselves by dragging the 1st Purchase Date and to see if it ignores the Order Date field (when the Customer is at the view) as seen below, meaning it ignores the granular level within the view.", "2. To calculate the 2nd Purchase Date, we need to address it differently. Usually, if all purchase dates were at the view, I\u2019d address it with LOOKUP Function. Bethany Lyons addressed it with a smart method, by giving each purchase date its own date, unless it was the first; So this would help us out with bringing the minimum date afterward, for this field, which is the 2nd Purchase Date. We\u2019ll call this field Repeat Purchase Dates and its syntax:  IIF([Order Date] > [1st Purchase Date], [Order Date], Null)", "Putting it in the view as we did before would be as follows:", "Now, as we did with 1st Purchase Date, we can implement the same thinking with the 2nd, taking the Repeat Purchase Dates field:", "3. The Sales of 1st and 2nd Purchase Dates: we need to match their sales to compare. We can address with the IIF functions as we did (A regular IF would do also), identifying whether its the 1st or 2nd dates, and to match their sales respectively. Since the granular level of our data is a purchased Product and not an Order ID, we should aggregate the given sales, so we can subtract it later from each other. These are the 1st Purchase Aggregated Sales and 2nd Purchase Aggregated Sales calculations:", "Note \u2014 We could also give all other purchase dates a Null instead of a 0 since the SUM doesn\u2019t consider the NULL.", "4. Comparing the Sales in a simple subtraction of the two last fields we created in a conditional statement would classify if indeed the 2nd purchase is greater from the 1st. We\u2019ll name as Is 2nd Purchase Greater?:", "Note \u2014 This syntax is encompassed by an IFNULL Function since they\u2019re customers who have only a single purchase; Since these customers don\u2019t have a value for the 2nd purchase, and subtraction between two values, if one of them is a NULL, will result in a NULL. We can classify them for a matter of convenience as \u2018Didn\u2019\u2019t Purchase Again\u2019 which is also a Nice to Have information.", "Putting Is 2nd Purchase Greater? in the view next to the Customer Name field will look as follows:", "4. Getting close to the end! the last field compares between the two purchases, but it doesn\u00b4t give the \u201cstamp\u201d we need for each customer, but for the purchases themselves, and a simple filter for this field taking the \u201cGreater\u201d value with customers count won\u2019t do, so let\u2019s aggregate this again, with a Status per Customer field:", "5. After classifying each customer status in this manner, let\u2019s count them! Putting in a new sheet the Customer Name field in the text as a COUNTD ( = COUNT DISTINCT), with the Status per Customer field in the filter, to include only \u201cGreater\u2019 value will result in our number ( = 415 Customers, the valid number for the dataset which ends on December 31st, 2019). But we seek to compare it to the overall number. For that, we\u2019ll build a calculation with an additional LOD expression (last but not least!) that\u2019d evaluate the customers count before the filter since a Fixed function happens before a dimensional filter. We\u2019ll name the new calculation as % of Customers Who Purchased More on 2nd Order:", "The numerator represents our 415 customers, while the denominator represents the overall customer count (= 795). The denominator\u2019s curly brackets (even without the fixed \u2014 redundant) creates the bypass we need for the filter; But the denominator in encompassed with a MAX function, since, every LOD is tabular variable in a way, and even without specifying a dimension inside the calculated field, with a single value as an aggregation, it still counts as a table (hard to perceive!). MAXing it (could also be a SUM, MIN) would make it a scalar function as it could be part of the fraction since aggregated expressions cannot be divided by a LOD expression.", "Putting the new field in a Text mark, and formatting the field into a percentage with 1 DP will look as follows:", "And there you have it. This is an important metric and smart business question for customer success measurement; Of course, it can be enhanced, and maybe even to be addressed with the 3rd purchase or even to be measured with the percentage growth between purchases per customer. But the primary focus for this article was to manifest the students more advanced LOD challenges with practical business examples after they achieved the demanded knowledge in the Tableau\u2019s functions and the Order of Operations. But to be honest, there\u2019s also a hidden message \u2014 it\u2019s worthy to contribute knowledge to the community, and I hope they\u2019ll learn this lesson by reading this article as well.", "Thanks for reading. I\u2019ll be grateful to read any remarks \u2014 on my Linkedin profile, or via alonrechavia@gmail.com.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Analyst | Content Writer | International Politics and Cultures Enthusiastic linkedin.com/in/alonrechavia/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6db1005500ff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6db1005500ff--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6db1005500ff--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@alonrechavia?source=post_page-----6db1005500ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alonrechavia?source=post_page-----6db1005500ff--------------------------------", "anchor_text": "Alon Rechavia"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff32516dadce7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&user=Alon+Rechavia&userId=f32516dadce7&source=post_page-f32516dadce7----6db1005500ff---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6db1005500ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6db1005500ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.naya-college.co.il/", "anchor_text": "Naya College"}, {"url": "https://www.tableau.com/about/blog/LOD-expressions", "anchor_text": "Top 15 LOD Expressions article by Bethany Lyons"}, {"url": "http://www.workout-wednesday.com/week-24-do-customers-spend-more-on-their-first-or-second-purchase/", "anchor_text": "Workout Wednesday week 24 challenge, composed by Ann Jackson"}, {"url": "https://help.tableau.com/current/pro/desktop/en-us/order_of_operations.htm#about-the-order-of-operations-aka-query-pipeline", "anchor_text": "Order of Operations"}, {"url": "https://www.linkedin.com/in/alonrechavia/", "anchor_text": "Linkedin profile"}, {"url": "https://medium.com/tag/tableau?source=post_page-----6db1005500ff---------------tableau-----------------", "anchor_text": "Tableau"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----6db1005500ff---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----6db1005500ff---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----6db1005500ff---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----6db1005500ff---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6db1005500ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&user=Alon+Rechavia&userId=f32516dadce7&source=-----6db1005500ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6db1005500ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&user=Alon+Rechavia&userId=f32516dadce7&source=-----6db1005500ff---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6db1005500ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6db1005500ff--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6db1005500ff&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6db1005500ff---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6db1005500ff--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6db1005500ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6db1005500ff--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6db1005500ff--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6db1005500ff--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6db1005500ff--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6db1005500ff--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6db1005500ff--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alonrechavia?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@alonrechavia?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Alon Rechavia"}, {"url": "https://medium.com/@alonrechavia/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "13 Followers"}, {"url": "http://linkedin.com/in/alonrechavia/", "anchor_text": "linkedin.com/in/alonrechavia/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff32516dadce7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&user=Alon+Rechavia&userId=f32516dadce7&source=post_page-f32516dadce7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ff32516dadce7%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdo-my-repeat-customers-tend-to-spend-more-on-their-2nd-purchase-6db1005500ff&user=Alon+Rechavia&userId=f32516dadce7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}