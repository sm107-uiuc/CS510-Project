{"url": "https://towardsdatascience.com/how-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed", "time": 1683007806.361453, "path": "towardsdatascience.com/how-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed/", "webpage": {"metadata": {"title": "How NLP has evolved for Financial Sentiment Analysis | by Neo Yi Peng | Towards Data Science", "h1": "How NLP has evolved for Financial Sentiment Analysis", "description": "Machine learning models aim to learn a good representation of its input data to perform its task. The way models learn to represent words with Natural language processing (NLP) has evolved in recent\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1307.5336", "anchor_text": "Financial Phrase Bank", "paragraph_index": 2}, {"url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=1331573", "anchor_text": "Loughran Macdonald dictionary", "paragraph_index": 3}, {"url": "http://kaichen.work/?p=399", "anchor_text": "code snippet", "paragraph_index": 3}, {"url": "https://gist.github.com/neoyipeng2018/73b61bec5e7034a92ea0a4e393202f7d", "anchor_text": "did a quick experiment here", "paragraph_index": 7}, {"url": "https://github.com/plasticityai/magnitude", "anchor_text": "pymagnitude", "paragraph_index": 8}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "BERT", "paragraph_index": 11}, {"url": "http://jalammar.github.io/illustrated-bert/", "anchor_text": "great article", "paragraph_index": 11}, {"url": "https://arxiv.org/abs/1801.06146", "anchor_text": "ULMFiT", "paragraph_index": 12}, {"url": "https://arxiv.org/abs/1908.10063", "anchor_text": "There is a nice paper, FinBERT", "paragraph_index": 13}, {"url": "https://arxiv.org/abs/2001.04451", "anchor_text": "Reformer", "paragraph_index": 15}, {"url": "https://arxiv.org/abs/2004.05150", "anchor_text": "Longformer", "paragraph_index": 15}, {"url": "https://arxiv.org/abs/1909.00109", "anchor_text": "a paper", "paragraph_index": 16}, {"url": "https://arxiv.org/abs/2005.14165?fbclid=IwAR1Cc2FIMZ-Eh-pPLeXNnB3GV7Nd4ER4AuCBbI9xc_gYPoSyFP58X202QuQ", "anchor_text": "GPT-3", "paragraph_index": 16}, {"url": "https://www.forbes.com/sites/michaelmolnar/2019/12/12/quantamental-investing-a-fuzzy-term-that-describes-an-inevitable-future/#434505a5ff07", "anchor_text": "quantamental approach", "paragraph_index": 17}, {"url": "https://bit.ly/3dsThtb", "anchor_text": "https://bit.ly/3dsThtb", "paragraph_index": 22}], "all_paragraphs": ["Machine learning models aim to learn a good representation of its input data to perform its task. The way models learn to represent words with Natural language processing (NLP) has evolved in recent years, and in this article, we explore the notable changes in how models understand language to make financial decisions.", "We focus on a direct application of NLP to financial markets: Automate sentiment classification of a text document to make fast and accurate investment calls that are free of human bias.", "For us to compare meaningfully across the technology shifts, we use a Financial Phrase Bank[1] that contains labelled financial phrases (example below):", "If we wanted a 8 year old to interpret the phrase above, we could give her a list of words with positive, neutral and negative labels, and ask her to tell us if the text contain any of those words \u2014 that is essentially what a lexicon method is. The most popular financial lexicon is the Loughran Macdonald dictionary[2]. If you are interested to try it out, use this code snippet that runs pretty quickly.", "Overall accuracy using LM is not great \u2014 61% [1]. So even though we can classify a text sequence quickly and understand why we classify them, we are heavily reliant on the words having a place in the dictionary. And even then, the words only have 1 dimension. Perhaps we will have better results representing every single word in a higher dimension, say 300?", "Embeddings take each word in a sequence and project them into a multi-dimensional space. We can think of embeddings as a wide lookup table \u2014 We have 300 columns with the words acting as the lookup index.", "The SOTA embeddings is likely ELMO\u2019s[2] contextual embeddings, i.e. embeddings that take into account the word and its surrounding context. The embeddings has three components: two are from bi-directional contextual representations and one is a context-independent representation.", "The embeddings by themselves are just representations \u2014 that alone cannot classify sentiment. So we have to train a model that uses the embeddings as inputs and learns to predict sentiment. I couldn\u2019t find any papers that tested on the phrase bank, so I did a quick experiment here.", "Side: Wasn\u2019t as quick as I thought \u2014 tensorflow/keras is much more iffy/painful than I remember. In the end I took the embeddings from a plug and play library called pymagnitude and used my trusty ol\u2019 random forest.", "Overall accuracy went up to 78%. Higher than LM dictionary, but still not fantastic. Embeddings are able to create multi-dimensional representations from words, but even if the embeddings are contextual, it is only a single layer of representations, no matter how big the dimensions are. It is time to explore a multi-layered representation with high dimensions, i.e. deep learning.", "Recent advancements in architecture and training methods have greatly improved the way deep learning models are able to learn language and perform downstream tasks.", "The transformer architecture and BERT[4] need no further introduction\u200a\u2014\u200arefer to this great article to learn more\u200a\u2014\u200abut in short, the use of self-attention and token masking allows a truly bi-directional contextual relationship to be learnt.", "The use of transfer learning in NLP was first introduced in ULMFiT[5], where a network first learns to predict the most probable word from a huge corpora of text, and then performs other tasks using the pre-trained weights from language modelling \u2014 this has led to improvements in convergence and reduced the need for a huge labelled dataset.", "There is a nice paper, FinBERT, that applied BERT and transfer learning to the phrase bank and achieved 97% accuracy! Btw, if you\u2019re interested to see how you can use FinBERT to trade on corporate filing sentiment, I made a video that brings you through the entire process from parsing the filings to backtesting the results!", "So are we done? Can machines analyse financial documents and churn out accurate and objective sentiment while we sip on our martinis? Do we no longer need human analysts to pore through reams of financial statements and be on the constant alert for Bloomberg headlines?", "There are practical limits in current BERT models, like the quadratic increase in computational cost with input length \u2014 the maximum input length usually caps at 512/1024 tokens. Reformer and Longformer are recent papers that try to solve it by simplifying the self-attention mechanism.", "Also, BERT cannot do mental sums \u2014 it only contains text representations. This is a major bottleneck for machines to fully understand and analyse financial documents which typically contain lots of numbers. I found a paper that tries to augment BERT with a program to do basic math \u2014 but it\u2019s likely a long wait before BERT can perform human level reasoning. **Update: GPT-3 released by OpenAI is able to do zero-shot calculations without being trained beforehand!", "Most importantly, financial text can be ambiguous and often require contextual knowledge that text alone cannot provide \u2014 the high accuracy achieved by BERT was on phrases that had 100% agreement among human annotators. The other phrases that even humans disagree on makes it very unlikely that machines will trump human analysts. More likely, a quantamental approach will dominate the markets, where financial analysts are augmented with machine learning to make accurate, fast and objective investment decisions.", "[3] Matthew Peters, Mark Neumann, Mohit Iyyer, Matt Gardner, Christopher Clark, Kenton Lee, and Luke Zettlemoyer. 2018a. Deep contextualized word representations. In NAACL.", "[4] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Bert: Pre-training of deep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805, 2018.", "[5] J. Howard and S. Ruder. Universal language model fine-tuning for text classification. Association for Computational Linguistics (ACL), 2018.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I condense insights/ideas from my machine learning experiments in the markets. Connect with me on LinkedIn: https://bit.ly/3dsThtb"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffb2990d9b3ed&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@neoyipeng?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@neoyipeng?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": "Neo Yi Peng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F486d40b5ad58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&user=Neo+Yi+Peng&userId=486d40b5ad58&source=post_page-486d40b5ad58----fb2990d9b3ed---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb2990d9b3ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb2990d9b3ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1307.5336", "anchor_text": "Financial Phrase Bank"}, {"url": "https://www.hillcrestasset.com/behavioral-finance/hillcrest-finance-award/2014-hbfa/", "anchor_text": "Source"}, {"url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=1331573", "anchor_text": "Loughran Macdonald dictionary"}, {"url": "http://kaichen.work/?p=399", "anchor_text": "code snippet"}, {"url": "https://gist.github.com/neoyipeng2018/73b61bec5e7034a92ea0a4e393202f7d", "anchor_text": "did a quick experiment here"}, {"url": "https://github.com/plasticityai/magnitude", "anchor_text": "pymagnitude"}, {"url": "https://arxiv.org/abs/1810.04805", "anchor_text": "BERT"}, {"url": "http://jalammar.github.io/illustrated-bert/", "anchor_text": "great article"}, {"url": "https://arxiv.org/abs/1801.06146", "anchor_text": "ULMFiT"}, {"url": "https://arxiv.org/abs/1908.10063", "anchor_text": "There is a nice paper, FinBERT"}, {"url": "https://arxiv.org/abs/2001.04451", "anchor_text": "Reformer"}, {"url": "https://arxiv.org/abs/2004.05150", "anchor_text": "Longformer"}, {"url": "https://arxiv.org/abs/1909.00109", "anchor_text": "a paper"}, {"url": "https://arxiv.org/abs/2005.14165?fbclid=IwAR1Cc2FIMZ-Eh-pPLeXNnB3GV7Nd4ER4AuCBbI9xc_gYPoSyFP58X202QuQ", "anchor_text": "GPT-3"}, {"url": "https://www.forbes.com/sites/michaelmolnar/2019/12/12/quantamental-investing-a-fuzzy-term-that-describes-an-inevitable-future/#434505a5ff07", "anchor_text": "quantamental approach"}, {"url": "https://doi.org/10.1002/asi.23062", "anchor_text": "https://doi.org/10.1002/asi.23062"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----fb2990d9b3ed---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fb2990d9b3ed---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/ai?source=post_page-----fb2990d9b3ed---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/python?source=post_page-----fb2990d9b3ed---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/investing?source=post_page-----fb2990d9b3ed---------------investing-----------------", "anchor_text": "Investing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb2990d9b3ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&user=Neo+Yi+Peng&userId=486d40b5ad58&source=-----fb2990d9b3ed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffb2990d9b3ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&user=Neo+Yi+Peng&userId=486d40b5ad58&source=-----fb2990d9b3ed---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffb2990d9b3ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffb2990d9b3ed&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fb2990d9b3ed---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fb2990d9b3ed--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@neoyipeng?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@neoyipeng?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Neo Yi Peng"}, {"url": "https://medium.com/@neoyipeng/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "864 Followers"}, {"url": "https://bit.ly/3dsThtb", "anchor_text": "https://bit.ly/3dsThtb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F486d40b5ad58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&user=Neo+Yi+Peng&userId=486d40b5ad58&source=post_page-486d40b5ad58--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F57433219cfac&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-nlp-has-evolved-for-financial-sentiment-analysis-fb2990d9b3ed&newsletterV3=486d40b5ad58&newsletterV3Id=57433219cfac&user=Neo+Yi+Peng&userId=486d40b5ad58&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}