{"url": "https://towardsdatascience.com/machine-learning-in-production-95e1999bba84", "time": 1683018216.330781, "path": "towardsdatascience.com/machine-learning-in-production-95e1999bba84/", "webpage": {"metadata": {"title": "Machine Learning in Production. Using Google Cloud Functions (Part-3) | by asjad anis | Towards Data Science", "h1": "Machine Learning in Production", "description": "This is going to be the last article in this series where we will explore Google Cloud Functions as our third option of choice when deploying machine learning models. In the previous articles, we\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cloud.google.com/functions", "anchor_text": "Google Cloud Functions", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/machine-learning-in-production-3d54860ff1d9", "anchor_text": "Tensorflow-serving", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/machine-learning-in-production-633548ad7281", "anchor_text": "AI-Platform", "paragraph_index": 0}, {"url": "https://cloud.google.com/functions", "anchor_text": "official docs", "paragraph_index": 2}, {"url": "https://cloud.google.com/blog/products/ai-machine-learning/how-to-serve-deep-learning-models-using-tensorflow-2-0-with-cloud-functions", "anchor_text": "article", "paragraph_index": 15}, {"url": "https://www.linkedin.com/in/asjad-anis/", "anchor_text": "LinkedIn", "paragraph_index": 18}], "all_paragraphs": ["This is going to be the last article in this series where we will explore Google Cloud Functions as our third option of choice when deploying machine learning models. In the previous articles, we explored Tensorflow-serving and AI-Platform. Before we dive into setting up our cloud function let\u2019s first briefly have a glance at what cloud functions are.", "Cloud functions are triggered by events such as an HTTP call and used to invoke some other service or give immediate response without having to manage infrastructure. Cloud functions automatically scale based on the load and you only pay for what you use. One thing to mention here is that cloud-functions were not built specifically for machine learning tasks but as a multi-purpose solution so they might not be suitable for complex workflows but can serve well as an intermediate layer sitting between the client and the deployed model which is responsible for data pre-processing before passing it to a tensorflow-serving instance for the actual prediction.", "Now that we have a basic know-how of cloud functions let's dive into setting up one for our mnist-digit-classifier. If you wish to learn more about cloud-functions head over to the official docs for a deeper understanding of cloud-functions.", "Let\u2019s get started and create our first cloud function, head over to your GCP-Console and from the side-bar select cloud function. Once you are in the view click Create Function.", "In the next screen, you can name your cloud-function and decide the trigger type, I am going to name my function predict-mnist-digit and keep the trigger-type as HTTP. I am going to go with the default advanced settings except for memory-allocation. For the sake of this tutorial, I will allow unauthenticated invocations, but you can change the config to your needs.", "Once you have edited click Save and hit Next, and you will be taken to the below screen where you can start implementing your cloud-function.", "You might have to enable the Cloud Build API if not enabled already.", "I will be using python as the runtime and we can see that there are already two files created for us, we can specify the package requirements in the requirements.txt file and write our code in the main.py file. Similarly, we can also specify the entry point of our cloud function which in this default template is the hello_world function.", "Now we just need to place the required packages in the requirements.txt file and write code to serve predictions. For predictions, I will be using the model we uploaded to the cloud-storage bucket in the first part of this series.", "You can also use the deployed model on tensorflow-serving or AI-Platform and use the cloud-function as a middle layer for pre-processing the data since doing such operations on the client-side is not ideal and time taking.", "Go ahead and update the requirements for the cloud function, I will be using the below two packages.", "Next we need to implement our cloud function which will be responsible for", "Let\u2019s first write code to download the model", "Here we are first creating the download-directory for our model, after that, we are getting the files from the bucket and downloading them.", "Next, we need to load the downloaded model.", "Note that we are using the global model variable because we don\u2019t want our model to be downloaded on every client request, which is also known as a cold invocation. We want to have more warm invocations where we use the cached model instead of downloading and loading it on every request which is just not ideal. Having more warm invocations not only reduces the response time but also reduces the cost. This article from google-cloud explains this very nicely, do give it a read for a better understanding of the concepts.", "Lastly, we need to handle the incoming requests and respond with model predictions.", "And that\u2019s it we have a cloud function up and running which will automatically scale based on the load. To test it quickly you can make an HTTP-POST request to the cloud function and pass in the data, below is a sample python code snippet that you can use to invoke the cloud function", "And that's it I hope this series has helped you. For any queries or suggestions, you can leave a comment and you can connect with me on LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer | ML Enthusiast | Creative Programmer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F95e1999bba84&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----95e1999bba84--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95e1999bba84--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://asjadanis128.medium.com/?source=post_page-----95e1999bba84--------------------------------", "anchor_text": ""}, {"url": "https://asjadanis128.medium.com/?source=post_page-----95e1999bba84--------------------------------", "anchor_text": "asjad anis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46e3b4d207b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&user=asjad+anis&userId=46e3b4d207b6&source=post_page-46e3b4d207b6----95e1999bba84---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95e1999bba84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95e1999bba84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tracamyng?utm_source=medium&utm_medium=referral", "anchor_text": "Tr\u00e0 My"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://cloud.google.com/functions", "anchor_text": "Google Cloud Functions"}, {"url": "https://towardsdatascience.com/machine-learning-in-production-3d54860ff1d9", "anchor_text": "Tensorflow-serving"}, {"url": "https://towardsdatascience.com/machine-learning-in-production-633548ad7281", "anchor_text": "AI-Platform"}, {"url": "https://cloud.google.com/functions", "anchor_text": "official docs"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Platform"}, {"url": "https://cloud.google.com/blog/products/ai-machine-learning/how-to-serve-deep-learning-models-using-tensorflow-2-0-with-cloud-functions", "anchor_text": "article"}, {"url": "https://www.linkedin.com/in/asjad-anis/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----95e1999bba84---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----95e1999bba84---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/google-cloud?source=post_page-----95e1999bba84---------------google_cloud-----------------", "anchor_text": "Google Cloud"}, {"url": "https://medium.com/tag/deployment?source=post_page-----95e1999bba84---------------deployment-----------------", "anchor_text": "Deployment"}, {"url": "https://medium.com/tag/python?source=post_page-----95e1999bba84---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95e1999bba84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&user=asjad+anis&userId=46e3b4d207b6&source=-----95e1999bba84---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F95e1999bba84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&user=asjad+anis&userId=46e3b4d207b6&source=-----95e1999bba84---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F95e1999bba84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----95e1999bba84--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F95e1999bba84&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----95e1999bba84---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----95e1999bba84--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----95e1999bba84--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----95e1999bba84--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----95e1999bba84--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----95e1999bba84--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----95e1999bba84--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----95e1999bba84--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----95e1999bba84--------------------------------", "anchor_text": ""}, {"url": "https://asjadanis128.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://asjadanis128.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "asjad anis"}, {"url": "https://asjadanis128.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "73 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46e3b4d207b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&user=asjad+anis&userId=46e3b4d207b6&source=post_page-46e3b4d207b6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Faadeff2fb71&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmachine-learning-in-production-95e1999bba84&newsletterV3=46e3b4d207b6&newsletterV3Id=aadeff2fb71&user=asjad+anis&userId=46e3b4d207b6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}