{"url": "https://towardsdatascience.com/live-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e", "time": 1683000881.885403, "path": "towardsdatascience.com/live-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e/", "webpage": {"metadata": {"title": "Live Prediction of Traffic Accident Risks Using Machine Learning and Google Maps | by Meraldo Antonio | Towards Data Science", "h1": "Live Prediction of Traffic Accident Risks Using Machine Learning and Google Maps", "description": "Traffic accidents are extremely common. If you live in a sprawling metropolis like I do, chances are that you\u2019ve heard about, witnessed, or even involved in one. Because of their frequency, traffic\u2026"}, "outgoing_paragraph_urls": [{"url": "https://kteo7.pythonanywhere.com/", "anchor_text": "machine learning model", "paragraph_index": 2}, {"url": "https://github.com/meraldoantonio/AccidentPredictor", "anchor_text": "GitHub repository", "paragraph_index": 3}, {"url": "https://kteo7.pythonanywhere.com/", "anchor_text": "website", "paragraph_index": 3}, {"url": "https://www.kaggle.com/daveianhickey/2000-16-traffic-flow-england-scotland-wales/version/8", "anchor_text": "Kaggle.", "paragraph_index": 7}, {"url": "https://kteo7.pythonanywhere.com/darksky.net", "anchor_text": "Dark Sky", "paragraph_index": 9}, {"url": "http://kteo7.pythonanywhere.com", "anchor_text": "kteo7.pythonanywhere.com", "paragraph_index": 31}, {"url": "http://kteo7.pythonanywhere.com", "anchor_text": "kteo7.pythonanywhere.com", "paragraph_index": 39}, {"url": "https://www.linkedin.com/in/meraldo/", "anchor_text": "LinkedIn", "paragraph_index": 41}, {"url": "https://medium.com/@meraldo.antonio/membership", "anchor_text": "my referral link", "paragraph_index": 41}], "all_paragraphs": ["Traffic accidents are extremely common. If you live in a sprawling metropolis like I do, chances are that you\u2019ve heard about, witnessed, or even involved in one. Because of their frequency, traffic accidents are a major cause of death globally, cutting short millions of lives per year. Therefore, a system that can predict the occurrence of traffic accidents or accident-prone areas can potentially save lives.", "Although difficult, traffic accident prediction is not impossible. Accidents don\u2019t arise in a purely random manner; their occurrence is influenced by a multitude of factors such as drivers\u2019 physical conditions, car types, driving speed, traffic condition, road structure and weather. Studying historical accident records would help us understand the (potentially causative) relationships between these factors and road accidents, which would in turn allow us to build an accident predictor.", "Fortunately, several of such accident records are publicly available! For instance, the UK government has published detailed records of traffic accidents in the country dating back to 2002. With this data set, my teammates and I have created and deployed a machine learning model that predicts with high accuracy as to when and where accidents are likely to occur in Greater London.", "In this article, I will take you through the process of completing this project. The complete code can be found in my GitHub repository, while the live model can be accessed at this website.", "Before embarking on this project, we set ourselves a clear objective: we wanted to create an interactive traffic accident predictor that would be easily accessible by anyone. We decided that the best way to achieve this goal was to deploy a trained predictor on a website. This predictor-website should be capable of doing the following:", "The steps we undertook to achieve this objective are depicted in the diagram below. I will elaborate them in the sections that follow.", "Having defined an objective, we proceeded to look for the necessary data. The following are the two data sets we finally chose:", "The main data set we used for this project was a detailed accident record published by the UK government and hosted on Kaggle. This data set contains details about 1.6 million traffic accidents that took place in the UK between 2000 and 2014. It consists of 33 columns which capture details such as the location, time, severity of the accidents as well as various meteorological and traffic backdrops. In this project, we restricted ourselves to analyzing traffic accidents in Greater London between 2012 and 2014.", "We believe that weather is a particularly important factor in road accidents. Although the aforementioned Kaggle data set contains meteorological information, we didn\u2019t think that it\u2019s sufficient. There were the two issues about using the weather_condition column of the Kaggle dataset:", "Because of these reasons, we decided to instead make use of the meteorological data provided by Dark Sky, an American company that specializes in weather forecasting. Dark Sky provides both past records and future weather forecast updated on a half-hourly basis, which perfectly serves our purpose.", "Upon exploring the data set, we found that almost every street in London has once been an accident site. This makes sense\u2014 London is a bustling city where traffic accidents (including minor ones) happen very frequently. The picture below, created using Tableau, superimposes accident locations (red dots) on the map of London. Notice how the whole city is bathed in red!", "Although accidents have happened all across the city, some areas are more accident-prone than the others. In order to systematically identify these accident hot spots, we grouped the aforementioned accident locations into clusters. We defined a cluster to be an area with a cross-section of 25 meters in which at least 14 accidents had occurred within the two-year time window.", "We used the DBSCAN algorithm to perform this clustering. DBSCAN was chosen due to its speed, its ability to find arbitrarily-shaped clusters and its robustness to outlier. The accident spots that fall outside of the clusters were regarded as outliers and were excluded from our subsequent analysis.", "The DBSCAN clustering step resulted in the discovery of 473 accident hot spots. These hot spots were visualized below using ArcGIS, a software for geographical analysis. We can see the hot spots are concentrated on the major roads of London such as A11 and A13.", "At this point, we had several hundreds of accident hot spots. One thing I should clarify \u2014 these hot spots are not accident-prone 100% of the time. For instance, accident hot spots along London\u2019s main arteries might be risky during the rush hours but relatively safe during quieter times. On the other hand, hot spots in a sharp turn might be pretty harmless on a bright, sunny day but might become mortal on a snowy or rainy day.", "Thus, our next task was to find out under which conditions these hot spots are \u201cactivated\u201d. Framed this way, our project now became a classic binary classification problem: we needed to find out the combination of factors (e.g. weather, time, etc) that would \u201cactivate\u201d a hot spot.", "However, our data at this point weren\u2019t yet sufficient to create a classification model! Training a classifier requires both positive and negative samples, but we only had positive ones (i.e. records whose is_accident target label is 1). Thus, we needed a way to generate negative samples (i.e. records of \u201cnon-accidents\u201d ).", "The generation of negative samples using positive samples had previously been described. We followed a method described by Yuan et al.\u00b9 In essence, this method entails the random generation of three negative samples for every positive sample in the cluster. For instance, if we had a cluster located on Abbey Road in which 15 accidents had occurred, we would randomly synthesize 45 records of non-accidents for this very spot. Except for their location, other predictive features of these negative samples, such as date and time of the non-accident events were selected at random. Caution was taken so that these randomly-synthesized negative samples did not coincidentally match the real positive samples.", "Upon exploring our cleaned data set, we made several interesting observations. Some of the more interesting observations are elaborated below.", "Which months are road traffic accidents most likely to occur?", "The heat map above shows how many accidents have occurred for each day of the week in all calendar months. We can see that the months of September until December are characterized by a relatively high frequency of accident. These are the months of autumn in London, which are characterized by low temperature, fog and rain. Counter-intuitively, fewer accidents take place in the chilly winter months of January and February. This might suggest that people are more reluctant to drive during this time.", "What time of the day are road traffic accidents most likely to occur?", "The heat map above shows how many traffic accidents have occurred in each hour for each day of the week. We observed that unsurprisingly, most accidents transpire during morning rush hour from 8 am to 9 am and evening rush hour from 3pm to 7pm (purple blocks). Friday is particularly bad.", "How many vehicles are involved per accident?", "The bar graph above shows the distribution of accidents based on the number of vehicles involved. It indicates that most accidents involve one or two vehicles. This intuitively makes sense; most accidents happen as a result of a c ar veering off the road and/or collision between two cars.", "In which boroughs do traffic accidents occur most often?", "The bar chart above shows how many accidents take place in different boroughs of London. We see that Westminster takes the number one spot and Kingston Upon Thames comes in last place with the least traffic accidents. The map below presents the same information in a different way: it highlights the accident-prone boroughs in darker shades of purple.", "With the aforementioned pre-processing steps, we were finally ready to proceed to the modeling stage! We split our data set in a 70:30 ratio into a training and testing data set.", "Python\u2019s scikit-learn library was used for model training and evaluation. We attempted common classification models such as SVM, logistic regression and random forest. The models\u2019 relative performance was measured and compared using accuracy and area under Receiver Operating Characteristic curve (AUC-ROC). The results of our modeling steps are summarized in the table below.", "We found that among the models we tested, the best performing model was random forest trained on only numerical features. This was the model we selected for deployment, a process I shall describe below.", "We then packaged our scikit-learn model into a web application using Flask, a Python web framework. The front-end display of the website was built off of a free template taken from the website HTML5UP . All the html, javascript and CSS codes were integrated in to the Flask application.", "The application was then is then made online by PythonAnywhere, a Python-focused web hosting service. You can visit the website on kteo7.pythonanywhere.com. Here is a screenshot of the website:", "Now I\u2019d like to provide more details into the workings of the Flask application.", "On the front end, there are fields where user can input the origin and destination of their choosing. These text fields are equipped with Google Places API that provide autocomplete feature. There is also a drop down menu with which the user can pick a date/time (can be past, present, or within 48 hours into the future).", "Once these inputs are made, a POSTrequest is sent to the backend framework. Here, these inputs act as arguments to the function call_google. Given an origin and destination, this function will call a Google Maps API that will return the best driving route connecting the two. More specifically, the function returns the latitudes and longitudes of the route\u2019s waypoints, which are regularly-spaced points along the route.", "The latitudes and longitudes serve as inputs to another function called calc_distance. This function \u201cdraws\u201d imaginary circles with a radius of 50 meters from these waypoints and checks whether or not there are any accident hot spots that fall within these waypoints.", "For each cluster falling inside the circles, yet another function, call_darksky, makes a request to the Dark Sky API. This function will return the weather forecast for the spot in the specified time.", "With the weather data, together with the information on the date/time information, the final predict function will perform a binary prediction on whether or not the hot spots of interest are \u201cactivated\u201d under the chosen weather/time. These predictions are then sent to the front-end, which will display them on the screen.", "The gif below shows our interactive model in action. Here, I picked a future date and time (6 pm on Saturday, October 12th), chose an origin (Hyde Park) and a destination (King\u2019s Cross). We can see that the model chose a route that passes through Gloucester Place and A501 and flagged the busy intersection between these two roads as a potential accident site.", "Again, you can access this model on kteo7.pythonanywhere.com. I encourage you to play around with it while it\u2019s still active (it will be active until early 2020).", "Note: all images and animations above belong to me unless specified otherwise.", "If you have any comments about the article or would like to reach out to me, feel free to send me a connection through LinkedIn. Also, I\u2019d be very grateful if you could support me by becoming a Medium member through my referral link. As a member, you\u2019ll be able to read all my writings on data science and personal development and have full access to all stories on Medium.", "This project was a part of a course, \u201cData and Visual Analytics\u201d, that I took as a part of my Master\u2019s in Analytics from Georgia Institute of Technology. Special thanks to my teammates in this project \u2014 Katannya, Roger, Siew Lee and Yeok! You guys rock!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist @ DBS \ud83c\uddf8\ud83c\uddec. Enthusiast of quantitative finance, operations research, MLOps, and Cloud Computing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd2eeffb9389e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@meraldo.antonio?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@meraldo.antonio?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": "Meraldo Antonio"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65b4354e2ed8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&user=Meraldo+Antonio&userId=65b4354e2ed8&source=post_page-65b4354e2ed8----d2eeffb9389e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2eeffb9389e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2eeffb9389e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/ZWXx6uERI6M", "anchor_text": "unsplash"}, {"url": "https://kteo7.pythonanywhere.com/", "anchor_text": "machine learning model"}, {"url": "https://github.com/meraldoantonio/AccidentPredictor", "anchor_text": "GitHub repository"}, {"url": "https://kteo7.pythonanywhere.com/", "anchor_text": "website"}, {"url": "https://kteo7.pythonanywhere.com/", "anchor_text": "Road Traffic AccidentIn this project, we built a machine learning model that predicts the probability of RTAs in different locations in\u2026kteo7.pythonanywhere.com"}, {"url": "https://www.kaggle.com/daveianhickey/2000-16-traffic-flow-england-scotland-wales/version/8", "anchor_text": "Kaggle."}, {"url": "https://kteo7.pythonanywhere.com/darksky.net", "anchor_text": "Dark Sky"}, {"url": "http://kteo7.pythonanywhere.com", "anchor_text": "kteo7.pythonanywhere.com"}, {"url": "http://kteo7.pythonanywhere.com", "anchor_text": "kteo7.pythonanywhere.com"}, {"url": "https://www.linkedin.com/in/meraldo/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/@meraldo.antonio/membership", "anchor_text": "my referral link"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d2eeffb9389e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/google?source=post_page-----d2eeffb9389e---------------google-----------------", "anchor_text": "Google"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d2eeffb9389e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/web-development?source=post_page-----d2eeffb9389e---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/tag/transportation?source=post_page-----d2eeffb9389e---------------transportation-----------------", "anchor_text": "Transportation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd2eeffb9389e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&user=Meraldo+Antonio&userId=65b4354e2ed8&source=-----d2eeffb9389e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd2eeffb9389e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&user=Meraldo+Antonio&userId=65b4354e2ed8&source=-----d2eeffb9389e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2eeffb9389e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd2eeffb9389e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d2eeffb9389e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d2eeffb9389e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@meraldo.antonio?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@meraldo.antonio?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Meraldo Antonio"}, {"url": "https://medium.com/@meraldo.antonio/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "367 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65b4354e2ed8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&user=Meraldo+Antonio&userId=65b4354e2ed8&source=post_page-65b4354e2ed8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff1745664aa6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flive-prediction-of-traffic-accident-risks-using-machine-learning-and-google-maps-d2eeffb9389e&newsletterV3=65b4354e2ed8&newsletterV3Id=f1745664aa6d&user=Meraldo+Antonio&userId=65b4354e2ed8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}