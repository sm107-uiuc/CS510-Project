{"url": "https://towardsdatascience.com/movie-recommender-system-52e4651f3ae7", "time": 1683005255.3893719, "path": "towardsdatascience.com/movie-recommender-system-52e4651f3ae7/", "webpage": {"metadata": {"title": "Movie Recommender System: Part 2. Learn how to find an optimal number of\u2026 | by Diven Sambhwani | Towards Data Science", "h1": "Movie Recommender System: Part 2", "description": "When it comes to recommending items in a recommender system, we are highly interested in recommending only top K items to the user and to find that optimal number recall and precision are used\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/divensambhwani/", "anchor_text": "LinkedIn", "paragraph_index": 30}], "all_paragraphs": ["When it comes to recommending items in a recommender system, we are highly interested in recommending only top K items to the user and to find that optimal number recall and precision are used.", "Precision: Makes an attempt to answer \u201cWhat proportion of positive identifications by the model are literally correct?\u201d", "True positive / (True positive+False Positive).", "Recall: Makes an attempt to answer \u201cWhat proportion of actual positives were known properly by the model?\u201d", "True positive / (True Positive+False Negative)", "In certain circumstances, we might recognize that we need to focus on Recall or Precision. For example, in screening whether a person is infected with some disease, the recall will be the option to go for.", "Recall and Precision are the classic evaluation metric and are used to evaluate the binary metric and so we have to convert our rating which is scaled from (1\u20135) into a binary problem, where 0 will be relevant and 1 will be not relevant items.", "To do the translation we have to select an arbitrary value on which we can say any rating above will be considered relevant. There are many methods of selecting that value but for now, we will select 3.5 as the threshold, which means any true rating above 3.5 will be considered relevant and below will not be relevant.", "Recommended item: Predicted Rating > = 3.5", "Not Recommended item: Predicted Rating > = 3.5", "In situations where we want to obtain a mixture of both, we can use the F1 score which is basically the harmonic mean of precision and recall.", "The below function computes precision and recall and F1 score as explained above.", "As per the results above, the optimal value for the threshold is 2.5.", "In Recommender Systems, we are interested in showing the top N items to users and so the best is to compute precision and recall on top N values instead of calculating on all the items.", "The next step is to find the optimal K value, and to find it we have to first calculate precision and recall for all the K values(2\u201310) having threshold value 2.5.", "Below is the function to calculate Precision and Recall @ K.", "Now, let's call the above-defined function and average it over all the users.", "As the graph states, Precision drops significantly after \u20184\u2019, So we will consider the value of K to be 4.", "Now as we know the optimal number of recommendations to provide, it\u2019s time to give recommendations to users. To do so we have to predict ratings for the movies which the user has not yet watched.", "First, we will train an SVD algorithm on the movie lens dataset.", "Then predict ratings for all pairs (u, i) that are NOT in the training set.", "Let\u2019s now sort all the ratings", "Now we have a data frame that consists of the top 4 movies recommended to every user.", "Let\u2019s create a function which will return recommended movies for the given user:", "Let\u2019s try one example and find recommendations for user 67", "The above image is showing top \u201c4\u201d recommendations for user 67, \u201cMovie-id Predicted-Rating\u201d. But we just need the movies and not the ratings, so let\u2019s extract the movie id\u2019s from the result and then get the movie details from the movie table", "Now we can compare the results with the user history and see how relevant the recommendations are.", "Below are the most highly rated movies by the user 67", "As the history of the user tells us that the user mostly likes Drama movies and we are recommending all the Drama movies, which means we are recommending the right movies to the user.", "Looks like you\u2019re enjoying the post!", "If you have any thoughts or suggestions please feel free to comment. You can also reach me through LinkedIn.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F52e4651f3ae7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sambhwanidiven?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sambhwanidiven?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": "Diven Sambhwani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7a3026b90232&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&user=Diven+Sambhwani&userId=7a3026b90232&source=post_page-7a3026b90232----52e4651f3ae7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52e4651f3ae7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52e4651f3ae7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@georgiavagim?utm_source=medium&utm_medium=referral", "anchor_text": "Georgia Vagim"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/movie-recommender-system-part-1-7f126d2f90e2?source=friends_link&sk=b28e7ae7f1cf97b0a7a59d0aa8c692ff", "anchor_text": "Here"}, {"url": "https://github.com/divensambhwani/MovieLens-100K_Recommender-System/blob/master/MovieLens-100K-Recommeder%20System-SVD.ipynb", "anchor_text": "here"}, {"url": "https://www.linkedin.com/in/divensambhwani/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/@m_n_malaeb/recall-and-precision-at-k-for-recommender-systems-618483226c54", "anchor_text": "https://medium.com/@m_n_malaeb/recall-and-precision-at-k-for-recommender-systems-618483226c54"}, {"url": "https://towardsdatascience.com/beyond-accuracy-precision-and-recall-3da06bea9f6c", "anchor_text": "https://towardsdatascience.com/beyond-accuracy-precision-and-recall-3da06bea9f6c"}, {"url": "https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall?hl=ru", "anchor_text": "https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall?hl=ru"}, {"url": "https://surprise.readthedocs.io/en/stable/", "anchor_text": "https://surprise.readthedocs.io/en/stable/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----52e4651f3ae7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/recommendation-system?source=post_page-----52e4651f3ae7---------------recommendation_system-----------------", "anchor_text": "Recommendation System"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----52e4651f3ae7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----52e4651f3ae7---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/collaborative-filtering?source=post_page-----52e4651f3ae7---------------collaborative_filtering-----------------", "anchor_text": "Collaborative Filtering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52e4651f3ae7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&user=Diven+Sambhwani&userId=7a3026b90232&source=-----52e4651f3ae7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52e4651f3ae7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&user=Diven+Sambhwani&userId=7a3026b90232&source=-----52e4651f3ae7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52e4651f3ae7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F52e4651f3ae7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----52e4651f3ae7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----52e4651f3ae7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sambhwanidiven?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sambhwanidiven?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Diven Sambhwani"}, {"url": "https://medium.com/@sambhwanidiven/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "29 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7a3026b90232&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&user=Diven+Sambhwani&userId=7a3026b90232&source=post_page-7a3026b90232--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F216ccbeb3c1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmovie-recommender-system-52e4651f3ae7&newsletterV3=7a3026b90232&newsletterV3Id=216ccbeb3c1&user=Diven+Sambhwani&userId=7a3026b90232&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}