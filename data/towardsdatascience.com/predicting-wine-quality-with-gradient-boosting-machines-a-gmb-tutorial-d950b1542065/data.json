{"url": "https://towardsdatascience.com/predicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065", "time": 1682996301.739022, "path": "towardsdatascience.com/predicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065/", "webpage": {"metadata": {"title": "Predicting Wine Quality with Gradient Boosting Machines | by Claire Longo | Towards Data Science", "h1": "Predicting Wine Quality with Gradient Boosting Machines", "description": "This article gives a tutorial for training a Gradient Boosting Machine (GBM) model that predicts the quality of a wine using only the price and a written description of the wine. In many real Data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "Kaggle", "paragraph_index": 3}, {"url": "https://github.com/statisticianinstilettos/wine_quality_predictions/blob/master/deploy_wine_model.ipynb", "anchor_text": "this notebook", "paragraph_index": 24}, {"url": "https://github.com/statisticianinstilettos/wine_quality_predictions/blob/master/train_wine_gbt.py", "anchor_text": "train_wine_gbt.py", "paragraph_index": 24}, {"url": "https://github.com/statisticianinstilettos/wine_quality_predictions", "anchor_text": "here", "paragraph_index": 26}], "all_paragraphs": ["This article gives a tutorial for training a Gradient Boosting Machine (GBM) model that predicts the quality of a wine using only the price and a written description of the wine. In many real Data Science projects, it is important to take the projects into the next phase by deploying a live model that others can use to get real-time predictions. In this article, I demonstrate the model training and deployment process using AWS SageMaker to create a live endpoint.", "I wanted to purchase a bottle of \u201csummer water\u201d rose from Winc, an online wine subscription service. Since I\u2019m unable to try it before I buy, I wanted to get an estimate of the quality before I decide to purchase. At the end of this post, we\u2019ll see the quality prediction for this wine using the trained GBM model.", "Let\u2019s jump into the data and modeling!", "This model uses a Gradient Boosting Trees Regression and real data from Kaggle to predict the quality points of a bottle of wine (y). Wine \u201cpoints\u201d are on a scale of 0\u2013100 and are categorized by Wine Spectator as follows:", "The features (X) used in this model are the price of the bottle of wine and latent features obtained from the performing Latent Semantic Analysis (LSA) on the unstructured text data from the descriptions.", "The latent text features are engineered using the following steps:", "The Gradient Boosting Regression Tree model is fit using xgboost in python and evaluated using Mean Absolute Error (MAE)", "In general, Gradient Boosting Machines are a collection of weak learners ensemble into one model to create a strong learner. Gradient Boosting Machines can be used for both Regression or Classification tasks. They are typically applied to tree-based models but could, in theory, be applied to any type of weak learner.", "The training data is used to fit each weak learner. Boosting and Bagging can both be used to ensemble these weak learners to one model. Bagging builds all the weak learners in parallel. Boosting takes a more systematic approach, and builds the weak learners sequentially with each weak learner attempting to better explain the patterns missed by the last weak learner by applying weights to the observations that the previous weak learner incorrectly predicted.", "In stochastic gradient boosting, a sample of the training data is used to fit each weak learner.", "AdaBoosting is the simplest effective boosting algorithm for binary classification. It sequentially fits decision trees with one split. These little weak learner trees are called \u201cdecision stumps\u201d. Each observation in the training observation receives a weight based on the classification error, and the next decision stump is trained using the updated weights on the training data. Each stump is also assigned a weight based on the classifiers total misclassification rate. The model then ensembles the predictions using the weights on each stump. Stumps with a high number of misclassifications receive lower weights, causing their predictions to contribute less in the ensembled prediction.", "Gradient boosting sequentially fits weak learners to the gradient (derivative) of a loss function in an attempt to explain the patterns missed by the previous weak learner. An additive model is used to ensemble the weak learners as each one is fit. The output of the new weak learned is added to the output of the previous weak learner to adjust the predictions. This results in a recursive equation where each weak learner attempts to explains a pattern not picked up by the previous ones.", "The first weak learner is initialized as a constant, such as the mean.", "Then, a function h(x) is fit to the residuals. The residuals are the gradient of the loss function.", "Where h(x) is a weak learner fit to the gradient of a loss function. Gamma represents the learning rate, or step size.", "The resulting model has many terms for each feature, each nudging the prediction it in a different direction.", "Because the weak learners are fit to predict the gradient of the loss function, any differentiable loss function used can be selected, thus allowing this method to be applied to both classification and regression problems.", "First, start by importing the required python libraries.", "Now, load in the wine data and view a sample of it.", "Preprocess the text descriptions by removing punctuation, digits, and converting to all characters to lower case.", "Now that the descriptions are cleaned, TF-IDF is used to vectorize the words, and SVD is used to compress that matrix into 5 latent vectors. This method of feature compression from text data is called Latent Semantic Analysis. 5 latent features are chosen for simplicity, but in practice, an elbow plot could be used to select the right number of latent features.", "Perform a test/train split, format data for xgboost, and train the model!", "Make predictions on the test data and evaluate the model using Mean Absolute Error. On average, the predicted quality points are off by 1.84 points. Not bad!", "Use the feature importance plot from xgboost to see the features that influence the model the most. It looks like price is the most important feature when predicting the quality of a wine.", "In this notebook, I used SageMaker\u2019s estimator to train the model and host it as a live endpoint. The estimator spins up a training instance and uses the code in the train_wine_gbt.pyscript to train the model, save the model to s3, and define the endpoint\u2019s input and output. It is possible to use SageMaker\u2019s many built-in models for training and deploying, but I wanted to specify my own feature transformations and output for the live predictions, which can be done using a python script like train_wine_gbt.py.", "Now that the model is trained and deployed, I can use it to predict the quality of any bottle of wine! Using the text description and price of \u201csummer water\u201d from the Winc website, the model predicts this wine as an 87, which is categorized as \u201cvery good\u201d!", "If you\u2019d like to reuse any of this code, check out the GitHub repo for the project here, where I have jupyter notebooks for both training and deployment.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Full Stack Data Scientist/Machine Learning Engineer, Recommender Systems Specialist, ML Platform Builder, Central ML Team Advocate, bad Poker Player (try me)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd950b1542065&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d950b1542065--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d950b1542065--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://statistician-in-stilettos.medium.com/?source=post_page-----d950b1542065--------------------------------", "anchor_text": ""}, {"url": "https://statistician-in-stilettos.medium.com/?source=post_page-----d950b1542065--------------------------------", "anchor_text": "Claire Longo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f6936fe85bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&user=Claire+Longo&userId=1f6936fe85bb&source=post_page-1f6936fe85bb----d950b1542065---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd950b1542065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd950b1542065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@vincenzolandino?utm_source=medium&utm_medium=referral", "anchor_text": "Vincenzo Landino"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/zynicide/wine-reviews", "anchor_text": "Kaggle"}, {"url": "https://github.com/statisticianinstilettos/wine_quality_predictions/blob/master/deploy_wine_model.ipynb", "anchor_text": "this notebook"}, {"url": "https://github.com/statisticianinstilettos/wine_quality_predictions/blob/master/train_wine_gbt.py", "anchor_text": "train_wine_gbt.py"}, {"url": "https://github.com/statisticianinstilettos/wine_quality_predictions", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d950b1542065---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/gradient-boosting?source=post_page-----d950b1542065---------------gradient_boosting-----------------", "anchor_text": "Gradient Boosting"}, {"url": "https://medium.com/tag/sagemaker?source=post_page-----d950b1542065---------------sagemaker-----------------", "anchor_text": "Sagemaker"}, {"url": "https://medium.com/tag/wine?source=post_page-----d950b1542065---------------wine-----------------", "anchor_text": "Wine"}, {"url": "https://medium.com/tag/xgboost?source=post_page-----d950b1542065---------------xgboost-----------------", "anchor_text": "Xgboost"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd950b1542065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&user=Claire+Longo&userId=1f6936fe85bb&source=-----d950b1542065---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd950b1542065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&user=Claire+Longo&userId=1f6936fe85bb&source=-----d950b1542065---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd950b1542065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d950b1542065--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd950b1542065&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d950b1542065---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d950b1542065--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d950b1542065--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d950b1542065--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d950b1542065--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d950b1542065--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d950b1542065--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d950b1542065--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d950b1542065--------------------------------", "anchor_text": ""}, {"url": "https://statistician-in-stilettos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://statistician-in-stilettos.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Claire Longo"}, {"url": "https://statistician-in-stilettos.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "573 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1f6936fe85bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&user=Claire+Longo&userId=1f6936fe85bb&source=post_page-1f6936fe85bb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1c44c11e7941&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-wine-quality-with-gradient-boosting-machines-a-gmb-tutorial-d950b1542065&newsletterV3=1f6936fe85bb&newsletterV3Id=1c44c11e7941&user=Claire+Longo&userId=1f6936fe85bb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}