{"url": "https://towardsdatascience.com/how-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5", "time": 1683007515.245558, "path": "towardsdatascience.com/how-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5/", "webpage": {"metadata": {"title": "How I Used Machine Learning and Smartwatches to Track Weightlifting Activity | by Eijaz Allibhai | Towards Data Science", "h1": "How I Used Machine Learning and Smartwatches to Track Weightlifting Activity", "description": "TL;DR: Scroll to the bottom section (Results) to see the project results and accuracy of the machine learning models. I recently completed a machine learning project where I was able to track bicep\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "F1 score", "paragraph_index": 13}], "all_paragraphs": ["TL;DR: Scroll to the bottom section (Results) to see the project results and accuracy of the machine learning models.", "I recently completed a machine learning project where I was able to track bicep curl form of a user. If the bicep curl form was correct, the model would indicate correct form. If the bicep curl form was incorrect, for example, if the user swung their elbow too much, the model would indicate that the form was incorrect and state why it was incorrect.", "Note: \u201cForm\u201d refers to the movement performed during one repetition of a bicep curl. Having correct form when weightlifting is important in order to prevent injury and target the correct muscles.", "The goal of this project was to develop proof of concept that I could build a machine learning model with sensor data from smartwatches to track subtle differences in movements during certain weightlifting exercises. In the future, I may expand on this project in order to develop a full fledged app.", "I have strong interests in data science and fitness, and am always looking for ways to combine the two topics. I noticed there was an increasing capability for wearables to track cardio exercise, but not so much for weightlifting. That\u2019s when I came up with the idea to use wearables to track weightlifting form. Looking back, I would say it is important that you choose a topic that genuinely interests you, because when you run into hiccups and setbacks (and you will), it will give you motivation to get past those moments.", "Prior to this project, I didn\u2019t have any experience working with sensor data, so I had to conduct a lot of research. In recent years, there have been many papers covering Human Activity Recognition (HAR), where researchers mainly looked at using sensor data from body sensors or smartphones to identify when users are conducting various activities such as standing, sitting, running, walking, and climbing stairs. The most common sensors used in these papers were an accelerometer and a gyroscope.", "I looked at type of data used, the processes used to collect data, and how models were built and tested. I also took note of some of the main differences between these HAR papers and my research. These differences included more subtle differences in weightlifting form compared to the activities identified in the HAR papers, and my research was only going to use a wrist sensor instead of a waist sensor or multiple sensors attached throughout the body.", "Based on my research, the models I ended up choosing to test for this project were a a Long Short Term Memory Network (LSTM), a 1-D Convolutional Neural Network (CNN), and a CNN-LSTM, which is a combination of the two previous models. An LSTM is a type of Recurrent Neural Network (RNN). RNNs are popular when dealing with sequence data, such as sensor data. An LSTM is a type of RNN that is good at retaining information throughout the whole sequence of data. A 1D-CNN can extract features from the raw sensor data, similar to how the more popular 2D-CNN is used when classifying image data. A CNN-LSTM uses the features extracted by the CNN and feeds that into the LSTM.", "To collect data, I designed an experiment by using participants to perform 3 variations of a bicep curl: one correct curl and two different types of incorrect curls. The incorrect curls were curls with the user\u2019s elbow swinging too much and a curls where the user does not go through a full range of motion for the exercise. I collected the data by attaching a smartphone to the participants wrist and asking them to complete 250 repetitions of each of the 3 variations of curls (with breaks in between and them being monitored so the data would not be faulty). I used the Androsensor Android app to collect the accelerometer and gyroscope sensor data. The data was collected at a rate of 100Hz and I used a time period of 2 seconds for each bicep curl sequence, which means that there were 200 data points in each sequence of data. It is important to retain information from the beginning of the curl as the network makes its way throughout the sequence of data.", "The data cleaning and data wrangling was done using Python, Numpy, and Pandas. A window of 2 seconds was used for each curl, with a sliding window of 0.5 seconds to create more data points. In order to create even more data points, I used starting points at 0.1, 0.2, 0.3, and 0.4 seconds into a curl to create more 2 second windows.", "The models were tested using a leave-one-out test. This test was used rather than a randomized split because the model should work on someone if it has never seen their data before. For example, in a group of 3 people, if the model was trained on person 1 and person 2\u2019s data, the model should be accurate on person 3\u2019s data without having been trained on it before.", "The glossary for the below model architecture table is at the end of this post.", "All three models were trained and tested using various adjustments in parameters for each model. The model architectures can be seen in the table above. The training and testing were done using the Tensorflow and Keras machine learning libraries and on Google Colab. Google Colab was chosen because it has free uninterrupted GPU access for up to 12 hours at a time. The results of each of the models can be seen in the table below. The best performing model architecture for each model is in bold.", "Below you can see the final results for the best performing architectures for each model using accuracy and F1 score as measures. The final scores were averages of using each of the 3 participants as the test set for each model. Model size was also important to track for this project because mobile and wearable devices only have a limited amount of resources and processing power. Therefore, the smaller the model size, the better it is to use on mobile devices (best practice is usually having the data sent from a wearable to the mobile device and the mobile device does all the processing because it has more processing power than a wearable device).", "Conv1D(filters, kernel size) \u2014 1-Dimensional Convolutional layer; filters refers to the dimensionality of the output space; kernel size refers to the length of the convolution window.", "LSTM(units) \u2014 LSTM layer; units refers to the dimensionality of the output space.", "Dropout(dropout value) \u2014 Dropout layer; dropout value refers to the percentage of units to randomly remove in the specified layer.", "MP(window size) \u2014 Max Pooling layer; window size refers to the size of the max pooling window.", "Flatten \u2014 Flattens the input to one dimension.", "FC(units) \u2014 Fully connected layer, also known as a dense layer; units refers to the dimensionality of the output space.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa45d24bf12e5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@eijaz?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eijaz?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": "Eijaz Allibhai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd86e20f6e783&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&user=Eijaz+Allibhai&userId=d86e20f6e783&source=post_page-d86e20f6e783----a45d24bf12e5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://unsplash.com/@timberfoster", "anchor_text": "Tim Foster"}, {"url": "https://unsplash.com/", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "F1 score"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a45d24bf12e5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/fitness?source=post_page-----a45d24bf12e5---------------fitness-----------------", "anchor_text": "Fitness"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a45d24bf12e5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a45d24bf12e5---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----a45d24bf12e5---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa45d24bf12e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&user=Eijaz+Allibhai&userId=d86e20f6e783&source=-----a45d24bf12e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa45d24bf12e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&user=Eijaz+Allibhai&userId=d86e20f6e783&source=-----a45d24bf12e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa45d24bf12e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a45d24bf12e5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a45d24bf12e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eijaz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@eijaz?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Eijaz Allibhai"}, {"url": "https://medium.com/@eijaz/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.7K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd86e20f6e783&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&user=Eijaz+Allibhai&userId=d86e20f6e783&source=post_page-d86e20f6e783--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2a3e615bb649&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-i-used-machine-learning-and-smartwatches-to-track-weightlifting-activity-a45d24bf12e5&newsletterV3=d86e20f6e783&newsletterV3Id=2a3e615bb649&user=Eijaz+Allibhai&userId=d86e20f6e783&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}