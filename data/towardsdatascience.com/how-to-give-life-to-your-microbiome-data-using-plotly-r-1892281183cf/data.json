{"url": "https://towardsdatascience.com/how-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf", "time": 1683011380.681393, "path": "towardsdatascience.com/how-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf/", "webpage": {"metadata": {"title": "How to give life to your microbiome data. | by Ruth Schmidt | Towards Data Science", "h1": "How to give life to your microbiome data.", "description": "I am a microbial ecologist, which means I study how microbes interact with each other and their environment. Recently, I jumped into the world of data science thanks to a fellowship I got from Mitacs\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.mitacs.ca/en", "anchor_text": "Mitacs", "paragraph_index": 0}, {"url": "https://plotly.com/", "anchor_text": "Plotly", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/DNA_sequencing", "anchor_text": "DNA sequencing", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Sequence_assembly", "anchor_text": "assembled", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/DNA_annotation#:~:text=DNA%20annotation%20or%20genome%20annotation,way%20of%20explanation%20or%20commentary.", "anchor_text": "annotated", "paragraph_index": 3}, {"url": "https://joey711.github.io/phyloseq/", "anchor_text": "phyloseq", "paragraph_index": 4}, {"url": "http://userweb.eng.gla.ac.uk/umer.ijaz/projects/microbiomeSeq_Tutorial.html", "anchor_text": "microbiomeSeq", "paragraph_index": 4}, {"url": "https://microbiome.github.io/tutorials/", "anchor_text": "microbiome", "paragraph_index": 4}, {"url": "https://cran.r-project.org/web/packages/picante/picante.pdf", "anchor_text": "picante", "paragraph_index": 4}, {"url": "https://www.frontiersin.org/articles/10.3389/fmicb.2019.02407/full", "anchor_text": "paper", "paragraph_index": 6}, {"url": "https://www.data-to-viz.com/graph/violin.html", "anchor_text": "violin plots", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Kernel_density_estimation", "anchor_text": "kernel density plot", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Taxonomic_rank", "anchor_text": "taxonomic rank", "paragraph_index": 8}, {"url": "https://www.data-to-viz.com/caveat/order_data.html", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://www.nature.com/articles/s41467-020-16224-6", "anchor_text": "quivalent decrease across the remaining taxa", "paragraph_index": 11}, {"url": "https://www.nature.com/articles/s41592-019-0527-3?proof=true&draft=collection%3Fproof%3Dtrue", "anchor_text": "commentary", "paragraph_index": 12}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6586903/", "anchor_text": "paper", "paragraph_index": 12}], "all_paragraphs": ["I am a microbial ecologist, which means I study how microbes interact with each other and their environment. Recently, I jumped into the world of data science thanks to a fellowship I got from Mitacs to work with the data analytics & visualization company Plotly. Plotly is all about building interactive data science web apps, and in this post, I would like to share some background on how to use Plotly\u2019s R graphing library for interactive visualization of microbiome data using some data from my research. You can replicate all figures with the code and links provided. You can even go to the editor yourself by clicking on the \u201cedit chart\u201d button and play around with it or suggest improvements!", "Before jumping directly into the visualization part, let me first give you an overview of what kind of data we\u2019re dealing with. If you\u2019re already familiar with microbiome data you can skip this next section.", "What are amplicon or shotgun data?", "They\u2019re essentially data obtained by DNA sequencing approaches that identify information about either pieces of DNA or whole genomes. These sequences are assembled and annotated using bioinformatic tools to extract biological information about the identity of microbes or gene abundances in a given environment. The output of such analysis is what is called OTU (for Operational Taxonomic Unit) tables or gene abundance tables.", "This table alongside information on taxonomy and metadata can then be used for statistical analysis and visualization. My programming language of choice is R because of the many packages (e.g. phyloseq, microbiomeSeq, microbiome, picante) that have already been developed for microbiome analysis and because of the statistical nature of the language.", "Let\u2019s talk about interactive data visualization (and some statistics)!", "As a first overview to assess differences in samples or environments one typically looks at the alpha diversity. Alpha diversity describes the diversity within a particular sample or environment (for more info on the statistics of alpha diversity have a look at Amy D. Willis paper). The diversity indices can be easily plotted using a box plot with the following code and explored interactively by hovering over the plot or by clicking on the legend to isolate traces (see the tools on the upper right for an explanation of the features).", "An alternative to bar charts is so-called violin plots, which are an extension of box plots with the addition of a kernel density plot that shows the distribution shape of the data. The wider the violin the more data points are in that range; the smaller the fewer data points. The following code produces a split violin plot that has the advantage of comparing multiple groups directly (here plant-soil compartments). Additional subplots can be added by filtering for other diversity indices and by following the code above for combining plots.", "As a next step, we can explore the taxonomy that gives information on what kind of microbes are there based on the taxonomic rank selected. Typically, the ranks of Phylum (for a broader overview) and Genus (for a more in-depth overview) are chosen. Tip: It helps to sort the data by their mean abundance from the most abundant to the least abundant taxa for easier interpretation (read more about why ordering data is important for a clear interpretation here).", "I like to use bubble charts as an alternative to stacked bar charts in which the size of the bubbles represent taxa abundances. I will illustrate this here with shotgun metagenomics data using the following code.", "A side note on relative abundance", "There is an ongoing debate about the disadvantage of interpreting data based on their relative abundance; for a good reason as every increase in one taxon\u2019s abundance causes an equivalent decrease across the remaining taxa. As James Morton from the Knight group at the University of California, San Diego, says:", "\u201cTo know if organisms A and B are present at 80% and 20% is one thing, but whether these numbers come from 100 or 100 million cells makes a huge difference for the host.\u201d (for more check out the commentary by Lei Tang and the paper behind the statement).", "This is to say that relative abundance data should be interpreted with care and one has to be cautious in inferring accurate taxonomic shifts from these data.", "Let\u2019s continue to the next step of a typical microbiome analysis by looking at the beta diversity. Beta diversity measures changes in species diversity from one environment or sample to another. This is typically shown in form of a scatter plot or PCoA/NMDS plot (Principal Coordinates Analysis/Non-metric Multidimensional Scaling) in which samples are separated based on their similarity or dissimilarity and arranged in a low-dimensional 2D or 3D space. Different indices can be used to calculate a dissimilarity matrix. For more on this have a look at the distance {phyloseq} pr designdist {vegan} documentation in R.", "This is it for now. I hope you found this tutorial useful and that it will help you with your own data analysis and visualization. Stay tuned for more tutorials on how to visualize omics data using Plotly\u2019s R graphing library, Dash for R, and Dash Bio!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Microbial Ecologist. Passionate about all things AI."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1892281183cf&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1892281183cf--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1892281183cf--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ruthlys?source=post_page-----1892281183cf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruthlys?source=post_page-----1892281183cf--------------------------------", "anchor_text": "Ruth Schmidt"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5678609fa64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&user=Ruth+Schmidt&userId=c5678609fa64&source=post_page-c5678609fa64----1892281183cf---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1892281183cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1892281183cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://www.sonjabaeumel.at/works/bacteria/fifty-percent-human/", "anchor_text": "50 percent human"}, {"url": "https://www.mitacs.ca/en", "anchor_text": "Mitacs"}, {"url": "https://plotly.com/", "anchor_text": "Plotly"}, {"url": "https://en.wikipedia.org/wiki/DNA_sequencing", "anchor_text": "DNA sequencing"}, {"url": "https://en.wikipedia.org/wiki/Sequence_assembly", "anchor_text": "assembled"}, {"url": "https://en.wikipedia.org/wiki/DNA_annotation#:~:text=DNA%20annotation%20or%20genome%20annotation,way%20of%20explanation%20or%20commentary.", "anchor_text": "annotated"}, {"url": "https://joey711.github.io/phyloseq/", "anchor_text": "phyloseq"}, {"url": "http://userweb.eng.gla.ac.uk/umer.ijaz/projects/microbiomeSeq_Tutorial.html", "anchor_text": "microbiomeSeq"}, {"url": "https://microbiome.github.io/tutorials/", "anchor_text": "microbiome"}, {"url": "https://cran.r-project.org/web/packages/picante/picante.pdf", "anchor_text": "picante"}, {"url": "https://www.frontiersin.org/articles/10.3389/fmicb.2019.02407/full", "anchor_text": "paper"}, {"url": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/alphadf.csv", "anchor_text": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/alphadf.csv"}, {"url": "https://plotly.com/chart-studio/", "anchor_text": "chart studio"}, {"url": "https://www.data-to-viz.com/graph/violin.html", "anchor_text": "violin plots"}, {"url": "https://en.wikipedia.org/wiki/Kernel_density_estimation", "anchor_text": "kernel density plot"}, {"url": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/alphadf.csv", "anchor_text": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/alphadf.csv"}, {"url": "https://en.wikipedia.org/wiki/Taxonomic_rank", "anchor_text": "taxonomic rank"}, {"url": "https://www.data-to-viz.com/caveat/order_data.html", "anchor_text": "here"}, {"url": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/psbac.df.csv", "anchor_text": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/psbac.df.csv"}, {"url": "https://plotly.com/r/text-and-annotations/", "anchor_text": "link"}, {"url": "https://www.rdocumentation.org/packages/phyloseq/versions/1.16.2/topics/psmelt", "anchor_text": "psmelt"}, {"url": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/meta_relative.csv", "anchor_text": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/meta_relative.csv"}, {"url": "https://www.nature.com/articles/s41467-020-16224-6", "anchor_text": "quivalent decrease across the remaining taxa"}, {"url": "https://www.nature.com/articles/s41592-019-0527-3?proof=true&draft=collection%3Fproof%3Dtrue", "anchor_text": "commentary"}, {"url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6586903/", "anchor_text": "paper"}, {"url": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/pca_16S.csv", "anchor_text": "https://raw.githubusercontent.com/ruthlys/files_plotlyr/master/pca_16S.csv"}, {"url": "https://medium.com/tag/microbiome?source=post_page-----1892281183cf---------------microbiome-----------------", "anchor_text": "Microbiome"}, {"url": "https://medium.com/tag/plotly?source=post_page-----1892281183cf---------------plotly-----------------", "anchor_text": "Plotly"}, {"url": "https://medium.com/tag/r?source=post_page-----1892281183cf---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----1892281183cf---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----1892281183cf---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1892281183cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&user=Ruth+Schmidt&userId=c5678609fa64&source=-----1892281183cf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1892281183cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&user=Ruth+Schmidt&userId=c5678609fa64&source=-----1892281183cf---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1892281183cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1892281183cf--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1892281183cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1892281183cf---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1892281183cf--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1892281183cf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1892281183cf--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1892281183cf--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1892281183cf--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1892281183cf--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1892281183cf--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1892281183cf--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruthlys?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruthlys?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ruth Schmidt"}, {"url": "https://medium.com/@ruthlys/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "32 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc5678609fa64&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&user=Ruth+Schmidt&userId=c5678609fa64&source=post_page-c5678609fa64--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F620b5ae4badc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-give-life-to-your-microbiome-data-using-plotly-r-1892281183cf&newsletterV3=c5678609fa64&newsletterV3Id=620b5ae4badc&user=Ruth+Schmidt&userId=c5678609fa64&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}