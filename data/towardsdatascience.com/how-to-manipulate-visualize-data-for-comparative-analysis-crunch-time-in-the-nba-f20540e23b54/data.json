{"url": "https://towardsdatascience.com/how-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54", "time": 1683003861.749023, "path": "towardsdatascience.com/how-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54/", "webpage": {"metadata": {"title": "How to manipulate & visualize data for comparative analysis\u2014Crunch time in the NBA | by JP Hwang | Towards Data Science", "h1": "How to manipulate & visualize data for comparative analysis\u2014Crunch time in the NBA", "description": "In this article, I demonstrate how to manipulate and visualise data for comparative insights. I begin the analysis with one dataset, which will be analysed to find an appropriate split and to find\u2026"}, "outgoing_paragraph_urls": [{"url": "https://twitter.com/BillSimmons", "anchor_text": "Bill Simmons", "paragraph_index": 1}, {"url": "https://gitlab.com/jphwang/online_articles", "anchor_text": "GitLab repo here", "paragraph_index": 4}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.assign.html", "anchor_text": "returns an entirely new object", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/how-to-visualize-hidden-relationships-in-data-with-python-analysing-nba-assists-e480de59db50", "anchor_text": "earlier article", "paragraph_index": 16}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html", "anchor_text": "here is the documentation", "paragraph_index": 22}, {"url": "https://fansided.com/2014/11/01/geometry-distance-corner-3s/", "anchor_text": "Modern analytics dictate that the best shots are from close to the rim and corner 3s", "paragraph_index": 35}, {"url": "https://twitter.com/_jphwang", "anchor_text": "twitter", "paragraph_index": 59}], "all_paragraphs": ["In this article, I demonstrate how to manipulate and visualise data for comparative insights. I begin the analysis with one dataset, which will be analysed to find an appropriate split and to find the best subset to be compared with the remaining data.", "Practically, this article looks at last season\u2019s NBA data to learn about close, late game situations. Some like The Ringer\u2019s Bill Simmons call it \u2018crunch time\u2019.", "We will use data to find out more about these high-stakes moments. When really is crunch time? Is the game played differently during this period? What kind of strategies are adopted here?", "As per usual, the focus of the article is going to be in the data analysis which will be applicable to your own domain and data, rather than the basketball-specific outputs.", "I included the data and code for this in my GitLab repo here (in the basketball_crunchtime directory), so please feel free to download it and play with it / improve upon it.", "I assume you\u2019re familiar with python. Even if you\u2019re relatively new, this tutorial shouldn\u2019t be too tricky, though.", "You\u2019ll need pandas and plotly. Install each (in your virtual environment) with a simple pip install [PACKAGE_NAME].", "The hypothesis here is pretty simple. In basketball, some situations are treated differently than others, receiving higher effort and attention from players and coaches. Let\u2019s call this \u2018crunch time\u2019, and see if the data shows up any differences and patterns between it and the rest of the game.", "Our dataset includes play-by-play data from the 2018\u201319 season. As you might imagine, there is no \u2018crunch time\u2019 feature in the data that I can filter for. But based on our intuition, it seems reasonable that crunch time data would relate to periods with limited remaining time and small score differences.", "First, we will explore the data and see what might be some reasonable criteria at which a crunch time subset could be selected.", "The existing dataset does not include features for remaining time nor score difference, but it does include the underlying data for these features.", "There are multiple ways to create new columns in Pandas, but I prefer to use the .assign method, as it returns an entirely new object. This can help avoid headaches of potentially manipulating the wrong object.", "The dataset features includes period, out of 4, and the elapsed time in each period (out of 12 minutes). The period data is in integers, and the elapsed time are in strings, so we would like to convert them to consistent time units.", "Pandas has a timedelta function that can handily convert strings to time, and timedelta64 function numpy can convert the period to seconds, so summing them puts us at the total game time elapsed.", "Let\u2019s also create a new column for the current score difference:", "These new columns can now be used to filter our dataset. We will use them to generate a few potential crunch time subsets for comparison.", "As a first point, I would like to see if the distribution of shots change. In an earlier article, we divided up the court into various zones, like so:", "Each shot is encoded with a feature that records which of these 7 zones it came from.", "Changes to shot locations could be just as meaningful as any changes to accuracy. It might be more so, actually, as the data might be less \u2018noisy\u2019 than shot accuracy.", "So, let\u2019s also capture whether the distribution of shots from these zones have changed, adding statistics such as shot accuracy/frequency from each zone to our dataframe.", "To evaluate the effects of various time and score thresholds, I built a nested loop with various time and score thresholds, and used pandas to filter the dataframe based on these values within the loop:", "Each statistic is also captured as a relative value in comparison to the overall data, as we look to capture changes to the game during crunch time.", "If you are not sure how to use .groupby methods with dataframes, here is the documentation.", "This gives us a workable dataframe for comparisons, and we are ready to start looking at our datasets.", "Whenever I am dealing with a subset of data, I want to be wary of introducing random errors, or unintended biases, which might lead me to erroneous conclusions.", "Here, let\u2019s quickly take a look at the distribution to understand how much of each game is spent at each range of score differences.", "Our database contains approximately 217,000 shots from the entire NBA season. Roughly, each minute contains 4500 shots. Plotting these into a histogram:", "And similarly for the last 6 minutes:", "Even in the last 6 minutes, about 4.5% of NBA games are played at a score within 1 point, and about 10% within 3.", "At a base of over 215,000 shots, getting these subsets seem reasonable, but it is something to keep an eye on, especially as subsets are derived based on time and on scores.", "We had two variables of interest, remaining game time (time_thresh) and score difference (score_thresh). We also have the variable of shot area (zone_name). With three variables to consider, it is perfect for a bubble chart, with one variable along the x-axis, another as colours and the third for subplots.", "With this code, we create one such bubble chart:", "And the subplot / colour series can be flipped like so, to produce:", "These plots already tell us a significant amount.", "They tell us that in late-game situations, far more three point shots are taken than the rest of the game. This increases as the score gap increases (i.e. as teams take more risks to catch up).", "Modern analytics dictate that the best shots are from close to the rim and corner 3s, and here the data shows these shots become harder to come. Presumably, this is due to the defence puts in more effort, particularly very late in the game when it is close (look at the purple <2 point game data).", "A close look at the bottom plot also indicates an inflection point at around 8 or 6 minute mark in most subplots. This is most evident in the first subplot (within 4 feet) and the fifth (short 3s).", "Let\u2019s take a look at shot accuracies. Does it tell us a similar story?", "It seems to be the case! As the score margin increases, accuracy tends to increase in close-by shots, and decrease from far. This is likely to be due to the the leading team being wary of three pointers to prevent their opponents catching up quickly, and as the team behind heaves up more often from long range. This is backed up by frequency shown in the charts above.", "Overall, many of these subplots indicate that something has changed at around the 6 minute-to-go mark in the game. This seems like a good treshold.", "What about the score? While there is a progressive impact on the data as we look at data from increasingly larger score gaps, my observation is that the data points for situations where the score is within 2 stands out from the rest in most of these subplots. (Take a look for yourself, please do let me know if you disagree.)", "So let\u2019s adopt the definition of crunch time where the time remaining is 6 minutes or less, and score within 2 points.", "Now that we have set parameters for crunch time, we can create a new column to distinguish the two datasets.", "crunch_df contains 3886 shots, which is nothing to sneeze at. (But we probably would not want to get much smaller.)", "Let\u2019s compare the two datasets based on this property. This is now easily done by simply building data around the boolean values of crunchtime variable:", "While the game is close, the teams are not taking extreme strategies (such as taking a lot more three pointers). But clearly the desirable shots in zones 1, 4 and 5 are harder to come by. Perhaps we should look at relative percentages to the overall average:", "Clearly, defences\u2019 added efforts force teams to take more shots from inefficient spots (2, 3, 6 and 7) and less from good spots (1, 4 and 5). While this could just be noise in the data, the fact that decreases came from the zones known to be desirable shot areas lead me to doubt that.", "And looking at shot accuracies, the picture becomes even more interesting.", "Shot accuracies in the last 6 minutes of a game when close fall across the board, before crossing over at the three point line, to become more accurate for long distances. This is puzzling, however there are some potential explanations.", "One is selection bias, in the team\u2019s best players getting these shots at this time. Another is game-theory related, in that the defence is likely to somewhat encourage teams to take these, relatively low-percentage shots (under normal circumstances).", "Nonetheless, teams looking at this data would say that taking long threes might be a surprisingly high-value proposition.", "To wrap this up, let\u2019s take a look the data in more detail, using shot charts.", "Shots become less accurate almost everywhere inside the three-point line, and the corner 3s become markedly more difficult, presumably as the defence ratchets up pressure.", "Although we expect the data to be potentially a little noisy given that there are only 3886 shots, rather than over 210,000), the decrease across the board is reflected here.", "For this reason, I would not read too much into the directional differences (yet). Given the small sample size, differences to the left/right could just easily be noise rather than reflection of a trend.", "I personally find that even though it is relatively easy to find large datasets these days, they do not always contain features that allow me to easily slice data and make comparisons or draw conclusions from them.", "Instead, I am often having to create new features from the existing data, and use my intuition to evaluate where the appropriate cut-off point might be to create subsets of data.", "To this end, I hope the above example was useful and to you, and possibly also interesting.", "Please download the data and code, and have a play with it, and build something similar with your own dataset. I would love to hear about your experiences or comments!", "If you liked this, say \ud83d\udc4b / follow on twitter, or follow for updates. I also wrote these articles about basketball data, which might help with this article, if you haven\u2019t read them before.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech / Data science writer & educator; Python dev; sports analytics enthusiast. \ud83c\udde6\ud83c\uddfa \ud83d\udc26: @_jphwang"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff20540e23b54&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f20540e23b54--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f20540e23b54--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@_jphwang?source=post_page-----f20540e23b54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=post_page-----f20540e23b54--------------------------------", "anchor_text": "JP Hwang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F964fe0870229&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&user=JP+Hwang&userId=964fe0870229&source=post_page-964fe0870229----f20540e23b54---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20540e23b54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20540e23b54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://gitlab.com/jphwang/online_articles", "anchor_text": "GitLab repo"}, {"url": "https://unsplash.com/@jdent?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Jason Dent"}, {"url": "https://unsplash.com/s/photos/comparison?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://twitter.com/BillSimmons", "anchor_text": "Bill Simmons"}, {"url": "https://gitlab.com/jphwang/online_articles", "anchor_text": "GitLab repo here"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.assign.html", "anchor_text": "returns an entirely new object"}, {"url": "https://towardsdatascience.com/how-to-visualize-hidden-relationships-in-data-with-python-analysing-nba-assists-e480de59db50", "anchor_text": "earlier article"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html", "anchor_text": "here is the documentation"}, {"url": "https://fansided.com/2014/11/01/geometry-distance-corner-3s/", "anchor_text": "Modern analytics dictate that the best shots are from close to the rim and corner 3s"}, {"url": "https://twitter.com/_jphwang", "anchor_text": "twitter"}, {"url": "https://towardsdatascience.com/how-to-visualize-hidden-relationships-in-data-with-python-analysing-nba-assists-e480de59db50", "anchor_text": "How to visualize hidden relationships in data with Python \u2014 analysing NBA assistsManipulating & visualising data with interactive shot, bubble & Sankey charts for insights with Plotly (code & data\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/interactive-basketball-data-visualizations-with-plotly-8c6916aaa59e", "anchor_text": "Interactive basketball data visualizations with PlotlyAnalyze sports data with hexbin shot charts and bubble charts with Plotly and Plotly Express (source code & my own data\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/programming?source=post_page-----f20540e23b54---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f20540e23b54---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/nba?source=post_page-----f20540e23b54---------------nba-----------------", "anchor_text": "NBA"}, {"url": "https://medium.com/tag/python?source=post_page-----f20540e23b54---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----f20540e23b54---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff20540e23b54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&user=JP+Hwang&userId=964fe0870229&source=-----f20540e23b54---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff20540e23b54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&user=JP+Hwang&userId=964fe0870229&source=-----f20540e23b54---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff20540e23b54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f20540e23b54--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff20540e23b54&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f20540e23b54---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f20540e23b54--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f20540e23b54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f20540e23b54--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f20540e23b54--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f20540e23b54--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f20540e23b54--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f20540e23b54--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f20540e23b54--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@_jphwang?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "JP Hwang"}, {"url": "https://medium.com/@_jphwang/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F964fe0870229&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&user=JP+Hwang&userId=964fe0870229&source=post_page-964fe0870229--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F743cf2a1623e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-manipulate-visualize-data-for-comparative-analysis-crunch-time-in-the-nba-f20540e23b54&newsletterV3=964fe0870229&newsletterV3Id=743cf2a1623e&user=JP+Hwang&userId=964fe0870229&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}