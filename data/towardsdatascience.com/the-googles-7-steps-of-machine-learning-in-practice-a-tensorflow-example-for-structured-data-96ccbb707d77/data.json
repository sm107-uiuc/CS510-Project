{"url": "https://towardsdatascience.com/the-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77", "time": 1683007479.045077, "path": "towardsdatascience.com/the-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77/", "webpage": {"metadata": {"title": "The Google\u2019s 7 steps of Machine Learning in practice: a TensorFlow example for structured data | by B. Chen | Towards Data Science", "h1": "The Google\u2019s 7 steps of Machine Learning in practice: a TensorFlow example for structured data", "description": "There are many great machine learning tutorials on the internet. However, most of them focus on a specific part of the machine learning, for example, exploring data, build a model, training, and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/the-7-steps-of-machine-learning-2877d7e5548e", "anchor_text": "The 7 steps of Machine Learning", "paragraph_index": 1}, {"url": "https://www.kaggle.com/c/titanic/overview", "anchor_text": "Titanic Dataset from Kaggle", "paragraph_index": 5}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/001-googles-7-steps-of-machine-learning-in-practice/001-googles-7-steps-of-machine-learning-in-practice.ipynb", "anchor_text": "The Google\u2019s 7 Steps of Machine Learning in Practice", "paragraph_index": 12}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github Repo", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "anchor_text": "one-hot encoding", "paragraph_index": 24}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "three ways to implement neural network architecture in TensorFlow 2.0", "paragraph_index": 31}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/001-googles-7-steps-of-machine-learning-in-practice/001-googles-7-steps-of-machine-learning-in-practice.ipynb", "anchor_text": "notebook on my Github", "paragraph_index": 64}], "all_paragraphs": ["There are many great machine learning tutorials on the internet. However, most of them focus on a specific part of the machine learning, for example, exploring data, build a model, training, and evaluation. Very few of them introduce the complete steps for building a machine learning model.", "One of the most popular articles outlines the steps for approaching the process of machine learning is Yufeng Guo\u2019s The 7 steps of Machine Learning, introduced by Google Cloud Platform.", "Guo laid out the 7 steps as follows:", "In this article, we are going to put the above steps into practice and build a machine learning model from scratch.", "Before we getting into the details, the first thing we need to do for any Machine Learning project is to define the question for our machine learning model.", "For this tutorial, we will be working on the Titanic Dataset from Kaggle. This is a very famous dataset and very often is a student\u2019s first step in machine learning.", "Let\u2019s pretend that we\u2019ve been asked to create a system that predicts survival on the Titanic.", "In order to run this tutorial, you need to install", "TensorFlow 2, TensorBoard 2, numpy, pandas, matplotlib, seaborn", "They can all be installed directly via PyPI and I strongly recommend creating a new Virtual Environment. It is a best practice to avoid using base(root) as it might break your system.", "You can check out the below articles for how to create Python Virtual Environment:", "All instructions are in this article, and I have made the notebook open source, please check out the following Github project for the source code", "The Google\u2019s 7 Steps of Machine Learning in Practice, is free for access in Github. More tutorials are available from Github Repo.", "Once we have our question defined, it\u2019s time for our first real step of machine learning: gathering data. This step is the most important because the quality and quantity of data that you gather will directly determine how good your predictive model can be.", "In this tutorial, the data will be from Kaggle. Let\u2019s import some libraries and load data to get started", "Let\u2019s load train.csv and test.csv files into pandas DataFrame.", "Let\u2019s begin with some exploratory data analysis (EDA). We\u2019ll start by checking out missing values.", "We can use seaborn to create a simple heatmap to see where are missing values", "Age, Cabin, and Embarked have missing values. The proportion of Age missing is likely small enough for reasonable replacement with some form of imputation. Looking at the Cabin column, it looks like too many missing values of that data to do something useful. We\u2019ll probably drop Cabin later, or change it to another feature like \u201cCabin Known: 1 or 0\u201d. The proportion of Embarked missing is very small, let\u2019s keep it for this tutorial.", "Let\u2019s continue on by visualizing some more of the data", "We would like to replace the missing Age with some form of imputation. One way to do this is by filling in the mean age of all the passengers. However, we can be smarter about this and check the average age by passenger class. For example:", "We can see the wealthier passengers in the higher classes tend to be older, which makes sense. We\u2019ll use these average age values to impute based on Pclass for Age.", "Now let\u2019s apply the function and check if it is working", "Great! impute_age() works. Let\u2019s go ahead and convert categorical features and drop the Cabin column.", "We\u2019ll need to convert categorical features to one-hot encoding. Otherwise, our machine learning algorithm won\u2019t be able to directly take in those features as inputs.", "Let\u2019s check column datatype with info()", "There are 5 columns with object datatype. Among them, Name, Ticket, and Cabin are not needed. In addition, we notice Pclass is a categorical data according to the Data Dictionary we have seen above. Let\u2019s make a function preprocessing() to keep these useful numerical features and convert the Pclass, Sex, and Embarked into one-hot encoding.", "Let\u2019s apply the function and create the training and test dataset for building our machine learning model.", "By running above, you should get the shape of the training and test dataset like below:", "And let\u2019s have a look the data by x_train.head()", "Great! our data is ready for model", "There are three ways to implement neural network architecture in TensorFlow 2.0:", "For simplicity, let\u2019s use the easiest way: Sequential Model with Sequential(). Let\u2019s go ahead and build a neural network with 3 dense layers. All parameters in each layer have been hardcoded as shown below:", "And below is the output of model.summary()", "Firstly, let\u2019s configure our model using model.compile()", "For training, there are three ways to train a Keras model:", "In this tutorial, let\u2019s go ahead with the easiest way model.fit() .", "If all runs smoothly, we should get an output like below.", "Once training is complete, it\u2019s time to see if the model is any good with Model Evaluation. The Model Evaluation typically involves", "Let\u2019s create a function plot_metric() for plotting metrics.", "By running plot_metric(history, 'loss') to plot the progress on loss.", "By running plot_metric(history, 'accuracy') to plot the progress on accuracy.", "To test our model against test dataset", "And we should get an output with loss and accuracy like below:", "Cool, we have done the evaluation for our first Machine Learning model. It is time to see if we can further improve that in any way. We can do this by turning our hyperparameters. There are a few parameters we implicitly assumed when we did our first training, and now is a good time to go back and test those assumptions and try other values.", "For this tutorial, let\u2019s just focus on the experiment with the following three hyperparameters in the model:", "Firstly, start by loading the TensorBoard notebook extension", "Then, add a statement to clear any logs from the previous run. It is going to mess up your dashboard if you don\u2019t clear them.", "List the values to try, and log an experiment configuration to TensorBoard.", "Our model is quite simple: 3 dense layers. The code will look familiar, although the hyperparameters are no longer hardcoded. Instead, the hyperparameters are provided in a hyparams dictionary and used throughout the training function:", "For each run, log a hparams summary with the hyperparameters and final accuracy", "We can now try multiple experiments, training each one with a different set of hypermeters. For simplicity, let\u2019s use a grid search that tries all combinations of the discrete parameters and just the lower and upper bounds of the real-valued parameter.", "If all runs smoothly, we should get an output like below:", "Once the run is complete, open your terminal and cd into the project directory. Then, the HParams dashboard can now be opened by running the following command in terminal", "Open the dashboard in browser and go straight to HPARAMS -> PARALLEL COORDINATES VIEW", "By looking at the PARALLEL COORDINATES VIEW, and clicking and dragging on the accuracy axis, you can select the runs with the highest accuracy.", "As these runs pass through different hyperparameters, we can conclude that", "performed the best among these experiments.", "Now, we have got the best Machine Learning model in terms of accuracy. The final step is to use this model to make predictions or inferences. This is the point of all this work, where the value of machine learning is realized. We can finally use our model to predict whether passengers are survival or not.", "Use the model to do prediction", "Use the model to generate class predictions for the input samples.", "Finally, we can save the whole model to a single HDF5 file:", "And to load a model saved via save()", "This article is a quick tutorial, mainly to show everyone how to put Google\u2019s 7 steps of Machine Learning in practice. I have tried to avoid many machine learning concepts and keep this tutorial as simple as possible.", "Please checkout the notebook on my Github for the source code.", "In a real-world application, they are a lot more to consider. For example, choose evaluation metrics, feature scaling, selecting meaningful features, splitting dataset, dealing with overfitting and underfitting, etc. In addition, this tutorial is for structured data only, and the real-world data are not always structured data, all the things like images, audio, or text are unstructured data.", "Next time, we will build a Keras Machine Learning model with three different ways Sequential, Functional, and Model subclassing.", "Stay tuned if are you are interested in the practical aspect of machine learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F96ccbb707d77&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bindichen.medium.com/?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": "B. Chen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a----96ccbb707d77---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96ccbb707d77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96ccbb707d77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/the-7-steps-of-machine-learning-2877d7e5548e", "anchor_text": "The 7 steps of Machine Learning"}, {"url": "https://www.youtube.com/watch?v=nKW8Ndu7Mjw", "anchor_text": "https://www.youtube.com/watch?v=nKW8Ndu7Mjw"}, {"url": "https://www.kaggle.com/c/titanic/overview", "anchor_text": "Titanic Dataset from Kaggle"}, {"url": "https://towardsdatascience.com/create-virtual-environment-using-virtualenv-and-add-it-to-jupyter-notebook-6e1bf4e03415", "anchor_text": "Create Virtual Environment using \u201cvirtualenv\u201d and add it to Jupyter NotebookAre you a Machine Learning Engineer and working with Python and Jupyter Notebook? In this article, you will see why\u2026towardsdatascience.com"}, {"url": "https://medium.com/analytics-vidhya/create-virtual-environment-using-conda-and-add-it-to-jupyter-notebook-d319a81dfd1", "anchor_text": "Create Virtual Environment using \u201cconda\u201d and add it to Jupyter NotebookAre you using anaconda and working with Jupyter Notebook and Python? In this article you will see how to create virtual\u2026medium.com"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/001-googles-7-steps-of-machine-learning-in-practice/001-googles-7-steps-of-machine-learning-in-practice.ipynb", "anchor_text": "The Google\u2019s 7 Steps of Machine Learning in Practice"}, {"url": "https://github.com/BindiChen/machine-learning", "anchor_text": "Github Repo"}, {"url": "https://www.kaggle.com/c/titanic/data?select=train.csv", "anchor_text": "Kaggle"}, {"url": "https://towardsdatascience.com/what-is-one-hot-encoding-and-how-to-use-pandas-get-dummies-function-922eb9bd4970", "anchor_text": "one-hot encoding"}, {"url": "https://towardsdatascience.com/3-ways-to-create-a-machine-learning-model-with-keras-and-tensorflow-2-0-de09323af4d3", "anchor_text": "three ways to implement neural network architecture in TensorFlow 2.0"}, {"url": "http://localhost:6006/", "anchor_text": "http://localhost:6006/"}, {"url": "https://github.com/BindiChen/machine-learning/blob/master/tensorflow2/001-googles-7-steps-of-machine-learning-in-practice/001-googles-7-steps-of-machine-learning-in-practice.ipynb", "anchor_text": "notebook on my Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----96ccbb707d77---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----96ccbb707d77---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/google?source=post_page-----96ccbb707d77---------------google-----------------", "anchor_text": "Google"}, {"url": "https://medium.com/tag/data-science?source=post_page-----96ccbb707d77---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/hyperparameter-tuning?source=post_page-----96ccbb707d77---------------hyperparameter_tuning-----------------", "anchor_text": "Hyperparameter Tuning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F96ccbb707d77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&user=B.+Chen&userId=563d09da62a&source=-----96ccbb707d77---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F96ccbb707d77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&user=B.+Chen&userId=563d09da62a&source=-----96ccbb707d77---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96ccbb707d77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F96ccbb707d77&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----96ccbb707d77---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----96ccbb707d77--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----96ccbb707d77--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----96ccbb707d77--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----96ccbb707d77--------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bindichen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "B. Chen"}, {"url": "https://bindichen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F563d09da62a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&user=B.+Chen&userId=563d09da62a&source=post_page-563d09da62a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F56a3bfbb80dc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-googles-7-steps-of-machine-learning-in-practice-a-tensorflow-example-for-structured-data-96ccbb707d77&newsletterV3=563d09da62a&newsletterV3Id=56a3bfbb80dc&user=B.+Chen&userId=563d09da62a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}