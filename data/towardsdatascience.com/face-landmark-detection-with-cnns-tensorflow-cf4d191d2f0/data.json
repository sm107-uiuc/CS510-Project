{"url": "https://towardsdatascience.com/face-landmark-detection-with-cnns-tensorflow-cf4d191d2f0", "time": 1683004578.725614, "path": "towardsdatascience.com/face-landmark-detection-with-cnns-tensorflow-cf4d191d2f0/", "webpage": {"metadata": {"title": "Face Landmark Detection With End-To-End Regression in TensorFlow | by Shubham Panchal | Towards Data Science", "h1": "Face Landmark Detection With End-To-End Regression in TensorFlow", "description": "Face Detection Systems have great uses in today\u2019s world which demands security, accessibility or joy! Today, we will be building a model that can plot 15 key points on a face. Face Landmark Detection\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/drgilermo/face-images-with-marked-landmark-points", "anchor_text": "Face Images with Marked Landmark Points", "paragraph_index": 5}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle", "paragraph_index": 5}, {"url": "https://www.kaggle.com/drgilermo", "anchor_text": "Omri Goldstein", "paragraph_index": 5}, {"url": "https://gist.github.com/shubham0204/7eb0435dc0142ce4fc560629111e0648", "anchor_text": "script", "paragraph_index": 7}, {"url": "https://github.com/shubham0204/Dataset_Archives", "anchor_text": "Dataset Archives", "paragraph_index": 7}, {"url": "https://susanqq.github.io/UTKFace/", "anchor_text": "UTKFace", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Mean_squared_error", "anchor_text": "Mean Squared Error", "paragraph_index": 11}, {"url": "https://towardsdatascience.com/batch-normalization-in-neural-networks-1ac91516821c", "anchor_text": "blog", "paragraph_index": 13}], "all_paragraphs": ["Face Detection Systems have great uses in today\u2019s world which demands security, accessibility or joy! Today, we will be building a model that can plot 15 key points on a face.", "Face Landmark Detection models form various features we see in social media apps. The face filters you find on Instagram are a common use case. The algorithm aligns the mask on the image keeping the face landmarks as base points.", "Let\u2019s develop a model with Keras ( TF backend )! First, we\u2019ll need some data to train our model.", "Please note! This blog teaches you to build a super simple face landmark detection model using Keras. For actual production models, this may not be useful.", "You can run the interactive Colab notebook in another tab to follow and understand each step.", "We are using the Face Images with Marked Landmark Points dataset on Kaggle by Omri Goldstein. The dataset contains around 7000 images ( 96 * 96 ) with face landmarks that can be found in the facial_keypoints.csv file.", "But here we have a problem. Most images do not have a complete set of 15 points. So we need only those images whose 15 facial keypoints are with us.", "Using this script, I have done a bit of cleaning and kept the modified data on my Dataset Archives GitHub repo. The Colab notebook downloads the ZIP archive using the wget command.", "We also normalize the images as well as the coordinates ( keypoints ). I have reshaped the outputs y_train and y_test as they going to be the expected outputs of a Conv2D layer and not a Dense layer.", "Pro-Tip: I found another dataset for face landmark detection called UTKFace. It contains 68 facial key points along with other features like age and gender. Give it try too!", "Let\u2019s discuss the structure of our model. Actually, I did some experiments with the model. We need a model that takes an image say of dimensions ( 96 , 96 ) and outputs an array of shape ( 30, ) ( 15 keypoints * 2 coordinates )", "We are using the Mean Squared Error as we are performing a regression task. A small learning rate is always good if you have a good amount of data.", "Why are we using Batch Normalization layers?", "Read this blog to know more.", "We train the model for around 250 epochs with a batch size of 50. After training, we\u2019ll generate some predictions on our testing dataset.", "Note: Keep in mind the orientation of the input images. The model trained on images that were rotated by 90 degrees could not generate correct predictions for an erect image.", "If you haven\u2019t made any modifications in the model or training parameters, the model after 250 epochs should look like this,", "Pretty impressive right? That\u2019s all! You have just built a face landmark detection model right from scratch. In the notebook, I have included a code cell with which you can take an image with your webcam and run the model on it.", "I have published after a long time ( Meanwhile I was busy writing on Math\u2026 ). Thanks for reading!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "\ud83d\ude07 Loves Android and ML, \ud83d\udca1 answering your thought-provoking questions in ML intuitively, \ud83d\udc68\u200d\ud83c\udf93 aspiring ML researcher"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcf4d191d2f0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://equipintelligence.medium.com/?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": "Shubham Panchal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd45a9465f044&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&user=Shubham+Panchal&userId=d45a9465f044&source=post_page-d45a9465f044----cf4d191d2f0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf4d191d2f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf4d191d2f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://equipintelligence.medium.com/list/deep-learning-techniques-methods-and-how-tos-01015cf5f917", "anchor_text": "Deep Learning"}, {"url": "https://unsplash.com/@priscilladupreez?utm_source=medium&utm_medium=referral", "anchor_text": "Priscilla Du Preez"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://colab.research.google.com/drive/11PoRdorcI5C8SFPEZbO2XNGPCTGIwDfP#scrollTo=IsWsGrm8BvgN&forceEdit=true&sandboxMode=true", "anchor_text": "Face_Landmark_Detectioncolab.research.google.com"}, {"url": "https://www.kaggle.com/drgilermo/face-images-with-marked-landmark-points", "anchor_text": "Face Images with Marked Landmark Points"}, {"url": "https://www.kaggle.com/", "anchor_text": "Kaggle"}, {"url": "https://www.kaggle.com/drgilermo", "anchor_text": "Omri Goldstein"}, {"url": "https://gist.github.com/shubham0204/7eb0435dc0142ce4fc560629111e0648", "anchor_text": "script"}, {"url": "https://github.com/shubham0204/Dataset_Archives", "anchor_text": "Dataset Archives"}, {"url": "https://susanqq.github.io/UTKFace/", "anchor_text": "UTKFace"}, {"url": "https://neurohive.io/en/popular-networks/vgg16/", "anchor_text": "VGG model"}, {"url": "https://en.wikipedia.org/wiki/Mean_squared_error", "anchor_text": "Mean Squared Error"}, {"url": "https://towardsdatascience.com/batch-normalization-in-neural-networks-1ac91516821c", "anchor_text": "blog"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----cf4d191d2f0---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cf4d191d2f0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----cf4d191d2f0---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----cf4d191d2f0---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/programming?source=post_page-----cf4d191d2f0---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf4d191d2f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&user=Shubham+Panchal&userId=d45a9465f044&source=-----cf4d191d2f0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcf4d191d2f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&user=Shubham+Panchal&userId=d45a9465f044&source=-----cf4d191d2f0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf4d191d2f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcf4d191d2f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cf4d191d2f0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cf4d191d2f0--------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://equipintelligence.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Shubham Panchal"}, {"url": "https://equipintelligence.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd45a9465f044&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&user=Shubham+Panchal&userId=d45a9465f044&source=post_page-d45a9465f044--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F55bcc27ba160&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fface-landmark-detection-with-cnns-tensorflow-cf4d191d2f0&newsletterV3=d45a9465f044&newsletterV3Id=55bcc27ba160&user=Shubham+Panchal&userId=d45a9465f044&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}