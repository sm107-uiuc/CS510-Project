{"url": "https://towardsdatascience.com/yolov4-ten-tactics-to-build-a-better-model-4c46869626a6", "time": 1683016392.07628, "path": "towardsdatascience.com/yolov4-ten-tactics-to-build-a-better-model-4c46869626a6/", "webpage": {"metadata": {"title": "YOLOv4 \u2014 Ten Tactics to Build a Better Model | by Jacob Solawetz | Towards Data Science", "h1": "YOLOv4 \u2014 Ten Tactics to Build a Better Model", "description": "The YOLO v4 model is currently one of the best architectures to use to train a custom object detector, and the capabilities of the Darknet repository are vast. In this post, we discuss and implement\u2026"}, "outgoing_paragraph_urls": [{"url": "https://blog.roboflow.com/training-yolov4-on-a-custom-dataset/", "anchor_text": "training YOLOv4", "paragraph_index": 1}, {"url": "https://blog.roboflow.com/tesla-stop-signs-computer-vision/", "anchor_text": "how Tesla teaches cars to stop", "paragraph_index": 2}, {"url": "https://blog.roboflow.com/yolov4-data-augmentation/", "anchor_text": "data augmentation in YOLO v4", "paragraph_index": 4}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "adding additional augmentation in Roboflow", "paragraph_index": 4}, {"url": "https://blog.roboflow.com/label-management-for-computer-vision/", "anchor_text": "class ontology", "paragraph_index": 5}, {"url": "https://blog.roboflow.com/when-to-use-grayscale-as-a-preprocessing-step/", "anchor_text": "grayscale", "paragraph_index": 5}, {"url": "https://blog.roboflow.com/when-to-use-contrast-as-a-preprocessing-step/", "anchor_text": "contrast", "paragraph_index": 5}, {"url": "https://blog.roboflow.com/coco-dataset/", "anchor_text": "the COCO dataset", "paragraph_index": 14}, {"url": "https://blog.roboflow.com/training-yolov4-on-a-custom-dataset/", "anchor_text": "YOLOv4", "paragraph_index": 17}, {"url": "https://blog.roboflow.com/train-yolov4-tiny-on-custom-data-lighting-fast-detection/", "anchor_text": "YOLOv4-tiny", "paragraph_index": 17}, {"url": "https://blog.roboflow.com/what-is-an-anchor-box/", "anchor_text": "custom anchor boxes", "paragraph_index": 19}, {"url": "https://blog.roboflow.com/train-test-split/", "anchor_text": "your validation set.", "paragraph_index": 23}, {"url": "https://blog.roboflow.com/mean-average-precision/", "anchor_text": "mean average precision", "paragraph_index": 25}, {"url": "https://github.com/CaoWGG/TensorRT-YOLOv4", "anchor_text": "YOLOv4 TensorRT framework", "paragraph_index": 27}], "all_paragraphs": ["The YOLO v4 model is currently one of the best architectures to use to train a custom object detector, and the capabilities of the Darknet repository are vast. In this post, we discuss and implement ten advanced tactics in YOLO v4 so you can build the best object detection model from your custom dataset.", "Note: this discussion assumes that you have already trained YOLO v4. To get started, check out our guide on training YOLOv4. The advanced tactics here will build from that basic training flow.", "The best way to improve an object detection model is to gather more representative data, and YOLO v4 does not escape from this fact. As Tesla\u2019s Senior Director of AI, Andrej Karpathy puts it when explaining how Tesla teaches cars to stop:", "\u201cYour dataset is alive, and your labeling instructions are changing all the time. You need to curate and change your dataset all the time.\u201d", "Gathering and labeling more data is costly. Luckily, there are some automatic ways to improve the scope and size of your training set through augmentation. The YOLO v4 training pipeline does augmentations automatically (see this article on data augmentation in YOLO v4) but you may want to consider adding additional augmentation in Roboflow.", "Image preprocessing is also another important step to make sure that your images are the correct image resolution size and you have standardized aspects such as class ontology, grayscale and contrast.", "The most important preprocessing decision to make is image input resolution.", "The input resolution determines the number of pixels that will be passed into the model to learn and predict from. A large pixel resolution improves accuracy, but trades off with slower training and inference time. Larger pixel resolution can help your model detect small objects.", "YOLO model pixel resolution must be a multiple of 32. A standard resolution size to choose is 416x416.", "If you are managing your dataset in Roboflow, you can select your dataset input resolution size with the resize preprocessing step.", "Important: To make sure your input resolution size flows through to your YOLOv4 model you must adjust the model configuration file. In the cfg folder where you specify your model configuration change width and height here.", "Change width and height in the YOLOv4 model cfg file", "To start training on YOLOv4, we typically download pretrained weights:", "And start from this pretrained checkpoint during training:", "These weights have been pretrained on the COCO dataset, which includes common objects like people, bikes, and cars. It is generally a good idea to start from pretrained weights, especially if you believe your objects are similar to the objects in COCO.", "However, if your task is significantly difficult than COCO (aerial, document, etc.), you may benefit from starting your training from scratch.", "And of course, it is always advantageous to experiment with both, and look empirically to see what works best for your model.", "YOLOv4 comes in two flavors YOLOv4 and YOLOv4-tiny.", "If inference speed is your end goal, the smaller model may be of interest. And it may be possible to pick up accuracy drops by improving your dataset.", "Shifting from YOLOv4 to YOLOv4-tiny is a matter of model configuration. You can experiment with intermediary configurations to construct a custom YOLO model. To do so, look in the cfg folder, and experiment with changing the networks architecture and layers. One thing to consider may be to implement custom anchor boxes, if your object shapes are vastly different than the COCO dataset. This is a very advanced tactic!", "It can take a while to train your YOLOv4 model in the Darknet framework. It is important to save your model periodically. You can always resume training by invoking training with the previous training runs weights like so:", "Be sure that the weights were trained with the same configuration file and trained under the same version of the Darknet framework!", "Just like pretrained weights, you can pick up from previous training runs and apply your model\u2019s learnings from other datasets to new datasets.", "Darknet model weights are saved in the backup folder and automatically save every 1000 iterations. Darknet will automatically save the best model for you with extension _best.weights. This is based on performance on your validation set. Darknet will also save the last weights from your training run with extension _last.weights.", "As you are working through various tweaks in your dataset and in YOLOv4 modeling, it can be useful to track your results, so you can see what combination of techniques works best on your dataset.", "Darknet will output a mean average precision score, which is the primary metric to track as you decide which model is working best on your data. Another important metric to consider is the speed of inference.", "Once you have a trained model it will be in a Darknet .weights format. You will likely want to convert it to a new format for deployment.", "The primary way to speed up the inference time of your model is to use a smaller model like YOLOv4-tiny. Further inference time improvements are possible through hardware selection, such as GPU or inferring with OpenVino on the Intel VPU. For GPU inference, it is advisable to deploy with the YOLOv4 TensorRT framework.", "Congratulations! Now you have ten new advanced tactics to get the most out of YOLO v4 for creating an object detector to model your custom dataset.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning @ Roboflow \u2014 building tools and artifacts like this one to help practitioners solve computer vision."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4c46869626a6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4c46869626a6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4c46869626a6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jacobsolawetz.medium.com/?source=post_page-----4c46869626a6--------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=post_page-----4c46869626a6--------------------------------", "anchor_text": "Jacob Solawetz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f06d25ec2e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=post_page-5f06d25ec2e8----4c46869626a6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c46869626a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c46869626a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://blog.roboflow.com/yolov4-tactics/", "anchor_text": "YOLOv4 tactics"}, {"url": "https://unsplash.com/photos/_rw79d4UgSw", "anchor_text": "cite"}, {"url": "https://blog.roboflow.com/training-yolov4-on-a-custom-dataset/", "anchor_text": "training YOLOv4"}, {"url": "https://blog.roboflow.com/tesla-stop-signs-computer-vision/", "anchor_text": "how Tesla teaches cars to stop"}, {"url": "https://blog.roboflow.com/yolov4-data-augmentation/", "anchor_text": "data augmentation in YOLO v4"}, {"url": "https://blog.roboflow.com/boosting-image-detection-performance-with-data-augmentation/", "anchor_text": "adding additional augmentation in Roboflow"}, {"url": "https://blog.roboflow.com/label-management-for-computer-vision/", "anchor_text": "class ontology"}, {"url": "https://blog.roboflow.com/when-to-use-grayscale-as-a-preprocessing-step/", "anchor_text": "grayscale"}, {"url": "https://blog.roboflow.com/when-to-use-contrast-as-a-preprocessing-step/", "anchor_text": "contrast"}, {"url": "https://roboflow.com", "anchor_text": "Roboflow"}, {"url": "https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.conv.137", "anchor_text": "https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.conv.137"}, {"url": "https://blog.roboflow.com/coco-dataset/", "anchor_text": "the COCO dataset"}, {"url": "https://blog.roboflow.com/training-yolov4-on-a-custom-dataset/", "anchor_text": "YOLOv4"}, {"url": "https://blog.roboflow.com/train-yolov4-tiny-on-custom-data-lighting-fast-detection/", "anchor_text": "YOLOv4-tiny"}, {"url": "https://github.com/AlexeyAB/darknet/issues/6067", "anchor_text": "YOLOv4-tiny"}, {"url": "https://blog.roboflow.com/what-is-an-anchor-box/", "anchor_text": "custom anchor boxes"}, {"url": "https://blog.roboflow.com/train-test-split/", "anchor_text": "your validation set."}, {"url": "https://blog.roboflow.com/mean-average-precision/", "anchor_text": "mean average precision"}, {"url": "https://blog.roboflow.com/how-to-train-a-custom-mobile-object-detection-model/", "anchor_text": "YOLOv4 TFLite for mobile deployment"}, {"url": "https://blog.roboflow.com/deploy-luxonis-oak/", "anchor_text": "YOLOv4 OpenVino and OAK Deploy"}, {"url": "https://github.com/hunglc007/tensorflow-yolov4-tflite", "anchor_text": "YOLOv4 Tensorflow Repo"}, {"url": "https://github.com/CaoWGG/TensorRT-YOLOv4", "anchor_text": "YOLOv4 TensorRT framework"}, {"url": "https://blog.roboflow.com/yolov4-tactics/", "anchor_text": "https://blog.roboflow.com"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----4c46869626a6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----4c46869626a6---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/yolov4?source=post_page-----4c46869626a6---------------yolov4-----------------", "anchor_text": "Yolov4"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4c46869626a6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----4c46869626a6---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4c46869626a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=-----4c46869626a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4c46869626a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=-----4c46869626a6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c46869626a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4c46869626a6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4c46869626a6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4c46869626a6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4c46869626a6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4c46869626a6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4c46869626a6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4c46869626a6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4c46869626a6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4c46869626a6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4c46869626a6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4c46869626a6--------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jacobsolawetz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jacob Solawetz"}, {"url": "https://jacobsolawetz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "513 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f06d25ec2e8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=post_page-5f06d25ec2e8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fbdaf42b583ae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fyolov4-ten-tactics-to-build-a-better-model-4c46869626a6&newsletterV3=5f06d25ec2e8&newsletterV3Id=bdaf42b583ae&user=Jacob+Solawetz&userId=5f06d25ec2e8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}