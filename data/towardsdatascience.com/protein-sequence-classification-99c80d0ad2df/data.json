{"url": "https://towardsdatascience.com/protein-sequence-classification-99c80d0ad2df", "time": 1683000598.075376, "path": "towardsdatascience.com/protein-sequence-classification-99c80d0ad2df/", "webpage": {"metadata": {"title": "Protein Sequence Classification. A case study on Pfam dataset to\u2026 | by Ronak Vijay | Towards Data Science", "h1": "Protein Sequence Classification", "description": "Proteins are large, complex biomolecules that play many critical roles in biological bodies. Proteins are made up of one or more long chains of amino acid sequences. These Sequences are the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Protein", "anchor_text": "Proteins", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Amino_acid", "anchor_text": "amino acid", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Peptide_bond", "anchor_text": "peptide bonds", "paragraph_index": 0}, {"url": "https://www.hornetjuice.com/amino-acids-types/", "anchor_text": "20", "paragraph_index": 0}, {"url": "https://en.m.wikipedia.org/wiki/Pfam", "anchor_text": "Pfam", "paragraph_index": 1}, {"url": "https://deepnote.com/", "anchor_text": "Deepnote", "paragraph_index": 2}, {"url": "https://deepnote.com/@ronakv/Protein-Sequence-Classification-33797a33-7311-48d3-8794-79a1ee26f406", "anchor_text": "notebook", "paragraph_index": 2}, {"url": "http://www.cryst.bbk.ac.uk/education/AminoAcid/the_twenty.html", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://www.biorxiv.org/content/10.1101/626507v4.full", "anchor_text": "this", "paragraph_index": 19}, {"url": "https://www.analyticsvidhya.com/blog/2017/12/fundamentals-of-deep-learning-introduction-to-lstm/", "anchor_text": "here", "paragraph_index": 24}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ResNet", "paragraph_index": 27}, {"url": "https://en.wikipedia.org/wiki/BLAST_(biotechnology)", "anchor_text": "BLASTp", "paragraph_index": 40}, {"url": "https://github.com/ronakvijay/Protein_Sequence_Classification", "anchor_text": "here", "paragraph_index": 42}], "all_paragraphs": ["Proteins are large, complex biomolecules that play many critical roles in biological bodies. Proteins are made up of one or more long chains of amino acid sequences. These Sequences are the arrangement of amino acids in a protein, held together by peptide bonds. Proteins can be made from 20 different kinds of amino acids, and the structure and function of each protein are determined by the kinds of amino acids used to make it and how they are arranged.", "Understanding this relationship between amino acid sequence and protein function is a long-standing problem in molecular biology with far-reaching scientific implications. Can we use deep learning that learns the relationship between unaligned amino acid sequences and their functional annotations across all protein families of the Pfam database.", "I created this project with Deepnote, an awesome product for data science professionals to run Jupyter notebooks over cloud. Super easy to setup, collaborative and offers many more features than Google Colab. Here is the complete notebook.", "We have been provided with 5 features, they are as follows:", "It is a multi class classification problem, for a given sequence of amino acids we need to predict its protein family accession.", "In this section, we will explore, visualize and try to understand the given features. Given data is already split into 3 folders i.e., train, dev, and test using random split.", "First, let\u2019s load the training, val, and test datasets.", "The sizes of the given sets are as follows:", "NOTE: I have considered less data because of limited computational power. However, the same solution can also be scaled for the whole Pfam dataset.", "First, let\u2019s count the number of codes(amino acid) in each unaligned sequences.", "Let\u2019s also find the frequency for each code(amino acid) in each unaligned sequences.", "Plotting code frequency count for train, val, and test data", "Amino acid sequences are represented with their corresponding 1 letter code, for example, the code for alanine is (A), arginine is (R), and so on. The complete list of amino acids with their code can be found here.", "For building deep learning models, we have to transform this textual data into a numerical form that the machines can process. I have used one hot encoding method for the same with considering 20 common amino acids as other uncommon amino acids are less in quantity.", "The below code snippet creates a dictionary of considered 20 amino acids with integer values in incremental order to be further used for integer encoding.", "For each unaligned amino acid sequences, 1 letter code is replaced by an integer value using the created code dictionary. If the code is not present in the dictionary the value is simply replaced by 0, thus considering only 20 common amino acids.", "This step will convert 1 letter code sequence data into numerical data like this,", "Next post padding is done with a max sequence length of 100 which pads with 0 if the total sequence length is less than 100 else truncates the sequence up to a max length of 100.", "Finally, each code in the sequences is converted into a one hot encoded vector.", "I have referred to this paper for defining model architectures and trained two separate models, one is bidirectional LSTM and the other one is inspired by ResNet, a CNN based architecture.", "Variations of Recurrent neural networks like LSTMs are the first choice when working on NLP based problems as they were made to work with temporal or sequential data like text.", "RNNs are a type of Neural Network where the outputs from previous steps are fed as inputs to the current step, thus remembering some information about the sequence. RNNs are great when it comes to short contexts, but it has a limitation in remembering longer sequences because of the vanishing gradient problem.", "LSTM (Long Short-Term Memory) Networks are improved versions of RNN, specialized in remembering information for an extended period using a gating mechanism which makes them selective in what previous information to be remembered, what to forget and how much current input is to be added for building the current cell state.", "Unidirectional LSTM only preserves the information from the past because the inputs it has seen are from the past. Using bidirectional will run the inputs in two ways, one from past to future and one from future to past allowing it to preserve contextual information from both past and future at any point of time.", "A more in-depth explanation for RNN and LSTM can be found here.", "Model architecture follows like this, first there is an embedding layer that learns the vector representation for each code followed by bidirectional LSTM. For regularization, Dropout is added to prevent model over-fitting.", "The output layer i.e., the softmax layer will give probability values for all the unique classes(1000), and based on the highest predicted probability, the model will classify amino acid sequences to one of its protein family accession.", "This model uses residual blocks inspired by ResNet architecture which also includes dilated convolutions offering a larger receptive field without increasing the number of model parameters.", "Deeper neural networks are difficult to train because of the vanishing gradient problem \u2014 as the gradient is back-propagated to earlier layers, repeated multiplication may make the gradient infinitely small. As a result, as the network goes deeper, its performance gets saturated or even starts degrading rapidly.", "ResNets introduces skip connection or identity shortcut connection which is adding initial input to the output of the convolution block.", "This mitigates the problem of vanishing gradient by allowing the alternate shortcut path for the gradient to flow through. It also allows the model to learn an identity function which ensures that the higher layer will perform at least as well as the lower layer, and not worse.", "Dilated convolutions introduce another parameter to convolutional layers called dilation rate. This defines the spacing between the values in a kernel. A 3x3 kernel with a dilation rate of 2 will have the same field of view as a 5x5 kernel, while only using 9 parameters. Imagine taking a 5x5 kernel and deleting every second column and row.", "Dilated convolutions deliver a wider field of view at the same computational cost.", "Amino acids sequences are converted to one hot encoding with shape (batch_size, 100, 21) as input to the model. The initial convolution operation is applied to the input with a kernel size of 1 to extract basic properties. Then two identical residual blocks are used to capture complex patterns in the data which are inspired by the ResNet architecture, this will help us to train the model with more number of epochs and with better model performance.", "I have defined residual block slight differently from the ResNet paper. Instead of performing three convolutions only two convolutions are used with also adding one more parameter (dilation rate) to the first convolution so as to have a wider field of view with the same number of model parameters.", "Each Convolution operation in the residual block follows a basic pattern of BatchNormalization => ReLU => Conv1D. In the residual block, the first convolution is done with a kernel size of 1x1 with a dilation rate, and the second convolution operation is done with a larger kernel size of 3x3.", "Finally, after applying the convolution operations, a skip connection is formed by adding the initial input(shortcut) and the output from the applied convolution operations.", "After two residual blocks, Max pooling is applied for reducing the spatial size of the representation. For regularization, Dropout is added to prevent model over-fitting.", "This model is trained with 10 epochs, batch_size of 256, and validated on the validation data.", "As we can see, the results of this model are better than the Bidirectional LSTM model. More improvements to this can be achieved by taking a majority vote across an ensemble of ProtCNN models.", "In this case study, we have explored deep learning models that learn the relationship between unaligned amino acid sequences and their functional annotations. The ProtCNN model has achieved significant results which are more accurate and computationally efficient than the current state-of-the-art techniques like BLASTp to annotate protein sequences.", "These results suggest deep learning models will be a core component of future protein function prediction tools.", "Thank you for reading. The complete code can be found here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F99c80d0ad2df&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ronakv.medium.com/?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": ""}, {"url": "https://ronakv.medium.com/?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": "Ronak Vijay"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F570e3f3b2ee4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&user=Ronak+Vijay&userId=570e3f3b2ee4&source=post_page-570e3f3b2ee4----99c80d0ad2df---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99c80d0ad2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99c80d0ad2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.amr-insights.eu/wp-content/uploads/2019/02/dna-3888228_960_720-800x450.jpg", "anchor_text": "Source"}, {"url": "https://en.wikipedia.org/wiki/Protein", "anchor_text": "Proteins"}, {"url": "https://en.wikipedia.org/wiki/Amino_acid", "anchor_text": "amino acid"}, {"url": "https://en.wikipedia.org/wiki/Peptide_bond", "anchor_text": "peptide bonds"}, {"url": "https://www.hornetjuice.com/amino-acids-types/", "anchor_text": "20"}, {"url": "https://en.m.wikipedia.org/wiki/Pfam", "anchor_text": "Pfam"}, {"url": "https://deepnote.com/", "anchor_text": "Deepnote"}, {"url": "https://deepnote.com/@ronakv/Protein-Sequence-Classification-33797a33-7311-48d3-8794-79a1ee26f406", "anchor_text": "notebook"}, {"url": "https://www.kaggle.com/googleai/pfam-seed-random-split", "anchor_text": "Kaggle"}, {"url": "http://www.cryst.bbk.ac.uk/education/AminoAcid/the_twenty.html", "anchor_text": "here"}, {"url": "https://www.biorxiv.org/content/10.1101/626507v4.full", "anchor_text": "this"}, {"url": "https://miro.medium.com/max/790/1*GRQ91HNASB7MAJPTTlVvfw.jpeg", "anchor_text": "Source"}, {"url": "https://www.analyticsvidhya.com/blog/2017/12/fundamentals-of-deep-learning-introduction-to-lstm/", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ResNet"}, {"url": "https://neurohive.io/wp-content/uploads/2019/01/plain-networks-training-results-770x272.png", "anchor_text": "Source"}, {"url": "https://neurohive.io/wp-content/uploads/2019/01/resnet-e1548261477164.png", "anchor_text": "Source"}, {"url": "https://www.researchgate.net/publication/329213875/figure/download/fig6/AS:697565997703168@1543324102225/Atrous-convolution-kernel-green-dilated-with-different-rates.jpg", "anchor_text": "Source"}, {"url": "https://www.biorxiv.org/content/biorxiv/early/2019/07/15/626507/F6.large.jpg", "anchor_text": "Source"}, {"url": "https://en.wikipedia.org/wiki/BLAST_(biotechnology)", "anchor_text": "BLASTp"}, {"url": "https://github.com/ronakvijay/Protein_Sequence_Classification", "anchor_text": "here"}, {"url": "https://www.biorxiv.org/content/10.1101/626507v4.full", "anchor_text": "Using Deep Learning to Annotate the Protein UniverseUnderstanding the relationship between amino acid sequence and protein function is a long-standing problem in molecular\u2026www.biorxiv.org"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----99c80d0ad2df---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----99c80d0ad2df---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/multiclass-classification?source=post_page-----99c80d0ad2df---------------multiclass_classification-----------------", "anchor_text": "Multiclass Classification"}, {"url": "https://medium.com/tag/bioinformatics?source=post_page-----99c80d0ad2df---------------bioinformatics-----------------", "anchor_text": "Bioinformatics"}, {"url": "https://medium.com/tag/protein-sequencing?source=post_page-----99c80d0ad2df---------------protein_sequencing-----------------", "anchor_text": "Protein Sequencing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99c80d0ad2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&user=Ronak+Vijay&userId=570e3f3b2ee4&source=-----99c80d0ad2df---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99c80d0ad2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&user=Ronak+Vijay&userId=570e3f3b2ee4&source=-----99c80d0ad2df---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99c80d0ad2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F99c80d0ad2df&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----99c80d0ad2df---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----99c80d0ad2df--------------------------------", "anchor_text": ""}, {"url": "https://ronakv.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ronakv.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ronak Vijay"}, {"url": "https://ronakv.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "60 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F570e3f3b2ee4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&user=Ronak+Vijay&userId=570e3f3b2ee4&source=post_page-570e3f3b2ee4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff5b92b88f43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprotein-sequence-classification-99c80d0ad2df&newsletterV3=570e3f3b2ee4&newsletterV3Id=f5b92b88f43&user=Ronak+Vijay&userId=570e3f3b2ee4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}