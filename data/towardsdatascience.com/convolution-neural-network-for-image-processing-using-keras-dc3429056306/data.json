{"url": "https://towardsdatascience.com/convolution-neural-network-for-image-processing-using-keras-dc3429056306", "time": 1683012758.580506, "path": "towardsdatascience.com/convolution-neural-network-for-image-processing-using-keras-dc3429056306/", "webpage": {"metadata": {"title": "Convolution Neural Network for Image Processing \u2014 Using Keras | by Angel Das | Towards Data Science", "h1": "Convolution Neural Network for Image Processing \u2014 Using Keras", "description": "Image classification is the process of segmenting images into different categories based on their features. A feature could be the edges in an image, the pixel intensity, the change in pixel values\u2026"}, "outgoing_paragraph_urls": [{"url": "https://docs.opencv.org/master/d4/d86/group__imgproc__filter.html", "anchor_text": "here", "paragraph_index": 19}, {"url": "https://www.linkedin.com/in/angel-das-9532bb12a/", "anchor_text": "Linked", "paragraph_index": 28}, {"url": "https://twitter.com/dasangel07_andy", "anchor_text": "Twitter", "paragraph_index": 28}], "all_paragraphs": ["Image classification is the process of segmenting images into different categories based on their features. A feature could be the edges in an image, the pixel intensity, the change in pixel values, and many more. We will try and understand these components later on. For the time being let\u2019s look into the images below (refer to Figure 1). The three images belong to the same individual however varies when compared across features like the color of the image, position of the face, the background color, color of the shirt, and many more. The biggest challenge when working with images is the uncertainty of these features. To the human eye, it looks all the same, however, when converted to data you may not find a specific pattern across these images easily.", "An image consists of the smallest indivisible segments called pixels and every pixel has a strength often known as the pixel intensity. Whenever we study a digital image, it usually comes with three color channels, i.e. the Red-Green-Blue channels, popularly known as the \u201cRGB\u201d values. Why RGB? Because it has been seen that a combination of these three can produce all possible color pallets. Whenever we work with a color image, the image is made up of multiple pixels with every pixel consisting of three different values for the RGB channels. Let\u2019s code and understand what we are talking about.", "The output of image.shape is (450, 428, 3). The Shape of the image is 450 x 428 x 3 where 450 represents the height, 428 the width, and 3 represents the number of color channels. When we say 450 x 428 it means we have 192,600 pixels in the data and every pixel has an R-G-B value hence 3 color channels.", "The output of gray.shape is 450 x 428. What we see right now is an image consisting of 192,600 odd pixels but consists of one channel only.", "When we try and covert the pixel values from the grayscale image into a tabular form this is what we observe.", "We have the grayscale value for all 192,600 pixels in the form of an array.", "Now if we take multiple such images and try and label them as different individuals we can do it by analyzing the pixel values and looking for patterns in them. However, the challenge here is that since the background, the color scale, the clothing, etc. vary from image to image, it is hard to find patterns by analyzing the pixel values alone. Hence we might require a more advanced technique that can detect these edges or find the underlying pattern of different features in the face using which these images can be labeled or classified. This where a more advanced technique like CNN comes into the picture.", "CNN or the convolutional neural network (CNN) is a class of deep learning neural networks. In short think of CNN as a machine learning algorithm that can take in an input image, assign importance (learnable weights and biases) to various aspects/objects in the image, and be able to differentiate one from the other.", "CNN works by extracting features from the images. Any CNN consists of the following:", "It is very important to understand that ANN or Artificial Neural Networks, made up of multiple neurons is not capable of extracting features from the image. This is where a combination of convolution and pooling layers comes into the picture. Similarly, the convolution and pooling layers can\u2019t perform classification hence we need a fully connected Neural Network.", "Before we jump into the concepts further let\u2019s try and understand these individual segments separately.", "Let\u2019s consider that we have access to multiple images of different vehicles, each labeled into a truck, car, van, bicycle, etc. Now the idea is to take these pre-label/classified images and develop a machine learning algorithm that is capable of accepting a new vehicle image and classify it into its correct category or label. Now before we start building a neural network we need to understand that most of the images are converted into a grayscale form before they are processed.", "We discussed earlier that any color image has three channels, i.e. red, green, and blue as shown in Figure 3. There are several such color spaces like the grayscale, CMYK, HSV in which an image can exist.", "The challenge with images having multiple color channels is that we have huge volumes of data to work with which makes the process computationally intensive. In other worlds think of it like a complicated process where the Neural Network or any machine learning algorithm has to work with three different data (R-G-B values in this case) to extract features of the images and classify them into their appropriate categories.", "The role of CNN is to reduce the images into a form that is easier to process, without losing features critical towards a good prediction. This is important when we need to make the algorithm scalable to massive datasets.", "We understand that the training data consists of grayscale images which will be an input to the convolution layer to extract features. The convolution layer consists of one or more Kernels with different weights that are used to extract features from the input image. Say in the example above we are working with a Kernel (K) of size 3 x 3 x 1 (x 1 because we have one color channel in the input image), having weights outlined below.", "When we slide the Kernel over the input image (say the values in the input image are grayscale intensities) based on the weights of the Kernel we end up calculating features for different pixels based on their surrounding/neighboring pixel values. E.g. when the Kernel is applied on the image for the first time as illustrated in Figure 5 below we get a feature value equal to 4 in the convolved feature matrix as shown below.", "If we observe Figure 4 carefully we will see that the kernel shifts 9 times across image. This process is called Stride. When we use a stride value of 1 (Non-Strided) operation we need 9 iterations to cover the entire image. The CNN learns the weights of these Kernels on its own. The result of this operation is a feature map that basically detects features from the images rather than looking into every single pixel value.", "Image features, such as edges and interest points, provide rich information on the image content. They correspond to local regions in the image and are fundamental in many applications in image analysis: recognition, matching, reconstruction, etc. Image features yield two different types of problem: the detection of the area of interest in the image, typically contours, and the description of local regions in the image, typically for matching in different images, (Image features. (n.d.))", "Extracting features from an image is similar to detecting edges in the image. We can use the openCV package to perform the same. We will declare a few matrices, apply them on a grayscale image, and try and look for edges. You can find more about the function here.", "If you are working with windows install the following \u2014 # conda install pytorch torchvision cudatoolkit=10.2 -c pytorch for using pytorch.", "We create the visualization layer, call the class object, and display the output of the Convolution of four kernels on the image (Bonner, 2019).", "Note: Depending on the weights associated with a filter, the features are detected from the image. Notice when an image is passed through a convolution layer, it and tries and identify the features by analyzing the change in neighboring pixel intensities. E.g. the top right of the image has similar pixel intensity throughout, hence no edges are detected. It is only when the pixels change intensity the edges are visible.", "ReLU or rectified linear unit is a process of applying an activation function to increase the non-linearity of the network without affecting the receptive fields of convolution layers. ReLU allows faster training of the data, whereas Leaky ReLU can be used to handle the problem of vanishing gradient. Some of the other activation functions include Leaky ReLU, Randomized Leaky ReLU, Parameterized ReLU Exponential Linear Units (ELU), Scaled Exponential Linear Units Tanh, hardtanh, softtanh, softsign, softmax, and softplus.", "The general objective of the convolution operation is to extract high-level features from the image. We can always add more than one convolution layer when building the neural network, where the first Convolution Layer is responsible for capturing gradients whereas the second layer captures the edges. The addition of layers depends on the complexity of the image hence there are no magic numbers on how many layers to add. Note application of a 3 x 3 filter results in the original image results in a 3 x 3 convolved feature, hence to maintain the original dimension often the image is padded with values on both ends.", "The pooling layer applies a non-linear down-sampling on the convolved feature often referred to as the activation maps. This is mainly to reduce the computational complexity required to process the huge volume of data linked to an image. Pooling is not compulsory and is often avoided. Usually, there are two types of pooling, Max Pooling, that returns the maximum value from the portion of the image covered by the Pooling Kernel and the Average Pooling that averages the values covered by a Pooling Kernel. Figure 12 below provides a working example of how different pooling techniques work.", "Once the pooling is done the output needs to be converted to a tabular structure that can be used by an artificial neural network to perform the classification. Note the number of the dense layer as well as the number of neurons can vary depending on the problem statement. Also often a drop out layer is added to prevent overfitting of the algorithm. Dropouts ignore few of the activation maps while training the data however use all activation maps during the testing phase. It prevents overfitting by reducing the correlation between neurons.", "An end to end example of working with CNN using Keras is provided in the link below.", "About the Author: Advanced analytics professional and management consultant helping companies find solutions for diverse problems through a mix of business, technology, and math on organizational data. A Data Science enthusiast, here to share, learn and contribute; You can connect with me on Linked and Twitter;", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant at IQVIA ANZ || Former Data Science Analyst at Novartis AU, Decision Scientist with Mu Sigma || Ex Teaching Associate Monash University"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdc3429056306&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----dc3429056306--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dc3429056306--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://angeleastbengal.medium.com/?source=post_page-----dc3429056306--------------------------------", "anchor_text": ""}, {"url": "https://angeleastbengal.medium.com/?source=post_page-----dc3429056306--------------------------------", "anchor_text": "Angel Das"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8418ab50405a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&user=Angel+Das&userId=8418ab50405a&source=post_page-8418ab50405a----dc3429056306---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc3429056306&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc3429056306&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@usgs?utm_source=medium&utm_medium=referral", "anchor_text": "USGS"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/are-your-coding-skills-good-enough-for-a-data-science-job-49af101457aa", "anchor_text": "Are your coding skills good enough for a Data Science job?5 coding sniffs you must know if you are working in the Data Science industrytowardsdatascience.com"}, {"url": "https://giphy.com/gifs/blog-daniel-keypoints-i4NjAwytgIRDW", "anchor_text": "GIPHY"}, {"url": "https://docs.opencv.org/master/d4/d86/group__imgproc__filter.html", "anchor_text": "here"}, {"url": "https://app.lucidchart.com/invitations/accept/bcbe2ab9-626c-4dfc-a5cf-de8c8c32554f", "anchor_text": "here"}, {"url": "https://github.com/angeleastbengal/ML-Projects/blob/master/Understanding%20Image%20Processing%20%2B%20CNN.ipynb", "anchor_text": "angeleastbengal/ML-ProjectsPermalink Dismiss GitHub is home to over 50 million developers working together to host and review code, manage\u2026github.com"}, {"url": "https://towardsdatascience.com/decision-tree-classifier-and-cost-computation-pruning-using-python-b93a0985ea77", "anchor_text": "Decision Tree Classifier and Cost Computation Pruning using PythonA complete hands on guide towards building, visualizing, and fine tuning a decision tree using cost computation pruning\u2026towardsdatascience.com"}, {"url": "https://neptune.ai/blog/what-image-processing-techniques-are-actually-used-in-the-ml-industry", "anchor_text": "What Image Processing Techniques Are Actually Used in the ML Industry? - neptune.aiProcessing can be used to improve the quality of your image, or to help you extract useful information from it. It's\u2026neptune.ai"}, {"url": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53.", "anchor_text": "https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53."}, {"url": "http://morpheo.inrialpes.fr/~Boyer/Teaching/Mosig/feature.pdf.", "anchor_text": "http://morpheo.inrialpes.fr/~Boyer/Teaching/Mosig/feature.pdf."}, {"url": "https://web.stanford.edu/class/cs231a/lectures/intro_cnn.pdf.", "anchor_text": "https://web.stanford.edu/class/cs231a/lectures/intro_cnn.pdf."}, {"url": "https://commons.wikimedia.org/wiki/File:Convolution_arithmetic_-_Same_padding_no_strides.gif", "anchor_text": "https://commons.wikimedia.org/wiki/File:Convolution_arithmetic_-_Same_padding_no_strides.gif"}, {"url": "https://towardsdatascience.com/wtf-is-image-classification-8e78a8235acb.", "anchor_text": "https://towardsdatascience.com/wtf-is-image-classification-8e78a8235acb."}, {"url": "https://www.linkedin.com/in/angel-das-9532bb12a/", "anchor_text": "Linked"}, {"url": "https://twitter.com/dasangel07_andy", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----dc3429056306---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/keras?source=post_page-----dc3429056306---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----dc3429056306---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----dc3429056306---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----dc3429056306---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdc3429056306&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&user=Angel+Das&userId=8418ab50405a&source=-----dc3429056306---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdc3429056306&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&user=Angel+Das&userId=8418ab50405a&source=-----dc3429056306---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdc3429056306&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----dc3429056306--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdc3429056306&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----dc3429056306---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----dc3429056306--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----dc3429056306--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----dc3429056306--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----dc3429056306--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----dc3429056306--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----dc3429056306--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----dc3429056306--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----dc3429056306--------------------------------", "anchor_text": ""}, {"url": "https://angeleastbengal.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://angeleastbengal.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Angel Das"}, {"url": "https://angeleastbengal.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8418ab50405a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&user=Angel+Das&userId=8418ab50405a&source=post_page-8418ab50405a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb55b5e582af9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolution-neural-network-for-image-processing-using-keras-dc3429056306&newsletterV3=8418ab50405a&newsletterV3Id=b55b5e582af9&user=Angel+Das&userId=8418ab50405a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}