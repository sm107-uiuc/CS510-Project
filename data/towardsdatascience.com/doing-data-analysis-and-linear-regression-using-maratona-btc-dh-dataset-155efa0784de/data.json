{"url": "https://towardsdatascience.com/doing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de", "time": 1683017055.0201752, "path": "towardsdatascience.com/doing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de/", "webpage": {"metadata": {"title": "Doing Data Analysis and Linear Regression for IBM\u2019s Maratona BTC competition | by Abraham Lemus Ruiz | Towards Data Science", "h1": "Doing Data Analysis and Linear Regression for IBM\u2019s Maratona BTC competition", "description": "Back in August 2020, IBM launched the event \u201cMaratona Behind The Code\u201d for Latin America in which participants would solve business challenges using IBM\u2019s services, create predictive models, etc. One\u2026"}, "outgoing_paragraph_urls": [{"url": "https://maratona.dev/es", "anchor_text": "Maratona Behind The Code", "paragraph_index": 0}, {"url": "https://maratona.dev/es/ranking?c=8", "anchor_text": "48th", "paragraph_index": 0}, {"url": "https://github.com/maratonadev-la/desafio-8-2020", "anchor_text": "Link to the Digital House challenge on GitHub", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/deploy-a-machine-learning-model-from-a-jupyter-notebook-9257ae5a5f7c", "anchor_text": "tutorial", "paragraph_index": 45}, {"url": "https://github.com/abraham149/linear_regression_project_d8_btc/blob/main/LR.ipynb", "anchor_text": "here", "paragraph_index": 48}], "all_paragraphs": ["Back in August 2020, IBM launched the event \u201cMaratona Behind The Code\u201d for Latin America in which participants would solve business challenges using IBM\u2019s services, create predictive models, etc. One of the challenges was for \u201cDigital House\u201d, a coding school requesting for a Machine Learning model that can predict how much time their students need to find a job after they have finished one of their courses. I managed to rank 48th.", "Link to the Digital House challenge on GitHub", "In this article, I go through different steps needed for a complete ML project using a dataset from real competition.", "This article will be divided into 3 parts:", "First of all, we download the dataset:", "Removing useless id column \u201cUNNAMED: 0\u201d:", "We have to predict the continuous variable \u201cDIAS_EMP\u201d.", "Some quick observations before exploring the data:", "Let\u2019s get some general info on the data:", "Some things to consider when doing exploratory data analysis:", "Now let\u2019s look at the correlation between numerical variables:", "Now let\u2019s plot the numerical features against each other, that way we can more clearly see their relations with each other:", "We start by using count plots with our categorical data:", "We now study how the feature varies across the different categories:", "The danger of dropping missing values is that our model may not learn all the features properly. Let\u2019s see how many rows we\u2019re getting rid of if we just drop any row with nulls:", "We would lose two-thirds of our data by dropping all rows with null values.", "The most popular ways of imputing categorical values are:", "In this article, we\u2019re going to try only the first two strategies, plot them to visualize results, and try an early LR to check performance.", "Let\u2019s first run a Linear Regression Model with the categorical variables, but dropping all null values to see the performance we could be looking up to.", "Not a bad performance considering it using only the categorical features. Let\u2019s now impute with the \u201cmost frequent\u201d category:", "Let\u2019s try and train this one:", "So we\u2019ve got a difference of -0.16 in the r2 score, a really big one considering we have almost half of the dataset with at least one value that was filled. Let\u2019s now try with imputing by creating another category among the variables. (null values are replaced with the constant \u201cmissing\u201d).", "This model shows a -0.12 difference in the r2 score, it\u2019s still a big difference but this is the superior one compared to imputing with the most frequent value, so we\u2019re going to stick with this one.", "There are multiple strategies we can try, for example:", "As before, we\u2019re going to try train a model without any missing values to have a starting comparison, then we\u2019ll try the different strategies described above", "So far a very poor performance, which we\u2019ll improve definitely once we mix the categorical features with the numerical ones. Now we try the different approaches, visualize the effects on the dataset, and train the model.", "Filling null values with mean and visualizing:", "By looking at the distribution plots and the plots between the pairs [EDAD, EXPERIENCIA] and [MINUTES_DH, AVG_DH] we can see that there\u2019s something wrong, the existing patterns are disrupted. This was done only by imputing with the mean, if we use any other constant value (like the mode or median), we'll get a similar result. Let's find the performance for this one:", "A difference of -0.022 in r2 score, not so big but let's see what the other strategies offer. Since we've seen the effect of imputing with a constant, let's jump straight to training with them.", "A somewhat similar performance compared to filling with mean.", "Let's try by using a predictor, in this case, the KNN Imputer from scikit. Since the pairs [\"EDAD\", \"EXPERIENCIA\"] and [\"MINUTES_DH\", \"AVG_DH\"] only have a high correlation with each other, we're going to predict only between those two and join the results.", "Now the plots don't show any weird effects, as the missing values were predicted. Let's see its performance:", "This model has an improvement of +0.009 in the r2 score over the previous approaches. We\u2019re going to stick to this change. We proceed to do some feature transformations.", "Here we apply some transformations over the numeric data in an attempt to improve performance. We have seen the relationship between EDAD-EXPERIENCIA and MINUTES_DH-AVG_DH, both of them appear to apply a polynomial Transformation, which we can see using a reg plot:", "We can simulate this effect with scikit\u2019s PolynomialFeatures, using a degree of 3 respectively. However, we must do them separately, since we are not using \u201cEDAD\u201d to predict \u201cMINUTES_DH\u201d.Since this is the final transformation we also call a Standard Scaler on the numeric features:", "With Polynomial Features we have an improvement of +0.007 in the r2 score over pure imputations. Now we join the datasets with categorical and numerical features to see how it performs with all the improvements done.", "A fairly decent performance, let\u2019s continue with model exploration.", "Here we will use different scikit models for regression and compare them, then we also use our custom LR model to compare it.", "From all the models seen, the basic LinearRegression() and Ridge() linear models are the strongest ones, let\u2019s further analyze the Ridge model by tuning its hyperparameters using GridSearchCV. We\u2019ll use the r2 metric for scoring:", "Select and display the top 15 parameter combinations:", "A high mean test score means the model accounts for a higher percentage of the dataset, a low std test score means our model is unlikely to be overfitting. Let\u2019s see the best model:", "Now that we got the best hyperparameters for our model, let\u2019s see some other metrics and visualize the results:", "Let\u2019s graph some results to compare the predictions vs the actual values:", "In our custom linear regression model, we do some exploration over the \u201citerations\u201d and \u201clearning rate\u201d hyperparameters:", "The best custom LR model\u2019s performance is comparable to the one we have from scikit.", "If you want to deploy your model with IBM\u2019s ML services directly from the Jupyter notebook, I recommend looking at the following tutorial.", "We have done Exploratory Data Analysis (EDA) over a dataset from a data science competition, we\u2019ve come up with decent strategies for imputing missing data and further data transformations, all based on observations we\u2019ve gathered from looking at different plots of the data. After we were done with the data we did some model exploration to find the best possible one and we have also built a custom LR model that has comparable performance to the one from scikit.", "Further things that could be done to improve the current performance:", "*All images used in this article are direct screenshots from a jupyter notebook authored by me, the notebook with everything in this article can be found here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F155efa0784de&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----155efa0784de--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----155efa0784de--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://abrahamlemusruiz.medium.com/?source=post_page-----155efa0784de--------------------------------", "anchor_text": ""}, {"url": "https://abrahamlemusruiz.medium.com/?source=post_page-----155efa0784de--------------------------------", "anchor_text": "Abraham Lemus Ruiz"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fee86f30a9fea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&user=Abraham+Lemus+Ruiz&userId=ee86f30a9fea&source=post_page-ee86f30a9fea----155efa0784de---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F155efa0784de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F155efa0784de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://maratona.dev/es", "anchor_text": "Maratona Behind The Code"}, {"url": "https://maratona.dev/es/ranking?c=8", "anchor_text": "48th"}, {"url": "https://github.com/maratonadev-la/desafio-8-2020", "anchor_text": "Link to the Digital House challenge on GitHub"}, {"url": "https://maratona.dev/es", "anchor_text": "https://maratona.dev/es"}, {"url": "https://raw.githubusercontent.com/vanderlei-test/654986294958/master/train_dataset_digitalhouse.csv", "anchor_text": "https://raw.githubusercontent.com/vanderlei-test/654986294958/master/train_dataset_digitalhouse.csv"}, {"url": "https://towardsdatascience.com/deploy-a-machine-learning-model-from-a-jupyter-notebook-9257ae5a5f7c", "anchor_text": "tutorial"}, {"url": "https://github.com/abraham149/linear_regression_project_d8_btc/blob/main/LR.ipynb", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----155efa0784de---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----155efa0784de---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/exploratory-data-analysis?source=post_page-----155efa0784de---------------exploratory_data_analysis-----------------", "anchor_text": "Exploratory Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F155efa0784de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&user=Abraham+Lemus+Ruiz&userId=ee86f30a9fea&source=-----155efa0784de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F155efa0784de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&user=Abraham+Lemus+Ruiz&userId=ee86f30a9fea&source=-----155efa0784de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F155efa0784de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----155efa0784de--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F155efa0784de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----155efa0784de---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----155efa0784de--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----155efa0784de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----155efa0784de--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----155efa0784de--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----155efa0784de--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----155efa0784de--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----155efa0784de--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----155efa0784de--------------------------------", "anchor_text": ""}, {"url": "https://abrahamlemusruiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://abrahamlemusruiz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Abraham Lemus Ruiz"}, {"url": "https://www.linkedin.com/in/abraham-lemus-ruiz/", "anchor_text": "https://www.linkedin.com/in/abraham-lemus-ruiz/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fee86f30a9fea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&user=Abraham+Lemus+Ruiz&userId=ee86f30a9fea&source=post_page-ee86f30a9fea--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fee86f30a9fea%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoing-data-analysis-and-linear-regression-using-maratona-btc-dh-dataset-155efa0784de&user=Abraham+Lemus+Ruiz&userId=ee86f30a9fea&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}