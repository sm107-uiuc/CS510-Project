{"url": "https://towardsdatascience.com/fuzzy-systems-from-data-51a53bcbc9b1", "time": 1683009436.7862709, "path": "towardsdatascience.com/fuzzy-systems-from-data-51a53bcbc9b1/", "webpage": {"metadata": {"title": "Fuzzy Systems from Data. Generating human-readable knowledge\u2026 | by Carmel Gafa | Towards Data Science", "h1": "Fuzzy Systems from Data", "description": "Fuzzy-Logic theory has introduced a framework whereby human knowledge can be formalized and used by machines in a wide variety of applications, ranging from cameras to trains. The basic ideas that we\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/a-very-brief-introduction-to-fuzzy-logic-and-fuzzy-systems-d68d14b3a3b8", "anchor_text": "post", "paragraph_index": 15}, {"url": "https://github.com/carmelgafa/ml_from_scratch", "anchor_text": "Github", "paragraph_index": 22}, {"url": "https://www.kaggle.com/budincsevity/szeged-weather/", "anchor_text": "Weather in Szeged 2006\u20132016", "paragraph_index": 34}, {"url": "http://carmelgafa.com", "anchor_text": "carmelgafa.com", "paragraph_index": 41}], "all_paragraphs": ["Fuzzy-Logic theory has introduced a framework whereby human knowledge can be formalized and used by machines in a wide variety of applications, ranging from cameras to trains. The basic ideas that we discussed in the earlier posts were concerned with only this aspect with regards to the use of Fuzzy Logic-based systems; that is the application of human experience into machine-driven applications. While there are numerous instances where such techniques are relevant; there are also applications where it is challenging for a human user to articulate the knowledge that they hold. Such applications include driving a car or recognizing images. Machine learning techniques provide an excellent platform in such circumstances, where sets of inputs and corresponding outputs are available, building a model that provides the transformation from the input data to the outputs using the available data.", "In this post, we will discuss an algorithm that constructs a Fuzzy System from data that was presented by Professor Li-Xin Wang and Professor Jerry Mendel. One exciting aspect of this and similar techniques is the ability to obtain knowledge that can be easily understood by humans in the form of fuzzy sets and rules from data.", "The objective of this exercise is, as we have explained in the introduction, given a set of input/output combinations, we will generate a ruleset that determines the mapping between the inputs and outputs. In this discussion, we will consider a two-input, single-output system. Extending this procedure for more complex systems should be a straightforward task to the reader.", "We start by assigning some fuzzy sets to each input and output space. Wang and Mendel specified an odd number of evenly spaced fuzzy regions, determined by 2N+1 where N is an integer. As we will see later on, the value of N affects the performance of our models and can result in under/overfitting at times. N is, therefore, one of the hyperparameters that we will use to tweak this system\u2019s performance.", "We can use our input and output spaces, together with the fuzzy regions that we have just defined, and the dataset for the application to generate fuzzy rules in the form of:", "We start by determining the degree of membership of each sample in the dataset to the different fuzzy regions in that space. If, as an example, we consider a sample depicted below:", "we obtain the following degrees of membership values.", "We then assign the region having the maximum degree of membership of to the spaces, which is indicated by the highlighted elements in the above table so that it is possible to obtain a rule:", "The next illustration shows a second example, together with the degree of membership results that it generates.", "This sample will, therefore, produce the following rule:", "Step 2 is very straightforward to implement, yet it suffers from one problem; it will generate conflicting rules, that is, rules that have the same antecedent clauses but different consequent clauses. Wang and Medel solved this issue by assigning a degree to each rule, using a product strategy such that the degree is the product of all the degree-of-membership values from both antecedent and consequent spaces forming the rule. We retain the rule having the most significant degree, while we discard the rules having the same antecedent but a having a smaller degree.", "If we refer to the previous example, the degree of Rule 1 will equate to:", "and for Rule 2 we obtain:", "We notice that this procedure reduces the number of rules radically in practice.", "It is also possible to fuse human knowledge to the knowledge obtained from data by introducing a human element to the rule degree, that has high applicability in practice, as human supervision can assess the reliability of data, and hence the rules generated from it directly. In the cases where human intervention is not desirable, this factor is set to 1 for all rules. Rule 1 can be hence defined as follows;", "The notion of the Combined Fuzzy Rule Base was examined in a previous post. It is a matrix that holds the fuzzy rule-base information for a system. A Combined Fuzzy Rule Base can contain the rules that are generated numerically using the procedure described above, but also rules that are obtained from human experience.", "The final step in this procedure explains the defuzzification strategy used to determine the value of y, given (x1, x2). Wang and Mendel suggest a different approach to the max-min computation used by Mamdani. We have to consider that, in practical applications, the number of input spaces will be significant when compared to the typical control application where Fuzzy Logic is typically used. Besides, this procedure will generate a large number of rules, and therefore it would be impractical to compute an output using the \u2018normal\u2019 approach.", "For a given input combination (x1, x2), we combine the antecedents of a given rule to determine the degree of output control corresponding to (x1, x2) using the product operator. If", "is the degree of output control for the ith Rule,", "We now define the centre of a fuzzy region as the point that has the smallest absolute value among all points at which the membership function for this region is equal to 1 as illustrated below;", "The value of y for a given (x1, x2) combination is thus", "where K is the number of rules.", "A (very dirty) implementation of the above algorithm was developed in Python to test it with real datasets. The code and data used are available in Github. Some considerations on this system include.", "We will use the coefficient of determination (R-Squared) to assess the performance of this system and to tune the hyperparameter that was identified, the number of fuzzy sets generated.", "To explain R-Squared, we must first define the sum of squares total and the sum of squares residual.", "The sum of squares total is the sum of the squared difference between the dependent variable (y) and the mean of the observed dependent variable.", "The sum of squares residual is the sum of the squared difference between the actual and estimated value of the dependent variable.", "R-Squared can be then calculated as", "we notice that R-Squared will have a value between 0 and 1, the larger, the better. If R-Squared =1, then there is no error and the estimated values will be equal to the actual values.", "We begin testing the procedure with a straightforward application; a single-input, single-output system that represents a hypothetical sensor that has an exponential response. To complicate things a little, we have added some noise to the sensor data as can be shown in the image below:", "We start by examining the various outcomes for the different values of N for x and y. The following illustrations formed the results that were obtained during the search for the best values.", "The best response is obtained when setting the value of N_x to 4 and N_y to 3, attaining an R-squared value of 0.985. The rules generated by the system are of particular interest as they can explain how the system is working in a way that can be easily understood;", "We notice that the characteristics of a system displaying exponential properties are clearly explained. The output value remains the smallest possible for all small values of the input, increasing very rapidly as the values of the input increase further.", "The system is also susceptible to overfitting as can be noticed for the values like N_x=5 and N_y=2.", "For a second test, we have used the Weather in Szeged 2006\u20132016 available at Kaggle. The dataset has over 96,000 training examples that consist of 12 features.", "For this exercise, we will be discarding most of these features and assess if we can predict the temperature given the month and humidity.", "Upon examining the data, we notice that the average temperature varied between 1 and 23 degrees Celcius with a variability of about 20 degrees per month.", "The average humidity varies between 0.63 and 0.85, but we also notice that it is always possible to reach 100%, irrelevant of the month.", "The best Fuzzy system that was tested consisted of 3 fuzzy spaces (N=1) for the input variables and nine fuzzy spaces (N=4) for the temperature. The system generated the nine rules depicted in the Fuzzy Distribution Map below and attained an R-Squared value of 0.75, using a test sample of 20%.", "The system described above produces human-readable rules from data that can help us gain insights on complex systems. Below are several observations and ideas for future work:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Passionate about engineering, AI and their impact on society- carmelgafa.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F51a53bcbc9b1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@carmelgafa?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carmelgafa?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": "Carmel Gafa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6724b79eb1b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&user=Carmel+Gafa&userId=6724b79eb1b0&source=post_page-6724b79eb1b0----51a53bcbc9b1---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51a53bcbc9b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51a53bcbc9b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/", "anchor_text": "https://www.pexels.com/"}, {"url": "https://towardsdatascience.com/a-very-brief-introduction-to-fuzzy-logic-and-fuzzy-systems-d68d14b3a3b8", "anchor_text": "post"}, {"url": "https://github.com/carmelgafa/ml_from_scratch", "anchor_text": "Github"}, {"url": "https://www.kaggle.com/budincsevity/szeged-weather/", "anchor_text": "Weather in Szeged 2006\u20132016"}, {"url": "https://medium.com/tag/fuzzy?source=post_page-----51a53bcbc9b1---------------fuzzy-----------------", "anchor_text": "Fuzzy"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----51a53bcbc9b1---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/soft-computing?source=post_page-----51a53bcbc9b1---------------soft_computing-----------------", "anchor_text": "Soft Computing"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----51a53bcbc9b1---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----51a53bcbc9b1---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51a53bcbc9b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&user=Carmel+Gafa&userId=6724b79eb1b0&source=-----51a53bcbc9b1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F51a53bcbc9b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&user=Carmel+Gafa&userId=6724b79eb1b0&source=-----51a53bcbc9b1---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F51a53bcbc9b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F51a53bcbc9b1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----51a53bcbc9b1---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----51a53bcbc9b1--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carmelgafa?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carmelgafa?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Carmel Gafa"}, {"url": "https://medium.com/@carmelgafa/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "107 Followers"}, {"url": "http://carmelgafa.com", "anchor_text": "carmelgafa.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6724b79eb1b0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&user=Carmel+Gafa&userId=6724b79eb1b0&source=post_page-6724b79eb1b0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F398fca6166f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffuzzy-systems-from-data-51a53bcbc9b1&newsletterV3=6724b79eb1b0&newsletterV3Id=398fca6166f8&user=Carmel+Gafa&userId=6724b79eb1b0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}