{"url": "https://towardsdatascience.com/geoparsing-with-python-c8f4c9f78940", "time": 1683002210.8180559, "path": "towardsdatascience.com/geoparsing-with-python-c8f4c9f78940/", "webpage": {"metadata": {"title": "Geoparsing with Python. Geoparsing refers to the process of\u2026 | by Michael Eby | Towards Data Science", "h1": "Geoparsing with Python", "description": "Geoparsing refers to the process of extracting place-names from text and matching those names unambiguously with proper nouns and spatial coordinates. These coordinates can then be plotted on a map\u2026"}, "outgoing_paragraph_urls": [{"url": "http://groups.inf.ed.ac.uk/geoparser/documentation/v1.1/html/intro.html", "anchor_text": "Edinburgh Geoparser", "paragraph_index": 1}, {"url": "https://www.openstreetmap.org/", "anchor_text": "OpenStreetMap", "paragraph_index": 7}, {"url": "https://pypi.org/project/geopy/", "anchor_text": "GeoPy", "paragraph_index": 7}, {"url": "https://pypi.org/project/Shapely/", "anchor_text": "Shapely", "paragraph_index": 9}, {"url": "https://hub.arcgis.com/datasets/a21fdb46d23e4ef896f31475217cbb08_1", "anchor_text": "the map object I downloaded", "paragraph_index": 9}, {"url": "http://geopandas.org/", "anchor_text": "geopandas", "paragraph_index": 10}], "all_paragraphs": ["Geoparsing refers to the process of extracting place-names from text and matching those names unambiguously with proper nouns and spatial coordinates. These coordinates can then be plotted on a map in order to visualize the spatial footprint of the text in question. Geoparsing is a specific kind of procedure known in geography as toponym resolution: however, while both geoparsing and toponym resolution address the identification of concrete geographical entities in text, toponym resolution typically concerns the simple derivation of geography from structured, unambiguous references; an example is the post office\u2019s use geocoded state abbreviations for routing. Geoparsing, on the other hand, indicates that the input text contains unstructured ambiguity; for example, a text may reference Georgia, both a country and a state in the southern USA, and it is the task of the geoparsing researcher to resolve that ambiguity.", "In information science, literary analysis, and the digital humanities, the Edinburgh Geoparser has been in use since 2015 as an open-source tool employed strictly for the task of geoparsing historical documents and classical works. Available free online, the Edinburgh Geoparser allows researchers to follow the peregrinations of John Steinbeck\u2019s Travels with Charley or George Orwell\u2019s The Road to Wigan Pier not solely on paper, but on a computer screen. The program takes an input text, pinpoints location names, cross-references those names with a gazetteer \u2014 an atlas-like geographical directory \u2014 and plots the output on Google Maps. In this way, scholars can see the travels of a letter sender or a novel\u2019s protagonist with God\u2019s-eye view, each discrete destination in interactive panorama.", "With the aid of just a handful of readily accessible packages, we can easily build our own rudimentary Edinburgh Geoparser in Python. What follows is an attempt at doing so. For this example, I will be parsing Mark Twain\u2019s The Innocents Abroad. This is an apt text for the task: published in 1859, the novel was one of Twain\u2019s most famous in his lifetime, and it remains one of the best-selling travelogues ever. From the United States to France, Odessa to Jerusalem, Twain and 60 compatriots from 15 different states traverse the globe, toponyms abounding throughout.", "For this geoparser, the below packages will be needed. I will make it clear what each is doing as it is called in the script below.", "The first thing to do is to grab The Innocents. The full text is available free online through the Gutenberg Project. Python\u2019s natural language processing library NLTK natively provides 18 Gutenberg texts for practice. Unfortunately, The Innocents is not one of them, so I will use the requests object from the urllib module, pass the url for the raw .txt, and decode it in utf-8.", "Printed in my Jupyter Notebook console is the book\u2019s title page; the entire text is just one large string of 1145397 characters. This string contains all the geographical references that I will attempt to mine. The automatic processing pipeline of the NLP package SpaCy includes name entity recognition, assigning countries, states, and cities the label \u201cgeopolitical entities.\u201d However, I was unable to find a simple way in SpaCy to extract just cities\u2014save for writing an iterative function that cross-references Wikipedia summaries\u2014so I am instead using GeoText, which has an attribute for easily extracting city names.", "Like SpaCy, GeoText recognizes geographically named entities, but calling .cities in GeoText returns just the city names. Note that I am not removing duplicates entries of cities; I want to keep these so that when I plot them my map contains frequencies of reference.", "Now, I need a gazetteer, in order concretely ground these city-names with unambiguous spatial coordinates. The Edinburgh Geoparser contains specialized gazetteers for historical place names, but I don\u2019t have access to those. Instead, OpenStreetMap is a collaborative map inspired by the Wikipedia model: it is free and editable by anyone. OSM has a search tool called Nominatim, which, given a city or state name, reverse geocodes that name and returns its geographical coordinates. So I just need to give Nominatim the list of city names. There are many ways to do this, but one way is through the Python package GeoPy, which abstract\u2019s Nominatim\u2019s API and returns the coordinates contained in the first result of the input search.", "I set the API\u2019s timeout to 2 seconds, and included an error-handling statement that skips the current search if the API times out. My hope is that if an individual search takes longer than 2 seconds, it\u2019s not really a city name, and the script will thus weed out non-names from the final map. I put the city names and coordinates into a Pandas dataframe:", "The coordinates, which are currently formatted as tuples, need to be transformed into point objects, as each city will be represented by a point on the map. The Python package Shapely does just that. Below, I\u2019m iterating over the dataframe series that contains the coordinate tuples, turning them each into Points, and switching the order of latitude and longitude, only because that\u2019s the order the map object I downloaded uses.", "Putting these point objects back into a dataframe will allow us to plot them easily. Now, instead of a pandas dataframe, I will use a geopandas dataframe, which can easily handle these types of objects.", "The final step is to plot the map with the locations. The fact that I did not remove duplicate location entries means that, if I set the transparency of the markers, more frequently referenced locations will appear more opaque than those referenced just once. That\u2019s being done with the alpha parameter in the plot object. Opaque markers should roughly correspond to cities where the USS Quaker City actually travelled, transparent ones to cites merely mentioned.", "And that\u2019s Mark Twain\u2019s The Innocents Abroad, geoparsed.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc8f4c9f78940&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@michaeleby1?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michaeleby1?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": "Michael Eby"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F18e2a69545db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&user=Michael+Eby&userId=18e2a69545db&source=post_page-18e2a69545db----c8f4c9f78940---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8f4c9f78940&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8f4c9f78940&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://groups.inf.ed.ac.uk/geoparser/documentation/v1.1/html/intro.html", "anchor_text": "Edinburgh Geoparser"}, {"url": "http://www.gutenberg.org/files/3176/3176-0.txt", "anchor_text": "http://www.gutenberg.org/files/3176/3176-0.txt"}, {"url": "https://www.openstreetmap.org/", "anchor_text": "OpenStreetMap"}, {"url": "https://pypi.org/project/geopy/", "anchor_text": "GeoPy"}, {"url": "https://pypi.org/project/Shapely/", "anchor_text": "Shapely"}, {"url": "https://hub.arcgis.com/datasets/a21fdb46d23e4ef896f31475217cbb08_1", "anchor_text": "the map object I downloaded"}, {"url": "http://geopandas.org/", "anchor_text": "geopandas"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c8f4c9f78940---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c8f4c9f78940---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/digital-humanities?source=post_page-----c8f4c9f78940---------------digital_humanities-----------------", "anchor_text": "Digital Humanities"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----c8f4c9f78940---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/geography?source=post_page-----c8f4c9f78940---------------geography-----------------", "anchor_text": "Geography"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc8f4c9f78940&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&user=Michael+Eby&userId=18e2a69545db&source=-----c8f4c9f78940---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc8f4c9f78940&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&user=Michael+Eby&userId=18e2a69545db&source=-----c8f4c9f78940---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc8f4c9f78940&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc8f4c9f78940&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c8f4c9f78940---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c8f4c9f78940--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michaeleby1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@michaeleby1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Eby"}, {"url": "https://medium.com/@michaeleby1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "50 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F18e2a69545db&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&user=Michael+Eby&userId=18e2a69545db&source=post_page-18e2a69545db--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F18e2a69545db%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeoparsing-with-python-c8f4c9f78940&user=Michael+Eby&userId=18e2a69545db&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}