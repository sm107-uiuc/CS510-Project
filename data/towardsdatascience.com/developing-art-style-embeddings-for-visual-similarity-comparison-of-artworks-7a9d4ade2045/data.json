{"url": "https://towardsdatascience.com/developing-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045", "time": 1683000179.952102, "path": "towardsdatascience.com/developing-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045/", "webpage": {"metadata": {"title": "Developing Art Style Embeddings for Visual Similarity Comparison of Artworks | by Grant Holtes | Towards Data Science", "h1": "Developing Art Style Embeddings for Visual Similarity Comparison of Artworks", "description": "The aim of this exercise is to find a function that transforms images into embedding vectors where the euclidean distance between vectors represents how visually similar the images are. This allows a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1508.06576", "anchor_text": "A Neural Algorithm of Artistic Style", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/neural-style-transfer-tutorial-part-1-f5cd3315fa7f", "anchor_text": "writing", "paragraph_index": 4}, {"url": "https://blog.griddynamics.com/create-image-similarity-function-with-tensorflow-for-retail/", "anchor_text": "Creating an image similarity function with TensorFlow and its application in e-commerce", "paragraph_index": 4}, {"url": "https://blog.griddynamics.com/author/nina-pakhomova/", "anchor_text": "Nina Pakhomova", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/DeepDream", "anchor_text": "deep dream", "paragraph_index": 9}, {"url": "http://www.grantholtes.com", "anchor_text": "www.grantholtes.com", "paragraph_index": 20}], "all_paragraphs": ["The aim of this exercise is to find a function that transforms images into embedding vectors where the euclidean distance between vectors represents how visually similar the images are. This allows a nearest neighbors search on one image\u2019s embedding to return images that are visually similar, empowering image recommendation and clustering.", "This task is complicated by the images being illustrations rather than photographs. While photographs are true representation of the subject, and hence similar subjects and composition would yield visually similar images, illustrations include the extra dimension of style.", "Style: \u201ca way of painting, writing, composing, building, etc., characteristic of a particular period, place, person, or movement.\u201d", "To create the image embeddings two methods are used:", "The model used to transfer images to embeddings borrows findings from both neural-style transfer and ecommerce image content similarity work. A Neural Algorithm of Artistic Style by Gatys et. al and writing by @Raghul Asokan was used to research neural-style transfer. Creating an image similarity function with TensorFlow and its application in e-commerce by Nina Pakhomova was used to develop an understanding of similar image retrieval techniques.", "Both style transfer and image similarity techniques leverage pre-trained convolutional (CNN) image classification models to extract and abstract information from images. These models have been trained to extract information for classification purposes, with the intermediate convolutional layers capturing increasingly complex information about the contents of the image as the depth of the network increases.", "For this I will be using VGG-19 model trained on the image-net database, the architecture of which is shown in the diagram above. To extract artistic style using this network we must first make a few subjective assumptions about what defines style in the context of the task at hand.", "Luckily we know that CNNs capture and extract this information in each convolutional layer, with each kernel \u201csearching\u201d for a texture or sub-feature. When that texture or sub-feature is present in the underlying image, the kernel outputs a high value when it samples that region of the image. The activation process for a single kernel is shown below.", "When all kernels for a layer are passed over the input, a 3D matrix with a depth equal to the number of kernels, k is output.", "The deeper into the network these kernels are, the more complex the extracted textures, with the deepest kernels activating with entire structures such as eyes or windows. This behavior is demonstrated in deep dream images.", "Using our above assumptions about what defines art style and knowing that each kernel captures different distinct elements of art style, we can use the combination of activations from all kernels at a specific region as a mathematical description of the art style that region. To summarize these findings over all regions, one could simply take every single activation and flatten them into an embedding vector, as is done in ecommerce image content similarity. However, that approach is inefficient as it requires that every activation is stored and is sensitive to spacial variations over the image. That would result in the two images below being rated as very dissimilar in style despite only varying spatially.", "To overcome these issues Gatys et. al use gram matrices in their neural style transfer paper. Gram matrices compute the correlation between the outputs of every kernel. Kernel combinations that show high correlation in their outputs are taken to be descriptive of the style of the image. For example in Starry Night above, the textures of individual brushstrokes and swirls would be highly correlated over both of the images, and as such the gram matrices of the images would be similar.", "Computationally, gram matrices are calculated by flattening the convolutional output into a 2D array, with columns for each kernel and rows for every activation, A. The dot product of this array with its transpose is taken and output as the gram matrix, G. Here G(i,j) gives the correlation between the activations of kernels i and j. Note that the term \u201ccorrelation\u201d is used rather loosely as this is not the statistically true correlation. Potentially the term cumulative co-activation would be more accurate.", "The size of the gram matrix produced is k\u00b2 which is flattened into a vector for storage. Which intermediate layer(s) to extract the kernel outputs from was determined by trial and error, with emphasis placed on performance, as the deeper the layer(s) used the more calculations and compute time required.", "Which colours are present is an obvious visual descriptor and one that we did not want to overlook. While gram matrices will extract colour information, we used a secondary sampling approach to explicitly encode the dominant colours present. Colour dimensionality reduction is well documented and usually to extract the dominant colours in an image I would use a clustering approach such a K-means. However, in this case I want the express the colours of the image as a vector where each element always corresponds to the same colour, allowing comparison between images.", "To achieve this the 3D RGB colourspace of an image is divided into n\u00b3 mutually exclusive cubes, each with side length 255/n. The number of pixels within each cube are counted, and the counts are stored in a vector of length n\u00b3.", "Finally, the flattened gram matrices are concatenated with the colour embeddings to form embeddings of dimensionality N = k\u00b2 + n\u00b3.", "A sample set of 10,000 images was used to test the model. As this method is unsupervised and requires no further training this small set is sufficient.", "If you are reading this, thanks for making it this far! Feel free to follow along as this project continues.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "AI and Analytics Consultant in Melbourne. www.grantholtes.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7a9d4ade2045&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://grantholtes.medium.com/?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": ""}, {"url": "https://grantholtes.medium.com/?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": "Grant Holtes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11f42e1349cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&user=Grant+Holtes&userId=11f42e1349cb&source=post_page-11f42e1349cb----7a9d4ade2045---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a9d4ade2045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a9d4ade2045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.lookandlearn.com", "anchor_text": "Look and Learn"}, {"url": "https://arxiv.org/abs/1508.06576", "anchor_text": "A Neural Algorithm of Artistic Style"}, {"url": "https://towardsdatascience.com/neural-style-transfer-tutorial-part-1-f5cd3315fa7f", "anchor_text": "writing"}, {"url": "https://blog.griddynamics.com/create-image-similarity-function-with-tensorflow-for-retail/", "anchor_text": "Creating an image similarity function with TensorFlow and its application in e-commerce"}, {"url": "https://blog.griddynamics.com/author/nina-pakhomova/", "anchor_text": "Nina Pakhomova"}, {"url": "http://www.cs.toronto.edu/~frossard/post/vgg16/", "anchor_text": "source"}, {"url": "https://www.mdpi.com/1996-1073/12/15/2846/xml", "anchor_text": "https://www.mdpi.com/1996-1073/12/15/2846/xml"}, {"url": "https://en.wikipedia.org/wiki/DeepDream", "anchor_text": "deep dream"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7a9d4ade2045---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----7a9d4ade2045---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/ai?source=post_page-----7a9d4ade2045---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7a9d4ade2045---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7a9d4ade2045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&user=Grant+Holtes&userId=11f42e1349cb&source=-----7a9d4ade2045---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7a9d4ade2045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&user=Grant+Holtes&userId=11f42e1349cb&source=-----7a9d4ade2045---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7a9d4ade2045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7a9d4ade2045&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7a9d4ade2045---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7a9d4ade2045--------------------------------", "anchor_text": ""}, {"url": "https://grantholtes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://grantholtes.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Grant Holtes"}, {"url": "https://grantholtes.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "241 Followers"}, {"url": "http://www.grantholtes.com", "anchor_text": "www.grantholtes.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11f42e1349cb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&user=Grant+Holtes&userId=11f42e1349cb&source=post_page-11f42e1349cb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fabeaae3f3891&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeveloping-art-style-embeddings-for-visual-similarity-comparison-of-artworks-7a9d4ade2045&newsletterV3=11f42e1349cb&newsletterV3Id=abeaae3f3891&user=Grant+Holtes&userId=11f42e1349cb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}