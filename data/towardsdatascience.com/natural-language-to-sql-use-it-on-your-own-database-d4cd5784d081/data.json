{"url": "https://towardsdatascience.com/natural-language-to-sql-use-it-on-your-own-database-d4cd5784d081", "time": 1683010950.0602298, "path": "towardsdatascience.com/natural-language-to-sql-use-it-on-your-own-database-d4cd5784d081/", "webpage": {"metadata": {"title": "Natural Language to SQL: Use it on your own database | by Param Raval | Towards Data Science", "h1": "Natural Language to SQL: Use it on your own database", "description": "Not everyone likes or knows how to write an SQL query to search within a huge database. To a layman, it would be a nightmare to construct complex queries with SQL functions and keywords \u2014 like JOIN\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1709.00103", "anchor_text": "WikiSQL", "paragraph_index": 1}, {"url": "https://catalog.ldc.upenn.edu/docs/LDC93S4B/corpus.html", "anchor_text": "ATIS", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1909.00786", "anchor_text": "EditSQL", "paragraph_index": 1}, {"url": "https://arxiv.org/pdf/1906.08990.pdf", "anchor_text": "survey", "paragraph_index": 7}, {"url": "https://demo.allennlp.org/atis-parser/MTM3MTcyNg==", "anchor_text": "converter", "paragraph_index": 8}, {"url": "https://yale-lily.github.io/spider", "anchor_text": "Spider", "paragraph_index": 10}, {"url": "https://yale-lily.github.io/sparc", "anchor_text": "SParC", "paragraph_index": 10}, {"url": "https://yale-lily.github.io/sparc", "anchor_text": "official page", "paragraph_index": 18}, {"url": "https://github.com/ryanzhumich/editsql/blob/master/README.md", "anchor_text": "README", "paragraph_index": 20}, {"url": "https://www.linkedin.com/in/param-raval/", "anchor_text": "https://www.linkedin.com/in/param-raval/", "paragraph_index": 35}], "all_paragraphs": ["Not everyone likes or knows how to write an SQL query to search within a huge database. To a layman, it would be a nightmare to construct complex queries with SQL functions and keywords \u2014 like JOIN and GROUP BY. A system to convert simple information retrieval questions into a corresponding SQL query would come in handy especially to the banking and healthcare sectors. And with advances in NLP, this could be a reality very soon.", "Though there has been substantial research to solve this problem, we are yet to get complete accurate results. Still, from work done on benchmark datasets like WikiSQL, Spider, SPaRC and ATIS, people have managed to build Text-to-SQL systems with decent results. Here, you will see how to implement such a system using the EditSQL model along with a simple workaround to use it on your own schema.", "This article is structured as follows:", "2. Installing & Running EditSQL on SParC", "3. Making Changes to the Code", "4. Adding a Custom Database and Building the Vocab", "Generating SQL queries from user questions involves solving tasks more than just question-answering and machine translation. Like in question-answering, as the user interacts more, they will often put forward questions that require complex processing such as \u2014 a reference to some information mentioned previously or require a combination of several disparate schemas. As a tool, such a system helps the end users, who are often inexperienced in database querying matters, extract information from scores of complex databases.", "Several attempts have been made on different benchmark datasets to address such problems in the Text-to-SQL task, especially in semantic parsing. You can check out this interesting survey [4] that introduces the task and the problem quite well.", "You can also check out this interactive converter built by the AllenNLP team on the ATIS dataset. Just like several other and better performing models, they use semantic parsing and an encoder-decoder architecture to do the job.", "As of July 2020, the leaderboard for Spider and SParC list the following models as some of the best performing models with an opensource code given:", "Here, you can find the complete leaderboard for Spider and SParC. For practicality, we limit the scope of this article to exploring EditSQL especially on SParC.", "While the listed models perform well on their respective datasets, the given codes do not have the option to test the model on a custom database (let alone train). In fact, even to make changes to existing queries of the dataset is a tedious and error-prone process.", "However, out of the models given above we can make some changes to EditSQL and manage to run the SParC experiment on a custom SQLite database. These changes are minor and prove to be an easy workaround to test the performance on your own database.", "EditSQL attempts to solve a context-dependent text to SQL query generation task and incorporates interaction histories as well as an utterance-table encoder-decoder unit to robustly understand the context of a user\u2019s utterance (or question). To do this, they use an encoder based on BERT which avails in capturing complex database structures and relate them to the utterances. Thus, given an arbitrary question, the model will most certainly identify correctly the database schema to which the question corresponds.", "Furthermore, EditSQL takes into account the relation between the user utterance and the table structures as well as recent history of encoding to correctly identify the context. As shown in the diagram above, the information gained here is then passed to a table-aware decoder that uses an attention enhanced LSTM to perform SQL generation.", "However, the user often asks questions that contain information provided in a previous interaction. In a sequential generation mechanism this might lead to redundancy in processing and query generation. What gives EditSQL its name is the novel mechanism to \u201cedit\u201d the generated tokens of the query and take care of this problem using another Bi-LSTM paired with the attention enabled context vector.", "To run this model, make sure you have a GPU enabled system. Alternatively, you can work on Google Colab.", "First off, clone this repository into your system (or in Colab):", "Download the SParC dataset to run the experiment from their official page or use the gdown command as follows:", "Place the unzipped folder into editsql/data/sparc", "Next, you can follow the instructions in their README or follow these steps:", "And place the pretrained BERT model in the file tree as below:", "If the above steps are successfully executed you can run the following bash script to begin training:", "The authors have saved their experimental logs at logs/logs_sparc_editsql in log.txt where you can find the details and performance of each epoch.", "You will need to successfully execute at least the initial preprocessing and vocab building steps during training. This will create folders named", "You can interrupt the execution (Ctrl+C) once your output looks like shown below (right before the actual training starts). Number of examples and batch size values might differ as per your configuration.", "Successful execution of these steps will create the processed data files and vocab files which are necessary for testing on the development set.", "Since we haven\u2019t really performed any \u201ctraining\u201d, we will need to download the author\u2019s pretrained model and place it under logs/logs_sparc_editsql under the name save_31_sparc_editsql.", "Now you are all set to run the bash script to predict on the dev set.", "The predictions are saved in a structured JSON file in logs/logs_sparc_editsql under the name dev_use_predicted_queries_predictions.json.", "It can be cumbersome to verify each predicted query with its corresponding question. So you can run the following script to get a readable output stored in a file. This script will create output.txt containing the input question, predicted query and the prediction confidence for every question-query pair in the predictions file.", "Note: Please delete all the folders that were created by the training script before running it again. This also includes logs_sparc_editsql/args.log. These files are not updated unless the script gets to create them from scratch.", "Now you can easily convert natural language questions to an SQL query on your own schema.", "[4] Affolter, Katrin, Kurt Stockinger, and Abraham Bernstein, A comparative survey of recent natural language interfaces for databases (2019), The VLDB Journal 28.5: 793\u2013819.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A student of engineering with a zeal for Machine Learning and writing. Reach out to me on LinkedIn: https://www.linkedin.com/in/param-raval/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd4cd5784d081&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@param005raval?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@param005raval?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": "Param Raval"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21c4fe422a47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&user=Param+Raval&userId=21c4fe422a47&source=post_page-21c4fe422a47----d4cd5784d081---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4cd5784d081&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4cd5784d081&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tofi?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Tobias Fischer"}, {"url": "https://unsplash.com/s/photos/database?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1709.00103", "anchor_text": "WikiSQL"}, {"url": "https://catalog.ldc.upenn.edu/docs/LDC93S4B/corpus.html", "anchor_text": "ATIS"}, {"url": "https://arxiv.org/abs/1909.00786", "anchor_text": "EditSQL"}, {"url": "https://arxiv.org/pdf/1906.08990.pdf", "anchor_text": "survey"}, {"url": "https://demo.allennlp.org/atis-parser/MTM3MTcyNg==", "anchor_text": "converter"}, {"url": "https://arxiv.org/abs/1911.04942", "anchor_text": "RATSQL v3 + BERT"}, {"url": "https://arxiv.org/abs/1905.08205", "anchor_text": "IRNet + BERT"}, {"url": "https://yale-lily.github.io/spider", "anchor_text": "Spider"}, {"url": "https://yale-lily.github.io/sparc", "anchor_text": "SParC"}, {"url": "https://yale-lily.github.io/sparc", "anchor_text": "leaderboard"}, {"url": "https://github.com/ryanzhumich/editsql", "anchor_text": "https://github.com/ryanzhumich/editsql"}, {"url": "https://yale-lily.github.io/sparc", "anchor_text": "official page"}, {"url": "https://github.com/ryanzhumich/editsql/blob/master/README.md", "anchor_text": "README"}, {"url": "https://drive.google.com/file/d/1f_LEWVgrtZLRuoiExJa5fNzTS8-WcAX9/view?usp=sharing", "anchor_text": "https://drive.google.com/file/d/1f_LEWVgrtZLRuoiExJa5fNzTS8-WcAX9/view?usp=sharing"}, {"url": "https://github.com/taoyds/spider#tables", "anchor_text": "here"}, {"url": "https://github.com/taoyds/spider#question-sql-and-parsed-sql", "anchor_text": "right here"}, {"url": "https://github.com/taoyds/spider/blob/master/preprocess/parsed_sql_examples.sql", "anchor_text": "parsed_sql_examples.sql"}, {"url": "https://github.com/ryanzhumich/editsql", "anchor_text": "https://github.com/ryanzhumich/editsql"}, {"url": "https://github.com/taoyds/sparc", "anchor_text": "https://github.com/taoyds/sparc"}, {"url": "https://github.com/taoyds/spider", "anchor_text": "https://github.com/taoyds/spider"}, {"url": "https://medium.com/tag/nlp?source=post_page-----d4cd5784d081---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/sql?source=post_page-----d4cd5784d081---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d4cd5784d081---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/text-to-sql?source=post_page-----d4cd5784d081---------------text_to_sql-----------------", "anchor_text": "Text To Sql"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d4cd5784d081---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd4cd5784d081&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&user=Param+Raval&userId=21c4fe422a47&source=-----d4cd5784d081---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd4cd5784d081&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&user=Param+Raval&userId=21c4fe422a47&source=-----d4cd5784d081---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd4cd5784d081&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd4cd5784d081&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d4cd5784d081---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d4cd5784d081--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d4cd5784d081--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d4cd5784d081--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d4cd5784d081--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@param005raval?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@param005raval?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Param Raval"}, {"url": "https://medium.com/@param005raval/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "104 Followers"}, {"url": "https://www.linkedin.com/in/param-raval/", "anchor_text": "https://www.linkedin.com/in/param-raval/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F21c4fe422a47&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&user=Param+Raval&userId=21c4fe422a47&source=post_page-21c4fe422a47--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F317796f8cb08&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fnatural-language-to-sql-use-it-on-your-own-database-d4cd5784d081&newsletterV3=21c4fe422a47&newsletterV3Id=317796f8cb08&user=Param+Raval&userId=21c4fe422a47&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}