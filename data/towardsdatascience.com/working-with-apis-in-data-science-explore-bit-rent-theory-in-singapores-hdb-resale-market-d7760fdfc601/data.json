{"url": "https://towardsdatascience.com/working-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601", "time": 1682992951.73024, "path": "towardsdatascience.com/working-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601/", "webpage": {"metadata": {"title": "Working with APIs in Data Science \u2014 Explore Bit-Rent Theory in Singapore\u2019s HDB Resale Market | by Yexi Yuan | Towards Data Science", "h1": "Working with APIs in Data Science \u2014 Explore Bit-Rent Theory in Singapore\u2019s HDB Resale Market", "description": "80% of your work in data analysis and machine learning is wrangling and cleaning data which can be very tedious work. Automation of data extraction, data enrichment, and data cleaning with APIs can\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["80% of your work in data analysis and machine learning is wrangling and cleaning data which can be very tedious work. Automation of data extraction, data enrichment, and data cleaning with APIs can save you a lot of work doing manual extraction.", "The focus in this article will be on how to interact with APIs in Python and we will be working in the context of the Singapore public housing data set and explore the Bid-Rent Theory in the housing market. It will be heavier on the Python scripting and lighter on the actual analysis so do forgive me if there is a lack of academic and statistical rigour in any part of this article.", "We are basically exploring the relationship between price per square meter and the distance of the property to the CBD.", "Great, now that is out of the way, let\u2019s let into the thick of things.", "First, we will start off with import some essential libraries", "To make our first API request we will be using the requests library. But before that let\u2019s examine the API in our browser:", "We can see that we can query the results by using the \u201climit\u201d or the \u201cq\u201d parameters to obtain results from the search. Since will we be needing the entire date set we just need to specific the limit to be the entire data set.", "Quickly examining the example query in our browser, we can see that the \u201crecords\u201d of transactions that we are interested in at nested in the \u201cresults\u201d array of the JSON response. With a sense of the data structure we are dealing with, we can move to our Python IDE and query our data.", "Since it is a rather large data set (101994 as of time of writing), we will sample 500 records to make it easier to work with before moving to the entire database. This is good practice in exploratory phase of using APIs to not use up unnecessary serve resources querying huge data sets repeatedly. Now, let\u2019s examine what the serve returned to us in our IDE.", "Nice, the JSON object returned from the serve is basically a Python Dictionary which are familiar with! Our job just got a little easier and no additional work is needed to transform our JSON object for it to work in Python.", "All we have to do is access the records key in our dictionary object to obtain the list of transaction data that are stored as dictionary key-value pairs.", "Now that we are comfortable with traversing the nested data, let\u2019s create our Pandas data frame.", "In the above, we are creating a for loop to append our dictionary values in each records to the relevant list that will form each column in our data frame.", "Cool! Our data frame is looking good!", "The next part gets a little tricky. We need to find the nearest MRT station the HDB unit is located in using their geo-location coordinates (Latitude, Longitude). We will use another API to achieve this \u2014 the OneMap API.", "First let\u2019s create a list of all the MRT stations in Singapore. Since MRT stations change relatively slowly overtime, we can leverage a static list instead. I obtained (good ole copy and pasta ;) ) the data from Wikipedia, which also provides data on upcoming MRT stations. We will only consider existing MRT stations for now.", "Quick look at the OneMap API \u2014 we can see that we need to input our address into the \u201csearchVal\u201d parameter of our URL like so:", "Let\u2019s use the OneMap API to obtain the (lat, long) coordinates of each MRT station. The for loop below iterates through the list of MRT stations and returns the results, we will then grab the first result of the response, similar to what we did when we transverse through the resale JSON object earlier.", "Then we store it into a new data frame:", "Now \u2014 let\u2019s find grab the geolocation of each unit that was transacted using the same method. But hang on \u2014 that\u2019s a large data set.. we can make it a bit more efficient. We know that there will be multiple units that will be transacted in the same HDB Apartment block. We can de-dup our data frame and obtain only unique addresses in our data frame.", "We can now obtain the (lat, long) coordinates through our OneMap API", "With that done, let\u2019s save it to a date frame:", "We will need to solution for our next task, find the nearest MRT for each address that we have in our data frame and obtain the distance in meters.", "We will be using the Haversine formula to obtain the distance between 2 points on a curved surface. Alternatively we can use Pythagoras\u2019 theorem too since the distance between our points are not that large. But to make things simplier, we will use the geopy package for the Haversine formula.", "To obtain the nearest MRT station for any given point on the map we will need to:", "Above we have a nested for-loop that iterates through the 2 sets of coordinates to obtain the nearest MRT for every unique address that we have in our data set. This is definitely not the most efficient solution though. We can for example group our addresses into various districts of Singapore and only check against a list of MRT stations that fall within the given distance instead of the whole list. But for now we will rely on the brute force of our CPUs to churn those numbers for us :)", "We will do the same for our distance to CBD and distance to nearest shopping mall.", "Lastly we will use an outer join to merge our distance data with our main data frame.", "We are ready to plot out our price/sqm to distance to CDB relationship!", "We definitely see a negative relationship between distance and price per sqm from our dataset. But there is also a large variance at certain intervals of distance between the property and the CBD. There must be other explanatory factors that determine land price beside our cdb_dist variable. Let\u2019s explore the correlation between our variables.", "Looks like distance to key amenities such as MRT and a shopping mall have an impact on our land price. While the lease of land also can explain part of the price as well.", "We will further explore the explanatory powers of our features using a simple multi-linear regression model. Let\u2019s engineer the features we need.", "Mean Abosulte Error gives us the average absolute value of our actual data from the model\u2019s prediction. Our MAE is fairly small compared to the range and mean of price per sqm in our data set.", "From our RMSE value, our model\u2019s prediction will miss the actual value of the property by $628.85 on average. If we take our RMSE as a percentage of our mean price per sqm, it will give us a 14% error rate \u2014 which is rather high.", "Let\u2019s try to improve our model\u2019s explanatory power by introducing our categorical variables into our regression.", "Our MAE, MSE, RSME have all decreased as well, implying a higher accurarcy for our model. Our RMSE/Mean has also dropped to 11.2%.", "Clearly, there is a statistically significant relationship between distance to the CBD and price per sqm. However, it does not fully explain HDB housing prices in Singapore. From our regression model we see there are more to residential estate pricing such as amenities, political boundaries, and maturity of the property and the estate it is in that could potentially have stronger explanatory and predictive powers than distance to CBD.", "Thanks for reading till the end! It\u2019s a long one and hope this helps you in better understand how to interact with APIs in Python and how it can help to automate your data processing and analysis workflows! Give me a follow for more data and Python related content :)", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Business Intelligence Analyst for Direct-to-Consumer products."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd7760fdfc601&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://yuanyexi.medium.com/?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": ""}, {"url": "https://yuanyexi.medium.com/?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": "Yexi Yuan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F377edf3deb58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&user=Yexi+Yuan&userId=377edf3deb58&source=post_page-377edf3deb58----d7760fdfc601---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7760fdfc601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7760fdfc601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/yuan-yexi/hdb-resale-api/blob/master/script.py", "anchor_text": "https://github.com/yuan-yexi/hdb-resale-api/blob/master/script.py"}, {"url": "https://data.gov.sg/dataset/resale-flat-prices", "anchor_text": "https://data.gov.sg/dataset/resale-flat-prices"}, {"url": "https://docs.onemap.sg/", "anchor_text": "https://docs.onemap.sg/"}, {"url": "https://data.gov.sg/api/action/datastore_search?resource_id=42ff9cfe-abe5-4b54-beda-c88f9bb438ee&limit=500'", "anchor_text": "https://data.gov.sg/api/action/datastore_search?resource_id=42ff9cfe-abe5-4b54-beda-c88f9bb438ee&limit=500'"}, {"url": "https://developers.onemap.sg/commonapi/search?searchVal='+str(query_address)+'&returnGeom=Y&getAddrDetails=Y'", "anchor_text": "https://developers.onemap.sg/commonapi/search?searchVal='+str(address)+'&returnGeom=Y&getAddrDetails=Y"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d7760fdfc601---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----d7760fdfc601---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/api?source=post_page-----d7760fdfc601---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/data-processing?source=post_page-----d7760fdfc601---------------data_processing-----------------", "anchor_text": "Data Processing"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----d7760fdfc601---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7760fdfc601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&user=Yexi+Yuan&userId=377edf3deb58&source=-----d7760fdfc601---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7760fdfc601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&user=Yexi+Yuan&userId=377edf3deb58&source=-----d7760fdfc601---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7760fdfc601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd7760fdfc601&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d7760fdfc601---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d7760fdfc601--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d7760fdfc601--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d7760fdfc601--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d7760fdfc601--------------------------------", "anchor_text": ""}, {"url": "https://yuanyexi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://yuanyexi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yexi Yuan"}, {"url": "https://yuanyexi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "237 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F377edf3deb58&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&user=Yexi+Yuan&userId=377edf3deb58&source=post_page-377edf3deb58--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F164cfdd6e72c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fworking-with-apis-in-data-science-explore-bit-rent-theory-in-singapores-hdb-resale-market-d7760fdfc601&newsletterV3=377edf3deb58&newsletterV3Id=164cfdd6e72c&user=Yexi+Yuan&userId=377edf3deb58&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}