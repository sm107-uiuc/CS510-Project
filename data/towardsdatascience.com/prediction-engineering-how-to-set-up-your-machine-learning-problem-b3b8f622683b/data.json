{"url": "https://towardsdatascience.com/prediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b", "time": 1682993902.018239, "path": "towardsdatascience.com/prediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b/", "webpage": {"metadata": {"title": "Prediction Engineering: How to Set Up Your Machine Learning Problem | by Will Koehrsen | Towards Data Science", "h1": "Prediction Engineering: How to Set Up Your Machine Learning Problem", "description": "This is the second in a four-part series on how we approach machine learning at Feature Labs. The set of articles is: These articles will cover the concepts and a full implementation as applied to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.featurelabs.com", "anchor_text": "Feature Labs", "paragraph_index": 0}, {"url": "https://github.com/Featuretools/predicting-customer-churn/tree/master/churn", "anchor_text": "Jupyter Notebooks are all available on GitHub", "paragraph_index": 1}, {"url": "https://github.com/Featuretools/featuretools", "anchor_text": "Featuretools", "paragraph_index": 1}, {"url": "https://www.cs.utexas.edu/~mitra/csSummer2014/cs312/lectures/bestPractices.html", "anchor_text": "from software engineering", "paragraph_index": 4}, {"url": "https://machinelearningmastery.com/data-leakage-machine-learning/", "anchor_text": "problem of data leakage", "paragraph_index": 13}, {"url": "https://www.kkbox.com/", "anchor_text": "KKBOX", "paragraph_index": 15}, {"url": "https://www.kaggle.com/c/kkbox-music-recommendation-challenge/data", "anchor_text": "dataset", "paragraph_index": 15}, {"url": "https://en.wikipedia.org/wiki/Relational_database", "anchor_text": "relational data", "paragraph_index": 16}, {"url": "https://github.com/Featuretools/predicting-customer-churn/blob/master/churn/2.%20Prediction%20Engineering.ipynb", "anchor_text": "the notebook", "paragraph_index": 24}, {"url": "https://medium.com/@williamkoehrsen/feature-engineering-what-powers-machine-learning-93ab191bcc2d", "anchor_text": "next article in the series describes how feature engineering works", "paragraph_index": 28}, {"url": "https://www.featurelabs.com/contact/", "anchor_text": "Feature Labs", "paragraph_index": 33}, {"url": "https://www.featurelabs.com/product", "anchor_text": "commercial product", "paragraph_index": 33}], "all_paragraphs": ["This is the second in a four-part series on how we approach machine learning at Feature Labs. The set of articles is:", "These articles will cover the concepts and a full implementation as applied to predicting customer churn. The project Jupyter Notebooks are all available on GitHub. (Full disclosure: I work for Feature Labs, a startup developing tooling, including Featuretools, for solving problems with machine learning. All of the work documented here was completed with open-source tools and data.)", "When working with real-world data on a machine learning task, we define the problem, which means we have to develop our own labels \u2014 historical examples of what we want to predict \u2014 to train a supervised model. The idea of making our own labels may initially seem foreign to data scientists (myself included) who got started on Kaggle competitions or textbook datasets where the answers are already included.", "The concept behind prediction engineering \u2014 making labels to train a supervised machine learning model \u2014 is not new. However, it currently is not a standardized process and is done by data scientists on an as-needed basis. This means that for each new problem \u2014 even with the same dataset \u2014 a new script must be developed to accomplish this task resulting in solutions that cannot be adapted to different prediction problems.", "A better solution is to write functions that are flexible to changing business parameters, allowing us to quickly generate labels for many problems. This is one area where data science can learn from software engineering: solutions should be reusable and accept changing inputs. In this article, we\u2019ll see how to implement a reusable approach to the first step in solving problems with machine learning \u2014 prediction engineering.", "Prediction engineering requires guidance both from the business viewpoint to figure out the right problem to solve as well as from the data scientist to determine how to translate the business need into a machine learning problem. The inputs to prediction engineering are the parameters which define the prediction problem for the business requirement , and the historical dataset for finding examples of what we want to predict.", "The output of prediction engineering is a label times table: a set of labels with negative and positive examples made from past data along with an associated cutoff time indicating when we have to stop using data to make features for that label (more on this shortly).", "For our use case we\u2019ll work through in this series \u2014 customer churn \u2014 we defined the business problem as increasing monthly active subscribers by reducing rates of churn. The machine learning problem is building a model to predict which customers will churn using historical data. The first step in this task is making a set of labels of past examples of customer churn.", "The parameters for what constitutes a churn and how often we want to make predictions will vary depending on the business need, but in this example, let\u2019s say we want to make predictions on the first of each month for which customers will churn one month out from the time of prediction. Churn will be defined as going more than 31 days without an active membership.", "It\u2019s important to remember this is only one definition of churn corresponding to one business problem. When we write functions to make labels, they should take in parameters so they can be quickly changed to different prediction problems.", "Our goal for prediction engineering is a label times table as follows:", "The labels correspond to whether a customer churned or not based on historical data. Each customer is used as a training example multiple times because they have multiple months of data. Even if we didn\u2019t use customers many times, because this is a time-dependent problem, we have to correctly implement the concept of cutoff times.", "The labels are not complete without the cutoff time which represents when we have to stop using data to make features for a label. Since we are making predictions about customer churn on the first of each month, we can\u2019t use any data after the first to make features for that label. Our cutoff times are therefore all on the first of the month as shown in the label times table above.", "All the features for each label must use data from before this time to prevent the problem of data leakage. Cutoff times are a crucial part of building successful solutions to time-series problems that many companies do not account for. Using invalid data to make features leads to models that do well in development but fail in deployment.", "Imagine we did not limit our features to data that occurred before the first of the month for each label. Our model would figure out that customers who had a paid transaction during the month could not have churned in that month and would thus record high metrics. However, when it came time to deploy the model and make predictions for a future month, we do not have access to the future transactions and our model would perform poorly. It\u2019s like a student who does great on homework because she has the answer key but then is lost on the test without the same information.", "Now that we have the concepts, let\u2019s work go through the details. KKBOX is Asia\u2019s leading music streaming service offering both a free and a pay-per-month subscription option to over 10 million members. KKBOX has made available a dataset for predicting customer churn. There are 3 data tables coming in at just over 30 GB that are represented by the schema below:", "This is a typical dataset for a subscription business and is an example of structured, relational data: observations in the rows, features in the columns, and tables tied together by primary and foreign keys: the customer id.", "The key to making prediction engineering adaptable to different problems is to follow a repeatable process for extracting training labels from a dataset. At a high-level this is outlined as follows:", "For customer churn, the parameters are the", "The following diagram shows each of these concepts while filling in the details with the problem definition we\u2019ll work through.", "In this case, the customer has churned during the month of January as they went without a subscription for more than 30 days. Because our lead time is one month and the prediction window is also one month, the label of churn is associated with the cutoff time of December 1. For this problem, we are thus teaching our model to predict customer churn one month in advance to give the customer satisfaction team sufficient time to engage with customers.", "For a given dataset, there are numerous prediction problems we can make from it. We might want to predict churn at different dates or frequencies, such as every two weeks, with a lead time of two months, or define churn as a shorter duration without an active membership. Moreover, there are other problems unrelated to churn we could solve with this dataset: predict how many songs a customer will listen to in the next month; predict the rate of growth of the customer base; or, segment customers into different groups based on listening habits to tailor a more personal experience.", "When we develop the functions for creating labels, we make our inputs parameters so we can quickly make multiple sets of labels from the dataset.", "If we develop a pipeline that has parameters instead of hard-coded values, we can rapidly adopt it to different problems. When we want to change the definition of a churn, all we need to do is alter the parameter input to our pipeline and re-run it.", "To make labels, we develop 2 functions (full code in the notebook):", "The label_customer function takes in a customer\u2019s transactions and the specified parameters and returns a label times table. This table has a set of prediction times \u2014 the cutoff times \u2014 and the label during the prediction window for each cutoff time corresponding to a single customer.", "As an example, our labels for a customer look like the following:", "The make_labels function then takes in the transactions for all customers along with the parameters and returns a table with the cutoff times and the label for every customer.", "When implemented correctly, the end outcome of prediction engineering is a function which can create label times for multiple prediction problems by changing input parameters. These labels times \u2014 a cutoff time and associated label \u2014 are the input to the next stage in which we make features for each label. The next article in the series describes how feature engineering works .", "We haven\u2019t invented the process of prediction engineering, just given it a name and defined a reusable approach for this first part in the pipeline.", "The process of prediction engineering is captured in three steps:", "Getting prediction engineering right is crucial and requires input from both the business and data science sides of a business. By writing the code for prediction engineering to accept different parameters, we can rapidly change the prediction problem if the needs of our company change.", "More generally, our approach to solving problems with machine learning segments the different parts of the pipeline while standardizing each input and output. The end result, as we\u2019ll see, is we can quickly change the prediction problem in the prediction engineering stage without needing to rewrite the subsequent steps. In this article, we\u2019ve developed the first step in a framework that can be used to solve many problems with machine learning.", "If building meaningful, high-performance predictive models is something you care about, then get in touch with us at Feature Labs. While this project was completed with the open-source Featuretools, the commercial product offers additional tools and support for creating machine learning solutions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist at Cortex Intel, Data Science Communicator"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb3b8f622683b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://williamkoehrsen.medium.com/?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": ""}, {"url": "https://williamkoehrsen.medium.com/?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": "Will Koehrsen"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2f299e30cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&user=Will+Koehrsen&userId=e2f299e30cb9&source=post_page-e2f299e30cb9----b3b8f622683b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3b8f622683b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3b8f622683b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.featurelabs.com", "anchor_text": "Feature Labs"}, {"url": "https://medium.com/@williamkoehrsen/how-to-create-value-with-machine-learning-eb09585b332e", "anchor_text": "Overview: A General-Purpose Framework for Machine Learning"}, {"url": "https://medium.com/@williamkoehrsen/feature-engineering-what-powers-machine-learning-93ab191bcc2d", "anchor_text": "Feature Engineering: What Powers Machine Learning"}, {"url": "https://medium.com/@williamkoehrsen/modeling-teaching-a-machine-learning-algorithm-to-deliver-business-value-ad0205ca4c86", "anchor_text": "Modeling: Teaching an Algorithm to Make Predictions"}, {"url": "https://github.com/Featuretools/predicting-customer-churn/tree/master/churn", "anchor_text": "Jupyter Notebooks are all available on GitHub"}, {"url": "https://github.com/Featuretools/featuretools", "anchor_text": "Featuretools"}, {"url": "https://www.cs.utexas.edu/~mitra/csSummer2014/cs312/lectures/bestPractices.html", "anchor_text": "from software engineering"}, {"url": "https://machinelearningmastery.com/data-leakage-machine-learning/", "anchor_text": "problem of data leakage"}, {"url": "https://www.kkbox.com/", "anchor_text": "KKBOX"}, {"url": "https://www.kaggle.com/c/kkbox-music-recommendation-challenge/data", "anchor_text": "dataset"}, {"url": "https://www.kaggle.com/c/kkbox-music-recommendation-challenge/data", "anchor_text": "data"}, {"url": "https://en.wikipedia.org/wiki/Relational_database", "anchor_text": "relational data"}, {"url": "https://github.com/Featuretools/predicting-customer-churn/blob/master/churn/2.%20Prediction%20Engineering.ipynb", "anchor_text": "the notebook"}, {"url": "https://medium.com/@williamkoehrsen/feature-engineering-what-powers-machine-learning-93ab191bcc2d", "anchor_text": "next article in the series describes how feature engineering works"}, {"url": "https://www.featurelabs.com/contact/", "anchor_text": "Feature Labs"}, {"url": "https://www.featurelabs.com/product", "anchor_text": "commercial product"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b3b8f622683b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b3b8f622683b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/engineering?source=post_page-----b3b8f622683b---------------engineering-----------------", "anchor_text": "Engineering"}, {"url": "https://medium.com/tag/education?source=post_page-----b3b8f622683b---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/predictive-analytics?source=post_page-----b3b8f622683b---------------predictive_analytics-----------------", "anchor_text": "Predictive Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb3b8f622683b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&user=Will+Koehrsen&userId=e2f299e30cb9&source=-----b3b8f622683b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb3b8f622683b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&user=Will+Koehrsen&userId=e2f299e30cb9&source=-----b3b8f622683b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb3b8f622683b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb3b8f622683b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b3b8f622683b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b3b8f622683b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b3b8f622683b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b3b8f622683b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b3b8f622683b--------------------------------", "anchor_text": ""}, {"url": "https://williamkoehrsen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://williamkoehrsen.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Will Koehrsen"}, {"url": "https://williamkoehrsen.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "38K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe2f299e30cb9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&user=Will+Koehrsen&userId=e2f299e30cb9&source=post_page-e2f299e30cb9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe7d4a87a913e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprediction-engineering-how-to-set-up-your-machine-learning-problem-b3b8f622683b&newsletterV3=e2f299e30cb9&newsletterV3Id=e7d4a87a913e&user=Will+Koehrsen&userId=e2f299e30cb9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}