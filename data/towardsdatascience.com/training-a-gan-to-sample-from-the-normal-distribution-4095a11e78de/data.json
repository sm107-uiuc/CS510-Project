{"url": "https://towardsdatascience.com/training-a-gan-to-sample-from-the-normal-distribution-4095a11e78de", "time": 1683002811.8690171, "path": "towardsdatascience.com/training-a-gan-to-sample-from-the-normal-distribution-4095a11e78de/", "webpage": {"metadata": {"title": "Training a GAN to Sample from the Normal Distribution | by Conor Lazarou | Towards Data Science", "h1": "Training a GAN to Sample from the Normal Distribution", "description": "In the original Generative Adversarial Network paper, Ian Goodfellow describes a simple GAN which, when trained, is able to generate samples indiscernible from those sampled from the normal\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1406.2661", "anchor_text": "paper", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Quantile_function", "anchor_text": "inverse CDF", "paragraph_index": 1}, {"url": "https://medium.com/intel-student-ambassadors/mnist-gan-detailed-step-by-step-explanation-implementation-in-code-ecc93b22dc60", "anchor_text": "handwritten digits", "paragraph_index": 1}, {"url": "https://medium.com/syncedreview/gan-2-0-nvidias-hyperrealistic-face-generator-e3439d33ebaf", "anchor_text": "human faces", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/MNIST_database", "anchor_text": "MNIST dataset", "paragraph_index": 2}, {"url": "https://towardsdatascience.com/this-will-change-the-way-you-look-at-gans-9992af250454", "anchor_text": "applying GANS to a 2-dimensional problem", "paragraph_index": 2}, {"url": "http://flatland.ai", "anchor_text": "flatland.ai", "paragraph_index": 18}], "all_paragraphs": ["In the original Generative Adversarial Network paper, Ian Goodfellow describes a simple GAN which, when trained, is able to generate samples indiscernible from those sampled from the normal distribution. This process is illustrated here:", "The simplest solution for this task is for the GAN to approximate the inverse CDF of the normal distribution, x=\u03a6\u207b\u00b9(z). This is an intuitive and appealing view of GANs: they are tools for randomly sampling from an unknown distribution given a set of samples. In the above example, this is the normal distribution. Others include the distribution of all handwritten digits and the distribution of all human faces. Describing the cumulative distribution function of human faces has proven to be a difficult task, which is why GANs and their ability to produce photo-realistic images of faces (among many other exciting results) have become such a hot topic.", "Unfortunately, it\u2019s easy to get caught up in the fervor and dive headfirst into complex GAN applications; most start their GAN journey with the MNIST dataset, despite its sample space of 784 dimensions. I previously explored applying GANS to a 2-dimensional problem, but found even that was too complex to properly visualize the distribution approximation. Therefore, I\u2019ve decided to take it back to the very basics with the first figure ever published in the GAN canon.", "We will be training a GAN to draw samples from the standard normal distribution N(0, 1). Thus, the samples x lie in the 1-dimensional sample space ranging from -\u221e to +\u221e. As a source of randomness, the GAN will be given values drawn from the uniform distribution U(-1, 1). Thus, the values z lie in the 1-dimensional latent space ranging from -1 to 1. Therefore, the GAN should come to approximate G(z)=\u03a6\u207b\u00b9(f(z)) such that f(z) has the U(0, 1) distribution. Possible realizations of f include:", "One of these mappings is obviously \u201cbest\u201d in that it is simple and interpretable. Applying the inverse CDF to these three functions results in the following:", "All three of these mappings transform z~U(-1,1) to x~N(0,1), but the blue curve is by far the simplest and most interpretable. Unfortunately, neural networks famously have no concern for either of these valuable traits.", "A simple, fully connected GAN was trained for 600 training steps (code available below). Measurements of the generator and discriminator were visualized after each step, and are depicted here:", "Both the generator and the discriminator use the binary cross-entropy loss (or logloss), which is visualized here alongside accuracy. After step 200, the two networks largely keep pace with each other for the remainder of training. It is well-known that generator loss does not correlate with GAN output quality, but it is nonetheless a useful metric to track; if either the generator or the discriminator significantly outperforms the other then the GAN will likely fail to converge.", "The top right panel displays the observed probability density of the GAN vs the real probability density of the standard normal distribution. Ideally, these two will line up exactly when training has completed. As you can see, there is a strong undulating behaviour as the GAN repeatedly over-corrects.", "The bottom left panel shows the real mapping used in this experiment as well as the mapping that the GAN has learned. As you can see, the GAN is approximating the unintuitive mapping \u03a6\u207b\u00b9((1-z)/2) with mixed success.", "This panel illustrates the discriminator\u2019s confidence that a value at this point in the sample space is real (that is, drawn from the real distribution, not the GAN). Two insights are immediately clear from the animation. First, the discriminator is fairly effective at identifying the relative frequency of real samples and fake samples throughout the sample space; where real samples outnumber fake samples, confidence increases, and vice versa. The second observation is that the extremes of the sample space, where real samples are rare, show huge fluctuations in confidence. This is reflected in the top right panel, in which an increase in confidence in the extreme region being real precipitates sample generation in that region (hence the undulating behaviour).", "The GAN was trained for 30000 steps in total, and learned to produce the following function:", "Given only a cursory glance at the GAN\u2019s output, it would indeed appear to be normally-distributed. However, by applying kernel density estimation (figure 5, top right) we see that the distribution is only a rough approximation. This shortcoming is obvious in the 1-dimensional setting, where the distribution can be easily visualized, but identifying the deviation between the \u201ctrue\u201d face generating function and that learned by a GAN is a much more difficult problem; indeed, in evaluating image-generating GANs, we often see that they produces various realistic samples and call that sufficient. Ensuring that GAN output and intermediate activations of the discriminator have similar statistical properties to real samples is an active area of research.", "The bottom left panel shows that the GAN has learned an unintuitive mapping from the latent space to the sample space, a problem which grows exponentially in higher-dimensional problems. This is unfortunate for two reasons: First, an ideal GAN would have its input correlate to a useful, human-interpretable features. In this case, that would be \u201cincreasing the latent value increases the sample value\u201d, when in practice we found the opposite occurred. In the case of generating human faces, it may be \u201cincreasing this latent feature increases nose size\u201d or \u201cincreasing that latent feature increases hair brightness\u201d. Instead, it is typical that the latent features are mapped to more than one sample features, such as nose size and hair colour, or that one sample feature is mapped to multiple latent features. This makes applying GANs for creative tasks difficult.", "The other problem is that the GAN may learn to map two nearby points in the latent space, say z=0.49 and z=0.51, to very distant points in the sample space (as was the case in figure 3 with the piece-wise function). This complicates training, because the intermediate value, z=0.50, will likely be mapped to some highly unrealistic intermediate point in the sample space. This was observed in my previous article on the same topic, and will be further explored in a forthcoming article.", "So there you have it; GAN training is never simple, not even in 1-dimensional problems. As a closing thought, I\u2019d like to reiterate my favourite piece of data science advice: visualize everything, no matter how much you think you know it. After all, the most exciting discoveries in science don\u2019t come from \u201ceureka!\u201d moments but rather \u201chuh, that\u2019s weird\u2026\u201d", "Code is available at the following github repo:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data science and ML consultant, generative artist, writer. flatland.ai"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4095a11e78de&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4095a11e78de--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4095a11e78de--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://conor-lazarou.medium.com/?source=post_page-----4095a11e78de--------------------------------", "anchor_text": ""}, {"url": "https://conor-lazarou.medium.com/?source=post_page-----4095a11e78de--------------------------------", "anchor_text": "Conor Lazarou"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdeb461dc9d26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&user=Conor+Lazarou&userId=deb461dc9d26&source=post_page-deb461dc9d26----4095a11e78de---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4095a11e78de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4095a11e78de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1406.2661", "anchor_text": "paper"}, {"url": "https://arxiv.org/pdf/1406.2661.pdf", "anchor_text": "Goodfellow 2014"}, {"url": "https://en.wikipedia.org/wiki/Quantile_function", "anchor_text": "inverse CDF"}, {"url": "https://medium.com/intel-student-ambassadors/mnist-gan-detailed-step-by-step-explanation-implementation-in-code-ecc93b22dc60", "anchor_text": "handwritten digits"}, {"url": "https://medium.com/syncedreview/gan-2-0-nvidias-hyperrealistic-face-generator-e3439d33ebaf", "anchor_text": "human faces"}, {"url": "https://en.wikipedia.org/wiki/MNIST_database", "anchor_text": "MNIST dataset"}, {"url": "https://towardsdatascience.com/this-will-change-the-way-you-look-at-gans-9992af250454", "anchor_text": "applying GANS to a 2-dimensional problem"}, {"url": "https://github.com/ConorLazarou/medium/blob/master/12020/visualizing_gan_uni2norm/1_uniform_to_normal_1D.py", "anchor_text": "ConorLazarou/mediumVisualizing GAN training as it learns to map U(-1, 1) to N(0, 1)github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4095a11e78de---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4095a11e78de---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/gan?source=post_page-----4095a11e78de---------------gan-----------------", "anchor_text": "Gan"}, {"url": "https://medium.com/tag/visualization?source=post_page-----4095a11e78de---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4095a11e78de---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4095a11e78de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&user=Conor+Lazarou&userId=deb461dc9d26&source=-----4095a11e78de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4095a11e78de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&user=Conor+Lazarou&userId=deb461dc9d26&source=-----4095a11e78de---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4095a11e78de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4095a11e78de--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4095a11e78de&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4095a11e78de---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4095a11e78de--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4095a11e78de--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4095a11e78de--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4095a11e78de--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4095a11e78de--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4095a11e78de--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4095a11e78de--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4095a11e78de--------------------------------", "anchor_text": ""}, {"url": "https://conor-lazarou.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://conor-lazarou.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Conor Lazarou"}, {"url": "https://conor-lazarou.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.1K Followers"}, {"url": "http://flatland.ai", "anchor_text": "flatland.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdeb461dc9d26&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&user=Conor+Lazarou&userId=deb461dc9d26&source=post_page-deb461dc9d26--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F51220adfabae&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftraining-a-gan-to-sample-from-the-normal-distribution-4095a11e78de&newsletterV3=deb461dc9d26&newsletterV3Id=51220adfabae&user=Conor+Lazarou&userId=deb461dc9d26&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}