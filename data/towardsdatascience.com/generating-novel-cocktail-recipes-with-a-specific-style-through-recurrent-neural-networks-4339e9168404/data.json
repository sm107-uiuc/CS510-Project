{"url": "https://towardsdatascience.com/generating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404", "time": 1682994444.4550111, "path": "towardsdatascience.com/generating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404/", "webpage": {"metadata": {"title": "Generating Novel Cocktail Recipes with a Specific Style through Recurrent Neural Networks | by Daniel Bojar | Towards Data Science", "h1": "Generating Novel Cocktail Recipes with a Specific Style through Recurrent Neural Networks", "description": "Deep learning is all the rage now. It\u2019s used in everything from diagnostics via pathology image classification to speech recognition used in Google Assistant or Amazon Echo. So it seems useful to at\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/explore-artificial-intelligence/an-introduction-to-recurrent-neural-networks-72c97bf0912", "anchor_text": "recurrent neural networks", "paragraph_index": 1}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "long short-term memory units", "paragraph_index": 1}, {"url": "http://www.wildml.com/2015/09/recurrent-neural-networks-tutorial-part-1-introduction-to-rnns/", "anchor_text": "Here", "paragraph_index": 1}, {"url": "http://cs.brown.edu/courses/csci2952d/readings/lecture1-firth.pdf", "anchor_text": "Firth", "paragraph_index": 2}, {"url": "https://www.deathandcompany.com/", "anchor_text": "Death & Co", "paragraph_index": 2}, {"url": "https://www.amazon.com/Death-Co-Modern-Classic-Cocktails/dp/1607745259", "anchor_text": "\u2018Death & Co: Modern Classic Cocktails, with More than 500 Recipes\u2019", "paragraph_index": 2}, {"url": "https://colab.research.google.com/", "anchor_text": "Colaboratory", "paragraph_index": 3}, {"url": "https://github.com/minimaxir/textgenrnn", "anchor_text": "textgenrnn", "paragraph_index": 3}, {"url": "https://github.com/karpathy/char-rnn", "anchor_text": "char-rnn", "paragraph_index": 3}, {"url": "https://ln.sync.com/dl/c05a4da40/mtxyvcah-tcfserys-spwidfbs-ebeemr2f", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://medium.com/@daniel_24692/rage-with-the-machine-tasting-cocktails-created-by-an-ai-5651d05ca6e0", "anchor_text": "my other article", "paragraph_index": 6}, {"url": "http://dbojar.com", "anchor_text": "dbojar.com", "paragraph_index": 10}], "all_paragraphs": ["Deep learning is all the rage now. It\u2019s used in everything from diagnostics via pathology image classification to speech recognition used in Google Assistant or Amazon Echo. So it seems useful to at least pick it up as a skill to implement into your workflow. And as every new skill you ever learn, it can be quite challenging to get started and to stay motivated throughout the learning curve. So what better way to motivate yourself than to choose cocktails as a subject of inquiry, where you may reward yourself with a delicious beverage upon the successful completion of your project?", "To make it brief: I planned to generate a program that can generate new cocktail recipes from scratch using deep learning in Python. For this, I chose recurrent neural networks (RNNs), a form of deep learning often used in natural language processing (NLP). More specifically, I used long short-term memory units (LSTMs) as units of the RNN to create an LSTM network. As their name suggests, LSTMs (and RNNs in general) have the advantage of memory which is particularly useful if you generate coherent text a character or word at a time and don\u2019t want to end up with a garbled mess. Here you can find an excellent introduction into RNNs for NLP, but briefly here\u2019s what happens for LSTMs: A single LSTM consists of a memory-containing cell, an input gate, an output gate and a forget gate. Simplistically speaking, the input and forget gate determine how much of incoming values transit to the output gate and the activation function of the gates is usually a logistic function. What we effectively learn with our input data are the weights of connections that influence the activity of these gates and hopefully generate awesome cocktails in the process!", "As with all such projects, data comes first. To generate cocktail recipes, you first need cocktail recipes so that your RNN can learn the correct embeddings (the \u2018company a word keeps\u2019 according to Firth) of ingredients and quantities etc. Of course you could, in theory, choose any cocktail recipes you come across for this but I decided to restrict myself to recipes from one specific bar to emulate their style with this AI algorithm. More specifically, I chose the famous bar Death & Co in New York City. Conveniently I own a physical copy of their highly recommended book \u2018Death & Co: Modern Classic Cocktails, with More than 500 Recipes\u2019 which I used to (manually) enter the ~500 recipes into a text file (one cocktail recipe each line, because what else do you do during the holidays). Importantly, I regularized the recipes while transcribing them. For us, the differences and commonalities of a Smith & Cross Rum or a Santa Teresa 1796 Rum may be obvious, especially in taste. Yet too many variants of something I simplistically labeled as \u2018brown rum\u2019 may rob the RNN of the opportunity to effectively learn the link between brown rum and, say, lime juice. I stripped brand names, clustered classes of ingredients and converted ounces, dashes and drops into the uniform milliliters. This of course also means that we may have to subsequently optimize generated recipes by trying out different versions of the category \u2018brown rum\u2019.", "Now that we have the data, we can get started with deep learning! One great resource to get started on this is Colaboratory, a free Jupyter notebook environment offered by Google. Next to being able to link your notebook to your Google Drive files you can use a free Tesla K80 GPU for your computations (much faster for neural networks than the CPU in laptops). For text generation with RNNs, textgenrnn is a highly effective tool based on Keras/TensorFlow. Before we start training we first need to set the hyperparameters which define the architecture of our model. To build the model, I combined five layers of LSTM layers which each had 128 memory cells with the gates described above. Additionally, I decided to use bidirectional LSTMs which take characters before as well as after the character of interest into account to strengthen the context-awareness of the RNN. After a semi-successful try with words as features I switched to an RNN version focusing on characters (more suitable for textgenrnn as it\u2019s based on char-rnn by Andrej Karpathy). Another important consideration for the eventual text generation is the question how many context characters the RNN should consider prior to generating the next character and which I set to 40.", "Now for each epoch, a full pass through the training data, the 40 context characters of every character are converted into their 100-dimensional embeddings and fed into and through the five LSTM layers. All five layers are also connected to an attention layer at the end. Loosely based on human attention, attention layers focus the network on certain regions of the surrounding characters while downplaying others and then shift their attention repeatedly. The final output of the RNN are then predicted probabilities for the next character. Here, I trained my RNN for 40 epochs, meaning 40 full passes through the training data. In the beginning, the RNN is not able to construct coherent words as seen in the examples. Yet at every step during the training process improvements in the cocktail recipe generation can be clearly seen and at the end, most words and usages seem correct. The largest problem can be seen with cocktail names, as the input names are mostly fictional and only occur once or twice (with the exception of suffixes such as \u2018\u2026 Daiquiri\u2019 or \u2018\u2026 Julep\u2019).", "Now the fun starts! After training for 40 epochs (which took about ~20 minutes on a GPU), the model is now ready for deployment. One detail that still has to be mentioned is temperature. Here, temperature is used as a stand-in for \u2018creativity\u2019 (the hotter the more creative) and determines how close the model creations will be to the input text. We can now take the model and, with a given temperature and a maximum length of the created recipes, generate an unlimited number of new cocktail recipes inspired by the Death & Co style. I personally like to have a mix of temperatures in my creations because it gives you a wider spectrum to choose from. Because you have to choose a bit as a few recipes won\u2019t make sense. Examples include the demand for \u2018176 ml of cinnamon syrup\u2019 or ingredients from a different universe such as \u201915 ml of laro werry\u2019. In general though, this truly is a great way to receive inspiration for new cocktail combinations and, by combining human and AI, the created recipes can be further tweaked to perfection.", "If you want to generate cocktail recipes yourself you can download the model weights, vocabulary and configuration for the described RNN here. Also, if you are interested what this cocktailAI generated and how they tasted, head over to my other article where I try some of these cocktails and delve into flavor combinations thought up by a machine. Here\u2019s just a brief teaser of one of the more intriguing creations, the abstrusely named Pon Cong where I filled in the brand of the gin and the detailed instructions. Cheers!", "Instructions: Muddle the strawberry with the gin and the syrup. Carefully strain the mixture into a mixing tin filled with ice cubes and stir. Carefully strain the mixture into a prechilled glass and garnish with a cut strawberry.", "Vanilla Syrup: Bring 1 cup of water and 1 cup of sugar to a boil with half a vanilla bean. Leave overnight; strain.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine Learning, Glycobiology, Synthetic Biology. Strong opinions, weakly held. Fascinated & Inspired by Counterintuitives. @daniel_bojar & dbojar.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4339e9168404&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4339e9168404--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4339e9168404--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@daniel_24692?source=post_page-----4339e9168404--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel_24692?source=post_page-----4339e9168404--------------------------------", "anchor_text": "Daniel Bojar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c2aa6d48d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&user=Daniel+Bojar&userId=1c2aa6d48d73&source=post_page-1c2aa6d48d73----4339e9168404---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4339e9168404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4339e9168404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/explore-artificial-intelligence/an-introduction-to-recurrent-neural-networks-72c97bf0912", "anchor_text": "recurrent neural networks"}, {"url": "http://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "long short-term memory units"}, {"url": "http://www.wildml.com/2015/09/recurrent-neural-networks-tutorial-part-1-introduction-to-rnns/", "anchor_text": "Here"}, {"url": "http://cs.brown.edu/courses/csci2952d/readings/lecture1-firth.pdf", "anchor_text": "Firth"}, {"url": "https://www.deathandcompany.com/", "anchor_text": "Death & Co"}, {"url": "https://www.amazon.com/Death-Co-Modern-Classic-Cocktails/dp/1607745259", "anchor_text": "\u2018Death & Co: Modern Classic Cocktails, with More than 500 Recipes\u2019"}, {"url": "https://colab.research.google.com/", "anchor_text": "Colaboratory"}, {"url": "https://github.com/minimaxir/textgenrnn", "anchor_text": "textgenrnn"}, {"url": "https://github.com/karpathy/char-rnn", "anchor_text": "char-rnn"}, {"url": "https://ln.sync.com/dl/c05a4da40/mtxyvcah-tcfserys-spwidfbs-ebeemr2f", "anchor_text": "here"}, {"url": "https://medium.com/@daniel_24692/rage-with-the-machine-tasting-cocktails-created-by-an-ai-5651d05ca6e0", "anchor_text": "my other article"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4339e9168404---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----4339e9168404---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/cocktails?source=post_page-----4339e9168404---------------cocktails-----------------", "anchor_text": "Cocktails"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----4339e9168404---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----4339e9168404---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4339e9168404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&user=Daniel+Bojar&userId=1c2aa6d48d73&source=-----4339e9168404---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4339e9168404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&user=Daniel+Bojar&userId=1c2aa6d48d73&source=-----4339e9168404---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4339e9168404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4339e9168404--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4339e9168404&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4339e9168404---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4339e9168404--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4339e9168404--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4339e9168404--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4339e9168404--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4339e9168404--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4339e9168404--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4339e9168404--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4339e9168404--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel_24692?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@daniel_24692?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Daniel Bojar"}, {"url": "https://medium.com/@daniel_24692/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "126 Followers"}, {"url": "http://dbojar.com", "anchor_text": "dbojar.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c2aa6d48d73&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&user=Daniel+Bojar&userId=1c2aa6d48d73&source=post_page-1c2aa6d48d73--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd2ae7c7ca71c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgenerating-novel-cocktail-recipes-with-a-specific-style-through-recurrent-neural-networks-4339e9168404&newsletterV3=1c2aa6d48d73&newsletterV3Id=d2ae7c7ca71c&user=Daniel+Bojar&userId=1c2aa6d48d73&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}