{"url": "https://towardsdatascience.com/hands-on-global-model-interpretation-3bb4264732b5", "time": 1682997531.577139, "path": "towardsdatascience.com/hands-on-global-model-interpretation-3bb4264732b5/", "webpage": {"metadata": {"title": "Hands-on Global Model Interpretation | by Gilbert Tanner | Towards Data Science", "h1": "Hands-on Global Model Interpretation", "description": "This article is a continuation of my series of articles on Model Interpretability and Explainable Artificial Intelligence. If you haven\u2019t, I would highly recommend you to check out the first article\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/introduction-to-machine-learning-model-interpretation-55036186eeab", "anchor_text": "\u2018Introduction to Machine Learning Model Interpretation\u2019", "paragraph_index": 0}, {"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "heart disease data-set", "paragraph_index": 1}, {"url": "https://christophm.github.io/interpretable-ml-book/feature-importance.html", "anchor_text": "Interpretable Machine Learning, A Guide for Making Black Box Models Explainable", "paragraph_index": 4}, {"url": "https://arxiv.org/abs/1801.01489", "anchor_text": "\u201cAll Models are Wrong but many are Useful \u2026\u201d", "paragraph_index": 7}, {"url": "https://christophm.github.io/interpretable-ml-book/feature-importance.html", "anchor_text": "use the training or testing set for calculating the feature importance", "paragraph_index": 9}, {"url": "https://christophm.github.io/", "anchor_text": "Christoph Molnar\u2019s", "paragraph_index": 11}, {"url": "https://christophm.github.io/interpretable-ml-book/", "anchor_text": "Interpretable Machine Learning", "paragraph_index": 11}, {"url": "https://www.kaggle.com/tannergi/heart-disease-analysis#Interpreting-models", "anchor_text": "Kaggle kernel", "paragraph_index": 14}, {"url": "https://scikit-learn.org/stable/auto_examples/ensemble/plot_forest_importances.html", "anchor_text": "Scikit-Learn,", "paragraph_index": 15}, {"url": "https://machinelearningmastery.com/feature-importance-and-feature-selection-with-xgboost-in-python/", "anchor_text": "XGBoost", "paragraph_index": 15}, {"url": "https://eli5.readthedocs.io/en/latest/", "anchor_text": "ELI5 library", "paragraph_index": 16}, {"url": "https://eli5.readthedocs.io/en/latest/tutorials/black-box-text-classifiers.html", "anchor_text": "text-explainer", "paragraph_index": 16}, {"url": "https://christophm.github.io/interpretable-ml-book/pdp.html", "anchor_text": "Interpretable Machine Learning", "paragraph_index": 24}, {"url": "https://github.com/SauceCat/PDPbox", "anchor_text": "PDPbox library", "paragraph_index": 25}, {"url": "http://eepurl.com/gq-u4X", "anchor_text": "join my newsletter", "paragraph_index": 36}], "all_paragraphs": ["This article is a continuation of my series of articles on Model Interpretability and Explainable Artificial Intelligence. If you haven\u2019t, I would highly recommend you to check out the first article of this series \u2014 \u2018Introduction to Machine Learning Model Interpretation\u2019 which covers the basics of Model Interpretability ranging from what model interpretability is, why we need it to the underlying distinctions of model interpretation.", "In this article, we will pick up where we left off by diving deeper into the ins and outs of global model interpretation. First we will quickly recap on what global model interpretation and why it is important. Then we will dive into the theory of two of it\u2019s most popular methods \u2014 feature importance and partial dependence plots \u2014 and apply them to get information about the features of the heart disease data-set.", "Global model interpretation is a set of techniques that helps us to answer questions like how does a model behave in general? What features drive predictions and what features are completely useless for your cause. Using this knowledge you can make decisions about the data collecting process, create dashboards to explain your model or use your domain knowledge to fix obvious bugs.", "Most global interpretation methods work by investigating the conditional interactions between the dependent variable and the independent variables (features) on the complete data-set. They also create and use extensive visualizations which are mostly easy to understand but contain a huge amount of useful information for analyzing your model.", "The importance of a feature is the increase in the prediction error of the model after we permuted the feature\u2019s values, which breaks the relationship between the feature and the true outcome. \u2014 Interpretable Machine Learning, A Guide for Making Black Box Models Explainable", "The concept of feature importance is really straightforward. Using feature importance we measure the importance of a feature by calculating the increase in the error of a given model after permuting/shuffling the feature values of a given feature.", "A feature is \u201cimportant\u201d if permuting it increases the model error. This is because in that case, the model relied heavily on this feature for making right prediction. On the other hand, a feature is \u201cunimportant\u201d if permuting it doesn\u2019t affect the error by much or doesn\u2019t change it at all.", "Fisher, Rudin, and Dominici suggest in their 2018 paper \u201cAll Models are Wrong but many are Useful \u2026\u201d that instead of randomly shuffling the feature you should split the feature in half and swap the halves.", "Feature importance is one of the most popular techniques to get a feel of the importance of a feature. This is because it is a simple technique that gives you highly compressed global insights about the importance of a feature. Also, it does not require retraining the model which is always an advantage because of the save of computing time.", "Even though feature importance is one of the go-to interpretation techniques which should be used almost all the time it still has some disadvantages. For instance, it isn\u2019t clear whether you should use the training or testing set for calculating the feature importance. Furthermore because of the permutation process results can vary heavily when repeating the calculation.", "Another problem is that correlation between features can bias feature importance by producing unrealistic instances or by splitting the importance between the two correlated features.", "For more information, I would highly recommend you to check out Christoph Molnar\u2019s e-book \u201cInterpretable Machine Learning\u201d which is an excellent read for learning more about interpreting models.", "What feature does a model think are important for determining if a patient has or doesn\u2019t have a heart disease?", "This question can be answered using feature importance.", "As I already mentioned at the start of the article we will work on the Heart Disease Data-set. You can find all the code used in this tutorial on my Github or as a Kaggle kernel.", "Most libraries like Scikit-Learn, XGBoost as well as other machine learning libraries already have their own feature importance methods but if you want to get exact results when working with models from multiple libraries it is advantageous to use the same method to calculate the feature importance for every model.", "To ensure this we will use the ELI5 library. ELI5 allows users to visualize and debug various Machine Learning Models. It offers way more than just feature importance including library-specific features as well as a text-explainer.", "To calculate the feature importance we can use the permutation_importance method. After calculating the feature importance of a given model we can visualize it using the show_weights method.", "Using the method above we can get the feature importance of models and compare them with each other.", "You can see that the two models have very different importance scores for a feature. This can have negative effects on the amount of trust you can have in the results.", "Nonetheless we can see that feature like ca, sex and thal are quite useful for getting to the right predictions whilst age and cp aren\u2019t important for getting to the right predictions.", "The partial dependence plot (short PDP or PD plot) shows the marginal effect one or two features have on the predicted outcome of a machine learning model \u2014 J. H. Friedman", "A partial dependence plot gives you information about how a feature affects the model\u2019s predictions. This can help us to understand what feature values tend to give us higher or lower outputs.", "The partial dependence can be calculated easily for categorical features. We get an estimate for each category by forcing all data instances to have the same category. For example, if we are interested in how gender affects the chance of having a heart disease we can first replace all values of the gender column with the value male and average the predictions and then to the same using female as the value.", "Calculating partial dependence for regression is way harder but Christoph Molnar explains it nicely in his ebook Interpretable Machine Learning. So if you are interested to go deeper into model interpretation be sure to check it out.", "For creating partial dependence plots we will use the PDPbox library. PDPbox provides us with a few different well-designed plots including partial dependence plots for a single feature as well as partial dependence plots for multiple features.", "To install PDPbox we can type:", "Now we can create a partial dependence plot to analyze the effect of the different genders on the probability of having a heart disease using the pdp_isolate and pdp_plot methods.", "The yellow and black line gives us the average effect on the predictions when changing the gender from sex_0 to sex_1. By only looking at this line we are able to see that patients with gender sex_0 are more likely to have a heart disease than patients with gender sex_1.", "To create a partial dependence plot that shows us the interaction effect of two features on the target we can use the pdp_interact and pdp_interact_plot methods.", "This can help us find interactions between two features or even individual feature values. For example we can see that no-matter the value of the gender column patients with an age between 55 and 63 have the lowest probability of having a heart disease.", "Global model interpretation are techniques that help us to answer questions like how does a model behave in general? What features drive predictions and what features are completely useless for your cause.", "The two most used global model interpretation techniques are feature importance and partial dependence plots.", "We can use feature importance to get an understanding of how important a model thinks a feature is for making predictions.", "Partial dependence plots help us understand how a specific feature value effects predictions. This is extremely useful because it allows you to get interesting inside about specific feature values which can then be further analyzed or shared.", "In part 3 of this series, we will take a closer look at understanding individual predictions by diving into what local model interpretation is and how two local model interpretation techniques\u2014 Lime and Shapely values \u2014 work.", "That\u2019s all from this article. If you have any questions or just want to chat with me feel free to leave a comment below or contact me on social media. If you want to get continuous updates about my blog make sure to follow me on Medium and join my newsletter.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3bb4264732b5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gilberttanner?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gilberttanner?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": "Gilbert Tanner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb986eefd54ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&user=Gilbert+Tanner&userId=b986eefd54ba&source=post_page-b986eefd54ba----3bb4264732b5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3bb4264732b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3bb4264732b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@bramnaus?utm_source=medium&utm_medium=referral", "anchor_text": "Bram Naus"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/introduction-to-machine-learning-model-interpretation-55036186eeab", "anchor_text": "\u2018Introduction to Machine Learning Model Interpretation\u2019"}, {"url": "https://www.kaggle.com/ronitf/heart-disease-uci", "anchor_text": "heart disease data-set"}, {"url": "https://christophm.github.io/interpretable-ml-book/feature-importance.html", "anchor_text": "Interpretable Machine Learning, A Guide for Making Black Box Models Explainable"}, {"url": "https://arxiv.org/abs/1801.01489", "anchor_text": "\u201cAll Models are Wrong but many are Useful \u2026\u201d"}, {"url": "https://christophm.github.io/interpretable-ml-book/feature-importance.html", "anchor_text": "use the training or testing set for calculating the feature importance"}, {"url": "https://christophm.github.io/", "anchor_text": "Christoph Molnar\u2019s"}, {"url": "https://christophm.github.io/interpretable-ml-book/", "anchor_text": "Interpretable Machine Learning"}, {"url": "https://www.kaggle.com/tannergi/heart-disease-analysis#Interpreting-models", "anchor_text": "Kaggle kernel"}, {"url": "https://scikit-learn.org/stable/auto_examples/ensemble/plot_forest_importances.html", "anchor_text": "Scikit-Learn,"}, {"url": "https://machinelearningmastery.com/feature-importance-and-feature-selection-with-xgboost-in-python/", "anchor_text": "XGBoost"}, {"url": "https://eli5.readthedocs.io/en/latest/", "anchor_text": "ELI5 library"}, {"url": "https://eli5.readthedocs.io/en/latest/tutorials/black-box-text-classifiers.html", "anchor_text": "text-explainer"}, {"url": "https://christophm.github.io/interpretable-ml-book/pdp.html", "anchor_text": "Interpretable Machine Learning"}, {"url": "https://github.com/SauceCat/PDPbox", "anchor_text": "PDPbox library"}, {"url": "http://eepurl.com/gq-u4X", "anchor_text": "join my newsletter"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3bb4264732b5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3bb4264732b5---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3bb4264732b5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/model-interpretation?source=post_page-----3bb4264732b5---------------model_interpretation-----------------", "anchor_text": "Model Interpretation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3bb4264732b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&user=Gilbert+Tanner&userId=b986eefd54ba&source=-----3bb4264732b5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3bb4264732b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&user=Gilbert+Tanner&userId=b986eefd54ba&source=-----3bb4264732b5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3bb4264732b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3bb4264732b5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3bb4264732b5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3bb4264732b5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3bb4264732b5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3bb4264732b5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3bb4264732b5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gilberttanner?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gilberttanner?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Gilbert Tanner"}, {"url": "https://medium.com/@gilberttanner/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.6K Followers"}, {"url": "https://gilberttanner.com/", "anchor_text": "https://gilberttanner.com/"}, {"url": "https://www.youtube.com/c/GilbertTanner", "anchor_text": "https://www.youtube.com/c/GilbertTanner"}, {"url": "http://buymeacoff.ee/gilberttanner", "anchor_text": "buymeacoff.ee/gilberttanner"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb986eefd54ba&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&user=Gilbert+Tanner&userId=b986eefd54ba&source=post_page-b986eefd54ba--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa3ff29165918&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-global-model-interpretation-3bb4264732b5&newsletterV3=b986eefd54ba&newsletterV3Id=a3ff29165918&user=Gilbert+Tanner&userId=b986eefd54ba&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}