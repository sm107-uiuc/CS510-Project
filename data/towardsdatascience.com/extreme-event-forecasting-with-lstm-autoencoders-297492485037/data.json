{"url": "https://towardsdatascience.com/extreme-event-forecasting-with-lstm-autoencoders-297492485037", "time": 1682996346.5491872, "path": "towardsdatascience.com/extreme-event-forecasting-with-lstm-autoencoders-297492485037/", "webpage": {"metadata": {"title": "Extreme Event Forecasting with LSTM Autoencoders | by Marco Cerliani | Towards Data Science", "h1": "Extreme Event Forecasting with LSTM Autoencoders", "description": "Dealing with extreme event prediction is a frequent nightmare for every Data Scientist. Looking around I found very interesting resources that deal with this problem. Personally, I literally fall in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://eng.uber.com/neural-networks/", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://arxiv.org/pdf/1709.01907.pdf", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://www.kaggle.com/neuromusic/avocado-prices", "anchor_text": "Avocado Prices Dataset", "paragraph_index": 6}], "all_paragraphs": ["Dealing with extreme event prediction is a frequent nightmare for every Data Scientist. Looking around I found very interesting resources that deal with this problem. Personally, I literally fall in love with the approach released by Uber Researchers. In their papers (two versions are available here and here) they developed an ML solution for daily future prediction of traveler demand. Their methodology stole my attention for its geniality, good explanation, and easy implementation. So my purpose is to reproduce their discovery in pythonic language. I\u2019m very satisfied with this challenge and in the end, I improved my knowledge of regression forecasting.", "The most important takeaways from this post can be summarized as:", "But Keep Kalm and let\u2019s proceed step by step.", "At Uber accurate prediction for completed trips (particularly during special events) provides a series of important benefits: more efficient driver allocation resulting in a decreased wait time for the riders, budget planning and other related tasks.", "In order to reach high accurate predictions of driver demand for ride-sharing, Uber Researchers developed a high-performance model for time series forecasting. They are able to fit (one-shot) a single model with a lot of heterogeneous time series, coming from different locations/cities. This process permits us to extract relevant time patterns. In the end, they were able to forecast demand, generalizing for different locations/cities, outperforming the classical forecasting methods.", "For this task Uber made use of an internal dataset of daily trips among different cities, including additional features; i.e. weather information and city-level information. They aimed to forecast the next day\u2019s demand from a fixed window of past observations.", "Unfortunately, we don\u2019t have at our disposal this kind of data, so we, as Kaggle Fans, chose the nice Avocado Prices Dataset. This data shows historical avocado prices, of two different species, and sales volume in multiple US markets.", "Our choice was due to the need for a nested dataset with temporal dependency: we have time series for each US market, 54 in total, a number that grows to 108 if we consider one time series for each type (conventional and organic). This data structure is highlighted as important by Uber Researchers because it permits our model to discover important invisible relations. Also, the correlation among series brings advantages for our LSTM Autoencoder during the process of feature extraction.", "To build our model we utilized the time series of prices at our disposal up to the end of 2017. The first 2 months of 2018 are stored and used as a test set. For our analysis, we will take into consideration also all the provided regressors. The observations are shown with a weakly frequency so our purpose is: given a fixed past window (4 weeks) of features, predict the upcoming weakly price.", "Due to the absence of exponential growth and trending behavior, we don\u2019t need to scale our price series.", "In order to solve our prediction task, we replicate the novel model architecture, proposed by Uber, which provides a single model for heterogeneous forecasting. As the below figure shows, the model first primes the network by auto feature extraction, training an LSTM Autoencoder, which is critical to capture complex time-series dynamics at scale. Features vectors are then concatenated with the new input and fed to LSTM Forecaster for prediction.", "Our forecasting workflow is easy to imagine: we have our initial windows of weekly prices (plus other features) for different markets. We start to train our LSTM Autoencoder on them; next, we remove the encoder and utilize it as a features creator. The second and final step required to train a prediction LSTM model for forecasting. Based on real/existing regressors and the previous artificial generated features, we are able to provide next week\u2019s avocado price prediction.", "We easily recreate this logic with Keras.", "Our LSTM Autoencoder is composed of a simple LSTM encoder layer, followed by another simple LSTM decoder. You will understand the utility of dropout during the evaluation, at this point they are harmless, trust me!", "We compute features extraction and concatenate the result with other variables. At this point I made a little deviation from the Uber solution: they suggest manipulating the feature vectors extracted by our encoder aggregating them via an ensemble technique (e.g., averaging). I decided to let them original and free. I make this choice because it permits me to achieve better results in my experiments.", "In the end, the prediction model is another simple LSTM based neural network:", "Finally, we are almost ready to see some results and make predictions. The last steps involve the creation of a rival model and the consequence definition of a robust forecasting methodology for results comparison.", "Personally, the best way to evaluate two different procedures is to replicate them as much as possible, in order to mark attention only at the points of real interest. In this implementation, I want to show evidence of LSTM Autoencoder power as a tool for relevant feature creation for time series forecasting. In this sense, to evaluate the goodness of our methodology, I decided to develop a new model for price forecasting with the same structure as our previous forecasting NN.", "The only difference between them is the features they received as input. The first one receives the encoder output plus the external regressors; the second one receives past raw prices plus the external regressors.", "Time series forecasting is critical in nature for the extreme variability of the domain of interest. In addition, if you try to build a model based on Neural Network your results are also subject to internal weight initialization. To overcome this drawback a number of approaches exist for uncertainty estimation: from Bayesian to those based on the bootstrap theory.", "In their work Uber Researchers combine Bootstrap and Bayesian approaches to produce a simple, robust and tight uncertainty bound with good coverage and provable convergence properties.", "This technique is extremely simple and practical\u2026 indirectly we have already implemented it! As you can see in the figure below, during the feedforward process, dropout is applied to all layers in both the encoder and the prediction network. As a result, the random dropout in the encoder perturbs the input intelligently in the embedding space, which accounts for potential model misspecification and gets further propagated through the prediction network.", "Pythonic speaking we have simply to add trainable dropout layers in our Neural Network and reactivate them during prediction (Keras used to cut dropout during prediction).", "For the final evaluation, we must iterate the calling of the prediction function and store the results. I also compute the scoring of the prediction at each interaction (I chose Mean Absolute Error). We must set the number of times we compute evaluation (100 times in our case). With the scores stored, we are able to compute the mean, the standard deviation, and the relative uncertainty of MAE.", "We replicate the same procedure for our \u2018rival model\u2019 made by only the LSTM prediction network. After averaging scores and computing uncertainty, the final results are better for the LSTM Autoencoder + LSTM Forecaster instead of the single LSTM Forecaster.", "In this post, I replicate an end-to-end neural network architecture developed at Uber for special event forecasting. I want to emphasize: the power of LSTM Autoencoder in the role of feature extractor; the scalability of this solution to generalize well avoiding training multiple models for every time series; the ability to provide a stable and profitable method for neural networks evaluation.", "I also remark that this kind of solution suits well when you have at your disposal an adequate number of time series that share common behaviors\u2026 It\u2019s not important that these are immediately visible, the Autoencoder makes this for us.", "[1] Deep and Confident Prediction for Time Series at Uber: Lingxue Zhu, Nikolay Laptev", "[2] Time-series Extreme Event Forecasting with Neural Networks at Uber: Nikolay Laptev, Jason Yosinski, Li Erran Li, Slawek Smyl", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F297492485037&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----297492485037--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----297492485037--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----297492485037--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----297492485037--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----297492485037---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F297492485037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F297492485037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nurafnisetiyaningrum?utm_source=medium&utm_medium=referral", "anchor_text": "Nur Afni Setiyaningrum"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://eng.uber.com/neural-networks/", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1709.01907.pdf", "anchor_text": "here"}, {"url": "https://www.kaggle.com/neuromusic/avocado-prices", "anchor_text": "Avocado Prices Dataset"}, {"url": "http://roseyu.com/time-series-workshop/submissions/TSW2017_paper_3.pdf", "anchor_text": "Time-series Extreme Event Forecasting with Neural Networks at Uber"}, {"url": "http://roseyu.com/time-series-workshop/submissions/TSW2017_paper_3.pdf", "anchor_text": "Time-series Extreme Event Forecasting with Neural Networks at Uber"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----297492485037---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----297492485037---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/lstm?source=post_page-----297492485037---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/autoencoder?source=post_page-----297492485037---------------autoencoder-----------------", "anchor_text": "Autoencoder"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----297492485037---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F297492485037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&user=Marco+Cerliani&userId=c843902314c7&source=-----297492485037---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F297492485037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&user=Marco+Cerliani&userId=c843902314c7&source=-----297492485037---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F297492485037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----297492485037--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F297492485037&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----297492485037---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----297492485037--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----297492485037--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----297492485037--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----297492485037--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----297492485037--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----297492485037--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----297492485037--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----297492485037--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-event-forecasting-with-lstm-autoencoders-297492485037&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}