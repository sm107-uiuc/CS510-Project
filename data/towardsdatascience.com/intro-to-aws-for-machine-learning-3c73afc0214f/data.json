{"url": "https://towardsdatascience.com/intro-to-aws-for-machine-learning-3c73afc0214f", "time": 1683008952.40468, "path": "towardsdatascience.com/intro-to-aws-for-machine-learning-3c73afc0214f/", "webpage": {"metadata": {"title": "Intro to AWS for Machine Learning | by Luke Betham | Towards Data Science", "h1": "Intro to AWS for Machine Learning", "description": "Creating powerful algorithms couldn\u2019t be easier with scikit-learn and tensor-flow, however, tuning them properly can take time; almost all of the models have thousands of different parameter\u2026"}, "outgoing_paragraph_urls": [{"url": "https://youtu.be/RbLbDO0CtrM", "anchor_text": "good setup video here", "paragraph_index": 1}, {"url": "https://aws.amazon.com/marketplace/pp/netCubed-Machine-Learning-Workbench/B07MP6Y8XT", "anchor_text": "Machine Learning Workbench page", "paragraph_index": 2}, {"url": "https://aws.amazon.com/marketplace/pp/netCubed-Machine-Learning-Workbench/B07MP6Y8XT", "anchor_text": "Machine Learning Workbook link", "paragraph_index": 3}, {"url": "https://console.aws.amazon.com/ec2/v2/home?region=us-east-1#Instances:sort=instanceId", "anchor_text": "EC2 instances screen", "paragraph_index": 7}, {"url": "https://ipv4/", "anchor_text": "https://IPv4", "paragraph_index": 8}, {"url": "https://console.aws.amazon.com/ec2/v2/home?region=us-east-1#Instances:sort=instanceId", "anchor_text": "EC2 instance screen", "paragraph_index": 13}], "all_paragraphs": ["Creating powerful algorithms couldn\u2019t be easier with scikit-learn and tensor-flow, however, tuning them properly can take time; almost all of the models have thousands of different parameter combinations. In addition, a good rule of thumb to improving your model is to increase the amount of data you are using to train \u2014 predictors or observations. Therefore, even if you have the latest MacBook Pro, you will quickly find yourself looking at a parametrisation gridsearches which can take hours, if not days. Luckily it is simple to farm out all of your processing to a computer in an AWS warehouse somewhere in Ohio!", "The first step will be to set up an AWS account and download your key file to a safe place on your computer. Setting up an AWS account is straightforward, however, there is a good setup video here if you get stuck. Bear in mind you will need to give credit card details even if you are signing up for the 12 month free trial as not everything is included in the trial.", "Cost: For my most recent project, I used a medium sized instance for multiple days of processing and the total bill came to about 4 dollars. You can turn the instance off when you are not using it, and the costs per hour are pretty cheap. The cost fully depends on the power of the instance you are renting, which ranges from ~5 cents per hour for an instance with 2cores at 2gb memory to about ~30 dollars per hour for a monster supercomputer with 96cores at 768gb memory. If you want an estimate of costs, just go to the bottom of the Machine Learning Workbench page.", "Once you have your AWS account up and running, you are ready to get started. The Machine Learning Workbench is simply an EC2 instance which has been already configured with Jupyter, Jupyter Notebooks, Scikit-learn, Tensorflow and many of the standard python packages like pandas and matplotlib. In order to get it set up, follow this Machine Learning Workbook link.", "Once there, follow the steps to continue to subscribe, accept the terms, continue to configuration and then continue to launch. It gives you the option to pay for a years subscription, but you can ignore this for now, if you follow through, it will allow you to simply rent the instance by the hour. Once you are through to the \u201cLaunch this software\u201d screen, I find it more straightforward to set up the instance through EC2, so select this option as below.", "From here, you will be given the option to choose the computing power you require. There are many additional configurations you can select at this stage, but the simplest is to click straight on \u201cReview and Launch\u201d in the bottom right and then click \u201cLaunch\u201d again. At this point it will ask you which key pair you want to set up this instance. This is required in order to be able to remote in to the EC2 instance from your command line. If you already have a key pair you use for AWS, use this, otherwise create a new key pair.", "Once you have downloaded the new key pair, it will allow you to click on \u201cLaunch Instance\u201d. You have now created your EC2 Machine learning instance and it will start to configure itself in the background!", "From the easiest way to track the instance setup is to click directly on the instance id. However if you navigate away from the page, you can always get back to it by going back to your EC2 instances screen. If you go back to your EC2 instances after launching it and you don\u2019t see your instance there, double check that you are in the correct region, you may have set up your workbench in a different region. You can find all of the regions in the top right of the EC2 screen.", "Once the instance has a green light in the instance state you are good to open the instance. The easiest way to do this is directly from the browser. In order to do this, in a new browser tab, just type in \u2018https://IPv4 Public IP\u2019 and press enter, where IPv4 Public IP is the public IP number underlined below. If you hover on the right of the number you can copy by clicking on the icon. Once you navigate to this IP address you are likely to get a warning from your browser letting you know the connection is not private. Depending on which browser you are using, follow the advanced options to ignore the error and proceed to your instance. If you are struggling to get through, try with another browser, as they may have different security settings.", "Once you are through, it should take you to this login screen. The password to login is your Instance ID highlighted above. You can connect directly to the virtual desktop or go straight into Jupyter Notebook to start training your model. It should take a minute of so to login the first time, but then you will have a jupyter notebook session ready to go!", "If you got in without any issues, skip this bit! However, if you are struggling to connect to the IP address and it keeps timing out, most likely the security group for the EC2 instance wasn\u2019t automatically set up correctly. This is easy enough to fix, just follow the steps below.", "The simplest method for loading data into your instance is by using the handy upload button, see below. This allows you to quickly and easily upload data directly from your laptop to the remote instance. Once your data and notebooks are uploaded, open up the notebook and start running the code!", "It should be noted however that if you need to upload very large files, it can be expensive and slow to do upload this way. Or the files might not be on you computer but be stored safely in a S3 bucket. No fear, it is also possible to load files directly from an S3 bucket. If you haven\u2019t encountered this before, and S3 bucket is simply a storage box for data and files, secure and easy to access from anywhere. This tutorial doesn\u2019t cover setting up S3 buckets, but this is easy to do and there are many instructions already online for this.", "If you want to access an S3 bucket directly from your jupyter notebook in your Machine Learning Workbench, you will first need to grant access to this instance to access your S3 bucket. The simplest way to do this is to log directly into the instance from you local computer using the command line. To do this, go back to the EC2 instance screen, select your instance and press connect. It will open up the below screen. Copy the example as highlighted below (yours will be different). Copy this command into the command line, make sure that you replace the 3rd item with the full filepath for your secret key file and replace the word \u201croot\u201d with \u201cubuntu\u201d. Press enter and you should log directly into your instance. If it asks you if you want to continue, type \u201cyes\u201d.", "If you get and error which says that your Private Key File is Unprotected, protect the file by running the command line command below and then try againchmod 400 New_Key_Pair.pemReplace the last item in the command with the full filepath for the your secret key file.", "Once you are in your command line should look like the above. From here \u2014 to authorise your S3 bucket run the below command line command:", "Then all you need to do is input the Key ID and Secret Key and you will be set up and ready to go! This means that you will be able to import files into your instance directly from S3. There are many more resources on how to do this on AWS, but below are a few common commands for using S3 from an EC2 instance:", "List your AWS Buckets:aws s3 ls", "Move file (or whole folder!) into bucket:aws s3 cp /Documents/data.csv s3://bucket/folder_name", "You can copy files the other way round by:aws s3 cp s3://bucket/file_to_copy file_to_copy", "If you wanted instead to give a full pathname that would look like:aws s3 cp s3://bucket/file_to_copy ~/folder/subfolder/.", "Once you are done with configuring the instance in your command line, just type exit in the command line and it will close the connection.", "A common error I have seen with people moving their notebooks over to AWS for speeding up their processing times is when they start running the code, they forget to adapt the code know to utilise all of the new computer. They copy over their notebook to a more powerful computer with 8 cores and then are surprised that the Gridsearching is taking just as long\u2026", "For example, sklearn has a parameter in most of its model functions called n_jobs which allows you to specify how many cores you want to use for training the model. The default for this is None, which means it will only use 1 core. If you don\u2019t change this default, moving to a computer with more cores will make no difference. You can manually set this to the number of cores you want to use, or simply put in -1, which will look to use all available cores.", "Be aware that n_jobs might not be the only limiting factor. Some solvers will not support multiprocessing and so will ignore your n_jobs input (e.g. the Sag solver with sklearn LogisticRegression).", "So you have your data on a the workbench, you are ready to start training your model, but what if, even with the additional AWS computing power, it looks like your gridsearch is going to take days. The drawback to logging into your machine learning workbench jupyter notebook is that if you quit the notebook, it isn\u2019t going to keep running in the background. If you shut the jupyter notebook it will interrupt the process and you will have to start from scratch. You have 3 real options here.", "Remember to do this! If you forget, you can quite easily rack up a chunky bill, so don\u2019t go on holiday before closing down your instances. You have two options here, stopping the instance and terminating it.", "In both cases, the instance will be shutdown and your virtual machine will be permanently removed and you will no longer be charged for instance usage. In both cases you lose any data saved on the ephemeral storage of the instance. The key difference between stopping and terminating an instance is that when you stop, the attached bootable EBS volume will not be deleted. This means the instance will still exist in your EC2 instances window, and you can start it up again anytime with the same setup and settings as before. However note if you do start it again, the connection path and IP address for connection will change. Also note that there can be charges for keeping an EBS volume in stopped state (though the charges will be minimal and during the free trial a lot of them are free), but bear in mind that if you plan on leaving it stopped for a long period of time you will be better of terminating the instance.", "There you go! The basics to using AWS computing power for your machine learning tasks \u2014 a great way to speed up any data science project.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist with 6 years experience working in an investment bank. Currently a teaching associate at General Assembly."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3c73afc0214f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@Lukebetham?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Lukebetham?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": "Luke Betham"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F75c80a6aa4a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&user=Luke+Betham&userId=75c80a6aa4a0&source=post_page-75c80a6aa4a0----3c73afc0214f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c73afc0214f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c73afc0214f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://youtu.be/RbLbDO0CtrM", "anchor_text": "good setup video here"}, {"url": "https://aws.amazon.com/marketplace/pp/netCubed-Machine-Learning-Workbench/B07MP6Y8XT", "anchor_text": "Machine Learning Workbench page"}, {"url": "https://aws.amazon.com/marketplace/pp/netCubed-Machine-Learning-Workbench/B07MP6Y8XT", "anchor_text": "Machine Learning Workbook link"}, {"url": "https://console.aws.amazon.com/ec2/v2/home?region=us-east-1#Instances:sort=instanceId", "anchor_text": "EC2 instances screen"}, {"url": "https://ipv4/", "anchor_text": "https://IPv4"}, {"url": "https://console.aws.amazon.com/ec2/v2/home?region=us-east-1#Instances:sort=instanceId", "anchor_text": "EC2 instance screen"}, {"url": "https://console.aws.amazon.com/ec2/v2/home?region=us-east-1#Instances:sort=instanceId", "anchor_text": "EC2 instance screen"}, {"url": "https://www.linode.com/docs/networking/ssh/persistent-terminal-sessions-with-tmux/", "anchor_text": "get set up here"}, {"url": "https://medium.com/tag/aws?source=post_page-----3c73afc0214f---------------aws-----------------", "anchor_text": "AWS"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3c73afc0214f---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3c73afc0214f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/jupyter-notebook?source=post_page-----3c73afc0214f---------------jupyter_notebook-----------------", "anchor_text": "Jupyter Notebook"}, {"url": "https://medium.com/tag/modelling?source=post_page-----3c73afc0214f---------------modelling-----------------", "anchor_text": "Modelling"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3c73afc0214f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&user=Luke+Betham&userId=75c80a6aa4a0&source=-----3c73afc0214f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3c73afc0214f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&user=Luke+Betham&userId=75c80a6aa4a0&source=-----3c73afc0214f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3c73afc0214f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3c73afc0214f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3c73afc0214f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3c73afc0214f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3c73afc0214f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3c73afc0214f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3c73afc0214f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Lukebetham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@Lukebetham?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luke Betham"}, {"url": "https://medium.com/@Lukebetham/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F75c80a6aa4a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&user=Luke+Betham&userId=75c80a6aa4a0&source=post_page-75c80a6aa4a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F75c80a6aa4a0%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintro-to-aws-for-machine-learning-3c73afc0214f&user=Luke+Betham&userId=75c80a6aa4a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}