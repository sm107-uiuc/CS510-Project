{"url": "https://towardsdatascience.com/understanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42", "time": 1683000632.8062022, "path": "towardsdatascience.com/understanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42/", "webpage": {"metadata": {"title": "Optimising a Machine Learning Model with the Confusion Matrix | by Rebecca Vickery | Towards Data Science", "h1": "Optimising a Machine Learning Model with the Confusion Matrix", "description": "The confusion matrix, in machine learning, is a grid of values that help to evaluate the performance of supervised classification models. From this grid, you can also compute a number of metrics to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas-ml.readthedocs.io/en/latest/conf_mat.html", "anchor_text": "pandas_ml", "paragraph_index": 11}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV", "anchor_text": "parameter", "paragraph_index": 28}, {"url": "https://stackabuse.com/cross-validation-and-grid-search-for-model-selection-in-python/", "anchor_text": "cross-validated grid-search", "paragraph_index": 28}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_breast_cancer.html", "anchor_text": "scikit-learn", "paragraph_index": 30}, {"url": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5", "anchor_text": "good one", "paragraph_index": 41}], "all_paragraphs": ["The confusion matrix, in machine learning, is a grid of values that help to evaluate the performance of supervised classification models. From this grid, you can also compute a number of metrics to give a score for the model these include precision, recall and the F1-score. Although on the surface this grid is quite simple, and the measures require only high-school level mathematics to calculate the concepts behind the matrix can be difficult to grasp.", "In the following post I will give a simple introduction to the following:", "For this explanation let\u2019s suppose we were working on a binary classification problem to detect whether or not a transaction is fraudulent. Our model uses characteristics of the user and transaction and returns 1 if the transaction is predicted to be fraudulent and 0 if not.", "Given that machine learning models are rarely 100% accurate there is going to be a level of risk in deploying this model. If we incorrectly classify a non-fraudulent transaction as fraud then we may well lose that transaction, and possibly even the future customers business. On the other hand, if we incorrectly detect a fraudulent transaction as non-fraudulent then we might stand to lose the value of that transaction.", "The confusion matrix essentially places the resulting predictions into four groups. They are as follows:", "True positive (TP): the model predicts fraud and the transaction is indeed fraudulent.", "False positive (FP): the model predicts fraud but the transaction is not fraudulent.", "True negative (TN): the model predicts not fraud and the transaction is not fraudulent.", "False negative (FN): the model predicts not fraud but the transaction is in fact fraudulent.", "To illustrate how a confusion matrix looks I am going to be using some manufactured data.", "There are a few python libraries that make constructing confusion matrices fairly simple, below are a couple of examples;", "The pandas_ml library produces a more readable output.", "Let\u2019s use the grid to determine the numbers for each of the 4 groups we discussed above.", "There are 3 samples where the model predicted fraud and the transaction is fraudulent, so TP = 3. This is the number in the bottom right-hand corner where the row and column are both True.", "There is 1 sample where the model predicted fraud but the transaction was not fraudulent, so FP = 1.", "There are 2 samples where the model predicted not fraud but the transaction was fraudulent, so FN = 2.", "There are 4 samples where the model correctly predicted not fraud and the transaction was fraudulent, so TN = 4.", "If we were in a business and a model such as this was going to be deployed and used to drive a value outcome there are a few things that the confusion matrix can help to determine. These include:", "How good is the model at determining a fraudulent transaction?", "How good is the model at differentiating a fraudulent transaction and a non-fraudulent transaction?", "How many times does the model incorrectly predict that a fraudulent transaction is not fraudulent?", "The measures that I mentioned earlier that you can derive from the confusion matrix can help to answer these questions.", "There are a number of metrics that can be derived from the confusion matrix which all measure the performance of the model. I am going to cover explanations for three of the most commonly used.", "Precision: This is essentially a measure of out of all the samples predicted to be fraud how many were correct. The calculation is, therefore;", "Recall (sensitivity): This is a measure of for those samples that were fraudulent how many were correctly predicted as fraudulent.", "The difference between these two metrics is subtle but very important. If we optimise for precision then we will get fewer false positives (fewer non-fraudulent transactions classified as fraud), 0 false positives would give a perfect score of 1. If we optimise for recall then we get fewer false negatives so we are catching more fraudulent transactions but this may be at the detriment of incorrectly classifying more non-fraudulent transactions as fraud.", "F1-score: is what is known as the \u2018harmonic average\u2019 of precision and recall.", "The F1-score, therefore, gives a good indicator of the overall accuracy of a classifier, whilst precision and recall give information about the areas in which specifically the model is performing well or not so well. Maximising the F1 score would create a balanced model which has the optimal score for both precision and recall. Which metric you choose to optimise for will very much depend on the use case.", "There are several methods that tune a machine learning model for a particular metric that suits your specific use case. One example is the scikit-learn GridSearchCV which has a scoring parameter which allows you to select a given metric. This function performs cross-validated grid-search over a parameter grid and returns the optimal parameters for the model based on the scoring metric you provide.", "In the next part of this post, I will walk through an example of optimising a model using GridSearchCV . First import the relevant libraries.", "For this example, I am going to use a simple data set which consists of attributes for a sample of patients and an indicator describing whether or not they have breast cancer. This can be obtained directly from scikit-learn using the code below.", "In this dataset, the malignant class is actually the negative class. To make the resulting confusion matrix easier to interpret I will relabel them so that the malignant class is positive.", "Next, I am splitting the data into test and train sets.", "I will then train a simple logistic regression model and use the model to make some predictions.", "The confusion matrix looks like this.", "The model performs quite well for all metrics. However, if we were going to use this model in place of a doctors diagnosis for breast cancer then even 8 false negatives would be too many. So for this use case we would want to minimise false negatives and therefore want to optimise the model for recall. Now we are going to implement GridSearchCV and optimise the model for this metric.", "First, we create a hyperparameter search space for two selected LogisticRegression parameters.", "We then call the logistic regression model and call GridSearchCV with the scoring parameter selected as recall.", "Now we fit GridSearchCV and print the best parameters for recall.", "Let\u2019s now print the confusion matrix and metrics for the best model.", "You can see from these results that the recall score is now higher and we have also improved both precision and recall. The model is now better at predicting the correct labels both for malignant and benign cases.", "There are many other metrics that are important to fully evaluate the performance of a classification model including specificity, AUC and ROC. However, I think those require an article of their own \u2014 this is a good one.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | Writer | Speaker"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc4e8aaf37f42&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://me.dm/@rebeccalvickery", "anchor_text": "Mastodon"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rebeccalvickery.medium.com/?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": ""}, {"url": "https://rebeccalvickery.medium.com/?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": "Rebecca Vickery"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8b7aca3e5b1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=post_page-8b7aca3e5b1c----c4e8aaf37f42---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4e8aaf37f42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4e8aaf37f42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@tomthompsonphotography?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Thomas Thompson"}, {"url": "https://unsplash.com/s/photos/tune?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html", "anchor_text": "Scikit-learn"}, {"url": "https://pandas-ml.readthedocs.io/en/latest/conf_mat.html", "anchor_text": "pandas_ml"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV", "anchor_text": "parameter"}, {"url": "https://stackabuse.com/cross-validation-and-grid-search-for-model-selection-in-python/", "anchor_text": "cross-validated grid-search"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_breast_cancer.html", "anchor_text": "scikit-learn"}, {"url": "https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5", "anchor_text": "good one"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c4e8aaf37f42---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----c4e8aaf37f42---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/statistics?source=post_page-----c4e8aaf37f42---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----c4e8aaf37f42---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c4e8aaf37f42---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4e8aaf37f42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=-----c4e8aaf37f42---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc4e8aaf37f42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=-----c4e8aaf37f42---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc4e8aaf37f42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc4e8aaf37f42&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c4e8aaf37f42---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c4e8aaf37f42--------------------------------", "anchor_text": ""}, {"url": "https://rebeccalvickery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rebeccalvickery.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rebecca Vickery"}, {"url": "https://rebeccalvickery.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "21K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8b7aca3e5b1c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=post_page-8b7aca3e5b1c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F558d5c99b70b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-the-confusion-matrix-and-its-business-applications-c4e8aaf37f42&newsletterV3=8b7aca3e5b1c&newsletterV3Id=558d5c99b70b&user=Rebecca+Vickery&userId=8b7aca3e5b1c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}