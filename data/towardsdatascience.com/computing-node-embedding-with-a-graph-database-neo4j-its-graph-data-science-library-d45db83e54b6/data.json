{"url": "https://towardsdatascience.com/computing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6", "time": 1683010764.800183, "path": "towardsdatascience.com/computing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6/", "webpage": {"metadata": {"title": "Computing Node Embedding with a Graph Database: Neo4j & its Graph Data Science Library | by Estelle Scifo | Towards Data Science", "h1": "Computing Node Embedding with a Graph Database: Neo4j & its Graph Data Science Library", "description": "Machine Learning these days is all about vectors. Performing a classification task requires that your data is well-arranged into rows (observations), each one containing the same amount of features\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/stellasia/pygds", "anchor_text": "pygds", "paragraph_index": 27}, {"url": "https://www.linkedin.com/in/estellescifo/", "anchor_text": "https://www.linkedin.com/in/estellescifo/", "paragraph_index": 38}], "all_paragraphs": ["Machine Learning these days is all about vectors. Performing a classification task requires that your data is well-arranged into rows (observations), each one containing the same amount of features (columns). While this is easy to obtain from data originally stored in an Excel sheet or in SQL or noSQL databases, the transformation is far from obvious when the problem involves complex objects such as texts, images or graphs.", "For these objects to be represented as vectors, embedding techniques are used. Embedding algorithms assign a vector with given \u201csmall\u201d size to each of these complex objects that would require thousands (at least) of features otherwise. The challenge of embedding is to preserve some characteristics of the object you are trying to model, while reducing the number of features. For instance, word embedding will try and capture the word meaning, such that words semantically close to each other have similar vector representations.", "Graph embedding covers several techniques, depending on the objects to be represented. The most common ones are node embedding, where the entities to be represented as vectors are nodes, but we can also find edge embedding or whole-graph embedding. This post will focus on the former one, node embedding.", "The primary purpose of graph databases is to make relationships easier to manage, whether we are talking about a web application with complex ManyToMany relationships, or graph data science. Interest for this kind of store is almost constantly increasing, especially since the Cypher query language has been introduced into Neo4j.", "Cypher makes it so easy to write intuitive queries. For instance, I am sure you will get instantaneously what this query is doing:", "A few things to note from the above query:", "Convinced to give a try to Neo4j? You have two ways to do it:", "In both cases, this is totally free. I\u2019ll be using the later in this blog, creating a new graph using Neo4j 4.1.", "Let\u2019s import some data into our graph. To do so, we are going to use the \u201cGame Of Thrones\u201d dataset using the got browser guide. Type:", "in the browser, and follow the instructions.", "Once you have imported the data, the graph schema looks like this:", "It contains one node label, Character , and five relationship types depending on which book the characters were found to interact with each other, and a global INTERACTS relationship. We are going to use only the last one for the rest of this post. If you want to visualize some of the data, you can use:", "Let\u2019s go ahead and proceed to the graph analysis and node embedding.", "The GDS is the successor of the Graph Algorithm plugin whose first release date back to 2018. It\u2019s goal is to enable the use of graph algorithms, from path finding algorithms to graph neural networks, without having to extract data from Neo4j.", "The Neo4j graph usually contains a lot of data: nodes with different labels, relationships with different types and properties attached to them. Most of the time, a data science algorithm requires only a small portion of these entities: only some node labels or some relationship type and only one property (relationship weight for shortest path algorithm for instance). That\u2019s why the GDS does not run on the full Neo4j graph, but on a projected (lighter) version. So, let\u2019s start and build our projected graph. In the Neo4j browser, execute:", "Here we create a projected graph named MyGraph, containing all nodes with label Character. Additionally, we add to this projected graph relationships with type INTERACTS.", "Here we are, our projected graph is created, we can go ahead and execute algorithms on it.", "The simplest way to run the node2vec algorithm on the MyGraph projected graph is to use this simple query:", "The result in the browser looks like the following image, where a list of numbers gets assigned to each node (identified by its internal Neo4j ID, nodeId):", "If you know a bit about how node2vec works, you know there are many configuration parameters to configure how:", "The full list of parameters is reproduced below, from the GDS documentation page.", "Let\u2019s try for instance to reduce the embedding size:", "Without surprise, the output now looks like:", "Before dealing with the usage of these results, let\u2019s see how to use another embedding algorithm, GraphSAGE.", "While Node2vec only takes into account the graph structure, GraphSAGE is able to consider node properties, if any.", "In our GoT graph, nodes only have a name property which is not that meaningful for embedding. We will then use only the node degree, or number of relationships attached to it, as property:", "The full list of parameters includes configuration of the properties (nodePropertyNames), the aggregator function (mean by default), the batch size\u2026 See image below for a full list.", "Neo4j provides a python driver that can be easily installed through pip. However, in this post, I will talk about a small tool that I have developed allowing to call GDS procedures from Python without effort: pygds. It still needs to be heavily tested, so feel free to report issues if you find any.", "Let\u2019s start by installing the package in your favorite python environment:", "Then, you can import the library and define the credentials to connect to your Neo4j graph:", "Usage of pygds is as follows:", "For instance, to run the node2vec algorithm, we will write:", "The result can then be parsed into a DataFrame:", "Starting from there, you can perform any Machine Learning algorithm, from PCA for visualization to classification if nodes also have some target class\u2026", "As a last step, whether you are working with Cypher or pygds, you have to drop the projected graph which is stored in the live memory of your computer: gds.graph.drop(\"MyGraph\")", "That\u2019s great! The GDS contains much more fantastic algorithms implementations (path finding, node importance, community detection, node similarity, link prediction) and features (e.g. writing the algorithms results as node properties to persist the result in the graph instead of streaming them).", "Here are a few online resources you can check if you are interested in learning more about graph algorithms and Neo4j:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD, Data Scientist, Python developer \u2014 Graphie award 2019 @Neo4j \u2014 author @PacktPub \u2014 now CTO @SmartGrid https://www.linkedin.com/in/estellescifo/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd45db83e54b6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@st3llasia?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@st3llasia?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Estelle Scifo"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F506d892fb653&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&user=Estelle+Scifo&userId=506d892fb653&source=post_page-506d892fb653----d45db83e54b6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd45db83e54b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd45db83e54b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/fr/users/geralt-9301/", "anchor_text": "Gerd Altmann"}, {"url": "https://db-engines.com/de/blog_post/53", "anchor_text": "https://db-engines.com/de/blog_post/53"}, {"url": "https://sandbox.neo4j.com/", "anchor_text": "https://sandbox.neo4j.com/"}, {"url": "https://neo4j.com/download/", "anchor_text": "https://neo4j.com/download/"}, {"url": "https://neo4j.com/docs/graph-data-science/current/installation/#_neo4j_desktop", "anchor_text": "https://neo4j.com/docs/graph-data-science/current/installation/#_neo4j_desktop"}, {"url": "https://neo4j.com/docs/graph-data-science/current/algorithms/node-embeddings/node2vec/", "anchor_text": "https://neo4j.com/docs/graph-data-science/current/algorithms/node-embeddings/node2vec/"}, {"url": "https://neo4j.com/docs/graph-data-science/current/algorithms/alpha/graph-sage/", "anchor_text": "https://neo4j.com/docs/graph-data-science/current/algorithms/alpha/graph-sage/"}, {"url": "https://github.com/stellasia/pygds", "anchor_text": "pygds"}, {"url": "https://medium.com/u/68584b0be0fb?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Mark Needham"}, {"url": "https://neo4j.com/graph-algorithms-book/", "anchor_text": "https://neo4j.com/graph-algorithms-book/"}, {"url": "https://neo4j.com/docs/graph-data-science/1.0/appendix-b/", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/introducing-the-neo4j-graph-data-science-plugin-with-examples-from-the-graph-algorithms-19b831f66f2", "anchor_text": "updated examples using the GDS"}, {"url": "https://medium.com/u/26bec2028463?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Neo4j"}, {"url": "https://neo4j.com/graphacademy/online-training/data-science/part-0/", "anchor_text": "https://neo4j.com/graphacademy/online-training/data-science/part-0/"}, {"url": "https://medium.com/u/57f13c0ea39a?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Tomaz Bratanic"}, {"url": "https://tbgraph.wordpress.com/", "anchor_text": "https://tbgraph.wordpress.com/"}, {"url": "https://neo4j.com/docs/graph-data-science/current/", "anchor_text": "https://neo4j.com/docs/graph-data-science/current/"}, {"url": "https://towardsdatascience.com/a-gentle-introduction-to-graph-neural-network-basics-deepwalk-and-graphsage-db5d540d50b3", "anchor_text": "A Gentle Introduction to Graph Neural Networks (Basis, DeepWalk and GraphSage)"}, {"url": "https://medium.com/u/2fc7b9c3f02a?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Kung-Hsiang, Huang (Steeve)"}, {"url": "https://medium.com/tag/neo4j?source=post_page-----d45db83e54b6---------------neo4j-----------------", "anchor_text": "Neo4j"}, {"url": "https://medium.com/tag/graph?source=post_page-----d45db83e54b6---------------graph-----------------", "anchor_text": "Graph"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d45db83e54b6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----d45db83e54b6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd45db83e54b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&user=Estelle+Scifo&userId=506d892fb653&source=-----d45db83e54b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd45db83e54b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&user=Estelle+Scifo&userId=506d892fb653&source=-----d45db83e54b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd45db83e54b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd45db83e54b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d45db83e54b6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d45db83e54b6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d45db83e54b6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d45db83e54b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@st3llasia?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@st3llasia?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Estelle Scifo"}, {"url": "https://medium.com/@st3llasia/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "310 Followers"}, {"url": "https://www.linkedin.com/in/estellescifo/", "anchor_text": "https://www.linkedin.com/in/estellescifo/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F506d892fb653&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&user=Estelle+Scifo&userId=506d892fb653&source=post_page-506d892fb653--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F147fb84d6af1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcomputing-node-embedding-with-a-graph-database-neo4j-its-graph-data-science-library-d45db83e54b6&newsletterV3=506d892fb653&newsletterV3Id=147fb84d6af1&user=Estelle+Scifo&userId=506d892fb653&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}