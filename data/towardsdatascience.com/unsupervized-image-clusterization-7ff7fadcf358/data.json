{"url": "https://towardsdatascience.com/unsupervized-image-clusterization-7ff7fadcf358", "time": 1683014334.33159, "path": "towardsdatascience.com/unsupervized-image-clusterization-7ff7fadcf358/", "webpage": {"metadata": {"title": "An easy and efficient way to explore a large quantity of images | by Jordan Thieyre | Sep, 2020 | Towards Data Science", "h1": "Unsupervised image mapping", "description": "This article presents a simple and effective way to explore a set of images using a neural network."}, "outgoing_paragraph_urls": [{"url": "https://www.python.org/downloads/release/python-368/", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://www.tableau.com/products/trial", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/phelber/eurosat", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/an-overview-of-resnet-and-its-variants-5281e2f56035", "anchor_text": "this article", "paragraph_index": 6}, {"url": "https://distill.pub/2016/misread-tsne/", "anchor_text": "This article", "paragraph_index": 10}, {"url": "https://gitlab.com/jthieyre/unsupervized-image-clusterization", "anchor_text": "code", "paragraph_index": 26}, {"url": "https://gitlab.com/jthieyre", "anchor_text": "https://gitlab.com/jthieyre", "paragraph_index": 29}], "all_paragraphs": ["As a data scientist, I often work on anti-fraud investigation missions. Exploration is therefore an essential part of the investigation. It allows one to become familiar with the subject of the analysis. I will detail here a simple, fast, efficient and reproducible way for you to get a global idea of the images you have. This is my first article so do not hesitate to ask your questions and make your comments. Enjoy \ud83d\ude09", "To install Python, if you are on Windows or Mac, you can download the installer here. For linux users, the following bash command will install Python 3.6:sudo apt-get install python3.6", "Finally, the visualisation of the results is done using Tableau Software. It is a paid software but you can try it for free here.", "We can now import the libraries and specify the path to the images:", "For this example, I chose to use the EuroSAT (RGB) dataset available here.", "The first step is to find a way to richly describe images. A quick and simple method is to use a neural network already trained on a general classification task as an encoder. Our goal will not be to classify but rather to group similar images together using the features extracted by the network. The ResNet50 residual neural network trained on the ImageNet dataset is a very good start.", "Want to learn more about residual neural networks? The first part of this article explains it very well.", "Why a ResNet50 trained on the ImageNet dataset? The ImageNet project is a large visual database designed for use in visual object recognition software research. More than 14 million images have been hand-annotated by the project to indicate what objects are pictured and in at least one million of the images, bounding boxes are also provided. ImageNet contains more than 20,000 categories with a typical category, such as \u201cballoon\u201d or \u201cstrawberry\u201d, consisting of several hundred images. Thus, a neural network trained to classify ImageNet images and achieving a good score will have learned to correctly differentiate the shapes and characteristics of the images. This faculty will be precious to us. The problem is that our ResNet50 as it stands only knows how to predict one class from the list of ImageNet classes. To overcome this, we have to remove the last layer of the network used for classification. The output of the network will then be a vector of characteristics of dimension 2048.", "We humans find it very difficult to grasp more than 3 dimensions. So imagine 2048\u2026", "One of my preferred methods for visualizing large vectors is the t-SNE algorithm. t-SNE stands for t-distributed Stochastic Neighbor Embedding. It is a machine learning algorithm for visualization based on Stochastic Neighbor Embedding. It is a nonlinear dimensionality reduction technique well-suited for embedding high-dimensional data for visualization in a low-dimensional space of two or three dimensions. Specifically, it models each high-dimensional object by a two- or three-dimensional point in such a way that similar objects are modeled by nearby points and dissimilar objects are modeled by distant points with high probability.The t-SNE algorithm comprises two main stages. First, t-SNE constructs a probability distribution over pairs of high-dimensional objects in such a way that similar objects are assigned a higher probability while dissimilar points are assigned a lower probability. Second, t-SNE defines a similar probability distribution over the points in the low-dimensional map, and it minimizes the Kullback-Leibler divergence (KL divergence) between the two distributions with respect to the locations of the points in the map.", "Like many algorithms, the parameters must be chosen carefully. This article explains very well the influence of the different parameters of the t-SNE.In our case, the following values of the parameters allowed us to obtain a satisfactory result.", "Once the projection has been made, we can visualise the result.", "A simple scatter plot can already be used to identify some groupings.", "The disadvantage of this simple graph is that it does not allow you to view images represented by dots. For this, more advanced visualisation solutions are required such as Power BI or Tableau Software which is detailed below.", "Tableau is a paid data visualisation software that is rather simple to use and allows a large number of different types of visualisation, including interactive visualisations.", "We must first save the results of the t-SNE.", "Then, in Tableau Software, click \u201cNew Data Source\u201d > \u201cText file\u201d and select your CSV file to open.", "Once the data has been loaded, go to \u201cSheet 1\u201d.", "Here, right-click on \u201cX\u201d > \u201cConvert to Dimension\u201d. Do the same with \u201cY\u201d.Add \u201cX\u201d and \u201cY\u201d to the \u201ccolumns\u201d and \u201crows\u201d fields respectively by dragging and dropping them. Click on the small arrow that appears when you move the mouse over \u201cX\u201d in the \u201ccolumns\u201d field, and then click \u201cContinuous\u201d. Do the same with \u201cY\u201d. You should get a visual similar to the scatter plot.In anticipation of later, drag and drop \u201cimage file paths\u201d into the \u201cdetail\u201d box in the \u201cMarks\u201d pane.", "To make the visual more aesthetic, you can make the grid, the axes and the name of the sheet disappear. To do this, right-click on the grid > \u201cFormat\u201d, then in the \u201cFormat Font\u201d pane on the right, click on the \u201cLines\u201d icon and deactivate the different lines by selecting \u201cNone\u201d for each one.Then, with a right click on the axes, you can deactivate the \u201cShow header\u201d option. Right-click on the title to activate the \u201cHide title\u201d option.Finally, in the \u201cMarks\u201d pane, you can modify the shape of the points, their size, colour, etc. Personally, I like to make them appear as small squares with an opacity of 75%. This reminds me of small polaroid images that we would have sorted and put together on a table.You can also make the name of the image appear by dragging and dropping \u201cimage file names\u201d into \u201ctooltips\u201d and then, by double-clicking \u201cTooltip\u201d, you can edit the content of the tooltip and modify it to keep only \u201c<ATTR(Image file names)>\u201d.", "We can now switch to the \u201cDashboard\u201d tab by clicking on the \u201cNew Dashboard\u201d icon at the bottom next to Sheet 1. Let\u2019s increase the size in the \u201cSize\u201d pane by changing \u201cWidth\u201d and \u201cHeight\u201d to 1600px and 900px respectively. You can then drag and drop \u201cSheet 1\u201d from the \u201cSheets\u201d tab to the dashboard. Right click on the title to make it disappear.In the \u201cObjects\u201d pane, drag and drop \u201cWeb Page\u201d to the right of \u201cSheet 1\u201d on the dashboard. Then click \u201cOK\u201d leaving the URL blank.", "This web page is a way to display images. The purpose is to display the images in the web page by hovering over a square. To do this, we will launch a local web server. In your terminal, go to the directory to be served and type cd <path where UIC_dataset folder is>, then launch a Python web server by typing python -m http.server --bind 127.0.0.1. Your server is now launched.In the \u201cDashboard\u201d tab at the top > \u201cActions\u2026\u201d > \u201cAdd Action >\u201d > \u201cGo to URL\u2026\u201d. In \u201cRun action on:\u201d select \u201cHover\u201d. In \u201cURL\u201d, enter the URL \u201chttp://127.0.0.1:8000/<Image file paths>\u201d literally. In \u201cURL Target\u201d, select \u201cWeb Page Object\u201d. Finally, click \u201cOK\u201d.", "Note: If you are working in Windows, you may need to change the \u201cimage file paths\u201d by replacing \u201c\\\u201d to \u201c/\u201d. To do this, in \u201cSheet 1\u201d, right click at the bottom of the \u201cData\u201d pane, then \u201cCreate Calculated Field\u2026\u201d. There type name \u201cpath\u201d and enter the calculation formula as below. Then in \u201cDashboard\u201d > \u201cActions\u201d > double-click on \u201cHyperlink1\u201d, change the URL with \u201chttp://127.0.0.1:8000/<path>\u201d.", "And voil\u00e0! Your images will appear as you fly over them.", "So we can see that similar images have been grouped together. Some clusters can be seen, such as the \u201cResidential\u201d cluster at the top right or the clearly detached \u201cSeaLake\u201d cluster at the bottom.", "So we saw a simple and effective way to get a good idea of an image dataset. This idea will be very precious for you in your further analysis work.I hope you enjoyed this article and that it made you want to learn more about data analysis. Feel free to ask questions and comments.", "The code is available as a Jupyter notebook on my gitlab to which you can contribute if you wish.", "More articles will come, including one on cleaning up plain text emails. Stay tuned and see you soon \ud83d\ude09", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data engineer at Inria | gitlab: https://gitlab.com/jthieyre"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7ff7fadcf358&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jordan.thieyre?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jordan.thieyre?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": "Jordan Thieyre"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9abc7f3f7a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&user=Jordan+Thieyre&userId=9abc7f3f7a5&source=post_page-9abc7f3f7a5----7ff7fadcf358---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ff7fadcf358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ff7fadcf358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jontyson?utm_source=medium&utm_medium=referral", "anchor_text": "Jon Tyson"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.python.org/downloads/release/python-368/", "anchor_text": "here"}, {"url": "https://www.tableau.com/products/trial", "anchor_text": "here"}, {"url": "https://github.com/phelber/eurosat", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/an-overview-of-resnet-and-its-variants-5281e2f56035", "anchor_text": "this article"}, {"url": "https://distill.pub/2016/misread-tsne/", "anchor_text": "This article"}, {"url": "https://gitlab.com/jthieyre/unsupervized-image-clusterization", "anchor_text": "code"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----7ff7fadcf358---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/ai?source=post_page-----7ff7fadcf358---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/data-exploration?source=post_page-----7ff7fadcf358---------------data_exploration-----------------", "anchor_text": "Data Exploration"}, {"url": "https://medium.com/tag/clustering?source=post_page-----7ff7fadcf358---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----7ff7fadcf358---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7ff7fadcf358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&user=Jordan+Thieyre&userId=9abc7f3f7a5&source=-----7ff7fadcf358---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7ff7fadcf358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&user=Jordan+Thieyre&userId=9abc7f3f7a5&source=-----7ff7fadcf358---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7ff7fadcf358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7ff7fadcf358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7ff7fadcf358---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7ff7fadcf358--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jordan.thieyre?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jordan.thieyre?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jordan Thieyre"}, {"url": "https://medium.com/@jordan.thieyre/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5 Followers"}, {"url": "https://gitlab.com/jthieyre", "anchor_text": "https://gitlab.com/jthieyre"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9abc7f3f7a5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&user=Jordan+Thieyre&userId=9abc7f3f7a5&source=post_page-9abc7f3f7a5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F9abc7f3f7a5%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funsupervized-image-clusterization-7ff7fadcf358&user=Jordan+Thieyre&userId=9abc7f3f7a5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}