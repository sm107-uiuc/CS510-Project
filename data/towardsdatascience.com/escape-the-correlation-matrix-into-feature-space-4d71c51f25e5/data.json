{"url": "https://towardsdatascience.com/escape-the-correlation-matrix-into-feature-space-4d71c51f25e5", "time": 1683008061.140806, "path": "towardsdatascience.com/escape-the-correlation-matrix-into-feature-space-4d71c51f25e5/", "webpage": {"metadata": {"title": "Escape the Correlation Matrix into\u2026 Feature Space. | by Matt Britton | Towards Data Science", "h1": "Escape the Correlation Matrix into\u2026 Feature Space.", "description": "We\u2019ve all had the experience of getting good at using a bad product. The wonky CRM your company is locked into a four-year contract with. The form tool with the hideous database connector that you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://gist.github.com/MattJBritton/b6944218903312f6220bfb48706b593c", "anchor_text": "minimal example", "paragraph_index": 4}, {"url": "https://github.com/MattJBritton/ExquisiteCorrpse", "anchor_text": "full notebook", "paragraph_index": 4}, {"url": "http://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "Boston Housing data set", "paragraph_index": 5}, {"url": "https://xkcd.com/1329/", "anchor_text": "running desk", "paragraph_index": 9}, {"url": "https://en.wikipedia.org/wiki/Pearson_correlation_coefficient", "anchor_text": "Pearson Correlation Coefficient", "paragraph_index": 9}, {"url": "https://www.csc2.ncsu.edu/faculty/healey/PP/", "anchor_text": "preattentive processing", "paragraph_index": 24}, {"url": "https://www.usertesting.com/blog/gestalt-principles", "anchor_text": "Gestalt principles", "paragraph_index": 24}, {"url": "https://github.com/MattJBritton/ExquisiteCorrpse", "anchor_text": "source code", "paragraph_index": 30}, {"url": "https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+(Diagnostic)", "anchor_text": "Breast Cancer data set", "paragraph_index": 33}, {"url": "https://archive.ics.uci.edu/ml/datasets/Epileptic+Seizure+Recognition", "anchor_text": "Epileptic Seizure Recognition", "paragraph_index": 39}, {"url": "https://github.com/MattJBritton/ExquisiteCorrpse", "anchor_text": "here", "paragraph_index": 44}, {"url": "https://rdrr.io/cran/lessR/man/corReorder.html", "anchor_text": "corReorder R package", "paragraph_index": 45}, {"url": "https://towardsdatascience.com/rip-correlation-introducing-the-predictive-power-score-3d90808b9598", "anchor_text": "Predictive Power Score", "paragraph_index": 45}], "all_paragraphs": ["We\u2019ve all had the experience of getting good at using a bad product. The wonky CRM your company is locked into a four-year contract with. The form tool with the hideous database connector that you never find time to migrate away from. MS Access. Due to inertia, organizational limitations, or cost, we often find ourselves using subpar tools and technologies, learning their little quirks, devoting muscle memory to a repetitive series of dialogue boxes. Have you ever tried to save an Excel file as a CSV?", "Some features in your workbook might be lost if you save it as a CSV.", "Sometimes, using these tools is a necessity. Who knows, maybe it even builds character?", "But as data scientists, we often have the ability to choose our own tools. And doing so is very important, because our tools shape our sense of what is easy, and what is even possible at all.", "The correlation matrix is one of these bad tools. To be more specific, it is a tool that is effective for a limited set of tasks, in a situation where we habitually need to perform a broad array of tasks. And because the correlation matrix has a long history and works just well enough on smaller datasets, we treat it like the only game in town. I present the Feature Space Diagram \u2014 a tool that complements the correlation matrix and is useful for both data scientists and non-experts. The code is easy to adapt for yourself \u2014 see the minimal example and the full notebook.", "So what exactly is the issue with the correlation matrix? Let\u2019s run through an example to see for ourselves. Say we are working with the Boston Housing data set, and our goal is to build a predictive model for the median house price in a neighborhood.", "We might ask about missing values, look at univariate distributions, consult our data dictionary, but one of our biggest questions will be:", "how do the features relate to each other, and the target?", "As good data scientists, rather than just throwing a neural network at it, we want to understand our data set to the extent possible. This will help us with:", "So, we leap into action (figuratively, my running desk hasn\u2019t come in yet), and build a correlation matrix. It calculates the Pearson Correlation Coefficient (abbreviated r), with each pair of quantitative features in the data receiving a single number from -1 to 0 to +1, indicating that their linear dependence is strongly negative, absent, or strongly positive, respectively. When output as a table, it shows the strength of the (linear) relationship between any two features. We engage in some light visualization, and presto!", "But how do we use this chart? Let\u2019s ask ourselves\u2026", "\u2014 What do we want to do?", "\u2014 Does this thing do it for us?", "As data scientists, we want to do at least the following:", "The correlation matrix above clearly excels at the first point. It\u2019s essentially just a look up table, improved by double-encoding the values with color.", "The second point is a little trickier. \u201cStructure\u201d here means forms of organization that exist among aggregates of individual elements \u2014 like looking at a house and saying \u201cit has 3 floors\u201d or \u201cthe foundation is sinking\u201d rather than just \u201cthose two bricks are adjacent\u201d. In feature space, the structures we are looking for are clusters of collinear features or independent features that offer unique predictive value.", "More complex relationships are possible in high-dimensional space , which points us towards the third objective \u2014 learn something we don\u2019t know. If we were simply looking to validate a hypothesis, there are plenty of statistical tests. But getting an insight that we had not even thought to consider is the heart of analysis and visualization.", "So, does our correlation matrix help us find clusters of features, and generate novel insights about the data?", "Kinda? We can tell from the prevalence of dark squares whether we have a lot of collinearity. We can look into a row or column and notice that it is very dark or very light, and get a sense of whether that feature is close to many other features or not. But, it is going to take a lot of time staring at this to identify clusters. One issue is that all of the columns look a little bit the same, and we have to keep checking the axis labels to make sure we are looking at the right one.", "With time and effort, we can deduce that, for example, RAD, TAX, INDUS, AGE, and NOX are highly correlated with each other, and might form a cluster. The information necessary to do that is all here.", "But the purpose of a visualization is to leverage our evolution-honed visual acuity to quickly spot patterns that are not visible when just staring at a table of figures.", "On that count, I think this fails as a tool for generating insight.", "But wait! If clusters are what we are after, then why not just sort the axes so that related features are next to each other?\u00b9 Can you see the improvement from the original version to this one?", "Now the rubber hits the road! Just scan along the diagonal and look for blocks of color. We can immediately see clusters between CRIM, RAD, and TAX, and INDUS, AGE, NOX, and DIS.", "What we\u2019ve done here is leverage our brain\u2019s evolution-honed preattentive processing to quickly pick out patterns based on Gestalt principles such as proximity and similarity.", "One of the main goals of visualization is to bind interesting data to these patterns \u2014 we are basically building binoculars and asking our brain to tell us what\u2019s moving in the forest.", "In addition to these clusters, our brain picks out other patterns. Sure RAD and TAX have a high correlation, but they are both correlated to a lesser extent with CRIM and B. LSTAT seems like it\u2019s in a cluster with Median_Home_Value and RM, but it has reasonably strong correlation with most of the other features. It also looks like the NOX/DIS and RAD/TAX clusters are correlated with each other, but not as much with the LSTAT/RM cluster.", "These are the complex, surprising structures we talked about earlier. Our sorted correlation matrix makes them visible, but we still need to reference the axis labels and trace down a row or column, and for a data set with hundreds of columns the correlation matrix won\u2019t even fit on a page!", "Another limitation of the correlation matrix is that both axes are sorted in the same order, and so a feature can only be directly adjacent to 2 others. This constrains our ability to use proximity as a measure of closeness. In the sorted matrix, we are trying to analyze relationships which are encoded well with color, but not with distance. This gives the chart a sort of \u201cmagic eye\u201d character, and makes it less approachable for non-experts.", "Hmm, what chart lets us position elements in 2 dimensions, so we can have horizontal and vertical proximity?", "All we need is a way to generate X,Y coordinates for each feature. The full method is available in the source code, and is summarized below:", "The Feature Space Diagram (FSD) below uses a combination of position, color (for cluster membership) and linkage (for strong correlations) to describe relationships between features in complementary ways. Even at a glance, we can see that:", "This is a quick insight that could be very helpful in feature engineering and selection. If we need the details, we can look them up in our correlation matrix, putting it into its rightful place as a lookup tool.", "The Boston Housing data is pretty small, so the correlation matrix and the feature space diagram are more evenly matched. But the FSD really shines with larger data sets. Let\u2019s take a look at the FSD for the Breast Cancer data set, which has 30 columns:", "We can immediately see that there are distinct clusters of features in this data. The orange and brown clusters are strongly correlated internally and with each other. The features in the red cluster are both further from the orange cluster, and less strongly correlated with each other. There are also outliers too such smoothness_worst, area_worst and concavity_mean. Radius_sd_error and concave_points_mean are strangely related to each other and nothing else.", "This data consists of several types of measurements (radius, perimeter, symmetry, etc) and statistics computed for each of these measurements (mean, standard deviation, worst). One high-level question we could try to answer is whether we can just use the \u201cmean\u201d of each measurement type and toss out the rest. In other words, do features cluster by measurement type?", "By hard-coding a color mapping of feature to measurement type, we can easily see the answer!", "There are a few measurement types that are physically adjacent, such as compactness_ in orange. But overall, measurement type doesn\u2019t drive correlation here.", "Still, this is a good hypothesis to reject. This approach would also be very helpful if we had merged several data sets together for our analysis, and now wanted to identify to what extent their features overlap. Just give the variables from each data set their own color.", "I was particularly surprised by the FSD created for a time series data set on Epileptic Seizure Recognition. Each data point consists of 178 EEG measurements taken over the course of a second. One of the first questions we want to ask of a time series is whether there is any repetitive or cyclical behavior.", "This vaguely Australian-looking blob shows us that each feature is only correlated with its neighbors (i.e. the preceding and following time slices). The odd shape comes from PCA trying to push each feature away from others based on chronological order.", "However, how do we explain all the bends and curlicues? We might reasonably expect a Markov chain to look something more like this:", "In other words, a circular shape without loops. This is a hint that there are other correlations in this data set, aside from between each chunk of 5 consecutive timestamps. Let\u2019s check our correlation matrix:", "At first glance, the correlation matrix supplies the same story \u2014 a band of highly correlated points extending 2\u20133 timestamps before and after each point, and no correlations otherwise. But if we look closely, we can see two sets of faint lines parallel to the main line \u2014 one set about 17 points before and after each point, and the other about 35 points before and after each point. This odd visual artifact suggests that there is a small cyclical effect in this data. In the FSD, we can even see that the line bends so that X18, X33, and X49 are as close as possible together, approximating the trend we see above. Pretty cool!", "The Feature Space Diagram is a tool that complements the correlation matrix and provides a faster synopsis of correlations between quantitative features. In this article, I show how it can be used to surface interesting relationships which require further investigation. The code is available below (or see the full notebook here) and includes additional configurations and interactive features, including:", "\u00b9 For a full implementation of this sorting, see the corReorder R package.\u00b2 In the examples for this article, the CHAS boolean variable is included in correlation matrices. Although it is coded as a number, the Pearson Correlation Coefficient is not designed to handle categorical variables, and so this should not be done in practice. See the Predictive Power Score for a similar feature score that can handle variables of any type.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m a data scientist with experience in the non-profit and education sectors. Interested in interpretable ML and computational social science."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4d71c51f25e5&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://blog.mattbritton.info/?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": ""}, {"url": "https://blog.mattbritton.info/?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": "Matt Britton"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6e9905adba83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&user=Matt+Britton&userId=6e9905adba83&source=post_page-6e9905adba83----4d71c51f25e5---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d71c51f25e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d71c51f25e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@juskteez?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Juskteez Vu"}, {"url": "https://unsplash.com/s/photos/space?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://gist.github.com/MattJBritton/b6944218903312f6220bfb48706b593c", "anchor_text": "minimal example"}, {"url": "https://github.com/MattJBritton/ExquisiteCorrpse", "anchor_text": "full notebook"}, {"url": "http://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "Boston Housing data set"}, {"url": "https://xkcd.com/1329/", "anchor_text": "running desk"}, {"url": "https://en.wikipedia.org/wiki/Pearson_correlation_coefficient", "anchor_text": "Pearson Correlation Coefficient"}, {"url": "https://www.csc2.ncsu.edu/faculty/healey/PP/", "anchor_text": "preattentive processing"}, {"url": "https://www.usertesting.com/blog/gestalt-principles", "anchor_text": "Gestalt principles"}, {"url": "https://github.com/MattJBritton/ExquisiteCorrpse", "anchor_text": "source code"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+(Diagnostic)", "anchor_text": "Breast Cancer data set"}, {"url": "https://archive.ics.uci.edu/ml/datasets/Epileptic+Seizure+Recognition", "anchor_text": "Epileptic Seizure Recognition"}, {"url": "https://github.com/MattJBritton/ExquisiteCorrpse", "anchor_text": "here"}, {"url": "https://rdrr.io/cran/lessR/man/corReorder.html", "anchor_text": "corReorder R package"}, {"url": "https://towardsdatascience.com/rip-correlation-introducing-the-predictive-power-score-3d90808b9598", "anchor_text": "Predictive Power Score"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4d71c51f25e5---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualisation?source=post_page-----4d71c51f25e5---------------data_visualisation-----------------", "anchor_text": "Data Visualisation"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4d71c51f25e5---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----4d71c51f25e5---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----4d71c51f25e5---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://creativecommons.org/licenses/by-sa/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d71c51f25e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&user=Matt+Britton&userId=6e9905adba83&source=-----4d71c51f25e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4d71c51f25e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&user=Matt+Britton&userId=6e9905adba83&source=-----4d71c51f25e5---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4d71c51f25e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4d71c51f25e5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4d71c51f25e5---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4d71c51f25e5--------------------------------", "anchor_text": ""}, {"url": "https://blog.mattbritton.info/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://blog.mattbritton.info/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Matt Britton"}, {"url": "https://blog.mattbritton.info/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "67 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6e9905adba83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&user=Matt+Britton&userId=6e9905adba83&source=post_page-6e9905adba83--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa89a8c50e06d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fescape-the-correlation-matrix-into-feature-space-4d71c51f25e5&newsletterV3=6e9905adba83&newsletterV3Id=a89a8c50e06d&user=Matt+Britton&userId=6e9905adba83&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}