{"url": "https://towardsdatascience.com/elmo-contextual-language-embedding-335de2268604", "time": 1682994498.921122, "path": "towardsdatascience.com/elmo-contextual-language-embedding-335de2268604/", "webpage": {"metadata": {"title": "ELMo: Contextual language embedding | by Josh Taylor | Towards Data Science", "h1": "ELMo: Contextual language embedding", "description": "This article will explore the latest in natural language modelling; deep contextualised word embeddings. The focus is more practical than theoretical with a worked example of how you can use the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://colab.research.google.com/drive/13f6dKakC-0yO6_DxqSqo0Kl41KMHT8A1", "anchor_text": "here", "paragraph_index": 0}, {"url": "https://colab.research.google.com/drive/13f6dKakC-0yO6_DxqSqo0Kl41KMHT8A1", "anchor_text": "Colab output here", "paragraph_index": 10}, {"url": "https://www.linkedin.com/in/josh-taylor-24806975/", "anchor_text": "https://www.linkedin.com/in/josh-taylor-24806975/", "paragraph_index": 39}], "all_paragraphs": ["This article will explore the latest in natural language modelling; deep contextualised word embeddings. The focus is more practical than theoretical with a worked example of how you can use the state-of-the-art ELMo model to review sentence similarity in a given document as well as creating a simple semantic search engine. The full code can be viewed in the Colab notebook here.", "As we know, language is complex. Context can completely change the meaning of the individual words in a sentence. For example:", "I have yet to cross-off all the items on my bucket list.", "The bucket was filled with water.", "In these sentences, whilst the word \u2018bucket\u2019 is always the same, it\u2019s meaning is very different.", "Whilst we can easily decipher these complexities in language, creating a model which can understand the different nuances of the meaning of words given the surrounding text is difficult.", "It is for this reason that traditional word embeddings (word2vec, GloVe, fastText) fall short. They only have one representation per word, therefore they cannot capture how the meaning of each word can change based on surrounding context.", "Enter ELMo. Developed in 2018 by AllenNLP, it goes beyond traditional embedding techniques. It uses a deep, bi-directional LSTM model to create word representations.", "Rather than a dictionary of words and their corresponding vectors, ELMo analyses words within the context that they are used. It is also character based, allowing the model to form representations of out-of-vocabulary words.", "This therefore means that the way ELMo is used is quite different to word2vec or fastText. Rather than having a dictionary \u2018look-up\u2019 of words and their corresponding vectors, ELMo instead creates vectors on-the-fly by passing text through the deep learning model.", "Lets get started! I will add the main snippets of code here but if you want to review the full set of code (or indeed want the strange satisfaction that comes with clicking through each of the cells in a notebook), please see the corresponding Colab output here.", "As per my last few posts, the data we will be using is based on Modern Slavery returns. These are mandatory statements by companies to communicate how they are addressing Modern Slavery both internally, and within their supply chains. We will be deep-diving into ASOS\u2019s return in this article (a British, online fashion retailer).", "If you are interested in seeing other posts in what is fast becoming a mini-series of NLP experiments performed on this dataset, I have included links to these at the end of this article.", "1. Get the text data, clean and tokenize", "It is amazing how simple this is to do using Python string functions and spaCy. Here we do some basic text cleaning by:", "a) removing line breaks, tabs and excess whitespace as well as the mysterious \u2018xa0\u2019 character;", "b) splitting the text into sentences using spaCy\u2019s \u2018.sents\u2019 iterator.", "ELMo can receive either a list of sentence strings or a list of lists (sentences and words). Here we have gone for the former. We know that ELMo is character based, therefore tokenizing words should not have any impact on performance.", "2. Get the ELMo model using TensorFlow Hub:", "If you have not yet come across TensorFlow Hub, it is a massive time saver in serving-up a large number of pre-trained models for use in TensorFlow. Luckily for us, one of these models is ELMo. We can load in a fully trained model in just two few lines of code. How satisfying\u2026", "To then use this model in anger we just need a few more lines of code to point it in the direction of our text document and create sentence vectors:", "3. Use visualisation to sense-check outputs", "It is amazing how often visualisation is overlooked as a way of gaining greater understanding of data. Pictures speak a thousand words and we are going to create a chart of a thousand words to prove this point (actually it is 8,511 words).", "Here we will use PCA and t-SNE to reduce the 1,024 dimensions which are output from ELMo down to 2 so that we can review the outputs from the model. I have included further reading on how this is achieved at the end of the article if you want to find out more.", "Using the amazing Plotly library, we can create a beautiful, interactive plot in no time at all. The below code shows how to render the results of our dimensionality reduction and join this back up to the sentence text. Colour has also been added based on the sentence length. As we are using Colab, the last line of code downloads the HTML file. This can be found below:", "The code to create this is below:", "Exploring this visualisation, we can see ELMo has done sterling work in grouping sentences by their semantic similarity. In fact it is quite incredible how effective the model is:", "4. Create a semantic search engine:", "Now that we are confident that our language model is working well, lets put it to work in a semantic search engine. The idea is that this will allow us to search through the text not by keywords but by semantic closeness to our search query.", "This is actually really simple to implement:", "Google Colab has some great features to create form inputs which are perfect for this use case. For example, creating an input is as simple as adding #@param after a variable. The below shows this for a string input:", "In addition to using Colab form inputs, I have used \u2018IPython.display.HTML\u2019 to beautify the output text and some basic string matching to highlight common words between the search query and the results.", "Lets put it to the test. Let us see what ASOS are doing with regards to a code of ethics in their Modern Slavery return:", "This is magical! The matches go beyond keywords, the search engine clearly knows that \u2018ethics\u2019 and ethical are closely related. We find hits for both a code of integrity and also ethical standards and policies. Both relevant to our search query but not directly linked based on key words.", "I hope you enjoyed the post. Please do leave comments if you have any questions or suggestions.", "Below are my other posts in what is now becoming a mini series on NLP and exploration of companies Modern Slavery returns:", "To find out more on the dimensionality reduction process used, I recommend the below post:", "Finally, for more information on state of the art language models, the below is a good read:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a specialist in producing insights through advanced analytics, machine learning and visualisation. https://www.linkedin.com/in/josh-taylor-24806975/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F335de2268604&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----335de2268604--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----335de2268604--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@thejoshtaylor?source=post_page-----335de2268604--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=post_page-----335de2268604--------------------------------", "anchor_text": "Josh Taylor"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb5b5ec923fa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&user=Josh+Taylor&userId=b5b5ec923fa3&source=post_page-b5b5ec923fa3----335de2268604---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F335de2268604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F335de2268604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colab.research.google.com/drive/13f6dKakC-0yO6_DxqSqo0Kl41KMHT8A1", "anchor_text": "here"}, {"url": "https://colab.research.google.com/drive/13f6dKakC-0yO6_DxqSqo0Kl41KMHT8A1", "anchor_text": "Colab output here"}, {"url": "https://tfhub.dev/google/elmo/2", "anchor_text": "https://tfhub.dev/google/elmo/2"}, {"url": "https://drive.google.com/open?id=17gseqOhQl9c1iPTfzxGcCfB6TOTvSU_i", "anchor_text": "Sentence encodeInteractive sentence embeddingdrive.google.com"}, {"url": "https://towardsdatascience.com/clean-your-data-with-unsupervised-machine-learning-8491af733595", "anchor_text": "Clean your data with unsupervised machine learningCleaning data does not have to be painful! This post is a quick example of how to use unsupervised machine learning to\u2026towardsdatascience.com"}, {"url": "https://towardsdatascience.com/supercharging-word-vectors-be80ee5513d", "anchor_text": "Supercharging word vectorsA simple technique to boost fastText and other word vectors in your NLP projectstowardsdatascience.com"}, {"url": "https://medium.com/@luckylwk/visualising-high-dimensional-datasets-using-pca-and-t-sne-in-python-8ef87e7915b", "anchor_text": "Visualising high-dimensional datasets using PCA and t-SNE in PythonThe first step around any data related challenge is to start by exploring the data itself. This could be by looking at\u2026medium.com"}, {"url": "http://jalammar.github.io/illustrated-bert/", "anchor_text": "http://jalammar.github.io/illustrated-bert/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----335de2268604---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----335de2268604---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/visualization?source=post_page-----335de2268604---------------visualization-----------------", "anchor_text": "Visualization"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----335de2268604---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----335de2268604---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F335de2268604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&user=Josh+Taylor&userId=b5b5ec923fa3&source=-----335de2268604---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F335de2268604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&user=Josh+Taylor&userId=b5b5ec923fa3&source=-----335de2268604---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F335de2268604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----335de2268604--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F335de2268604&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----335de2268604---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----335de2268604--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----335de2268604--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----335de2268604--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----335de2268604--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----335de2268604--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----335de2268604--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----335de2268604--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----335de2268604--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@thejoshtaylor?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Josh Taylor"}, {"url": "https://medium.com/@thejoshtaylor/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "851 Followers"}, {"url": "https://www.linkedin.com/in/josh-taylor-24806975/", "anchor_text": "https://www.linkedin.com/in/josh-taylor-24806975/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb5b5ec923fa3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&user=Josh+Taylor&userId=b5b5ec923fa3&source=post_page-b5b5ec923fa3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F826db04da2c9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Felmo-contextual-language-embedding-335de2268604&newsletterV3=b5b5ec923fa3&newsletterV3Id=826db04da2c9&user=Josh+Taylor&userId=b5b5ec923fa3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}