{"url": "https://towardsdatascience.com/why-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6", "time": 1682994989.536884, "path": "towardsdatascience.com/why-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6/", "webpage": {"metadata": {"title": "Why isn\u2019t out-of-time validation more ubiquitous? | by Tomas Dvorak | Towards Data Science", "h1": "Why isn\u2019t out-of-time validation more ubiquitous?", "description": "The purpose of supervised machine learning is to classify unlabeled data. We want algorithms to tell us whether a borrower will default, a customer make a purchase, an image contains a cat, dog\u2026"}, "outgoing_paragraph_urls": [{"url": "https://machinelearningmastery.com/difference-test-validation-datasets/", "anchor_text": "terminology sometimes differs", "paragraph_index": 0}, {"url": "http://users.rowan.edu/~polikar/RESEARCH/PUBLICATIONS/tnn11.pdf", "anchor_text": "sub-field", "paragraph_index": 1}, {"url": "http://www.rogermstein.com/wp-content/uploads/BenchmarkingDefaultPredictionModels_TR030124.pdf", "anchor_text": "Roger Stein", "paragraph_index": 4}, {"url": "https://forums.fast.ai/t/should-the-final-model-be-retrained-on-full-available-data-set-train-validation-not-test-after-validation/11748", "anchor_text": "disagreement online", "paragraph_index": 6}, {"url": "https://www.springer.com/us/book/9781461468486", "anchor_text": "Kuhn and Johnson", "paragraph_index": 6}, {"url": "http://cs229.stanford.edu/notes/cs229-notes5.pdf", "anchor_text": "lecture notes", "paragraph_index": 6}, {"url": "https://machinelearningmastery.com/difference-between-a-parameter-and-a-hyperparameter/", "anchor_text": "distinction between model parameters and hyper-parameters", "paragraph_index": 7}], "all_paragraphs": ["The purpose of supervised machine learning is to classify unlabeled data. We want algorithms to tell us whether a borrower will default, a customer make a purchase, an image contains a cat, dog, malignant tumor or a benign polyp. The algorithms \u201clearn\u201d how to make these classifications using labeled data, i.e. data where we know whether the borrower actually defaulted, customer made a purchase, and what a blob of pixels actually shows. Normally, researchers take the labeled data, and split it three ways: training, validation and testing/hold-out (the terminology sometimes differs). They train hundreds of models on train data, and select one model that performs well on the validation data. The reason for using only a subset of labeled data to train the algorithm is to make sure that the algorithms perform well on any data \u2014 not just the data used to train the algorithm. Researchers often repeat this step several times, selecting different splits into train and validation, making sure the model performance is not specific to a particular validation data (k-fold cross-validation). As a final step, researchers evaluate the model\u2019s performance on yet unseen data (the test set). This provides a measure of how well the model will perform on the unlabeled data. This classic setup is illustrated in the figure below:", "In a large number of applications the data has a time dimension such that the labeled data is the past and the unlabeled data is the future. For example, we already know which borrowers or customers defaulted or made a purchase in the past. We want to know which ones will do so in the future. In this case, the purpose of the algorithm is to predict labels ahead of time. This means that it needs to work not just on yesterday\u2019s data but also on tomorrow\u2019s. I ask how the time dimension should be incorporated into the classic train/validate/test setup. This will surely matter if the processes that change over time. It turns out that there is a whole sub-field dealing with this issues. The approaches range from setting up a sliding window over training data, to actively testing for a changes in the underlying relationships. In this post, I review a few options for setting up the train, validation and test data.", "Let\u2019s consider what happens if we ignore the time dimension of the data, and split all of the labeled data regardless of its time dimension. We train, validate and test the model using data from the same time period. We make predictions for new data (say 2019) using using a model trained, validated and tested on labeled 2015\u20132018 data. The figure below illustrates this set up. The advantage is that we use the most recent data to train the model. The disadvantage is that it assumes that the relationships that existed in the past will be the same in the future. If the relationships shift over time, our estimated performance measures (which we calculated using in-time test data) will overstate the model\u2019s true performance, i.e. once deployed, the model will perform worse than we expect.", "Another possibility is that we hold-out year 2018, train the model using 2015\u20132017 data, and test it on 2018 data. The advantage of this approach is that we explicitly evaluate the model\u2019s ability to predict out-of-time. The disadvantage is the ability to predict out-of-time is not taken into account when building the model. This is because we select model that performs well on the in-time validation data. Moreover, unless we re-train the model using the full 2015\u20132018 data, we are not using the most recent data to make predictions.", "Roger Stein suggests training models on successive (potentially sliding) windows of data, and making predictions for the next time period. Each time we retrain the model using all observations through a particular point in time, and make predictions for the next time period. The predictions from each window are combined into one set of predictions. We do this for many different models and choose one that creates best combined predictions. The advantage of this approach is that the model building (i.e. trying out which models work best) explicitly takes into account the model\u2019s ability to make out-of-time predictions. Since the model is refit for each window, this approach simulates periodic retraining of the model which happens (or should happen) in practice. The disadvantage of the approach is that we always validate predictions on the same set of data rather than randomly selected data. (Perhaps holding out a portion of the test data could overcome this concern.)", "When we make predictions into the future, it is probably a good idea to use as recent data as possible so that we capture the most recent phenomena. However, if we hold out the most recent data (to evaluate out-of-time performance) as in option 2, we should probably re-train the model using all of the labeled data before making predictions. The retraining is illustrated in the figure below:", "There is some disagreement online over whether to re-train the model using all training and test data before deployment. Kuhn and Johnson seem pretty explicit when in chapter on over-fitting, data splitting and model tuning, they say \u201cWe then build a final model with all of the training data using the selected tuning parameters.\u201d (page 65). Similarly, Andrew Ng in one of his lecture notes says that after selecting a model from a cross-validation procedure we can \u201coptionally\u201d retrain the model \u201con the entire training set.\u201d", "It is helpful to draw the distinction between model parameters and hyper-parameters (aka tuning parameters). Hyper-parameters determine the structure of the model and generally can\u2019t be estimated from the data. They include things like the tree complexity, k in the KNN algorithm, feature set, functional form (e.g. linear vs quadratic) etc. In contrast, model parameters include coefficients in a regression, tree rules, support vectors. These can be estimated using data. The model building stage is all about finding the hyper-parameters. Once, the hyper-parameters (i.e. the structure of the model) are validated, there seem little reason not to use as much data as possible to get the most accurate estimates of the model parameters. These parameters should be used to deploy the model and make classifications or predictions.", "In summary, if we follow the classic setup and ignore the time dimension of our data as in option 1, we have no idea how the model will do on out-of-time data. In option 2, we at least have a measure of the model\u2019s out-of-time performance. However, it is only if we do something like in option 3 that we are building models with the intent to forecast the future. Regardless of what we do, retraining the model using all labeled data before making predictions seems like a good idea.", "I am hard-pressed finding examples of applications that don\u2019t have a time dimension. I suppose a pile of MRI images of which only some were labeled is one example, but my sense is that these one-off projects are rare. Moreover, while some processes are stable over time (e.g. weather or image classification \u2014 dog today will look the same as a dog tomorrow), processes such as customer behavior are bound to change over time. It is therefore surprising that the discussions (and implementation) of out-of-time testing and validation are not more ubiquitous. Chances are that out-of-time performance is worse than in-time, particularly if you have lots of in-time labeled data, not a very long time series, and a non-stationary process. However, not doing some out-of-time evaluation could haunt developers as subsequent data will show that the model performed worse than the in-time performance measures indicated.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a Professor of Economics at Union College in Schenectady, NY. I spent my last sabbatical on the data science team at a local health insurer."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7397098c4ab6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://dvorakt.medium.com/?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": ""}, {"url": "https://dvorakt.medium.com/?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": "Tomas Dvorak"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F47a548d2efb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&user=Tomas+Dvorak&userId=47a548d2efb1&source=post_page-47a548d2efb1----7397098c4ab6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7397098c4ab6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7397098c4ab6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://machinelearningmastery.com/difference-test-validation-datasets/", "anchor_text": "terminology sometimes differs"}, {"url": "http://users.rowan.edu/~polikar/RESEARCH/PUBLICATIONS/tnn11.pdf", "anchor_text": "sub-field"}, {"url": "http://www.rogermstein.com/wp-content/uploads/BenchmarkingDefaultPredictionModels_TR030124.pdf", "anchor_text": "Roger Stein"}, {"url": "https://forums.fast.ai/t/should-the-final-model-be-retrained-on-full-available-data-set-train-validation-not-test-after-validation/11748", "anchor_text": "disagreement online"}, {"url": "https://www.springer.com/us/book/9781461468486", "anchor_text": "Kuhn and Johnson"}, {"url": "http://cs229.stanford.edu/notes/cs229-notes5.pdf", "anchor_text": "lecture notes"}, {"url": "https://machinelearningmastery.com/difference-between-a-parameter-and-a-hyperparameter/", "anchor_text": "distinction between model parameters and hyper-parameters"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7397098c4ab6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/validation?source=post_page-----7397098c4ab6---------------validation-----------------", "anchor_text": "Validation"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----7397098c4ab6---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/tag/practical-guides?source=post_page-----7397098c4ab6---------------practical_guides-----------------", "anchor_text": "Practical Guides"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----7397098c4ab6---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7397098c4ab6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&user=Tomas+Dvorak&userId=47a548d2efb1&source=-----7397098c4ab6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7397098c4ab6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&user=Tomas+Dvorak&userId=47a548d2efb1&source=-----7397098c4ab6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7397098c4ab6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7397098c4ab6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7397098c4ab6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7397098c4ab6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7397098c4ab6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7397098c4ab6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7397098c4ab6--------------------------------", "anchor_text": ""}, {"url": "https://dvorakt.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://dvorakt.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tomas Dvorak"}, {"url": "https://dvorakt.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "58 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F47a548d2efb1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&user=Tomas+Dvorak&userId=47a548d2efb1&source=post_page-47a548d2efb1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F47a548d2efb1%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-isnt-out-of-time-validation-more-ubiquitous-7397098c4ab6&user=Tomas+Dvorak&userId=47a548d2efb1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}