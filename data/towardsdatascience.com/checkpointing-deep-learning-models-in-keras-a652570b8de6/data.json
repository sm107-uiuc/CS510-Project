{"url": "https://towardsdatascience.com/checkpointing-deep-learning-models-in-keras-a652570b8de6", "time": 1683004144.766173, "path": "towardsdatascience.com/checkpointing-deep-learning-models-in-keras-a652570b8de6/", "webpage": {"metadata": {"title": "Checkpointing Deep Learning Models in Keras | by Renu Khandelwal | Towards Data Science", "h1": "Checkpointing Deep Learning Models in Keras", "description": "In this article, you will learn how to checkpoint a deep learning model built using Keras and then reinstate the model architecture and trained weights to a new model or resume the training from you\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/arshren/save-and-load-model-and-weights/blob/master/Fashion%20MNIST-Save%20and%20load%20models.ipynb", "anchor_text": "code for saving the model and reloading model using Fashion MNIST", "paragraph_index": 28}], "all_paragraphs": ["Different methods to save and load the deep learning model are using", "In this article, you will learn how to checkpoint a deep learning model built using Keras and then reinstate the model architecture and trained weights to a new model or resume the training from you left off", "It acts like an autosave for your model in case training is interrupted for any reason.", "We have created the multi-class classification model for Fashion MNIST dataset", "Specify the path where the checkpoint files will be stored", "Create the callback function to save the model.", "Callback functions are applied at different stages of training to give a view on the internal training states.", "We create a callback function to save the model weights using ModelCheckpoint.", "If we set save_weight_only to True, then only the weights will be saved. Model architecture, loss, and the optimizer will not be saved.", "We can also specify if we want to save the model at every epoch or every n number of epochs.", "ModelCheckpoint callback class has the following arguments:", "Apply the callback during the training process", "We can see that if the val_loss does not improve, then the weights are not saved. Whenever the loss is reduced then those weights are saved to the checkpoint file", "Evaluating the model on test images", "Checkpoint file stores the trained weights to a collection of checkpoint formatted files in a binary format", "The TensorFlow save() saves three kinds of files: checkpoint file, index file, and data file. It stores the graph structure separately from the variable values.", "checkpoint file: contains prefixes for both an index file as well as for one or more data files", "data file: saves values for all the variables, without the structure. There can be one or more data files", "Reasons for loading the pre-trained weights", "We create a new model to load the pre-trained weights.", "When loading a new model with the pre-trained weights, the new model should have the same architecture as the original model.", "We load the pre-trained weights into our new model using load_weights().", "We can make inferences using the new model on the test images", "An untrained model will perform at chance levels (~10% accuracy)", "we see that the accuracy has changed now", "latest_checkoint() find the filename of the latest saved checkpoint file", "We create a new model, load the weights from the latest checkpoint and make inferences", "Including epoch number in the filename", "code for saving the model and reloading model using Fashion MNIST", "We now understand how to create a callback function using ModelCheckpoint class, the different checkpoint files that get created and then how we can restore the pre-trained weights", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A Technology Enthusiast who constantly seeks out new challenges by exploring cutting-edge technologies to make the world a better place!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa652570b8de6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a652570b8de6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a652570b8de6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arshren.medium.com/?source=post_page-----a652570b8de6--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=post_page-----a652570b8de6--------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35----a652570b8de6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa652570b8de6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa652570b8de6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@arshren/saving-and-loading-keras-model-42195b92f57a", "anchor_text": "JSON files"}, {"url": "https://medium.com/@arshren/saving-and-loading-keras-model-42195b92f57a", "anchor_text": "YAML files"}, {"url": "https://github.com/arshren/save-and-load-model-and-weights/blob/master/Fashion%20MNIST-Save%20and%20load%20models.ipynb", "anchor_text": "code for saving the model and reloading model using Fashion MNIST"}, {"url": "https://www.tensorflow.org/tutorials/keras/save_and_load", "anchor_text": "https://www.tensorflow.org/tutorials/keras/save_and_load"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a652570b8de6---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/keras?source=post_page-----a652570b8de6---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/python?source=post_page-----a652570b8de6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/checkpoints?source=post_page-----a652570b8de6---------------checkpoints-----------------", "anchor_text": "Checkpoints"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa652570b8de6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&user=Renu+Khandelwal&userId=31b07253bc35&source=-----a652570b8de6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa652570b8de6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&user=Renu+Khandelwal&userId=31b07253bc35&source=-----a652570b8de6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa652570b8de6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a652570b8de6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa652570b8de6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a652570b8de6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a652570b8de6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a652570b8de6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a652570b8de6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a652570b8de6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a652570b8de6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a652570b8de6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a652570b8de6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a652570b8de6--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://arshren.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb1cb44d62203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcheckpointing-deep-learning-models-in-keras-a652570b8de6&newsletterV3=31b07253bc35&newsletterV3Id=b1cb44d62203&user=Renu+Khandelwal&userId=31b07253bc35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}