{"url": "https://towardsdatascience.com/an-illustrative-introduction-to-dynamic-time-warping-36aa98513b98", "time": 1683014977.1501188, "path": "towardsdatascience.com/an-illustrative-introduction-to-dynamic-time-warping-36aa98513b98/", "webpage": {"metadata": {"title": "An Illustrative Introduction to Dynamic Time Warping | by Esmaeil Alizadeh | Towards Data Science", "h1": "An Illustrative Introduction to Dynamic Time Warping", "description": "Dynamic Time Warping (DTW) is a way to compare two -usually temporal- sequences that do not sync up perfectly. It is a method to calculate the optimal matching between two sequences. DTW is useful in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/slaypni/fastdtw", "anchor_text": "FastDTW", "paragraph_index": 13}, {"url": "https://pypi.org/project/scipy/", "anchor_text": "SciPy", "paragraph_index": 14}, {"url": "https://github.com/e-alizadeh/medium/blob/master/notebooks/intro_to_dtw.ipynb", "anchor_text": "here", "paragraph_index": 25}, {"url": "https://www.aaai.org/Papers/Workshops/1994/WS-94-03/WS94-03-031.pdf", "anchor_text": "Using Dynamic Time Warping to Find Patterns in Time Series", "paragraph_index": 26}, {"url": "https://cs.fit.edu/~pkc/papers/tdm04.pdf", "anchor_text": "FastDTW: Toward accurate dynamic time warping in linear time and space", "paragraph_index": 27}, {"url": "https://core.ac.uk/display/147806669", "anchor_text": "On the effect of endpoints on dynamic time warping", "paragraph_index": 28}, {"url": "https://ealizadeh.com", "anchor_text": "https://ealizadeh.com", "paragraph_index": 30}], "all_paragraphs": ["Dynamic Time Warping (DTW) is a way to compare two -usually temporal- sequences that do not sync up perfectly. It is a method to calculate the optimal matching between two sequences. DTW is useful in many domains such as speech recognition, data mining, financial markets, etc. It\u2019s commonly used in data mining to measure the distance between two time-series.", "In this post, we will go over the mathematics behind DTW. Then, two illustrative examples are provided to better understand the concept. If you are not interested in the math behind it, please jump to examples.", "Let\u2019s assume we have two sequences like the following:", "The sequences \ud835\udc4b and \ud835\udc4c can be arranged to form an \ud835\udc5b-by-\ud835\udc5a grid, where each point (\ud835\udc56, j) is the alignment between \ud835\udc65[\ud835\udc56] and \ud835\udc66[\ud835\udc57].", "A warping path \ud835\udc4a maps the elements of \ud835\udc4b and \ud835\udc4c to minimize the distance between them. \ud835\udc4a is a sequence of grid points (\ud835\udc56, \ud835\udc57). We will see an example of the warping path later.", "where \ud835\udc51 is the Euclidean distance. Then, the overall path cost can be calculated as", "The warping path is found using a dynamic programming approach to align two sequences. Going through all possible paths is \u201ccombinatorically explosive\u201d [1]. Therefore, for efficiency purposes, it\u2019s important to limit the number of possible warping paths, and hence the following constraints are outlined:", "In addition to the above three constraints, there are other less frequent conditions for an allowable warping path:", "An acceptable warping path has combinations of chess king moves that are:", "Let\u2019s import all python packages we need.", "Let\u2019s define a method to compute the accumulated cost matrix D for the warp path. The cost matrix uses the Euclidean distance to calculate the distance between every two points. The methods to compute the Euclidean distance matrix and accumulated cost matrix are defined below:", "In this example, we have two sequences x and y with different lengths.", "We cannot calculate the Euclidean distance between x and y since they don\u2019t have equal lengths.", "Many Python packages calculate the DTW by just providing the sequences and the type of distance (usually Euclidean). Here, we use a popular Python implementation of DTW that is FastDTW which is an approximate DTW algorithm with lower time and memory complexities [2].", "Note that we are using SciPy\u2019s distance function Euclidean that we imported earlier. For a better understanding of the warp path, let\u2019s first compute the accumulated cost matrix and then visualize the path on a grid. The following code will plot a heatmap of the accumulated cost matrix.", "The color bar shows the cost of each point in the grid. As can be seen, the warp path (blue line) is going through the lowest cost on the grid. Let\u2019s see the DTW distance and the warping path by printing these two variables.", "The warping path starts at point (0, 0) and ends at (4, 6) by 6 moves. Let\u2019s also calculate the accumulated cost most using the functions we defined earlier and compare the values with the heatmap.", "The cost matrix is printed above has similar values to the heatmap.", "Now let\u2019s plot the two sequences and connect the mapping points. The code to plot the DTW distance between x and y is given below.", "In this example, we will use two sinusoidal signals and see how they will be matched by calculating the DTW distance between them.", "Just like Example 1, let\u2019s calculate the DTW distance and the warp path for x1 and x2 signals using FastDTW package.", "As can be seen in above figure, the DTW distance between the two signals is particularly powerful when the signals have similar patterns. The extrema (maximum and minimum points) between the two signals are correctly mapped. Moreover, unlike Euclidean distance, we may see many-to-one mapping when DTW distance is used, particularly if the two signals have different lengths.", "You may spot an issue with dynamic time warping from the figure above. Can you guess what it is?", "The issue is around the head and tail of time-series that do not properly match. This is because the DTW algorithm cannot afford the warping invariance for at the endpoints. In short, the effect of this is that a small difference at the sequence endpoints will tend to contribute disproportionately to the estimated similarity[3].", "DTW is an algorithm to find an optimal alignment between two sequences and a useful distance metric to have in our toolbox. This technique is useful when we are working with two non-linear sequences, particularly if one sequence is a non-linear stretched/shrunk version of the other. The warping path is a combination of \u201cchess king\u201d moves that starts from the head of two sequences and ends with their tails.", "You can find the Jupyter notebook for this blog post here. Thanks for reading!", "[1] Donald J. Berndt and James Clifford, Using Dynamic Time Warping to Find Patterns in Time Series, 3rd International Conference on Knowledge Discovery and Data Mining", "[2] Salvador, S. and P. Chan, FastDTW: Toward accurate dynamic time warping in linear time and space (2007), Intelligent Data Analysis", "[3] Diego Furtado Silva, et al., On the effect of endpoints on dynamic time warping (2016), SIGKDD Workshop on Mining and Learning from Time Series", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "https://ealizadeh.com | Engineer & Data Scientist in Permanent Beta: Learning, Improving, Evolving."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F36aa98513b98&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----36aa98513b98--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----36aa98513b98--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.ealizadeh.com/?source=post_page-----36aa98513b98--------------------------------", "anchor_text": ""}, {"url": "https://medium.ealizadeh.com/?source=post_page-----36aa98513b98--------------------------------", "anchor_text": "Esmaeil Alizadeh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F35a932e89ec1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&user=Esmaeil+Alizadeh&userId=35a932e89ec1&source=post_page-35a932e89ec1----36aa98513b98---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F36aa98513b98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F36aa98513b98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/getting-started", "anchor_text": "Getting Started"}, {"url": "https://github.com/slaypni/fastdtw", "anchor_text": "FastDTW"}, {"url": "https://pypi.org/project/scipy/", "anchor_text": "SciPy"}, {"url": "https://github.com/e-alizadeh/medium/blob/master/notebooks/intro_to_dtw.ipynb", "anchor_text": "here"}, {"url": "https://www.aaai.org/Papers/Workshops/1994/WS-94-03/WS94-03-031.pdf", "anchor_text": "Using Dynamic Time Warping to Find Patterns in Time Series"}, {"url": "https://cs.fit.edu/~pkc/papers/tdm04.pdf", "anchor_text": "FastDTW: Toward accurate dynamic time warping in linear time and space"}, {"url": "https://core.ac.uk/display/147806669", "anchor_text": "On the effect of endpoints on dynamic time warping"}, {"url": "https://nipunbatra.github.io/blog/ml/2014/05/01/dtw.html", "anchor_text": "https://nipunbatra.github.io/blog/ml/2014/05/01/dtw.html"}, {"url": "https://databricks.com/blog/2019/04/30/understanding-dynamic-time-warping.html", "anchor_text": "https://databricks.com/blog/2019/04/30/understanding-dynamic-time-warping.html"}, {"url": "https://medium.com/tag/pattern-recognition?source=post_page-----36aa98513b98---------------pattern_recognition-----------------", "anchor_text": "Pattern Recognition"}, {"url": "https://medium.com/tag/python?source=post_page-----36aa98513b98---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----36aa98513b98---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/dynamic-programming?source=post_page-----36aa98513b98---------------dynamic_programming-----------------", "anchor_text": "Dynamic Programming"}, {"url": "https://medium.com/tag/getting-started?source=post_page-----36aa98513b98---------------getting_started-----------------", "anchor_text": "Getting Started"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F36aa98513b98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&user=Esmaeil+Alizadeh&userId=35a932e89ec1&source=-----36aa98513b98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F36aa98513b98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&user=Esmaeil+Alizadeh&userId=35a932e89ec1&source=-----36aa98513b98---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F36aa98513b98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----36aa98513b98--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F36aa98513b98&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----36aa98513b98---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----36aa98513b98--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----36aa98513b98--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----36aa98513b98--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----36aa98513b98--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----36aa98513b98--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----36aa98513b98--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----36aa98513b98--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----36aa98513b98--------------------------------", "anchor_text": ""}, {"url": "https://medium.ealizadeh.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.ealizadeh.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Esmaeil Alizadeh"}, {"url": "https://medium.ealizadeh.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "226 Followers"}, {"url": "https://ealizadeh.com", "anchor_text": "https://ealizadeh.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F35a932e89ec1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&user=Esmaeil+Alizadeh&userId=35a932e89ec1&source=post_page-35a932e89ec1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7f92962e06d6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-illustrative-introduction-to-dynamic-time-warping-36aa98513b98&newsletterV3=35a932e89ec1&newsletterV3Id=7f92962e06d6&user=Esmaeil+Alizadeh&userId=35a932e89ec1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}