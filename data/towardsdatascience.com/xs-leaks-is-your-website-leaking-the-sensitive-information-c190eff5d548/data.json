{"url": "https://towardsdatascience.com/xs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548", "time": 1683007581.202102, "path": "towardsdatascience.com/xs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548/", "webpage": {"metadata": {"title": "Is your website leaking sensitive information? | by Tuan Nhu Dinh | Towards Data Science", "h1": "Is your website leaking sensitive information?", "description": "Most developers are familiar and aware of the security vulnerabilities XSS (Cross-site scripting), CSRF (Cross-site request forgery) or SQL Injection, but there has been a lack of attention for\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=L5l9lSnNMxg", "anchor_text": "XSS", "paragraph_index": 0}, {"url": "https://www.youtube.com/watch?v=vRBihr41JTo", "anchor_text": "CSRF", "paragraph_index": 0}, {"url": "https://www.youtube.com/watch?v=_jKylhJtPmI", "anchor_text": "SQL Injection", "paragraph_index": 0}, {"url": "http://patorjk.com/blog/2013/03/01/facebook-user-identification-bug/", "anchor_text": "reported bug", "paragraph_index": 2}, {"url": "https://www.tomanthony.co.uk/blog/facebook-bug-confirm-user-identities/", "anchor_text": "reported bug", "paragraph_index": 4}, {"url": "https://github.com/xsleaks/xsleaks/wiki/Links", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Clickjacking", "anchor_text": "clickjacking", "paragraph_index": 7}, {"url": "https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html", "anchor_text": "link", "paragraph_index": 10}], "all_paragraphs": ["Most developers are familiar and aware of the security vulnerabilities XSS (Cross-site scripting), CSRF (Cross-site request forgery) or SQL Injection, but there has been a lack of attention for XSLeaks (cross-site leaks) which can result in the leaking of user information. In this blog, I am going to give a brief introduction to it.", "XSLeaks is a class of vulnerabilities where a third party malicious website is able to send requests or redirect users to the target services and then measure side channel signals (e.g. time of the response, static resources caches in browser, HTTP response status code, response content, etc ..) to infer and gather information about users based on such side channel signals.", "In 2013, there was a reported bug that allowed a website to use Facebook to detect if a visitor was a particular person. The preview-image for a Facebook Badge was dynamically generated based on a user\u2019s Facebook ID at that time. If user 1234567 was logged in, the image would look something like Fig1. If other users tried to load the badge image for user 1234567, a Facebook logo image was loaded instead of the profile image (Fig2). Basically, only the user themselves could view their profile badge preview.", "Even though Facebook had well blocked the information of name and email address, it still leaked the user identity. Hacker could use a JavaScript to silently load profile bade previews for a list of predefined user ids and then check the height and width of the response image to know that a particular user was viewing their page.", "If the above example is quite outdated for you, there is another reported bug in mid-2018. Tom Anthony discovered a way that could achieve a similar result. Today, most Facebook backend endpoints are well protected compared to 2013, they are loaded with access-control-allow-origin, x-frame-options headers to prevent the malicious website to embed and investigate the FB content using XHR request, iframe, image tag, \u2026. However, Tom found out one api (with user ID as a param) gave different content-type for matched user and non-matched user. He then used a simple JavaScript script that would take a list of user IDs and generate many script tags with src equals to the endpoint. The script tags would of course fail but they fail in different ways due to the differences in response content type, and it can be detected via onload and onerror event handlers. Moreover, there did not seem to have any sort of rate limiting for that endpoint and he could check thousands of IDs for a minute.", "If the above bugs were not fixed, people could have used them to stalk particular people (such as the boss, ex-girlfriend, celebrities ..) reading their blogs or they could show different contents depending on who was visiting. More real world examples about XS-Leak attacks can be found here.", "The nature of web application generally ends up with a large number of web-exposed endpoints revealing sensitive data about users and browser implementation makes the websites easily vulnerable to XSLeak attacks. Luckily, XSLeak is firmly on the radar of browser makers and there are some mechanisms to avoid it.", "Using X-Frame-Options: DENY results any attempt to load your page in a frame fail. It does not only defend against clickjacking but it also helps to defend against XSLeaks. If the page needs to be embedded in other sites (ads, widgets, and so on) the information contained inside it should be as constant and predictable as possible.", "In some cases, malicious websites can delete the cache for a specific resource of the attacked sites, force the browser to render those information again and check if the browser really caches the resource that was originally deleted. This allows an attacker to figure out if a website loads a specific resource (such as an image, script, or stylesheet) and results in identifying a user or disclosing some information about him.", "Strict same-site cookies can help to avoid the above cases as it differentiates between requests generated by the user manually typing a URL, clicking a bookmark, or clicking on a link from the current site vs. requests initiated by other websites.", "You can refer to this link for more details about this kind of attack.", "Modern browsers implement sec fetch headers to provide servers more context of the circumstances of why/where the request was triggered. Those information help servers quickly reject requests based on testing a set of preconditions.", "For example, a request generated by a img element would result in a request containing the following HTTP request headers:", "The server can implement a policy checking over the endpoint and quickly reject the request of non-image content using Sec-Fetch-Dest.", "Research in the field of XSLeak attacks is ongoing and I do believe there will be more techniques revealing in the next few years. As a developer, it is important to realise how serious the issue is and start paying more attention to protect your websites from this kind of attack.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc190eff5d548&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c190eff5d548--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c190eff5d548--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nhudinhtuan?source=post_page-----c190eff5d548--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nhudinhtuan?source=post_page-----c190eff5d548--------------------------------", "anchor_text": "Tuan Nhu Dinh"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6aa205a81381&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&user=Tuan+Nhu+Dinh&userId=6aa205a81381&source=post_page-6aa205a81381----c190eff5d548---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc190eff5d548&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc190eff5d548&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/fPxOowbR6ls", "anchor_text": "source"}, {"url": "https://www.youtube.com/watch?v=L5l9lSnNMxg", "anchor_text": "XSS"}, {"url": "https://www.youtube.com/watch?v=vRBihr41JTo", "anchor_text": "CSRF"}, {"url": "https://www.youtube.com/watch?v=_jKylhJtPmI", "anchor_text": "SQL Injection"}, {"url": "http://patorjk.com/blog/2013/03/01/facebook-user-identification-bug/", "anchor_text": "reported bug"}, {"url": "https://www.tomanthony.co.uk/blog/facebook-bug-confirm-user-identities/", "anchor_text": "reported bug"}, {"url": "https://github.com/xsleaks/xsleaks/wiki/Links", "anchor_text": "here"}, {"url": "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options", "anchor_text": "X-Frame-Options"}, {"url": "https://en.wikipedia.org/wiki/Clickjacking", "anchor_text": "clickjacking"}, {"url": "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite", "anchor_text": "SameSite cookies"}, {"url": "https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html", "anchor_text": "link"}, {"url": "https://www.w3.org/TR/fetch-metadata/", "anchor_text": "Fetch Metadata request headers"}, {"url": "https://portswigger.net/research/xs-leak-leaking-ids-using-focus", "anchor_text": "https://portswigger.net/research/xs-leak-leaking-ids-using-focus"}, {"url": "https://github.com/xsleaks/xsleaks/wiki/Defenses", "anchor_text": "https://github.com/xsleaks/xsleaks/wiki/Defenses"}, {"url": "http://patorjk.com/blog/2013/03/01/facebook-user-identification-bug/", "anchor_text": "http://patorjk.com/blog/2013/03/01/facebook-user-identification-bug/"}, {"url": "https://www.tomanthony.co.uk/blog/facebook-bug-confirm-user-identities/", "anchor_text": "https://www.tomanthony.co.uk/blog/facebook-bug-confirm-user-identities/"}, {"url": "https://portswigger.net/daily-swig/new-xs-leak-techniques-reveal-fresh-ways-to-expose-user-information", "anchor_text": "https://portswigger.net/daily-swig/new-xs-leak-techniques-reveal-fresh-ways-to-expose-user-information"}, {"url": "https://medium.com/bugbountywriteup/cross-site-content-and-status-types-leakage-ef2dab0a492", "anchor_text": "https://medium.com/bugbountywriteup/cross-site-content-and-status-types-leakage-ef2dab0a492"}, {"url": "https://scarybeastsecurity.blogspot.com/2009/12/cross-domain-search-timing.html", "anchor_text": "https://scarybeastsecurity.blogspot.com/2009/12/cross-domain-search-timing.html"}, {"url": "https://medium.com/tag/security?source=post_page-----c190eff5d548---------------security-----------------", "anchor_text": "Security"}, {"url": "https://medium.com/tag/xss-attack?source=post_page-----c190eff5d548---------------xss_attack-----------------", "anchor_text": "Xss Attack"}, {"url": "https://medium.com/tag/vulnerability?source=post_page-----c190eff5d548---------------vulnerability-----------------", "anchor_text": "Vulnerability"}, {"url": "https://medium.com/tag/web-development?source=post_page-----c190eff5d548---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/tag/javascript?source=post_page-----c190eff5d548---------------javascript-----------------", "anchor_text": "JavaScript"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc190eff5d548&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&user=Tuan+Nhu+Dinh&userId=6aa205a81381&source=-----c190eff5d548---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc190eff5d548&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&user=Tuan+Nhu+Dinh&userId=6aa205a81381&source=-----c190eff5d548---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc190eff5d548&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c190eff5d548--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc190eff5d548&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c190eff5d548---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c190eff5d548--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c190eff5d548--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c190eff5d548--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c190eff5d548--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c190eff5d548--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c190eff5d548--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c190eff5d548--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c190eff5d548--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nhudinhtuan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nhudinhtuan?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tuan Nhu Dinh"}, {"url": "https://medium.com/@nhudinhtuan/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6aa205a81381&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&user=Tuan+Nhu+Dinh&userId=6aa205a81381&source=post_page-6aa205a81381--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F383333807951&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fxs-leaks-is-your-website-leaking-the-sensitive-information-c190eff5d548&newsletterV3=6aa205a81381&newsletterV3Id=383333807951&user=Tuan+Nhu+Dinh&userId=6aa205a81381&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}