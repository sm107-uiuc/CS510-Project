{"url": "https://towardsdatascience.com/sql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377", "time": 1683017145.697333, "path": "towardsdatascience.com/sql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377/", "webpage": {"metadata": {"title": "SQL Unit Testing in BigQuery? Here is a tutorial | by \ud83d\udca1Mike Shakhomirov | Towards Data Science", "h1": "SQL Unit Testing in BigQuery? Here is a tutorial", "description": "Since Google BigQuery introduced Dynamic SQL it has become a lot easier to run repeating tasks with scripting jobs. Now we can do unit tests for datasets and UDFs in this popular data warehouse. Our\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting#declare", "anchor_text": "scripting", "paragraph_index": 0}, {"url": "https://github.com/mshakhomirov/bigquery_unit_tests", "anchor_text": "repository", "paragraph_index": 2}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting#declare", "anchor_text": "BigQuery scripting", "paragraph_index": 44}, {"url": "http://linktr.ee/mshakhomirov", "anchor_text": "linktr.ee/mshakhomirov", "paragraph_index": 66}], "all_paragraphs": ["Since Google BigQuery introduced Dynamic SQL it has become a lot easier to run repeating tasks with scripting jobs. Now we can do unit tests for datasets and UDFs in this popular data warehouse.", "This tutorial aims to answers the following questions:", "All scripts and UDF are free to use and can be downloaded from the repository.", "Our test will be a stored procedure and will test the execution of a big SQL statement which consists of two parts:", "First part generates a source dataset to work with. Here we will need to test that data was generated correctly.", "The second one will test the logic behind the user-defined function (UDF) that will be later applied to a source dataset to transform it.", "All the datasets are included. They are just a few records and it won\u2019t cost you anything to run it in BigQuery.", "It is for everyone who would like to:", "I have run into a problem where we keep having complex SQL queries go out with errors.", "Chaining SQL statements and missing data always was a problem for me.", "That\u2019s why, it is good to have SQL unit tests in BigQuery so that they can not only save time but also help to standardize our overall datawarehouse development and testing strategy contributing to streamlining database lifecycle management process.", "A typical SQL unit testing scenario is as follows:", "During this process you\u2019d usually decompose those long functions into smaller functions, each with a single clearly defined responsibility and test them in isolation.", "I would do the same with long SQL queries, break down into smaller ones because each view adds only one transformation, each can be independently tested to find errors, and the tests are simple.", "Let\u2019s imagine we have some base table which we need to test. For this example I will use a sample with user transactions. This is a very common case for many mobile applications where users can make in-app purchases, for example, subscriptions and they may or may not expire in the future.", "Run this SQL below for testData1 to see this table example. It\u2019s a CTE and it contains information, e.g. user_id, product_id, transaction_id, created_at (a timestamp when this transaction was created) and expire_time_after_purchase which is a timestamp expiration for that subscription.", "Test table testData1 will imitate a real-life scenario from our resulting table which represents a list of in-app purchases for a mobile application.", "I want to be sure that this base table doesn\u2019t have duplicates. For example, \u2018For every (transaction_id) there is one and only one (created_at):", "Now let\u2019s test it\u2019s consecutive, e.g. our base table is sorted in the way we need it. Even though BigQuery works with sets and doesn\u2019t use internal sorting we can ensure that our table is sorted, e.g. consequtive numbers of transactions are in order with created_at timestmaps:", "Now let\u2019s wrap these two tests together with UNION ALL:", "Decompose your queries, just like you decompose your functions.", "This makes them shorter, and easier to understand, easier to test. When they are simple it is easier to refactor. And it allows you to add extra things between them, and wrap them with other useful ones, just as you do in procedural code.", "So every significant thing a query does can be transformed into a view.", "Then you can create more complex queries out of these simpler views, just as you compose more complex functions out of more primitive functions.", "And the great thing is, for most compositions of views, you\u2019ll get exactly the same performance.", "Indeed, BigQuery works with sets so decomposing your data into the views won\u2019t change anything. Even amount of processed data will remain the same.", "Now let\u2019s imagine that our testData1 dataset which we created and tested above will be passed into a function. We might want to do that if we need to iteratively process each row and the desired outcome can\u2019t be achieved with standard SQL.", "In this example we are going to \u201cstack up\u201d expire_time_after_purchase based on previous value and the fact that the previous purchase expired or not.", "Then we need to test the UDF responsible for this logic. We will also create a nifty script that does this trick.", "Our user-defined function is BigQuery UDF built with Java Script.", "Here is our UDF that will process an ARRAY of STRUCTs (columns) according to our business logic.", "Run this example with UDF (just add this code in the end of the previous SQL where we declared UDF) to see how the source table from testData1 will be processed:", "What we need to test now is how this function calculates newexpire_time_after_purchase time. You can see it under `processed` column. It\u2019s a nested field by the way.", "It\u2019s a nice and easy way to work with table data because you can pass into a function as a whole and implement any business logic you need.", "I will now create a series of tests for this and then I will use a BigQuery script to iterate through each testing use case to see if my UDF function fails.", "But first we will need an `expected` value for each test.", "Let\u2019s slightly change our testData1 and add `expected` column for our unit test:", "and also add expected to our UDF:", "So our final script will look like this:", "expected column will help us to understand where UDF fails if we change it. For example change it to this and run the script again. You will see straight away where it fails:", "Now let\u2019s imagine that we need a clear test for a particular case when the data has changed. By `clear` I mean the situation which is easier to understand.", "Of course, we could add that second scenario into our 1st test for UDF but separating and simplifying makes a code esier to understand, replicate and use later.", "Let\u2019s say we have a purchase that expired inbetween. In the exmaple below purchase with transaction 70000001 expired at 2021\u201301\u201322 09:01:00 and stucking MUST stop here until the next purchase.", "Now we could use UNION ALL to run a SELECT query for each test case and by doing so generate the test output. However that might significantly increase the test.sql file size and make it much more difficult to read.", "Instead it would be much better to user BigQuery scripting to iterate through each test case\u2019s data, generate test results for each case and insert all results into one table in order to produce one single output.", "BigQuery scripting enables you to send multiple statements to BigQuery in one request, to use variables, and to use control flow statements such as IF and WHILE.", "If you reverse engineer a stored procedure it is typically a set of SQL scripts that are frequently used to serve the purpose.", "I will put our tests, which are just queries, into a file, and run that script against the database. Indeed, if we store our view definitions in a script (or scripts) to be run against the data, we can add our tests for each view to the same script.", "That way, we both get regression tests when we re-create views and UDFs, and, when the view or UDF test runs against production, the view will will also be tested in production.", "To create a persistent UDF, use the following SQL:", "Great! Now it is stored in your project and we don\u2019t need to create it each time again.", "Let\u2019s wrap it all up with a stored procedure:", "Now if you run the script above in BigQuery you will get:", "Now in ideal scenario we probably would like to chain our isolated unit tests all together and perform them all in one procedure.", "Let\u2019s chain first two checks from the very beginning with our UDF checks:", "Now let\u2019s do one more thing (optional) \u2014 convert our test results to a JSON string. Who knows, maybe you\u2019d like to run your test script programmatically and get a result as a response in ONE JSON row.", "Let\u2019s simply change the ending of our stored procedure to this:", "We can extend our use case to perform the healthchecks on real data.", "Just point the script to use real tables and schedule it to run in BigQuery.", "For example, let\u2019s imagine our pipeline is up and running processing new records. What I would like to do is to monitor every time it does the transformation and data load.", "One of the ways you can guard against reporting on a faulty data upstreams is by adding health checks using the BigQuery ERROR() function.", "We can now schedule this query to run hourly for example and receive notification if error was raised:", "In this case BigQuery will send an email notification and other downstream processes will be stopped.", "We have created a stored procedure to run unit tests in BigQuery. This makes SQL more reliable and helps to identify flaws and errors in data streams.", "This tutorial provides unit testing template which could be used to:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "BigData Engineer | Full stack dev | I write about ML/AI in Digital marketing. | linktr.ee/mshakhomirov | @MShakhomirov"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F64fc7a6b377&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mshakhomirov.medium.com/?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": ""}, {"url": "https://mshakhomirov.medium.com/?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": "\ud83d\udca1Mike Shakhomirov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe06a48b3dd48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&user=%F0%9F%92%A1Mike+Shakhomirov&userId=e06a48b3dd48&source=post_page-e06a48b3dd48----64fc7a6b377---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64fc7a6b377&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64fc7a6b377&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@florianolv?utm_source=medium&utm_medium=referral", "anchor_text": "Florian Olivo"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting#declare", "anchor_text": "scripting"}, {"url": "https://github.com/mshakhomirov/bigquery_unit_tests", "anchor_text": "repository"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting#declare", "anchor_text": "BigQuery scripting"}, {"url": "https://stackoverflow.com/questions/754527/best-way-to-test-sql-queries", "anchor_text": "Best way to test SQL queriesAsked Closed. This question is opinion-based. It is not currently accepting answers. Want to improve this question\u2026stackoverflow.com"}, {"url": "https://stackoverflow.com/questions/46299703/updating-a-value-in-an-array-in-a-bigquery-table", "anchor_text": "Updating a value in an ARRAY in a BigQuery tableThanks for contributing an answer to Stack Overflow! Please be sure to answer the question. Provide details and share\u2026stackoverflow.com"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting#declare", "anchor_text": "Scripting in Standard SQL | BigQuery | Google CloudBigQuery scripting enables you to send multiple statements to BigQuery in one request, to use variables, and to use\u2026cloud.google.com"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/array_functions#array_reverse", "anchor_text": "Array functions in Standard SQL | BigQuery | Google CloudWhether your business is early in its journey or well on its way to digital transformation, Google Cloud's solutions\u2026cloud.google.com"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/arrays#accessing_array_elements", "anchor_text": "Working with arrays in Standard SQL | BigQuery | Google CloudWhether your business is early in its journey or well on its way to digital transformation, Google Cloud's solutions\u2026cloud.google.com"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types#declaring_a_struct_type", "anchor_text": "Data types in Standard SQL | BigQuery | Google CloudBigQuery supports simple data types such as integers, as well as more complex types such as ARRAY and STRUCT. This page\u2026cloud.google.com"}, {"url": "https://stackoverflow.com/questions/49349604/cast-datetime-to-string-working-on-array-of-struct-on-bigquery-standard-sql/49349848", "anchor_text": "Cast DATETIME to STRING working on ARRAY of STRUCT on BigQuery Standard SQLin my table I have an attribute called 'messages' with this exact data type: ARRAY , id STRING, message STRING>> and I\u2026stackoverflow.com"}, {"url": "https://stackoverflow.com/questions/57663983/how-to-check-if-sql-records-are-in-a-specific-order", "anchor_text": "How to check if SQL records are in a specific orderThanks for contributing an answer to Stack Overflow! Please be sure to answer the question. Provide details and share\u2026stackoverflow.com"}, {"url": "https://wideops.com/whats-happening-in-bigquery-new-features-bring-flexibility-and-scale-to-your-data-warehouse/", "anchor_text": "What's happening in BigQuery: New features bring flexibility and scale to your data warehouseWe've been busy releasing new features for BigQuery, Google Cloud's petabyte-scale data warehouse. BigQuery lets you\u2026wideops.com"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/array_functions", "anchor_text": "Array functions in Standard SQL | BigQuery | Google CloudWhether your business is early in its journey or well on its way to digital transformation, Google Cloud's solutions\u2026cloud.google.com"}, {"url": "https://stackoverflow.com/questions/42231454/bigquery-fails-to-save-view-that-uses-functions", "anchor_text": "BigQuery fails to save view that uses functionsWe're using BigQuery with their new dialect of \" standard\" SQL. the new SQL supports inline functions written in SQL\u2026stackoverflow.com"}, {"url": "https://stackoverflow.com/questions/58838199/create-table-statement-with-repeated-nested-column-in-bigquery", "anchor_text": "Create table statement with repeated nested column in BigQueryThanks for contributing an answer to Stack Overflow! Please be sure to answer the question. Provide details and share\u2026stackoverflow.com"}, {"url": "https://cloud.google.com/blog/products/data-analytics/whats-happening-in-bigquery-new-features-bring-flexibility-and-scale-to-your-data-warehouse", "anchor_text": "Cloud data warehousing with scripting, stored procedures | Google Cloud BlogDECLARE heads BOOL; DECLARE heads_count INT64 DEFAULT 0; LOOP SET heads = RAND() < 0.5; IF heads THEN SELECT 'Heads!'\u2026cloud.google.com"}, {"url": "https://cloud.google.com/blog/products/data-analytics/command-and-control-now-easier-in-bigquery-with-scripting-and-stored-procedures", "anchor_text": "https://cloud.google.com/blog/products/data-analytics/command-and-control-now-easier-in-bigquery-with-scripting-and-stored-procedures"}, {"url": "https://cloud.google.com/bigquery/docs/reference/standard-sql/user-defined-functions", "anchor_text": "Standard SQL user-defined functions | BigQuery | Google CloudEdit descriptioncloud.google.com"}, {"url": "https://towardsdatascience.com/how-to-use-dynamic-sql-in-bigquery-8c04dcc0f0de", "anchor_text": "How to use Dynamic SQL in BigQueryFormat a string, and use EXECUTE IMMEDIATEtowardsdatascience.com"}, {"url": "https://stackoverflow.com/questions/57605272/how-to-create-array-of-nested-fields-and-arrays-in-bigquery", "anchor_text": "How to create array of nested fields and arrays in BigQueryI am trying to create a table in BigQuery according to a json schema which I will put in GCS and push to a pub/sub\u2026stackoverflow.com"}, {"url": "https://stackoverflow.com/questions/41695231/passing-array-of-structs-into-user-defined-function-for-standard-bigquery-sql", "anchor_text": "Passing ARRAY of STRUCTs into user-defined function for standard BigQuery SQLHow would I got about passing an ARRAY of STRUCTS into my user-defined function (using standard SQL)?stackoverflow.com"}, {"url": "https://stackoverflow.com/questions/51791990/convert-arraystruct-to-multiple-columns-in-bigquery-sql", "anchor_text": "Convert ARRAY to multiple columns in BigQuery SQLThanks for contributing an answer to Stack Overflow! Please be sure to answer the question. Provide details and share\u2026stackoverflow.com"}, {"url": "https://www.qwiklabs.com/focuses/3696?parent=catalog", "anchor_text": "Working with JSON, Arrays, and Structs in BigQuery | Qwiklabs1 hour 15 minutes 5 Credits BigQuery is Google's fully managed, NoOps, low cost analytics database. With BigQuery you\u2026www.qwiklabs.com"}, {"url": "https://stackoverflow.com/questions/41597314/is-there-an-easy-way-to-convert-rows-in-bigquery-to-json", "anchor_text": "Is there an easy way to convert rows in BigQuery to JSON?Thanks for contributing an answer to Stack Overflow! Please be sure to answer the question. Provide details and share\u2026stackoverflow.com"}, {"url": "https://stackoverflow.com/questions/59396443/iterate-over-rows-in-stored-procedure-bigquery", "anchor_text": "Iterate over rows in Stored Procedure BigQueryIs there a way to fetch a query result inside a stored procedure and then iterate over the rows in BigQuery? Having\u2026stackoverflow.com"}, {"url": "https://stackoverflow.com/questions/63147752/how-to-declare-variable-inside-bigquery-udf-body", "anchor_text": "How to declare variable inside BigQuery UDF body?Context: I'm trying to build a function to apply title case to a string. Instead of answering directly the question - I\u2026stackoverflow.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----64fc7a6b377---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/big-data?source=post_page-----64fc7a6b377---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/tag/unit-testing?source=post_page-----64fc7a6b377---------------unit_testing-----------------", "anchor_text": "Unit Testing"}, {"url": "https://medium.com/tag/analytics?source=post_page-----64fc7a6b377---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----64fc7a6b377---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F64fc7a6b377&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&user=%F0%9F%92%A1Mike+Shakhomirov&userId=e06a48b3dd48&source=-----64fc7a6b377---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F64fc7a6b377&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&user=%F0%9F%92%A1Mike+Shakhomirov&userId=e06a48b3dd48&source=-----64fc7a6b377---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F64fc7a6b377&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F64fc7a6b377&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----64fc7a6b377---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----64fc7a6b377--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----64fc7a6b377--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----64fc7a6b377--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----64fc7a6b377--------------------------------", "anchor_text": ""}, {"url": "https://mshakhomirov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mshakhomirov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "\ud83d\udca1Mike Shakhomirov"}, {"url": "https://mshakhomirov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.2K Followers"}, {"url": "http://linktr.ee/mshakhomirov", "anchor_text": "linktr.ee/mshakhomirov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe06a48b3dd48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&user=%F0%9F%92%A1Mike+Shakhomirov&userId=e06a48b3dd48&source=post_page-e06a48b3dd48--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9d2ef9c7b433&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377&newsletterV3=e06a48b3dd48&newsletterV3Id=9d2ef9c7b433&user=%F0%9F%92%A1Mike+Shakhomirov&userId=e06a48b3dd48&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}