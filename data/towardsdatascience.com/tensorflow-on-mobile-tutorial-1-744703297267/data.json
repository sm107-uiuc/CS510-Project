{"url": "https://towardsdatascience.com/tensorflow-on-mobile-tutorial-1-744703297267", "time": 1682993227.8444018, "path": "towardsdatascience.com/tensorflow-on-mobile-tutorial-1-744703297267/", "webpage": {"metadata": {"title": "TensorFlow on Mobile: Tutorial. On Android and iOS | by SAGAR SHARMA | Towards Data Science", "h1": "TensorFlow on Mobile: Tutorial", "description": "TensorFlow is usually used for training huge models from tons of data but no one can ignore the emerging market of smartphones and the need to make our future \u201cArtificially Intelligent\u201d. And people\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/training-inception-with-tensorflow-on-custom-images-using-cpu-8ecd91595f26", "anchor_text": "Train Inception with Custom Images on CPU", "paragraph_index": 7}, {"url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/makefile/tf_op_files.txt", "anchor_text": "tensorflow/contrib/makefile/tf_op_files.txt", "paragraph_index": 15}, {"url": "https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/ios#building-the-tensorflow-ios-libraries-from-source", "anchor_text": "code", "paragraph_index": 35}, {"url": "https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip", "anchor_text": "Inception v1", "paragraph_index": 36}, {"url": "https://cocoapods.org/pods/TensorFlow-experimental", "anchor_text": "Tensorflow-experimental", "paragraph_index": 37}, {"url": "http://www.image-net.org/", "anchor_text": "Imagenet", "paragraph_index": 48}, {"url": "https://medium.com/@sagarsharma4244", "anchor_text": "Medium", "paragraph_index": 55}, {"url": "https://www.facebook.com/profile.php?id=100003188718299", "anchor_text": "Facebook", "paragraph_index": 55}, {"url": "https://twitter.com/SagarSharma4244", "anchor_text": "Twitter", "paragraph_index": 55}, {"url": "https://www.linkedin.com/in/sagar-sharma-232a06148/", "anchor_text": "LinkedIn", "paragraph_index": 55}, {"url": "https://plus.google.com/u/0/+SAGARSHARMA4244", "anchor_text": "Google+", "paragraph_index": 55}, {"url": "https://www.quora.com/profile/Sagar-Sharma-71", "anchor_text": "Quora", "paragraph_index": 55}, {"url": "https://towardsdatascience.com/epoch-vs-iterations-vs-batch-size-4dfb9c7ce9c9", "anchor_text": "Epoch vs Batch Size vs Iterations", "paragraph_index": 57}, {"url": "https://towardsdatascience.com/tensorflow-image-recognition-python-api-e35f7d412a70", "anchor_text": "TensorFlow Image Recognition Python API Tutorial On CPU", "paragraph_index": 58}, {"url": "https://medium.com/towards-data-science/activation-functions-neural-networks-1cbd9f8d91d6", "anchor_text": "Activation Function Explained: Neural Networks", "paragraph_index": 59}], "all_paragraphs": ["TensorFlow is usually used for training huge models from tons of data but no one can ignore the emerging market of smartphones and the need to make our future \u201cArtificially Intelligent\u201d. And people who can\u2019t wait for the future and love Machine Learning are pushing the boundaries by making tools, which target the multi-trillion dollar market.", "You are a part of this multi-trillion dollar market because you might be reading this on your Android or iOS right now or you have one in your pocket, whichever might be the case, you know how future oriented Machine Learning on Mobile is\u2026", "I\u2019ll be writing 2 different tutorials on how to run your Machine Learning Models on your Android and iOS devices.", "This tutorial uses a more stable version of tensorflow which is TensorFlow Mobile, so follow the steps on how to implement your models and make them Optimized for Mobiles.", "We are going to make an Image Classifier by Retraining the Final (Bottleneck) Layer of the Inception-v3 model and then Optimize the model for your smart devices.", "The tutorial contains only 5\u20136 steps:", "I\u2019m pretty sure you already know this step, since you are learning to run the same model on the smartphones.", "Also to keep this tutorials strictly focused on the Implementing models on the smartphones, I would recommend this quick tutorial \ud83d\udd39 Train Inception with Custom Images on CPU \ud83d\udd39 So we\u2019d be on the same page \ud83d\udcc4 and you can start the things in a new directory with a newly trained Model.", "FYI: The data \ud83d\udcd7 on which the model is trained contains types of Flowers which are Tulips \ud83c\udf37, Daisy, Sunflower \ud83c\udf3b, Dandelion and Roses \ud83c\udf39", "And after this you should have these two files:", "which contains a version of the selected network with a final layer retrained on your categories.", "which is a text file \ud83d\udcdd containing labels .", "Run the following command prompt (keep the path correct)", "It will create a new optimized model file tf_files/optimized_graph.pb", "Note: If you are getting an error KeyError: \u201cThe following input nodes were not found: {\u2018input\u2019}\\n\u201d then change \"input\" to \"Mul\".", "To reduce the pre-processing of an app and to decrease the size of the library at the same time, tensorflow only supports the subset of operations that are commonly used during inference. The operations which are not supported are tensorflow/contrib/makefile/tf_op_files.txt", "Now, just to make sure that whatever graph file we\u2019ve just created includes the supported operations as follows\u2026", "To make sure that your new optimized graph is running and the optimize_for_inference file that removes all nodes that aren\u2019t needed for a given set of input and outputs and hasn\u2019t altered the output of the network.", "Compare the output of the same image using the label_file on both the graph retrained_graph.pb with optimized_graph.pb", "Run these commands one by one and if both the outputs are identical that means optimized_graph.pb is created perfectly \ud83c\udf89", "The issue is still that the size of the model is still big and definitely not suitable for mobiles. Since, the majority of the space taken up by the graph is by the weights, which are large blocks of floating point numbers. Each weight has a slightly different floating point value, with very little regularity.", "But compression works by exploiting regularity in the data, which explains the failure here.", "Quantization helps to reduce the size of the neural network by factors, by performing quantization on the weights of the net. This gives a lot more repetition in the graph and helps significantly in the compression afterwards.", "Now use the quantize_graph script to apply changes to the graph:", "This will create a rounded_graph.pb file.", "You should see some significant improvement in the compression.", "Note: If you are getting any error when running the quantize_graph download this file and paste it in the tools/quantization /quantize_graph.py in the tensorflow library (wherever TensorFlow is installed).", "From here on the tutorial is divided into two sections Android and iOS.", "Add TensorFlow-experimental pod to your pod file, which installs a universal binary framework. This is the most easiest way to run tensorflow on iOS.", "\ud83d\udd39 Create your own app or load your already-created app in XCode.", "\ud83d\udd39Add a file named Podfile at the project root directory with the following content:", "\ud83d\udd39 Run pod install to download & install the TensorFlow-experimental pod.", "\ud83d\udd39 Open YourProjectName.xcworkspace and add your code.", "\ud83d\udd39 In your app\u2019s Build Settings, make sure to add $(inherited) to the Other Linker Flags, and Header Search Paths sections.", "You\u2019ll need Xcode 7.3 or later to run our iOS samples.", "There are three examples in simple, benchmark, and camera. You can clone the code.", "Also, download Inception v1 from root of tensorflow and extract the label and graph files into the data folders inside both the simple and camera examples using these steps:", "Change into one of the sample directories, download the Tensorflow-experimental pod, and open the Xcode workspace. Note that installing the pod can take a long time since it is big (~450MB). If you want to run the simple example, then:", "Run the simple app in the XCode simulator. You should see a single-screen app with a Run Model button. Tap that, and you should see a Grace Hopper image. Once you build and run that, you should get a live camera view that you can point at objects to get real-time recognition results.", "Note: I\u2019m pretty sure that I\u2019ve done some mistake or left something on the iOS section. Please go through the following official links and please comment down below if you get any error, the community will help you.", "There are two ways to do this Android Studio and Bazel. I\u2019ll be using AS since more people are familiar with it.", "If you don\u2019t have it installed already, go here and install it", "Just to check whether everything is working correctly in Android Studio, let\u2019s do a test run.", "\ud83d\udd38 Open Android Studio and select \u201c\ud83d\udcc1Open an existing Android Studio project\u201d.", "\ud83d\udd38 Open Build.gradle file and sync the Gradle. If everything works perfectly, click BUILD>BUILD APK button.", "Note: If you are new to Android Studio like me and having issues with something, comment below.", "Now a folder should come with the app.apk file, copy it in your phone and install it. Also, keep in mind to turn on the Developer Mode in your phone.", "If everything works fine till here, it\u2019s a cakewalk from now.", "The Default app is an classify images app with 1000 categories from Imagenet.", "Now, to run our customized app perform the following two steps:", "Right now the demo app is looking at the graph.pb file and label.txt file present in the android/tfmobile/assets not at your rounded_graph.pb and retrained_labels.txt", "Now, replace the files with the following command or you can do it manually.", "The output node for our model has a different name: \"final_result\". Open ClassifierActivity.java and update the OUTPUT_NAME variable as follows:", "Note: If you get any error or hit any wall comment below.", "\ufe0fI have tried to keep the article as exact and easy to understand as possible. Any comments, suggestions or if you have any queries, write it in the comments.", "For further Tutorials on how to use TensorFlow in Mobile apps follow me on Medium, Facebook, Twitter, LinkedIn, Google+, Quora to see similar posts.", "Clap it! Share it! Follow Me!", "2. Epoch vs Batch Size vs Iterations", "3. TensorFlow Image Recognition Python API Tutorial On CPU", "4. Activation Function Explained: Neural Networks", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Freelance Writer. React developer. Deep learning/AI Electronics \ud83d\udce9 sagarsharma4244@gmail.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F744703297267&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----744703297267--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----744703297267--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@sagarsharma4244?source=post_page-----744703297267--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sagarsharma4244?source=post_page-----744703297267--------------------------------", "anchor_text": "SAGAR SHARMA"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F165370addbb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&user=SAGAR+SHARMA&userId=165370addbb5&source=post_page-165370addbb5----744703297267---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F744703297267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F744703297267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://mossandfog.com/2017/10/06/design-verdict-iphone-x-vs-google-pixel-2-vs-samsung-galaxy-s8/", "anchor_text": "Source"}, {"url": "https://towardsdatascience.com/training-inception-with-tensorflow-on-custom-images-using-cpu-8ecd91595f26", "anchor_text": "Train Inception with Custom Images on CPU"}, {"url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/makefile/tf_op_files.txt", "anchor_text": "tensorflow/contrib/makefile/tf_op_files.txt"}, {"url": "https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/ios#building-the-tensorflow-ios-libraries-from-source", "anchor_text": "code"}, {"url": "https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip", "anchor_text": "Inception v1"}, {"url": "https://cocoapods.org/pods/TensorFlow-experimental", "anchor_text": "Tensorflow-experimental"}, {"url": "https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/ios#building-the-tensorflow-ios-libraries-from-source", "anchor_text": "https://github.com/tensorflow/tensorflow/tree/master/tensorflow/examples/ios#building-the-tensorflow-ios-libraries-from-source"}, {"url": "https://www.tensorflow.org/mobile/ios_build", "anchor_text": "Building TensorFlow on iOS | TensorFlowThe TensorFlow-experimental pod is current about ~450MB. The reason it is so big is because we are bundling multiple\u2026www.tensorflow.org"}, {"url": "https://developer.android.com/studio/index.html", "anchor_text": "Download Android Studio and SDK Tools | Android StudioDownload the official Android IDE and developer tools to build apps for Android phones, tablets, wearables, TVs, and\u2026developer.android.com"}, {"url": "http://www.image-net.org/", "anchor_text": "Imagenet"}, {"url": "https://medium.com/@sagarsharma4244", "anchor_text": "Medium"}, {"url": "https://www.facebook.com/profile.php?id=100003188718299", "anchor_text": "Facebook"}, {"url": "https://twitter.com/SagarSharma4244", "anchor_text": "Twitter"}, {"url": "https://www.linkedin.com/in/sagar-sharma-232a06148/", "anchor_text": "LinkedIn"}, {"url": "https://plus.google.com/u/0/+SAGARSHARMA4244", "anchor_text": "Google+"}, {"url": "https://www.quora.com/profile/Sagar-Sharma-71", "anchor_text": "Quora"}, {"url": "https://towardsdatascience.com/tensorflow-on-mobile-tensorflow-lite-a5303eef77eb", "anchor_text": "TensorFlow on Mobile: TensorFlow Lite"}, {"url": "https://towardsdatascience.com/epoch-vs-iterations-vs-batch-size-4dfb9c7ce9c9", "anchor_text": "Epoch vs Batch Size vs Iterations"}, {"url": "https://towardsdatascience.com/tensorflow-image-recognition-python-api-e35f7d412a70", "anchor_text": "TensorFlow Image Recognition Python API Tutorial On CPU"}, {"url": "https://medium.com/towards-data-science/activation-functions-neural-networks-1cbd9f8d91d6", "anchor_text": "Activation Function Explained: Neural Networks"}, {"url": "https://medium.com/@sagarsharma4244/how-to-send-emails-using-python-4293dacc57d9", "anchor_text": "How to Send Emails using PythonDesign Professional Mails using Flask!medium.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----744703297267---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ios?source=post_page-----744703297267---------------ios-----------------", "anchor_text": "IOS"}, {"url": "https://medium.com/tag/android?source=post_page-----744703297267---------------android-----------------", "anchor_text": "Android"}, {"url": "https://medium.com/tag/android-app-development?source=post_page-----744703297267---------------android_app_development-----------------", "anchor_text": "Android App Development"}, {"url": "https://medium.com/tag/data-science?source=post_page-----744703297267---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F744703297267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&user=SAGAR+SHARMA&userId=165370addbb5&source=-----744703297267---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F744703297267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&user=SAGAR+SHARMA&userId=165370addbb5&source=-----744703297267---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F744703297267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----744703297267--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F744703297267&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----744703297267---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----744703297267--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----744703297267--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----744703297267--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----744703297267--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----744703297267--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----744703297267--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----744703297267--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----744703297267--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sagarsharma4244?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@sagarsharma4244?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "SAGAR SHARMA"}, {"url": "https://medium.com/@sagarsharma4244/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F165370addbb5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&user=SAGAR+SHARMA&userId=165370addbb5&source=post_page-165370addbb5--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8dc3f98660e7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftensorflow-on-mobile-tutorial-1-744703297267&newsletterV3=165370addbb5&newsletterV3Id=8dc3f98660e7&user=SAGAR+SHARMA&userId=165370addbb5&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}