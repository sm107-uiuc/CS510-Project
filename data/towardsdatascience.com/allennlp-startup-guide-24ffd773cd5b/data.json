{"url": "https://towardsdatascience.com/allennlp-startup-guide-24ffd773cd5b", "time": 1682996591.404497, "path": "towardsdatascience.com/allennlp-startup-guide-24ffd773cd5b/", "webpage": {"metadata": {"title": "A Gentle Guide to Starting Your NLP Project with AllenNLP | by Yasufumi TANIGUCHI | Towards Data Science", "h1": "A Gentle Guide to Starting Your NLP Project with AllenNLP", "description": "Do you happen to know the library, AllenNLP? If you\u2019re working on Natural Language Processing (NLP), you might hear about the name. However, I guess a few people actually use it. Or the other has\u2026"}, "outgoing_paragraph_urls": [{"url": "https://allennlp.org/", "anchor_text": "AllenNLP", "paragraph_index": 0}, {"url": "https://allenai.org/", "anchor_text": "Allen Institute for Artificial Intelligence", "paragraph_index": 1}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch", "paragraph_index": 1}, {"url": "https://www.imdb.com/", "anchor_text": "IMDB", "paragraph_index": 7}, {"url": "https://www.imdb.com/title/tt4154796/reviews?ref_=tt_urv", "anchor_text": "Avengers: Endgame\u2019s User Reviews", "paragraph_index": 7}, {"url": "https://github.com/yasufumy/allennlp_imdb/blob/master/allennlp_imdb/data/dataset_readers/imdb.py#L38", "anchor_text": "this link", "paragraph_index": 11}, {"url": "https://docs.python.org/3/glossary.html#term-decorator", "anchor_text": "decorator", "paragraph_index": 13}, {"url": "https://github.com/yasufumy/allennlp_imdb/blob/master/allennlp_imdb/data/dataset_readers/imdb.py#L22", "anchor_text": "this link", "paragraph_index": 16}, {"url": "https://github.com/yasufumy/allennlp_imdb/blob/master/allennlp_imdb/model/rnn_classifier.py", "anchor_text": "this link", "paragraph_index": 26}, {"url": "https://github.com/yasufumy/allennlp_imdb/blob/master/training_config/base_cpu.jsonnet", "anchor_text": "this link", "paragraph_index": 30}, {"url": "https://allenai.github.io/allennlp-docs/api/allennlp.data.dataset_readers.html", "anchor_text": "the document", "paragraph_index": 32}, {"url": "https://github.com/allenai/allennlp/blob/master/allennlp/data/token_indexers/single_id_token_indexer.py#L12", "anchor_text": "SingleIdTokenIndexer", "paragraph_index": 33}, {"url": "https://github.com/allenai/allennlp/blob/master/allennlp/data/tokenizers/word_tokenizer.py#L12", "anchor_text": "WordTokenizer", "paragraph_index": 33}, {"url": "https://allenai.github.io/allennlp-docs/api/allennlp.modules.token_embedders.html#embedding", "anchor_text": "Embedding", "paragraph_index": 36}, {"url": "https://allenai.github.io/allennlp-docs/api/allennlp.modules.seq2vec_encoders.html", "anchor_text": "GRU", "paragraph_index": 36}], "all_paragraphs": ["Do you happen to know the library, AllenNLP? If you\u2019re working on Natural Language Processing (NLP), you might hear about the name. However, I guess a few people actually use it. Or the other has tried before but hasn\u2019t know where to start because there are lots of functions. For those who aren\u2019t familiar with AllenNLP, I will give a brief overview of the library and let you know the advantages of integrating it to your project.", "AllenNLP is the deep learning library for NLP. Allen Institute for Artificial Intelligence, which is one of the leading research organizations of Artificial Intelligence, develops this PyTorch-based library. Using AllenNLP to develop a model is much easier than building a model by PyTorch from scratch. Not only it provides easier development but also supports the management of the experiments and its evaluation after development. AllenNLP has the feature to focus on research development. More specifically, it\u2019s possible to prototype the model quickly and makes easier to manage the experiments with a lot of different parameters. Also, it has consideration using readable variable names.", "We might have the experience to get messy codes or lost our important experimental result by coding from scratch.", "In AllenNLP, we should follow the development and experiment flow below.", "According to your own research project, you only need to implement DatasetReader and Model, and then run your various experiments with config files. Basically, we need to understand three features below to start our project with AllenNLP", "In other words, once you get to understand it, you are able to do scalable development. In this post, I\u2019ll explain the three key features above with tackling a sentiment analysis task. Also, you can check the code using in the post as follows:", "Here I\u2019ll explain the basis of sentiment analysis task for those who aren\u2019t familiar with it. So if you\u2019ve already known it well, please proceed the next section: 1. Define DatasetReader.", "Sentiment analysis is a task that tries to classify the polarity (positive or negative) of a given document. In this post, we use the movie reviews in IMDB as given documents. For example, we\u2019re going to find the positive and the negative reviews in Avengers: Endgame\u2019s User Reviews. In this time, we\u2019ll use the dataset provided in the link below.", "We\u2019re going to build the model takes the documents (the reviews) as input and predicts the label (the polarity) as output. We should prepare the pair of the document and the label as the dataset.", "The figure below shows the DatasetReader class in AllenNLP. This class mainly handles the data using in the task.", "The DatasetReader takes raw dataset as input and applies the preprocessing like lowercasing, tokenization and so on. Finally, it outputs the list of the Instance object which holds preprocessed each data as attributes. In this post, the Instance object has the document and the label information as attributes.", "First, we should inherit the DatasetReader class to make our own. Then we need to implement the three methods: __init__ ,_read andtext_to_instance. So let\u2019s look at the way how to implement our own DatasetReader. I\u2019ll skip the implementation of the read method because it doesn\u2019t relate to the usage of AllenNLP so much. But if you\u2019re interested in it, you can refer to this link though.", "The implementation __init__ will be as follows. We can control the arguments of this method via config files.", "In this post, I set token_indexers and tokenizer as the arguments because I assume that we change the way of indexing or tokenization in the experiments. The token_indexers performs indexing and the tokenizer performs tokenization. The class I implemented has the decorator (DatasetReader.register('imdb')) which enables us to control it by config files.", "The implementation text_to_instance will be as follows. This method is the main process of DatasetReader. The text_to_instance takes each raw data as input, applies some preprocessing and output each raw data as a Instance. In IMDB, it takes the review string and the polarity label as input.", "In AllenNLP, the Instance\u2019s attributes correspond to the Field. We can create the Instance from the dictionary of the Fields. The Instance\u2019s attributes stand each data like a document or a label. In IMDB, the Instance hash two attributes: the review and the label. The review and the label correspond to the TextField and the LabelField respectively.", "The mentioned above is the way to define our DatasetReader. You can refer to the whole code from this link.", "The figure below shows the Model class in AllenNLP. This class mainly builds the model to solve the task.", "The Model takes the data as input and outputs the results of the forward computation and the evaluation metrics as the dictionary.", "First, we should inherit the Model class to make our own. Then we need to implement the three methods: __init__ ,forward andget_metrics. Here we implement the polarity classification model for IMDB\u2019s reviews with Recurrent Neural Network (RNN).", "The implementation __init__ will be as follows. We can control the arguments of this method via config files the same as the DatasetReader.", "In this post, I set text_field_embedder and seq2vec_encoder as the arguments because I assume that we change the way of embedding or RNN types in the experiments. The text_field_embedder embeds the token as the vector and the seq2vec_encoder encodes the sequence of the tokens with RNN (Technically you can use other types except for RNN). The class I implemented has the decorator (Model.register('rnn_classifier')) which enables us to control it by config files.", "The implementation of forward will be as follows. This method is the main process of Model. The forward takes the data as input, calculate by the forward computation, and outputs the results of predicted labels and the evaluation metrics as the dictionary. Most implementation is the same as the way of PyTorch. However, please note that we should return results as the dictionary.", "This implementation above computes the classification probabilities for polarity, the cross-entropy loss, and the accuracy. We compute the classification probabilities from the output of RNN through softmax. Also, we compute the model\u2019s classification accuracy if the label is given. Finally, it outputs each computational result as the dictionary (output_dict).", "The implementation get_metrics will be as follows.", "It returns the value of the accuracy as the dictionary. This is because we use the model\u2019s accuracy as the metric in this time. We can use multiple values in the get_metrics method.", "The mentioned above is the way to define our Model. You can refer to the whole code from this link.", "The figure below shows the way how to run our experiments in AllenNLP. We can run our experiments by passing our config files to the allennlp traincommand.", "I\u2019ll explain the way how to make our config files to control our experiments. We can make config files with the GUI interface via the command below. But I\u2019ll explain from scratch for better understanding.", "The config file mainly consists of the dataset_reader field, the model field, and the trainer field.", "The dataset_reader field and the model field specify the settings of the DatasetReader and the Model we implemented so far respectively. Also, the trainer field specifies the settings for optimizers, the number of epochs, and devices (CPU/GPU). You can refer to the whole config files from this link. Next, I\u2019ll explain the important parts of these three fields each.", "The settings for DatasetReader will be as follows.", "First, we specify which DatasetReader we use in type. We can use our ImdbDatasetReader to set type as imdb because it\u2019s ready to use by @DatasetReader.register('imdb'). AllenNLP provides a lot of popular datasets already. You can check these from the document.", "Then, we specify the arguments for the ImdbDatasetReader.__init__ method. We use SingleIdTokenIndexer for token_indexers because we want the token to correspond to the single id. Also, we use WordTokenizer for tokenizer because we want the token to be the one word.", "The settings for Model will be as follows.", "First, we specify which Model we use in type the same as DatasetReader. We can use our RnnClassifier to set type as rnn_classifier because it\u2019s ready to use by @Model.register('rnn_classifier').", "Then, we specify the arguments for the RnnClassifier.__init__ method. We use Embedding for text_field_embedder because we want to embed the word as the vector. Also, we use GRU for seq2vec_encoder because we want to encode the sequence of embedded words via GRU.", "The settings for Trainer will be as follows.", "The num_epochs specifies the number of epochs to train. The optimizer specifies the optimizer to update the parameters, in this case, we choose to use adam .", "The mentioned above is the way to set up your config file.", "We can run the experiment by executing the following command:", "We need to make our new config file when we want to change the experimental setting. But we can change the setting by the following command though if the changes are a few. The command below updates GRU to LSTM.", "That\u2019s all for the explanation. Thank you for reading my post. I hope you understand the way how to build your data loader and model and manage your experiments in AllenNLP.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software engineer, My interest in Natural Language Processing"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F24ffd773cd5b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@yasufumy?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yasufumy?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": "Yasufumi TANIGUCHI"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79c2d8c5db50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&user=Yasufumi+TANIGUCHI&userId=79c2d8c5db50&source=post_page-79c2d8c5db50----24ffd773cd5b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F24ffd773cd5b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F24ffd773cd5b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jamietempleton?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Jamie Templeton"}, {"url": "https://unsplash.com/search/photos/sign?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://allennlp.org/", "anchor_text": "AllenNLP"}, {"url": "https://allenai.org/", "anchor_text": "Allen Institute for Artificial Intelligence"}, {"url": "https://pytorch.org/", "anchor_text": "PyTorch"}, {"url": "https://github.com/yasufumy/allennlp_imdb", "anchor_text": "yasufumy/allennlp_imdbThe Simplest AllenNLP recipe. Contribute to yasufumy/allennlp_imdb development by creating an account on GitHub.github.com"}, {"url": "https://www.imdb.com/", "anchor_text": "IMDB"}, {"url": "https://www.imdb.com/title/tt4154796/reviews?ref_=tt_urv", "anchor_text": "Avengers: Endgame\u2019s User Reviews"}, {"url": "https://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "Sentiment AnalysisThis is a dataset for binary sentiment classification containing substantially more data than previous benchmark\u2026ai.stanford.edu"}, {"url": "https://github.com/yasufumy/allennlp_imdb/blob/master/allennlp_imdb/data/dataset_readers/imdb.py#L38", "anchor_text": "this link"}, {"url": "https://docs.python.org/3/glossary.html#term-decorator", "anchor_text": "decorator"}, {"url": "https://github.com/yasufumy/allennlp_imdb/blob/master/allennlp_imdb/data/dataset_readers/imdb.py#L22", "anchor_text": "this link"}, {"url": "https://github.com/yasufumy/allennlp_imdb/blob/master/allennlp_imdb/model/rnn_classifier.py", "anchor_text": "this link"}, {"url": "https://github.com/yasufumy/allennlp_imdb/blob/master/training_config/base_cpu.jsonnet", "anchor_text": "this link"}, {"url": "https://allenai.github.io/allennlp-docs/api/allennlp.data.dataset_readers.html", "anchor_text": "the document"}, {"url": "https://github.com/allenai/allennlp/blob/master/allennlp/data/token_indexers/single_id_token_indexer.py#L12", "anchor_text": "SingleIdTokenIndexer"}, {"url": "https://github.com/allenai/allennlp/blob/master/allennlp/data/tokenizers/word_tokenizer.py#L12", "anchor_text": "WordTokenizer"}, {"url": "https://allenai.github.io/allennlp-docs/api/allennlp.modules.token_embedders.html#embedding", "anchor_text": "Embedding"}, {"url": "https://allenai.github.io/allennlp-docs/api/allennlp.modules.seq2vec_encoders.html", "anchor_text": "GRU"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----24ffd773cd5b---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/python?source=post_page-----24ffd773cd5b---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----24ffd773cd5b---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----24ffd773cd5b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----24ffd773cd5b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F24ffd773cd5b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&user=Yasufumi+TANIGUCHI&userId=79c2d8c5db50&source=-----24ffd773cd5b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F24ffd773cd5b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&user=Yasufumi+TANIGUCHI&userId=79c2d8c5db50&source=-----24ffd773cd5b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F24ffd773cd5b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F24ffd773cd5b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----24ffd773cd5b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----24ffd773cd5b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yasufumy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@yasufumy?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yasufumi TANIGUCHI"}, {"url": "https://medium.com/@yasufumy/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "341 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F79c2d8c5db50&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&user=Yasufumi+TANIGUCHI&userId=79c2d8c5db50&source=post_page-79c2d8c5db50--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4dcb03ea08bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fallennlp-startup-guide-24ffd773cd5b&newsletterV3=79c2d8c5db50&newsletterV3Id=4dcb03ea08bc&user=Yasufumi+TANIGUCHI&userId=79c2d8c5db50&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}