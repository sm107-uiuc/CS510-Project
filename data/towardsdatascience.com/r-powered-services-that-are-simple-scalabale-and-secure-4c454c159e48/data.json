{"url": "https://towardsdatascience.com/r-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48", "time": 1683017856.9256341, "path": "towardsdatascience.com/r-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48/", "webpage": {"metadata": {"title": "R-Powered Services that are Simple, Scalabale, and Secure | by Sam Terfa | Towards Data Science", "h1": "R-Powered Services that are Simple, Scalabale, and Secure", "description": "R-powered services running on Google Cloud Run can act as webooks, APIs, apps, and even dashboards. Now that Github offers continuous integration and deployment with Cloud Run, publishing and\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.rplumber.io/", "anchor_text": "Plumber package", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098", "anchor_text": "Using R and Python in Google Sheets Formulas", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/r-and-python-plotting-in-google-sheets-255e974aed91", "anchor_text": "R and Python Plotting in Google Sheets", "paragraph_index": 1}, {"url": "https://cloud.google.com/run", "anchor_text": "Google Cloud Run", "paragraph_index": 2}, {"url": "https://cloud.google.com/run/docs/continuous-deployment-with-cloud-build", "anchor_text": "continuous deployment from Github to Cloud Build", "paragraph_index": 2}, {"url": "https://github.com/samterfa/r_services", "anchor_text": "samterfa/r_services", "paragraph_index": 3}, {"url": "https://cloud.google.com/secret-manager/docs", "anchor_text": "Google Secret Manager", "paragraph_index": 3}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Console", "paragraph_index": 4}, {"url": "https://github.com/samterfa/r_services", "anchor_text": "samterfa/r_services", "paragraph_index": 7}, {"url": "http://minimal", "anchor_text": "http://minimal", "paragraph_index": 15}, {"url": "https://www.rplumber.io/reference/serializers.html", "anchor_text": "serializes", "paragraph_index": 18}, {"url": "https://docs.docker.com/engine/reference/builder/", "anchor_text": "Dockerfile", "paragraph_index": 20}, {"url": "https://docs.docker.com/get-started/overview/", "anchor_text": "Docker", "paragraph_index": 20}, {"url": "https://hub.docker.com/r/rocker/tidyverse", "anchor_text": "template image with the Tidyverse", "paragraph_index": 21}], "all_paragraphs": ["R-powered services running on Google Cloud Run can act as webooks, APIs, apps, and even dashboards. Now that Github offers continuous integration and deployment with Cloud Run, publishing and updating these services has never been easier. This post outlines a minimal setup which will get you going. Future posts will cover using secrets securely, making interactive Slack apps, and more.", "R scripts can do many amazing things besides statistical analyses. With the power of the Plumber package, they can back webpages and applications with very little code. Here are a couple custom Google Sheets examples from two previous posts of mine: Using R and Python in Google Sheets Formulas and R and Python Plotting in Google Sheets. It\u2019s crazy what is possible!", "There are many options for hosting these services but I have become especially fond of Google Cloud Run because it is easy to use, very inexpensive, and highly scalable. Recently, Google announced the availability of continuous deployment from Github to Cloud Build, which takes code pushes to Github repositories and deploys them to Cloud Run automatically!", "The following is the quickest way to get set up to do this. You can fork my Github repo samterfa/r_services if you\u2019d like to have the source repo all set. My plan is to build on this post and cover using Google Secret Manager to pass credentials to your apps securely, creating interactive Slack apps, and more, all powered by R!", "Working in Google Cloud starts at the Google Cloud Console where projects live and are provisioned. Setting up a new project is very simple but does require billing to be set up. I promise, it generally costs me less than a dollar to set up and utilize a Cloud Run project for a month; it\u2019s highly worth it!", "Begin by creating a new project using the \u201cSelect a project\u201d dropdown in the top left. You can name your project whatever you like.", "I like to organize my files locally to mirror the Google Cloud project and Cloud Run services in the following way.", "Here\u2019s the file structure for samterfa/r_services. It\u2019s a pretty standard set up.", "Next, we select Cloud Run from the main menu in the upper left. Then create a service.", "Choose Cloud Run (fully managed) and select a region near you. Name your service whatever you like.", "After clicking Next, we get to the good stuff. We can choose to \u201ccontinuously deploy new revisions from a source repository\u201d. Selecting that, enabling more APIs, and clicking SET UP WITH CLOUD BUILD allows us to choose Github as our repository provider and choose a repo to sync with.", "You can select the branch you\u2019d like to use as the source. I will be using a Dockerfile to instruct Google Cloud Build how to the build my app. If you\u2019ve never used Docker do not worry! You can literally copy my Dockerfile and Cloud Build will know what to do. Given the file structure we\u2019ve set up, you should make sure to set the Dockerfile path to /{service_name}/Dockerfile, and not just Dockerfile.", "Save your configuration. Finally, we will \u201cAllow unaunthenticated invocations\u201d for simplicity, and click Create. You should now see some action as Google Cloud sets authentication policies for your service, creates a Github continuous deployment build trigger, builds your container, and deploys it to Cloud Run to begin receiving traffic. If you see the orange message I have below, that means your repo wasn\u2019t prepopulated so the trigger needs to wait for a proper push to Github.", "To check on the status of your build at any time, go to the menu in the upper left and select Cloud Build -> History. This will show you any builds in progress.", "In order to do something useful with your service, you will need to create/modify an R file named Plumber.R by convention. In it you will set up endpoints for your service which can receive requests such as GET and POST API calls. Below is an example.", "@get /testing means {your_service_url}/testing can receive GET requests. Your Cloud Run service URL acts like a base url for these calls. My base url looks like http://minimal...run.app as can be seen below.", "Now is a great time to test that pushing to Github indeed updates your service. After pushing your changes to Github, take a look at Cloud Build -> History if you would like to check on the progress of the build. It should only take a couple minutes to deploy the updated service. Then type in {your_service_url}/testing into a browser and see what your fancy service can do!", "This result is a bit underwhelming. It didn\u2019t require R at all. But you may realize that we could have used R code to generate the output instead of just returning static text. Let\u2019s add a second example to see something a bit more fancy.", "This example takes arguments min and max which are passed in through query parameters. This example also serializes the returned data as html which is pretty cool. Go ahead and update Plumber.R, push to Github, wait a couple of minutes, and navigate to {your_service_url}/runif?min=0&max=1. You should see something like this.", "This last example starts to actually look useful. You can make an interactive datatable using the DT package super quickly! Imagine doing some interactive dashboarding with your own curated data instead of iris\u2026 again.", "What did that Dockerfile do anyway? A Dockerfile is simply a set of instructions for Docker to follow to build an image (our app). Let\u2019s take a look.", "From the comments it should be relatively clear what this file does. It instructs docker to pull a template image with the Tidyverse preloaded. Next, the the plumber package is installed since it doesn\u2019t come standard with the Tidyverse. You can also install Github-hosted packages using the installGithub.r command in your Dockerfile. Files are then copied into the app directory, and plumber::plumb() makes the endpoints we defined available for API calls.", "There are fancier things we could use to build and deploy to Cloud Run but a Dockerfile is so simple and straightforward; it\u2019s a great place to start.", "Armed with this simple set up which continuously deploys from Github, you are ready to do some pretty interesting things. My next post will go over passing credentials to your app securely using Google Secret Manager. This is vital if your service is going to interact with anything interesting such as Google Sheets or Slack.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist | R and Google Cloud Enthusiast"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4c454c159e48&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4c454c159e48--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4c454c159e48--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://samterfa.medium.com/?source=post_page-----4c454c159e48--------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=post_page-----4c454c159e48--------------------------------", "anchor_text": "Sam Terfa"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff927a36747b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&user=Sam+Terfa&userId=f927a36747b7&source=post_page-f927a36747b7----4c454c159e48---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c454c159e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c454c159e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ianjbattaglia?utm_source=medium&utm_medium=referral", "anchor_text": "Ian Battaglia"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.rplumber.io/", "anchor_text": "Plumber package"}, {"url": "https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098", "anchor_text": "Using R and Python in Google Sheets Formulas"}, {"url": "https://towardsdatascience.com/r-and-python-plotting-in-google-sheets-255e974aed91", "anchor_text": "R and Python Plotting in Google Sheets"}, {"url": "https://cloud.google.com/run", "anchor_text": "Google Cloud Run"}, {"url": "https://cloud.google.com/run/docs/continuous-deployment-with-cloud-build", "anchor_text": "continuous deployment from Github to Cloud Build"}, {"url": "https://github.com/samterfa/r_services", "anchor_text": "samterfa/r_services"}, {"url": "https://cloud.google.com/secret-manager/docs", "anchor_text": "Google Secret Manager"}, {"url": "https://console.cloud.google.com/", "anchor_text": "Google Cloud Console"}, {"url": "https://github.com/samterfa/r_services", "anchor_text": "samterfa/r_services"}, {"url": "http://twitter.com/apiTitle", "anchor_text": "@apiTitle"}, {"url": "http://twitter.com/apiDescription", "anchor_text": "@apiDescription"}, {"url": "http://twitter.com/get", "anchor_text": "@get"}, {"url": "http://twitter.com/serializer", "anchor_text": "@serializer"}, {"url": "http://minimal", "anchor_text": "http://minimal"}, {"url": "http://twitter.com/apiTitle", "anchor_text": "@apiTitle"}, {"url": "http://twitter.com/apiDescription", "anchor_text": "@apiDescription"}, {"url": "http://twitter.com/param", "anchor_text": "@param"}, {"url": "http://twitter.com/param", "anchor_text": "@param"}, {"url": "http://twitter.com/get", "anchor_text": "@get"}, {"url": "http://twitter.com/serializer", "anchor_text": "@serializer"}, {"url": "http://twitter.com/get", "anchor_text": "@get"}, {"url": "http://twitter.com/serializer", "anchor_text": "@serializer"}, {"url": "https://www.rplumber.io/reference/serializers.html", "anchor_text": "serializes"}, {"url": "http://twitter.com/apiTitle", "anchor_text": "@apiTitle"}, {"url": "http://twitter.com/apiDescription", "anchor_text": "@apiDescription"}, {"url": "http://twitter.com/get", "anchor_text": "@get"}, {"url": "http://twitter.com/serializer", "anchor_text": "@serializer"}, {"url": "http://twitter.com/param", "anchor_text": "@param"}, {"url": "http://twitter.com/param", "anchor_text": "@param"}, {"url": "http://twitter.com/get", "anchor_text": "@get"}, {"url": "http://twitter.com/serializer", "anchor_text": "@serializer"}, {"url": "http://twitter.com/get", "anchor_text": "@get"}, {"url": "http://twitter.com/serializer", "anchor_text": "@serializer"}, {"url": "https://docs.docker.com/engine/reference/builder/", "anchor_text": "Dockerfile"}, {"url": "https://docs.docker.com/get-started/overview/", "anchor_text": "Docker"}, {"url": "https://hub.docker.com/r/rocker/tidyverse", "anchor_text": "template image with the Tidyverse"}, {"url": "https://medium.com/tag/r?source=post_page-----4c454c159e48---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/api?source=post_page-----4c454c159e48---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/tag/google-cloud-run?source=post_page-----4c454c159e48---------------google_cloud_run-----------------", "anchor_text": "Google Cloud Run"}, {"url": "https://medium.com/tag/github?source=post_page-----4c454c159e48---------------github-----------------", "anchor_text": "Github"}, {"url": "https://medium.com/tag/docker?source=post_page-----4c454c159e48---------------docker-----------------", "anchor_text": "Docker"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4c454c159e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&user=Sam+Terfa&userId=f927a36747b7&source=-----4c454c159e48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4c454c159e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&user=Sam+Terfa&userId=f927a36747b7&source=-----4c454c159e48---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4c454c159e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4c454c159e48--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4c454c159e48&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4c454c159e48---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4c454c159e48--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4c454c159e48--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4c454c159e48--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4c454c159e48--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4c454c159e48--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4c454c159e48--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4c454c159e48--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4c454c159e48--------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://samterfa.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sam Terfa"}, {"url": "https://samterfa.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "71 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff927a36747b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&user=Sam+Terfa&userId=f927a36747b7&source=post_page-f927a36747b7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5c5d191f9494&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fr-powered-services-that-are-simple-scalabale-and-secure-4c454c159e48&newsletterV3=f927a36747b7&newsletterV3Id=5c5d191f9494&user=Sam+Terfa&userId=f927a36747b7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}