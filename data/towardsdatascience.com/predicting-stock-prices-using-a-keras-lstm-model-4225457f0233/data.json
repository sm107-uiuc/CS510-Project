{"url": "https://towardsdatascience.com/predicting-stock-prices-using-a-keras-lstm-model-4225457f0233", "time": 1683002387.122017, "path": "towardsdatascience.com/predicting-stock-prices-using-a-keras-lstm-model-4225457f0233/", "webpage": {"metadata": {"title": "Machine Learning to Predict Stock Prices | by Roshan Adusumilli | Towards Data Science", "h1": "Machine Learning to Predict Stock Prices", "description": "As financial institutions begin to embrace artificial intelligence, machine learning is increasingly utilized to help make trading decisions. Although there is an abundance of stock data for machine\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://colab.research.google.com/drive/18WiSw1K0BW3jOKO56vxn11Fo9IyOuRjh", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://github.com/mwitiderrick/stockprice", "anchor_text": "Data and Notebook for the Stock Price Prediction Tutorial", "paragraph_index": 16}, {"url": "https://becominghuman.ai/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "anchor_text": "https://becominghuman.ai/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "paragraph_index": 17}], "all_paragraphs": ["As financial institutions begin to embrace artificial intelligence, machine learning is increasingly utilized to help make trading decisions. Although there is an abundance of stock data for machine learning models to train on, a high noise to signal ratio and the multitude of factors that affect stock prices are among the several reasons that predicting the market difficult. At the same time, these models don\u2019t need to reach high levels of accuracy because even 60% accuracy can deliver solid returns. One method for predicting stock prices is using a long short-term memory neural network (LSTM) for times series forecasting.", "LSTMs are an improved version of recurrent neural networks (RNNs). RNNs are analogous to human learning. When humans think, we don\u2019t start our thinking from scratch each second. For example, in the sentence \u201cBob plays basketball\u201d, we know that Bob is the person who plays basketball because we retain information about past words while reading sentences. Similarly, RNNs are networks with loops in them, which allow them to use past information before arriving at a final output. However, RNNs can only connect recent previous information and cannot connect information as the time gap grows. This is where LSTMs come into play; LSTMs are a type of RNN that remember information over long periods of time, making them better suited for predicting stock prices. For a technical explanation of LSTMs click here.", "To begin our project, we import numpy for making scientific computations, pandas for loading and modifying datasets, and matplotlib for plotting graphs.", "After making the necessary imports, we load data on Tata Global Beverage\u2019s past stock prices. From the data, we select the values of the first and second columns (\u201cOpen\u201d and \u201cHigh\u201d respectively) as our training dataset. The \u201cOpen\u201d column represents the opening price for shares that day and the \u201cHigh\u201d column represents the highest price shares reached that day.", "To get a look at the dataset we\u2019re using, we can check the head, which shows us the first five rows of our dataset.", "\u201cLow\u201d represents the lowest share price for the day, \u201cLast\u201d represents the price at which the last transaction for a share went through. \u201cClose\u201d represents the price shares ended at for the day.", "Normalization is changing the values of numeric columns in the dataset to a common scale, which helps the performance of our model. To scale the training dataset we use Scikit-Learn\u2019s MinMaxScaler with numbers between zero and one.", "We should input our data in the form of a 3D array to the LSTM model. First, we create data in 60 timesteps before using numpy to convert it into an array. Finally, we convert the data into a 3D array with X_train samples, 60 timestamps, and one feature at each step.", "Before we can develop the LSTM, we have to make a few imports from Keras: Sequential for initializing the neural network, LSTM to add the LSTM layer, Dropout for preventing overfitting with dropout layers, and Dense to add a densely connected neural network layer.", "The LSTM layer is added with the following arguments: 50 units is the dimensionality of the output space, return_sequences=True is necessary for stacking LSTM layers so the consequent LSTM layer has a three-dimensional sequence input, and input_shape is the shape of the training dataset.", "Specifying 0.2 in the Dropout layer means that 20% of the layers will be dropped. Following the LSTM and Dropout layers, we add the Dense layer that specifies an output of one unit. To compile our model we use the Adam optimizer and set the loss as the mean_squared_error. After that, we fit the model to run for 100 epochs (the epochs are the number of times the learning algorithm will work through the entire training set) with a batch size of 32.", "We start off by importing the test set", "Before predicting future stock prices, we have to modify the test set (notice similarities to the edits we made to the training set): merge the training set and the test set on the 0 axis, set 60 as the time step again, use MinMaxScaler, and reshape data. Then, inverse_transform puts the stock prices in a normal readable format.", "After all these steps, we can use matplotlib to visualize the result of our predicted stock price and the actual stock price.", "While the exact price points from our predicted price weren\u2019t always close to the actual price, our model did still indicate overall trends such as going up or down. This project teaches us the LSTMs can be somewhat effective in times series forecasting.", "Click here for the entire code", "[1] Derrick Mwiti, Data and Notebook for the Stock Price Prediction Tutorial(2018), Github", "I\u2019m Roshan, a 16 year old passionate about the intersection of artificial intelligence and finance. For a broad view of AI in finance, check out this article: https://becominghuman.ai/artificial-intelligence-and-its-application-in-finance-9f1e0588e777.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4225457f0233&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4225457f0233--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4225457f0233--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@roshan.adusumilli?source=post_page-----4225457f0233--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=post_page-----4225457f0233--------------------------------", "anchor_text": "Roshan Adusumilli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4b91022e00a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&user=Roshan+Adusumilli&userId=4b91022e00a0&source=post_page-4b91022e00a0----4225457f0233---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4225457f0233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4225457f0233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://colah.github.io/posts/2015-08-Understanding-LSTMs/", "anchor_text": "source"}, {"url": "https://towardsdatascience.com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21", "anchor_text": "here"}, {"url": "https://colab.research.google.com/drive/18WiSw1K0BW3jOKO56vxn11Fo9IyOuRjh", "anchor_text": "here"}, {"url": "https://github.com/mwitiderrick/stockprice", "anchor_text": "Data and Notebook for the Stock Price Prediction Tutorial"}, {"url": "https://becominghuman.ai/artificial-intelligence-and-its-application-in-finance-9f1e0588e777", "anchor_text": "https://becominghuman.ai/artificial-intelligence-and-its-application-in-finance-9f1e0588e777"}, {"url": "https://www.linkedin.com/in/roshan-adusumilli-96b104194/", "anchor_text": "https://www.linkedin.com/in/roshan-adusumilli-96b104194/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4225457f0233---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----4225457f0233---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/tag/finance?source=post_page-----4225457f0233---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----4225457f0233---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/ai-in-finance?source=post_page-----4225457f0233---------------ai_in_finance-----------------", "anchor_text": "Ai In Finance"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4225457f0233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&user=Roshan+Adusumilli&userId=4b91022e00a0&source=-----4225457f0233---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4225457f0233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&user=Roshan+Adusumilli&userId=4b91022e00a0&source=-----4225457f0233---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4225457f0233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4225457f0233--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4225457f0233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4225457f0233---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4225457f0233--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4225457f0233--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4225457f0233--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4225457f0233--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4225457f0233--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4225457f0233--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4225457f0233--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4225457f0233--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roshan.adusumilli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roshan Adusumilli"}, {"url": "https://medium.com/@roshan.adusumilli/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "467 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4b91022e00a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&user=Roshan+Adusumilli&userId=4b91022e00a0&source=post_page-4b91022e00a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33022f0f4364&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-stock-prices-using-a-keras-lstm-model-4225457f0233&newsletterV3=4b91022e00a0&newsletterV3Id=33022f0f4364&user=Roshan+Adusumilli&userId=4b91022e00a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}