{"url": "https://towardsdatascience.com/pymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a", "time": 1683008610.806015, "path": "towardsdatascience.com/pymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a/", "webpage": {"metadata": {"title": "PyMC3 and Bayesian Inference Towards Non-Linear Models: Part 1 | by Adam Watts | Towards Data Science", "h1": "PyMC3 and Bayesian Inference Towards Non-Linear Models: Part 1", "description": "Probabilistic programming languages such as Stan have provided scientists and engineers accessible means into the world of Bayesian statistics. As someone who is comfortable programming in Python, I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Stan_(software)", "anchor_text": "Stan", "paragraph_index": 0}, {"url": "https://medium.com/p/a03c3303e6fa/edit", "anchor_text": "part 2", "paragraph_index": 3}, {"url": "https://github.com/adamcwatts/Statistic_and_Data_Science_Examples/blob/master/PyMC3/Newton_Bayesian.ipynb", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Newton%27s_law_of_cooling", "anchor_text": "Newton\u2019s law of cooling", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables", "anchor_text": "IID", "paragraph_index": 15}, {"url": "https://medium.com/@aldburg/pymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa", "anchor_text": "here", "paragraph_index": 26}], "all_paragraphs": ["Probabilistic programming languages such as Stan have provided scientists and engineers accessible means into the world of Bayesian statistics. As someone who is comfortable programming in Python, I have been trying to find the perfect Bayesian library that complements Python\u2019s wonderful and succinct syntax.", "One of the biggest challenges in learning new material and a new library is finding sufficient resources and examples. I couldn\u2019t find an accessible article on using Python and Bayesian inference for parameter and model uncertainty quantification (UQ) towards non-linear models. Therefore, I hope this article helps others trying to apply these methods towards their own research or work.", "This will be 2 part article to make it accessible to a wide audience but also make navigation and reading the articles easier.", "Part 1 will quickly discuss two common libraries for Bayesian inference: PyStan, and PyMC3. We will also set up a non-linear function to be used for Bayesian inference. This will include parameter optimization though the SciPy library. We will use the optimal parameters as a starting point for our Bayesian Inference and check our Bayesian method. If you\u2019re already comfortable with parameter optimization, feel free to skip directly to the PyMC3 section in part 2.", "Part 2 is where we begin using PyMC3 and dive into the syntax and results. For validation, we will also see how the Bayesian methods compare to the frequentist approach for parameter uncertainty quantification.", "I am not going to divine much into Baye\u2019s theorem and the entire Bayesian framework, there are plenty of articles on Medium to satisfy your curiosity. The primary outcome for this article is for the reader to understand how to utilize PyMC3 for quantifying the uncertainty in the parameter(s) and model used in linear, and in particular, non-linear models. The Jupyter Notebook can be found here.", "Stan is available for Python in the form of PyStan, however, the syntax is rather offputting. Let\u2019s take a look at an example of creating a model in PyStan which is assigned to a variable of type string. This model will then be compiled to C++ with the help of PyStan.", "Above is a simple example of a quadratic model with two parameters, \u03b1, and \u03b2 with the response y. The model is very verbose and difficult to debug when one starts to use more complicated models. There must be something more Pythonic\u2026", "I believe the PyMC3 is a perfect library for people entering into the world of probabilistic programming with Python. PyMC3 uses native Python Syntax making it easier to debug and more intuitive. Let\u2019s dive into an example and see the prowess of the library.", "I will be using an everyday example of a simple non-linear equation for this example with the hopes that the concepts will be easier for comprehension and retention.", "Let\u2019s begin with a cooling of a hot object using Newton\u2019s law of cooling. We are assuming no thermal gradients exist in the object (lumped capacitance).", "For those who are rusty at ordinary differential equations (ODE), fear not. The solution is below.", "T(t) represents the temperature of the drink at a given time t. \u03c4 is our parameter of interest which governs the cooling rate for this problem. T_env is our environmental temperature and T_0 is the temperature of the drink at time t=0. We are assuming that T_env is invariant with time.", "Let us also assume that we know ahead of time, a priori, that the environmental temperature is 30C and that the object started at 100C. Finally, we will assume that the unknown parameter \u03c4=15.", "We will first plot the theoretical solution for the cooling of a hot drink, shown as the solid blue curve. Here we can get an intuition for the equations and parameters.", "We will also generate some data with artificial noise to simulate real-life data, shown here as red scatter points. We will assume that the data is IID. The response, temperature of the drink, is Gaussian, i.e., T(t)~ N(\u03bc, \u03c3\u00b2). The mean, \u03bc, will follow the solution above. We will address shortly the problem that we don\u2019t know \u03c4 from the data itself. The standard deviation in the response is \u03c3=1.5. That is how we generated the fake noise, we will also be able to estimate this from the data too.", "From this simulated data, we want to estimate the cooling parameter \u03c4 and estimate the uncertainty in its value. Ideally, our estimate parameter and the uncertainty will encapsulate the true value. Similarly, we also would like our uncertainty in the standard error of the model to encapsulate \u03c3.", "To clarify what I mean by the term encapsulate, assume we estimate a parameter \u03b3=100 \u00b1 10. We want the true parameter to be within the range of 90\u2013110 which is the same as 100 \u00b1 10.", "Before we can estimate the uncertainty in \u03c4, we must first optimize the value of \u03c4 that fits the data the best. In more technical terms, we wish to find \u03c4 such that it minimizes the residual sum of squares.", "Where the function within the left-hand side of the bracket is our data and the function within the right-hand side of the bracket is the solution to our ODE.", "We find \u03c4_opt = 14.93, pretty close estimate to the real parameter of \u03c4=15. Returning back to our initial problem, remember that the response, temperature of the drink, is Gaussian, i.e., T(t)~ N(\u03bc, \u03c3\u00b2). We finally have an estimate for \u03c4, and we can check for normality.", "Remember that if our response came from a Gaussian distribution, then our residuals (data minus the predictions) must also be Gaussian.", "Think, linear transformation, or even more fundamental, the shift one makes for a Z-score.", "The residual, o=difference between the data and our model, looks great with a mean of roughly 0. They appear stochastic, homoscedastic, with roughly most of the data between the two red dash lines.", "Let\u2019s see how we did for estimating \u03c3", "We find that the estimate for \u03c3 is 1.42, pretty close to 1.5", "If you\u2019re still with me, fantastic! Now that we have estimates for \u03c4 and \u03c3, we can finally begin our dive into Bayesian statistics and PyMC3. Check out part 2 of the series here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am an engineer and Ph.D. student at North Carolina State University. My passion is combining the field of data science with traditional engineering."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd1d50250f16a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@aldburg?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aldburg?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": "Adam Watts"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5577d2680e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&user=Adam+Watts&userId=a5577d2680e0&source=post_page-a5577d2680e0----d1d50250f16a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1d50250f16a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1d50250f16a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Stan_(software)", "anchor_text": "Stan"}, {"url": "https://medium.com/p/a03c3303e6fa/edit", "anchor_text": "part 2"}, {"url": "https://github.com/adamcwatts/Statistic_and_Data_Science_Examples/blob/master/PyMC3/Newton_Bayesian.ipynb", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Newton%27s_law_of_cooling", "anchor_text": "Newton\u2019s law of cooling"}, {"url": "https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables", "anchor_text": "IID"}, {"url": "https://medium.com/@aldburg/pymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-a03c3303e6fa", "anchor_text": "here"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----d1d50250f16a---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/pymc3?source=post_page-----d1d50250f16a---------------pymc3-----------------", "anchor_text": "Pymc3"}, {"url": "https://medium.com/tag/nonlinear-models?source=post_page-----d1d50250f16a---------------nonlinear_models-----------------", "anchor_text": "Nonlinear Models"}, {"url": "https://medium.com/tag/uncertainty?source=post_page-----d1d50250f16a---------------uncertainty-----------------", "anchor_text": "Uncertainty"}, {"url": "https://medium.com/tag/parameter?source=post_page-----d1d50250f16a---------------parameter-----------------", "anchor_text": "Parameter"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1d50250f16a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&user=Adam+Watts&userId=a5577d2680e0&source=-----d1d50250f16a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd1d50250f16a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&user=Adam+Watts&userId=a5577d2680e0&source=-----d1d50250f16a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd1d50250f16a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd1d50250f16a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d1d50250f16a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d1d50250f16a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d1d50250f16a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d1d50250f16a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d1d50250f16a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aldburg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@aldburg?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Adam Watts"}, {"url": "https://medium.com/@aldburg/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa5577d2680e0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&user=Adam+Watts&userId=a5577d2680e0&source=post_page-a5577d2680e0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2fdd7ba74e7f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpymc3-and-bayesian-inference-for-parameter-uncertainty-quantification-towards-non-linear-models-d1d50250f16a&newsletterV3=a5577d2680e0&newsletterV3Id=2fdd7ba74e7f&user=Adam+Watts&userId=a5577d2680e0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}