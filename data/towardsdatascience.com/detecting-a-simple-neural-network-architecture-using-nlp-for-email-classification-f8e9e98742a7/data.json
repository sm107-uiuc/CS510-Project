{"url": "https://towardsdatascience.com/detecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7", "time": 1682995880.101862, "path": "towardsdatascience.com/detecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7/", "webpage": {"metadata": {"title": "Detecting a simple neural network architecture for email classification | by tannistha maiti | Towards Data Science", "h1": "Detecting a simple neural network architecture for email classification", "description": "About a decade ago, spam brought email to near-ruin. By 2015, Google says that its spam rate is down to 0.1 percent, and its false positive rate has dipped to 0.05 percent. The significant drop in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.wired.com/2015/07/google-says-ai-catches-99-9-percent-gmail-spam/", "anchor_text": "Google", "paragraph_index": 0}, {"url": "https://github.com/tensorflow/models/tree/master/research/lm_1b", "anchor_text": "lm_1b", "paragraph_index": 28}, {"url": "https://www.linkedin.com/in/tannistha-m-83588a45/", "anchor_text": "LinkedIn", "paragraph_index": 29}, {"url": "https://github.com/tannisthamaiti/Ham_spam_email_classification", "anchor_text": "here", "paragraph_index": 29}], "all_paragraphs": ["About a decade ago, spam brought email to near-ruin. By 2015, Google says that its spam rate is down to 0.1 percent, and its false positive rate has dipped to 0.05 percent. The significant drop in large part is due to the introduction of neural networks into its spam filters that can learn to recognize junk mail and phishing messages by analyzing scads off the stuff across an enormous collection.", "Neural networks are powerful machine learning algorithms. They can be used to transform the features so as to form fairly complex non linear decision boundaries. They are primarily used for classification problems. The fully connected layers take the deep representation from the CNN to RNN/LSTM and transforms it into the final output classes or class scores.", "This post explains email classifications in ham and spam based on the following factors.", "The use of word embedding method on email subject lines.", "Hyperparameter tuning in terms of layers and number of nodes layers, and optimizer on email subject lines.", "Compare the performance of CNN vs RNN method based on email subject lines.", "A business can decide from the different type of available spam filter. Some of the filters target the content of emails to determine if these are relevant to the business or not, whereas some filter check email headers of the messages. There are also some filters that you can set to restrict the acceptance of emails from specific addresses, as well as some that allow you to set parameters for what kinds of emails need to be blocked. There are even some that allow you to stop any email that comes from addresses that are on a list of blacklisted spammers. In this study spam filters are developed based on the subject line of the emails.", "The dataset is based on the cleaned Enron corpus, there is a total of 92188 messages belonging to 158 users with an average of 757 messages per user. The dataset has almost an equal distribution of ham and spam emails. 19997 emails consisting of ham and spams are used as training and validation set with a split of 20% . 17880 emails are then used as a test set to identify accuracy and false positives.", "Artificial neural networks have two main hyperparameters that control the architecture or topology of the network: (a) the number of layers and (b) the number of nodes in each hidden layer.", "The most reliable way to configure these hyperparameters for a specific predictive modeling problem is via systematic experimentation with robust test. A Multilayer Perceptron consists of a node, also called a neuron or perceptron, is a computational unit that has one or more weighted input connections, a transfer function that combines the inputs in some way, and an output connection. Nodes are then organized into layers to comprise a network.", "The types of layers in an MLP are as follows:", "1. Input Layer: Input variables, sometimes called the visible layer.", "2. Hidden Layers: Layers of nodes between the input and output layers. There may be one or more of these layers.", "3. Output Layer: A layer of nodes that produce the output variables.", "4. Size: The number of nodes in the model.", "5. Width: The number of nodes in a specific layer.", "6. Depth: The number of layers in a neural network.", "7. Architecture: The specific arrangement of the layers and nodes in the network.", "Detecting hyperparameters are essential for three reasons (a) Find a simplistic neural network architecture to the particular problem. (b) Find the right set of parameters from countless combinations of hyperparameters and (c) Replicate the neural network architecture for future use.", "Table 1 gives details of three pre-trained deep neural net (DNN) model (Bi-directional LSTM, no-embedding CNN and embedding CNN) use the hidden layers, containing 16, 32, 64 and 128 neurons and 16, 32, 64 and 128 filters in first, second and third layers. The activation is ReLu in all layers except for the dense layer where the activation is \u2018tanh\u2019. The codes for CNN and Bi-directional LSTM network with embedding are presented here. All models use a batch size of 16 and epoch of 2.", "Two important techniques of neural network are Dropout and Activation. hyperparameter tuning can also be done based on these techniques, but are not used here. Dropout technique is used to improve the generalization error of large neural networks. In this method the noise zeros, or drops out a fixed fraction of the activation of the neurons in a given layer. Rectified linear unit (ReLU) uses the activation function max(0; x). ReLUs are incorporate into a standard feed-forward neural net, to maintain the probabilistic model with the max(0; x).", "GloVe (Global vectors) used here is one of the approach where each word is mapped to 100-dimension vector. These vectors can be used to learn the semantics of words like Man is Woman as King is to Queen. Or Man + Female = Woman. This embedding plays an important role in many applications. It is kind of a transfer learning where word embedding are learnt from large corpus of data and then can be used on smaller datasets. The vectors are generated by an unsupervised learning algorithm (PCA). Training is performed on aggregated global word-word co-occurrence statistics from a corpus, and the resulting representations showcase linear substructures of the word vector space. The main intuition underlying the model is the simple observation that the ratio of word-word co-occurrence probabilities have the potential for encoding some form of meaning. The GloVe data set has 400000 words.", "The Bag-of-words method is used as feature vectors. An analysis of the tokens (words) revels that 24.80% of the vocabulary and 43.05% of all text are present in the embedding matrix.", "The results from Figure 1 shows that the number of neurons in the dense layer is not very conclusive, but 64 filters in the first layers give low validation loss. Also it\u2019s difficult to predict filter numbers and low validation loss in second and third layers respectively.", "Figure 2 gives a good visualization of simple (low trainable parameters) and complex models (high trainable parameters). In the lower left hand corner of the parameter space models with single neuron layers and trainable parameters ranging from 20k to 70k gives low validation loss and are good architectures.", "The results from Figure 3 shows that the 64 neurons in the dense layer is a good approximation, and 128 filters in the first layer are also acceptable results with low validation loss. However, bi-directional LSTM shows that the more the trainable parameters are the better the validation loss is.", "Figure 4 gives a good visualization of simple (low trainable parameters) and complex models (high trainable parameters) in bi-directional LSTM models . At least 64/128 dense layer neurons are necessary to generate results with a low validation loss. Also models with higher with trainable parameters have a low validation loss and are good architectures. However, in comparison to CNN models the validation loss is less for LSTMs.", "Qualitative analysis of Table 2 shows the results from the CNN and bidirectional LSTM networks with and without Global vector embedding. The first five best models based on least validation loss are chosen. The maximum accuracy is 58% that is generated by CNN with embedding. The best accuracy and sensitivity of 73% is for a CNN model with trainable parameters of 66226. The average accuracy is 50% with CNN model with no-embedding having lower accuracy than 50%. The sensitivity of the models is more than 50% with a high of 73%. It should be noted that the models with no-embedding have very low sensitivity. The models with no-embedding have high true negative rates. Also, Nadam optimizer works best with these kind of problems.", "Future studies will include methods to deal with out of vocabulary words and use of character based model such that was designed by Google Brain team, the lm_1b model which includes 256 vectors (including 52 characters, special characters) and the dimension is just 16.", "I welcome feedback and constructive criticism. I can be reached through LinkedIn. The code to this study is found here.", "**The total combination of hyper parameters in CNN models is 3072 but only the models with Adam and Nadam optimizer are considered since they generate the least validation loss. Similar only Adam and Nadam optimizer are considered for LSTM.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Head engineering & co-founder of DK AI Research Lab leading a team of AI researchers and developers to transform innovative ideas from lab to production."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff8e9e98742a7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@tannistha.iitkgp?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tannistha.iitkgp?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": "tannistha maiti"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff4b805251a23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&user=tannistha+maiti&userId=f4b805251a23&source=post_page-f4b805251a23----f8e9e98742a7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8e9e98742a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8e9e98742a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.wired.com/2015/07/google-says-ai-catches-99-9-percent-gmail-spam/", "anchor_text": "Google"}, {"url": "https://github.com/tensorflow/models/tree/master/research/lm_1b", "anchor_text": "lm_1b"}, {"url": "https://www.linkedin.com/in/tannistha-m-83588a45/", "anchor_text": "LinkedIn"}, {"url": "https://github.com/tannisthamaiti/Ham_spam_email_classification", "anchor_text": "here"}, {"url": "https://medium.com/tag/nlp?source=post_page-----f8e9e98742a7---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----f8e9e98742a7---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/hyperparameter?source=post_page-----f8e9e98742a7---------------hyperparameter-----------------", "anchor_text": "Hyperparameter"}, {"url": "https://medium.com/tag/classification?source=post_page-----f8e9e98742a7---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----f8e9e98742a7---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff8e9e98742a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&user=tannistha+maiti&userId=f4b805251a23&source=-----f8e9e98742a7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff8e9e98742a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&user=tannistha+maiti&userId=f4b805251a23&source=-----f8e9e98742a7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff8e9e98742a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff8e9e98742a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f8e9e98742a7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f8e9e98742a7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tannistha.iitkgp?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@tannistha.iitkgp?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "tannistha maiti"}, {"url": "https://medium.com/@tannistha.iitkgp/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "78 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff4b805251a23&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&user=tannistha+maiti&userId=f4b805251a23&source=post_page-f4b805251a23--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd77699fc3198&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-a-simple-neural-network-architecture-using-nlp-for-email-classification-f8e9e98742a7&newsletterV3=f4b805251a23&newsletterV3Id=d77699fc3198&user=tannistha+maiti&userId=f4b805251a23&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}