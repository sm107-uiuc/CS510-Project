{"url": "https://towardsdatascience.com/neural-style-transfer-for-audio-in-pytorch-e1de972b1f68", "time": 1683011860.298971, "path": "towardsdatascience.com/neural-style-transfer-for-audio-in-pytorch-e1de972b1f68/", "webpage": {"metadata": {"title": "Neural Style Transfer for Audio in Pytorch | by Neel Iyer | Towards Data Science", "h1": "Neural Style Transfer for Audio in Pytorch", "description": "They\u2019ve been some really interesting applications of style transfer. It basically aims to take the \u2018style\u2019 from one image and change the \u2018content\u2019 image to meet that style. But so far it hasn\u2019t\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/tensorflow/neural-style-transfer-creating-art-with-deep-learning-using-tf-keras-and-eager-execution-7d541ac31398", "anchor_text": "interesting applications", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Joe_Rogan", "anchor_text": "Joe Rogan", "paragraph_index": 2}, {"url": "http://podcasts.joerogan.net/", "anchor_text": "Joe Rogan Experience", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Joey_Diaz", "anchor_text": "Joey Diaz", "paragraph_index": 2}, {"url": "https://www.youtube.com/channel/UCv695o3i-JmkUB7tPbtwXDA", "anchor_text": "Church of Whats Happening Now", "paragraph_index": 2}, {"url": "https://www.youtube.com/watch?v=SLolljsbbFs", "anchor_text": "impression of joey diaz", "paragraph_index": 2}, {"url": "https://github.com/ytdl-org/youtube-dl/issues/622#issuecomment-162337869", "anchor_text": "github", "paragraph_index": 3}, {"url": "https://github.com/ytdl-org/youtube-dl", "anchor_text": "youtube-dl", "paragraph_index": 3}, {"url": "https://ffmpeg.org/", "anchor_text": "ffmpeg", "paragraph_index": 3}, {"url": "https://pytorch.org/tutorials/advanced/neural_style_tutorial.html#content-loss", "anchor_text": "implemented", "paragraph_index": 6}, {"url": "https://ghamrouni.github.io/stn-tuto/advanced/neural_style_tutorial.html", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://github.com/DmitryUlyanov/neural-style-audio-tf/blob/master/neural-style-audio-tf.ipynb", "anchor_text": "github repo", "paragraph_index": 13}, {"url": "https://github.com/alishdipani/Neural-Style-Transfer-Audio", "anchor_text": "github repo", "paragraph_index": 13}, {"url": "https://github.com/alishdipani/Neural-Style-Transfer-Audio/blob/master/NeuralStyleTransfer.py", "anchor_text": "here", "paragraph_index": 15}, {"url": "https://youtu.be/xXXiC4YRGrQ?t=5798", "anchor_text": "fastai", "paragraph_index": 16}, {"url": "https://pytorch.org/tutorials/advanced/neural_style_tutorial.html", "anchor_text": "neural style transfer", "paragraph_index": 17}, {"url": "https://pytorch.org/tutorials/advanced/neural_style_tutorial.html#gradient-descent", "anchor_text": "closure", "paragraph_index": 17}, {"url": "https://github.com/spiyer99/spiyer99.github.io/blob/master/nbs/Neural%20Transfer%20of%20Audio%20in%20Pytorch.ipynb", "anchor_text": "Github", "paragraph_index": 20}], "all_paragraphs": ["They\u2019ve been some really interesting applications of style transfer. It basically aims to take the \u2018style\u2019 from one image and change the \u2018content\u2019 image to meet that style.", "But so far it hasn\u2019t really been applied to audio. So I explored the idea of applying neural style transfer to audio. To be frank, the results were less than stellar but I\u2019m going to keep working on this in the future.", "For this exercise, I\u2019m going to be using clips from the joe rogan podcast. I\u2019m trying to make Joe Rogan, from the Joe Rogan Experience, sound like Joey Diaz, from the Church of Whats Happening Now. Joe Rogan already does a pretty good impression of joey diaz. But I\u2019d like to improve his impression using deep learning.", "First I\u2019m going to download the youtube videos. There\u2019s a neat trick mentioned on github that allows you to download small segments of youtube videos. That\u2019s handy cause I don\u2019t want to download the entire video. You\u2019ll need youtube-dl and ffmpeg for this step.", "There are two types of loss for this", "Ideally we want both content and style loss to be minimised.", "The content loss function takes in an input matrix and a content matrix. The content matrix corresponds to joe rogan\u2019s audio. Then it returns the weighted content distance: between the input matrix and the content matrix. This is implemented using a torch module. It can be calculated using nn.MSELoss.", "This implementation of content loss was largely borrowed from here.", "When looking at the style we really just want to extract the way in which joey diaz speaks. We don\u2019t really want to extract the exact words he says. But we want to get the tone, the intonation, the inflection, etc. from his speech. For that we\u2019ll need to get the gram matrix.", "To calculate this we get the first slice in the input matrix and flatten it. Flattening this slice in the matrix removes a lot of audio information. Then we take another slice from the input matrix and flatten it. We take the dot product of the flattened matrices.", "A dot product is a measure of how similar the two matrices are. If the matrices are similar then the we\u2019ll get a really large result. If they are very different we\u2019ll get a very small result.", "So for example, let\u2019s say that the first flattened matrix corresponded with pitch. And let\u2019s say that the second flattened matrix corresponded with volume. If we get a high dot product, then it\u2019s saying that when volume is high pitch is also high. Or in other words when joey talks very loudly his voice increases in pitch.", "The dot products can give us very large numbers. We normalize them by dividing each element by the total number of elements in the matrix.", "To convert the waveform audio to a matrix that we can pass to pytorch I\u2019ll use librosa. Most of this code was borrowed from Dmitry Ulyanov's github repo and Alish Dipani's github repo.", "We get the Short-time Fourier transform from the audio using the librosa library. The window size for this is 2048, which is also the default setting. There is scope here for replacing the code with code from torchaudio. But this works for now.", "This CNN is very shallow. It consists of 2 convolutions and a ReLU in between them. I originally took the CNN used here but I\u2019ve made a few changes.", "I personally found that my loss values \u2014 particularly for style loss \u2014 were very low. So low they were almost 0. I recitifed this by multiplying by a style_weight and a content_weight. This seems like a crude solution. But according to fastai you care about the direction of the loss and its relative size. So I think it's alright for now.", "Now I\u2019ll run the style transfer. This will use the optim.Adam optimizer. This piece of code was taken from the pytorch tutorial for neural style transfer. For each iteration of the network the style loss and content loss is calculated. In turn that is used to get the gradients. The gradients are mulitplied by the learning rates. That in turn updates the input audio matrix. In pytorch the optimizer requries a closure function.", "Finally the audio needs to be reconstructed. To do that the librosa inverse short-time fourier transform can be used.", "Then we write to an audio file and use the jupyter notebook extension to play the audio in the notebook.", "The notebook for this can be found on Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe1de972b1f68&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://neel-iyer.medium.com/?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": "Neel Iyer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe7c5e1c9cae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&user=Neel+Iyer&userId=e7c5e1c9cae1&source=post_page-e7c5e1c9cae1----e1de972b1f68---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://unsplash.com/@jhjowen", "anchor_text": "James Owen"}, {"url": "https://unsplash.com/photos/MuIvHRJbjA8", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tensorflow/neural-style-transfer-creating-art-with-deep-learning-using-tf-keras-and-eager-execution-7d541ac31398", "anchor_text": "interesting applications"}, {"url": "https://en.wikipedia.org/wiki/Joe_Rogan", "anchor_text": "Joe Rogan"}, {"url": "http://podcasts.joerogan.net/", "anchor_text": "Joe Rogan Experience"}, {"url": "https://en.wikipedia.org/wiki/Joey_Diaz", "anchor_text": "Joey Diaz"}, {"url": "https://www.youtube.com/channel/UCv695o3i-JmkUB7tPbtwXDA", "anchor_text": "Church of Whats Happening Now"}, {"url": "https://www.youtube.com/watch?v=SLolljsbbFs", "anchor_text": "impression of joey diaz"}, {"url": "https://github.com/ytdl-org/youtube-dl/issues/622#issuecomment-162337869", "anchor_text": "github"}, {"url": "https://github.com/ytdl-org/youtube-dl", "anchor_text": "youtube-dl"}, {"url": "https://ffmpeg.org/", "anchor_text": "ffmpeg"}, {"url": "https://pytorch.org/tutorials/advanced/neural_style_tutorial.html#content-loss", "anchor_text": "implemented"}, {"url": "https://ghamrouni.github.io/stn-tuto/advanced/neural_style_tutorial.html", "anchor_text": "here"}, {"url": "https://github.com/DmitryUlyanov/neural-style-audio-tf/blob/master/neural-style-audio-tf.ipynb", "anchor_text": "github repo"}, {"url": "https://github.com/alishdipani/Neural-Style-Transfer-Audio", "anchor_text": "github repo"}, {"url": "https://github.com/alishdipani/Neural-Style-Transfer-Audio/blob/master/NeuralStyleTransfer.py", "anchor_text": "here"}, {"url": "https://stats.stackexchange.com/questions/275358/why-is-increasing-the-non-linearity-of-neural-networks-desired", "anchor_text": "established"}, {"url": "https://youtu.be/xXXiC4YRGrQ?t=5798", "anchor_text": "fastai"}, {"url": "https://pytorch.org/tutorials/advanced/neural_style_tutorial.html", "anchor_text": "neural style transfer"}, {"url": "https://pytorch.org/tutorials/advanced/neural_style_tutorial.html#gradient-descent", "anchor_text": "closure"}, {"url": "https://github.com/spiyer99/spiyer99.github.io/blob/master/nbs/Neural%20Transfer%20of%20Audio%20in%20Pytorch.ipynb", "anchor_text": "Github"}, {"url": "https://spiyer99.github.io/Change-Audio-Pytorch/", "anchor_text": "https://spiyer99.github.io"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----e1de972b1f68---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-style-transfer?source=post_page-----e1de972b1f68---------------neural_style_transfer-----------------", "anchor_text": "Neural Style Transfer"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----e1de972b1f68---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe1de972b1f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&user=Neel+Iyer&userId=e7c5e1c9cae1&source=-----e1de972b1f68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe1de972b1f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&user=Neel+Iyer&userId=e7c5e1c9cae1&source=-----e1de972b1f68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe1de972b1f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e1de972b1f68---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e1de972b1f68--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e1de972b1f68--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e1de972b1f68--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e1de972b1f68--------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Neel Iyer"}, {"url": "https://neel-iyer.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "418 Followers"}, {"url": "https://www.linkedin.com/in/neel-iyer/", "anchor_text": "https://www.linkedin.com/in/neel-iyer/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe7c5e1c9cae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&user=Neel+Iyer&userId=e7c5e1c9cae1&source=post_page-e7c5e1c9cae1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa4687e9ccf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fneural-style-transfer-for-audio-in-pytorch-e1de972b1f68&newsletterV3=e7c5e1c9cae1&newsletterV3Id=a4687e9ccf6&user=Neel+Iyer&userId=e7c5e1c9cae1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}