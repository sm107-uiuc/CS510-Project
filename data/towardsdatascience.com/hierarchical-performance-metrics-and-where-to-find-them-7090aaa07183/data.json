{"url": "https://towardsdatascience.com/hierarchical-performance-metrics-and-where-to-find-them-7090aaa07183", "time": 1683013112.04135, "path": "towardsdatascience.com/hierarchical-performance-metrics-and-where-to-find-them-7090aaa07183/", "webpage": {"metadata": {"title": "Hierarchical Performance Metrics and Where to Find Them | by Noa Weiss | Towards Data Science", "h1": "Hierarchical Performance Metrics and Where to Find Them", "description": "Hierarchical machine learning models are one top-notch trick. As discussed in previous posts, considering the natural taxonomy of the data when designing our models can be well worth our while\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "in", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "previous", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc", "anchor_text": "posts", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "my", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "previous", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc", "anchor_text": "posts", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "the one introducing the subject", "paragraph_index": 5}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "first post in this series", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc", "anchor_text": "blocking by confidence", "paragraph_index": 13}], "all_paragraphs": ["Hierarchical machine learning models are one top-notch trick. As discussed in previous posts, considering the natural taxonomy of the data when designing our models can be well worth our while. Instead of flattening out and ignoring those inner hierarchies, we\u2019re able to use them, making our models smarter and more accurate.", "\u201cMore accurate\u201d, I say \u2014 are they, though? How can we tell? We are people of science, after all, and we expect bold claims to be be supported by the data. This is why we have performance metrics. Whether it\u2019s precision, f1-score, or any other lovely metric we\u2019ve got our eye on \u2014 if using hierarchy in our models improves their performance, the metrics should show it.", "Problem is, if we use regular performance metrics \u2014 the ones designed for flat, one-level classification \u2014 we go back to ignoring that natural taxonomy of the data.", "If we do hierarchy, let\u2019s do it all the way. If we\u2019ve decided to celebrate our data\u2019s taxonomy and build our model in its image, this needs to also be a part of measuring its performance.", "How do we do this? The answer lies below.", "This post is about measuring the performance of machine learning models designed for hierarchical classification. It kind of assumes you know what all those words mean. If you don\u2019t, check out my previous posts on the topic. Especially the one introducing the subject. Really. You\u2019re gonna want to know what hierarchical classification is before learning how to measure it. That\u2019s kind of an obvious one.", "Throughout this post, I\u2019ll be giving examples based on this taxonomy of common house pets:", "So we\u2019ve got a whole ensemble of hierarchically-structured local classifiers, ready to do our bidding. How do we evaluate them?", "That is not a trivial problem, and the solution is not obvious. As we\u2019ve seen in previous problems in this series, different projects require different treatment. The best metric could differ depending on the specific requirements and limitations of your project.", "All in all, there are three main options to choose from. Let\u2019s introduce them, shall we?", "The contestants, in all their grace and glory:", "These are the same classification metrics we all know and love (precision, recall, f-score \u2014 you name it), applied\u2026 Well, flatly.", "Same as with the original \u201cflat classification\u201d approach (described in the first post in this series), this method is all about ignoring the hierarchy. Only the final, leaf-node predictions are considered (in our house pets example, those are the specific breeds), and they\u2019re all considered as equal classes, without any special treatment to sibling-classes vs. non-sibling ones.", "This method is simple, but, obviously, not ideal. We don\u2019t want the errors at different levels of the class hierarchy to be penalized in the same way (if I mistook a Pegasus for a Narwhal, that\u2019s not as bad as mistaking it for a Labrador). Also, there isn\u2019t an obvious way to handle cases where the final prediction is not a leaf-node one \u2014 which could definitely be the case if you implemented the previously-mentioned blocking by confidence method.", "Not happy with the flat metrics, and feel that creative spark tingling in your fingertips? You can conjure up your own special metric, which specifically fits your unique snowflake of a use case.", "This could be useful where the model needs to fit some unusual business constraints. If, for example, you don\u2019t really care about falsely identifying dogs as unicorns, but a Sphynx cat must be correctly spotted or all hell breaks loose, you can design your metrics accordingly, giving more or less weight to different errors.", "Those are variations of well-known precision, recall and f-score metrics, specifically adapted to fit hierarchical classification.", "Please bear with me as I throw some math notations in your general direction:", "What does it all mean, though?", "Pi is the set consisting of the most specific class (or classes, in case of a multi label problem) predicted for each test example i, and all of its/their ancestor classes; Ti is the set consisting of the true most specific class(es) of test example i, and all its/their ancestor classes; and each summation is computed, of course, over all of the test set examples.", "This one is a bit of a handful to unpack, so if you find yourself puzzled, check out the appendix, where I explain it in more detail.", "Now, if you\u2019ve implemented your model with non-mandatory leaf-node prediction (meaning the most specific level predicted doesn\u2019t have to be the deepest one), some adjustments need to be made; I won\u2019t go into it here, but if this is something you want to read more about, let me know.", "The everlasting question. As I previously mentioned, there isn\u2019t one obvious answer, but here are my own thoughts on the subject:", "A machine learning model is nothing without its performance metrics, and hierarchical models require their own special care. There is no one best method to measure hierarchy-based classification: different approaches have their own pros and cons, and each project has its own best fit. If you got this far, you hopefully have an idea as to which method is best for yours, and can now measure your model once you\u2019ve got it rolling.", "This post concludes my four-post series about hierarchical classification models. If you\u2019ve read all of them, you should have all of the tools you need to design, build and measure an outstanding hierarchical classification project. I hope you put it to the best use possible.", "Noa Weiss is an AI & Machine Learning Consultant based in Tel Aviv.", "Can\u2019t figure out those pesky hierarchical metrics? I\u2019m here to help.", "In the table below I go over the mock results of a \u201ccommon house pets\u201d hierarchical model, looking at the measures for the \u201cDalmatian\u201d class (remember: precision, recall and f-score metrics are calculated per class, treating the labels \u2014 both predicted and true \u2014 as binary).", "I go over a few examples, checking out what each of them contributes to both the precision and the recall scores. Remember \u2014 the final precision/recall scores are the summation of all those individual examples.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7090aaa07183&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7090aaa07183--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7090aaa07183--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@noa.weiss?source=post_page-----7090aaa07183--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noa.weiss?source=post_page-----7090aaa07183--------------------------------", "anchor_text": "Noa Weiss"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F94ed18c37f4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&user=Noa+Weiss&userId=94ed18c37f4b&source=post_page-94ed18c37f4b----7090aaa07183---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7090aaa07183&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7090aaa07183&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "in"}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "previous"}, {"url": "https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc", "anchor_text": "posts"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "my"}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "previous"}, {"url": "https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc", "anchor_text": "posts"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "the one introducing the subject"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "first post in this series"}, {"url": "https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc", "anchor_text": "blocking by confidence"}, {"url": "https://towardsdatascience.com/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076", "anchor_text": "The Hitchhiker\u2019s Guide to Hierarchical Classification"}, {"url": "https://towardsdatascience.com/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382", "anchor_text": "Hierarchical Classification with Local Classifiers: Down the Rabbit Hole"}, {"url": "https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc", "anchor_text": "Hierarchical Classification by Local Classifiers: Your Must-Know Tweaks & Tricks"}, {"url": "https://link.springer.com/article/10.1007/s10618-010-0175-9", "anchor_text": "A survey of hierarchical classification across different application domains"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7090aaa07183---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ensemble-learning?source=post_page-----7090aaa07183---------------ensemble_learning-----------------", "anchor_text": "Ensemble Learning"}, {"url": "https://medium.com/tag/performance-metrics?source=post_page-----7090aaa07183---------------performance_metrics-----------------", "anchor_text": "Performance Metrics"}, {"url": "https://medium.com/tag/metrics?source=post_page-----7090aaa07183---------------metrics-----------------", "anchor_text": "Metrics"}, {"url": "https://medium.com/tag/hierarchical?source=post_page-----7090aaa07183---------------hierarchical-----------------", "anchor_text": "Hierarchical"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7090aaa07183&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&user=Noa+Weiss&userId=94ed18c37f4b&source=-----7090aaa07183---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7090aaa07183&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&user=Noa+Weiss&userId=94ed18c37f4b&source=-----7090aaa07183---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7090aaa07183&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7090aaa07183--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7090aaa07183&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7090aaa07183---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7090aaa07183--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7090aaa07183--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7090aaa07183--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7090aaa07183--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7090aaa07183--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7090aaa07183--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7090aaa07183--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7090aaa07183--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noa.weiss?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@noa.weiss?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Noa Weiss"}, {"url": "https://medium.com/@noa.weiss/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "196 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F94ed18c37f4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&user=Noa+Weiss&userId=94ed18c37f4b&source=post_page-94ed18c37f4b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F59eb191f7cc5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhierarchical-performance-metrics-and-where-to-find-them-7090aaa07183&newsletterV3=94ed18c37f4b&newsletterV3Id=59eb191f7cc5&user=Noa+Weiss&userId=94ed18c37f4b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}