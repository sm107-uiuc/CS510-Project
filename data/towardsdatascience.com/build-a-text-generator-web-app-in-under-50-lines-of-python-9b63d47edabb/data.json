{"url": "https://towardsdatascience.com/build-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb", "time": 1683001096.045105, "path": "towardsdatascience.com/build-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb/", "webpage": {"metadata": {"title": "Build a Text Generator Web App in under 50 Lines of Python | by Dev Sharma | Towards Data Science", "h1": "Build a Text Generator Web App in under 50 Lines of Python", "description": "This tutorial assumes you already have Python 3.7+ installed and have some understanding of Language Models. Although the steps involved can be done outside of Jupyter, using a jupyter notebook is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://openai.com/blog/better-language-models/", "anchor_text": "OpenAI\u2019s GPT-2", "paragraph_index": 0}, {"url": "https://panel.pyviz.org/index.html", "anchor_text": "Panel", "paragraph_index": 0}, {"url": "https://www.anaconda.com/distribution/", "anchor_text": "Python 3.7+", "paragraph_index": 1}, {"url": "https://openai.com/blog/better-language-models/", "anchor_text": "Language Models", "paragraph_index": 1}, {"url": "https://jupyter.org/install", "anchor_text": "jupyter notebook", "paragraph_index": 1}, {"url": "https://pytorch.org/get-started/locally/", "anchor_text": "PyTorch", "paragraph_index": 2}, {"url": "https://huggingface.co/transformers/", "anchor_text": "transformers", "paragraph_index": 2}, {"url": "https://panel.pyviz.org/", "anchor_text": "Panel", "paragraph_index": 3}, {"url": "https://youtu.be/3oEb_fFmPnY?list=PLtmWHNX-gukKocXQOkQjuVxglSDYWsSh9&t=1084", "anchor_text": "Nucleus (Top-p) Sampling", "paragraph_index": 9}, {"url": "https://panel.pyviz.org", "anchor_text": "Panel", "paragraph_index": 13}, {"url": "https://panel.pyviz.org/user_guide/Deploy_and_Export.html#Embedding", "anchor_text": "embed this app", "paragraph_index": 31}, {"url": "https://github.com/devkosal/gpt-panel-app", "anchor_text": "github", "paragraph_index": 31}, {"url": "https://github.com/devkosal/gpt-panel-app/blob/master/text_generation_app.ipynb", "anchor_text": "text_generation_app.ipynb", "paragraph_index": 31}], "all_paragraphs": ["We will be using OpenAI\u2019s GPT-2 as the model and Panel as the web dashboard framework. This guide will be split into two parts. In the first part, we will load our model and write a predictions function. In the second, we will build the web application.", "This tutorial assumes you already have Python 3.7+ installed and have some understanding of Language Models. Although the steps involved can be done outside of Jupyter, using a jupyter notebook is highly highly recommended.", "We will be using PyTorch as our Deep Learning library of choice. Within PyTorch, we will use the transformers library to import the pre-trained OpenGPT-2 model. You can install these libraries by individually entering the following commands in your bash:", "For our web application, we will be utilizing Panel, a great tool for easily creating servable dashboards from either jupyter notebooks or a regular python script. Use the following command to install panel:", "OpenAI\u2019s GPT is a type of transformer model which has received a lot of buzz about its capabilities to produce human-like text. If you have not experimented with it before, you are likely to come away with the same opinion at the end of this read.", "First, we need to import the required packages.", "Next, we will load the OpenGPT2 Tokenizer and the Language Model: (it may take a few minutes to download the pre-trained model if run for the first time)", "At this stage, most of the work in already done. Since our model is pre-trained, we don\u2019t need to train it or make any modifications. We simply need to write a function which can input text to the model and generate a prediction.", "There is a lot happening in this function. So, let\u2019s break it down. First, we are tokenizing and encoding the input text from input_ids. Then, we ask our model to generate a logits vector for the next word/token. After applying softmax and sorting these probabilities in descending order, we have a vector, idxs, which lists the indices of each token in our vocab in order by their respective probabilities.", "At this stage, we could just pick the token which has the highest probability. However, we want to be able to mix up our results so the same input text can generate a variety of text. To do this, we will add an element of randomness where we choose a random token from a list of the most probable next tokens. This way, we are not selecting the same predicted token each time. To do this, we utilize Nucleus (Top-p) Sampling.", "We perform this by looping through each probability until the sum of all the probabilities we have looped over is greater than p, an arbitrary number between 0 and 1. All the tokens iterated through until p is exceeded are stored in a list, res. Once, p is exceeded, we choose a token at random from this list. Remember that the list of probabilities that we are looping through contains indices ordered by their probability. Note that if p is higher, more tokens will be included in our list. Vice versa. Therefore, if you want the same result each time, you can set p to 0.", "Now, let\u2019s test out our pred function a few times:", "Each time, there is a different result which is exactly what we expect. Our prediction function is now ready. Let\u2019s build our web app!", "If you are not familiar with Panel, it facilitates the process of creating web dashboards and apps. At a first glance, what you need to know is that it has three primary components:", "The next and final thing you need to know for our purpose is that there are multiple ways for us to define how different panes and widgets interact with each other. These are called \u201ccallbacks.\u201d For example, if a certain button is pressed, how should the other panes be updated? We will be defining a callback function later on which does exactly this.", "Our text generator app will have an input for a user to enter their desired text. Next, the user should be able to generate a new token with a press of a button. After which, new text will be generated with a predicted token from the function we defined in Part 1. Lastly, the user should be able to continue to generate new text on top of the already predicted tokens.", "Let\u2019s first import panel and create the text input widget:", "Now, if we execute text_input in jupyter, we get the following:", "Next, we want a pane which will store the whole text as we generate more and more tokens:", "Notice that we set the object of text to the value of text_input. We want the value of the generated_text to have the same value as the text_input since we will be predicting new text on top of the generated_text. As more tokens get added to our sequence, we will keep predicting over the generated_text until the user changes the text_input. In which case, the process will restart.", "However, we are not quite done yet. Although generated_text will take the value of text_input at its initiation, it will not update itself if the text_input value changes. For this, we need to link these two objects together as so:", "Here, we have formed a unidirectional link between text_input to generated_text. So whenever the value of the text_input changes, the value of generated_text is changed to the new value as well. See:", "Now that we have both our text objects, let\u2019s create our button widget:", "Great, now that we have a button, we just have to link it to our desired behavior. For this we will be writing a callback function which will run every time the button is clicked:", "Two things happen here. First, we pass generated_text as the input to the prediction function we wrote earlier which gives a new token. Second, this token is added to the generated_text. This process repeats each time there is a new click of the button.", "Speaking of, we still have to tie the button click with the callback function. We can do that with:", "We are now through creating all our widgets, panes and functions. We just need to put these objects in a panel and voila:", "Let\u2019s add a title and a brief description and we are through!", "Panel makes it very easy to serve the app. There are two methods which can be used to do this. The first one is the \u201c.show()\u201d command. This is used for debugging usually and it is used as below. This will launch a new window with our final_app panel running as a web application.", "In order to put it in a production environment, you need to use the \u201c.servable()\u201d method. However, if you run this similarly to the show method, nothing different will happen in your current notebook. Instead, you have to serve the notebook through your machine\u2019s bash like this:", "This will launch your app on a local port as long as you have the following code in your notebook:", "By now, you have the capabilities to build your own text generation app. You can further build upon it by adding more panel components. You can even embed this app in your other projects. As always, you can find my code base on github. Note: the app in the title image is the advanced variation found in my tutorial notebook: text_generation_app.ipynb.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9b63d47edabb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@devkosal?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@devkosal?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": "Dev Sharma"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F795cbf38e25d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&user=Dev+Sharma&userId=795cbf38e25d&source=post_page-795cbf38e25d----9b63d47edabb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b63d47edabb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b63d47edabb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://openai.com/blog/better-language-models/", "anchor_text": "OpenAI\u2019s GPT-2"}, {"url": "https://panel.pyviz.org/index.html", "anchor_text": "Panel"}, {"url": "https://www.anaconda.com/distribution/", "anchor_text": "Python 3.7+"}, {"url": "https://openai.com/blog/better-language-models/", "anchor_text": "Language Models"}, {"url": "https://jupyter.org/install", "anchor_text": "jupyter notebook"}, {"url": "https://pytorch.org/get-started/locally/", "anchor_text": "PyTorch"}, {"url": "https://huggingface.co/transformers/", "anchor_text": "transformers"}, {"url": "https://panel.pyviz.org/", "anchor_text": "Panel"}, {"url": "https://youtu.be/3oEb_fFmPnY?list=PLtmWHNX-gukKocXQOkQjuVxglSDYWsSh9&t=1084", "anchor_text": "Nucleus (Top-p) Sampling"}, {"url": "https://panel.pyviz.org", "anchor_text": "Panel"}, {"url": "https://panel.pyviz.org/user_guide/Deploy_and_Export.html#Embedding", "anchor_text": "embed this app"}, {"url": "https://github.com/devkosal/gpt-panel-app", "anchor_text": "github"}, {"url": "https://github.com/devkosal/gpt-panel-app/blob/master/text_generation_app.ipynb", "anchor_text": "text_generation_app.ipynb"}, {"url": "https://github.com/devkosal/gpt-panel-app", "anchor_text": "devkosal/gpt-panel-appYou can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or\u2026github.com"}, {"url": "https://towardsdatascience.com/openai-gpt-2-understanding-language-generation-through-visualization-8252f683b2f8", "anchor_text": "OpenAI GPT-2: Understanding Language Generation through Visualization"}, {"url": "https://panel.pyviz.org/getting_started/index.html", "anchor_text": "Getting Started with Panel"}, {"url": "https://www.youtube.com/watch?v=7deGS4IPAQ0", "anchor_text": "Visualize any Data Easily, from Notebooks to Dashboards | Scipy 2019 Tutorial | James Bednar (Video: first hour is about Panel)"}, {"url": "https://panel.pyviz.org/user_guide/Server_Deployment.html", "anchor_text": "Deploying Panel Apps on a Server"}, {"url": "https://medium.com/tag/python?source=post_page-----9b63d47edabb---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----9b63d47edabb---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9b63d47edabb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----9b63d47edabb---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/web-development?source=post_page-----9b63d47edabb---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b63d47edabb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&user=Dev+Sharma&userId=795cbf38e25d&source=-----9b63d47edabb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b63d47edabb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&user=Dev+Sharma&userId=795cbf38e25d&source=-----9b63d47edabb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b63d47edabb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9b63d47edabb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9b63d47edabb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9b63d47edabb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9b63d47edabb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9b63d47edabb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9b63d47edabb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@devkosal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@devkosal?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dev Sharma"}, {"url": "https://medium.com/@devkosal/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "122 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F795cbf38e25d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&user=Dev+Sharma&userId=795cbf38e25d&source=post_page-795cbf38e25d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa2960c132164&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-text-generator-web-app-in-under-50-lines-of-python-9b63d47edabb&newsletterV3=795cbf38e25d&newsletterV3Id=a2960c132164&user=Dev+Sharma&userId=795cbf38e25d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}