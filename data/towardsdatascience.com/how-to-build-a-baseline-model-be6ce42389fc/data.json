{"url": "https://towardsdatascience.com/how-to-build-a-baseline-model-be6ce42389fc", "time": 1683008701.5191438, "path": "towardsdatascience.com/how-to-build-a-baseline-model-be6ce42389fc/", "webpage": {"metadata": {"title": "How to Build a Baseline Model | Towards Data Science", "h1": "How to Build a Baseline Model", "description": "A pragmatic approach for building a baseline model to understand your data. Code and examples in Python."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@tatianasennikova/code-and-techniques-for-exploratory-data-analysis-a44c50953502", "anchor_text": "Part 1", "paragraph_index": 0}, {"url": "https://medium.com/@tatianasennikova/code-and-techniques-for-exploratory-data-analysis-a44c50953502", "anchor_text": "Part 1", "paragraph_index": 3}, {"url": "https://data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data", "anchor_text": "road safety dataset", "paragraph_index": 3}, {"url": "https://github.com/tsennikova/road-accidents-analysis/blob/master/road_accidents_analysis.ipynb", "anchor_text": "GitHub", "paragraph_index": 3}, {"url": "https://medium.com/@tatianasennikova/code-and-techniques-for-exploratory-data-analysis-a44c50953502", "anchor_text": "Part 1", "paragraph_index": 5}, {"url": "https://stackoverflow.com/a/56876351", "anchor_text": "Vinoj John Hosan", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Principal_component_analysis", "anchor_text": "Principle Component Analysis", "paragraph_index": 19}, {"url": "https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-106", "anchor_text": "SMOTE", "paragraph_index": 21}], "all_paragraphs": ["Disclaimer: You are reading Part 2 of the series. In Part 1, I presented an Exploratory Data Analysis Framework which is a necessary step before starting the modeling part described here.", "It is very tempting to jump right into research and to implement a cutting edge deep learning solution. However, that is the point where I usually tell myself to stay pragmatic and build a decent baseline first. Many data scientists underestimate the importance of having a baseline. I love baseline models for their ability to deliver 90% of value for 10% of the effort. An 80% accurate model in 2 days is better than an 81.5% accurate model in 4 weeks and that is what is important when working with clients. The beauty of a decent baseline model is that it is very hard to beat and the cutting edge models will achieve just a marginal improvement over it. There are few requirements for a good baseline model:", "These two reasons lead us to my favourite choice of baseline models, which are the models from the decision tree family. Another amazing fact about the trees is that tree based models are non-parametric and do not require the data to be normally distributed.", "After deciding on a model, let\u2019s move to the data preparation. In Part 1 we performed an Exploratory Data Analysis of the road safety dataset. The full code for both parts can be found on GitHub.", "The end goal is to develop a model to predict the probability of a police officer to attend an accident. We also should evaluate the quality of the data at our disposal and demonstrate which factors have the highest impact on the model\u2019s decision.", "In Part 1 we created a few new variables:", "For the sake of brevity, I copy these variables from the data dataframe (the one that we used during the exploration phase) to our raw dataframe acc_df. In a production system, the related steps of the data processing pipeline should be implemented.", "We initially had 3 classes in Did_Police_Officer_Attend_Scene_of_Accident. Classes 2 and 3 need to be merged into the negative class as we are interested only in estimating the probability of a police officer attending an accident.", "The response variable in the accident dataset contains two imbalanced classes. Therefore we split the dataset in such a way that we preserve the same proportion of the negative class in both train and test datasets.", "Now let\u2019s start creating data transformers that we will later join into a data processing pipeline. In order to keep the model simple and avoid overfitting, we need to remove columns with associated variables.", "Then we need to encode the category names of LSOA_of_Accident_Location as integers. Some values of this variable are rare and included only in the test dataset. At the same time, new unseen categories can suddenly appear in the future. The standard sklearn implementation does not address this problem, therefore we need to implement another solution by introducing a category \u201cUnknown\u201d in which all previously unseeing values will fall into. I use the implementation of Vinoj John Hosan for that.", "The next step is to fill the missing values. I implemented two strategies. The default one indicates missing value with a special category \u201c-1\u201d. The second strategy is to train a model to fill the missing values based on the values that are present in the dataset. We can test both approached via randomised search while tuning the hyperparameters.", "The last thing we should take care of is rescaling continues values. Strictly speaking it is not necessary for a tree model, but it is good to have if we want to use this pipeline with other classification models in the future.", "Now we can join all the preprocessing steps into a pipeline and run it to prepare the Train and Test datasets.", "The RandomForest Classifier is the most stable from all the decision tree models and less likely to overfit. Therefore it is a good choice to start with.", "Since we are dealing with an imbalanced dataset, I balanced the class weights and used weighted F1 score as a scoring metric for the hyperparameters tuning and model evaluation.", "The average F1 score on the validation set with the best hyperparameter\u2019s choice is 0.785. Now let\u2019s check for the F1 score on the Train and Test datasets to make sure that the model does not overfit.", "Oops, our weighted F1 is 0.96 on the Train dataset and 0.79 on the Test dataset, which means that we over-tuned the hyperparaneters and the model overfits heavily. We need regularise the model.", "The RandomForest Classifier has quite a few parameters to tweak. A small hint how to remember which ones need to be adjusted to reduce the overfitting is that you generally need to decrease the value of the parameters that start with max_ and increase the value of parameters that start with min_. I will reduce the depth of the tree and increase minimum sample split.", "Now the F1 score of the Train and Test datasets looks better. However, there is still room for improvement. One of the approaches to improve the model\u2019s ability to generalise is to use Principle Component Analysis (PCA), which has shown to be a very effective data transformation step for tree models. Since tree models love orthogonal decision boundaries, rotating the dataset might help to build a less convoluted tree. Applying PCA on the dataset before the training will often result in a better orientation of the features and an overall better generalisation ability of the model. The reason why we do not apply PCA before training the baseline model is that PCA transforms features into the principal components which loose their explainability. Yet, explainability is the main requirement for a baseline model.", "Now let\u2019s check for a few other evaluation metrics to make sure that the classification makes sense.", "The model correctly classified 66% of cases where police officer did not attend the accident and in 81% of cases where police officer attended the accident. As expected, the recall and precision on the minority class is worse than the majority class. This could be improved by increasing the number of negative class samples in the dataset, or using more advanced sampling techniques like SMOTE. However, keep in mind that oversampling with SMOTE is computationally expensive and might require to be run in a cloud environment.", "Let\u2019s get the probabilities of the police officer to attend an accident and check for the Area Under the ROC curve for our baseline model.", "The Area Under the ROC curve is 0.83 which is a decent performance for a baseline model.", "I talked a lot about the importance of the model\u2019s explainability. Before we look at it in practice, I would like to take a moment to talk about the characteristic properties of the feature importance in decision tree models. The functions to measure the quality of the split in decision tree algorithms are either Gini Coefficient or Entropy. Both aim to split the tree node in a way that the obtained class samples are as pure as possible. Therefore, high cardinality categorical features, as well as continues features, receive a high importance just based on the fact that they produce plenty of splits with small and pure class samples. However, as we aim to understand how useful each feature is for making classification decision, we need to use another methodology. One of the approaches is to calculate a permutation feature importance. The permutation feature importance answers the question: \u201cHow will the accuracy of our model be affected if we randomly shuffle a single column of the data, while leaving the other columns in place\u201d. That sounds like a more useful definition of the feature importance.", "The feature importance of the implemented classifier is consistent with the findings provided in the Exploratory Data Analysis section. Junction_Control, the Geo variables, and Ploice_Force are the features with the highest discriminative power. From the engineered features the most important are Cycle and Rush_Hour. We can use these insights for future feature engineering by introducing new Geo related variables or by improving the quality of the Junction_Control variable.", "In this part, we looked at several requirements for a good baseline model. Then we saw how to leverage custom transformers for the data processing. A RandomForest Classifier was trained and we saw how to reduce overfitting of a decision tree model. Finally, we calculated the importance of each feature for making the classification decision and showed that the decisions made by our model are in line with the Exploratory Data Analysis that was performed earlier.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Solutions Engineer at Databricks | all views are my own"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbe6ce42389fc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tatianasennikova.medium.com/?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": ""}, {"url": "https://tatianasennikova.medium.com/?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": "Tatiana Sennikova"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c2625b643a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&user=Tatiana+Sennikova&userId=3c2625b643a&source=post_page-3c2625b643a----be6ce42389fc---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6ce42389fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6ce42389fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/@tatianasennikova/code-and-techniques-for-exploratory-data-analysis-a44c50953502", "anchor_text": "Part 1"}, {"url": "https://medium.com/@tatianasennikova/code-and-techniques-for-exploratory-data-analysis-a44c50953502", "anchor_text": "Part 1"}, {"url": "https://data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data", "anchor_text": "road safety dataset"}, {"url": "https://github.com/tsennikova/road-accidents-analysis/blob/master/road_accidents_analysis.ipynb", "anchor_text": "GitHub"}, {"url": "https://medium.com/@tatianasennikova/code-and-techniques-for-exploratory-data-analysis-a44c50953502", "anchor_text": "Part 1"}, {"url": "https://stackoverflow.com/a/56876351", "anchor_text": "Vinoj John Hosan"}, {"url": "https://en.wikipedia.org/wiki/Principal_component_analysis", "anchor_text": "Principle Component Analysis"}, {"url": "https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-106", "anchor_text": "SMOTE"}, {"url": "https://skilled.dev", "anchor_text": "Coding Interview Questions | Skilled.devA full platform where I teach you everything you need to land your next job and the techniques to\u2026skilled.dev"}, {"url": "https://medium.com/tag/data-science?source=post_page-----be6ce42389fc---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----be6ce42389fc---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/python?source=post_page-----be6ce42389fc---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/random-forest?source=post_page-----be6ce42389fc---------------random_forest-----------------", "anchor_text": "Random Forest"}, {"url": "https://medium.com/tag/programming?source=post_page-----be6ce42389fc---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe6ce42389fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&user=Tatiana+Sennikova&userId=3c2625b643a&source=-----be6ce42389fc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbe6ce42389fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&user=Tatiana+Sennikova&userId=3c2625b643a&source=-----be6ce42389fc---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbe6ce42389fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbe6ce42389fc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----be6ce42389fc---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----be6ce42389fc--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----be6ce42389fc--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----be6ce42389fc--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----be6ce42389fc--------------------------------", "anchor_text": ""}, {"url": "https://tatianasennikova.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tatianasennikova.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tatiana Sennikova"}, {"url": "https://tatianasennikova.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "193 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3c2625b643a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&user=Tatiana+Sennikova&userId=3c2625b643a&source=post_page-3c2625b643a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F58b331b01bd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-baseline-model-be6ce42389fc&newsletterV3=3c2625b643a&newsletterV3Id=58b331b01bd3&user=Tatiana+Sennikova&userId=3c2625b643a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}