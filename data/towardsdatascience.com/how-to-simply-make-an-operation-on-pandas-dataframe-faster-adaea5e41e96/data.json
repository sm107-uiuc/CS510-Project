{"url": "https://towardsdatascience.com/how-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96", "time": 1683006362.816382, "path": "towardsdatascience.com/how-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96/", "webpage": {"metadata": {"title": "How to simply make an operation on pandas DataFrame faster | by Mahdi Rasouli | Towards Data Science", "h1": "How to simply make an operation on pandas DataFrame faster", "description": "If you ever had a big enough dataset before, you already know that sometimes a simple operation requires a lot of time. There are a bunch of methods available out there to make an operation on pandas\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/snap/amazon-fine-food-reviews", "anchor_text": "this", "paragraph_index": 1}, {"url": "https://github.com/MINIMALaq/FasterPandasOperation", "anchor_text": "this Github", "paragraph_index": 1}, {"url": "https://github.com/MINIMALaq/FasterPandasOperation/blob/master/FortranMagic.ipynb", "anchor_text": "notebook", "paragraph_index": 12}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.map.html", "anchor_text": "pandas.Series.map", "paragraph_index": 23}], "all_paragraphs": ["If you ever had a big enough dataset before, you already know that sometimes a simple operation requires a lot of time. There are a bunch of methods available out there to make an operation on pandas DataFrame faster. You can use libraries like multiprocessing, modin[ray], cuDF, Dask, Spark to get the job done. Also, You can modify your algorithm to get the task executed way faster. But before going after a hard solution, let\u2019s see if there is any simple way to gain higher speed and save some time!", "As for my dataset, I am using a part of this. It has 2 numerical columns and 1 text column, consisting of some 0 in \u201cHelpfulnessNumerator\u201d column and some NaN in \u201cProfileName\u201d column. (dataset and all notebooks have been uploaded in this Github repository.)", "I want to simply check out different methods without any change in the main function. The function in the numerical part is a divide function.", "The first thing I learned on working on pandas DataFrame was df.iterrows()", "The apply() method is another option:", "The best option among pandas row-wise operation is itertuples() method:", "Using row-wise operation is not compulsory for us most of the time. But if it is a must for you, df.itertuples() is the fastest way.", "let\u2019s do some (fake) numpy vectorizer() method:", "we can use numpy where() method for (real) numpy vectorizer:", "As you can see we can not use the np.where() method everywhere. But it is really fast. let's change the function a little bit:", "Now we can use this function in np.where():", "Also, we can use this function with pandas operation directly:", "Is there any other option? Absolutely yes. If you can write code by Python, You can write code with Fortran. I made a notebook for Fortran magic in Jupyter Notebook. Just as an example, look at this one:", "We can use numba. Numba is a python library that we can use it very straight forward. It is 2X faster than np.where(), and you have not some of the limitations of np.where() here:", "Both numba and Fortran have the option to use the power of multiprocessing. It depends on the size of the DataFrame and the operation. Sometimes we can use multiprocessing and gain more speed and Sometimes multiprocessing in numba and Fortran can't help us much.", "As a conclusion, Do not use row-wise operations on pandas DataFrame. If it is a must, you can use df.itertuples(). Do not use df.iterrows() and df.apply(\u2026,axis=1) never ever.", "You can use np.where() with some tricks most of the time. It is the best option. But if you can not use it, You can use np.vectorize() while you have numerical operations.", "There are some other options like numba and Fortran magics that can help us if we have a large dataset it worth spending some times to learn and use them.", "Also, sometimes pandas itself support what we want. it is better to check pandas at first. :)", "I will define a simple function to evaluate different methods. the function will add a phrase at the beginning of each record.", "Using df.iterrows() is simple. But it is too slow:", "A different kind of using apply() method:", "Oops, np.vectorizer is not as fast as we expect. Yes, Because the operation is not numerical.", "There is a pandas.Series.map that can do limited tasks very fast. It can handle NaN values itself. For example, let's change the function and see the results:", "We can handle NaN values easily in np.where():", "When it comes to text, I prefer to use map() because it is fast. And if I must have a row-wise operation, I will use df.itertuples().", "As I said, After this simple optimizations, We can go after applying multiprocessing and using other libraries to have a faster operation on pandas DataFrame.", "For more information about numba and Fortran magic take a look here:", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fadaea5e41e96&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@MINIMALaq?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@MINIMALaq?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": "Mahdi Rasouli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd3e12cffc59a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&user=Mahdi+Rasouli&userId=d3e12cffc59a&source=post_page-d3e12cffc59a----adaea5e41e96---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fadaea5e41e96&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fadaea5e41e96&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@marcsm?utm_source=medium&utm_medium=referral", "anchor_text": "Marc Sendra Martorell"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/snap/amazon-fine-food-reviews", "anchor_text": "this"}, {"url": "https://github.com/MINIMALaq/FasterPandasOperation", "anchor_text": "this Github"}, {"url": "https://github.com/MINIMALaq/FasterPandasOperation/blob/master/FortranMagic.ipynb", "anchor_text": "notebook"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.map.html", "anchor_text": "pandas.Series.map"}, {"url": "http://numba.pydata.org/numba-doc/0.15.1/examples.html", "anchor_text": "Examples - numba 0.15.1 documentationSuppose we want to write an image-processing function in Python. Here's how it might look. Numba actually produces two\u2026numba.pydata.org"}, {"url": "https://github.com/mgaitan/fortran_magic", "anchor_text": "mgaitan/fortran_magicCompile and import symbols from a cell with Fortran code, using f2py. The contents of the cell are written to a .f90\u2026github.com"}, {"url": "http://arogozhnikov.github.io/2015/11/29/using-fortran-from-python.html", "anchor_text": "Using fortran from pythonI like numpy (a core library for numerical computations in python), but in some very-very rare cases I need to achieve\u2026arogozhnikov.github.io"}, {"url": "https://medium.com/tag/pandas?source=post_page-----adaea5e41e96---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/numpy?source=post_page-----adaea5e41e96---------------numpy-----------------", "anchor_text": "Numpy"}, {"url": "https://medium.com/tag/numba?source=post_page-----adaea5e41e96---------------numba-----------------", "anchor_text": "Numba"}, {"url": "https://medium.com/tag/data-science?source=post_page-----adaea5e41e96---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----adaea5e41e96---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fadaea5e41e96&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&user=Mahdi+Rasouli&userId=d3e12cffc59a&source=-----adaea5e41e96---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fadaea5e41e96&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&user=Mahdi+Rasouli&userId=d3e12cffc59a&source=-----adaea5e41e96---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fadaea5e41e96&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fadaea5e41e96&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----adaea5e41e96---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----adaea5e41e96--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----adaea5e41e96--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----adaea5e41e96--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----adaea5e41e96--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@MINIMALaq?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@MINIMALaq?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mahdi Rasouli"}, {"url": "https://medium.com/@MINIMALaq/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "181 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd3e12cffc59a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&user=Mahdi+Rasouli&userId=d3e12cffc59a&source=post_page-d3e12cffc59a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fefa528b5b207&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-simply-make-an-operation-on-pandas-dataframe-faster-adaea5e41e96&newsletterV3=d3e12cffc59a&newsletterV3Id=efa528b5b207&user=Mahdi+Rasouli&userId=d3e12cffc59a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}