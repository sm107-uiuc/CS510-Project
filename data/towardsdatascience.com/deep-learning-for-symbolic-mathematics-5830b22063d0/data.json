{"url": "https://towardsdatascience.com/deep-learning-for-symbolic-mathematics-5830b22063d0", "time": 1683002027.6809611, "path": "towardsdatascience.com/deep-learning-for-symbolic-mathematics-5830b22063d0/", "webpage": {"metadata": {"title": "Deep Learning for symbolic mathematics | by Oliver M\u00fcller | Towards Data Science", "h1": "Deep Learning for symbolic mathematics", "description": "This article attempts to describe the main contents of the paper \u201cDeep Learning for Symbolic Mathematics\u201d, by Guillaume Lample and Fran\u00e7ois Charton. DeepLearning methods have successfully been used\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "\u201cDeep Learning for Symbolic Mathematics\u201d, by Guillaume Lample and Fran\u00e7ois Charton.", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "The paper mentioned above", "paragraph_index": 3}, {"url": "https://google.github.io/seq2seq/", "anchor_text": "Seq2Seq", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/understanding-encoder-decoder-sequence-to-sequence-model-679e04af4346", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://en.wikipedia.org/wiki/Infix_notation", "anchor_text": "infix notation", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Polish_notation", "anchor_text": "prefix-notation", "paragraph_index": 14}, {"url": "https://www.sympy.org/en/index.html", "anchor_text": "SymPy", "paragraph_index": 19}, {"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "Guillaume Lample and Fran\u00e7ois Charton", "paragraph_index": 27}, {"url": "https://www.wolfram.com/mathematica/", "anchor_text": "Mathematica", "paragraph_index": 29}, {"url": "https://de.maplesoft.com/products/Maple/", "anchor_text": "Maple", "paragraph_index": 29}, {"url": "https://www.mathworks.com/products/matlab.html", "anchor_text": "Matlab", "paragraph_index": 29}, {"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "original paper", "paragraph_index": 36}], "all_paragraphs": ["This article attempts to describe the main contents of the paper \u201cDeep Learning for Symbolic Mathematics\u201d, by Guillaume Lample and Fran\u00e7ois Charton.", "DeepLearning methods have successfully been used for a multitude of tasks, most often improving the current state of the art by a large margin. Examples include:", "What all these scenarios have in common is that for any given input, a certain range of outputs is acceptable:", "The paper mentioned above explores a different kind of scenario. One in which the output is either 100% correct or 100% incorrect: Solving mathematical expressions.", "More specifically, the paper explores two tasks:", "In this article I will only describe the process of function integration. Typically the following notation is used:", "For the task of integration, a function f is given and its integral F is the desired answer. There are multiple correct ways of expressing that answer, but each of these ways is 100% correct. Any other expression is 100% incorrect.", "The DeepLearning architecture that is used to tackle this problem is called Seq2Seq. A detailed explanation of what it is and how it works can be found here.", "All you need to know right now is that a Seq2Seq model takes an input sequence of arbitrary length and transforms it into some output sequence of arbitrary length.", "The most important properties of this model for the task of function integration are:", "Those two properties make this kind of model a perfect fit for the current task. The input sequence would be the symbols that define the input function and the output sequence would be the symbols that define the integral.", "But how exactly do we feed mathematical expressions to this model?", "Usually mathematical expressions already are in sequence form, the so-called infix notation. It\u2019s called like that because binary operators are written in-between the two arguments they refer to.", "However, this notation is not very well suited for processing in a seq2seq model. This because to make the order of the operations unambiguous, a lot of parenthesis are needed:", "To circumvent this problem, the paper uses the so called prefix-notation. To construct a prefix-notation expression from an infix-notation expression, the following steps are used:", "First, construct a tree that captures the order and values of the operations in the expression.", "Second, the tree is traversed from top to bottom and from left to right with the following rules:", "In the above example, this procedure would lead to the expression:", "Every DeepLearning application needs lots of data to train on, and integrating symbolic expressions is no different. Fortunately there are ways to automatically generate an arbitrary amount of training data. The paper proposes 3 different ways of generating function->integral pairs.", "This one is straight forward. Randomly generate a symbolic function f, then use an external tool to compute the symbolic integral F. External tools could be libraries like SymPy. The pair (f, F) is then used as training sample.", "There are two main drawbacks to this method:", "Also, pairs (f,F) produced by this method have the property, that f often consists of much fewer symbols than F. This is a result from how the automatic symbolic integration works.", "Make use of the fact that it is easy to differentiate, but hard to integrate a function. Randomly generate a function F, then automatically differentiate it to receive function f. The pair (f,F) is then as training sample.", "Pairs (f,F) produced by this method have the property, that F most often consists of fewer symbols than f. This is a result from how the automatic symbolic differentiation works.", "This method makes use of a mathematical property of integrals over functions that are multiplied together. The property is as follows:", "The algorithm for generating functions with this trick:", "After building a training set with either one or a combination of the method described above, these two additional steps are performed:", "Now that the groundwork is done, lets look at the results that Guillaume Lample and Fran\u00e7ois Charton achieved.", "Using training data from only one of FWD, BWD or IBP and evaluating the model on data generated from the same method yields very good results:", "Next, the authors compared their accuracies to results produced by Mathematica, Maple and Matlab. Only the BWD generator was evaluated. The results are clear:", "The seq2seq model clearly outperforms the mathematical frameworks on equations generated by the BWD approach.", "Here is an example of an equation that Mathematica could not solve. If the denominator is simplified, Mathematica succeeds in solving the integral:", "Finally, the authors evaluated models that were trained on one generator using equations from another generator.", "Training a model on only one generator does not seem to generalize well to other generators. This is probably due to the fact that the training pairs (f,F) from each generator have different properites regarding their length. E.g. long f and short F, or short f and long F.", "However, training the model on equations from all 3 generators works well:", "So all in all, the authors demonstrated that a neural network approach can work even for tasks that require an absolute precision in their outputs. They even outperform popular mathematical frameworks in some settings.", "If you have the time you should read the original paper. It is very well written and easy to follow, even without much mathematical background!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Diploma in Applied Mathematics. Passionate about connecting theoretical knowledge with practical applications."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5830b22063d0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5830b22063d0--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5830b22063d0--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@oneironaut.oml?source=post_page-----5830b22063d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oneironaut.oml?source=post_page-----5830b22063d0--------------------------------", "anchor_text": "Oliver M\u00fcller"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf9b68a4259e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&user=Oliver+M%C3%BCller&userId=df9b68a4259e&source=post_page-df9b68a4259e----5830b22063d0---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5830b22063d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5830b22063d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "\u201cDeep Learning for Symbolic Mathematics\u201d, by Guillaume Lample and Fran\u00e7ois Charton."}, {"url": "https://pixabay.com/de/users/pascualamaia-4708629/?utm_source=link-attribution&amp;", "anchor_text": "pascualamaia"}, {"url": "https://www.flickr.com/photos/pasa/", "anchor_text": "Paul Sableman"}, {"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "The paper mentioned above"}, {"url": "https://google.github.io/seq2seq/", "anchor_text": "Seq2Seq"}, {"url": "https://towardsdatascience.com/understanding-encoder-decoder-sequence-to-sequence-model-679e04af4346", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Infix_notation", "anchor_text": "infix notation"}, {"url": "https://en.wikipedia.org/wiki/Polish_notation", "anchor_text": "prefix-notation"}, {"url": "https://www.sympy.org/en/index.html", "anchor_text": "SymPy"}, {"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "Guillaume Lample and Fran\u00e7ois Charton"}, {"url": "https://www.wolfram.com/mathematica/", "anchor_text": "Mathematica"}, {"url": "https://de.maplesoft.com/products/Maple/", "anchor_text": "Maple"}, {"url": "https://www.mathworks.com/products/matlab.html", "anchor_text": "Matlab"}, {"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "original paper"}, {"url": "https://arxiv.org/abs/1912.01412", "anchor_text": "original paper"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----5830b22063d0---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----5830b22063d0---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----5830b22063d0---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----5830b22063d0---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5830b22063d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&user=Oliver+M%C3%BCller&userId=df9b68a4259e&source=-----5830b22063d0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5830b22063d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&user=Oliver+M%C3%BCller&userId=df9b68a4259e&source=-----5830b22063d0---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5830b22063d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5830b22063d0--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5830b22063d0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5830b22063d0---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5830b22063d0--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5830b22063d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5830b22063d0--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5830b22063d0--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5830b22063d0--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5830b22063d0--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5830b22063d0--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5830b22063d0--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oneironaut.oml?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@oneironaut.oml?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Oliver M\u00fcller"}, {"url": "https://medium.com/@oneironaut.oml/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "83 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdf9b68a4259e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&user=Oliver+M%C3%BCller&userId=df9b68a4259e&source=post_page-df9b68a4259e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fdf9b68a4259e%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-for-symbolic-mathematics-5830b22063d0&user=Oliver+M%C3%BCller&userId=df9b68a4259e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}