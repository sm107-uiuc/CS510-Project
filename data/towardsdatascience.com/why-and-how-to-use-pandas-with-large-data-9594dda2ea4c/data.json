{"url": "https://towardsdatascience.com/why-and-how-to-use-pandas-with-large-data-9594dda2ea4c", "time": 1682993881.968203, "path": "towardsdatascience.com/why-and-how-to-use-pandas-with-large-data-9594dda2ea4c/", "webpage": {"metadata": {"title": "Why and How to Use Pandas with Large Data | by Admond Lee | Towards Data Science", "h1": "Why and How to Use Pandas with Large Data", "description": "Pandas has been one of the most popular and favourite data science tools used in Python programming language for data wrangling and analysis. Data is unavoidably messy in real world. And Pandas is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas.pydata.org/", "anchor_text": "Pandas", "paragraph_index": 0}, {"url": "https://www.python.org/", "anchor_text": "Python", "paragraph_index": 0}, {"url": "http://www.numpy.org/", "anchor_text": "NumPy", "paragraph_index": 2}, {"url": "https://activewizards.com/blog/top-15-libraries-for-data-science-in-python/", "anchor_text": "abundance of useful features for operations on n-arrays and matrices in Python", "paragraph_index": 2}, {"url": "https://www.scipy.org/", "anchor_text": "SciPy", "paragraph_index": 5}, {"url": "https://www.wired.com/insights/2014/04/big-data-big-hype/", "anchor_text": "hype around big data", "paragraph_index": 7}, {"url": "http://blog.syncsort.com/2018/03/big-data/big-data-vs-traditional-data/", "anchor_text": "big data", "paragraph_index": 7}, {"url": "https://aws.amazon.com/ec2/", "anchor_text": "AWS EC2", "paragraph_index": 12}, {"url": "https://hadoop.apache.org/", "anchor_text": "Hadoop", "paragraph_index": 12}, {"url": "https://spark.apache.org/", "anchor_text": "Spark", "paragraph_index": 12}, {"url": "https://www.edureka.co/blog/hadoop-ecosystem", "anchor_text": "many other tools", "paragraph_index": 12}, {"url": "http://pbpython.com/pandas_dtypes.html", "anchor_text": "convert a pandas column of data to a different type", "paragraph_index": 23}, {"url": "https://medium.com/p/9594dda2ea4c/edit", "anchor_text": "most of the features", "paragraph_index": 29}, {"url": "https://www.amazon.com/Python-Data-Analysis-Wrangling-IPython/dp/1449319793/ref=as_li_ss_tl?ie=UTF8&linkCode=ll1&tag=admond-20&linkId=3b36a4cb00a369cf09eb1d7af9690b8a", "anchor_text": "Python for Data Analysis", "paragraph_index": 30}, {"url": "https://www.linkedin.com/in/admond1994/", "anchor_text": "LinkedIn", "paragraph_index": 31}, {"url": "https://www.linkedin.com/in/admond1994/", "anchor_text": "Admond Lee", "paragraph_index": 32}, {"url": "https://www.trystaq.com", "anchor_text": "Staq", "paragraph_index": 32}, {"url": "https://bit.ly/3pGF8jv", "anchor_text": "Join Admond\u2019s email newsletter \u2014 Hustle Hub", "paragraph_index": 34}, {"url": "https://www.linkedin.com/in/admond1994/", "anchor_text": "LinkedIn", "paragraph_index": 35}, {"url": "https://medium.com/@admond1994", "anchor_text": "Medium", "paragraph_index": 35}, {"url": "https://twitter.com/admond1994", "anchor_text": "Twitter", "paragraph_index": 35}, {"url": "https://www.facebook.com/admond1994", "anchor_text": "Facebook", "paragraph_index": 35}], "all_paragraphs": ["Pandas has been one of the most popular and favourite data science tools used in Python programming language for data wrangling and analysis.", "Data is unavoidably messy in real world. And Pandas is seriously a game changer when it comes to cleaning, transforming, manipulating and analyzing data. In simple terms, Pandas helps to clean the mess.", "When I first started out learning Python, I was naturally introduced to NumPy (Numerical Python). It is the fundamental package for scientific computing with Python that provides an abundance of useful features for operations on n-arrays and matrices in Python.", "In addition, the library provides vectorization of mathematical operations on the NumPy array type, which significantly optimizes computation with high performance and enhanced speed of execution.", "But therein still lies some underlying needs for more higher level of data analysis tools. And this is where Pandas comes to my rescue.", "Fundamentally, the functionality of Pandas is built on top of NumPy and both libraries belong to the SciPy stack. This means that Pandas relies heavily on NumPy array to implement its objects for manipulation and computation \u2014 but used in a more convenient fashion.", "In practice, NumPy & Pandas are still being used interchangeably. The high level features and its convenient usage are what determine my preference in Pandas.", "There is a stark difference between large data and big data. With the hype around big data, it is easy for us to consider everything as \u201cbig data\u201d and just go with the flow.", "A famous joke by Prof. Dan Ariely:", "The word large and big are in themselves \u2018relative\u2019 and in my humble opinion, large data is data sets that are less than 100GB.", "Pandas is very efficient with small data (usually from 100MB up to 1GB) and performance is rarely a concern.", "However, if you\u2019re in data science or big data field, chances are you\u2019ll encounter a common problem sooner or later when using Pandas \u2014 low performance and long runtime that ultimately result in insufficient memory usage \u2014 when you\u2019re dealing with large data sets.", "Indeed, Pandas has its own limitation when it comes to big data due to its algorithm and local memory constraints. Therefore, big data is typically stored in computing clusters for higher scalability and fault tolerance. And it can often be accessed through big data ecosystem (AWS EC2, Hadoop etc.) using Spark and many other tools.", "Eventually, one of the ways to use Pandas with large data on local machines (with certain memory constraints) is to reduce memory usage of the data.", "So the question is: How to reduce memory usage of data using Pandas?", "The following explanation will be based my experience on an anonymous large data set (40\u201350 GB) which required me to reduce the memory usage to fit into local memory for analysis (even before reading the data set to a dataframe).", "To be honest, I was baffled when I encountered an error and I couldn\u2019t read the data from CSV file, only to realize that the memory of my local machine was too small for the data with 16GB of RAM.", "Here comes the good news and the beauty of Pandas: I realized that pandas.read_csv has a parameter called chunksize!", "The parameter essentially means the number of rows to be read into a dataframe at any single time in order to fit into the local memory. Since the data consists of more than 70 millions of rows, I specified the chunksize as 1 million rows each time that broke the large data set into many smaller pieces.", "The operation above resulted in a TextFileReader object for iteration. Strictly speaking, df_chunk is not a dataframe but an object for further operation in the next step.", "Once I had the object ready, the basic workflow was to perform operation on each chunk and concatenate each of them to form a dataframe in the end (as shown below). By iterating each chunk, I performed data filtering/preprocessing using a function \u2014 chunk_preprocessing before appending each chunk to a list. And finally I concatenated the list into a final dataframe to fit into the local memory.", "Great. At this stage, I already had a dataframe to do all sorts of analysis required.", "To save more time for data manipulation and computation, I further filtered out some unimportant columns to save more memory.", "The simplest way to convert a pandas column of data to a different type is to use astype().", "I can say that changing data types in Pandas is extremely helpful to save memory, especially if you have large data for intense analysis or computation (For example, feed data into your machine learning model for training).", "By reducing the bits required to store the data, I reduced the overall memory usage by the data up to 50% !", "Give it a try. And I believe you\u2019ll find that useful as well! Let me know how it goes. \ud83d\ude0a", "There you have it. Thank you for reading.", "I hope that sharing my experience in using Pandas with large data could help you explore another useful feature in Pandas to deal with large data by reducing memory usage and ultimately improving computational efficiency.", "Typically, Pandas has most of the features that we need for data wrangling and analysis. I strongly encourage you to check them out as they\u2019d come in handy to you next time.", "Also, if you\u2019re serious about learning how to do data analysis in Python, then this book is for you \u2014 Python for Data Analysis. With complete instructions for manipulating, processing, cleaning, and crunching datasets in Python using Pandas, the book gives a comprehensive and step-by-step guides to effectively use Pandas in your analysis.", "As always, if you have any questions or comments feel free to leave your feedback below or you can always reach me on LinkedIn. Till then, see you in the next post! \ud83d\ude04", "Admond Lee is currently the Co-Founder/CTO of Staq \u2014 the #1 business banking API platform for Southeast Asia.", "Want to get free weekly data science and startup insights?", "Join Admond\u2019s email newsletter \u2014 Hustle Hub, where every week he shares actionable data science career tips, mistakes & learnings from building his startup \u2014 Staq.", "You can connect with him on LinkedIn, Medium, Twitter, and Facebook.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Co-Founder & CTO @ Staq | Building the universal API to help fintech companies access financial data from SMEs across Southeast Asia \ud83d\ude80"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9594dda2ea4c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@admond1994?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@admond1994?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": "Admond Lee"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cfb1b8791bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&user=Admond+Lee&userId=7cfb1b8791bb&source=post_page-7cfb1b8791bb----9594dda2ea4c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9594dda2ea4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9594dda2ea4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pandas.pydata.org/", "anchor_text": "Pandas"}, {"url": "https://www.python.org/", "anchor_text": "Python"}, {"url": "http://www.numpy.org/", "anchor_text": "NumPy"}, {"url": "https://activewizards.com/blog/top-15-libraries-for-data-science-in-python/", "anchor_text": "abundance of useful features for operations on n-arrays and matrices in Python"}, {"url": "https://www.scipy.org/", "anchor_text": "SciPy"}, {"url": "https://www.wired.com/insights/2014/04/big-data-big-hype/", "anchor_text": "hype around big data"}, {"url": "http://blog.syncsort.com/2018/03/big-data/big-data-vs-traditional-data/", "anchor_text": "big data"}, {"url": "https://www.facebook.com/dan.ariely/posts/904383595868", "anchor_text": "(Source)"}, {"url": "https://aws.amazon.com/ec2/", "anchor_text": "AWS EC2"}, {"url": "https://hadoop.apache.org/", "anchor_text": "Hadoop"}, {"url": "https://spark.apache.org/", "anchor_text": "Spark"}, {"url": "https://www.edureka.co/blog/hadoop-ecosystem", "anchor_text": "many other tools"}, {"url": "https://unsplash.com/photos/lO2qvjuM7ec", "anchor_text": "(Source)"}, {"url": "http://pbpython.com/pandas_dtypes.html", "anchor_text": "convert a pandas column of data to a different type"}, {"url": "https://unsplash.com/photos/FXFz-sW0uwo", "anchor_text": "(Source)"}, {"url": "https://medium.com/p/9594dda2ea4c/edit", "anchor_text": "most of the features"}, {"url": "https://www.amazon.com/Python-Data-Analysis-Wrangling-IPython/dp/1449319793/ref=as_li_ss_tl?ie=UTF8&linkCode=ll1&tag=admond-20&linkId=3b36a4cb00a369cf09eb1d7af9690b8a", "anchor_text": "Python for Data Analysis"}, {"url": "https://www.linkedin.com/in/admond1994/", "anchor_text": "LinkedIn"}, {"url": "https://www.linkedin.com/in/admond1994/", "anchor_text": "Admond Lee"}, {"url": "https://www.trystaq.com", "anchor_text": "Staq"}, {"url": "https://bit.ly/3pGF8jv", "anchor_text": "Join Admond\u2019s email newsletter \u2014 Hustle Hub"}, {"url": "https://www.linkedin.com/in/admond1994/", "anchor_text": "LinkedIn"}, {"url": "https://medium.com/@admond1994", "anchor_text": "Medium"}, {"url": "https://twitter.com/admond1994", "anchor_text": "Twitter"}, {"url": "https://www.facebook.com/admond1994", "anchor_text": "Facebook"}, {"url": "https://www.admondlee.com/", "anchor_text": "Admond LeeIn the mission of making data science accessible to everyone. Admond is helping companies and digital marketing agencies achieve their marketing ROI with actionable insights through advanced social analytics and machine learning.www.admondlee.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9594dda2ea4c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----9594dda2ea4c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/education?source=post_page-----9594dda2ea4c---------------education-----------------", "anchor_text": "Education"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----9594dda2ea4c---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/python?source=post_page-----9594dda2ea4c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9594dda2ea4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&user=Admond+Lee&userId=7cfb1b8791bb&source=-----9594dda2ea4c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9594dda2ea4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&user=Admond+Lee&userId=7cfb1b8791bb&source=-----9594dda2ea4c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9594dda2ea4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9594dda2ea4c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9594dda2ea4c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9594dda2ea4c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@admond1994?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@admond1994?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Admond Lee"}, {"url": "https://medium.com/@admond1994/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6.3K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7cfb1b8791bb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&user=Admond+Lee&userId=7cfb1b8791bb&source=post_page-7cfb1b8791bb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F805a9a823fd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-and-how-to-use-pandas-with-large-data-9594dda2ea4c&newsletterV3=7cfb1b8791bb&newsletterV3Id=805a9a823fd3&user=Admond+Lee&userId=7cfb1b8791bb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}