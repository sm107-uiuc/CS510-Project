{"url": "https://towardsdatascience.com/an-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4", "time": 1683010058.961906, "path": "towardsdatascience.com/an-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4/", "webpage": {"metadata": {"title": "An intuitive approach to DTW \u2014 Dynamic Time Warping | by Himanshu Chandra | Towards Data Science", "h1": "An intuitive approach to DTW \u2014 Dynamic Time Warping", "description": "Since you are here, I assume you already know the reason why we use Dynamic Time Warping, or DTW in time-series data. Simply put, it\u2019s used to align or match two similar patterns. One of the reasons\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "here", "paragraph_index": 3}, {"url": "http://seninp.github.io/assets/pubs/senin_dtw_litreview_2008.pdf", "anchor_text": "here", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Dynamic_programming", "anchor_text": "Dynamic Programming", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Recursion_(computer_science)", "anchor_text": "recursion", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "euclidean distance", "paragraph_index": 33}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping#Implementation", "anchor_text": "windowed DTW", "paragraph_index": 38}, {"url": "https://www.linkedin.com/in/himanshu-chandra-33512811/", "anchor_text": "LinkedIn", "paragraph_index": 39}, {"url": "https://www.youtube.com/channel/UChNybQwpqrX9SOc1D4K_x5Q", "anchor_text": "YouTube", "paragraph_index": 39}, {"url": "https://github.com/HCGrit/MachineLearning-iamJustAStudent", "anchor_text": "GitHub", "paragraph_index": 39}, {"url": "http://iamjustastudent.com/about", "anchor_text": "I am Just a Student", "paragraph_index": 39}, {"url": "https://iamjustastudent.com/about", "anchor_text": "https://iamjustastudent.com/about", "paragraph_index": 42}], "all_paragraphs": ["Since you are here, I assume you already know the reason why we use Dynamic Time Warping, or DTW in time-series data. Simply put, it\u2019s used to align or match two similar patterns.", "One of the reasons DTW was initially developed was for speech recognition. Your mother may speak slowly one day, and hurriedly on another; even have a bit of cold and sore throat on some days, but you still can recognize her voice. Can machines do the same? Can they somehow match the highs and lows, the peaks and troughs, the frequencies of her voice, no manner how she speaks and tell us it is her voice indeed?", "There are several awesome real life situations were DTW just rocks \u2014 if you do not know them already, I recommend getting to know them \u2014 they are really fun!", "You can read more about DTW here and about it\u2019s many applications here (refer the Introduction section)", "I love this algorithm! In essence, it is one of those short and elegant algos which pack a punch. It is a classic example of finding the shortest path using the Dynamic Programming approach.", "I have had colleagues running away from understanding the inner workings of the algo as it involves recursion. This eventually stops them from understanding the nuances of the approach and from learning how to tweak it as per their requirements.", "Let\u2019s visualize the logic behind the algorithm in a non-programmatic way so that we can write it from scratch.", "To understand recursion, one must first understand recursion.", "Imagine you are standing at the blue square and wish to go to the red square. All the numbers that you see in the cells along the path, correspond to the toll amount you have to pay at each step (arbitrarily decided, for now). If I were to ask you, \u201cTell me the least amount one needs to spend to reach from blue to red\u201d, how would you do it?", "In fact, I\u2019ll make it simpler by saying that you are supposed to move only in the \u2018forward\u2019 direction. The black arrows show the only 3 \u2018allowed\u2019 directions (right, down, right-down diagonal) and red arrows show \u2018restricted\u2019 directions, which are everything apart from the 3 allowed ones (up, left, other diagonals, etc.). This is similar to what DTW assumes before solving the problem.", "Another way to say the above fact is that, \u201cYou can arrive at any square only from one of the 3 adjacent squares\u201d:", "A \u2018brute-force\u2019 way would be to try all the paths possible from the blue to the red square and choose the cheapest one. However, dynamic programming and recursion give us a better, smarter way.", "I like to solve all recursion problems by thinking as \u2018the lazy boss\u2019 who has uncountable minions at his disposal to do the job. If someone asked me to solve the above problem, I would simply say, \u201cMinions A, B and C, tell me the least cost to reach the 3 squares surrounding the red square, and then I\u2019ll calculate the answer in a minute. Till then, don\u2019t bother me.\u201d", "This is the trick recursion uses \u2014 give the exact same kind of work you have been asked to do, to your underlings, after \u2018scaling down\u2019 the work a bit. And make sure to keep something simple for yourself, so that no one can say you did nothing!", "Suppose by some magic (which you are not interested in knowing about), the minions bring you the answer, marked in green cells:", "All I need to do now is find the minimum of (10, 7, 7), which is 7 and then add current square\u2019s cost, which is 2. This gives me the answer as 9. Done!", "9 is the minimum cost of travelling from blue to red. But wait, how did the minions come up with the green values? They of course, emulate you and act as lazy bosses too!", "Each minion gets hold of 3 junior minions (the damned hierarchy in the office, I tell you!) and tells them to bring them least cost values for their 3 neighbourhood/adjacent squares. Here\u2019s an animation to better explain this:", "This keeps going on and on, with each junior minion \u2018magically\u2019 getting its answer. But for how long? Surely it ends sometime? Yes, it does. When there is no way to subdivide the work further. When a minion gets the task to calculate the cost at the blue square, he can\u2019t delegate it to anyone else, as there is no neighbourhood to go to. He just needs to know that the cost there is zero.", "That\u2019s it. You can translate this into a recursive python function in just a few lines of code:", "Here, cost is a 2-D array, our initial matrix:", "Notice how I have returned np.inf (infinity) when either i or j is less than zero. This is just a way to ignore the neighbour which doesn\u2019t exist. For example, when you are in a top-row square, the only neighbour you need to consider is the left one, as there\u2019s no square above the current square. Similar logic goes for squares in the first column, where there\u2019s no neighbour to the left.", "And you can call the recursive function by simply calling:", "The output it will give is 9.", "If you call it for all the squares, you can finally create a cheapest cost matrix as output:", "So, what would be the cheapest path from the blue square to the red square?", "We just need to track the minimum-neighbour around each square. Here\u2019s the code if you want to print the path too. This is certainly not optimized, but is simple to understand:", "Let\u2019s see the path returned from blue to red square by calling:", "Or tracing it over our original matrix:", "Quite right! How does DTW picture into all of this?", "Well, DTW is nothing but simply matching one point in time-series pattern1 with the closest point in pattern2.", "Let\u2019s look at the mapping of two signals again. The one in cyan is pattern1 and the one in orange is pattern2, with the red lines trying to find a corresponding point on pattern1 for every point on pattern2:", "So essentially, we are finding the shortest or cheapest path between a pattern2-point and pattern1-point. But what is the cost between any two points. Do we put it randomly like we did in our example for each square?", "You have various choices you can pick from here, as per your use-case, but the most common one is the euclidean distance between those points.", "You arrange all pattern1-points as column axis of the matrix and all pattern2-points as row axis. Then fill each square with the euclidean distance:", "But what does that actually achieve? What does such shortest-distance matching mean?", "I like to imagine it as a solution where you are trying to match pattern2 with pattern1 in a manner that ensures least stretching (or shrinking) of pattern2; greedily matching it to the closest neighbour.", "And there you have it. A simple DTW algorithm implemented from scratch.", "I have not mentioned several nuances and variations of the DTW process, for example a windowed DTW where we add a locality constraint. I hope this article has sparked your interest in knowing more about it. Do let me know if you discover something cool about it!", "Interested in sharing ideas, asking questions or simply discussing thoughts? Connect with me on LinkedIn, YouTube, GitHub or through my website: I am Just a Student.", "See you around & happy learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Tech enthusiast. I love absorbing new concepts and sharing them with others in the simplest of ways. Reach out on: https://iamjustastudent.com/about"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff660ccb77ff4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@himanshuhc?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshuhc?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": "Himanshu Chandra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88960b2eb891&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&user=Himanshu+Chandra&userId=88960b2eb891&source=post_page-88960b2eb891----f660ccb77ff4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff660ccb77ff4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff660ccb77ff4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@nxvision?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Nigel Tadyanehondo"}, {"url": "https://towardsdatascience.com/photos/i9gR_dz_xzU?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping", "anchor_text": "here"}, {"url": "http://seninp.github.io/assets/pubs/senin_dtw_litreview_2008.pdf", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Dynamic_programming", "anchor_text": "Dynamic Programming"}, {"url": "https://en.wikipedia.org/wiki/Recursion_(computer_science)", "anchor_text": "recursion"}, {"url": "https://en.wikipedia.org/wiki/Euclidean_distance", "anchor_text": "euclidean distance"}, {"url": "https://en.wikipedia.org/wiki/Dynamic_time_warping#Implementation", "anchor_text": "windowed DTW"}, {"url": "https://www.linkedin.com/in/himanshu-chandra-33512811/", "anchor_text": "LinkedIn"}, {"url": "https://www.youtube.com/channel/UChNybQwpqrX9SOc1D4K_x5Q", "anchor_text": "YouTube"}, {"url": "https://github.com/HCGrit/MachineLearning-iamJustAStudent", "anchor_text": "GitHub"}, {"url": "http://iamjustastudent.com/about", "anchor_text": "I am Just a Student"}, {"url": "https://www.linkedin.com/in/himanshu-chandra-33512811/", "anchor_text": "Himanshu Chandra - Business Head - AI, MLwww.linkedin.com"}, {"url": "https://medium.com/tag/dtw?source=post_page-----f660ccb77ff4---------------dtw-----------------", "anchor_text": "Dtw"}, {"url": "https://medium.com/tag/dynamic-time-warping?source=post_page-----f660ccb77ff4---------------dynamic_time_warping-----------------", "anchor_text": "Dynamic Time Warping"}, {"url": "https://medium.com/tag/dynamic-programming?source=post_page-----f660ccb77ff4---------------dynamic_programming-----------------", "anchor_text": "Dynamic Programming"}, {"url": "https://medium.com/tag/recursion?source=post_page-----f660ccb77ff4---------------recursion-----------------", "anchor_text": "Recursion"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----f660ccb77ff4---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff660ccb77ff4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&user=Himanshu+Chandra&userId=88960b2eb891&source=-----f660ccb77ff4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff660ccb77ff4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&user=Himanshu+Chandra&userId=88960b2eb891&source=-----f660ccb77ff4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff660ccb77ff4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff660ccb77ff4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f660ccb77ff4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f660ccb77ff4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshuhc?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@himanshuhc?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Himanshu Chandra"}, {"url": "https://medium.com/@himanshuhc/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "99 Followers"}, {"url": "https://iamjustastudent.com/about", "anchor_text": "https://iamjustastudent.com/about"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F88960b2eb891&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&user=Himanshu+Chandra&userId=88960b2eb891&source=post_page-88960b2eb891--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fc3cc93643227&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fan-intuitive-approach-to-dtw-dynamic-time-warping-f660ccb77ff4&newsletterV3=88960b2eb891&newsletterV3Id=c3cc93643227&user=Himanshu+Chandra&userId=88960b2eb891&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}