{"url": "https://towardsdatascience.com/how-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233", "time": 1682996562.047437, "path": "towardsdatascience.com/how-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233/", "webpage": {"metadata": {"title": "How Machine Learning can help identify Effectiveness and Adverseness of a Drug | by Dipen Chawla | Towards Data Science", "h1": "How Machine Learning can help identify Effectiveness and Adverseness of a Drug", "description": "Building a system for processing text reviews of neurological drugs using NLP and employing ML algorithms to predict if the drug is effective or might cause adverse reactions."}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@gianpaul.r/tokenization-and-parts-of-speech-pos-tagging-in-pythons-nltk-library-2d30f70af13b", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://machinelearningmastery.com/prepare-text-data-machine-learning-scikit-learn/", "anchor_text": "here", "paragraph_index": 22}, {"url": "https://we-care-neuro.herokuapp.com/prediction", "anchor_text": "here", "paragraph_index": 48}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 49}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 49}], "all_paragraphs": ["Have you ever looked up your common cold medicine on the Internet only to be horrified by the number of side-effects listed under it? Or gone through the review section to verify them but got overwhelmed by the sheer number of reviews listed you probably couldn\u2019t read if you had all day? Or wished there was a simple way to know how many people who used it were satisfied with the results?", "Most of us have been there, done that. As humans, we tend to prefer our information to be presented to us in a nutshell, such that we can comprehend it effectively while utilizing minimum time and resources.", "The same is applicable for the above case, where a comprehensive and visually informative system is needed to summarize all the information about the medication in one place, which helps the user in making an informed decision before choosing a particular drug.", "How can ML aid this process?", "The distributed information in the form of blogs or specialized websites for user drug reviews has huge potential for analysis. However, this data is mostly textual, which means that it needs to be structured and cleaned before it can be used for analysis.", "A complete end-to-end system would take this unstructured data into consideration and transform it into useable features, which in turn are used by suitable algorithms to determine whether the drug will be effective or not, given review(s) of the drug.", "Thus, the objectives of the final system would be:", "Let\u2019s break down the development process in the article below.", "For developing a decisive system, a subset of the extensive review data available on the Internet is taken into consideration. The reviews for neurological drugs for the treatment of epilepsy, seizures and bipolar disorders were scraped using scrapy, a Python library for developing custom web crawlers.", "The final dataset consisted of an average of 200 reviews for each of the seven drugs, which was then split into training and test dataset in the ratio of 80:20.", "The stopwords, negation, and punctuation are retained in this step to preserve the information contained in the reviews as best as possible. At the end of this step, the cleaned sentences are ready to be labeled into appropriate categories.", "The sentence can be classified into one of the three categories:", "An auto-labeler was set up which evaluated the sentence on three parameters.", "2. The POS(parts-of-speech) tags of individual words of the sentence, generated using the nltk library. A detailed description of the POS tagging process and tags can be found here.", "3. The compound VADER sentiment score of each sentence. VADER is a python module which is used for scoring the sentiment of a review in terms of polarity(positive or negative) and intensity(score). The compound score is an integer value ranging between -1 and 1 to evaluate the sentiment conveyed in the text. A value of 0 is the center point of the scale signifying neutral sentiment.", "Thus, a preliminary labeling scheme for reviews was developed which was further refined by manual labeling of sentences.", "The reviews misclassified by the auto-labeler were manually labeled by two independent annotators, and the conflicts resolved by an unbiased third annotator. The dataset was then verified by a medical health professional.", "The training set is now ready for input to the classification algorithm.", "The vectorizer is used to convert every word into a vector of size equal to the unique count of words in the entire collection of documents(reviews). This approach is known as the \u2018bag-of-words\u2019 model. This model converts the text into numerical features form required by the machine learning algorithm.", "For example, a review of a certain drug reads \u2018This drug has made me worse\u2019 while another review says \u2018This drug has made me better\u2019. The count of unique words in the reviews is found to be 7 (\u2018this\u2019, \u2018drug\u2019, \u2018has\u2019, \u2018made\u2019, \u2018me\u2019, \u2018worse\u2019, \u2018better\u2019).", "Thus, the vectors for the reviews are", "We can use either the CountVectorizer approach (creation of a sparse matrix of the size of words * reviews) or the Term Frequency-Inverse Document Frequency(TF-IDF) approach (measures the frequency of a word along with the rareness of the word in the collection).", "You can learn more about these two approaches and their implementation here.", "In NLP, each word in the text document is referred to as a \u2018gram\u2019. Thus, a combination of co-occurring words is known as an n-gram, where n is the length of the combination considered.", "For example, \u2018bipolar disorder\u2019 would be an often occurring combination in our corpus of words. Thus, it can be represented with a bi-gram instead of the unigrams for individual words \u2018bipolar\u2019 and \u2018disorder\u2019, as both of these words may not appear as separate words as frequently.", "The bi-grams or tri-grams may be obtained as features independently using Gensim (as above) or by using scikit-learn\u2019s feature extraction module to automatically generate them during vectorization.", "The reviews need to be classified into three categories, that is, effective, ineffective and adverse, therefore we need to use a multi-class classifier instead of a binary classifier.", "For comparative analysis, four multi-class algorithms are used for prediction of categories.", "The code for training and testing the classifiers mentioned above using scikit-learn is given below.", "The performance of the algorithms was tested against a variety of feature selections in a trial-and-error fashion. Thus, various combinations of features were generated by combining vectorization techniques, the number of words considered as features and sentiment scores of the reviews. An example is shown below", "Here, we convert the top 15,000 occurring words and their bi-grams (as ngram_range is set between 1\u20132) to feature vectors using TF-IDF. The vectors of each review are combined with the VADER sentiment scores to obtain the features, which are to be fed to the classification algorithm to decide the class of that review.", "Similarly, 7 other such feature sets are created as below:", "We present the system results in three formats: a review classifier, a summarization of each of the categories using TextRank, and an interactive visual plot of reviews for drug comparison.", "We use the weighted f1 score metric from sklearn\u2019s f1_score metric module for evaluating performance as it has the added advantage of accounting for class imbalance in a multi-class classification problem. It calculates the f1 score for each class and averages them by also considering the support (number of instances as shown above) of each class.", "An f1 score of ~0.74 is obtained using feature selection 8 with logistic regression approach.", "The TextRank algorithm uses the similarity graph of TF-IDF vectors to calculate the importance of each node. The node or review which is most similar to most other reviews is considered \u2018central\u2019 to the class it belongs.", "Here, the reviews for the effective category are ranked for a particular drug. The phrases \u2018best drug\u2019, \u2018helped me lots\u2019, \u2018would not be able to live without it\u2019 best reflect the theme of the effective class, and therefore the reviews containing them are ranked at the top using TextRank.", "Similarly, the adverse category reviews are compared against a dictionary of adverse reactions and an occurrence-ordered graph is generated for the adverse reactions caused by a drug.", "The webapp uses Bokeh, an interactive visualization library in python, to present interactive bar graphs to show a side-by-side comparison of drugs for the user.", "A bokeh server is used to initiate a service which responds to changes on the webapp to trigger callbacks for updating the data for the plot. These changes are synced by the browser of the webapp and the plot is updated accordingly.", "To run the bokeh server, a method is called in the app.py by running the command", "The visualization is rendered at localhost port 5006 which can be integrated into the app.py", "The complete code for interactive visualizing using bokeh is given here.", "The code contains three major functions make_dataset, make_plot and update which are used for creating the dataframes and their values, static plotting, and updating the data based on checkbox state (checked or unchecked) respectively. Finally, the plot and the control elements are placed next to each other using curdoc() and the output is rendered to the web browser.", "I wanted to create a user-focused webapp that helps the patients to know more about the experiences of others who have used similar drugs in the past and save them the trouble of reading hundreds of reviews on online forums.", "In the future, the system can be improved in many ways by providing support for authentication of reviews, considering reviews of other domains, and improving the efficiency by employing neural networks.", "Thanks to my amazing teammates, who put in the efforts to make this idea into a reality.", "Feel free to comment if you have any suggestions. I would love to hear your feedback!", "The webapp is now on Heroku with the predictor here.", "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Architecting applications and writing about them. Engineering @ Episource LLC. Views are personal. Love talking cinema, art and coffee."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe23c7933c233&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e23c7933c233--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e23c7933c233--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@dipenchawla?source=post_page-----e23c7933c233--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dipenchawla?source=post_page-----e23c7933c233--------------------------------", "anchor_text": "Dipen Chawla"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b7b4e59abbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&user=Dipen+Chawla&userId=7b7b4e59abbd&source=post_page-7b7b4e59abbd----e23c7933c233---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe23c7933c233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe23c7933c233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@hikendal?utm_source=medium&utm_medium=referral", "anchor_text": "Kendal James"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/@gianpaul.r/tokenization-and-parts-of-speech-pos-tagging-in-pythons-nltk-library-2d30f70af13b", "anchor_text": "here"}, {"url": "https://machinelearningmastery.com/prepare-text-data-machine-learning-scikit-learn/", "anchor_text": "here"}, {"url": "https://i.stack.imgur.com/zKpJy.jpg", "anchor_text": "here"}, {"url": "https://stats.stackexchange.com/a/318526", "anchor_text": "here"}, {"url": "https://we-care-neuro.herokuapp.com/prediction", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e23c7933c233---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----e23c7933c233---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/healthcare?source=post_page-----e23c7933c233---------------healthcare-----------------", "anchor_text": "Healthcare"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----e23c7933c233---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/in-depth-analysis?source=post_page-----e23c7933c233---------------in_depth_analysis-----------------", "anchor_text": "In Depth Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe23c7933c233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&user=Dipen+Chawla&userId=7b7b4e59abbd&source=-----e23c7933c233---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe23c7933c233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&user=Dipen+Chawla&userId=7b7b4e59abbd&source=-----e23c7933c233---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe23c7933c233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e23c7933c233--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe23c7933c233&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e23c7933c233---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e23c7933c233--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e23c7933c233--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e23c7933c233--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e23c7933c233--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e23c7933c233--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e23c7933c233--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e23c7933c233--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e23c7933c233--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dipenchawla?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@dipenchawla?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dipen Chawla"}, {"url": "https://medium.com/@dipenchawla/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "37 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b7b4e59abbd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&user=Dipen+Chawla&userId=7b7b4e59abbd&source=post_page-7b7b4e59abbd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F7b7b4e59abbd%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-machine-learning-can-help-identify-effectiveness-and-adverseness-of-a-drug-e23c7933c233&user=Dipen+Chawla&userId=7b7b4e59abbd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}