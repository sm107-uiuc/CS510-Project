{"url": "https://towardsdatascience.com/using-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e", "time": 1683017768.9326458, "path": "towardsdatascience.com/using-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e/", "webpage": {"metadata": {"title": "Using GraphSAGE embeddings for downstream classification model | by Tomaz Bratanic | Towards Data Science", "h1": "Using GraphSAGE embeddings for downstream classification model", "description": "The use of knowledge graphs and graph analytics pipeline is getting more and more popular. If you keep an eye on the graph analytics field, you already know that graph neural networks are trending\u2026"}, "outgoing_paragraph_urls": [{"url": "http://snap.stanford.edu/graphsage/", "anchor_text": "original GraphSAGE article", "paragraph_index": 1}, {"url": "https://neo4j.com/download-v2/", "anchor_text": "Neo4j Desktop", "paragraph_index": 4}, {"url": "https://drive.google.com/file/d/10_YVI5E7xrSZLawnh_oaaTZVZtueud5C/view?usp=sharing", "anchor_text": "database dump file", "paragraph_index": 4}, {"url": "https://tbgraph.wordpress.com/2020/11/11/dump-and-load-a-database-in-neo4j-desktop/", "anchor_text": "blog post", "paragraph_index": 4}, {"url": "https://neo4j.com/developer/neo4j-apoc/", "anchor_text": "APOC", "paragraph_index": 4}, {"url": "https://neo4j.com/product/graph-data-science-library/", "anchor_text": "Graph Data Science libraries", "paragraph_index": 4}, {"url": "https://github.com/williamleif/GraphSAGE", "anchor_text": "official GraphSAGE repository", "paragraph_index": 7}, {"url": "https://scikit-learn.org/stable/modules/sgd.html", "anchor_text": "Stochastic Gradient Descent", "paragraph_index": 7}, {"url": "https://towardsdatascience.com/an-intuitive-explanation-of-graphsage-6df9437ee64f", "anchor_text": "An Intuitive Explanation of GraphSAGE", "paragraph_index": 10}, {"url": "http://snap.stanford.edu/graphsage/", "anchor_text": "official GraphSAGE site", "paragraph_index": 10}, {"url": "https://tbgraph.wordpress.com/2020/03/09/exploring-the-graph-catalog-feature-of-neo4j-graph-data-science-plugin-on-a-lord-of-the-rings-dataset/", "anchor_text": "native projection", "paragraph_index": 12}, {"url": "https://tbgraph.wordpress.com/2020/03/17/how-to-use-cypher-projection-in-neo4j-graph-data-science-library-on-a-lord-of-the-rings-social-network/", "anchor_text": "cypher projection", "paragraph_index": 12}, {"url": "https://neo4j.com/docs/graph-data-science/current/algorithms/graph-sage/index.html", "anchor_text": "documentation", "paragraph_index": 14}, {"url": "https://neo4j.com/docs/graph-data-science/current/model-catalog/model-catalog/", "anchor_text": "model catalog", "paragraph_index": 15}, {"url": "https://github.com/tomasonjo/blogs/blob/master/protein_graphsage/Protein%20analysis.ipynb", "anchor_text": "GitHub", "paragraph_index": 18}, {"url": "http://snap.stanford.edu/graphsage/", "anchor_text": "Hamilton, Will, Zhitao Ying, and Jure Leskovec. \u201cInductive representation learning on large graphs.\u201d Advances in Neural Information Processing Systems. 2017.", "paragraph_index": 19}, {"url": "http://mng.bz/GGVN", "anchor_text": "http://mng.bz/GGVN", "paragraph_index": 21}], "all_paragraphs": ["The use of knowledge graphs and graph analytics pipeline is getting more and more popular. If you keep an eye on the graph analytics field, you already know that graph neural networks are trending. Unfortunately, there aren\u2019t many tutorials out there on how to use them in a practical application. For this reason, I have decided to write this blog post, where you will learn how to train a convolutional graph neural network and integrate it into your machine learning workflow to improve downstream classification model accuracy.", "In this example, you will reproduce the protein role classification task from the original GraphSAGE article. The task is to classify protein roles in terms of their cellular function across various protein-protein interaction graphs (PPI). The dataset contains 22 PPI graphs, with each graph corresponding to a different human tissue. The average PPI graph contains 2373 nodes, with an average degree of 28.8. There are available predefined positional gene sets, motif gene sets, and immunological signatures for each protein in the network. Based on those features and their connections, you will predict the roles of proteins in the network. You will train both the classification and GraphSAGE model on 20 graphs and then average prediction F1 scores on two test graphs.", "As mentioned, we are dealing with a protein-protein interaction network. This is a monopartite network, where nodes represent proteins and relationships represent their interactions.", "Additionally, the protein nodes have the predefined features stored as a property. The embeddings_all property contains all 50 features stored as a list of floats. I have also prepared the decoupled properties, where the embedding_x property holds a single feature and x ranges from 0 to 49. You will see later in the blog post why the decoupled properties are required. The protein nodes also contain a secondary label that could be either Train or Test. With the help of the secondary label, you can easily perform the train-test data split.", "To set up the Neo4j environment, you will first need to download and install the Neo4j Desktop application. You don\u2019t need to create a database instance just yet. To avoid bugging you with the import process, I have prepared a database dump file, which you can go ahead and load a database instance from it. In this example, I used the Neo4j 4.2.0 version. If you aren\u2019t familiar with how to load a Neo4j database instance from a dump file, you can take a look at my blog post for more detailed instructions. Next, you will need to install both the APOC and the Graph Data Science libraries. Using the Neo4j Desktop application, you can install both libraries with a single click as shown below.", "Now that you have loaded the database instance and installed both libraries, you can go ahead and start the database. Run the following query in the Neo4j Browser interface to make sure the graph is loaded correctly.", "You should see a similar visualization in your Neo4j Browser. The green nodes represent the proteins and the relationships represent the interactions between the proteins. You can also notice that a protein can interact with itself. That is represented with self-loops, where the relationship starts and points to the same node.", "To get a baseline f1 score, you will first train the classification model using only the predefined features available for proteins. The code is identical to the code found in the official GraphSAGE repository, where they used the Stochastic Gradient Descent classifier model to train and predict protein roles. The only difference is that here you will be fetching the data from a Neo4j database instance.", "The baseline f1 score, where you used only the predefined features of proteins, is 0.422. Let\u2019s now try to improve the classification model accuracy using the GraphSAGE algorithm", "GraphSAGE is a convolutional graph neural network algorithm. The key idea behind the algorithm is that we learn a function that generates node embeddings by sampling and aggregating feature information from a node\u2019s local neighborhood. As the GraphSAGE algorithm learns a function that can induce the embedding of a node, it can also be used to induce embeddings of a new node that wasn\u2019t observed during the training phase. This is called inductive learning.", "If you want to learn more about the training process and the math behind the GraphSAGE algorithm, I suggest you take a look at the An Intuitive Explanation of GraphSAGE blog post by R\u0131za \u00d6z\u00e7elik or the official GraphSAGE site.", "Neo4j Graph Data Science library operates entirely on heap memory to enable fast caching for the graph\u2019s topology, containing only relevant nodes, relationships, and weights. Graph algorithms are executed on an in-memory projected graph model, which is separate from Neo4j\u2019s stored graph model.", "Before you can execute any graph algorithms, you have to project the in-memory graph via the Graph Loader component. You can use either native projection or cypher projection to load the in-memory graph.", "In this example, you will use the native projection feature to load the in-memory graph. To start, you will project the training data and store it as a named graph in the Graph Catalog. The current implementation of the GraphSAGE algorithm supports only node features that are of type Float. For this reason, you will include the decoupled node properties ranging from embedding_0 to embedding_49 in the graph projection instead of a single property embeddings_all, which holds all the node features in the form of a list of Floats. Additionally, you will treat the projected graph as undirected.", "Next, you will train the GraphSAGE model. The model\u2019s hyper-parameter settings were mostly copied from the original paper. I have noticed that the lower learning-rate setting had the most impact on the downstream classification accuracy. Another import hyper-parameter is the samplingSizes parameter, where the size of the list determines the number of layers (defined as K parameter in the paper), and the values determine how many nodes will be sampled by the layers. Find more information about the available hyper-parameters in the documentation.", "The training process took around 20 minutes on my laptop. After the training process finishes, the GraphSAGE model will be stored in the model catalog. You can now use this model to induce node embeddings on any projected graph with the same node properties used during the training. Before testing the downstream classification accuracy, you have to load the test data as an in-memory graph in the Graph Catalog.", "With the GraphSAGE model trained and both the training and test data projected as an in-memory graph, you can go ahead and calculate the f1 score using the GraphSAGE embeddings in a downstream classification model. Remember, the GraphSAGE model has not observed the test data during the training phase.", "Using the GraphSAGE embeddings as feature input to the classification model, you have improved the f1 score to 0.462. You can also try to follow the other examples in the original GraphSAGE paper to hone your graph data science skills.", "As always, the code is available on GitHub.", "[1] Hamilton, Will, Zhitao Ying, and Jure Leskovec. \u201cInductive representation learning on large graphs.\u201d Advances in Neural Information Processing Systems. 2017.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data explorer. Turn everything into a graph. Author of Graph algorithms for Data Science at Manning publication. http://mng.bz/GGVN"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4492e01ae54e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bratanic-tomaz.medium.com/?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": ""}, {"url": "https://bratanic-tomaz.medium.com/?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": "Tomaz Bratanic"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57f13c0ea39a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&user=Tomaz+Bratanic&userId=57f13c0ea39a&source=post_page-57f13c0ea39a----4492e01ae54e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4492e01ae54e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4492e01ae54e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://snap.stanford.edu/graphsage/", "anchor_text": "original GraphSAGE article"}, {"url": "http://www.apcjones.com/arrows/", "anchor_text": "http://www.apcjones.com/arrows/"}, {"url": "https://neo4j.com/download-v2/", "anchor_text": "Neo4j Desktop"}, {"url": "https://drive.google.com/file/d/10_YVI5E7xrSZLawnh_oaaTZVZtueud5C/view?usp=sharing", "anchor_text": "database dump file"}, {"url": "https://tbgraph.wordpress.com/2020/11/11/dump-and-load-a-database-in-neo4j-desktop/", "anchor_text": "blog post"}, {"url": "https://neo4j.com/developer/neo4j-apoc/", "anchor_text": "APOC"}, {"url": "https://neo4j.com/product/graph-data-science-library/", "anchor_text": "Graph Data Science libraries"}, {"url": "https://github.com/williamleif/GraphSAGE", "anchor_text": "official GraphSAGE repository"}, {"url": "https://scikit-learn.org/stable/modules/sgd.html", "anchor_text": "Stochastic Gradient Descent"}, {"url": "https://towardsdatascience.com/an-intuitive-explanation-of-graphsage-6df9437ee64f", "anchor_text": "An Intuitive Explanation of GraphSAGE"}, {"url": "http://snap.stanford.edu/graphsage/", "anchor_text": "official GraphSAGE site"}, {"url": "https://neo4j.com/docs/graph-data-science/current/common-usage/", "anchor_text": "Neo4j GDS library documentation"}, {"url": "https://tbgraph.wordpress.com/2020/03/09/exploring-the-graph-catalog-feature-of-neo4j-graph-data-science-plugin-on-a-lord-of-the-rings-dataset/", "anchor_text": "native projection"}, {"url": "https://tbgraph.wordpress.com/2020/03/17/how-to-use-cypher-projection-in-neo4j-graph-data-science-library-on-a-lord-of-the-rings-social-network/", "anchor_text": "cypher projection"}, {"url": "https://neo4j.com/docs/graph-data-science/current/algorithms/graph-sage/index.html", "anchor_text": "documentation"}, {"url": "https://neo4j.com/docs/graph-data-science/current/model-catalog/model-catalog/", "anchor_text": "model catalog"}, {"url": "https://github.com/tomasonjo/blogs/blob/master/protein_graphsage/Protein%20analysis.ipynb", "anchor_text": "GitHub"}, {"url": "http://snap.stanford.edu/graphsage/", "anchor_text": "Hamilton, Will, Zhitao Ying, and Jure Leskovec. \u201cInductive representation learning on large graphs.\u201d Advances in Neural Information Processing Systems. 2017."}, {"url": "https://medium.com/tag/neo4j?source=post_page-----4492e01ae54e---------------neo4j-----------------", "anchor_text": "Neo4j"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4492e01ae54e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/graph-neural-networks?source=post_page-----4492e01ae54e---------------graph_neural_networks-----------------", "anchor_text": "Graph Neural Networks"}, {"url": "https://medium.com/tag/classification?source=post_page-----4492e01ae54e---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/graph?source=post_page-----4492e01ae54e---------------graph-----------------", "anchor_text": "Graph"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4492e01ae54e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&user=Tomaz+Bratanic&userId=57f13c0ea39a&source=-----4492e01ae54e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4492e01ae54e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&user=Tomaz+Bratanic&userId=57f13c0ea39a&source=-----4492e01ae54e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4492e01ae54e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4492e01ae54e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4492e01ae54e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4492e01ae54e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4492e01ae54e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4492e01ae54e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4492e01ae54e--------------------------------", "anchor_text": ""}, {"url": "https://bratanic-tomaz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bratanic-tomaz.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tomaz Bratanic"}, {"url": "https://bratanic-tomaz.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.1K Followers"}, {"url": "http://mng.bz/GGVN", "anchor_text": "http://mng.bz/GGVN"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F57f13c0ea39a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&user=Tomaz+Bratanic&userId=57f13c0ea39a&source=post_page-57f13c0ea39a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feab586d298c8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-graphsage-embeddings-for-downstream-classification-model-4492e01ae54e&newsletterV3=57f13c0ea39a&newsletterV3Id=eab586d298c8&user=Tomaz+Bratanic&userId=57f13c0ea39a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}