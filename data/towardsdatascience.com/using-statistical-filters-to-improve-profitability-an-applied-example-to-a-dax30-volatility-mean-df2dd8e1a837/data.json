{"url": "https://towardsdatascience.com/using-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837", "time": 1682996720.618443, "path": "towardsdatascience.com/using-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837/", "webpage": {"metadata": {"title": "Using statistical filters to improve profitability | by Mario Emmanuel | Towards Data Science", "h1": "Using statistical filters to improve profitability", "description": "Finding profitable strategies with reasonable drawdown is not an easy endeavour so any resource that improves profitability and mitigates drawdown is worth to be explored. In this article, I am going\u2026"}, "outgoing_paragraph_urls": [{"url": "https://ieee.shortcm.li/OP8dFS", "anchor_text": "https://ieee.shortcm.li/OP8dFS", "paragraph_index": 50}], "all_paragraphs": ["Finding profitable strategies with reasonable drawdown is not an easy endeavour so any resource that improves profitability and mitigates drawdown is worth to be explored.", "In this article, I am going to talk about strategy optimization through the usage of Statistical filters.", "Statistical filters \u2014 together with parametric Monte Carlo analysis \u2014 are the simplest way to optimize a trading strategy.", "Statistics are easier to apply and can be used to either alter sizing or filter out/in some operations. This approach requires only the result dataset from the backtesting although a final check through an automated backtesting engine is recommended.", "It is worth to mention that this process does not address exclusively profitability and/or equity curve, but it might have also the positive side effect of reducing the number of executed trades, which effectively eliminates some fees and mitigates the psychological stress of the operator\u2014 in case the strategy is designed to be executed discretionarily \u2014 .", "In this example, a discretionary strategy is being analysed. The strategy is designed around a risk-controlled and contextualized mean reversion/volatility setup for DAX30\u00ae instruments (futures or CFDs).", "Any strategy and any instrument/asset can be analysed in a similar way, as filters can be applied to any setup.", "Designing filters is more an art than a science and involves a large degree of data observation. Data observation involves both reading the actual data and chart and creating auxiliary charts to identify and isolate factors that might have an impact on profitability or equity curve.", "The data must be interpreted taking into consideration what every parameter or setup means in terms of market context. This implies taking an active role while reading data, as initial hypotheses need to be established to be later confirmed \u2014 or refuted \u2014 by further statistical analysis.", "Optimization does not necessarily deal with profitability. There might be optimization goals to smooth the equity curve. A friendly equity curve is much easier to scale through financial leverage or credit, while the severe drawdowns of a choppy equity curve can easily put our capital at severe risk.", "The analysis begins with the data coming from a manual backtest of the strategy \u2014 the same would apply for automated trading \u2014 . This data is incorporated into the analysis as a CSV file.", "This article deals exclusively with the Statistical analysis of the backtest results. Despite a few commands will be included to show how key columns are added, I assume that anyone interested in applying these concepts knows how to code statistical analysis.", "Backtesting can lead you to rediscover your strategy and will often reveal hidden behaviours and biases in the strategy that are not part of the original definition.", "It is extremely important to visually examine the equity curve against the underlying asset/instrument to determine if there are potential correlations between specific market conditions and equity curve behaviour. A large number of items can be checked: underlying trend, trend strength/slope, overbuy and oversell conditions, volatility, volume, higher timeframes market conditions, etc. \u2014 just to mention a few ones \u2014 .", "Some items can be quantified (volatility can be quantified by ATR), but others can not (trend, trend strength or market regime might be subjective). For those that can not be quantified an operator comment or code can be incorporated manually to the dataset.", "The first action to data is to incorporate the cumulative Equity column from the strategy. Assuming that your data is already incorporated into a Pandas dataframe called data, the following command will add a new column that provides the equity curve.", "Although the Profit column is expected to be the profit/loss in euros, the backtest has been adjusted so 1\u20ac matches one point, so this column actually represents profit in instrument points per trade. Actual profit can be easily obtained by defining the number of future contracts being operated \u2014 or lot size if the strategy is being operated using CFD instruments \u2014 .", "The equity curve of the strategy is shown in Figure 2. The x-axis represents the executed trades and the y-axis show the cumulative profit in points. This curve is good to visually understand the mechanics of the strategy, including the number of consecutive losses and wins and the relative win/loss in points for each trade. The representation is related to the equity curve in time but it does not match as trades are not distributed linearly across time.", "Both charts are meaningful, the first one focus on the sequence of trades and the second one gives an idea on the equity development over time.", "From the charts, it can be noticed that during the first half of the year the execution of the strategy has been profitable. The market has fallen around 2000 points and the strategy has been able to capture 1250 points from that movement. During the next quarter the strategy has been able to incorporate an additional 500/600 profit points.", "The second half of the year has been on the contrary not profitable at all. It has accumulated an aggressive 500/600 points fall. Analysing the chart and the entry setups of the largest trades we infer that trades that try to capture larger movements might be losing ones. From the backtesting execution, I also had the subjective feeling that lasting trades tend to be losers, while best trades reach profit targets quickly. This is actually in line with the underlying principles used in the strategy: volatility and mean reversion.", "Subjective feelings cannot redefine a strategy, but they constitute legitim leads for further analysis as they are part of the operator\u2019s market know-how (which is often heuristic).", "As discussed, one question that arises is if trade duration is correlated to the win/loss probability of the trade. A simple way to analyse this is to use a scatter plot that draws trade size in the y-axis and trade duration in the x-axis. In this example, I have plotted the winning trades in blue and the losing trades in red. The extra columns are easily incorporated:", "The definition of trade size is a bit arbitrary, and it would be equally valid to take the stop loss or take profit points.", "Classifying win and loss trades is easy, you just need to generate a new filtered Pandas data frame for each chart series.", "It can be clearly seen that most trades are concentrated in an area of 400 points / 5000 minutes approximately. Outside this range, there are just 13 observations.", "I will start with the outliers as they are easier to analyse. Filtering them out will help to focus on the area where trades are concentrated.", "I mentioned before that we were concerned by subjective feelings pointing to:", "From the chart, I notice that larger size trades have been profitable in this specific case. Only six trades were aimed for a trade size larger than 400, and out of those six trades, two were lost. It is worth to mention, however, that six observations are probably a too small sample size to get Statistically relevant results.", "Regarding the second hypothesis, out of the total trades with a larger duration than 5000 minutes, 7 were losing trades and 3 were winning trades. Again, 10 trades might not be enough sample to extract information though, so it would be safer if the strategy can be redefined to avoid those trades.", "Even with this simple analysis, a first filter could be selected as a hypothesis. I will analyse what happens in the area where there is more density. Indeed, we will choose closing trades that last more than 180 minutes \u2014 the value has been selected after some iterations \u2014 . In the case of CFDs, it will also eliminate swap fees.", "In futures, it might avoid having to roll over contracts if trade lasts more than the settlement period. We could also evaluate other filters such as imposing a 100 points restriction on the trade stop loss. This shall help to increase leverage with confidence as we are not taking trades with larger stop losses.", "Lack of observations for large size trades and longer trade durations could lead to noisy results as the number of observations in those areas is small and hence prone to more variability.", "I will incorporate initially the trade timeout filter. The analysis is not accurate as I do not have information on what happens when the trades are closed by time. They might lead to a partial profit or loss. I will assume at first that wins and losses are compensated. The idea of reducing trade duration is appealing. Intuitively it might generate smoother equity curves, reduce fees (especially swap fees in CFDs) and simplify operations.", "These results can be later be validated with a new backtest, ideally ran over a fresh set of data \u2014i.e. a different year to avoid overfitting\u2014.", "Figures 6 and 7 show two subsets of conditions that further limit the universe for trades lasting less than 5000 minutes and 180 minutes respectively. In both cases, but specially in the second one it can be seen that blue dominates over red.", "This statement can be proved by plotting the 180 minutes time-limit equity curve.", "In this equity curve, I am assuming that losing and winning trades are compensating among themselves when you close them after 180 minutes. This might be true or not, but for sure they might have an impact on drawdown.", "The key message of this simplified approach is that the equity seems to improve when this path is followed. Therefore it is worth to spend time on further backtesting this scenario.", "Now that it seems that closing prematurely trades after 180 minutes could lead to an improved equity curve we analyse what actually happens. In order to do that, a custom backtest engine is programmed (it is actually just a few lines of code in Python) to enter the trades when they were actually traded and backtest the results for SL, TP or time-out.", "This new backtest gives a more realistic but still improved result, as shown in Figure 9.", "While the curve is not as good as the theoretical one, a significant improvement has been achieved. In the original strategy, the maximum drawdown was a large 750 points drawdown that lasted for 30/40 trades.", "By applying this simple filter we reduce the drawdown to 300 points, a 60% reduction. The filter provides a similar profit level than the original strategy.", "A limited drawdown, which effectively delivers a smoother equity curve is the most important aspect of a strategy. Even when smaller profitabilities are reached. Profits can be easily scaled up through financial leverage or credit with a safer equity curve.", "Figure 10 shows a comparison between both strategies (without and with filter). Although the Sharpe ratio\u00b9 shall be calculated for both strategies to quantify which one is better, in this case, it is clear that the filter improves the strategy.", "The Sharpe ratio relates the risk (standard deviation) versus the profitability and it can be used as a figure of merit of a given strategy or fund manager. While I will not cover the Sharpe ratio in this article it is worth to mention as it would apply to properly quantify both strategies and compare against others.", "In this article, the concept of using simple Statistical filters to improve profitability and/or drawdown has been presented. The whole logical process includes analysing the data, plotting the equity curve, making some initial hypotheses and iteratively testing that data.", "The relevance of drawdown and equity curve has been highlighted and a final comparison of the achieved results has been provided.", "While the example is really simple and lacks exploring further filters or a more mathematical approach to optimize results, it achieves the objective of illustrating the usage of Statistical filters in an easy to follow way. It also shows how sometimes simple data observation and a limited set of plots and iterations can improve a strategy without complex maths.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Consultant, retail trader & lifelong learner | Linkedin https://ieee.shortcm.li/OP8dFS"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf2dd8e1a837&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@m.emmanuel?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.emmanuel?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": "Mario Emmanuel"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7728df51142e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&user=Mario+Emmanuel&userId=7728df51142e&source=post_page-7728df51142e----df2dd8e1a837---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf2dd8e1a837&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf2dd8e1a837&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.investopedia.com/terms/s/sharperatio.asp", "anchor_text": "https://www.investopedia.com/terms/s/sharperatio.asp"}, {"url": "https://medium.com/tag/trading?source=post_page-----df2dd8e1a837---------------trading-----------------", "anchor_text": "Trading"}, {"url": "https://medium.com/tag/statistics?source=post_page-----df2dd8e1a837---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/data-science?source=post_page-----df2dd8e1a837---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/finance?source=post_page-----df2dd8e1a837---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/stock-market?source=post_page-----df2dd8e1a837---------------stock_market-----------------", "anchor_text": "Stock Market"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf2dd8e1a837&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&user=Mario+Emmanuel&userId=7728df51142e&source=-----df2dd8e1a837---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fdf2dd8e1a837&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&user=Mario+Emmanuel&userId=7728df51142e&source=-----df2dd8e1a837---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdf2dd8e1a837&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fdf2dd8e1a837&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----df2dd8e1a837---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----df2dd8e1a837--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.emmanuel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.emmanuel?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mario Emmanuel"}, {"url": "https://medium.com/@m.emmanuel/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "977 Followers"}, {"url": "https://ieee.shortcm.li/OP8dFS", "anchor_text": "https://ieee.shortcm.li/OP8dFS"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7728df51142e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&user=Mario+Emmanuel&userId=7728df51142e&source=post_page-7728df51142e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffd67658cd0f9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fusing-statistical-filters-to-improve-profitability-an-applied-example-to-a-dax30-volatility-mean-df2dd8e1a837&newsletterV3=7728df51142e&newsletterV3Id=fd67658cd0f9&user=Mario+Emmanuel&userId=7728df51142e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}