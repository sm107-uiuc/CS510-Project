{"url": "https://towardsdatascience.com/the-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4", "time": 1682995124.398317, "path": "towardsdatascience.com/the-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4/", "webpage": {"metadata": {"title": "The force is strong in you if you abstract your R code | by Keith McNulty | Towards Data Science", "h1": "The force is strong in you if you abstract your R code", "description": "Any decent mathematician or computer programmer will tell you that if a task is being repeated again and again, it should be made into a function. This has always been true, and if you are still\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/keith-mcnulty/", "anchor_text": "LinkedIn", "paragraph_index": 17}, {"url": "https://twitter.com/dr_keithmcnulty", "anchor_text": "Twitter", "paragraph_index": 17}, {"url": "http://keithmcnulty.org", "anchor_text": "keithmcnulty.org", "paragraph_index": 20}], "all_paragraphs": ["Any decent mathematician or computer programmer will tell you that if a task is being repeated again and again, it should be made into a function.", "This has always been true, and if you are still coding repeated tasks again and again while just changing a variable or two \u2014 if you are just copy/pasting code for example \u2014 then you need to stop right now and learn how to write functions.", "But recent developments mean that there are more and more incentives to always consider what parts of your code can be abstracted. Developments in R packages to get around non-standard evaluation challenges and to enhance abstraction power through quosures and related expressions means that amazing powers are within our reach.", "Let\u2019s start simply. A function is useful to create if you are doing identical analysis but just changing variable values. Let\u2019s work with the starwars dataset in dplyr. If we wanted a list of all human characters we might use this:", "This will return the names of 35 characters. Now if we want a the same list but for several other species, we could just copy and paste and change the value for species. Or we would write this function for future use:", "Now if we run species_search(\"Droid\") we get a list of four characters and are reassured to see our buddy R2-D2 in there.", "We can of course extend this to make it a function with more than one variable to help us search based on various conditions.", "The problem above is that this function has limited flexibility. It is defined in a way that you have no control over which variable you want to filter on.", "What if we wanted to redefine this function so that it will return a list based on any arbitrary condition that we set. Here we can now set two arguments to the function, one to represent the column on which to filter, and another the value to filter against. We can use the enquo function in rlang to capture the column name for use in dplyr::filter(). Like this:", "Now if we evaluate starwars_search(skin_color, \"gold\") we are reassured to see our anxious but loveable friend C-3PO returned.", "So even with our step above we have made our search functionality more abstract and powerful, but it\u2019s still somewhat limited. For example, it only deals with one filter and will only find characters that match that single value.", "Lets imagine that we have a set of filters in the form a of a list. We can use the map2 function in purrr to take that list and break it into a series of quosure expressions that can be passed as individual statements into dplyr::filter, using a new function that acts on a dataframe:", "Now this allows us to further abstract our starwars_search function to receive an arbitrary set of filter conditions in a list, and those conditions can be set to either match a single value of a set of values expressed in a vector:", "Now we can, for example, look for all characters who have blue or brown eyes, are human and hail from Tatooine or Alderaan, using starwars_search(list(eye_color = c(\"blue\", \u201cbrown\"), species = \u201cHuman\", homeworld = c(\"Tatooine\", \u201cAlderaan\"))) which will return the following:", "Now you are ready to unleash the full power of the force, by developing functions that abstract multiple elements of your dplyr code. For example, here\u2019s a function that allows you to find any grouped averages you wish of certain Star Wars characters:", "So if you wanted to find the average height of all humans according to their home worlds, this can be accomplished using starwars_average(height, homeworld, list(species = \"Human\")) which will return this table:", "Although this has been a somewhat trivial example, I hope this helps you better grasp the potential that is available in R functions nowadays. As you look at your day to day work, you may find that there are opportunities to abstract out some of your most common manipulations into functions which could save you a lot of time and effort. Really, what I have demonstrated here is only the tip of the iceberg in terms of what is possible.", "Originally I was a Pure Mathematician, then I became a Psychometrician and a Data Scientist. I am passionate about applying the rigor of all those disciplines to complex people questions. I\u2019m also a coding geek and a massive fan of Japanese RPGs. Find me on LinkedIn or on Twitter.", "Many thanks to Sai Im on my team for inspiring some of the ideas here with his functional programming wizardry.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Expert and Author in Applied Mathematics, Data Science, Statistics. Also writes History, Science, Culture. Find me on Twitter or keithmcnulty.org"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F134ea0869c4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----134ea0869c4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----134ea0869c4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://keith-mcnulty.medium.com/?source=post_page-----134ea0869c4--------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=post_page-----134ea0869c4--------------------------------", "anchor_text": "Keith McNulty"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa859aab532a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&user=Keith+McNulty&userId=a859aab532a0&source=post_page-a859aab532a0----134ea0869c4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F134ea0869c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F134ea0869c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.linkedin.com/in/keith-mcnulty/", "anchor_text": "LinkedIn"}, {"url": "https://twitter.com/dr_keithmcnulty", "anchor_text": "Twitter"}, {"url": "https://medium.com/tag/data-science?source=post_page-----134ea0869c4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----134ea0869c4---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/analytics?source=post_page-----134ea0869c4---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/data?source=post_page-----134ea0869c4---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/statistics?source=post_page-----134ea0869c4---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F134ea0869c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&user=Keith+McNulty&userId=a859aab532a0&source=-----134ea0869c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F134ea0869c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&user=Keith+McNulty&userId=a859aab532a0&source=-----134ea0869c4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F134ea0869c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----134ea0869c4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F134ea0869c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----134ea0869c4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----134ea0869c4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----134ea0869c4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----134ea0869c4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----134ea0869c4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----134ea0869c4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----134ea0869c4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----134ea0869c4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----134ea0869c4--------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://keith-mcnulty.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Keith McNulty"}, {"url": "https://keith-mcnulty.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "11K Followers"}, {"url": "http://keithmcnulty.org", "anchor_text": "keithmcnulty.org"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa859aab532a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&user=Keith+McNulty&userId=a859aab532a0&source=post_page-a859aab532a0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7991b3dbcee9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-force-is-strong-in-you-if-you-abstract-your-r-code-134ea0869c4&newsletterV3=a859aab532a0&newsletterV3Id=7991b3dbcee9&user=Keith+McNulty&userId=a859aab532a0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://peopleanalytics-regression-book.org/", "anchor_text": "Handbook of Regression Modeling in People Analytics2021"}, {"url": "https://ona-book.org", "anchor_text": "Handbook of Graphs and Networks in People Analytics2022"}, {"url": "https://medium.com/@keith-mcnulty/books?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "See all (2)"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}