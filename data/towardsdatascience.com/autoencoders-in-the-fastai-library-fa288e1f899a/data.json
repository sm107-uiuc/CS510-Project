{"url": "https://towardsdatascience.com/autoencoders-in-the-fastai-library-fa288e1f899a", "time": 1683007645.576501, "path": "towardsdatascience.com/autoencoders-in-the-fastai-library-fa288e1f899a/", "webpage": {"metadata": {"title": "Implementing Autoencoders in the Fastai Library | Towards Data Science", "h1": "Implementing Autoencoders in the Fastai Library", "description": "This post is going to cover how to set up an autoencoder in fastai. This will go through creating a basic autoencoder model, setting up the data in fastai, and finally putting all this together into a learner model."}, "outgoing_paragraph_urls": [{"url": "https://docs.fast.ai/index.html", "anchor_text": "fastai", "paragraph_index": 0}, {"url": "https://github.com/henriwoodcock/blog-post-codes/blob/master/autoencoders-in-fastai/autoencoders-in-fastai.ipynb", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/jellycsc/PyTorch-CIFAR-10-autoencoder/blob/master/main.py", "anchor_text": "here", "paragraph_index": 11}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR10", "paragraph_index": 17}, {"url": "https://github.com/henriwoodcock/blog-post-codes/blob/master/autoencoders-in-fastai/autoencoders-in-fastai.ipynb", "anchor_text": "here", "paragraph_index": 18}, {"url": "http://henriwoodcock.github.io", "anchor_text": "henriwoodcock.github.io", "paragraph_index": 21}], "all_paragraphs": ["fastai is a deep learning library that simplifies training neural networks using modern best practices [1]. While fastai provides users with a high-level neural network API, it is designed to allow researchers and users to easily mix in low-level methods while still making the overall training process as easy and accessible to all.", "This post is going to cover how to set up an autoencoder in fastai. This will go through creating a basic autoencoder model, setting up the data in fastai, and finally putting all this together into a learner model.", "Note: a basic understanding of fastai and PyTorch is assumed.", "An autoencoder is a neural network that learns to recreate the input through some type of bottleneck in the architecture. To set this up we need a fastai databunch in which the input and output are equal.", "Here I will give an example to do this with image data, however, there is a more general example to work with any array available on the corresponding notebook available here.", "The code for importing a dataset is below:", "The two differences between this and setting up a databunch for a classifier are:", "ImageImageList is a built-in fastai list that sets both the input and output data to be an Image. Using this means we can still use in-built fastai functions like show_batch.", "The second difference is how the labels are set:", "This allows the user to set the labels from a defined function. Here we use a function that outputs the input.", "Now with all this together, we can run:", "We now need to create an autoencoder model. This is done by creating a PyTorch module. Below is a basic example taken from here.", "Now we put all this together into a fastai learner. To do this you need to define a loss function, I will be using MSE loss for this example.", "To implement this we first create an instance of our autoencoder as follows:", "Then we put this into a fastai Learner:", "Now we have done this we can easily utilise all the best training practices incorporated in fastai such as lr_find and fit_one_cycle.", "All the techniques implemented in fastai can now be used on your custom autoencoder.", "Using the fastai library I trained 10 epochs on a subset of the CIFAR10 using lr_find to find an optimal learning rate and fit_one_cycle and achieved the following results:", "Here I have presented a simple overview of how to implement an autoencoder in fastai, you can find the notebook here which includes all the code as well as how to implement this for a general array dataset. There is also information on how to use the encoder and decoder part once the autoencoder has been trained.", "The autoencoder model I presented here was a very simple one and there are many improvements which can be made a few to mention are feature loss, upsampling instead of transposed convolutions and finally pixel shuffle. I have found these to prove very effective in some of my own work.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "UK Based Data Scientist \\\\ Personal website: henriwoodcock.github.io \\\\ The opinions expressed are my own views and not my employer. \\\\ @henriwoodcock"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffa288e1f899a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://henriwoodcock.medium.com/?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": ""}, {"url": "https://henriwoodcock.medium.com/?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": "Henri Woodcock"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe9ee1187182a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&user=Henri+Woodcock&userId=e9ee1187182a&source=post_page-e9ee1187182a----fa288e1f899a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa288e1f899a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa288e1f899a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://alexlenail.me/NN-SVG/LeNet.html", "anchor_text": "NN-SVG"}, {"url": "https://docs.fast.ai/index.html", "anchor_text": "fastai"}, {"url": "https://github.com/henriwoodcock/blog-post-codes/blob/master/autoencoders-in-fastai/autoencoders-in-fastai.ipynb", "anchor_text": "here"}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR10 Dataset"}, {"url": "https://github.com/jellycsc/PyTorch-CIFAR-10-autoencoder/blob/master/main.py", "anchor_text": "here"}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR10"}, {"url": "https://github.com/henriwoodcock/blog-post-codes/blob/master/autoencoders-in-fastai/autoencoders-in-fastai.ipynb", "anchor_text": "here"}, {"url": "https://arxiv.org/abs/2002.04688", "anchor_text": "https://arxiv.org/abs/2002.04688"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fa288e1f899a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/fastai?source=post_page-----fa288e1f899a---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/pytorch?source=post_page-----fa288e1f899a---------------pytorch-----------------", "anchor_text": "Pytorch"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----fa288e1f899a---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----fa288e1f899a---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffa288e1f899a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&user=Henri+Woodcock&userId=e9ee1187182a&source=-----fa288e1f899a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffa288e1f899a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&user=Henri+Woodcock&userId=e9ee1187182a&source=-----fa288e1f899a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffa288e1f899a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffa288e1f899a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fa288e1f899a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fa288e1f899a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fa288e1f899a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fa288e1f899a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fa288e1f899a--------------------------------", "anchor_text": ""}, {"url": "https://henriwoodcock.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://henriwoodcock.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Henri Woodcock"}, {"url": "https://henriwoodcock.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "50 Followers"}, {"url": "http://henriwoodcock.github.io", "anchor_text": "henriwoodcock.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe9ee1187182a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&user=Henri+Woodcock&userId=e9ee1187182a&source=post_page-e9ee1187182a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8e478f1fd18&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fautoencoders-in-the-fastai-library-fa288e1f899a&newsletterV3=e9ee1187182a&newsletterV3Id=8e478f1fd18&user=Henri+Woodcock&userId=e9ee1187182a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}