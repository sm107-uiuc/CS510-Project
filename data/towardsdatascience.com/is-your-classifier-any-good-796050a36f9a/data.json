{"url": "https://towardsdatascience.com/is-your-classifier-any-good-796050a36f9a", "time": 1683015144.171401, "path": "towardsdatascience.com/is-your-classifier-any-good-796050a36f9a/", "webpage": {"metadata": {"title": "Is Your Classifier Any Good?. Don\u2019t fall for the wrong evaluation\u2026 | by Frank Zickert | Quantum Machine Learning | Towards Data Science", "h1": "Is Your Classifier Any Good?", "description": "In this post, we aim to predict whether a passenger survived the Titanic shipwreck. But rather than training a sophisticated model, we don\u2019t even look at the data. This way, we discover how easy it\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.pyqml.com/page?ref=medium_classifier&dest=/", "anchor_text": "Hands-On Quantum Machine Learning With Python", "paragraph_index": 0}, {"url": "https://www.pyqml.com/page?ref=medium_classifier&dest=/", "anchor_text": "Hands-On Quantum Machine Learning With Python", "paragraph_index": 46}, {"url": "https://www.pyqml.com/page?ref=medium_classifier&dest=/", "anchor_text": "here", "paragraph_index": 47}], "all_paragraphs": ["This post is part of the book: Hands-On Quantum Machine Learning With Python", "In this post, we aim to predict whether a passenger survived the Titanic shipwreck. But rather than training a sophisticated model, we don\u2019t even look at the data. This way, we discover how easy it is to produce seemingly good results that are, in fact, worthless.", "Predicting survival on board the Titanic is a classification task since there are distinct outcome values. Specifically, it is a binary classification task because there are exactly two possible predictions (survived or died).", "Before we develop a sophisticated machine learning algorithm, let\u2019s implement the simplest algorithm we can imagine. A classifier that guesses.", "We import the random number generator (line 1) and initialize it (line 2).", "Our classifier is a function that takes passenger data as input and returns either 0 or 1 as output. Similar to our data, 0 indicates the passenger died and 1 the passenger survived.", "In order to use the classifier, we write a Python function that runs our classifier for each item in the training set.", "This function takes the classifier-function as the first argument (we can replace the classifier later) and the input data (as x) as the second parameter (line 1).", "It uses Python\u2019s map function to call the classifier with each item in x and return an array of the results.", "When we run the classifier with our train_input we receive a list of predictions.", "Since our goal is to predict the actual result correctly, we need to evaluate whether the prediction matches the actual result.", "Let\u2019s have a look at the accuracy of our predictions.", "We define another function evaluate. It takes the predictions of our algorithm and the actual results as parameters (line 1).", "The term list(zip(predictions,actual)) (line 4) creates a list of 2-item lists. The 2-item lists are pairs of a prediction and the corresponding actual result.", "We filter these items from the list where the prediction matches the actual result (lambda item: item[0] == item[1]) (line 3). These are the correct predictions. The length of the list of correct predictions divided by the total number of passengers is our Accuracy.", "Great! We are already correct in half of the cases (more or less). This is not a surprise when guessing one out of two possible labels.", "But maybe we can do even better? I mean without any effort. We know that more people died than survived. What if we always predicted the death of a passenger?", "We\u2019re up to an accuracy of 61% of our predictions. Not too bad, is it? This value, that is the ratio between the two possible actual values is the prevalence.", "Let\u2019s consider a different task for a moment. Let\u2019s say you\u2019re a doctor and your task is to predict whether a patient has cancer. Only 1% of your patients actually have cancer. If you predicted no-cancer all the time, your accuracy would be astonishing 99%! But you would falsely diagnose the patients that actually have cancer. And for the resulting lack of treatment, they\u2019re going to die.", "Maybe the accuracy of the predictions alone is not a good measure to evaluate the performance of our algorithm.", "The evaluation is one main part of every machine learning algorithm. It may seem trivial at first sight. Yet, deciding on the right measure is a very important step. When you optimize your algorithm towards better performance, you will inevitably optimize towards better scores in your evaluation function.", "But for now, we keep it simple. A better way to evaluate the performance of a classifier is to look at the confusion matrix.", "The general idea is to compare the predictions with the actual values. In binary classification, there are two possible actual values: true or false. And there are two possible predictions: true or false.", "Let\u2019s have a look at the confusion matrix of the predict death classifier.", "Scikit-Learn provides the confusion_matrix method that we import (line 1). It takes the actual values as first and the predictions as the second parameter (line 3).", "It returns a two-dimensional array. In the first row, it shows the true negatives (TN) and the false positives (FP). In the second row, it shows the false negatives (FN) and the true positives (TP).", "We can define the accuracy we measured thus far as:", "It does not care whether there is a systematic error, such as the algorithm\u2019s inability to correctly predict a passenger who survived (true positives) as long as it performs well at correctly predicting passengers who die (true negatives).", "The confusion matrix offers us more detailed measures of our classifier performance. These are:", "The precision is the \u201caccuracy of the positive predictions\u201d. It only looks at the positive predictions, these are predictions that the passenger survived.", "Let\u2019s have a look at the code:", "Scikit-Learn provides a function to calculate the precision_score. It takes the list of actual values and the list of predicted values as input.", "Since we did not have a single positive prediction, our precision is not defined. Scikit-Learn interprets this as a score of 0.0.", "The recall is the \u201caccuracy of the actual positives\u201d. It only looks at the actual positives.", "This time, even though recall is defined (the number of actual positives is greater than 0), the score is 0.0 again, because our classifier did not predict a single survival correctly. Not a surprise when it always predicts death.", "The specificity is the \u201caccuracy of the actual negatives\u201d. It only looks at actual negatives (deaths).", "And the \u2018negative predictive value\u2019 (NPV) is the \u201caccuracy of the negative predictions\u201d.", "These two functions are not provided out of the box. But with the values we get from the confusion matrix, we can calculate them easily:", "The function specificity takes the confusion matrix as a parameter (line 1). It divides the true negatives (matrix[0][0]) by the sum of the true negatives and the false positives (matrix[0][1]) (line 2).", "The function npv takes the confusion matrix as a parameter (line 4) and divides the true negatives by the sum of the true negatives and the false negatives (matrix[1][0]).", "These four scores provide a more detailed view of the performance of our classifiers.", "Let\u2019s calculate these scores for our random classifier as well:", "While the predict death classifier exhibits a complete absence of precision and recall, it has perfect specificity and reaches an NPV score that matches the percentage of negatives in our test dataset (the prevalence).", "The random classifier yields more balanced scores. You\u2019ll get a little bit different scores every time you run the classifier. But the values seem to stay in certain ranges. While the precision of this classifier is usually below 0.4 the npv is above 0.6.", "The confusion matrix and related measures give you a lot of information. But sometimes, you need a more concise metric. In fact, the evaluation function in a machine learning algorithm must return a single measure it can optimize.", "And this single measure should unmask a classifier that does not really add any value.", "This post is part of the book: Hands-On Quantum Machine Learning With Python.", "Get the first three chapters for free here.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "You're interested in quantum computing and machine learning. But you don't know how to get started? Let me help"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F796050a36f9a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----796050a36f9a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----796050a36f9a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://pyqml.medium.com/?source=post_page-----796050a36f9a--------------------------------", "anchor_text": ""}, {"url": "https://pyqml.medium.com/?source=post_page-----796050a36f9a--------------------------------", "anchor_text": "Frank Zickert | Quantum Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feebfab42a2c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&user=Frank+Zickert+%7C+Quantum+Machine+Learning&userId=eebfab42a2c4&source=post_page-eebfab42a2c4----796050a36f9a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F796050a36f9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F796050a36f9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pyqml.com/page?ref=medium_classifier&dest=/", "anchor_text": "Hands-On Quantum Machine Learning With Python"}, {"url": "https://www.pinewoodgroup.com/", "anchor_text": "Pinewood Studios"}, {"url": "https://www.pyqml.com/page?ref=medium_classifier&dest=/", "anchor_text": "Hands-On Quantum Machine Learning With Python"}, {"url": "https://www.pyqml.com/page?ref=medium_classifier&dest=/", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----796050a36f9a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----796050a36f9a---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----796050a36f9a---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----796050a36f9a---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/evaluation-metric?source=post_page-----796050a36f9a---------------evaluation_metric-----------------", "anchor_text": "Evaluation Metric"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F796050a36f9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&user=Frank+Zickert+%7C+Quantum+Machine+Learning&userId=eebfab42a2c4&source=-----796050a36f9a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F796050a36f9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&user=Frank+Zickert+%7C+Quantum+Machine+Learning&userId=eebfab42a2c4&source=-----796050a36f9a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F796050a36f9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----796050a36f9a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F796050a36f9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----796050a36f9a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----796050a36f9a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----796050a36f9a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----796050a36f9a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----796050a36f9a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----796050a36f9a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----796050a36f9a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----796050a36f9a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----796050a36f9a--------------------------------", "anchor_text": ""}, {"url": "https://pyqml.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://pyqml.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Frank Zickert | Quantum Machine Learning"}, {"url": "https://pyqml.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feebfab42a2c4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&user=Frank+Zickert+%7C+Quantum+Machine+Learning&userId=eebfab42a2c4&source=post_page-eebfab42a2c4--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F2d21069992f0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-your-classifier-any-good-796050a36f9a&newsletterV3=eebfab42a2c4&newsletterV3Id=2d21069992f0&user=Frank+Zickert+%7C+Quantum+Machine+Learning&userId=eebfab42a2c4&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}