{"url": "https://towardsdatascience.com/productionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2", "time": 1683001879.6962712, "path": "towardsdatascience.com/productionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2/", "webpage": {"metadata": {"title": "Productionize a Machine Learning model with Flask and Heroku | by GreekDataGuy | Towards Data Science", "h1": "Productionize a Machine Learning model with Flask and Heroku", "description": "Coming from a software development background I never thought twice about productionizing my models. But for anyone just getting into coding, as a data scientist, it may not be obvious. In this post\u2026"}, "outgoing_paragraph_urls": [{"url": "http://heroku create flask-ml-api-123", "anchor_text": "Heroku", "paragraph_index": 34}, {"url": "http://gmail.com", "anchor_text": "gmail.com", "paragraph_index": 39}], "all_paragraphs": ["Coming from a software development background I never thought twice about productionizing my models. But for anyone just getting into coding, as a data scientist, it may not be obvious.", "For a model to be used in the real world, you\u2019ll need to productionize it.", "In this post we\u2019ll cover a few things:1. creating an ML model2. wrapping it in a Flask API3. deploying that API onto Heroku", "This tutorial is not about training a model so we\u2019ll train a really simple model on the Boston housing dataset without regards to how well it works.", "label on the left represents Median value of owner-occupied homes in $1000\u2019s average home value in thousands of dollars in each area. The idea behind this dataset is to use values in the other columns to predict average home value.", "We\u2019ll just use RM, average number of rooms per dwelling to make our predictions, fully knowing this will not create an accurate model.", "I\u2019ve predicted results here but frankly, we don\u2019t care. We could build a much more accurate model if we spent more time on the problem.", "Pickling converts the object into a byte stream which can be stored, transferred, and converted back to the original model at a later time. Pickles are one of the ways python lets you save just about any object out of the box.", "Boom. Our model is now saved as a pickle in the same directory as our jupyter notebook.", "Flask is a micro frameworks for Python. It comes with none of the excess cruft of other frameworks so its perfect for building a simple API.", "We\u2019re going to run a few commands on the command line to get things started.", "Create a directory to store the appmkdir FlaskAPI", "Create a virtual environmentpython3 -m venv vir_env", "Install all the packages we\u2019ll needpip3 install flask gunicorn sklearn", "Save a list of packages and versions that production will need to installpip3 freeze > requirements.txt", "Inside the last directory we created, create a few files and another directory with the command line.", "Open the FlaskAPI directory in your favorite code editor. I like sublime so I\u2019ll launch it in the current directory with sublime ..", "Copy the following into app.py .", "And copy the following into wsgi.py", "Success. We have a Flask API running locally.", "Time to add our machine learning model. Grab your model_file.p pickle and drop it into the /models/ directory in the app we made so your file tree now looks like the left.", "And modify your predict() function so it looks like this", "You\u2019ll also need to add import json and import pickle to the top of app.py .", "Note that we\u2019re mocking an input value rather than actually sending it to the app and parsing the response \u2014 that\u2019s coming.", "Let\u2019s test the app again to ensure the model is working behind our API.", "Perfect. Our model is predicting a label based on an inputted feature inside our API!", "Now let\u2019s get our API to accept input features from a request.", "Also add this to Procfile, which actually does have no extension.", "Make another request. This time we\u2019ve modified it slightly so our API knows it\u2019s getting a JSON.", "Again, success! We have a working API with our model inside.", "Add git to the app by running git init on the command line.", "Then run nano .gitignore and add the following lines,", "Then press ctrl+x, y, then enter to save and close the file on mac. This will prevent pushing unnecessary files to Heroku.", "Continue adding files to git by running git add . -A and git commit -m 'first commit' on the command line.", "Create an account with Heroku. Then login to Heroku with heroku login on the command line, then create an app with heroku create flask-ml-api-123 . flask-ml-api-123 is the app name I picked. You\u2019ll need to find a name that no one else has already taken.", "Now push our app to heroku with git push heroku master.", "While deploying you\u2019ll see the URL given to your app from Heroku. This is where you\u2019ll send your API request.", "Now we\u2019re talking! We\u2019ve trained a model, wrapped it in an API, and deployed it to Heroku. Obviously there are a lot more things we should add like authentication. But this should get you started!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Just a developer. Contact: greek.data.guy \u201cat\u201d gmail.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8201260503d2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8201260503d2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8201260503d2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://greekdataguy.medium.com/?source=post_page-----8201260503d2--------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=post_page-----8201260503d2--------------------------------", "anchor_text": "GreekDataGuy"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd67bf018ae6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&user=GreekDataGuy&userId=d67bf018ae6d&source=post_page-d67bf018ae6d----8201260503d2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8201260503d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8201260503d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "http://0.0.0.0:8080/predict", "anchor_text": "http://0.0.0.0:8080/predict"}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "http://0.0.0.0:8080/predict", "anchor_text": "http://0.0.0.0:8080/predict"}, {"url": "http://twitter.com/app", "anchor_text": "@app"}, {"url": "http://heroku create flask-ml-api-123", "anchor_text": "Heroku"}, {"url": "https://flask-ml-api-123.herokuapp.com/", "anchor_text": "https://flask-ml-api-123.herokuapp.com/"}, {"url": "https://flask-ml-api-123.herokuapp.com/predict", "anchor_text": "https://flask-ml-api-123.herokuapp.com/predict"}, {"url": "https://medium.com/tag/web-development?source=post_page-----8201260503d2---------------web_development-----------------", "anchor_text": "Web Development"}, {"url": "https://medium.com/tag/python-flask?source=post_page-----8201260503d2---------------python_flask-----------------", "anchor_text": "Python Flask"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----8201260503d2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----8201260503d2---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8201260503d2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8201260503d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&user=GreekDataGuy&userId=d67bf018ae6d&source=-----8201260503d2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8201260503d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&user=GreekDataGuy&userId=d67bf018ae6d&source=-----8201260503d2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8201260503d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8201260503d2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8201260503d2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8201260503d2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8201260503d2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8201260503d2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8201260503d2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8201260503d2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8201260503d2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8201260503d2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8201260503d2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8201260503d2--------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://greekdataguy.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "GreekDataGuy"}, {"url": "https://greekdataguy.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "9.97K Followers"}, {"url": "http://gmail.com", "anchor_text": "gmail.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd67bf018ae6d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&user=GreekDataGuy&userId=d67bf018ae6d&source=post_page-d67bf018ae6d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F26b33036e2a7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fproductionize-a-machine-learning-model-with-flask-and-heroku-8201260503d2&newsletterV3=d67bf018ae6d&newsletterV3Id=26b33036e2a7&user=GreekDataGuy&userId=d67bf018ae6d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}