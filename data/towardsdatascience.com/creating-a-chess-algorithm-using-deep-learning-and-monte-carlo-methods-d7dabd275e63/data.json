{"url": "https://towardsdatascience.com/creating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63", "time": 1683016744.154634, "path": "towardsdatascience.com/creating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63/", "webpage": {"metadata": {"title": "Creating a Chess Algorithm using Deep Learning and Monte Carlo Methods | by Victor Sim | Towards Data Science", "h1": "Creating a Chess Algorithm using Deep Learning and Monte Carlo Methods", "description": "Over the past few weeks I have tried two distinct approaches to create a chess algorithm that can play with great strategic depth without looking too far ahead and blundering. The first method I used\u2026"}, "outgoing_paragraph_urls": [{"url": "https://linktr.ee/victorsi", "anchor_text": "link", "paragraph_index": 16}, {"url": "https://linktr.ee/victorsi", "anchor_text": "https://linktr.ee/victorsi", "paragraph_index": 18}], "all_paragraphs": ["Over the past few weeks I have tried two distinct approaches to create a chess algorithm that can play with great strategic depth without looking too far ahead and blundering.", "The first method I used was to convert chess moves and chess boards into one-hot encoding, and then using these values to train a deep neural network to come up with the best move, when given a certain board. There are few problems with this method. It would be far too easy for the computer to make illegal moves, that is, moves that are not possible on the board configuration, making training learning legal moves before best moves, which would significantly slow down convergence.", "The second method I used was manually creating a heuristic algorithm from scratch that took numerical measures of the board and calculated a numerical value that was the score of the board. I then wrote a search algorithm that used Monte Carlo methods by picking random moves after a recorded first move. However, I found that the heuristic values that my algorithm calculated were largely inaccurate and had no foresight for more complex tactics or positional advantages.", "I found out that putting two of the algorithms together would yield great results. Here\u2019s the concept:", "I would train a deep neural network based on the evaluation made by the Stockfish algorithm from a dataset. For each legal move for the position given, for a given depth, a random move would be made. The position would then be evaluated and recorded. The first move that has the highest score would therefore be the best move.", "This would be better than the deep learning algorithm as it would only make legal moves and better than the search algorithm as it had the evaluation abilities of the stockfish algorithm. The computation would be relatively low as training the stockfish deep learning algorithm could be done beforehand, and due to only running random moves, it would take less computational power.", "Access the first dataset from Kaggle. Download it onto your local drive and import it using the read_csv function from pandas.", "The chess_dict is a dictionary that can be used to change each board into a matrix of one-hot encoded arrays. Based on basic functions of the python-chess function, one can convert a chess board into a matrix of strings. This matrix of strings can be one-hot encoded to form a matrix of one-hot encodings. This matrix can then be fed into a neural network.", "This script gets the actual values and performs the two sets of operations on the boards so that the data can be fed into a neural network.", "As the evaluation could return with a value of M5, or #5, we have to remove this and change this to a numerical value. For every occurence of a hash, multiple the last value in the string by 1000.", "After a few preliminary runs with the training function with the data at this state, I found that normalizing the data (setting the data as a value between 0 and 1) yielded better results. Of course, the last layer of the neural network must therefore be a sigmoid function.", "Now that the data has been properly normalized, we can create the neural network. The neural network is a basic convolutional neural network, with batch normalization at the end of it. I am saving the best weights so that the model can be loaded later to prevent wasting computational power on training the model everytime a move needs to be made. I created a test and train set to make sure that everything is working as intended.", "This function loads the model based on the best weights saved earlier. It is reasonably simple, but one must make sure that the file is in the directory that the program is in or a path must be defined to access the file.", "Basically the program collects the first set of legal moves possible to make given the board configuration. F or a defined test_depth, the algorithm will choose random legal moves. The final board it comes up with will be evaluated using the model, and a numerical evaluation will be calculated. This numerical evaluation will be added to the score of that move. The move with the highest score will be the move played by the computer.", "I wrote a little prototype script to play against the chess algorithm:", "It fared much better than any other algorithm I have written, moving quite rapidly as well! I hope you learnt how to use monte carlo algorithms and deep learning algorithms in conjunction to solve problems with my article.", "If you want to see more of my content, click this link.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Interested in Machine Learning. Open to internships and opportunities. Connect at https://linktr.ee/victorsi."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd7dabd275e63&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://victorsim14.medium.com/?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": ""}, {"url": "https://victorsim14.medium.com/?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": "Victor Sim"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc395af42221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&user=Victor+Sim&userId=fc395af42221&source=post_page-fc395af42221----d7dabd275e63---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7dabd275e63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7dabd275e63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lastly?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Tyler Lastovich"}, {"url": "https://unsplash.com/backgrounds/colors/light?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://linktr.ee/victorsi", "anchor_text": "link"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d7dabd275e63---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/programming?source=post_page-----d7dabd275e63---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d7dabd275e63---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7dabd275e63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&user=Victor+Sim&userId=fc395af42221&source=-----d7dabd275e63---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd7dabd275e63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&user=Victor+Sim&userId=fc395af42221&source=-----d7dabd275e63---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7dabd275e63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd7dabd275e63&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d7dabd275e63---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d7dabd275e63--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d7dabd275e63--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d7dabd275e63--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d7dabd275e63--------------------------------", "anchor_text": ""}, {"url": "https://victorsim14.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://victorsim14.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Victor Sim"}, {"url": "https://victorsim14.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "952 Followers"}, {"url": "https://linktr.ee/victorsi", "anchor_text": "https://linktr.ee/victorsi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc395af42221&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&user=Victor+Sim&userId=fc395af42221&source=post_page-fc395af42221--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa08a1abceacb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-chess-algorithm-using-deep-learning-and-monte-carlo-methods-d7dabd275e63&newsletterV3=fc395af42221&newsletterV3Id=a08a1abceacb&user=Victor+Sim&userId=fc395af42221&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}