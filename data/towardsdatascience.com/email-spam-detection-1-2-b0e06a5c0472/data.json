{"url": "https://towardsdatascience.com/email-spam-detection-1-2-b0e06a5c0472", "time": 1682994239.1008189, "path": "towardsdatascience.com/email-spam-detection-1-2-b0e06a5c0472/", "webpage": {"metadata": {"title": "How To Design A Spam Filtering System with Machine Learning Algorithm | by gannestweb | Towards Data Science", "h1": "How To Design A Spam Filtering System with Machine Learning Algorithm", "description": "As a software developer, email is one of the very important tool for communication. To have effective communication, spam filtering is one of the important feature. The main goal of these two parts\u2026"}, "outgoing_paragraph_urls": [{"url": "https://spamassassin.apache.org/old/publiccorpus/", "anchor_text": "link", "paragraph_index": 10}, {"url": "https://machinelearningmastery.com/prepare-text-data-machine-learning-scikit-learn/", "anchor_text": "article", "paragraph_index": 41}, {"url": "https://towardsdatascience.com/introduction-to-naive-bayes-classification-4cffabb1ae54", "anchor_text": "article", "paragraph_index": 50}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html", "anchor_text": "here,", "paragraph_index": 64}, {"url": "https://towardsdatascience.com/spam-filtering-system-with-deep-learning-b8070b28f9e0", "anchor_text": "here", "paragraph_index": 68}, {"url": "https://github.com/huai99/Email-Spam-Detection-Python", "anchor_text": "Github", "paragraph_index": 69}, {"url": "https://colab.research.google.com/drive/1nh4bWccs7cgOx7kSalBmUMJzK3h7UEvU", "anchor_text": "Colab", "paragraph_index": 69}], "all_paragraphs": ["As a software developer, email is one of the very important tool for communication. To have effective communication, spam filtering is one of the important feature.", "So how do spam filtering system actually works? Can we design something similar from scratch?", "The main goal of these two parts of article is to show how you could design a spam filtering system from scratch.", "Outlines of this article are summarized as below:", "Exploratory Data Analysis is a very important process of data science. It helps the data scientist to understand the data at hand and relates it with the business context.", "The open source tools that I will be using in visualizing and analyzing my data is Word Cloud.", "Word Cloud is a data visualization tool used for representing text data. The size of the texts in the image represent the frequency or importance of the words in the training data.", "Steps to take in this section:", "Data is the essential ingredients before we can develop any meaningful algorithm. Knowing where to get your data can be a very handy tool especially when you are just a beginner.", "Below are a few of the famous repositories where you can easily get thousand kind of data set for free :", "For this email spamming data set, it is distributed by Spam Assassin, you can click this link to go to the data set. There are a few categories of the data, you can read the readme.html to get more background information on the data.", "In short, there is two types of data present in this repository, which is ham (non-spam) and spam data. Furthermore, in the ham data, there are easy and hard, which mean there is some non-spam data that has a very high similarity with spam data. This might pose a difficulty for our system to make a decision.", "If you are using Linux or Mac, simply do this in the terminal, wget is simply a command that help you to download file given an url:", "Let\u2019s run some code and see what content is inside all these emails!", "Let\u2019s take a look at the email message content and have a basic understanding of the data", "This looks like a normal email reply to another person, which is not difficult to classified as a ham:", "Hard Ham is indeed more difficult to differentiate from the spam data, as they contain some key words such as limited time order, Special \u201cBack to School\u201d Offer, this make it very suspicious !", "One of the spam training data does look like one of those spam advertisement email in our junk folder:", "Wordcloud is a useful visualization tool for you to have a rough estimate of the words that has the highest frequency in the data that you have.", "From this visualization, you can notice something interesting about the spam email. A lot of them are having high number of \u201cspammy\u201d words such as: free, money, product etc. Having this awareness might help us to make better decision when it comes to designing the spam detection system.", "One important thing to note is that word cloud only displays the frequency of the words, not necessarily the importance of the words. Hence it is necessary to do some data cleaning such as removing stopwords, punctuation and so on from the data before visualizing it.", "Another technique of visualization is by utilizing bar chart and display the frequency of the words that appear the most. N-gram means that how many words you are considering as a single unit when you are calculating the frequency of words.", "In this article, I have shown the example of 1-gram, and 2-gram. You can definitely experiment by trying bigger n-gram model.", "It is important to split your data set to training set and test set, so that you can evaluate the performance of your model using the test set before deploying it in a production environment.", "One important thing to note when doing the train test split is to make sure the distribution of the data between the training set and testing set are similar.", "What it means in this context is that the percentage of spam email in the training set and test set should be similar.", "The distribution between train data and test data are quite similar which is around 20\u201321%, so we are good to go and start to process our data !", "Text Cleaning is a very important step in machine learning because your data may contains a lot of noise and unwanted character such as punctuation, white space, numbers, hyperlink and etc.", "Some standard procedures that people generally use are:", "The two techniques that might seem foreign to most people are word stemming and word lemmatization. Both these techniques are trying to reduce the words to its most basic form, but doing this with different approaches.", "Implementing these two algorithms might be tricky and requires a lot of thinking and design to deal with different edge cases.", "Luckily NLTK library has provided the implementation of these two algorithms, so we can use it out of the box from the library!", "Import the library and start designing some functions to help us understand the basic working of these two algorithms.", "The output of word stemmer is very obvious, some of the endings of the words have been chopped off", "The lemmatization has converted studies -> study, breaks -> break", "Our algorithm always expect the input to be integers/floats, so we need to have some feature extraction layer in the middle to convert the words to integers/floats.", "There are a couples ways of doing this, and today I am going to introduce:", "First we need to input all the training data into CountVectorizer and the CountVectorizer will keep a dictionary of every word and its respective id and this id will relate to the word count of this word inside this whole training set.", "For example, a sentence like \u2018I like to eat apple and drink apple juice\u2019", "Word counts are good but can we do better? One issue with simple word count is that some words like \u2018the\u2019, \u2018and\u2019 will appear many times and they don\u2019t really add too much meaningful information.", "Another popular alternative is TfidfVectorizer. Besides of taking the word count of every words, words that often appears across multiple documents or sentences, the vectorizer will try to downscale them.", "For more info about CountVectorizer and TfidfVectorizer, please read from this great piece of article, which is also where I gain most of my understanding.", "There is a lot of great articles online that explains the details of word embedding and the algorithm to generate them. So here, I will skip most of them and try to give you a rough idea of what it is.", "Word embedding is trying to convert a word to a vectorized format and this vector represents the position of this word in a higher dimensional space.", "For words that have similar meaning, the cosine distance of those two word vectors will be shorter and they will be closer to each other.", "And in fact, these words are vectors, so you can even perform math operations on them ! The end results of these operation will be another vector that maps to a word. Unexpectedly, those operations produce some amazing result !", "Example 1 : King- Man + Woman = Queen", "Simply put, word embedding is a very powerful representation of the words and one of the well known techniques in generating this embedding is Word2Vec.", "Hooh ! After converting all the sentences into some form of vectors, it comes to the most exciting part of our articles \u2192 Algorithm Implementation !", "The first approach that I take was to use the TfidfVectorizer as a feature extraction tools and Naive Bayes algorithm to do the prediction. Naive Bayes is a simple and a probabilistic traditional machine learning algorithm.", "It is very popular even in the past in solving problems like spam detection. The details of Naive Bayes can be checkout at this article by Devi Soni which is a concise and clear explanation of the theory of Naive Bayes algorithm.", "Using Naive Bayes library provided by sklearn library save us a lot of hassle in implementing this algorithm ourselves. We can easily get this done in a few lines of codes", "We achieve an accuracy of 93.2%. But accuracy is not solely the metrics to evaluate the performance of an algorithm. Lets try out other scoring metrics and that may help us to understand thoroughly how well this model is doing.", "When it comes to evaluation of a data science model\u2019s performance, sometimes accuracy may not be the best indicator.", "Some problems that we are solving in real life might have a very imbalanced class and using accuracy might not give us enough confidence to understand the algorithm\u2019s performance.", "In the email spamming problem that we are trying to solve, the spam data is approximately 20% of our data. If our algorithm predicts all the email as non-spam, it will achieve an accuracy of 80%.", "And for some problem that has only 1% of positive data, predicting all the sample as negative will give them an accuracy of 99% but we all know this kind of model is useless in a real life scenario.", "Precision & Recall is the common evaluation metrics that people use when they are evaluating class-imbalanced classification model.", "Let\u2019s try to understand what questions Precision & Recall is trying to answer,", "Precision: What proportion of positive identifications was actually correct ?", "Recall: What actual proportion of actual positives was identified correctly?", "So, precision is evaluating, when a model predict something as positive, how accurate the model is. On the other hand, recall is evaluating how well a model in finding all the positive samples.", "The mathematical equation for precision & recall are as respective", "Confusion Matrix is a very good way to understand results like true positive, false positive, true negative and so on.", "Sklearn documentation has provided a sample code of how to plot nice looking confusion matrix to visualize your result. You can check it out here, or you can find the code in the notebook that I am sharing at the end of the articles.", "The recall of this model is rather low, it might not be doing a good enough job in discovering the spam email. How do we do better than this ?", "In this article, I have showed you all the necessary steps needed in designing a spam detection algorithm. Just a brief recap:", "Here concludes the first part of demonstration in designing spam detection algorithm.", "There is a part 2 of this article! I am going to demonstrate how you could improve the performance in terms of accuracy, precision and recall of the model by using word embeddings and deep learning model. Read the article here if you are interested!", "You can clone the notebook from Github or run it from Colab directly. Leave any questions you have at the comments section below.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer in the payment industry, Foodie and Deeply Interested in History, Psychology and Economics"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb0e06a5c0472&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gannestweb?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gannestweb?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": "gannestweb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65d58216b9a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&user=gannestweb&userId=65d58216b9a9&source=post_page-65d58216b9a9----b0e06a5c0472---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0e06a5c0472&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0e06a5c0472&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://archive.ics.uci.edu/ml/index.php", "anchor_text": "UC Irvine Machine Learning Repository"}, {"url": "https://www.kaggle.com/datasets", "anchor_text": "Kaggle datasets"}, {"url": "https://registry.opendata.aws/", "anchor_text": "AWS datasets"}, {"url": "https://spamassassin.apache.org/old/publiccorpus/", "anchor_text": "link"}, {"url": "https://spamassassin.apache.org/old/publiccorpus/20030228_easy_ham.tar.bz2", "anchor_text": "https://spamassassin.apache.org/old/publiccorpus/20030228_easy_ham.tar.bz2"}, {"url": "https://spamassassin.apache.org/old/publiccorpus/20030228_easy_ham_2.tar.bz2", "anchor_text": "https://spamassassin.apache.org/old/publiccorpus/20030228_easy_ham_2.tar.bz2"}, {"url": "https://spamassassin.apache.org/old/publiccorpus/20030228_spam.tar.bz2", "anchor_text": "https://spamassassin.apache.org/old/publiccorpus/20030228_spam.tar.bz2"}, {"url": "https://spamassassin.apache.org/old/publiccorpus/20050311_spam_2.tar.bz2", "anchor_text": "https://spamassassin.apache.org/old/publiccorpus/20050311_spam_2.tar.bz2"}, {"url": "https://spamassassin.apache.org/old/publiccorpus/20030228_hard_ham.tar.bz2", "anchor_text": "https://spamassassin.apache.org/old/publiccorpus/20030228_hard_ham.tar.bz2"}, {"url": "http://www.affordable-domains.com", "anchor_text": "http://www.affordable-domains.com"}, {"url": "https://machinelearningmastery.com/prepare-text-data-machine-learning-scikit-learn/", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/introduction-to-naive-bayes-classification-4cffabb1ae54", "anchor_text": "article"}, {"url": "https://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html", "anchor_text": "here,"}, {"url": "https://towardsdatascience.com/spam-filtering-system-with-deep-learning-b8070b28f9e0", "anchor_text": "here"}, {"url": "https://github.com/huai99/Email-Spam-Detection-Python", "anchor_text": "Github"}, {"url": "https://colab.research.google.com/drive/1nh4bWccs7cgOx7kSalBmUMJzK3h7UEvU", "anchor_text": "Colab"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b0e06a5c0472---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----b0e06a5c0472---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/spam?source=post_page-----b0e06a5c0472---------------spam-----------------", "anchor_text": "Spam"}, {"url": "https://medium.com/tag/naive-bayes?source=post_page-----b0e06a5c0472---------------naive_bayes-----------------", "anchor_text": "Naive Bayes"}, {"url": "https://medium.com/tag/feature-extraction?source=post_page-----b0e06a5c0472---------------feature_extraction-----------------", "anchor_text": "Feature Extraction"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0e06a5c0472&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&user=gannestweb&userId=65d58216b9a9&source=-----b0e06a5c0472---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb0e06a5c0472&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&user=gannestweb&userId=65d58216b9a9&source=-----b0e06a5c0472---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb0e06a5c0472&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb0e06a5c0472&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b0e06a5c0472---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b0e06a5c0472--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gannestweb?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gannestweb?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "gannestweb"}, {"url": "https://medium.com/@gannestweb/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "64 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F65d58216b9a9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&user=gannestweb&userId=65d58216b9a9&source=post_page-65d58216b9a9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe21f931870ee&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Femail-spam-detection-1-2-b0e06a5c0472&newsletterV3=65d58216b9a9&newsletterV3Id=e21f931870ee&user=gannestweb&userId=65d58216b9a9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}