{"url": "https://towardsdatascience.com/helping-machines-understand-complex-questions-48536fd93ef2", "time": 1683004894.1501591, "path": "towardsdatascience.com/helping-machines-understand-complex-questions-48536fd93ef2/", "webpage": {"metadata": {"title": "Helping Machines Understand Complex Questions | by Giovanna Fernandes | Towards Data Science", "h1": "Helping Machines Understand Complex Questions", "description": "The field of Natural Language Processing has always been fascinating to me. To imagine that a computer can understand and respond to human language is nothing short of amazing. I\u2019ve been wanting to\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/google-quest-challenge", "anchor_text": "Google QUEST Kaggle Challenge", "paragraph_index": 0}, {"url": "https://www.kaggle.com/c/google-quest-challenge/data", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://github.com/gioamorim80/QA-Complex-Questions---Multi-label-Text-Classification/blob/master/Capstone_Project.ipynb", "anchor_text": "my Github page", "paragraph_index": 6}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab", "paragraph_index": 7}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "GloVe embeddings here", "paragraph_index": 11}, {"url": "https://www.kaggle.com/buntyshah/google-quest-q-a-labeling-embeddings-glove", "anchor_text": "this Kaggle Notebook", "paragraph_index": 14}], "all_paragraphs": ["(This project was inspired by Google QUEST Kaggle Challenge)", "The field of Natural Language Processing has always been fascinating to me. To imagine that a computer can understand and respond to human language is nothing short of amazing. I\u2019ve been wanting to work on a project that involved both NLP and also deep learning for a little while, so I decided to create a project where a stakeholder needs to improve his Question & Answer system.", "As advanced as QA systems and chatbots have become, they still struggle when faced with questions that are more complex in nature. Machines can easily compute dimensions such as number of characters, or vocabulary, but humans are much better at computing qualitative dimensions such as \u201cis this question looking for a recommendation?\u201d", "A model that can predict such subjective aspects of questions and correctly identify complexity can be very helpful in improving how these tools are built and implemented.", "You can find the data we will be using here. The original data consists of over six thousand samples of question-answer pairs from various StackExchange websites along with 30 human-generated subjective labels for each sample. I\u2019ve adapted the problem from this competition to a more business-like situation. Our imaginary stakeholder is only interested in a machine-based solution to evaluate the questions it receives from its customers, and only over a few subjective aspects. The final goal is for his QA system to automatically answer the questions that are more factual and flag complex questions for employees to answer them.", "So, we have a multi-class, multi-label text classification problem, where a sample can be classified for more than one class at the same time, and 6,079 samples to work with. We will use GloVe pre-trained word embeddings and a neural network model with Keras. Let\u2019s start!", "In order to not make this post too long, we will focus on the natural language processing and modeling aspects, but you can find the entirety of this project including data exploration on my Github page.", "To have more computational power I used Google Colab to work on my project, so I added the data to my google drive. I loaded the data, selected only what was relevant for my project and split the data right away to avoid any leakage.", "Also, the original targets on this dataset are not binary, so I did a quick transformation to facilitate our classification.", "Now the fun part starts! First, we create a little helper function to clean our text data from punctation, numbers, extra spaces, etc.", "We apply the function to all our text data using the method apply and lambda.", "We will load a pickled version of the Common Crawl GloVe model with 840B tokens, 2.2M vocabulary, cased, and 300d vectors. Loading the pickled version is much faster than loading the entire 2.03 GB glove model. Again, I saved that file on my Google Drive, so that\u2019s where we are getting it from, but you can find all GloVe embeddings here. We define an embedding matrix that our model will use as part of an embedding layer further on.", "Now we need to tokenize and pad our text data into the right shape for our 300 dimension GloVe embeddings. I chose to treat my text columns as separate features instead of concatenating all text data.", "Next, we also need to prepare our categorical column for our neural network. I used LabelEncoder to do that.", "Finally, we will build our neural network model with Keras. This function below was heavily inspired and adapted from this Kaggle Notebook and uses three separate inputs \u2014 one for the categorical feature and two text features, the questions title and the questions body.", "Let\u2019s walk through what is going on there: we pass our categorical feature through a Dense layer with a sigmoid activation. Then, use two embedding layers that will encode our text columns with the GloVe embeddings, and concatenate them. Then we use a Long Short Term Memory network (LSTM) layer, which is commonly used for natural language processing models, with a bidirectional layer wrapper. We will follow the LSTM layer with concatenating a Global Max Pooling and a Global Average Pooling, and add two hidden layers with relu and sigmoid activations. Finally, we add the text and the categorical layer outputs and pass one final Dense layer with our 8 nodes and a sigmoid activation that will work with our multi-label problem target.", "We compile our model and pass the function with the GloVe embedding matrix that we have constructed previously. We then fit it to our data and evaluate our results. First I use the evaluate method and get the model\u2019s accuracy for train and test data.", "However, because we have strong imbalance in our data, we want to look at other metrics that will be more informative than accuracy. Keras does not support a classification report method but we can easily counter that by transforming the predictions from Keras into a binary result and then passing them through Scikit-learn classification report method.", "What we can see from our results is that even though we were able to achieve an overall accuracy of close to 84% with our Neural Network model using GloVe embeddings, we have varying precision, recall and f1 scores depending on the target.", "Our data suffers from serious class imbalance, where the more complex targets are in fact also the ones with much fewer samples. These targets had the worst performance by far, not only because they are the complex and thus difficult for the machines to interpret, but also because of the small number of samples. More data, especially covering the targets that were underrepresented, can help improve our model further.", "In any case, working on this project was a great way to play with Natural Language Processing tools and with Keras, and I hope it can be useful to you as well. Happy coding!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I want to positively impact the world using the power of data."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F48536fd93ef2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@gio.amorim?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gio.amorim?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": "Giovanna Fernandes"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1b24a810b12b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=post_page-1b24a810b12b----48536fd93ef2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48536fd93ef2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48536fd93ef2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ratushny?utm_source=medium&utm_medium=referral", "anchor_text": "Dmitry Ratushny"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/c/google-quest-challenge", "anchor_text": "Google QUEST Kaggle Challenge"}, {"url": "https://www.kaggle.com/c/google-quest-challenge/data", "anchor_text": "here"}, {"url": "https://github.com/gioamorim80/QA-Complex-Questions---Multi-label-Text-Classification/blob/master/Capstone_Project.ipynb", "anchor_text": "my Github page"}, {"url": "https://colab.research.google.com/", "anchor_text": "Google Colab"}, {"url": "https://nlp.stanford.edu/projects/glove/", "anchor_text": "GloVe embeddings here"}, {"url": "https://www.kaggle.com/buntyshah/google-quest-q-a-labeling-embeddings-glove", "anchor_text": "this Kaggle Notebook"}, {"url": "https://medium.com/tag/data-science?source=post_page-----48536fd93ef2---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/keras?source=post_page-----48536fd93ef2---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----48536fd93ef2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/word-embeddings?source=post_page-----48536fd93ef2---------------word_embeddings-----------------", "anchor_text": "Word Embeddings"}, {"url": "https://medium.com/tag/classification?source=post_page-----48536fd93ef2---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F48536fd93ef2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=-----48536fd93ef2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F48536fd93ef2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=-----48536fd93ef2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F48536fd93ef2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F48536fd93ef2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----48536fd93ef2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----48536fd93ef2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----48536fd93ef2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----48536fd93ef2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----48536fd93ef2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gio.amorim?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@gio.amorim?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Giovanna Fernandes"}, {"url": "https://medium.com/@gio.amorim/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "70 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1b24a810b12b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=post_page-1b24a810b12b--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F1b24a810b12b%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhelping-machines-understand-complex-questions-48536fd93ef2&user=Giovanna+Fernandes&userId=1b24a810b12b&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}