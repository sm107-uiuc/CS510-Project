{"url": "https://towardsdatascience.com/scraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f", "time": 1683006009.5745192, "path": "towardsdatascience.com/scraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f/", "webpage": {"metadata": {"title": "Scraping Live Traffic Data in 3 Lines of Code, Step-by-Step | by Nathan Thomas | Towards Data Science", "h1": "Scraping Live Traffic Data in 3 Lines of Code, Step-by-Step", "description": "In light of the recent pandemic, lockdown measures imposed by policymakers have halted the majority of economic activity. Due to the lagging nature of economic data, it\u2019s not always easy to gauge in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://api.midway.tomtom.com/ranking/live/ITA_milan", "anchor_text": "https://api.midway.tomtom.com/ranking/live/ITA_milan", "paragraph_index": 4}, {"url": "https://github.com/nathanwilthomas/tomtom_live_traffic_scrape", "anchor_text": "Github repository.", "paragraph_index": 11}], "all_paragraphs": ["In light of the recent pandemic, lockdown measures imposed by policymakers have halted the majority of economic activity. Due to the lagging nature of economic data, it\u2019s not always easy to gauge in the data how consumers are behaving in real-time. In fact, data often has at least a one-month time lag, making it difficult to assess if people are actually moving around or not. Therefore, governments, scientists and economists alike have been looking at high-frequency data, which provides a real-time view of how movement in the global economy has changed since restrictions have been imposed. A popular gauge of how activity has fared has been traffic data, provided by TomTom. This data covers 416 cities across 57 countries and calculates travel times of all vehicles on the entire road network. On TomTom\u2019s website, the average congestion level is shown as a live traffic chart. I\u2019ve chosen to look at Milan:", "We\u2019re able to hover over the chart to get each individual data point, but there\u2019s no way of downloading the data from the website. So there are two options:", "On any website, it\u2019s common for the site to load in a range of different information when loading the page. This may include cookies, data files, images and more. We are able to see what\u2019s under the hood by inspecting the page. In Chrome, this is made easy by pressing \u2018Ctrl+shift+I\u2019. A window will come up which will show all the data that has been loaded into the page. The tab that we want is the Network tab, shown at the top of the pop-up window.", "If you can\u2019t see all the data, hit \u2018Ctrl+R\u2019 to reload the page and watch as all the data loads in. On the Name tab, you\u2019ll see many different file types: .js, .json, .svg, .otf and more. So how do we know which one contains the underlying data for our chart? Firstly, we need to filter by XHR. This is short for XML HTTP request. It\u2019s common for data on a webpage to be loaded using this format. We can then filter by size \u2014 underlying data is usually one of the largest files contained in the page (likely to be in kilobytes rather than bytes). Finally, more often than not, source data will come in the form of a .json file. This stands for Javascript Object Notation, and it\u2019s a common way for large amounts of data to be stored.", "However, looking at our dataset, it\u2019s not immediately obvious where the json file is. As a next step, let\u2019s look at the type column. Since we\u2019ve filtered by xhr, we should only see xhr types in this column. Having said that, when we look down the column, we can see both xhr and fetch. The fetch type implies that this data is being loaded from an API, or Automated Processing Interface. Looking at the data with the fetch type, the filename for this specific object is \u201cITA_milan\u201d. Looks like we\u2019ve got our data! We can check it\u2019s correct by opening it in a new tab. When we open the new tab, we see that this indeed the data we want, under the link: https://api.midway.tomtom.com/ranking/live/ITA_milan, which is being retrieved from an API. Great \u2014 now let\u2019s load this data into python and start cleaning it to replicate the live chart.", "First of all, requests is the module that we\u2019ll use to load the data. Using requests.get() on the url we found earlier, we can show this file as a json and unpack it using the json module in python (yes, using only three lines of code):", "This gives us the following output:", "This file may look slightly confusing, with a lot of different punctuation and parentheses. It\u2019s simpler than it looks \u2014 the json file is actually a dictionary called \u2018data\u2019, with a list of dictionaries contained within it. So to get to the information that we want; (\u201cTime\u201d and \u201cTrafficIndexLive\u201d), we have to call the keys for each point we want to retrieve. For example, to get the first value of the live traffic index, we would enter the following:", "We can then append each item in this dictionary to a list, converting each list to a column in a pandas DataFrame:", "Using dictionaries and a little bit of data cleaning, and we\u2019ve got it! Let\u2019s validate that the data matches the live chart by plotting it:", "And there we have it! In a few lines of code, we were able to retrieve data from a chart that we couldn\u2019t have otherwise accessed. Turns out what they say is true: If you can see it, you can scrape it!", "Thanks for reading! Please feel free to leave any comments for any insights you may have. The full Jupyter Notebook which contains the source code I used to do this project can be found on my Github repository.", "Disclaimer: All views expressed in this article are my own, and are not in any way associated with Vanguard or any other financial entity. I am not a trader and am not making any money from the methods used in this article. This is not financial advice.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9b2cc7ddf31f&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nathanwthomas?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nathanwthomas?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": "Nathan Thomas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fecf3c9fa298d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&user=Nathan+Thomas&userId=ecf3c9fa298d&source=post_page-ecf3c9fa298d----9b2cc7ddf31f---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b2cc7ddf31f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b2cc7ddf31f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.tomtom.com/en_gb/traffic-index/milan-traffic/", "anchor_text": "TomTom."}, {"url": "https://api.midway.tomtom.com/ranking/live/ITA_milan", "anchor_text": "https://api.midway.tomtom.com/ranking/live/ITA_milan"}, {"url": "https://api.midway.tomtom.com/ranking/live/ITA_milan", "anchor_text": "https://api.midway.tomtom.com/ranking/live/ITA_milan"}, {"url": "https://github.com/nathanwilthomas/tomtom_live_traffic_scrape", "anchor_text": "Github repository."}, {"url": "https://www.tomtom.com/en_gb/traffic-index/milan-traffic/", "anchor_text": "https://www.tomtom.com/en_gb/traffic-index/milan-traffic/"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9b2cc7ddf31f---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data-visualization?source=post_page-----9b2cc7ddf31f---------------data_visualization-----------------", "anchor_text": "Data Visualization"}, {"url": "https://medium.com/tag/coronavirus?source=post_page-----9b2cc7ddf31f---------------coronavirus-----------------", "anchor_text": "Coronavirus"}, {"url": "https://medium.com/tag/web-scraping?source=post_page-----9b2cc7ddf31f---------------web_scraping-----------------", "anchor_text": "Web Scraping"}, {"url": "https://medium.com/tag/python?source=post_page-----9b2cc7ddf31f---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b2cc7ddf31f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&user=Nathan+Thomas&userId=ecf3c9fa298d&source=-----9b2cc7ddf31f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9b2cc7ddf31f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&user=Nathan+Thomas&userId=ecf3c9fa298d&source=-----9b2cc7ddf31f---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9b2cc7ddf31f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9b2cc7ddf31f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9b2cc7ddf31f---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9b2cc7ddf31f--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nathanwthomas?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nathanwthomas?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nathan Thomas"}, {"url": "https://medium.com/@nathanwthomas/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "83 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fecf3c9fa298d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&user=Nathan+Thomas&userId=ecf3c9fa298d&source=post_page-ecf3c9fa298d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F52e24c772819&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fscraping-live-traffic-data-in-3-lines-of-code-step-by-step-9b2cc7ddf31f&newsletterV3=ecf3c9fa298d&newsletterV3Id=52e24c772819&user=Nathan+Thomas&userId=ecf3c9fa298d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}