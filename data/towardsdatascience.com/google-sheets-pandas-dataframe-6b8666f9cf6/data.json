{"url": "https://towardsdatascience.com/google-sheets-pandas-dataframe-6b8666f9cf6", "time": 1683012178.3987148, "path": "towardsdatascience.com/google-sheets-pandas-dataframe-6b8666f9cf6/", "webpage": {"metadata": {"title": "Google Sheets, Meet Pandas DataFrame | by Nicholas Ballard | Towards Data Science", "h1": "Google Sheets, Meet Pandas DataFrame", "description": "Maybe it\u2019s from too many hours behind the keyboard. But sometimes my reading and watching on the internet gives me the feeling I\u2019m one of an endangered species of developer. One who\u2019s working inside\u2026"}, "outgoing_paragraph_urls": [{"url": "https://console.cloud.google.com/", "anchor_text": "console.cloud.google.com/", "paragraph_index": 9}, {"url": "https://docs.google.com/spreadsheets/d/11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA/edit?usp=sharing", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://developers.google.com/sheets/api/", "anchor_text": "Sheets", "paragraph_index": 20}, {"url": "https://developers.google.com/sheets/api/quickstart/python", "anchor_text": "Python library", "paragraph_index": 20}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.htmlhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html", "anchor_text": "DataFrames", "paragraph_index": 25}, {"url": "https://github.com/asweigart/ezsheets", "anchor_text": "EZSheets", "paragraph_index": 28}, {"url": "https://github.com/burnash/gspread/blob/master/docs/index.rst", "anchor_text": "gspread", "paragraph_index": 30}, {"url": "https://gspread.readthedocs.io/en/latest/", "anchor_text": "documentation", "paragraph_index": 31}, {"url": "https://github.com/robin900/gspread-dataframe", "anchor_text": "gspread-dataframe", "paragraph_index": 32}, {"url": "https://pythonhosted.org/gspread-dataframe/", "anchor_text": "documentation", "paragraph_index": 33}, {"url": "https://docs.google.com/spreadsheets/d/11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA/edit?usp=sharing", "anchor_text": "Google Sheet", "paragraph_index": 54}], "all_paragraphs": ["Maybe it\u2019s from too many hours behind the keyboard. But sometimes my reading and watching on the internet gives me the feeling I\u2019m one of an endangered species of developer. One who\u2019s working inside spreadsheets. Every single day.", "Can you believe it? Developers, going about their lives like spreadsheets don\u2019t exist. If you are one of these people, I\u2019d like to meet you. To know that you exist, and this isn\u2019t all a paranoid rant raging between my ears.", "For the rest of us, spreadsheets are very much a thing. Love them or hate them, those binary rows and columns are going nowhere. To cut the philosophy lesson short: spreadsheets are. Every non-developer employee save the cleaning staff lives inside spreadsheets.", "\u201cSpreadsheets are.\u201d Submit this existential bombshell to a university; an honorary doctorate in philosophy is sure to follow.", "Excel and Google Sheets, they\u2019re going nowhere; neither is our productivity until we put automation between us and the knowledge worker ritual of passing the spreadsheet.", "Personally, I love a good spreadsheet. For munging data, quick and dirty calculations, visualizing 1-dimensional times series\u2026 4 out of 5 times I will open Excel or Google Sheets, rather than fire up a Jupyter server.", "Except, spreadsheetitis in a business is a symptom of not knowing how to move data. I have personally seen the \u201chuman router\u201d problem so bad where more than 20 (twenty!) people touched a version of a spreadsheet before it was finally\u2013mercifully\u2013put to rest in \u201cthe database\u201d (another spreadsheet).", "And THE Spreadsheet. You know the business is in data hell when there\u2019s The Spreadsheet, with a capital \u201cS\u201d. The one managers think is the business.", "There\u2019s a few libraries we will talk about using for Google Sheets I/O in Python. No matter the approach, you have to enable the Google Sheets API inside the maze-like console for Google Cloud Platform (Google\u2019s version of AWS and Azure). Fortunately Google\u2013go figure\u2013has a great search feature in the console that we\u2019ll use to get you set up.", "Go to console.cloud.google.com/, sign in with the Google account with access to the spreadsheet you want to automate. The API is available for both GSuite and free Google accounts. If it\u2019s a work-owned spreadsheet, the admin with GCP access is going to have to follow these steps and give you the credentials file.", "Select the project in the navbar on the top. Every resource is kept inside a project, like resource groups in Azure. If you do not have one yet, select the project dropdown and \u201cNEW PROJECT\u201d. Then search for \u201cGoogle Sheets API\u201d, which if you are a sadist and want to explore the dashboard by mouse, is under \u201cAPIs & Services\u201d.", "Now you need to do the same for Google Drive API.", "Next up, you need to create a service account, which you will then create credentials for.", "Now you are back on the \u201cService accounts for project [PROJECT NAME]\u201d screen. Select the service account in the table, either clicking on the hyperlinked Email field, or hamburger menu (three dots) > Create key.", "Either way, ADD KEY or Create key, select JSON key type and CREATE. This downloads a JSON file to your computer.", "Last thing: the spreadsheet. Here I created one for this example. Note the highlighted section of the URL in the Omnibar. That is the document\u2019s ID. Most libraries give the choice of referencing the whole URL or just this ID.", "You can take a look at and download the spreadsheet from here.", "Open the credentials.json file you downloaded from GCP for the service account. Copy the email value in the client_email property. Share the Google Sheet with this email. This gives the service account access to the spreadsheet, which was created on another account (not the service account).", "Phew. That\u2019s all the Google infrastructure stuff. I promise.", "Now we can get down to business writing Python code.", "Google has an API for Sheets, like it does for all Google Drive products. There is nothing you cannot do with its Python library.", "Still you would be mad to use it.", "My hard line on spreadsheets is they are a portable, visual way to deliver data to business users. A rectangle of data, cell A1 on the top left. Not to play Bob Ross\ud83c\udfa8\ud83d\udd8c with conditional formatting, islands of data in the same worksheet forming archipelagos, or creating a Tableau-like dashboard of charts.", "Not to say all those things aren\u2019t great. I\u2019ve went down those rabbit holes with spreadsheet automation many times. It\u2019s just, the payoff-to-time-spent-coding ratio falls off a cliff pretty fast when you dive into all the features Google Sheets built in over the years.", "This article is about data in, data out. Fastest time to solution wins.", "On the Python data side, that means using pandas DataFrames. On the Google Sheets connector side, it\u2019s more up in the air. Time to go shopping on GitHub.", "For that, here are three of my favorite third party Python libraries wrapping the Google Sheets API:", "Al Sweigart can do no wrong. His book Automate the Boring Stuff With Python singlehandedly taught me how to code for money. I still reference it a few times a month.", "Sweigart is this giant brain with a talent for taking the complex and breaking it down into baby food I can digest. EZSheets (GitHub) is his creation, along with sibling interfaces for Gmail, Calendar, and Drive.", "EZSheets shines with its clear methods for updating a selection of data all at once. Also, for selecting columns and rows. I haven\u2019t found another library that captures the complexity of iterating over cells quite like this one. Other libraries are no better than the Sheets API, where the nested for loops for processing data give me vertigo.", "gspread (GitHub) is a library by another brain, Anton Burnashev. gspread is popular to the point of being the de facto library for Python developers wanting to work with Google Sheets.", "And with good reason. The documentation is great, the source code is clear with a sensible layout and good docstrings. Plus, gspread\u2019s interface wraps some Google Sheets formatting functionality. It also has methods for working with pandas and NumPy arrays.", "A wrapper for the gspread library built by Robin Thomas, gspread-dataframe (GitHub) is my go-to package for reading and writing Google Sheets with DataFrames.", "The documentation is good, but somewhat unnecessary. The source code is brief, with two functions, get_as_dataframe and set_with_dataframe.", "gspread-dataframe is what we will be using for this tutorial.", "Scenario: We have a table of data about for an ongoing movie night. Coworkers need to add values to a column manually on a daily basis. As we schedule new movie nights, we need to collect the handwritten data entered in the sheet, as well as add new movies to the top.", "This example is fiction, but I have had multiple clients that were medium size tech companies request just this feature. You can imagine there is a database with tables like movies and movienights, and there's a view function joining those into this one table that the coordinators of the movie night help fill out.", "Short of a full-blown web app or form software, using a spreadsheet as the presentation and data entry layers is actually quite convenient.", "Bonus: With pandas 1.1.0, we can generate a markdown table without index from a method on the DataFrame!", "First install gspread_dataframe. Since it is a wrapper for gspread, we will need that library and its oauth2client dependency.", "Check you can connect to the sheet:", "If you have a problem connecting, read the Exception thrown by gspread, it's pretty informative. Remember, the downloaded keys for the JSON file has a client_email. That email needs the sheet shared with it. The OAuth library needs access to the credentials.json at the right file path. Remember to rename the file to credentials.json.", "Now to write to Google Sheets.", "Options for set_as_dataframe (credit Robin Thomas, gspread-dataframe.py):", "Nice! (I love seeing computers perform drudgery. Means it\u2019s saving me work. \ud83d\ude04) Notice how the resize=True option makes the worksheet fit the DataFrame shape.", "Could be better though. Will make a few tweaks to the DataFrame before writing to the sheet. The dates are formatted as datetime. Also, let\u2019s use the power of cell formulas to neaten up the IMDB links.", "Much cleaner. And now, the Movie column has working hyperlinks!", "As new movies nights are inserted into the database, the scheduler running the Python script updates the sheet:", "The movie night secretary counts heads, reads the crowd, and writes comments on the event. Things people still do better than machines.", "Now for Python to slurp it up. To upsert into a database, save in an S3 bucket, file system, or somewhere.", "For this we use the other function provided by gspread_dataframe: get_as_dataframe.", "Options for set_as_dataframe (again, credit Robin Thomas, gspread-dataframe.py):", "Spreadsheets are a powerful tool. And with amazing wrappers around the Google Sheets API like EZSheets, gspread and gspread_dataframe, a lot of the work managing them with Python is done for you.", "Instead of getting in the way of business automation, using spreadsheets as part of the toolchain with Python\u2026 it\u2019s saves us a lot of time and unfun work. Best of all, it stops the ritual of \u201cpassing the spreadsheet\u201d. It is a wonderful thing!", "Here\u2019s the link again to the Google Sheet used in this article.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Engineer by day. Engineer, Software by night."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6b8666f9cf6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nball?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nball?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": "Nicholas Ballard"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F441042f5df53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&user=Nicholas+Ballard&userId=441042f5df53&source=post_page-441042f5df53----6b8666f9cf6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b8666f9cf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b8666f9cf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@mbaumi?utm_source=medium&utm_medium=referral", "anchor_text": "Mika Baumeister"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://console.cloud.google.com/", "anchor_text": "console.cloud.google.com/"}, {"url": "https://docs.google.com/spreadsheets/d/11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA/edit?usp=sharing", "anchor_text": "here"}, {"url": "https://developers.google.com/sheets/api/", "anchor_text": "Sheets"}, {"url": "https://developers.google.com/sheets/api/quickstart/python", "anchor_text": "Python library"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.htmlhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html", "anchor_text": "DataFrames"}, {"url": "https://github.com/asweigart/ezsheets", "anchor_text": "EZSheets"}, {"url": "https://github.com/burnash/gspread/blob/master/docs/index.rst", "anchor_text": "gspread"}, {"url": "https://gspread.readthedocs.io/en/latest/", "anchor_text": "documentation"}, {"url": "https://github.com/robin900/gspread-dataframe", "anchor_text": "gspread-dataframe"}, {"url": "https://pythonhosted.org/gspread-dataframe/", "anchor_text": "documentation"}, {"url": "https://docs.google.com/spreadsheets/d/11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA/edit?usp=sharing", "anchor_text": "Google Sheet"}, {"url": "https://medium.com/tag/google-sheets?source=post_page-----6b8666f9cf6---------------google_sheets-----------------", "anchor_text": "Google Sheets"}, {"url": "https://medium.com/tag/google-drive-api?source=post_page-----6b8666f9cf6---------------google_drive_api-----------------", "anchor_text": "Google Drive Api"}, {"url": "https://medium.com/tag/python-programming?source=post_page-----6b8666f9cf6---------------python_programming-----------------", "anchor_text": "Python Programming"}, {"url": "https://medium.com/tag/google-cloud-platform?source=post_page-----6b8666f9cf6---------------google_cloud_platform-----------------", "anchor_text": "Google Cloud Platform"}, {"url": "https://medium.com/tag/python-libraries?source=post_page-----6b8666f9cf6---------------python_libraries-----------------", "anchor_text": "Python Libraries"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b8666f9cf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&user=Nicholas+Ballard&userId=441042f5df53&source=-----6b8666f9cf6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6b8666f9cf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&user=Nicholas+Ballard&userId=441042f5df53&source=-----6b8666f9cf6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6b8666f9cf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6b8666f9cf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6b8666f9cf6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6b8666f9cf6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nball?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nball?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nicholas Ballard"}, {"url": "https://medium.com/@nball/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "90 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F441042f5df53&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&user=Nicholas+Ballard&userId=441042f5df53&source=post_page-441042f5df53--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4c9426650cb6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgoogle-sheets-pandas-dataframe-6b8666f9cf6&newsletterV3=441042f5df53&newsletterV3Id=4c9426650cb6&user=Nicholas+Ballard&userId=441042f5df53&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}