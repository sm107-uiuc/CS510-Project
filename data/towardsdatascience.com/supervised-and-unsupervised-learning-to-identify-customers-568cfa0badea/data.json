{"url": "https://towardsdatascience.com/supervised-and-unsupervised-learning-to-identify-customers-568cfa0badea", "time": 1683006189.725585, "path": "towardsdatascience.com/supervised-and-unsupervised-learning-to-identify-customers-568cfa0badea/", "webpage": {"metadata": {"title": "Supervised and Unsupervised Learning to Identify Customers | by Caro Negrelli | Towards Data Science", "h1": "Supervised and Unsupervised Learning to Identify Customers", "description": "Welcome to my final project for Udacity\u2019s Data Scientist Nanodegree. I\u2019m going through a career change, moving from academia (I have a Ph.D. in Astrophysics) to industry, and this Nanodegree is one\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.udacity.com/", "anchor_text": "Udacity\u2019s", "paragraph_index": 0}, {"url": "https://github.com/cnegrelli/Arvato_identify_customers", "anchor_text": "link", "paragraph_index": 1}, {"url": "https://chrisalbon.com/machine_learning/feature_selection/drop_highly_correlated_features/", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://www.kaggle.com/c/udacity-arvato-identify-customers/leaderboard#score", "anchor_text": "Kaggle competition", "paragraph_index": 47}], "all_paragraphs": ["Welcome to my final project for Udacity\u2019s Data Scientist Nanodegree. I\u2019m going through a career change, moving from academia (I have a Ph.D. in Astrophysics) to industry, and this Nanodegree is one of the steps I\u2019m taking in that direction.", "I choose this project because involves two different types of machine learning algorithm applied to the same data. Also, because it is a very common problem for industries of all types. The data and outline of this project were provided by Arvato Financial Solutions, a Bertelsmann subsidiary. All the work done is in this link.", "We want to identify new customers for a mail-order sales company in Germany making use of Unsupervised and Supervised Machine Learning Techniques and demographic data.", "The data includes 4 data sets:", "The demographic columns don\u2019t have intuitive names and this difficulty the analysis but we can obtain the meaning of each column from the metadata provided by Arvato.", "I had to do a lot of wrangling in the data:", "We are not using this data.", "The data contains a lot of missing values but some of them are coded. I had to look very carefully the metadata to find out that:", "I had to convert all these values to NaNs.", "3. Delete columns with a lot of missing values.", "In the following plot I show the columns with more missing values:", "There are 6 columns with more than 50% of missing values. We drop those columns.", "4. Delete rows with a lot of missing values.", "In the following plot I show the counts of row according to the percentage of missing data:", "Most of the rows have less than 10% of missing data, we keep only those rows.", "5. Convert object columns to numeric.", "Since most of the data is categorical, I chose to fill the missing values with the mode by column. In order to do these I implemented a Imputer().", "Following the steps here I drop columns with a correlation bigger than 0.95 in the AZDIAS and CUSTOMERS data frames.", "The id column called LNR is not an interesting feature for the models.", "Steps 2\u20138 were implemented in a function called clean_data().", "We need to scale the date to obtain accurate performances of the machine learning models. I used the StandardScaler() which standardize features by removing the mean and scaling to unit variance.", "In this part of the project we perform unsupervised clustering to identify customer segments.", "After the wrangling we ended with 425 columns. Since this number is really big, we perform a principal component analysis on the AZDIAS data set with the goal of reducing the dimensionality.", "I decided to keep 170 components which account for around 80% of the cumulative explained variance.", "I performed a K-means clustering. First I took only a sample of the data to fit the algorithm with different amounts of clusters. I show the result in the following plot:", "Following the elbow method I chose to keep 16 clusters (I could also choose 7 clusters, but I decided to go with 16).", "Then I fitted the K-means algorithm with the AZDIAS data set and predicted the cluster number for each row.", "I applied the fitted PCA with 170 features and the fitted K-means with 16 clusters to the CUSTOMERS data to obtain the predicted cluster number for each row.", "In order to identify customer segments we have to compare the clusters:", "It\u2019s clear that the customer sub-population is represented by the clusters 10, 12 and 2 principally. People in these three clusters are the company\u2019s target. Which Principal components (PC) are associated with these clusters? And which ones with the most underrepresented (13, 5, 6, 8)?", "We can take a look at the values of the firsts principal components for these 7 clusters identified as overrepresented (blue) and underrepresented (green).", "It\u2019s really difficult to do an exhaustive analysis of the situation but there is one clear conclusion:", "For the PC # 0 all the underrepresented clusters have a value less than 1 and the overrepresented have a bigger value. Almost the opposite happens for the PC # 1.", "As an example let\u2019s see what kind of values for the column MOBI_REGIO are related with a PC#0>1 (clients) and ones with PC#0<1 (non-clients):", "In general, we can associate positive values with clients and negative values with no clients. Since all these features are scaled to mean=0 the this means values above and under the mean. The MOBI_REGIO column is related to mobility, high values indicate low mobility. So, people with low mobility are our target.", "After repeating this proceeding for the other 9 columns I found out that:", "Conclusion \u2014 We are looking for people with high income, high social status, low mobility and a neighborhood with houses of 1\u20132 families.", "In this part of the project we train a classificator to predict the likelihood that the people in the test data set respond to the campaign.", "3. Scale the features with a StandardScaler()", "4. Train different simple models to see how they perform.", "I trained 5 models and computed the roc_auc. I used this metric due to the imbalance in the data (and also because it is the metric used in the Kaggle competition to test my results).", "Due to the resulting metrics I chose to keep the Gradient Boosting algorithm.", "5. Look for the best parameters", "I scanned the following parameter space using GridSearchCV.", "6. Predict labels for the test data.", "First I had to clean the test data. I used the clean_data function with the option of no deleting rows and I also saved the id column because I needed it for step 7.", "I predicted the probabilities for the labels (since we are using roc_auc we are not interested in the exact values) with the predict_proba method of the fitted best model.", "7. Upload results to the Kaggle competition", "I obtained a score of 0.77698 and the 91st place at the time of submission.", "I liked the project because it had a lot of things to explore. The data wrangling step was really long and the fact that the columns don\u2019t have an intuitive name makes all more difficult. Luckily, most of the features were numeric which simplifies things.", "The unsupervised model was easy to implement but required a lot of work to understand the results. Reach an exhaustive conclusion is difficult but I\u2019m happy with the conclusion that I reached: We are looking for people with high income, high social status, low mobility and a neighborhood with houses of 1\u20132 families.", "The supervised model was more difficult, I had to test different models and look for the best parameters. After upload my results to Kaggle I obtained a score of 0.77698. I\u2019m happy with that result but I know there is room for improvement.", "What can I do to improve the model?- Engineer some features: as an example, I could convert the year variable to buckets- Fill NaNs with mean or some other technique- Test more classifiers or a bigger parameter space", "Do you have any other ideas?", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data analyst with a Ph.D. in Astrophysics. I\u2019m from Argentina but I\u2019m living in Rochester, NY. Looking for a job here or remote. GitHub: cnegrelli"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F568cfa0badea&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----568cfa0badea--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----568cfa0badea--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@caro.negrelli?source=post_page-----568cfa0badea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@caro.negrelli?source=post_page-----568cfa0badea--------------------------------", "anchor_text": "Caro Negrelli"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1158f4842d91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&user=Caro+Negrelli&userId=1158f4842d91&source=post_page-1158f4842d91----568cfa0badea---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F568cfa0badea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F568cfa0badea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ray30?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "ray rui"}, {"url": "https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.udacity.com/", "anchor_text": "Udacity\u2019s"}, {"url": "https://github.com/cnegrelli/Arvato_identify_customers", "anchor_text": "link"}, {"url": "https://chrisalbon.com/machine_learning/feature_selection/drop_highly_correlated_features/", "anchor_text": "here"}, {"url": "https://www.kaggle.com/c/udacity-arvato-identify-customers/leaderboard#score", "anchor_text": "Kaggle competition"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----568cfa0badea---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/clustering?source=post_page-----568cfa0badea---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/classification?source=post_page-----568cfa0badea---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/customer-segmentation?source=post_page-----568cfa0badea---------------customer_segmentation-----------------", "anchor_text": "Customer Segmentation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F568cfa0badea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&user=Caro+Negrelli&userId=1158f4842d91&source=-----568cfa0badea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F568cfa0badea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&user=Caro+Negrelli&userId=1158f4842d91&source=-----568cfa0badea---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F568cfa0badea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----568cfa0badea--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F568cfa0badea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----568cfa0badea---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----568cfa0badea--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----568cfa0badea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----568cfa0badea--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----568cfa0badea--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----568cfa0badea--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----568cfa0badea--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----568cfa0badea--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----568cfa0badea--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@caro.negrelli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@caro.negrelli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Caro Negrelli"}, {"url": "https://medium.com/@caro.negrelli/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "49 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1158f4842d91&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&user=Caro+Negrelli&userId=1158f4842d91&source=post_page-1158f4842d91--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F1158f4842d91%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsupervised-and-unsupervised-learning-to-identify-customers-568cfa0badea&user=Caro+Negrelli&userId=1158f4842d91&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}