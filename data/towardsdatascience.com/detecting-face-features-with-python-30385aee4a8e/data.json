{"url": "https://towardsdatascience.com/detecting-face-features-with-python-30385aee4a8e", "time": 1683010303.770805, "path": "towardsdatascience.com/detecting-face-features-with-python-30385aee4a8e/", "webpage": {"metadata": {"title": "Detecting Face Features with Python | by Juan Cruz Martinez | Towards Data Science", "h1": "Detecting Face Features with Python", "description": "Today we are going to learn how to work with images to detect faces and to extract facial features such as the eyes, nose, mouth, etc. There\u2019s a number of incredible things we can do this information\u2026"}, "outgoing_paragraph_urls": [{"url": "http://dlib.net/", "anchor_text": "Dlib", "paragraph_index": 2}, {"url": "https://github.com/italojs/facial-landmarks-recognition/blob/master/shape_predictor_68_face_landmarks.dat", "anchor_text": "here", "paragraph_index": 24}, {"url": "https://livecodestream.dev", "anchor_text": "https://livecodestream.dev", "paragraph_index": 38}], "all_paragraphs": ["Today we are going to learn how to work with images to detect faces and to extract facial features such as the eyes, nose, mouth, etc. There\u2019s a number of incredible things we can do this information as a pre-processing step like capture faces for tagging people in photos (manually or through machine learning), create effects to \u201cenhance\u201d our images (similar to those in apps like Snapchat), do sentiment analysis on faces and much more.", "In the past, we have covered before how to work with OpenCV to detect shapes in images, but today we will take it to a new level by introducing DLib, and abstracting face features from an image.", "Dlib is an advanced machine learning library that was created to solve complex real-world problems. This library has been created using the C++ programming language and it works with C/C++, Python, and Java.", "It worth noting that this tutorial might require some previous understanding of the OpenCV library such as how to deal with images, open the camera, image processing, and some little techniques.", "Our face has several features that can be identified, like our eyes, mouth, nose, etc. When we use DLib algorithms to detect these features we actually get a map of points that surround each feature.", "This map composed of 67 points (called landmark points) can identify the following features:", "Now that we know a bit about how we plan to extract the features, let\u2019s start coding.", "As usual, this article will present examples with code, and I\u2019ll guide you step by step to implement a fully working example of face feature recognition. But before we get started you need to start a new Python project and install 3 different libraries:", "If you use pipenv like I do, you can install all of them with the following command:", "If you are working on Mac, and some versions of Linux you may have some problems installing dlib, if you get compiling errors during the installation make sure you check the CMake library version you are using. In Mac to make sure you have CMake available and with the right version you can run:", "For other OS, check online for specific support.", "We will start small and build on the code until we have a fully working example.", "Normally I like to use plots to render the images, but since we have something cool prepared for later in the post, we will do something different, and we will create a window where we are going to show the results of our work.", "Pretty simple, right? We are just loading the image with imread, and then telling OpenCV to show the image in a winname, this will open the window and give it a title.", "After that, we need to pause execution, as the window will be destroyed when the script stops, so we use cv2.waitKey to hold the window until a key is pressed, and after that, we destroy the window and exit the script.", "If you use the code and added an image named face.jpg to the code directory, you should get something like the following:", "So far we haven\u2019t done anything with the image other than presenting it into a window, pretty boring, but now we will start coding the good stuff, and we will start by identifying where in the image there is a face.", "For this, we will use Dlib function called get_frontal_face_detector(), pretty intuitive. There is a caveat though, this function will only work with grayscale images, so we will have to do that first with OpenCV.", "The get_frontal_face_detector() will return a detector that is a function we can use to retrieve the faces information. Each face is an object that contains the points where the image can be found.", "But let\u2019s better see it on the code:", "The code above will retrieve all the faces from the image and render a rectangle over each face, resulting in an image like the following:", "So far we did pretty well at finding the face, but we still need some work to extract all the features (landmarks). Let\u2019s work on that next.", "Do you love magic? So far DLib has been pretty magical in the way it works, with just a few lines of code we could achieve a lot, and now we have a whole new problem, would it continue to be as easy?", "The short answer is YES! Turns out DLib offers a function called shape_predictor() that will do all the magic for us but with a caveat, it needs a pre-trained model to work.", "There are several models out there that work with shape_predictor, the one I\u2019m using can be downloaded here, but feel free to try others.", "Let\u2019s see how the new code looks like now", "Like before, we are always building on the same code, now using our predictor function for each face to find the landmarks. Now I\u2019m still doing something strange, like what\u2019s the number 27 doing there?", "Our predictor function will return an object that contains all the 68 points that conform a face according to the diagram we saw before, and if you pay attention to it, the point 27 is exactly between the eyes, so if all worked out correctly you should see a green dot between the eyes in the face like in here:", "We are getting really close, let\u2019s now render all the points instead of just the one:", "But what if you are not interested in all the points? well\u2026 you can actually adjust your range intervals to get any feature specified in the glossary above, as I did here:", "Amazing, but can we do something even cooler?", "Yes, you read it right! And yes it\u2019s probably what you are thinking! The next step is to hook up our webcam and do real-time landmark recognition from your video stream.", "You can do real-time facial landmarks detection on your face by iterating through video frames with your camera or use a video file. Refer to the code below if you want to use your own camera but for video file make sure to change the number 0 to video path.", "If you want to end the window press ESC key on your keyboard:", "And the final result is here:", "Even in cases with low light conditions the results were pretty accurate, though there are some errors in the image above, with better lighting works perfectly.", "OpenCV and DLib are powerful libraries that simplify working with ML and computer vision. Today we just touch down on the very basics, and there\u2019s much more to learn from both of them.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I help people learn tech skills so they can level up their life. Founder of https://livecodestream.dev, content creator, and Oktanaut!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F30385aee4a8e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://bajcmartinez.medium.com/?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": ""}, {"url": "https://bajcmartinez.medium.com/?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": "Juan Cruz Martinez"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46b6f430560f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&user=Juan+Cruz+Martinez&userId=46b6f430560f&source=post_page-46b6f430560f----30385aee4a8e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F30385aee4a8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F30385aee4a8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/essential-opencv-functions-to-get-you-started-into-computer-vision-743df932e60", "anchor_text": "Essential OpenCV Functions to Get You Started into Computer VisionLearn about common OpenCV functions, and their applications to get you started into Computer Vision.towardsdatascience.com"}, {"url": "http://dlib.net/", "anchor_text": "Dlib"}, {"url": "https://github.com/italojs/facial-landmarks-recognition/blob/master/shape_predictor_68_face_landmarks.dat", "anchor_text": "here"}, {"url": "https://medium.com/tag/python?source=post_page-----30385aee4a8e---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----30385aee4a8e---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----30385aee4a8e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----30385aee4a8e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----30385aee4a8e---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F30385aee4a8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&user=Juan+Cruz+Martinez&userId=46b6f430560f&source=-----30385aee4a8e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F30385aee4a8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&user=Juan+Cruz+Martinez&userId=46b6f430560f&source=-----30385aee4a8e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F30385aee4a8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F30385aee4a8e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----30385aee4a8e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----30385aee4a8e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----30385aee4a8e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----30385aee4a8e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----30385aee4a8e--------------------------------", "anchor_text": ""}, {"url": "https://bajcmartinez.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://bajcmartinez.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Juan Cruz Martinez"}, {"url": "https://bajcmartinez.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.7K Followers"}, {"url": "https://livecodestream.dev", "anchor_text": "https://livecodestream.dev"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46b6f430560f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&user=Juan+Cruz+Martinez&userId=46b6f430560f&source=post_page-46b6f430560f--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F22c096860c66&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdetecting-face-features-with-python-30385aee4a8e&newsletterV3=46b6f430560f&newsletterV3Id=22c096860c66&user=Juan+Cruz+Martinez&userId=46b6f430560f&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}