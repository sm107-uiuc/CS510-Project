{"url": "https://towardsdatascience.com/why-not-to-select-features-before-splitting-your-data-2d6aba2e9fb", "time": 1682996984.683799, "path": "towardsdatascience.com/why-not-to-select-features-before-splitting-your-data-2d6aba2e9fb/", "webpage": {"metadata": {"title": "Why NOT to select features before splitting your data | by Krishna Rao | Towards Data Science", "h1": "Why NOT to select features before splitting your data", "description": "Picture this: A Stanford Ph.D. student was trying to predict the occurrence of a rare heart disease using gene data. The student collected more than 100,000 gene expression data (predictors) for 50\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/swlh/machine-learning-with-one-line-of-code-85974fee247e", "anchor_text": "single line of code", "paragraph_index": 3}, {"url": "https://www.pnas.org/content/99/10/6562.full", "anchor_text": "article", "paragraph_index": 4}, {"url": "https://gist.github.com/kkraoj/94ec4653a96bad5127affedbf61658e4", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://www.youtube.com/watch?v=S06JpVoNaA0", "anchor_text": "video", "paragraph_index": 9}, {"url": "http://krishnakrao.github.io", "anchor_text": "krishnakrao.github.io", "paragraph_index": 11}], "all_paragraphs": ["Picture this: A Stanford Ph.D. student was trying to predict the occurrence of a rare heart disease using gene data. The student collected more than 100,000 gene expression data (predictors) for 50 patients. The student then picked the best 100 predictors among the 100,000 as part of \u201cinitial screening\u201d, fit a statistical model to only the 100 screened predictors using cross-validation and reported an accuracy of over 65% (which is a big deal for rare heart diseases). Sounds fine?", "This student contributed to a recent dangerous trend in applied statistics in (mis)using cross-validation to present a highly biased, cherry-picked result of their study. It is important to understand not just where the student went wrong, but why they fell into this trap too. In reality, they have \u201cpeeked\u201d into their validation set without even realizing it.", "In this article you will learn to-", "With the explosion of machine learning in practically every field that gathers data, people have increasingly found ways to quickly train and deploy off-the-shelf models without fully understanding the algorithms that underlie them. The latest trend in making machine learning libraries \u201ceasy\u201d to implement with just a single line of code has only added to the problem. Because of these shortcuts, every now and then, we come across an example of what can go wrong, such as the case with the Stanford student.", "That student was not alone- wrongly estimated cross-validated errors occasionally creep up in several high profile academic journals as well. In-fact a whole article was dedicated to documenting such instances of selection bias in the Proceedings of the National Academy of Sciences. So, let\u2019s look at precisely what went wrong in the above example.", "In the above example, the student used all of the examples (patients) to screen the predictors instead of restricting themselves only to the training folds. Since they were working with a wide dataset \u2014 number of features (genes) >> number of examples (patients) \u2014 performing feature selection to narrow down to a subset of genes was a natural choice. This is in fact also a valuable step to prevent the model from over-fitting. But quite often, the screening is performed in the early stages of the project leading people to forget about it by the time they are modeling using cross-validation. If we use all of our examples to select our predictors (Fig. 1), the model has \u201cpeeked\u201d into the validation set even before predicting on it. Thus, the cross validation accuracy was bound to be much higher than the true model accuracy.", "Below is a working example of the cross-validation trap where we obtain 99% accuracy in predicting something which is truly random like a coin flip! The complete R notebook is also available here.", "On the other-hand, if we run the same model as above, but use only the training folds to screen the predictors, we will have a much better representation of the true error of the model. This correct way of slicing the data is shown in Fig. 2. In this case, the same model has a cross-validation accuracy of 46%, or in other words, the model is right less than half of the time in predicting a coin flip.", "In this article, we learnt to perform feature screening the right way and not fall for the cross-validation trap . To review, remember to-", "And as for that Stanford student who grossly overestimated their model\u2019s accuracy for predicting heart diseases? The student fortunately ran into Rob Tibshirani (my professor) before making any of their mistakes public and mislead the medical society. If you want to hear about it from Rob himself, here is his video.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Earth Scientist & Bicycle Traveler | krishnakrao.github.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2d6aba2e9fb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://kkrao.medium.com/?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": ""}, {"url": "https://kkrao.medium.com/?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": "Krishna Rao"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F110a69a850da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&user=Krishna+Rao&userId=110a69a850da&source=post_page-110a69a850da----2d6aba2e9fb---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d6aba2e9fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d6aba2e9fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/swlh/machine-learning-with-one-line-of-code-85974fee247e", "anchor_text": "single line of code"}, {"url": "https://www.pnas.org/content/99/10/6562.full", "anchor_text": "article"}, {"url": "https://gist.github.com/kkraoj/94ec4653a96bad5127affedbf61658e4", "anchor_text": "here"}, {"url": "https://www.youtube.com/watch?v=S06JpVoNaA0", "anchor_text": "video"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----2d6aba2e9fb---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----2d6aba2e9fb---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/statistics?source=post_page-----2d6aba2e9fb---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----2d6aba2e9fb---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/stanford?source=post_page-----2d6aba2e9fb---------------stanford-----------------", "anchor_text": "Stanford"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2d6aba2e9fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&user=Krishna+Rao&userId=110a69a850da&source=-----2d6aba2e9fb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F2d6aba2e9fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&user=Krishna+Rao&userId=110a69a850da&source=-----2d6aba2e9fb---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d6aba2e9fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F2d6aba2e9fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----2d6aba2e9fb---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----2d6aba2e9fb--------------------------------", "anchor_text": ""}, {"url": "https://kkrao.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://kkrao.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Krishna Rao"}, {"url": "https://kkrao.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "522 Followers"}, {"url": "http://krishnakrao.github.io", "anchor_text": "krishnakrao.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F110a69a850da&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&user=Krishna+Rao&userId=110a69a850da&source=post_page-110a69a850da--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3e72f572b0fe&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhy-not-to-select-features-before-splitting-your-data-2d6aba2e9fb&newsletterV3=110a69a850da&newsletterV3Id=3e72f572b0fe&user=Krishna+Rao&userId=110a69a850da&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}