{"url": "https://towardsdatascience.com/doubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777", "time": 1683008694.0470898, "path": "towardsdatascience.com/doubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777/", "webpage": {"metadata": {"title": "Doubling Your Money with the Kelly Criterion and Bayesian Statistics | by Paul Tune | Towards Data Science", "h1": "Doubling Your Money with the Kelly Criterion and Bayesian Statistics", "description": "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Parimutuel_betting", "anchor_text": "parimutuel betting system", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Kelly_criterion", "anchor_text": "Wikipedia", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/Warren_Buffett", "anchor_text": "Warren Buffett", "paragraph_index": 16}, {"url": "https://en.wikipedia.org/wiki/Charlie_Munger", "anchor_text": "Charlie Munger", "paragraph_index": 16}, {"url": "https://github.com/ptuls/multiarm_kelly_portfolio", "anchor_text": "here", "paragraph_index": 23}, {"url": "https://www.docker.com/", "anchor_text": "Docker", "paragraph_index": 23}, {"url": "https://en.wikipedia.org/wiki/Dirichlet_distribution", "anchor_text": "Dirichlet distribution", "paragraph_index": 24}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "Monte Carlo simulations", "paragraph_index": 28}, {"url": "https://paultune.com/posts/kelly-bayesian", "anchor_text": "here", "paragraph_index": 30}, {"url": "https://www.amazon.com/Fortunes-Formula-Scientific-Betting-Casinos/dp/0809045990", "anchor_text": "link", "paragraph_index": 31}, {"url": "https://www.amazon.com/Dhandho-Investor-Low-risk-Method-Returns/dp/047004389X", "anchor_text": "link", "paragraph_index": 32}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Some time ago, when I was living in Adelaide, I was approached by clients who wanted to figure out how to allocate bets made in a horse racing, specifically for exotic bets such as the trinella (picking the top three horses in any order) and quinella (picking the top four horses in any order) bets.", "They wanted me to figure out a way to compute the Kelly criterion (see below) as a means to exponentially increase their pool of money over repeated bets. A huge complication is that it is a parimutuel betting system, so the odds for the horses updates even just right before the start of the race!", "Suffice to say I solved the problem, but am not at privy to disclose the solution as part of my consulting contract.", "In this post, however, I am going to discuss the Kelly criterion, and how to combine Bayesian statistics with it.", "Say you wanted to make a once-off bet with a friend by flipping a coin. Given that you have a pool of money M, then, to maximize your winnings, the optimal policy is that you should bet the entire stake of M. For a fair coin, the expected reward would be M/2.", "But what if you get to bet with your friend multiple times?", "We can easily see that the strategy used in a once-off bet does not apply here. If we were to bet the full amount each round, the chance of survival long enough to compound the initial pool of money would be very slim, so our expected reward would tend towards 0 as the number of bets increase. We can see that, at the very least, the main name of the game for repeated bets is survival, while thriving.", "What, then, is the optimal strategy in this case?", "The Kelly criterion, developed by John L. Kelly Jr. at Bell Labs, is a strategy for the optimal sizing of bets in the repeated bets scenario in his seminal paper\u00b9. Kelly himself was an interesting character: a chain smoking Texan who used to be a fighter pilot in the Navy during World War 2, he was also brilliant researcher. He developed the criterion as an alternative interpretation of information entropy, developed by his eminent colleague, Claude Shannon. You can learn about its history from the book, \u201cFortune\u2019s Formula\u201d\u00b2.", "Given an initial pool of wealth, the objective is to maximize the doubling rate of wealth as bets are being placed. The initial analysis on the case of horse racing in Kelly\u2019s paper assumed that the bettor fully invested her portfolio over all options; variations later existed where the bettor can withhold a portion of wealth. What is interesting is that it can be mathematically proven that (almost surely) no other strategy would beat the Kelly criterion in terms of higher wealth in the long run\u00b3.", "The long short of it is that the Kelly criterion\u2019s objective is to maximize the rate at which wealth doubles by allocating intelligently each time bets are being placed. Even if you know the odds are good, it\u2019s not a good idea to go all in, since there is a chance of loss.", "Let\u2019s consider repeated bets in the coin toss scenario. In this case, the Kelly criterion is simply (example taken from Wikipedia)", "I\u2019m not going to delve too much into the formula for this case in order to get to the good stuff below. You can find the derivation in standard textbooks like Thomas and Cover\u2019s classic text\u00b3.", "Now that we have built our intuition about the Kelly criterion, by contrasting the single bet case versus the repeated bets case, we can see clear differences:", "These in concert helps us maximize the rate at which our money M doubles (or doubling rate) each time.", "This has been applied to various games, including horse racing, and even stock market investing. In the latter, it has been said that Warren Buffett himself is a Kelly bettor\u2074 (although I would argue Charlie Munger is more of one than Buffett).", "However, the major difficulty in applying the criterion is that it assumes that the true probabilities of events occurring is known to the bettor. In the coin toss example above, the bettor knows what the value of p is, and she can size the bets accordingly.", "In reality, these are often unknown and the probabilities have to be estimated by the bettor. Unfortunately, any estimate is, by definition, likely to be wrong since it\u2019s just a guess. The criterion is sensitive to the estimated probabilities, and since the criterion maximizes the wealth doubling exponent, mistakes made in the estimated probabilities can easily ruin the bettor over time.", "Note that in my consulting gig, my clients have a system to estimate the probabilities of horses winning, so that made my job a lot simpler.", "If you don\u2019t have such a system though, this is where Bayesian updating comes in. The goal is simple: we want to approximate the probabilities of events occurring based on all available information. We constantly update the probabilities in light of new information, then use this information to size our bets. Over time as the estimation adapts, we expect our allocation to perform much better.", "For concreteness, let\u2019s cast the problem to the specific problem of betting on horses at a race track.", "Let us assume that there are K horses. In each round, we want to bet on a winning horse for that round, and once the round is over, the winner is one of the K horses. Based on that information, we would want to update a set of probabilities p\u2081\u200b, p\u2082\u200b, \u22ef, p\u2096\u200b, where p\u1d62\u200b is the probability that that horse i, over time to get closer and closer to the truth.", "Check out the link here to run a simulation of how they all work together! Assuming you have Docker installed on your machine, just run the notebook via the provided script run.sh on your command line. The notebook is found in docker/Kelly Multiarm Portfolio Simulation.ipynb.", "We assume that the horses perform independently. Based on this assumption, we can model the probabilities of the horses winning with a Dirichlet distribution. The rationale for this is as follows:", "We will see that in simulations, over repeated bets, due to errors in the estimated probabilities, the allocation is often imperfect and don\u2019t approach the optimal allocation, i.e., if the bettor knew the underlying horse win probabilities. We can see this in the following figure, where the initial wealth starts from $1 for both the optimal and Bayesian portfolios. The results are undeniable though: as the estimation gets better, the resulting allocations get much better too!", "Of course, reality is far more complicated:", "One avenue I have not explored is to switch to a non-parametric model (a.k.a. neural networks) to estimate the probabilities. This is exciting because one could presumably use more contextual information about each horse, such as its jockey, past performance on different tracks etc. to derive the probability of winning instead of attaching a classic conjugate prior like what we\u2019ve done above.", "Another is that applying it to the stock market is more complicated as there is a wider range of stock prices which essentially can be modelled by a continuous distribution. That being said, it is conceivable that some combination of Monte Carlo simulations could help with the estimation.", "One main insight I would like to end on is that the modelling of the probabilities and the sizing of the bets are essentially estimation and decision tasks respectively. This has strong ties to reinforcement learning and control systems, so combining knowledge from these areas would be an exciting area to explore!", "Originally published here with minor edits.", "[2] William Poundstone, \u201cFortune\u2019s Formula: The Untold Story of the Scientific Betting System That Beat the Casinos and Wall Street\u201d, 2006 link", "[4] Mohnish Pabrai, \u201cThe Dhandho Investor: The Low-Risk Value Method to High Returns\u201d, Wiley, 2007 link", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Machine learning engineer at Canva. I work on computer vision and churn modelling. My interests are data science, information theory, finance and investing."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F83ee407c0777&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----83ee407c0777--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83ee407c0777--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@anamolous.behaviour?source=post_page-----83ee407c0777--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anamolous.behaviour?source=post_page-----83ee407c0777--------------------------------", "anchor_text": "Paul Tune"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f15d28c014e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&user=Paul+Tune&userId=3f15d28c014e&source=post_page-3f15d28c014e----83ee407c0777---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83ee407c0777&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83ee407c0777&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pietromattia?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Pietro Mattia"}, {"url": "https://unsplash.com/s/photos/horse-racing?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://en.wikipedia.org/wiki/Parimutuel_betting", "anchor_text": "parimutuel betting system"}, {"url": "https://en.wikipedia.org/wiki/Kelly_criterion", "anchor_text": "Wikipedia"}, {"url": "https://en.wikipedia.org/wiki/Geometric_mean", "anchor_text": "geometric mean"}, {"url": "https://en.wikipedia.org/wiki/Warren_Buffett", "anchor_text": "Warren Buffett"}, {"url": "https://en.wikipedia.org/wiki/Charlie_Munger", "anchor_text": "Charlie Munger"}, {"url": "https://github.com/ptuls/multiarm_kelly_portfolio", "anchor_text": "here"}, {"url": "https://www.docker.com/", "anchor_text": "Docker"}, {"url": "https://en.wikipedia.org/wiki/Dirichlet_distribution", "anchor_text": "Dirichlet distribution"}, {"url": "https://en.wikipedia.org/wiki/Monte_Carlo_method", "anchor_text": "Monte Carlo simulations"}, {"url": "https://paultune.com/posts/kelly-bayesian", "anchor_text": "here"}, {"url": "http://www.herrold.com/brokerage/kelly.pdf", "anchor_text": "link"}, {"url": "https://www.amazon.com/Fortunes-Formula-Scientific-Betting-Casinos/dp/0809045990", "anchor_text": "link"}, {"url": "http://staff.ustc.edu.cn/~cgong821/Wiley.Interscience.Elements.of.Information.Theory.Jul.2006.eBook-DDU.pdf", "anchor_text": "link"}, {"url": "https://www.amazon.com/Dhandho-Investor-Low-risk-Method-Returns/dp/047004389X", "anchor_text": "link"}, {"url": "https://medium.com/tag/portfolio-management?source=post_page-----83ee407c0777---------------portfolio_management-----------------", "anchor_text": "Portfolio Management"}, {"url": "https://medium.com/tag/finance?source=post_page-----83ee407c0777---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/bayesian-statistics?source=post_page-----83ee407c0777---------------bayesian_statistics-----------------", "anchor_text": "Bayesian Statistics"}, {"url": "https://medium.com/tag/kelly-criterion?source=post_page-----83ee407c0777---------------kelly_criterion-----------------", "anchor_text": "Kelly Criterion"}, {"url": "https://medium.com/tag/data-science?source=post_page-----83ee407c0777---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83ee407c0777&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&user=Paul+Tune&userId=3f15d28c014e&source=-----83ee407c0777---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F83ee407c0777&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&user=Paul+Tune&userId=3f15d28c014e&source=-----83ee407c0777---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F83ee407c0777&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----83ee407c0777--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F83ee407c0777&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----83ee407c0777---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----83ee407c0777--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----83ee407c0777--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----83ee407c0777--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----83ee407c0777--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----83ee407c0777--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----83ee407c0777--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----83ee407c0777--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----83ee407c0777--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anamolous.behaviour?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@anamolous.behaviour?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Paul Tune"}, {"url": "https://medium.com/@anamolous.behaviour/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "491 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f15d28c014e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&user=Paul+Tune&userId=3f15d28c014e&source=post_page-3f15d28c014e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1d01df761956&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdoubling-your-money-with-the-kelly-criterion-and-bayesian-statistics-83ee407c0777&newsletterV3=3f15d28c014e&newsletterV3Id=1d01df761956&user=Paul+Tune&userId=3f15d28c014e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}