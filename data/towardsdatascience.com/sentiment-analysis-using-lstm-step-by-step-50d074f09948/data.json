{"url": "https://towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948", "time": 1682995054.972841, "path": "towardsdatascience.com/sentiment-analysis-using-lstm-step-by-step-50d074f09948/", "webpage": {"metadata": {"title": "Sentiment Analysis using LSTM Step by Step Tutorial | Deep Learning | Towards Data Science", "h1": "Sentiment Analysis using LSTM (Step-by-Step Tutorial)", "description": "Building a deep learning model (LSTM Model) using PyTorch for sentiment analysis"}, "outgoing_paragraph_urls": [{"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "IMDB movie dataset", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Deep_learning", "anchor_text": "Deep Learning", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Recurrent_neural_network", "anchor_text": "Recurrent Neural Networks (RNN)", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Long_short-term_memory", "anchor_text": "Long Short Term Memory (LSTM)", "paragraph_index": 1}, {"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "IMDB movies review dataset", "paragraph_index": 3}, {"url": "https://pytorch.org/docs/stable/data.html#torch.utils.data.TensorDataset", "anchor_text": "TensorDataset", "paragraph_index": 28}, {"url": "https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader", "anchor_text": "DataLoaders", "paragraph_index": 28}, {"url": "https://pytorch.org/docs/stable/torchvision/datasets.html", "anchor_text": "torchvision datasets", "paragraph_index": 28}], "all_paragraphs": ["I think this result from google dictionary gives a very succinct definition. I don\u2019t have to re-emphasize how important sentiment analysis has become. So, here we will build a classifier on IMDB movie dataset using a Deep Learning technique called RNN.", "I\u2019m outlining a step-by-step process for how Recurrent Neural Networks (RNN) can be implemented using Long Short Term Memory (LSTM) architecture:", "1) Load in and visualize the data", "We are using IMDB movies review dataset. If it is stored in your machine in a txt file then we just load it in", "2) Data Processing \u2014 convert to lower case", "3) Data Processing \u2014 remove punctuation", "We saw all the punctuation symbols predefined in python. To get rid of all these punctuation we will simply use", "4) Data Processing \u2014 create list of reviews", "We have got all the strings in one huge string. Now we will separate out individual reviews and store them as individual list elements. Like, [review_1, review_2, review_3\u2026\u2026. review_n]", "5) Tokenize \u2014 Create Vocab to Int mapping dictionary", "In most of the NLP tasks, you will create an index mapping dictionary in such a way that your frequently occurring words are assigned lower indexes. One of the most common way of doing this is to use Counter method from Collections library.", "Let\u2019s have a look at these objects we have created", "In order to create a vocab to int mapping dictionary, you would simply do this", "There is a small trick here, in this mapping index will start from 0 i.e. mapping of \u2018the\u2019 will be 0. But later on we are going to do padding for shorter reviews and conventional choice for padding is 0. So we need to start this indexing from 1", "Let\u2019s have a look at this mapping dictionary. We can see that mapping for \u2018the\u2019 is 1 now", "6) Tokenize \u2014 Encode the words", "So far we have created a) list of reviews and b) index mapping dictionary using vocab from all our reviews. All this was to create an encoding of reviews (replace words in our reviews by integers)", "Note: what we have created now is a list of lists. Each individual review is a list of integer values and all of them are stored in one huge list", "7) Tokenize \u2014 Encode the labels", "This is simple because we only have 2 output labels. So, we will just label \u2018positive\u2019 as 1 and \u2018negative\u2019 as 0", "Observations : a) Mean review length = 240 b) Some reviews are of 0 length. Keeping this review won\u2019t make any sense for our analysis c) Most of the reviews less than 500 words or more d) There are quite a few reviews that are extremely long, we can manually investigate them to check whether we need to include or exclude them from our analysis", "9) Removing Outliers \u2014 Getting rid of extremely long or short reviews", "10) Padding / Truncating the remaining data", "To deal with both short and long reviews, we will pad or truncate all our reviews to a specific length. We define this length by Sequence Length. This sequence length is same as number of time steps for LSTM layer.", "For reviews shorter than seq_length, we will pad with 0s. For reviews longer than seq_length we will truncate them to the first seq_length words.", "Note: We are creating/maintaining a 2D array structure as we created for reviews_int . Output will look like this", "11) Training, Validation, Test Dataset Split", "Once we have got our data in nice shape, we will split it into training, validation and test sets", "After creating our training, test and validation data. Next step is to create dataloaders for this data. We can use generator function for batching our data into batches instead we will use a TensorDataset. This is one of a very useful utility in PyTorch for using our data with DataLoaders with exact same ease as of torchvision datasets", "In order to obtain one batch of training data for visualization purpose we will create a data iterator", "Here, 50 is the batch size and 200 is the sequence length that we have defined. Now our data prep step is complete and next we will look at the LSTM network architecture for start building our model", "13) Define the LSTM Network Architecture", "0. Tokenize : This is not a layer for LSTM network but a mandatory step of converting our words into tokens (integers)", "Note: If you want to understand more about these LSTM layers and get a microscopic view of things. Read this one \u2014", "Most of the code in training loop is pretty standard Deep Learning training code that you might see often in all the implementations that\u2019s using PyTorch framework.", "First, we will define a tokenize function that will take care of pre-processing steps and then we will create a predict function that will give us the final output after parsing the user provided review.", "Update: Another article to give you a microscopic view of what happens within the layers.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "15 years in Data Science. I'm sharing valuable tips, ideas, and code snippets on Machine Learning & Deep Learning"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F50d074f09948&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----50d074f09948--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----50d074f09948--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://samarthagrawal86.medium.com/?source=post_page-----50d074f09948--------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=post_page-----50d074f09948--------------------------------", "anchor_text": "Samarth Agrawal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c9c1e60de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&user=Samarth+Agrawal&userId=2c9c1e60de25&source=post_page-2c9c1e60de25----50d074f09948---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50d074f09948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50d074f09948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://monkeylearn.com/sentiment-analysis/", "anchor_text": "Monkeylearn"}, {"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "IMDB movie dataset"}, {"url": "https://en.wikipedia.org/wiki/Deep_learning", "anchor_text": "Deep Learning"}, {"url": "https://en.wikipedia.org/wiki/Recurrent_neural_network", "anchor_text": "Recurrent Neural Networks (RNN)"}, {"url": "https://en.wikipedia.org/wiki/Long_short-term_memory", "anchor_text": "Long Short Term Memory (LSTM)"}, {"url": "http://ai.stanford.edu/~amaas/data/sentiment/", "anchor_text": "IMDB movies review dataset"}, {"url": "https://pytorch.org/docs/stable/data.html#torch.utils.data.TensorDataset", "anchor_text": "TensorDataset"}, {"url": "https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader", "anchor_text": "DataLoaders"}, {"url": "https://pytorch.org/docs/stable/torchvision/datasets.html", "anchor_text": "torchvision datasets"}, {"url": "https://towardsdatascience.com/reading-between-the-layers-lstm-network-7956ad192e58", "anchor_text": "Reading between the layers (LSTM Network)Using PyTorch framework for Deep Learningtowardsdatascience.com"}, {"url": "https://samarthagrawal86.medium.com", "anchor_text": "follow me on medium"}, {"url": "https://www.linkedin.com/in/samarth-agrawal-2501/", "anchor_text": "Linkedin"}, {"url": "https://towardsdatascience.com/reading-between-the-layers-lstm-network-7956ad192e58", "anchor_text": "Reading between the layers (LSTM Network)Using PyTorch framework for Deep Learningtowardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----50d074f09948---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----50d074f09948---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/sentiment-analysis?source=post_page-----50d074f09948---------------sentiment_analysis-----------------", "anchor_text": "Sentiment Analysis"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----50d074f09948---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/lstm?source=post_page-----50d074f09948---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F50d074f09948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&user=Samarth+Agrawal&userId=2c9c1e60de25&source=-----50d074f09948---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F50d074f09948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&user=Samarth+Agrawal&userId=2c9c1e60de25&source=-----50d074f09948---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50d074f09948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----50d074f09948--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F50d074f09948&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----50d074f09948---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----50d074f09948--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----50d074f09948--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----50d074f09948--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----50d074f09948--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----50d074f09948--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----50d074f09948--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----50d074f09948--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----50d074f09948--------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://samarthagrawal86.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Samarth Agrawal"}, {"url": "https://samarthagrawal86.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "491 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c9c1e60de25&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&user=Samarth+Agrawal&userId=2c9c1e60de25&source=post_page-2c9c1e60de25--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fd946063b0300&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsentiment-analysis-using-lstm-step-by-step-50d074f09948&newsletterV3=2c9c1e60de25&newsletterV3Id=d946063b0300&user=Samarth+Agrawal&userId=2c9c1e60de25&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}