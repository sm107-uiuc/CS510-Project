{"url": "https://towardsdatascience.com/cross-field-validation-using-pandas-f7a316fd37b7", "time": 1683016512.597613, "path": "towardsdatascience.com/cross-field-validation-using-pandas-f7a316fd37b7/", "webpage": {"metadata": {"title": "Cross field validation with Pandas. Final Blows to the Dirty Data. | Towards Data Science", "h1": "Final Blows to the Dirty Data", "description": "Cross field validation is a process of using multiple fields of the dataset to ensure the validity of another. In CFV, the main concern is the execution speed, so you will find an in-depth comparison of CFV methods: apply(), iterrows(), itertuples()"}, "outgoing_paragraph_urls": [{"url": "https://www.linkedin.com/in/bextuychiev/", "anchor_text": "https://www.linkedin.com/in/bextuychiev/", "paragraph_index": 29}], "all_paragraphs": ["Today, data never comes from a single source. More often than not, it is collected in different locations and merged together. A common challenge when merging data is data integrity. In simple words, making sure our data is correct by using multiple fields to check the validity of another. In fancier terms, this process is called Cross Field Validation.", "Sanity checking your dataset for data integrity is essential to have accurate analysis and running machine learning models. Cross field validation should come in after you dealt with most of the other cleaning issues like missing value imputation, ensuring field constraints are in place, etc.", "I wrote the code snippets for this post with regard to execution time. Since cross-field validation may involve performing operations across multiple columns for millions of observations, the execution speed should is very important. The solutions suggested here should be scalable enough for even massive datasets.", "I generated fake data to perform cross-field validation:", "In the setup section, we loaded a fake people dataset. For example purposes, we are going to assume that this data was collected from two sources: from census data that gives each individual's full name and birthday which was merged with their hospital records later.", "To have an accurate analysis, we should make sure our data is valid. In this case, we can check the validness of two fields: age and BMI (Body Mass Index).", "Let\u2019s start with age. We have to ensure when we subtract their birth year from the current year, the result matches the age column.", "When you are performing cross-field validation, the speed should be the main concern. Unlike our little example, you may have to deal with millions of observations. One of the fastest methods for cross-field validation for datasets of any size is apply function of pandas.", "Here is a simple example of apply:", "The above was an example of a column-wise execution. apply takes a function name as an argument and calls that function on each element of the column it was called on. The function has an extra argument axis which is by default set to 0 or rows. If we set it to 1 or columns, the function shifts to row-wise execution.", "Note on axis argument: axis='rows' means performing an operation along the row axis which is vertical because rows are stacked vertically. axis='columns' means performing an operation along the column axis which is horizontal because columns are stacked horizontally. These two terms confuse a lot of people because they look like they are doing the opposite of what they are told to. In reality, it just takes a shift in perspective, or using the words if you will.", "Let\u2019s create a function that validates a person\u2019s age:", "Since we are going to use apply for a row-wise operation, its inputs will be each row of the dataset. That's why we can easily access each column's value just like we would in a normal situation.", "Using the datetime package we imported earlier, we will store today's date. Then, we calculate the age by subtracting the year components from each other. For this to work, you have to make sure the birthday column has a datetime data type.", "In the return statement we compare the calculated age and the given age, which returns True if they match, False if otherwise:", "The function works as expected. Now we can subset the data for invalid ages if any:", "There were 75 rows with invalid age. If you do the math, the ages do not match. To correct these values, we could write a new function but that would involve a code repetition. We can update validate_age to replace any invalid values with valid ones:", "We can make sure the operation was successful with an assert statement:", "Next, we will validate the Body Mass Index column.", "Body mass index is a value derived from the mass and height of a person.", "A quick Google search gives us the formula to calculate BMI:", "Using the ideas from the first example, we will create the function for BMI which replaces invalid BMI with correct values:", "It is a good practice to start all of your validation functions with validate_. This gives a signal you are performing a validation to the readers of your code.", "In this section, we will perform a speed comparison of different methods for cross-field validation. We will start off with the apply function for validating the bmi:", "It took around 0.3 seconds for the 10k dataset. Next, we will use a for loop using pandas iterrows():", "It took 10 times longer! Besides, this time difference will not be linear. For larger datasets, the difference becomes bigger and bigger. I don\u2019t think any for loop can beat the apply function, but let's also try itertuples which is generally faster than iterrows():", "Still much slower than apply. So, the general rule of thumb for cross-field validation is to always use apply function.", "Read more articles related to the topic:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "BEXGBoost | DataCamp Instructor |\ud83e\udd47Top 10 AI/ML Writer on Medium | Kaggle Master | https://www.linkedin.com/in/bextuychiev/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff7a316fd37b7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://ibexorigin.medium.com/?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": ""}, {"url": "https://ibexorigin.medium.com/?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": "Bex T."}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39db050c2ac2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&user=Bex+T.&userId=39db050c2ac2&source=post_page-39db050c2ac2----f7a316fd37b7---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7a316fd37b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7a316fd37b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.pexels.com/@ian-beckley-1278367?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Ian Beckley"}, {"url": "https://www.pexels.com/photo/top-view-photography-of-roads-2440013/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels", "anchor_text": "Pexels"}, {"url": "https://www.wikipedia.org/", "anchor_text": "Wikipedia"}, {"url": "https://towardsdatascience.com/data-type-constraints-data-range-constraints-duplicate-data-with-pandas-44897a350b1e", "anchor_text": "Master the Most Time-consuming task in DS/ML, #1Dealing with common data problemstowardsdatascience.com"}, {"url": "https://towardsdatascience.com/master-the-most-hated-task-in-ds-ml-3b9779276d7c", "anchor_text": "Master the Most Hated Task in DS/MLCategorical data cleaning with Pandastowardsdatascience.com"}, {"url": "https://towardsdatascience.com/fuzzywuzzy-fuzzy-string-matching-in-python-beginners-guide-9adc0edf4b35", "anchor_text": "FuzzyWuzzy: Fuzzy String Matching in Python, Beginner\u2019s Guide\u2026 and hands-on practice on a real-world datasettowardsdatascience.com"}, {"url": "https://towardsdatascience.com/data-uniformity-in-data-science-9bec114fbfae", "anchor_text": "Data Uniformity in Data ScienceTreating most common uniformity problems in Pandastowardsdatascience.com"}, {"url": "https://towardsdatascience.com/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92", "anchor_text": "Meet the hardest functions of Pandas, Part IMaster the when and how of pivot_table(), stack(), unstack()towardsdatascience.com"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----f7a316fd37b7---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f7a316fd37b7---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f7a316fd37b7---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----f7a316fd37b7---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/software-development?source=post_page-----f7a316fd37b7---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7a316fd37b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&user=Bex+T.&userId=39db050c2ac2&source=-----f7a316fd37b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7a316fd37b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&user=Bex+T.&userId=39db050c2ac2&source=-----f7a316fd37b7---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7a316fd37b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff7a316fd37b7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f7a316fd37b7---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f7a316fd37b7--------------------------------", "anchor_text": ""}, {"url": "https://ibexorigin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://ibexorigin.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Bex T."}, {"url": "https://ibexorigin.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "16.4K Followers"}, {"url": "https://www.linkedin.com/in/bextuychiev/", "anchor_text": "https://www.linkedin.com/in/bextuychiev/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F39db050c2ac2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&user=Bex+T.&userId=39db050c2ac2&source=post_page-39db050c2ac2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F22cea38b90f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcross-field-validation-using-pandas-f7a316fd37b7&newsletterV3=39db050c2ac2&newsletterV3Id=22cea38b90f3&user=Bex+T.&userId=39db050c2ac2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}