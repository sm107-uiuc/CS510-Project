{"url": "https://towardsdatascience.com/https-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054", "time": 1682996218.3512042, "path": "towardsdatascience.com/https-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054/", "webpage": {"metadata": {"title": "Classification and Regression Analysis with Decision Trees | by Lorraine Li | Towards Data Science", "h1": "Classification and Regression Analysis with Decision Trees", "description": "By understanding the fundamental concepts and mathematics behind decision trees, learn to build classification and regression decision trees!"}, "outgoing_paragraph_urls": [{"url": "https://c.next.tech/2E7k6Dy", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "Iris", "paragraph_index": 15}, {"url": "http://www.graphviz.org/", "anchor_text": "GraphViz", "paragraph_index": 22}, {"url": "https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "Boston Housing", "paragraph_index": 27}], "all_paragraphs": ["A decision tree is a supervised machine learning model used to predict a target by learning decision rules from features. As the name suggests, we can think of this model as breaking down our data by making a decision based on asking a series of questions.", "Let's consider the following example in which we use a decision tree to decide upon an activity on a particular day:", "Based on the features in our training set, the decision tree model learns a series of questions to infer the class labels of the samples. As we can see, decision trees are attractive models if we care about interpretability.", "Although the preceding figure illustrates the concept of a decision tree based on categorical targets (classification), the same concept applies if our targets are real numbers (regression).", "In this tutorial, we will discuss how to build a decision tree model with Python\u2019s scikit-learn library. We will cover:", "This tutorial is adapted from Next Tech\u2019s Python Machine Learning series which takes you through machine learning and deep learning algorithms with Python from 0 to 100. It includes an in-browser sandboxed environment with all the necessary software and libraries pre-installed, and projects using public datasets. You can get started here!", "A decision tree is constructed by recursive partitioning \u2014 starting from the root node (known as the first parent), each node can be split into left and right child nodes. These nodes can then be further split and they themselves become parent nodes of their resulting children nodes.", "For example, looking at the image above, the root node is Work to do? and splits into the child nodes Stay in and Outlook based on whether or not there is work to do. The Outlook node further splits into three child nodes.", "So, how do we know what the optimal splitting point is at each node?", "Starting from the root, the data is split on the feature that results in the largest Information Gain (IG) (explained in more detail below). In an iterative process, we then repeat this splitting procedure at each child node until the leaves are pure \u2014 i.e. samples at each node all belong to the same class.", "In practice, this can result in a very deep tree with many nodes, which can easily lead to overfitting. Thus, we typically want to prune the tree by setting a limit for the maximal depth of the tree.", "In order to split the nodes at the most informative features, we need to define an objective function that we want to optimize via the tree learning algorithm. Here, our objective function is to maximize the information gain at each split, which we define as follows:", "Here, f is the feature to perform the split, Dp, Dleft, and Dright are the datasets of the parent and child nodes, I is the impurity measure, Np is the total number of samples at the parent node, and Nleft and Nright are the number of samples in the child nodes.", "We will discuss impurity measures for classification and regression decision trees in more detail in our examples below. But for now, just understand that information gain is simply the difference between the impurity of the parent node and the sum of the child node impurities \u2014 the lower the impurity of the child nodes, the larger the information gain.", "Note that the above equation is for binary decision trees \u2014 each parent node is split into two child nodes only. If you have a decision tree with multiple nodes, you would simply sum the impurity of all nodes.", "We will start by talking about classification decision trees (also known as classification trees). For this example, we will be using the Iris dataset, a classic in the field of machine learning. It contains the measurements of 150 Iris flowers from three different species \u2014 Setosa, Versicolor, and Virginica. These will be our targets. Our goal is to predict which category an Iris flower belongs to. The petal length and width in centimeters are stored as columns, which we also call the features of the dataset.", "Let\u2019s first import the dataset and assign the features as X and the target as y:", "Using scikit-learn, we will now train a decision tree with a maximum depth of 4. The code is as follows:", "Notice that we set the criterion as \u2018entropy\u2019. This criterion is known as the impurity measure (mentioned in the previous section). In classification, entropy is the most common impurity measure or splitting criteria. It is defined by:", "Here, p(i|t) is the proportion of the samples that belong to class c for a particular node t. The entropy is therefore 0 if all samples at a node belong to the same class, and the entropy is maximal if we have a uniform class distribution.", "For a more visual understanding of entropy, let\u2019s plot the impurity index for the probability range [0, 1] for class 1. The code is as follows:", "Now, returning to our Iris example, we will visualize our trained classification tree and see how entropy decides each split.", "A nice feature in scikit-learn is that it allows us to export the decision tree as a .dot file after training, which we can visualize using GraphViz, for example. In addition to GraphViz, we will use a Python library called pydotplus, which has capabilities similar to GraphViz and allows us to convert .dot data files into a decision tree image file.", "You can install pydotplus and graphviz by executing the following commands in your Terminal:", "The following code will create an image of our decision tree in PNG format:", "Looking at the resulting decision tree figure saved in the image file tree.png, we can now nicely trace back the splits that the decision tree determined from our training dataset. We started with 150 samples at the root and split them into two child nodes with 50 and 100 samples, using the petal width cut-off \u2264 1.75 cm. After the first split, we can see that the left child node is already pure and only contains samples from the setosa class (entropy = 0). The further splits on the right are then used to separate the samples from the versicolor and virginica class.", "Looking at the final entropy we see that the decision tree with a depth of 4 does a very good job of separating the flower classes.", "We will be using the Boston Housing dataset for our regression example. This is another very popular dataset which contains information about houses in the suburbs of Boston. There are 506 samples and 14 attributes. For simplicity and visualization purposes, we will only use two \u2014 MEDV (median value of owner-occupied homes in $1000s) as the target and LSTAT (percentage of lower status of the population) as the feature.", "Let\u2019s first import the necessary attributes from scikit-learn into a pandas DataFrame.", "Let\u2019s use the DecisionTreeRegressor implemented in scikit-learn to train a regression tree:", "Notice that our criterion is different from the one we used for our classification tree. Entropy as a measure of impurity is a useful criteria for classification. To use a decision tree for regression, however, we need an impurity metric that is suitable for continuous variables, so we define the impurity measure using the weighted mean squared error (MSE) of the children nodes instead:", "Here, Nt is the number of training samples at node t, Dt is the training subset at node t, y(i) is the true target value, and \u0177t\u200b is the predicted target value (sample mean):", "Now, let\u2019s model the relationship between MEDV and LSTAT to see what the line fit of a regression tree looks like:", "As we can see in the resulting plot, the decision tree of depth 3 captures the general trend in the data.", "I hope you enjoyed this tutorial on decision trees! We discussed the fundamental concepts of decision trees, the algorithms for minimizing impurity, and how to build decision trees for both classification and regression.", "In practice, it is important to know how to choose an appropriate value for a depth of a tree to not overfit or underfit the data. Knowing how to combine decision trees to form an ensemble random forest is also useful as it usually has a better generalization performance than an individual decision tree due to randomness, which helps to decrease the model\u2019s variance. It is also less sensitive to outliers in the dataset and doesn\u2019t require much parameter tuning.", "We cover these techniques in our Python Machine Learning series, as well as diving into other machine learning models such as perceptrons, Adaline, linear and polynomial regression, logistic regression, SVMs, kernel SVMs, k-nearest-neighbors, models for sentiment analysis, k-means clustering, DBSCAN, convolutional neural networks, and recurrent neural networks.", "We also look at other topics such as regularization, data processing, feature selection and extraction, dimensionality reduction, model evaluation, ensemble learning techniques, and deploying a machine learning model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc43cdbc58054&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lorrli?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lorrli?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": "Lorraine Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F37b1fe31b4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&user=Lorraine+Li&userId=37b1fe31b4bf&source=post_page-37b1fe31b4bf----c43cdbc58054---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc43cdbc58054&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc43cdbc58054&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://c.next.tech/2E7k6Dy", "anchor_text": "here"}, {"url": "https://archive.ics.uci.edu/ml/datasets/iris", "anchor_text": "Iris"}, {"url": "http://www.graphviz.org/", "anchor_text": "GraphViz"}, {"url": "https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html", "anchor_text": "Boston Housing"}, {"url": "https://c.next.tech/2E7k6Dy", "anchor_text": "here"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c43cdbc58054---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/decision-tree?source=post_page-----c43cdbc58054---------------decision_tree-----------------", "anchor_text": "Decision Tree"}, {"url": "https://medium.com/tag/python?source=post_page-----c43cdbc58054---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----c43cdbc58054---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/learning?source=post_page-----c43cdbc58054---------------learning-----------------", "anchor_text": "Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc43cdbc58054&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&user=Lorraine+Li&userId=37b1fe31b4bf&source=-----c43cdbc58054---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc43cdbc58054&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&user=Lorraine+Li&userId=37b1fe31b4bf&source=-----c43cdbc58054---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc43cdbc58054&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc43cdbc58054&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c43cdbc58054---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c43cdbc58054--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c43cdbc58054--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c43cdbc58054--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c43cdbc58054--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lorrli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lorrli?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lorraine Li"}, {"url": "https://medium.com/@lorrli/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "994 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F37b1fe31b4bf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&user=Lorraine+Li&userId=37b1fe31b4bf&source=post_page-37b1fe31b4bf--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feeded4fba6ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhttps-medium-com-lorrli-classification-and-regression-analysis-with-decision-trees-c43cdbc58054&newsletterV3=37b1fe31b4bf&newsletterV3Id=eeded4fba6ef&user=Lorraine+Li&userId=37b1fe31b4bf&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}