{"url": "https://towardsdatascience.com/multi-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4", "time": 1682993722.016761, "path": "towardsdatascience.com/multi-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4/", "webpage": {"metadata": {"title": "Multi-Class Text Classification with Doc2Vec & Logistic Regression | by Susan Li | Towards Data Science", "h1": "Multi-Class Text Classification with Doc2Vec & Logistic Regression", "description": "Doc2vec is an NLP tool for representing documents as a vector and is a generalizing of the word2vec method. In order to understand doc2vec, it is advisable to understand word2vec approach. However\u2026"}, "outgoing_paragraph_urls": [{"url": "https://cs.stanford.edu/~quocle/paragraph_vector.pdf", "anchor_text": "Doc2vec", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Natural_language_processing", "anchor_text": "NLP", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Word2vec", "anchor_text": "word2vec", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/multi-class-text-classification-with-scikit-learn-12f1e60e0a9f", "anchor_text": "Multi-Class Text Classification with Scikit-Learn", "paragraph_index": 2}, {"url": "https://radimrehurek.com/gensim/models/doc2vec.html", "anchor_text": "Gensim", "paragraph_index": 2}, {"url": "https://catalog.data.gov/dataset/consumer-complaint-database", "anchor_text": "data.gov", "paragraph_index": 3}, {"url": "https://www.nltk.org/api/nltk.tokenize.html", "anchor_text": "NLTK tokenizer", "paragraph_index": 9}, {"url": "https://github.com/RaRe-Technologies/gensim/blob/3c3506d51a2caf6b890de3b1b32a8b85f7566ca5/docs/notebooks/doc2vec-IMDB.ipynb", "anchor_text": "Gensim doc2vec tutorial on the IMDB sentiment data set", "paragraph_index": 16}, {"url": "https://github.com/RaRe-Technologies/gensim/blob/develop/docs/notebooks/doc2vec-IMDB.ipynb", "anchor_text": "Gensim\u2019s tutorial", "paragraph_index": 18}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/Doc2Vec%20Consumer%20Complaint.ipynb", "anchor_text": "notebook", "paragraph_index": 18}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/Doc2Vec%20Consumer%20Complaint_3.ipynb", "anchor_text": "Jupyter notebook", "paragraph_index": 19}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/Doc2Vec%20Consumer%20Complaint_3.ipynb", "anchor_text": "Github", "paragraph_index": 19}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/", "paragraph_index": 21}], "all_paragraphs": ["Doc2vec is an NLP tool for representing documents as a vector and is a generalizing of the word2vec method.", "In order to understand doc2vec, it is advisable to understand word2vec approach. However, the complete mathematical details is out of scope of this article. If you are new to word2vec and doc2vec, the following resources can help you to get start:", "Using the same data set when we did Multi-Class Text Classification with Scikit-Learn, In this article, we\u2019ll classify complaint narrative by product using doc2vec techniques in Gensim. Let\u2019s get started!", "The goal is to classify consumer finance complaints into 12 pre-defined classes. The data can be downloaded from data.gov.", "After remove null values in narrative columns, we will need to re-index the data frame.", "We have over 63 million words, it is a relatively large data set.", "The classes are imbalanced, however, a naive classifier that predicts everything to be Debt collection will only achieve over 20% accuracy.", "Let\u2019s have a look a few examples of complaint narrative and its associated product.", "Below we define a function to convert text to lower-case and strip punctuation/symbols from words and so on.", "The following steps include train/test split of 70/30, remove stop-words and tokenize text using NLTK tokenizer. For our first try we tag every complaint narrative with its product.", "This is what a training entry looks like \u2014 an example complaint narrative tagged by \u201cCredit reporting\u201d.", "First, we instantiate a doc2vec model \u2014 Distributed Bag of Words (DBOW). In the word2vec architecture, the two algorithm names are \u201ccontinuous bag of words\u201d (CBOW) and \u201cskip-gram\u201d (SG); in the doc2vec architecture, the corresponding algorithms are \u201cdistributed memory\u201d (DM) and \u201cdistributed bag of words\u201d (DBOW).", "DBOW is the doc2vec model analogous to Skip-gram model in word2vec. The paragraph vectors are obtained by training a neural network on the task of predicting a probability distribution of words in a paragraph given a randomly-sampled word from the paragraph.", "We will vary the following parameters:", "Training a doc2vec model is rather straight-forward in Gensim, we initialize the model and train for 30 epochs.", "Distributed Memory (DM) acts as a memory that remembers what is missing from the current context \u2014 or as the topic of the paragraph. While the word vectors represent the concept of a word, the document vector intends to represent the concept of a document. We again instantiate a Doc2Vec model with a vector size with 300 words and iterating over the training corpus 30 times.", "According to Gensim doc2vec tutorial on the IMDB sentiment data set, combining a paragraph vector from Distributed Bag of Words (DBOW) and Distributed Memory (DM) improves performance. We will follow, pairing the models together for evaluation.", "First, we delete temporary training data to free up RAM.", "For this article, I used training set to train doc2vec, however, in Gensim\u2019s tutorial, the whole data set was used for training, I tried that approach, using the whole data set to train doc2vec classifier for our consumer complaint classification, I was able to achieve 70% accuracy. You can find that notebook here, it is a little different approach.", "The Jupyter notebook for the above analysis can be found on Github. I look forward to hearing any questions.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Changing the world, one post at a time. Sr Data Scientist, Toronto Canada. https://www.linkedin.com/in/susanli/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9da9947b43f4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://actsusanli.medium.com/?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": "Susan Li"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a----9da9947b43f4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9da9947b43f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9da9947b43f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://cs.stanford.edu/~quocle/paragraph_vector.pdf", "anchor_text": "Doc2vec"}, {"url": "https://en.wikipedia.org/wiki/Natural_language_processing", "anchor_text": "NLP"}, {"url": "https://en.wikipedia.org/wiki/Word2vec", "anchor_text": "word2vec"}, {"url": "https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf", "anchor_text": "Distributed Representations of Words and Phrases and their Compositionality"}, {"url": "https://cs.stanford.edu/~quocle/paragraph_vector.pdf", "anchor_text": "Distributed Representations of Sentences and Documents"}, {"url": "https://medium.com/scaleabout/a-gentle-introduction-to-doc2vec-db3e8c0cce5e", "anchor_text": "A gentle introduction to Doc2Vec"}, {"url": "https://github.com/RaRe-Technologies/gensim/blob/3c3506d51a2caf6b890de3b1b32a8b85f7566ca5/docs/notebooks/doc2vec-IMDB.ipynb", "anchor_text": "Gensim Doc2Vec Tutorial on the IMDB Sentiment Dataset"}, {"url": "https://github.com/RaRe-Technologies/movie-plots-by-genre/blob/master/ipynb_with_output/Document%20classification%20with%20word%20embeddings%20tutorial%20-%20with%20output.ipynb", "anchor_text": "Document classification with word embeddings tutorial"}, {"url": "https://towardsdatascience.com/multi-class-text-classification-with-scikit-learn-12f1e60e0a9f", "anchor_text": "Multi-Class Text Classification with Scikit-Learn"}, {"url": "https://radimrehurek.com/gensim/models/doc2vec.html", "anchor_text": "Gensim"}, {"url": "https://catalog.data.gov/dataset/consumer-complaint-database", "anchor_text": "data.gov"}, {"url": "https://www.nltk.org/api/nltk.tokenize.html", "anchor_text": "NLTK tokenizer"}, {"url": "https://github.com/RaRe-Technologies/gensim/blob/3c3506d51a2caf6b890de3b1b32a8b85f7566ca5/docs/notebooks/doc2vec-IMDB.ipynb", "anchor_text": "Gensim doc2vec tutorial on the IMDB sentiment data set"}, {"url": "https://github.com/RaRe-Technologies/gensim/blob/develop/docs/notebooks/doc2vec-IMDB.ipynb", "anchor_text": "Gensim\u2019s tutorial"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/Doc2Vec%20Consumer%20Complaint.ipynb", "anchor_text": "notebook"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/Doc2Vec%20Consumer%20Complaint_3.ipynb", "anchor_text": "Jupyter notebook"}, {"url": "https://github.com/susanli2016/NLP-with-Python/blob/master/Doc2Vec%20Consumer%20Complaint_3.ipynb", "anchor_text": "Github"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9da9947b43f4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/nlp?source=post_page-----9da9947b43f4---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/naturallanguageprocessing?source=post_page-----9da9947b43f4---------------naturallanguageprocessing-----------------", "anchor_text": "Naturallanguageprocessing"}, {"url": "https://medium.com/tag/python?source=post_page-----9da9947b43f4---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/doc2vec?source=post_page-----9da9947b43f4---------------doc2vec-----------------", "anchor_text": "Doc2vec"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9da9947b43f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&user=Susan+Li&userId=731d8566944a&source=-----9da9947b43f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9da9947b43f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&user=Susan+Li&userId=731d8566944a&source=-----9da9947b43f4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9da9947b43f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9da9947b43f4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9da9947b43f4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9da9947b43f4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9da9947b43f4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9da9947b43f4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9da9947b43f4--------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://actsusanli.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Susan Li"}, {"url": "https://actsusanli.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "27K Followers"}, {"url": "https://www.linkedin.com/in/susanli/", "anchor_text": "https://www.linkedin.com/in/susanli/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F731d8566944a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&user=Susan+Li&userId=731d8566944a&source=post_page-731d8566944a--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F1f2b19329694&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-class-text-classification-with-doc2vec-logistic-regression-9da9947b43f4&newsletterV3=731d8566944a&newsletterV3Id=1f2b19329694&user=Susan+Li&userId=731d8566944a&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}