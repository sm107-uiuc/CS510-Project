{"url": "https://towardsdatascience.com/the-power-of-ensembles-in-deep-learning-a8900ff42be9", "time": 1683001434.4958441, "path": "towardsdatascience.com/the-power-of-ensembles-in-deep-learning-a8900ff42be9/", "webpage": {"metadata": {"title": "The Power of Ensembles in Deep Learning | by Julio Borges | Towards Data Science", "h1": "The Power of Ensembles in Deep Learning", "description": "Introducing DeepStack, a python package for Building Deep Learning Ensembles"}, "outgoing_paragraph_urls": [{"url": "https://www.quora.com/What-machine-learning-approaches-have-won-most-Kaggle-competitions", "anchor_text": "Giuliano Janson at quora (2016)", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/ensemble-methods-bagging-boosting-and-stacking-c9214a10a205", "anchor_text": "this article", "paragraph_index": 9}, {"url": "https://mlwave.com/kaggle-ensembling-guide/", "anchor_text": "Kaggle Ensembling Guide", "paragraph_index": 9}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR-10", "paragraph_index": 10}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html", "anchor_text": "sklearn.metrics.roc_auc_score", "paragraph_index": 15}, {"url": "https://scikit-learn.org/dev/modules/generated/sklearn.ensemble.StackingClassifier.html#sklearn.ensemble.StackingClassifier", "anchor_text": "StackingClassifier", "paragraph_index": 18}, {"url": "https://scikit-learn.org/dev/modules/generated/sklearn.ensemble.StackingRegressor.html#sklearn.ensemble.StackingRegressor", "anchor_text": "StackingRegressor", "paragraph_index": 18}, {"url": "https://github.com/jcborges/DeepStack/blob/master/deepstack/base.py", "anchor_text": "deepstack.base.Member", "paragraph_index": 20}, {"url": "https://mlwave.com/kaggle-ensembling-guide/", "anchor_text": "reported", "paragraph_index": 21}], "all_paragraphs": ["Ensemble Building is the leading winning strategy for machine learning competitions and often the technique used for solving real-world problems. What often happens is that while solving a problem or participating in a competition you end up with several trained models, each one with some differences to another \u2014 and you end up picking up your best model based on your best evaluation score. The truth is that your best model \u201cknows less\u201d about the data, than all others \u201cweak models\u201d combined. Combining several base models together to create a more powerful ensemble model then rises as a natural by-product of this workflow.", "\u201cThere is really no way you can win most Kaggle competitions without a very strong ensemble. As good as your best individual model is, it won\u2019t match a good ensemble.\u201d Giuliano Janson at quora (2016)", "Ensembles range from simple to weighted averages up to complicated 2nd and 3rd level meta-models. Back into building my ensemble models for my machine learning competitions I ended up creating several blocks of code that helped me test different ensemble strategies and win or perform much better in such challenges. So, I just as the natural question: what if I could make building Deep Learning Ensembles as easy as writing a few lines of python code and share this with the community? These solo projects gestated into scripts and matured into a python packaged I named DeepStack.", "Ensemble Learning is all about learning how to best combine predictions from multiple existing models (called the base-learners). Every member of the ensemble makes a contribution to the final output and individual weaknesses are offset by the contribution the other members. The combined learned model is named the meta-learner. There are several flavors of Ensemble Learning. In this article we will focus on particularly 2 methods currently supported by DeepStack. Namely:", "#1 Stacking: in stacking the output of the base-learners are taken as input for training a meta-learner, that learns how to best combine the base-learners predictions.", "Often times the stacking model will outperform each of the individual models due to its smoothing nature, offsetting deficiencies of individual models leading to a better prediction performance. Therefore, stacking works best when the base models are basically different.", "#2 Weighted Average Ensemble: this method weights the contribution of each ensemble member based on their performance on a hold-out validation dataset. Models with better contribution receive a higher weight.", "The main difference between both methods is that in stacking, the meta-learner takes every single output of the base-learners as a training instance, learning how to best map the base-learner decisions into an improved output. The meta-learner can be any classic known machine learning model. The weighted average ensemble on the other hand is just about optimizing weights that are used for weighting all outputs of the base-learner and taking the weighted average. There is no meta-learner here (besides the weights). Here the number of weights is equal to the number of existing base-learners.", "Needless to say, when building an ensemble you need a training dataset which has not been seen by the base-learners in order to avoid overfitting. You also need a hold-out (validation) dataset to guide / test the performance of your ensembles.", "The are several techniques for ensemble learning and I would definitely recommend this article of Joseph Rocca to get deeper into concepts such as boosting and bagging. The Kaggle Ensembling Guide is also a good reading.", "Ready for coding with a real example? In the next minutes I will show you how to easily build ensembles with DeepStack using the CIFAR-10 dataset. The CIFAR-10 dataset consists of 60000 32x32 colour images in 10 classes, with 6000 images per class. We will start creating simple CNNs for classifying the images and create ensembles with the single CNNs using the 2 ensemble strategies previously described. Let\u2019s get started.", "Now we can make use of the DeepStack interface and create instances of the class deepstack.base.Member which provide all the necessary logic for building the base-learners of the ensembles. In this demonstration we will start using the class KerasMember which inherits from Member but has additional logic for Keras Models . The rationale is to initiate the instance with a training and validation dataset for the meta-learner \u2014 and we already built a utility function for that!", "Now you may be asking yourself, why are we initiating all 4 objects with the same train and validation datasets? Well, you don\u2019t have to. Your keras Models could have been trained with different ImageDataGenerator and you could pass the data generators directly as an argument to the KerasMember. What is important here is that the class labels (y_train / y_val) are equal among the members, so that we can validate and compare the base-learners in a later step.", "Now that we have all the necessary building blocks, let\u2019s create our first ensemble.", "And voil\u00e0, you should see a similar output like this:", "The weighted average ensemble performs ~1% better than the best single model w.r.t to the AUC as default score function. As you can see, models with a higher score also received higher weights. What happened under the hood? The fit() method optimizes the weights of the base-learners based on the performance of a target score function on the training dataset. Weight optimization search is performed with a greedy randomized search based on the dirichlet distribution on a validation dataset. Per default, the score function is the sklearn.metrics.roc_auc_score, but you can pass any score function to the constructors. The describe() method just prints the performance of the single models and of the ensemble on the validation dataset.", "This example takes a RandomForestRegressor from scikit-learn as meta-learner. The regression task is to optimize (predict) the output probability of the 10 classes based on the class probability output of the base-learners. But the classifier probabilities would also totally work here. DeepStack focus on flexibility and everything is up to you. This time we focus on the accuracy score and we could gain 4% accuracy with stacking when compared to the best model alone.", "In stacked generalization there is no limit in the number of stacking levels. However, a higher amount of levels do not necessarily guarantee better results. The best architecture can only be found by experimentation and by high variation between the base learners as discussed previously.", "Scikit-learn 0.22 introduces a StackingClassifier and StackingRegressor allowing you to have a stack of scikit-learn estimators with a final classifier or a regressor. Nice! We can now leverage the scikit-learn Stacking interface for building a 3rd level meta-learner with DeepStack:", "But why do I need DeepStack if scikit-learn is already supporting stacking? DeepStack is developed to be used in cases you have already an army of pre-trained models and wish to bundle (ensemble) them together creating an even more powerful model. I.e., you don\u2019t create or train your base-learners with DeepStack. DeepStack is also generic and is not dependent on the library used for creating the base-learners (keras, pytorch, tensorflow, you name it).The scikit-learn stacking API supports creating (training) base-learners from scratch with scikit-learn models \u2014 which is not our use-case here.", "And this is just scratching the surface. For using DeepStack with the output of any your pyTorch, tensorflow, etc. models and train meta-learners for them check the class deepstack.base.Member. You can also specify any custom target scoring function for the ensembles. DeepStack also allow you to save and load your ensembles for later optimisation.", "For the examples given above, we took a relatively simple CNN model trained on a few (25) epochs. In reality, more complex and well-trained models have been reported to reach up to 93.17% accuracy on CIFAR-10 with their weighted average ensembles reported to reach 94.12%. This 1% reduction in error-rate pushed the results beyond human classification accuracy.", "Got excited about trying DeepStack? Then happy ensembling!", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa8900ff42be9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@jcmborges?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jcmborges?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": "Julio Borges"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9fbe0b7dba70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&user=Julio+Borges&userId=9fbe0b7dba70&source=post_page-9fbe0b7dba70----a8900ff42be9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8900ff42be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8900ff42be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@manufactured?utm_source=medium&utm_medium=referral", "anchor_text": "Manuel Will"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.quora.com/What-machine-learning-approaches-have-won-most-Kaggle-competitions", "anchor_text": "Giuliano Janson at quora (2016)"}, {"url": "https://towardsdatascience.com/ensemble-methods-bagging-boosting-and-stacking-c9214a10a205", "anchor_text": "this article"}, {"url": "https://mlwave.com/kaggle-ensembling-guide/", "anchor_text": "Kaggle Ensembling Guide"}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR-10"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html", "anchor_text": "sklearn.metrics.roc_auc_score"}, {"url": "https://scikit-learn.org/dev/modules/generated/sklearn.ensemble.StackingClassifier.html#sklearn.ensemble.StackingClassifier", "anchor_text": "StackingClassifier"}, {"url": "https://scikit-learn.org/dev/modules/generated/sklearn.ensemble.StackingRegressor.html#sklearn.ensemble.StackingRegressor", "anchor_text": "StackingRegressor"}, {"url": "https://github.com/jcborges/DeepStack/blob/master/deepstack/base.py", "anchor_text": "deepstack.base.Member"}, {"url": "https://mlwave.com/kaggle-ensembling-guide/", "anchor_text": "reported"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a8900ff42be9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a8900ff42be9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/ensemble-learning?source=post_page-----a8900ff42be9---------------ensemble_learning-----------------", "anchor_text": "Ensemble Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a8900ff42be9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa8900ff42be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&user=Julio+Borges&userId=9fbe0b7dba70&source=-----a8900ff42be9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa8900ff42be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&user=Julio+Borges&userId=9fbe0b7dba70&source=-----a8900ff42be9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8900ff42be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa8900ff42be9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a8900ff42be9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a8900ff42be9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a8900ff42be9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a8900ff42be9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a8900ff42be9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jcmborges?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@jcmborges?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Julio Borges"}, {"url": "https://medium.com/@jcmborges/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "35 Followers"}, {"url": "https://www.linkedin.com/in/julio-borges/", "anchor_text": "https://www.linkedin.com/in/julio-borges/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9fbe0b7dba70&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&user=Julio+Borges&userId=9fbe0b7dba70&source=post_page-9fbe0b7dba70--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F9fbe0b7dba70%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-power-of-ensembles-in-deep-learning-a8900ff42be9&user=Julio+Borges&userId=9fbe0b7dba70&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}