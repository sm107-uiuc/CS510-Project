{"url": "https://towardsdatascience.com/predict-nba-games-make-money-machine-learning-project-b222b33f70a3", "time": 1683005579.567018, "path": "towardsdatascience.com/predict-nba-games-make-money-machine-learning-project-b222b33f70a3/", "webpage": {"metadata": {"title": "Predict NBA games, make money \u2014 machine learning project | by Caleb Cheng | Towards Data Science", "h1": "Predict NBA games, make money \u2014 machine learning project", "description": "The bettor and the bookie don\u2019t have much in common \u2014 one could describe their relationship as a rivalry. But in their sleep, they drool over the same fantasy: a model of historical performance so\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.sciencedirect.com/science/article/abs/pii/S016920701930007X?via%3Dihub", "anchor_text": "Exploiting sports-betting market using machine learning", "paragraph_index": 1}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1111/ecin.12404", "anchor_text": "Sentiment bias and asset prices: evidence from sports betting markets", "paragraph_index": 1}, {"url": "https://journals.sagepub.com/doi/abs/10.1177/1527002516656726", "anchor_text": "Sentiment bias in National Basketball Association Betting", "paragraph_index": 1}, {"url": "https://arxiv.org/abs/1310.6998", "anchor_text": "Predicting the NFL using Twitter", "paragraph_index": 1}, {"url": "https://github.com/swar/nba_api", "anchor_text": "using the nba_api Python library", "paragraph_index": 6}, {"url": "https://www.betexplorer.com", "anchor_text": "betexplorer", "paragraph_index": 6}, {"url": "https://github.com/calebcheng00/nba_predictions/blob/master/nba.ipynb", "anchor_text": "https://github.com/calebcheng00/nba_predictions/blob/master/nba.ipynb", "paragraph_index": 10}], "all_paragraphs": ["The bettor and the bookie don\u2019t have much in common \u2014 one could describe their relationship as a rivalry. But in their sleep, they drool over the same fantasy: a model of historical performance so perfect it predicts the outcome of future games with pinpoint precision. With deep learning, this might be possible \u2014 or at least easier than previous data science techniques.", "I read a lot of good and bad journal articles to see if this was possible and here are the good ones:Exploiting sports-betting market using machine learning (2018)Sentiment bias and asset prices: evidence from sports betting markets (2016)Sentiment bias in National Basketball Association Betting (2013)Predicting the NFL using Twitter (2013)", "The underlying assumption is that NBA markets are inefficient (the price or betting line does not reflect all available information for the game) \u2014 and maybe more inefficient than most markets because of the bias of hardcore fans to just bet on their favourite team. If you can bet against the inefficiencies of the market, you can make money. One of the ways we could identify inefficiencies is by analysing the cold hard numbers.", "Although many models that attempt this challenge are accurate, most are nowhere near close to making a profit. The reason for this is simple: the bookies are extremely accurate as well. Even if you match the bookie accuracy, you will lose because of the 5% betting fee/house edge.", "The graph on the left is bet365 money line vs actual win percentage. A successful model will have to predict those minute fluctuations of the bookie from the perfect regression.", "My model, built in Python with Tensorflow, analyses the past 11 NBA seasons and in many ways, is similar to every other deep learning model that attempted this problem with one crucial difference \u2014 it uses a custom loss function to decorrelate from the bookies. We are trying to pick the games the bookie has misgudged the actual percentage.", "I scraped the box score history using the nba_api Python library. The data is stored in a MongoDB collection. A total of 42 stats for each player, for each game, for the past 11 seasons were stored, ranging from free throw percentage to defensive rating to steal count. Betting data was scraped from betexplorer. Finding quality betting lines was much harder than training the model. Shoutout to Prof. \u0160trumbelj at University of Ljubjana, Slovenia for some tips.", "For each game, the sample was calculated using the averages of the last 8 games for each player from the beginning of the season. The top 8 players based on average gametime were chosen.", "The model is a combination of Conv2D and dense layers, with lots of dropout. The unique part of the model is the decorrelation loss, outlined by the first paper I mentioned. Although Keras doesn\u2019t natively support loss functions with the neuron value, wrapping a function in a function is a useful workaround. I trained the network for 20 epochs on a GTX 1660Ti until the network converged.", "Using a very primitive betting strategy of 10% of balance * model confidence, and only gambling on the games the model was > 0.6 confident in, we generate an upward balance trend. It\u2019s interesting that the model only bet on roughly 10% of the total games. Apart from the disasterous losing streak throughout the 2017\u201318 season, our model does pretty well and sits at $136 from an initial investment of $100, with a peak of $292.", "This is only the start of this model. With the encouraging results, I would like to develop a more dynamic betting strategy. If you would like to laugh at/pity me for the 1k lines of Jupyter notebook I wrote, the full unabridged, unedited notebook can be found here: https://github.com/calebcheng00/nba_predictions/blob/master/nba.ipynbThe only useful things are probably the betting scraping code and the model.", "Using NoSQL was a mistake, I should have stuck with SQLite but it was good to learn a new technology. Writing a custom loss function was a very valuable experience and will come in handy in future deep learning projects.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb222b33f70a3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://caleb-cheng.medium.com/?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": ""}, {"url": "https://caleb-cheng.medium.com/?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": "Caleb Cheng"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd88e6e520358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&user=Caleb+Cheng&userId=d88e6e520358&source=post_page-d88e6e520358----b222b33f70a3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb222b33f70a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb222b33f70a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.sciencedirect.com/science/article/abs/pii/S016920701930007X?via%3Dihub", "anchor_text": "Exploiting sports-betting market using machine learning"}, {"url": "https://onlinelibrary.wiley.com/doi/abs/10.1111/ecin.12404", "anchor_text": "Sentiment bias and asset prices: evidence from sports betting markets"}, {"url": "https://journals.sagepub.com/doi/abs/10.1177/1527002516656726", "anchor_text": "Sentiment bias in National Basketball Association Betting"}, {"url": "https://arxiv.org/abs/1310.6998", "anchor_text": "Predicting the NFL using Twitter"}, {"url": "https://www.football-data.co.uk/blog/nba_pinnacle_efficiency.php", "anchor_text": "https://www.football-data.co.uk/blog/nba_pinnacle_efficiency.php"}, {"url": "https://github.com/swar/nba_api", "anchor_text": "using the nba_api Python library"}, {"url": "https://www.betexplorer.com", "anchor_text": "betexplorer"}, {"url": "https://github.com/calebcheng00/nba_predictions/blob/master/nba.ipynb", "anchor_text": "https://github.com/calebcheng00/nba_predictions/blob/master/nba.ipynb"}, {"url": "https://medium.com/tag/betting?source=post_page-----b222b33f70a3---------------betting-----------------", "anchor_text": "Betting"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b222b33f70a3---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b222b33f70a3---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----b222b33f70a3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----b222b33f70a3---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb222b33f70a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&user=Caleb+Cheng&userId=d88e6e520358&source=-----b222b33f70a3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb222b33f70a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&user=Caleb+Cheng&userId=d88e6e520358&source=-----b222b33f70a3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb222b33f70a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb222b33f70a3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b222b33f70a3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b222b33f70a3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b222b33f70a3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b222b33f70a3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b222b33f70a3--------------------------------", "anchor_text": ""}, {"url": "https://caleb-cheng.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://caleb-cheng.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Caleb Cheng"}, {"url": "https://caleb-cheng.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "120 Followers"}, {"url": "http://gmail.com", "anchor_text": "gmail.com"}, {"url": "https://subscribe.to/caleb", "anchor_text": "https://subscribe.to/caleb"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd88e6e520358&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&user=Caleb+Cheng&userId=d88e6e520358&source=post_page-d88e6e520358--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe4a6e49d81a1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredict-nba-games-make-money-machine-learning-project-b222b33f70a3&newsletterV3=d88e6e520358&newsletterV3Id=e4a6e49d81a1&user=Caleb+Cheng&userId=d88e6e520358&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}