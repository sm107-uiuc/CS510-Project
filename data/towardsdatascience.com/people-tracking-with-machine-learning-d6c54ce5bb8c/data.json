{"url": "https://towardsdatascience.com/people-tracking-with-machine-learning-d6c54ce5bb8c", "time": 1683000157.906295, "path": "towardsdatascience.com/people-tracking-with-machine-learning-d6c54ce5bb8c/", "webpage": {"metadata": {"title": "People Tracking with Machine Learning | by Marco Cerliani | Towards Data Science", "h1": "People Tracking with Machine Learning", "description": "Is your window attractive effectively? How much your goods are easily available to a shopper? If you are an open-minded owner of a little grocery, or if you are a visual merchandiser of a clothing\u2026"}, "outgoing_paragraph_urls": [{"url": "http://imageai.org/", "anchor_text": "ImageAI library", "paragraph_index": 6}], "all_paragraphs": ["Is your window attractive effectively? How much your goods are easily available to a shopper? If you are an open-minded owner of a little grocery, or if you are a visual merchandiser of a clothing store, you need to know that these are typical examples of questions which AI can help to answer. Not only retailers adopt AI solutions to improve customer experience but also directly increase their business. In this way, a proper question can be: how much a particular store convert the outdoor footfall?", "The perfect trade-offs between marketing effectiveness and total cost-to-serve need to be evaluated simultaneously to both influence consumer behavior and achieve cost optimization. In this scenario, AI solutions seem to represent a high-value possibility.", "In this post, I produce a funny application which aims to track people inside shops and takes care of their historical movements, in order to detect their behaviors. With the actual state of the art of Machine Learning and Computer Vision techniques, we\u2019ve tons of powerful instruments in our hands to complete tasks like this one with great performances\u2026 You don\u2019t need to reinvent the wheel, you need to know how to use the wheel to make your car better.", "For this particular challenge, we don\u2019t need a dataset with labeled data, i.e. we consume pre-trained model which are already specialized in similar domains. Our ability is to correctly adapt them to the situation of our interest. People detection is a classical field of application in Computer Vision and a lot of models are trained to discriminate this standard class, achieving high performances.", "We only have to find meaningful data to test our approach. I want to find data in video format showing shopper movements inside a fixed shop layout. Security cam videos suit perfectly for this purpose! They are easily available resources on the web and reflect our needs to have a \u2018Big Brother\u2019 which watches everything inside the shop. I found on YouTube the right candidates for our experiment and I downloaded them on my PC.", "These videos are of a discrete quality and are not so heavy (on average 3 minutes) so they are perfect for us!", "I\u2019ve chosen, to carry out our task, the ImageAI library. This opensource project enables everybody to easily integrate state-of-the-art Artificial Intelligence features into our new and existing applications and systems. With a few lines of code, you can access a list of state-of-the-art Machine Learning algorithms for image prediction and object detection. All the dirty jobs (preprocess, query of the model, output results\u2026) are already done for us and live behind the scenes.", "So, is our work already finish? Not yet, fortunately\u2026 the added values are directly given by us building an intelligent workflow which is able to answer our infamous questions.", "We have at disposal raw videos in mp4 format; as the first stage of our action plan, we have to swap video into images. This is easy and can be achieved simply sampling frames at a fixed given frequency from the original video. In python:", "I\u2019ve fixed frequency rate (fr) at 12: i.e. if a given video has a frequency of 30 frames per second, we are collecting one frame per second, which is a good approximation for tracking people.", "In the second stage, we initialize all the ImageAI tools. With only a few rows we can access very powerful pre-trained object detection models.", "I\u2019ve chosen Tiny YOLO for object detection (easily available for download from ImageAI documentation page in h5 format) because it allows a good trade-off between performance and speed. This network works well and all the workflow is able to process a frame in less than a second!", "The funny part comes now. We have to translate the data we\u2019ve collected (images from videos) in something useful for us: that it is at the same time easy to understand and that it contains valuable information. The perfect choice is a heatmap representation which permits us to give value to the information we\u2019ve stored from the people detection task. If it isn\u2019t still so clear, let me paint\u2026", "This is possible in a very elegant way thanks to the power of ImageAI: their detectors return as output the detected object with the associated coordinates of bounding boxes. In the case of people, we extract only the bottom part of the boxes to provide an interpretable overlapping with this information and the planimetry of the store. With these results easily accessible, we can build a frequency map in form of heatmap representation (at right overlapped with a map of the store) and a mask of paths (at left). In order to grant further interpretability, we exclude the bottom parts of the frames: these regions are subject to \u2018false detections\u2019, i.e. our model is too clever and recognize person also with half body corrupting the heatmap calculation.", "These results tell us the paths followed by the buyers and where they are staying longer.", "The \u2018hottest zones\u2019 are where people have focused more. In the longest videos (the latest two I\u2019ve processed) these areas are immediately clear! Now imagine to have more video materials at our disposal, how many customer behaviors are we able to detect?", "In this post, I produce a Computer Vision solution to track people inside shops. People detection is a consolidate task in Machine Learning, so we try to applicate this knowledge (with the relative high performances) in a different domain. Given a video showing a normal shopping routine, we are able to detect shopper behaviors and paths. These are golden information for every retailer in order to improve their business in different ways: exhibition of goods, store layout, employee efficiency, inventory level and much more.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd6c54ce5bb8c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----d6c54ce5bb8c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd6c54ce5bb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd6c54ce5bb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@srz?utm_source=medium&utm_medium=referral", "anchor_text": "sydney Rae"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.youtube.com/watch?v=osN_4ril08Q", "anchor_text": "Video1"}, {"url": "https://www.youtube.com/watch?v=LsGb4gbuIpc", "anchor_text": "Video2"}, {"url": "https://www.youtube.com/watch?v=0yNiX9nt43U", "anchor_text": "Video3"}, {"url": "http://imageai.org/", "anchor_text": "ImageAI library"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d6c54ce5bb8c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d6c54ce5bb8c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----d6c54ce5bb8c---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/tracking?source=post_page-----d6c54ce5bb8c---------------tracking-----------------", "anchor_text": "Tracking"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----d6c54ce5bb8c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd6c54ce5bb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&user=Marco+Cerliani&userId=c843902314c7&source=-----d6c54ce5bb8c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd6c54ce5bb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&user=Marco+Cerliani&userId=c843902314c7&source=-----d6c54ce5bb8c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd6c54ce5bb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd6c54ce5bb8c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d6c54ce5bb8c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d6c54ce5bb8c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpeople-tracking-with-machine-learning-d6c54ce5bb8c&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}