{"url": "https://towardsdatascience.com/predicting-hotel-cancellations-using-interpretml-e4e64fefc7a8", "time": 1683008620.7766058, "path": "towardsdatascience.com/predicting-hotel-cancellations-using-interpretml-e4e64fefc7a8/", "webpage": {"metadata": {"title": "Predicting Hotel Cancellations Using InterpretML | by Michael Grogan | Towards Data Science", "h1": "Predicting Hotel Cancellations Using InterpretML", "description": "In order to deploy models into production and make research findings understandable to a non-technical audience, intelligibility or understanding of model findings are just as important as accuracy\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/MGCodesandStats/hotel-modelling", "anchor_text": "here", "paragraph_index": 33}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com", "paragraph_index": 36}], "all_paragraphs": ["In order to deploy models into production and make research findings understandable to a non-technical audience, intelligibility or understanding of model findings are just as important as accuracy.", "The purpose of the InterpretML package developed by Microsoft is to allow for increased intelligibility of black box machine learning models, while maintaining strong accuracy performance.", "Here is an example of the use of the Explainable Boosting Machine (EBM) in predicting whether a customer will cancel their hotel booking or not (1 = customer cancels, 0 = customer does not cancel).", "The H1 dataset is used for training purposes, while H2 is used for testing the model predictions.", "The original datasets and research by Antonio et al. can be found at the reference at the end of this article. Here is a sample of the dataset:", "All features in the dataset are included, with the exception of variables containing NULL values (children, agent, company), along with ReservationStatusDate.", "The MinMaxScaler is used to transform the features to a scale between 0 and 1.", "Given that there are more incidences of non-cancellations (0) than cancellations (1), the SMOTE oversampling method is used to create sample training data to simulate feature data for the cancellation incidences.", "The incidences of 0s and 1s are now equal.", "The Explainable Boosting Classifier is used as the training model.", "The validation accuracy comes in at 62%.", "When comparing the accuracy scores, we see that numerous readings are provided in each confusion matrix.", "However, a particularly important distinction exists between precision and recall.", "The two readings are often at odds with each other, i.e. it is often not possible to increase precision without reducing recall, and vice versa.", "An assessment as to the ideal metric to use depends in large part on the specific data under analysis. For example, cancer detection screenings that have false negatives (i.e. indicating patients do not have cancer when in fact they do), is a big no-no. Under this scenario, recall is the ideal metric.", "However, for emails \u2014 one might prefer to avoid false positives, i.e. sending an important email to the spam folder when in fact it is legitimate.", "The f1-score takes both precision and recall into account when devising a more general score.", "Which would be more important for predicting hotel cancellations?", "Well, from the point of view of a hotel \u2014 they would likely wish to identify customers who are ultimately going to cancel their booking with greater accuracy \u2014 this allows the hotel to better allocate rooms and resources. Identifying customers who are not going to cancel their bookings may not necessarily add value to the hotel\u2019s analysis, as the hotel knows that a significant proportion of customers will ultimately follow through with their bookings in any case.", "When running the model on the test set (H2) \u2014 the following confusion matrix indicates a 55% accuracy overall based on the f1-score, while recall for the cancellation class is at 87% (meaning that of all customers who cancel their booking \u2014 the model identifies 87% of them correctly):", "Here is the generated ROC curve:", "The top 5 features are identified.", "Lead time (feature 1), stays on weekend nights (feature 5), required car parking spaces (feature 15), country (feature 19), and assigned room type (feature 23) are identified as the five most influential factors on whether a customer will cancel their hotel booking or not.", "Let\u2019s compare the accuracy metrics from the confusion matrix to that of a standard XGBoost model run using the same features:", "Recall for XGBoost is slightly higher at 94%, while overall accuracy remains at 55%.", "Let\u2019s see how the RandomForestClassifier fares as a black box classification system for this problem.", "Let\u2019s take a look at the identified features in order of importance.", "While the importance of features differs somewhat from the Explainable Boosting Classifier, required car parking spaces and country (features 15 and 19) are still identified as important influencing factors on hotel cancellations.", "Here is the ROC curve generated on the test set:", "Here is the associated confusion matrix:", "Overall accuracy based on the f1-score is much higher at 74%, while recall for the cancellation class is significantly lower at 46%. In this regard, this model does a better job at predicting the overall outcome (both cancellations and non-cancellations).", "However, if we are looking to predict specifically which customers will cancel their booking, then the Explainable Boosting Classifier is a better model for this purpose.", "As mentioned, the emphasis of InterpretML is on making model results intelligible as well as accurate. From this standpoint, this library is a very useful tool in allowing for an intuitive and understandable display of results.", "Many thanks for reading, and the GitHub repository for this project with associated code can be found here.", "Disclaimer: This article is written on an \u201cas is\u201d basis and without warranty. It was written with the intention of providing an overview of data science concepts, and should not be interpreted as professional advice in any way.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Science Consultant with expertise in economics, time series analysis, and Bayesian methods | michael-grogan.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe4e64fefc7a8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178----e4e64fefc7a8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe4e64fefc7a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe4e64fefc7a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/MGCodesandStats/hotel-modelling", "anchor_text": "here"}, {"url": "https://www.sciencedirect.com/science/article/pii/S2352340918315191", "anchor_text": "Antonio, Almedia and Nunes (2019). Hotel Booking Demand Datasets"}, {"url": "https://github.com/interpretml/interpret", "anchor_text": "GitHub: Fit interpretable models. Explain blackbox machine learning."}, {"url": "https://www.youtube.com/watch?v=MREiHgHgl0k", "anchor_text": "Microsoft Developer: The Science Behind InterpretML: Explainable Boosting Machine"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e4e64fefc7a8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----e4e64fefc7a8---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/interpretml?source=post_page-----e4e64fefc7a8---------------interpretml-----------------", "anchor_text": "Interpretml"}, {"url": "https://medium.com/tag/intelligible?source=post_page-----e4e64fefc7a8---------------intelligible-----------------", "anchor_text": "Intelligible"}, {"url": "https://medium.com/tag/fair?source=post_page-----e4e64fefc7a8---------------fair-----------------", "anchor_text": "Fair"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe4e64fefc7a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&user=Michael+Grogan&userId=eec017a8b178&source=-----e4e64fefc7a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe4e64fefc7a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&user=Michael+Grogan&userId=eec017a8b178&source=-----e4e64fefc7a8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe4e64fefc7a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe4e64fefc7a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e4e64fefc7a8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e4e64fefc7a8--------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://mgcodesandstats.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Michael Grogan"}, {"url": "https://mgcodesandstats.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://michael-grogan.com", "anchor_text": "michael-grogan.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feec017a8b178&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&user=Michael+Grogan&userId=eec017a8b178&source=post_page-eec017a8b178--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3c6e2607915&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpredicting-hotel-cancellations-using-interpretml-e4e64fefc7a8&newsletterV3=eec017a8b178&newsletterV3Id=3c6e2607915&user=Michael+Grogan&userId=eec017a8b178&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}