{"url": "https://towardsdatascience.com/lets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef", "time": 1682995060.7343628, "path": "towardsdatascience.com/lets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef/", "webpage": {"metadata": {"title": "Let\u2019s make some molecules with machine learning! \u269b\ufe0f | by Flawnson Tong | Towards Data Science", "h1": "Let\u2019s make some molecules with machine learning! \u269b\ufe0f", "description": "In April 1912, the RMS Titanic collided with an iceberg in the Atlantic while on her maiden voyage, drowning 1,500 lives and making history. Decades later, the wreck was recovered, still rich with\u2026"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/p/9434f3f8a593/edit", "anchor_text": "A.I enhanced molecular discovery and optimization", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/rps-intro-to-differentiable-neural-computers-e6640b5aa73a", "anchor_text": "DNCs", "paragraph_index": 34}, {"url": "http://www.linkedin.com/in/flawnson", "anchor_text": "LinkedIn", "paragraph_index": 41}, {"url": "https://www.facebook.com/flawnson", "anchor_text": "Facebook", "paragraph_index": 41}, {"url": "https://www.instagram.com/flaws.non/?hl=en", "anchor_text": "Instagram", "paragraph_index": 41}, {"url": "https://medium.com/@flawnsontong1", "anchor_text": "Medium", "paragraph_index": 41}, {"url": "http://www.flawnson.com", "anchor_text": "my website", "paragraph_index": 42}, {"url": "https://github.com/flawnson", "anchor_text": "GitHub", "paragraph_index": 42}, {"url": "http://mail.google.com", "anchor_text": "flawnsontong1@gmail.com", "paragraph_index": 43}, {"url": "https://usejournal.com/?utm_source=medium.com&utm_medium=noteworthy_blog&utm_campaign=guest_post_read_later_text", "anchor_text": "Journal", "paragraph_index": 45}, {"url": "https://usejournal.com/newsletter/?utm_source=medium.com&utm_medium=noteworthy_blog&utm_campaign=guest_post_text", "anchor_text": "Get the noteworthy newsletter >", "paragraph_index": 46}], "all_paragraphs": ["It takes 10 years on average for a new molecule to reach the mass market.", "In April 1912, the RMS Titanic collided with an iceberg in the Atlantic while on her maiden voyage, drowning 1,500 lives and making history. Decades later, the wreck was recovered, still rich with 20th century history. A couple months after recovering the Titanic, the Challenger space shuttle was set to launch with the eager eyes of millions watching from screens across the nation. 73 seconds from launch, the shuttle exploded in midair.", "The fundamental problem with both disasters lie beyond human error and design. The problem is in the material. The hull of the Titanic failed as much as the right rocket booster of the Challenger. We remember these events as tragedies not because they happened, but rather because they could have been prevented. Better materials where known whilst the Titanic and Challenger where being built. But simply knowing that there exist better materials is not enough; they have to be available and applicable.", "The problem, is the immense time it takes for a molecule to get from knowledge to application. Today, the average time is 10 years.", "10 years is enough for trillions of dollars to be spent, half a billion people to die, and millions of hours wasted trying to solve problems that could have been made much less severe if only we had the right material or drug.", "This isn\u2019t new. Historically, scientific progress has been slow. Tools made of stone remained the standard for centuries, and medical treatments that were usually more harmful than helpful where prescribed regularly. It wasn\u2019t until humanity placed emphasis on the advancement of science did we begin creating better technology, thus beginning the positive feedback loop:", "For a while, this feedback loop resulted in stable linear growth. But as our mastery of science grew, so too did our technological advancements. With the advent of technology like A.I, this growth is bound to accelerate exponentially.", "A.I is making waves in the domain of science by giving researchers more control over molecular space.", "In my previous article, A.I enhanced molecular discovery and optimization, current methods of accelerating science with A.I where discussed at a high level. Here I\u2019ll be walking through a recent project of mine that follows the most common workflow/pipeline that is employed in current research of ML applications in the domain of science.", "The goal of this project is to generate novel molecules with a Recurrent Neural Network. These molecules might not be useful, perhaps not even valid, but the idea is to train the model to learn the patterns in SMILES strings such that the output resembles valid molecules. SMILES is a string representation of a molecule, based off the structure and components of a given molecule. For example, Ciprofloxacin looks a bit like this:", "The neural network of choice depends on the type of data we\u2019ll be feeding it. In this case, we\u2019ll be feeding it SMILES strings as data, so a Recurrent Neural Network (RNN) is best suited for the job. It\u2019s custom to enhance the inner architecture of an RNN with it\u2019s more efficient and effective relative; the LSTM cell. We\u2019ll be using a couple layers consisting of LSTMs, trained on a dataset of over 200,000 SMILES strings.", "The first step, as is in most language processing RNNs, is to create a mapping of characters to integers (to allow the neural network to process the data) and vice versa (to translate results back to characters).", "The easiest way to do this is by creating a set of unique characters and enumerate each item. In a natural language like English, there are 26 letters (double that for capital letters), along with a whole host of grammatical symbols and syntax characters. In SMILES strings, there are two types of characters:", "This list of unique characters is enumerated and conveniently placed into a dictionary.", "It\u2019s worth noting that the dictionary does not consider elemental symbols consisting of 2 characters as a single element. For example, the \u201cS\u201d and \u201ci\u201d of the elemental symbol for Silicon counts as 2 independent characters. This means that the model will have to learn the difference between \u201cSi\u201d and \u201cS\u201d, which are both entirely different elements. It\u2019s totally possible to hard code these 2-character symbols into the dictionary, but just for fun, I left them separate to see how well the model would perform.", "Once you have your unique character mapping, you can go about translating every character in the SMILES string dataset into integers. A simple call of the dictionary we built in Step 1 should do the trick.", "At the same time, you can normalize all the integers by simply dividing each by the total number of unique characters in the dataset. Finally, reshape the resulting integerized and normalized dataset into a format that fits the neural network model.", "Using Keras, building the model is super easy.", "Our model has multiple layers, each with a decreasing number of neurons per hidden layer; feel free to play around with these numbers. It\u2019s a big generalization but the rule of thumb is, the more layers and neurons in the neural network, the more computationally intensive, but also the better its performance.", "We\u2019ve all been there. You\u2019ve made lots of progress on that essay or report you\u2019ve been writing when all of a sudden your computer glitches out \u2014 and all your work disappears into the abyss. Incidentally, training neural networks has the same problem. Thankfully, there\u2019s a solution.", "Remember in the new Mario games, once you got past the halfway mark, the game would save your progress?", "Checkpoints are a built in function in the Keras library that allows us to save our training progress (the weights of the model at any given epoch) in a file, which can then be transferred to another device or saved for later. Checkpointing is probably the least appreciated yet one of the most useful machine learning know-hows to have up your sleeve.", "Checkpoints are especially useful for separating the training from the predicting, classifying, or generating steps. By training on a GPU or Cloud service before loading the saved weights on a CPU, you could cut down the time needed to complete a project. Checkpoints are therefore useful for transfer learning, or to simply pause and resume training. They can also be used to sample the output of your model for each improving epoch, giving a little more transparency into the network model.", "I used categorical cross entropy as the loss function with an Adam optimizer (A mix of RMS-prop with ADAgrad and a built in momentum). To take advantage of as much of the dataset as possible, the model was given 19 epochs of 512 batch size to learn from. Generally, more epochs paired with smaller batch sizes allow the network to learn from the data much better, but at the cost of a much longer training time.", "Generating is relatively straight forward. First we import the checkpoints that we saved from training (so that we don\u2019t have to retrain the model every time we want to generate a new molecule). The next step is to select a random SMILES string from the dataset as reference, and finally generate a specified number of characters.", "Results will vary according to the choice of dataset size, learning rate, and other custom adjustments that can be made to the model, but ideally, you should get an output that resembles something like a valid molecule. If you plug in a checkpoint file with a lower accuracy, you could actually see how the neural network learns and gets better over time. Usually, it starts with a sequence of just once character:", "But it gets better over time to include alternating characters", "Eventually the output will be even more diverse as it learns substructures", "The goal is to get is as close to", "This project could be enhanced in a couple different ways, some centered around the data and others around the architecture of the model itself.", "The dataset of 200k molecules, while impressive, wouldn\u2019t hurt if it where bigger. Apart from scouring the internet for more SMILES strings, a possible technique that could be implemented is data augmentation.", "Data augmentation is actually similar to an Andy Warhol painting; take one image, change it a bit, and add it to your dataset. That, in essence, is data augmentation, albeit oversimplified. The same can be done to SMILES strings; take the string, find it\u2019s permutations, and add it to your dataset.", "In this case, the goal of the project is to generate molecules that are as close to valid as possible, not molecules that have a specified or desired property. This eliminates the risk of biasing results towards one specific type of molecule, hence it is safe to augment our existing dataset of 200k molecules. We can augment data by enumerating the SMILES strings beyond it\u2019s canonical form, which basically means write the same SMILES string in another way, all of which ultimately represent the same molecule. This gives the model significantly more strings to learn from, as each molecule has many different SMILES strings, the number of which increases as the size and complexity of the molecule increases.", "In this project, and LSTM was used as the main node in each layer. There exists however, plenty of other powerful options. Neural Turing Machines (NTM) and it\u2019s bigger brother, the Differentiable Neural Computer (DNCs) for example, are both state of the art architectures created by researchers at Google. Both architectures are powerful. NTMs and DNCs are impressive due to an external component that allows them to \u201cremember\u201d things better than LSTMs. This external component acts as a sort of memory bank.", "You can read all about it in these blog posts (NTMs, DNCs) and research papers (NTMs, DNCs) about them, or get a high level overview in my article about all the members of the RNN architecture family. Essentially, these two powerful alternatives both have memory banks with built in attention mechanisms, which allow them to selectively memorize portions of data (in this case text, but can also be for images), that are learned to be very important. This could be really useful in the generation of molecules with desirable properties, since some properties like toxicity are determined by a substructure within the molecule, which, when translated in terms of SMILES, is a specific portion of the string.", "There are other factors to consider, such as the abundance of other possible datasets and formats (Ex. different type of molecular representation instead of SMILES, such as SMARTS) and architecture improvements (Ex. the use of adversarial training or reinforcement learning). There are already some noteworthy implementations of both improvements available.", "There are some pretty awesome tools out there for large scale and high quality productions that not many are aware of. Computational material science, biology, chemistry, and physics projects will use packages like:", "These specialized packages are congruent with Python\u2019s built in and extended libraries, meaning they can be used together with numpy, scipy, matplotlib, etc. for projects. Future work will explore what these toolkits can do!", "Project Novel is an example of the most rudimentary way molecules can be generated with basic M.L tools and a solid dataset. Most research will combine aspects from other architectures like adversarial training, or reinforcement learning to boost the validity of generated molecules or bias the results of the model towards molecules with desired properties.", "Even at it\u2019s best, LSTMs have a limit to how convincing it can make a sample of generated text look. The reason lies in SMILES strings themselves, which are not the optimal way to represent molecules computationally. In the near future there will likely be better frameworks available specifically for cheminformatics and related scientific fields. For now however, the standard remains set at the dynamic duo of recurrent neural nets and molecular string representations.", "In my next post, we\u2019ll take a dive into where the intersection of science and A.I is heading towards and what will change as M.L accelerates science.", "Follow me on LinkedIn, Facebook, Instagram, and of course, Medium for more content.", "All my content is on my website and all my projects are on GitHub", "I\u2019m always looking to meet new people, collaborate, or learn something new so feel free to reach out to flawnsontong1@gmail.com", "Upwards and onwards, always and only \ud83d\ude80", "\ud83d\udcdd Read this story later in Journal.", "\ud83d\uddde Wake up every Sunday morning to the week\u2019s most noteworthy Tech stories, opinions, and news waiting in your inbox: Get the noteworthy newsletter >", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Using machine learning to accelerate science one step at a time :)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F429b8838e3ef&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://flawnsontong.medium.com/?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": ""}, {"url": "https://flawnsontong.medium.com/?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": "Flawnson Tong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa1dcfdd487e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&user=Flawnson+Tong&userId=a1dcfdd487e6&source=post_page-a1dcfdd487e6----429b8838e3ef---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F429b8838e3ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F429b8838e3ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://medium.com/p/9434f3f8a593/edit", "anchor_text": "A.I enhanced molecular discovery and optimization"}, {"url": "https://towardsdatascience.com/rps-intro-to-differentiable-neural-computers-e6640b5aa73a", "anchor_text": "DNCs"}, {"url": "http://www.linkedin.com/in/flawnson", "anchor_text": "LinkedIn"}, {"url": "https://www.facebook.com/flawnson", "anchor_text": "Facebook"}, {"url": "https://www.instagram.com/flaws.non/?hl=en", "anchor_text": "Instagram"}, {"url": "https://medium.com/@flawnsontong1", "anchor_text": "Medium"}, {"url": "http://www.flawnson.com", "anchor_text": "my website"}, {"url": "https://github.com/flawnson", "anchor_text": "GitHub"}, {"url": "http://mail.google.com", "anchor_text": "flawnsontong1@gmail.com"}, {"url": "https://usejournal.com/?utm_source=medium.com&utm_medium=noteworthy_blog&utm_campaign=guest_post_image", "anchor_text": ""}, {"url": "https://usejournal.com/?utm_source=medium.com&utm_medium=noteworthy_blog&utm_campaign=guest_post_read_later_text", "anchor_text": "Journal"}, {"url": "https://usejournal.com/newsletter/?utm_source=medium.com&utm_medium=noteworthy_blog&utm_campaign=guest_post_text", "anchor_text": "Get the noteworthy newsletter >"}, {"url": "https://medium.com/tag/science?source=post_page-----429b8838e3ef---------------science-----------------", "anchor_text": "Science"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----429b8838e3ef---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/technology?source=post_page-----429b8838e3ef---------------technology-----------------", "anchor_text": "Technology"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----429b8838e3ef---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/startup?source=post_page-----429b8838e3ef---------------startup-----------------", "anchor_text": "Startup"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F429b8838e3ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%25EF%25B8%258F-429b8838e3ef&user=Flawnson+Tong&userId=a1dcfdd487e6&source=-----429b8838e3ef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F429b8838e3ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%25EF%25B8%258F-429b8838e3ef&user=Flawnson+Tong&userId=a1dcfdd487e6&source=-----429b8838e3ef---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F429b8838e3ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F429b8838e3ef&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----429b8838e3ef---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----429b8838e3ef--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----429b8838e3ef--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----429b8838e3ef--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----429b8838e3ef--------------------------------", "anchor_text": ""}, {"url": "https://flawnsontong.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://flawnsontong.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Flawnson Tong"}, {"url": "https://flawnsontong.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa1dcfdd487e6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&user=Flawnson+Tong&userId=a1dcfdd487e6&source=post_page-a1dcfdd487e6--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8d63c32fc3a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flets-make-some-molecules-with-machine-learning-%EF%B8%8F-429b8838e3ef&newsletterV3=a1dcfdd487e6&newsletterV3Id=8d63c32fc3a0&user=Flawnson+Tong&userId=a1dcfdd487e6&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}