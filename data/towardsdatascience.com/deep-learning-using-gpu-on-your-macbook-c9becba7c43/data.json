{"url": "https://towardsdatascience.com/deep-learning-using-gpu-on-your-macbook-c9becba7c43", "time": 1683004119.5265799, "path": "towardsdatascience.com/deep-learning-using-gpu-on-your-macbook-c9becba7c43/", "webpage": {"metadata": {"title": "Deep Learning using GPU on your MacBook | by Frank Xu | Towards Data Science", "h1": "Deep Learning using GPU on your MacBook", "description": "As an owner of MacBook Pro, I am aware of the frustration of not being able to utilize its GPU to do deep learning, considering the incredible quality and texture, and of course, the price of it. I\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/CUDA", "anchor_text": "CUDA", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Amdahl%27s_law", "anchor_text": "Amdahl\u2019s law", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Linus_Torvalds", "anchor_text": "Linus Torvalds", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/how-to-start-a-data-science-project-using-google-cloud-platform-6618b7c6edd2", "anchor_text": "last story", "paragraph_index": 13}, {"url": "https://github.com/Frank-Xu-Huaze/Medium/blob/master/PlaidML_CNN/PlaidML_Fashion_mnist.ipynb", "anchor_text": "github", "paragraph_index": 19}, {"url": "https://keras.io", "anchor_text": "Keras", "paragraph_index": 20}, {"url": "https://onnx.ai", "anchor_text": "ONNX", "paragraph_index": 20}, {"url": "https://pypi.org/project/ngraph-core/", "anchor_text": "NGraph", "paragraph_index": 20}, {"url": "https://github.com/plaidml/plaidml", "anchor_text": "PlaidML github page", "paragraph_index": 20}], "all_paragraphs": ["As an owner of MacBook Pro, I am aware of the frustration of not being able to utilize its GPU to do deep learning, considering the incredible quality and texture, and of course, the price of it. I still remember when I was choosing between MacBook Pro 13\u2019 and 15\u2019, back when I was not familiar with Data Science at all, I chose the 15\u2019 just because it has a discrete AMD GPU. Soon I found out that extra piece of GPU brought almost no help when it comes to Machine Learning & Deep Learning. For a long time, the majority of modern machine learning models can only utilize Nvidia GPUs through the general-purpose GPU library CUDA.", "However, it\u2019s already 2020 now and things could be a little bit different today: PlaidML was initially released in 2017 by Vertex.AI designed to bring \u201cdeep learning for every platform\u201d. Since the acquisition by Intel in 2018 and the later 0.3.3 version release, you can utilize your AMD and Intel GPUs to do Parallel Deep Learning jobs with Keras. And since the 0.7.0 release on Jan 15 this year, PlaidML includes full Stripe backends for GPU & CPU for all major targets. But first of all, why do we need to use GPU to do Parallel computing?", "Let\u2019s take the example of constructing a house: If you are solely on your own, let\u2019s say it might take 400 hours to build the house. However, if you hire an extra construction worker to build it with you together, it will only take 200 hours to build it since you split the work in half. Similarly, the more workers you hire, the sooner you can get the house built. There\u2019s a well-known Amdahl\u2019s law describing how well a program can speed up when we add more processors (workers).", "Ok, then why using GPUs? GPUs, as known as Graphics Processing Units, obviously are not designed for doing deep learning in the first place. However, the essence of parallel computing seems to be similar to that of graphics processing: The cores of a GPU, though weaker, are more efficient than a CPU for algorithms that process large blocks of data due to their highly parallel structure and the number of cores (a GPU consists of hundreds of computationally weak cores, while a CPU consists of generally 4 to up 32 more powerful cores). Due to the similar inner nature of graphics processing and deep learning (that most operations can be done at the same time instead of one after another), GPU became the natural first choice to utilize when for deep learning and parallel computing.", "As one of my favorite quotes from Linus Torvalds says:", "\u201cTalk is cheap. Show me the code.\u201d", "Let\u2019s get our hands on and use your own laptop to run a simple case of CNN using your GPU!", "First of all, make sure your laptop/PC has a working Python3 environment. I would recommend running under a virtual environment any time:", "keep in mind that Keras under TensorFlow will not work using PlaidML.", "First you will see a welcome page and a question asking you whether to use experimental device support. As it suggested, using the experimental devices can cause poor performance, crashes and other nastiness, you can type in \u201cn\u201d or nothing, then return to choose using default config devices.", "Now you get a list of all the devices you can choose. For my Macbook Pro 15\u2019 2018, the following options are:", "I choose 3 because that AMD is the most powerful one available.", "Finally, type \u201cy\u201d or nothing and return to save settings. Now you are fully setup and ready for a Deep Learning Project using your GPU.", "First of all, let us start up a Jupyter Notebook. (Not sure why using a Jupyter Notebook or how to? Check my last story for more details).", "You need to run these lines of codes in the exact sequence to utilize PlaidML as Keras Backend, otherwise it would be using TensorFlow by default.", "Now we import packages and download the fashion dataset.", "We will build a simple CNN (Convolutional Neural Network) using Keras Sequential model and compile it.", "Now we fit the model and test the accuracy.", "We trained a CNN model with around 91% accuracy on categorizing the fashion data set with only around 2 minutes! You might think that is not so impressive, but look at the comparison versus my laptop\u2019s CPU:", "From the comparison above we can see that with the GPU on my MacBook Pro was about 15 times faster than using the CPU on running this simple CNN code. With the help of PlaidML, it is no longer intolerable to do deep learning with your own laptop. The full script of this project can be found at my github.", "Up to today (Feb 2020), PlaidML already supports Keras, ONNX and NGraph. It works well on GPUs, and it doesn\u2019t require use of CUDA/cuDNN on Nvidia hardware, while achieving comparable performance. There are more demos and related projects on the PlaidML github page. There might be a chance that your GPU could not be fully support by PlaidML for now, but I believe that GPU learning will not be a privilege of Nvidia anymore real soon.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc9becba7c43&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9becba7c43--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9becba7c43--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://franknb.medium.com/?source=post_page-----c9becba7c43--------------------------------", "anchor_text": ""}, {"url": "https://franknb.medium.com/?source=post_page-----c9becba7c43--------------------------------", "anchor_text": "Frank Xu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F545cf0b2e26c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&user=Frank+Xu&userId=545cf0b2e26c&source=post_page-545cf0b2e26c----c9becba7c43---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9becba7c43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9becba7c43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/CUDA", "anchor_text": "CUDA"}, {"url": "https://en.wikipedia.org/wiki/Amdahl%27s_law", "anchor_text": "Amdahl\u2019s law"}, {"url": "https://en.wikipedia.org/wiki/Linus_Torvalds", "anchor_text": "Linus Torvalds"}, {"url": "https://towardsdatascience.com/how-to-start-a-data-science-project-using-google-cloud-platform-6618b7c6edd2", "anchor_text": "last story"}, {"url": "https://github.com/Frank-Xu-Huaze/Medium/blob/master/PlaidML_CNN/PlaidML_Fashion_mnist.ipynb", "anchor_text": "github"}, {"url": "https://keras.io", "anchor_text": "Keras"}, {"url": "https://onnx.ai", "anchor_text": "ONNX"}, {"url": "https://pypi.org/project/ngraph-core/", "anchor_text": "NGraph"}, {"url": "https://github.com/plaidml/plaidml", "anchor_text": "PlaidML github page"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c9becba7c43---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c9becba7c43---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c9becba7c43---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----c9becba7c43---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----c9becba7c43---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9becba7c43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&user=Frank+Xu&userId=545cf0b2e26c&source=-----c9becba7c43---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc9becba7c43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&user=Frank+Xu&userId=545cf0b2e26c&source=-----c9becba7c43---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc9becba7c43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c9becba7c43--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc9becba7c43&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c9becba7c43---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c9becba7c43--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c9becba7c43--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c9becba7c43--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c9becba7c43--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c9becba7c43--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c9becba7c43--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c9becba7c43--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c9becba7c43--------------------------------", "anchor_text": ""}, {"url": "https://franknb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://franknb.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Frank Xu"}, {"url": "https://franknb.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "186 Followers"}, {"url": "https://www.linkedin.com/in/frank-xu-huaze/", "anchor_text": "https://www.linkedin.com/in/frank-xu-huaze/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F545cf0b2e26c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&user=Frank+Xu&userId=545cf0b2e26c&source=post_page-545cf0b2e26c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F630ffaf7a481&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fdeep-learning-using-gpu-on-your-macbook-c9becba7c43&newsletterV3=545cf0b2e26c&newsletterV3Id=630ffaf7a481&user=Frank+Xu&userId=545cf0b2e26c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}