{"url": "https://towardsdatascience.com/into-a-textual-heart-of-darkness-39b3895ce21e", "time": 1682993382.4397178, "path": "towardsdatascience.com/into-a-textual-heart-of-darkness-39b3895ce21e/", "webpage": {"metadata": {"title": "Into a Textual Heart of Darkness. Going zero to not-quite-hero in NLP via\u2026 | by Leon Zhou | Towards Data Science", "h1": "Into a Textual Heart of Darkness", "description": "The internet is a jungle. Here, rich diversity and wondrous color combine to create a unique ecosystem, enabling novel technologies and methods of communication. But beneath this bright canopy is the\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.supremecourt.gov/opinions/16pdf/15-1293_1o13.pdf", "anchor_text": "Matal v. Tam,", "paragraph_index": 3}, {"url": "http://www.inach.net/fileadmin/user_upload/Manifestations_of_online_hate_speech.pdf", "anchor_text": "hate speech is certainly on the rise", "paragraph_index": 6}, {"url": "https://github.com/t-davidson/hate-speech-and-offensive-language", "anchor_text": "collection of human-labeled tweets", "paragraph_index": 7}, {"url": "https://aaai.org/ocs/index.php/ICWSM/ICWSM17/paper/view/15665", "anchor_text": "Automated Hate Speech Detection and the Problem of Offensive Language", "paragraph_index": 7}, {"url": "http://www.gutenberg.org/", "anchor_text": "Project Gutenberg", "paragraph_index": 12}, {"url": "https://en.wikipedia.org/wiki/N-gram", "anchor_text": "n-grams", "paragraph_index": 14}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "tf-idf", "paragraph_index": 15}, {"url": "https://www.nltk.org/", "anchor_text": "smarter people have walked this road before", "paragraph_index": 22}, {"url": "https://www.nltk.org/api/nltk.tag.html", "anchor_text": "excellent code already exists", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/Brown_Corpus", "anchor_text": "pre-tagged corpus,", "paragraph_index": 22}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "F1-scores", "paragraph_index": 26}], "all_paragraphs": ["The internet is a jungle. Here, rich diversity and wondrous color combine to create a unique ecosystem, enabling novel technologies and methods of communication. But beneath this bright canopy is the dark understory of the unmoderated internet \u2014 a place where the safety of anonymity blurs the lines of civil discourse.", "Here, you\u2019ll find insults and indignity, abuse and ridicule. In this brave new world, the person is merely an abstraction, removed from the things he or she says. Here, entire swaths of people are demonized and denigrated through no fault of their own. Thankfully, some of these are the result of internet trolls \u2014 comments carefully constructed to feign ignorance and provoke outrage.", "Some of these comments are the product of real prejudice and malice. I wanted to see if I could find a way to construct a model that would be able to detect and classify these comments and separate them from the rest. As one with a very limited (read zero) knowledge of natural language processing techniques, I was interested in seeing how far I could get in two weeks.", "To limit the scope of my investigation, I wanted to hone in on a specific category of distasteful comment \u2014 hate speech. While it is a term increasingly thrown around, it is just as increasingly misunderstood. Justice Alito, in his written opinion opinion on the case Matal v. Tam, defines hate speech and our relationship with it in the following way:", "Speech that demeans on the basis of race, ethnicity, gender, religion, age, disability, or any other similar ground is hateful; but the proudest boast of our free speech jurisprudence is that we protect the freedom to express \u201cthe thought that we hate\u201d.", "Hate speech in the United States is surprisingly unregulated at the federal level, and has been upheld to be protected under the First Amendment. Institutions such as universities, however, have frequently defined codes of conduct and decency that place limitations around speech, to limited effect.", "With the anonymity offered by the Internet, and the insulation from consequences that it provides, hate speech is certainly on the rise and of increasing concern to communities and platforms seeking to maintain civility.", "To start, I needed some hate speech to work with. A quick internet search let me to a collection of human-labeled tweets. This data formed the basis for the paper \u201cAutomated Hate Speech Detection and the Problem of Offensive Language\u201d. A cursory exploration of the data revealed what I was up against:", "The numerical columns corresponded to, from left to right:", "Each tweet was read by a minimum of three readers, with as many as double that for more ambiguous statements.", "As my challenge was to classify the tweet solely on the text of the tweet, I disregarded all the numeric columns except for the final classification decision.", "Tweets are inherently messy; Internet communication is informal and fluid \u2014 repeated letters for emphasis, unconventional abbreviations, and ever-evolving slang are just some of the things that both bring the platform to life and make the text just thaaaaaaaat much harder to process. In order to get any sort of accurate read on the words I had in my data, I needed to standardize and normalize.", "To do this, I generated a list of words from a number of books on Project Gutenberg. Unfortunately (and understandably), much of the profanity and jargon on the Internet was not part of these classic works of literature, and needed to be added manually. This was a very imperfect system, as it would be impossible for me to account for everything, but it preserved the profanity I needed and normalized the majority of my text.", "I hoped most of what would fall through the cracks would at least be normalized incorrectly in a consistent fashion, thus limiting the potential impact.", "With my (mostly) corrected words, I was ready to convert my tweets into something a little more machine-readable. A common approach when handling text is to divide the text into individual words, or groups of words, known as n-grams.", "These n-grams were then turned into a machine-readable vector of numbers, with numbers corresponding to the tf-idf weight of each n-gram.", "Term frequency-inverse document frequency (tf-idf) can be thought of as a measure of how unique or distinctive a word is to a class of document. One approach to determining how important a word is is to simply count how many times it shows up (term frequency).", "We have a problem, though. Some words just appear more often in general across all documents \u2014 for example \u201cand,\u201d \u201cthe,\u201d or \u201ca.\u201d Without removing these words, a simple term frequency would be dominated by these non-distinguishing words, thus hiding the real information.", "The tf-idf was conceived to rectify this by penalizing words appearing across multiple documents. Although \u201cthe\u201d might have a high term frequency, because it appears in almost every document, its tf-idf score will suffer, allowing the truly unique and descriptive words to rise to the surface.", "In my case, the \u201coffensive\u201d and \u201chate\u201d classes shared a lot of vocabulary, such as curse words. My hope was that tf-idf would allow the distinctive slurs that make hate speech what it is to emerge.", "I performed two major classification steps \u2014 part-of-speech tagging, and the final classification as hateful, offensive, or neither.", "Now I freely admit I\u2019m no grammar buff. I didn\u2019t know what a \u201csemantically superlative adjective\u201d was until five minutes ago. But part of speech could potentially help me glean some extra juice from the data I had, so I buckled down and prepared myself for some hardcore linguistic instruction.", "Now, smarter people have walked this road before, and excellent code already exists to tag text with minimal effort. But in the name of learning, I resolved to build an inferior model of my own to do the same job. Taking a pre-tagged corpus, I used a simple and quick algorithm, a naive Bayes classifier, to do the job.", "As \u201cnaive\u201d might suggest, this type of classifier is simple-minded, making assumptions that trade accuracy for simplicity and speed. And, simple and speedy it was; in a few lines of code I had my tagger up and running, with an accuracy of 85%. Certainly room for improvement, but quite sufficient: I was eager to move on to the meat of the problem \u2014 detection of hate speech itself.", "Recap: At this point, I\u2019ve cleaned up my original tweets, attached part-of-speech tags, broken my text down into small chunks of words, and turned them into a whole lot of numbers. I\u2019m ready for the main event.", "My first pass through the data, I trained five different types of models on each of my six types of features: chunks of one, two, or three words and their corresponding part-of-speech tags.", "Looks great for a first pass, right? My top F1-scores are already in the high-80s, and with optimization, I\u2019m confident I can push higher.", "Unfortunately, my data was not so kind. As I was seeking to build a hate speech classifier, the metric of greatest interest to me was the F1-score specific to hate speech; showing only that data painted a radically different picture.", "What\u2019s going on here? Sadly, in my excitement and haste, I was not diligent in performing my exploratory data analysis. Had I been more thorough, I might have noticed something very off about my data.", "The proportion of my classes was wildly off balance. Class 0, hate speech \u2014 the class I was most interested in \u2014 only comprised little over 7% of my total data. With the similarity in language between \u201chateful\u201d and \u201coffensive\u201d classes, my models were having trouble seeing where the boundary between hateful and offensive lay.", "With my best models only performing at around 25%, clearly my approach was not working. Since my independent models weren\u2019t up to the task, I looked at combining the best I had \u2014 a poor man\u2019s random forest.", "The five models I ended up selecting were all decision trees or variants thereof. For each tweet, I took the majority decision as my classification; if three models predicted class 0, that would be my classification decision for that tweet. This approach got me up to a class-0 F1 score of 21%. This was less than I what had achieved before.", "Running out of time, I started to worry. Even with majority decision, my model could not reach the correct conclusion. But that gave me a second idea \u2014 if most of my models were getting the hate speech classification wrong, maybe they were getting it wrong consistently. If there was any sort of pattern to it, I could feed those five decisions into a new classifier that would be able to make sense of it all.", "My ploy paid off: feeding my model inputs into a new naive Bayes classifier making the final decision got me an F1-score of 31%, not a terribly significant improvement, granted, but an improvement nonetheless.", "While my success in classifying hate speech was not all that impressive, it provides a decent start. Corny as it may be, more important than my accuracy or precision was my increased understanding of good code and data analysis that could only come from making mistakes and having a boneheaded code architecture.", "As for the model itself, there\u2019s certainly a lot more I could have done, especially with what I know now. From handling class imbalance gracefully to exploring more advanced algorithms or word embeddings, the only way to go is up.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I am a data scientist with a background in chemical engineering and biotech. I am also homeless and live in my car, but that's another thing entirely. Hire me!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F39b3895ce21e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@confusionmatrix?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@confusionmatrix?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": "Leon Zhou"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdd71c9199ba9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&user=Leon+Zhou&userId=dd71c9199ba9&source=post_page-dd71c9199ba9----39b3895ce21e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39b3895ce21e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39b3895ce21e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.supremecourt.gov/opinions/16pdf/15-1293_1o13.pdf", "anchor_text": "Matal v. Tam,"}, {"url": "http://www.inach.net/fileadmin/user_upload/Manifestations_of_online_hate_speech.pdf", "anchor_text": "hate speech is certainly on the rise"}, {"url": "https://github.com/t-davidson/hate-speech-and-offensive-language", "anchor_text": "collection of human-labeled tweets"}, {"url": "https://aaai.org/ocs/index.php/ICWSM/ICWSM17/paper/view/15665", "anchor_text": "Automated Hate Speech Detection and the Problem of Offensive Language"}, {"url": "http://www.gutenberg.org/", "anchor_text": "Project Gutenberg"}, {"url": "https://en.wikipedia.org/wiki/N-gram", "anchor_text": "n-grams"}, {"url": "https://en.wikipedia.org/wiki/Tf%E2%80%93idf", "anchor_text": "tf-idf"}, {"url": "https://www.nltk.org/", "anchor_text": "smarter people have walked this road before"}, {"url": "https://www.nltk.org/api/nltk.tag.html", "anchor_text": "excellent code already exists"}, {"url": "https://en.wikipedia.org/wiki/Brown_Corpus", "anchor_text": "pre-tagged corpus,"}, {"url": "https://en.wikipedia.org/wiki/F1_score", "anchor_text": "F1-scores"}, {"url": "https://medium.com/tag/data-science?source=post_page-----39b3895ce21e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----39b3895ce21e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/natural-language?source=post_page-----39b3895ce21e---------------natural_language-----------------", "anchor_text": "Natural Language"}, {"url": "https://medium.com/tag/classification?source=post_page-----39b3895ce21e---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/learning-to-code?source=post_page-----39b3895ce21e---------------learning_to_code-----------------", "anchor_text": "Learning To Code"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F39b3895ce21e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&user=Leon+Zhou&userId=dd71c9199ba9&source=-----39b3895ce21e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F39b3895ce21e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&user=Leon+Zhou&userId=dd71c9199ba9&source=-----39b3895ce21e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F39b3895ce21e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F39b3895ce21e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----39b3895ce21e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----39b3895ce21e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----39b3895ce21e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----39b3895ce21e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----39b3895ce21e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@confusionmatrix?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@confusionmatrix?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Leon Zhou"}, {"url": "https://medium.com/@confusionmatrix/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "77 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdd71c9199ba9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&user=Leon+Zhou&userId=dd71c9199ba9&source=post_page-dd71c9199ba9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fdd71c9199ba9%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finto-a-textual-heart-of-darkness-39b3895ce21e&user=Leon+Zhou&userId=dd71c9199ba9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}