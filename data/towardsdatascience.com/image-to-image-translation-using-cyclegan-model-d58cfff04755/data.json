{"url": "https://towardsdatascience.com/image-to-image-translation-using-cyclegan-model-d58cfff04755", "time": 1683001365.7820659, "path": "towardsdatascience.com/image-to-image-translation-using-cyclegan-model-d58cfff04755/", "webpage": {"metadata": {"title": "Image-to-Image Translation using CycleGAN Model | by Rahil Vijay | Towards Data Science", "h1": "Image-to-Image Translation using CycleGAN Model", "description": "Cycle Generative Adversarial Network(CycleGAN), is an approach to training deep convolutional networks for Image-to-Image translation tasks. Unlike other GANs models for image translation tasks\u2026"}, "outgoing_paragraph_urls": [{"url": "https://machinelearningmastery.com/a-gentle-introduction-to-pix2pix-generative-adversarial-network/", "anchor_text": "here", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/Yosemite_National_Park", "anchor_text": "Yosemite National Park", "paragraph_index": 14}, {"url": "https://s3.amazonaws.com/video.udacity-data.com/topher/2018/November/5be66e78_summer2winter-yosemite/summer2winter-yosemite.zip", "anchor_text": "here", "paragraph_index": 16}, {"url": "https://arxiv.org/pdf/1512.03385.pdf", "anchor_text": "here", "paragraph_index": 26}, {"url": "https://arxiv.org/pdf/1611.04076.pdf", "anchor_text": "original paper of LSGANs", "paragraph_index": 30}, {"url": "https://arxiv.org/pdf/1703.10593.pdf", "anchor_text": "original, CycleGAN paper", "paragraph_index": 35}, {"url": "https://arxiv.org/pdf/1703.10593.pdf", "anchor_text": "original CycleGAN paper", "paragraph_index": 36}, {"url": "https://arxiv.org/abs/1711.11585", "anchor_text": "here", "paragraph_index": 42}, {"url": "http://www.linkedin.com/in/rahil-vijay", "anchor_text": "LinkedIn", "paragraph_index": 44}, {"url": "https://github.com/vjrahil/CycleGAN-in-Pytorch", "anchor_text": "Github repo", "paragraph_index": 45}, {"url": "https://www.linkedin.com/in/rahil-vijay/", "anchor_text": "https://www.linkedin.com/in/rahil-vijay/", "paragraph_index": 47}], "all_paragraphs": ["If you are completely new to the GANs field, I recommend you to check my previous article before beginning with this post.", "Even if you are not new to GANs, I still recommend you to go through this article, as we will be requiring all the basic concepts that we learn in the previous article to understand this post. That being said let begin with this post.", "Cycle Generative Adversarial Network(CycleGAN), is an approach to training deep convolutional networks for Image-to-Image translation tasks. Unlike other GANs models for image translation tasks, CycleGAN learns a mapping between one image domain and another using an unsupervised approach. For-eg If we are interested in translating an image of a horse into an image of a zebra, we do not require the training dataset of the horse physically converted into a zebra. The way CycleGAN does it is by training Generator Networks to learn a mapping from domain X into an image that looks like it came from domain Y(and vice-versa).", "You will get a deeper understanding of how it\u2019s done as you walk through this post. So let\u2019s begin\u2026", "We would be referring to the above image for the intuition.", "For the paired set of images, we can directly create a GAN to learn a mapping from x to y with the help of Pix2Pix. You can read more about Pix2Pix Networks here.", "But preparing paired sets of data is time-intensive and difficult. For-eg By paired set what I mean is that we need to have an image of a zebra in the same position as a horse or with the same background to be able to learn to map.", "To be able to solve this problem CycleGAN architecture was developed. CycleGANs enable learning a mapping from one domain X to another domain Y without having to find perfectly-matched, training pairs! Let\u2019s look at how CycleGAN does it.", "Suppose we have a set of images from the domain X and an unpaired set of images from the domain Y. We want to be able to translate an image from one set to another. To do this we define a mapping G(G: X->Y) that tries its best to map X to Y. But with unpaired data, we no longer have the ability to look at real and fake pairs of data. But we know that we can change our model to produce an output that belongs to a target domain.", "So when you push an image of a horse(domain X), we can train a Generator to produce realistic-looking images of zebras(domain Y). But the problem with that is that we can\u2019t force the output of the Generator to correspond to its input(In the above image the first transformation is the correct image-to-image translation). This leads to a problem called mode collapse in which a model might map multiple inputs from domain X into the same output from domain Y. In such cases, given an input horse(domain X), all we know is that the output should look like a zebra(domain Y). But to get the correct mapping of the input in the corresponding target domain we introduce an additional mapping as inverse mapping G\u2019(G\u2019: Y->X) which tries to map Y to X. This is called cycle-consistency constraint.", "Think of it like this, if we translate an image of a horse(domain X) to an image of a zebra(domain Y), and then we translate back from a zebra(domain Y) to a horse(domain X), we should arrive back at the same image of the horse with which we started.", "A complete translation cycle should bring you back the same image with which you started with. In the case of image translation form domain X to Y, if the following condition is met, we say that the transformation of an image from domain X to domain Y was correct.", "With the help of cycle-consistency constraint, CycleGAN makes sure that the model learns a correct mapping from domain X to domain Y.", "The following task is broken down into a series of small tasks from loading and visualizing data to training models.", "Specifically, we\u2019ll look at a set of images of Yosemite National Park taken either during the summer or winter. The seasons are our two domains!", "In general, you can see that the summer images are brighter and more green than the winter images. The winter contains things like snow and cloudy images. In this dataset, our main objective will be to train a Generator that learns to transform an image from summer into winter and vice versa. These images do not contain labels and are referred to as unpaired training data. But by using CycleGAN we can learn a mapping from one image domain to another using the unsupervised approach.", "You can download the following data by clicking here.", "CycleGAN comprises of two Discriminators(D_x and D_y) and two Generators(G_xtoy and G_ytox).", "The discriminators D_x and D_y, in this CycleGAN, are convolutional neural networks that see an image and attempt to classify it as real or fake. In this case, real is indicated by an output close to 1 and fake as close to 0. The discriminators have the following architecture:", "Both D_x and D_y have the same architecture, so we only need to define one class, and later instantiate two discriminators.", "While defining Generator architecture we will be using something called Resnet block and residual function in our architecture. The idea behind using Resnet Block and residual function is the following:", "Residual Block connects encoder and decoder. The motivation behind this architecture is as follows: deep neural networks can be very difficult to train, as they are more likely to have exploding or vanishing gradients and, therefore, have trouble reaching convergence; batch normalization helps with this a bit.", "One solution to this problem is to use Resnet blocks that allow us to learn so-called residual functions as they are applied to layer inputs.", "When we create a deep learning model, the model (several layers with activations applied) is responsible for learning a mapping, M, from an input x to an output y.", "Instead of learning a direct mapping from x to y, we can instead define a residual function.", "This looks at the difference between a mapping applied to x and the original input, x. F(x) is, typically, two convolutional layers + normalization layer and a ReLU in between. These convolutional layers should have the same number of inputs as outputs. This mapping can then be written as the following; a function of the residual function and the input x.", "You can read more about deep residual learning here. Here is the code snippet for implementing Residual Block.", "The Generator G_xtoy and G_ytox are composed of an encoder, a conv net that turns an image into a small feature representation and a decoder, a transpose_conv net that is responsible for turning that feature representation into a transformed image. Here is the code snippet for implementing Generator.", "Both G_xtoy and G_ytox have the same architecture, so we only need to define one class, and later instantiate two Generators.", "The training process comprises defining the loss functions, selecting optimizer and finally training the model.", "We\u2019ve seen that regular GANs treat the discriminator as a classifier with the sigmoid cross-entropy loss function. However, this loss function may lead to the vanishing gradient problem during the learning process. To overcome such a problem, we\u2019ll use a least-squares loss function for the discriminator. This structure is often referred to as Least Square GANs, you can read more about them from the original paper of LSGANs.", "The discriminator losses will be mean squared errors between the output of the discriminator, given an image, and the target value, 0 or 1, depending on whether it should classify that image as fake or real. For example, for a real image, x, we can train D_x by looking at how close it is to recognizing and image x as real using the mean squared error:", "In this, we will generate fake images that look like they belong to domain X but are based on images from domain Y, and vice versa. We will compute real loss on those generated images by looking at the output of the discriminator as it\u2019s applied to these fake images.", "In addition to the adversarial loss, the Generator loss term will include cycle consistency loss. This loss is a measure of how good a reconstructed image is when compared to an original image. For-eg we have a fake generated image x^ and a real image y, we can generate y^ from x^ with the help of G_xtoy(G_xtoy(x^) = y^). Here the cycle consistency loss will be the absolute difference between the original and reconstructed image.", "Here is the code snippet for defining losses.", "In cycle consistency loss the lambda term is the weight parameter that will weight the mean absolute error in a batch. It\u2019s recommended that you take a look at the original, CycleGAN paper to get a starting value for lambda_weight.", "For CycleGAN we define three optimizers for Generators(G_xtoy and G_ytox) and D_x and D_y. For all the optimizers we are using Adam. All the values hyperparameters are chosen from the original CycleGAN paper.", "When a CycleGAN train, and sees one batch of real images from set X and Y, it trains by performing the following steps:", "Here is the code snippet for doing so.", "The training is performed over 5000 epochs using a GPU, that\u2019s why I had to move my model and inputs from CPU to GPU.", "We can observe that the Generators start with a very high error, but with time it starts to produce decent image translations, thus helps in bringing down the error.", "Both the discriminator errors show very little fluctuation in error. But by the end of 5000 epochs, we can see that both discriminator errors have decreased, thus forcing Generators to do more realistic image translations.", "We can observe that CycleGAN models produce low-resolution images, this is an ongoing area of research, you can read more about the high-resolution formulation that uses multiple Generators by clicking here.", "This model struggles with matching colors exactly. This is because, if G_xtoy and G_ytox may change the tint of an image; the cycle consistency loss may not be affected and can still be small. You could choose to introduce a new, color-based loss term that compares G_ytox(y) and y, and G_xtoy(x) and x, but then this becomes a supervised learning approach. That being said CycleGAN was able to do satisfactory translations.", "If you want to stay connected, you can find me on LinkedIn .", "Check out my Github repo regarding this post.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A machine learning enthusiast. Trying to explain complex stuff in simple terms. Contact: https://www.linkedin.com/in/rahil-vijay/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd58cfff04755&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d58cfff04755--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d58cfff04755--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vijayrahil1998?source=post_page-----d58cfff04755--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vijayrahil1998?source=post_page-----d58cfff04755--------------------------------", "anchor_text": "Rahil Vijay"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8495ac9849ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&user=Rahil+Vijay&userId=8495ac9849ea&source=post_page-8495ac9849ea----d58cfff04755---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd58cfff04755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd58cfff04755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@timmossholder?utm_source=medium&utm_medium=referral", "anchor_text": "Tim Mossholder"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://towardsdatascience.com/fake-face-generator-using-dcgan-model-ae9322ccfd65", "anchor_text": "Fake Face Generator Using DCGAN ModelOverviewtowardsdatascience.com"}, {"url": "https://modelzoo.co/model/mnist-svhn-transfer", "anchor_text": "https://modelzoo.co/model/mnist-svhn-transfer"}, {"url": "https://machinelearningmastery.com/a-gentle-introduction-to-pix2pix-generative-adversarial-network/", "anchor_text": "here"}, {"url": "https://en.wikipedia.org/wiki/Yosemite_National_Park", "anchor_text": "Yosemite National Park"}, {"url": "https://s3.amazonaws.com/video.udacity-data.com/topher/2018/November/5be66e78_summer2winter-yosemite/summer2winter-yosemite.zip", "anchor_text": "here"}, {"url": "https://arxiv.org/pdf/1512.03385.pdf", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/fake-face-generator-using-dcgan-model-ae9322ccfd65", "anchor_text": "article"}, {"url": "https://arxiv.org/pdf/1611.04076.pdf", "anchor_text": "original paper of LSGANs"}, {"url": "https://ssnl.github.io/better_cycles/report.pdf", "anchor_text": "https://ssnl.github.io/better_cycles/report.pdf"}, {"url": "https://arxiv.org/pdf/1703.10593.pdf", "anchor_text": "original, CycleGAN paper"}, {"url": "https://arxiv.org/pdf/1703.10593.pdf", "anchor_text": "original CycleGAN paper"}, {"url": "https://arxiv.org/abs/1711.11585", "anchor_text": "here"}, {"url": "http://www.linkedin.com/in/rahil-vijay", "anchor_text": "LinkedIn"}, {"url": "https://arxiv.org/pdf/1703.10593.pdf", "anchor_text": "CycleGAN original paper"}, {"url": "https://www.udacity.com/course/deep-learning-nanodegree--nd101", "anchor_text": "Udacity Deep Learning Nanodegree course"}, {"url": "https://github.com/vjrahil/CycleGAN-in-Pytorch", "anchor_text": "Github repo"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d58cfff04755---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----d58cfff04755---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----d58cfff04755---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/generative-model?source=post_page-----d58cfff04755---------------generative_model-----------------", "anchor_text": "Generative Model"}, {"url": "https://medium.com/tag/data-science?source=post_page-----d58cfff04755---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd58cfff04755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&user=Rahil+Vijay&userId=8495ac9849ea&source=-----d58cfff04755---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd58cfff04755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&user=Rahil+Vijay&userId=8495ac9849ea&source=-----d58cfff04755---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd58cfff04755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d58cfff04755--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd58cfff04755&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d58cfff04755---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d58cfff04755--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d58cfff04755--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d58cfff04755--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d58cfff04755--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d58cfff04755--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d58cfff04755--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d58cfff04755--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d58cfff04755--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vijayrahil1998?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vijayrahil1998?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rahil Vijay"}, {"url": "https://medium.com/@vijayrahil1998/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "77 Followers"}, {"url": "https://www.linkedin.com/in/rahil-vijay/", "anchor_text": "https://www.linkedin.com/in/rahil-vijay/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8495ac9849ea&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&user=Rahil+Vijay&userId=8495ac9849ea&source=post_page-8495ac9849ea--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdbfa3715bb31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fimage-to-image-translation-using-cyclegan-model-d58cfff04755&newsletterV3=8495ac9849ea&newsletterV3Id=dbfa3715bb31&user=Rahil+Vijay&userId=8495ac9849ea&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}