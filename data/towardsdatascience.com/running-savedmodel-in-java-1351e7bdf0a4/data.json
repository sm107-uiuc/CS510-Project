{"url": "https://towardsdatascience.com/running-savedmodel-in-java-1351e7bdf0a4", "time": 1683014657.808751, "path": "towardsdatascience.com/running-savedmodel-in-java-1351e7bdf0a4/", "webpage": {"metadata": {"title": "Tensorflow SavedModel in Java. The most popular programming language\u2026 | by Steven Mi | Towards Data Science", "h1": "Tensorflow SavedModel in Java", "description": "The most popular programming language for machine learning is Python. Most Data Scientist and ML Engineer build their pipelines with Python. Although Python is a widely used solution, it may not be\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/tensorflow/java", "anchor_text": "Tensorflow Java", "paragraph_index": 0}, {"url": "https://github.com/tensorflow/java", "anchor_text": "Tensorflow Java", "paragraph_index": 1}, {"url": "https://github.com/tensorflow/java", "anchor_text": "Tensorflow/Java", "paragraph_index": 3}, {"url": "https://github.com/tensorflow/java-models/blob/master/tensorflow-examples/src/main/java/org/tensorflow/model/examples/tensors/TensorCreation.java", "anchor_text": "TensorCreation.java", "paragraph_index": 7}, {"url": "https://gist.github.com/steven-mi/c4578d312546bd2414b152331100ac26", "anchor_text": "gist", "paragraph_index": 10}], "all_paragraphs": ["The most popular programming language for machine learning is Python. Most Data Scientist and ML Engineer build their pipelines with Python. Although Python is a widely used solution, it may not be optimal for all stacks or use cases. In this article, I show you how to use your SavedModel with the current version of Tensorflow Java, which might be useful.", "Note: As you may see Tensorflow Java is still under construction. Therefore some unexpected behaviors can happen. Keep this in mind.", "First create a Maven project and open your pom.xml. Add the following lines to indicate the Java version. I use Java 11 because it is LTS.", "Next, add the Tensorflow Java artifacts to your project. At the time of writing this article they are not hosted on maven. Therefore you have to add the OSS repository of Sonatype manually. You can always find the latest instructions in their Github repository Tensorflow/Java.", "For demonstration purposes I will use a GPT-2 model. But any other SavedModel will work. After downloading/creating the SavedModel files I moved the whole folder to the resource folder of the Java project. Then go to the terminal and enter the following lines:", "This provides you with all relevant information about your model, e.g. the tag sets, input and output nodes, \u2026. This information is needed when executing the inference.", "Create a new Java class, create a main method and add the following line to load your SavedModel with a specific tag set:", "At this point, we need to create the input tensor for the model. An overview of all available transformations is available in TensorCreation.java. In my case, GPT-2 takes a Tensor with shape (1, -1) and int values. So I create a tensor with shape (1, 9) with some random handwritten int values", "Then create a map that has a string key and a tensor as value. The key is the name of the input tensor and the value of the tensor you will use as input. This should remind you of the old Tensorflow 1.X days when you had to create a feed_dict that you had to insert into your diagram during a session. In Java we can simply create a hashmap and insert the input sensors we created into it:", "All that is left to do is to call the signature_def function.", "And you are done, all code can be found in this gist.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Hello, I am Steven, a machine learning engineer."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1351e7bdf0a4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://stevenmi.medium.com/?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": ""}, {"url": "https://stevenmi.medium.com/?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": "Steven Mi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F37bd87126728&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&user=Steven+Mi&userId=37bd87126728&source=post_page-37bd87126728----1351e7bdf0a4---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1351e7bdf0a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1351e7bdf0a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/tensorflow/java", "anchor_text": "Tensorflow Java"}, {"url": "https://unsplash.com/@ricaros", "anchor_text": "https://unsplash.com/@ricaros"}, {"url": "https://github.com/tensorflow/java", "anchor_text": "Tensorflow Java"}, {"url": "https://github.com/tensorflow/java", "anchor_text": "Tensorflow Java"}, {"url": "https://github.com/tensorflow/java", "anchor_text": "Tensorflow/Java"}, {"url": "https://github.com/tensorflow/java-models/blob/master/tensorflow-examples/src/main/java/org/tensorflow/model/examples/tensors/TensorCreation.java", "anchor_text": "TensorCreation.java"}, {"url": "https://gist.github.com/steven-mi/c4578d312546bd2414b152331100ac26", "anchor_text": "gist"}, {"url": "https://medium.com/tag/data-science?source=post_page-----1351e7bdf0a4---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/java?source=post_page-----1351e7bdf0a4---------------java-----------------", "anchor_text": "Java"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----1351e7bdf0a4---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow-java?source=post_page-----1351e7bdf0a4---------------tensorflow_java-----------------", "anchor_text": "Tensorflow Java"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----1351e7bdf0a4---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1351e7bdf0a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&user=Steven+Mi&userId=37bd87126728&source=-----1351e7bdf0a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F1351e7bdf0a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&user=Steven+Mi&userId=37bd87126728&source=-----1351e7bdf0a4---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1351e7bdf0a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F1351e7bdf0a4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----1351e7bdf0a4---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----1351e7bdf0a4--------------------------------", "anchor_text": ""}, {"url": "https://stevenmi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://stevenmi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Steven Mi"}, {"url": "https://stevenmi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "4 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F37bd87126728&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&user=Steven+Mi&userId=37bd87126728&source=post_page-37bd87126728--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F37bd87126728%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frunning-savedmodel-in-java-1351e7bdf0a4&user=Steven+Mi&userId=37bd87126728&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}