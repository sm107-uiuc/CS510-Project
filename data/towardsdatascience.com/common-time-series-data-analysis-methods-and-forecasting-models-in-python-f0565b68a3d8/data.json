{"url": "https://towardsdatascience.com/common-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8", "time": 1683009730.32997, "path": "towardsdatascience.com/common-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8/", "webpage": {"metadata": {"title": "Common Time Series Data Analysis Methods and Forecasting Models in Python | by Yuefeng Zhang, PhD | Towards Data Science", "h1": "Common Time Series Data Analysis Methods and Forecasting Models in Python", "description": "A time series is a sequence of data samples taken in time order with equal time intervals. Time series include many kinds of real experimental data taken from various domains such as finance\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "time series", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Autocovariance", "anchor_text": "autocovariance", "paragraph_index": 34}, {"url": "https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test", "anchor_text": "Augmented Dickey Fuller test", "paragraph_index": 36}, {"url": "https://en.wikipedia.org/wiki/Stationary_process", "anchor_text": "trend stationary", "paragraph_index": 37}, {"url": "https://en.wikipedia.org/wiki/Partial_autocorrelation_function", "anchor_text": "Partial Autocorrelation Function", "paragraph_index": 43}], "all_paragraphs": ["A time series is a sequence of data samples taken in time order with equal time intervals. Time series include many kinds of real experimental data taken from various domains such as finance, medicine, scientific research (e.g., global warming, speech analysis, earthquakes), etc. [1][2]. Time series forecasting has many real applications in various areas such as forecasting of business (e.g., sales, stock), weather, decease, and others [1].", "Given a traditional (time order independent) dataset for supervised machine learning for prediction, data exploration and preprocessing are required before features engineering can be performed, and the features engineering needs to be done before a machine learning model can be chosen and applied to the engineered features for prediction.", "Similarly to traditional dataset, given a time series dataset, data exploration and preprocessing are required before the time series data can be analyzed, and time series data analysis is required before a time series forecasting model can be chosen and applied to the analyzed dataset for forecasting.", "In this article, I use a global warming dataset from Kaggle [2] to demonstrate some of the common time series data preprocessing/analysis methods and time series forecasting models in Python. The demonstration consists of the following:", "As described before, for a time series data, data preprocessing is required before data analysis can be performed.", "The first step towards data preprocessing is to load data from a csv file.", "Time order plays a critical role in time series data analysis and forecasting. In particular, each data sample in a time series must be associated with a unique point in time. This can be achieved in Pandas DataFrame/Series by using values of DatetimeIndex type as its index values.", "Once the earth surface temperature dataset in Kaggle [2] has been downloaded onto a local machine, the dataset csv file can be loaded into a Pandas DataFrame as follows:", "The option parse_dates is to tell Pandas to parse the string values in the dt column into Python datatime values, while the option index_col is to tell Pandas to convert the parsed values of the dt column into DatatimeIndex type and then use them as indices.", "For simplicity, I extract the LandAverageTemperature column as a Pandas Series for demonstration purpose in this article:", "Similarly to a traditional dataset, missing data frequently occurs in time series data, which must be handled before the data can be further preprocessed and analyzed.", "The following code can check how many data entries are missing:", "There are 12 missing data entries in the earth surface temperature time series. Those missing values cannot simply be removed or set to zero without breaking the past time dependency. There are multiple ways of handling missing data in time series appropriately [3]:", "I used forward fill to fill up the missing data entries in this article:", "Once the data preprocessing is done, the next step is to analyze data.", "As a common practice [1][3][4], the first step towards time series data analysis is to visualize the data.", "The code below uses the Pandas DataFrame/Series built-in plot method to plot the earth surface temperature time series:", "The above plot shows that the average temperature of the earth\u2019s surface is around the range of [5, 12] and the overall trend is increasing slowly. No other obvious patterns show up in the plot due to mixture of different time series components such as base level, trend, seasonality, and other components such as error and random noise [1][3]. The time series can be decomposed into individual components for further analysis.", "To decompose a time series into components for further analysis, the time series can be modeled as an additive or multiplicative of base level, trend, seasonality, and error (including random noise) [3]:", "The earth surface temperature time series is modeled as an additive time series in this article:", "The option extrapolate_trend='freq' is to handle any missing values in the trend and residuals at the beginning of the time series [3].", "In theory, the same dataset can be easily modeled as a multiplicative time series by replacing the option model=\u2019additive\u2019 with model=\u2019multiplicative\u2019. However, the multiplicative model cannot be applied to this particular dataset because the dataset contains zero and/or negative values, which are not allowed in multiplicative seasonality decomposition.", "The resulting components of the additive decomposition can be extracted to form a Pandas DataFrame as follows:", "The code below is to visualize the additive decomposed components: trend, seasonal, and residual (i.e., base level + error).", "For the earth surface temperature time series data, we are interested in its long term trend the most, which can be extracted as follows:", "Once the data preprocessing and analysis are done, time series forecasting can begin.", "This section presents the results of applying two common time series forecasting models to the earth surface temperature trend data:", "An ARIMA model [1][4] is determined by three parameters:", "ARIMA model consists of three parts [4]: AutoRegression (AR), Moving Average (MA), and a constant:", "ARIMA = constant + AR + MA", "AR = a linear combination of p consecutive values in the past time points (i.e., lags)", "MA = a linear combination of q consecutive forecast errors in the past time points (i.e., lagged forecast errors)", "Both AR and MA can only be applied to a stationary time series, which is achieved by differencing in ARIMA.", "3.1.1 Determining the order of differencing d", "A time series is (weakly) stationary if its mean is constant (independent of time) and its autocovariance function between two different time points s and t of the time series only depends on the time interval |s - t| (i.e., lag), not a specific time point [1].", "Time series forecasting works only for a stationary time series since only the behavior of a stationary time series is predictable.", "We can use the ADF test (Augmented Dickey Fuller test) [4] to check whether or not a time series is stationary. As an example, the code below is to check the earth surface temperature time series for stationarity:", "The default null hypothesis of the ADF test is that the time series is non-stationary. Since the p-value of the ADF test above is less than the significance level of 0.05, we reject the null hypothesis and conclude that the time series is stationary (only trend stationary in this case).", "Generally speaking, the following need to be done to make a time series stationary:", "Differencing is a popular data transform method for removing non-stationary behaviors (especially trend).", "The following code is to perform 1st and 2nd order of differencing against the earth surface temperature time series:", "The figure below shows that 1st order of differencing is enough to remove the trend. 2nd order of differencing does not make any improvement. Thus the order of differencing d is set to 1 in this article.", "3.1.2 Determining the autoregressive order p", "The autoregressive order p can be determined by analyzing the results of PACF (Partial Autocorrelation Function) on the 1st order of differencing of the time series data [1][4]:", "We can observe that the PACF lag 1 is well above the significance line (gray area). Thus the autoregressive order p is set to 1 in this article.", "3.1.3 Determining the moving average order q", "The moving average order q can be determined by analyzing the results of ACF (Autocorrelation Function) on the 1st order of differencing of the time series data [1][4]:", "We can observe that the ACF lag 1 is well above the significance line (gray area). Thus the moving average order q is set to 1 as well in this article.", "The following code divides the earth surface temperature trend time series into training and testing sub-series first and then uses the training data to train an ARIMA model with the determined values of p =1, d =1, q = 1.", "A traditional dataset is typically randomly divided into training and testing subsets. However, this does not work for time series because it breaks the sequential time dependency. To avoid this problem, the temperature trend time series data is divided by keeping its original sequential order.", "It can be seen from the above model training results that the P Values of the AR1 and MA1 in the p>|z| column are highly significant (<< 0.05). This indicates that the choices of p =1 and q =1 are appropriate.", "The code below is to plot the residuals.", "The plot of the residuals shows no patterns (i.e., with constant mean and variance) except for the first 20% of the time series. This indicates that the trained ARIMA model behaves appropriately.", "3.1.5 Forecasting using the trained ARIMA model", "The code below is to use the trained ARIMA model to forecast 192 (this can be any positive integer) temperature values and then compare them with the testing time series:", "The forecasting results above show that the trained ARIMA model tends to forecast temperatures below the actual ones.", "This section presents the results of applying the well-known LSTM model to the earth surface temperature trend time series.", "Similarly to [6], the following code is to generate pairs of feature vector (a sequence of temperature values in the past time points) and label (target temperature at current time point) from the temperature time series for LSTM model training and evaluation.", "For simplicity, I used the temperatures in the past 12 months to predict the temperature in next month in this article. The following are two samples of the generated dataset:", "The generated dataset is divided into two parts: the first 3,000 for model training and the rest of dataset for model testing:", "The following LSTM model [6] takes a sequence of temperature values as input and generates one target temperate as output. Since the temperature forecasting is a regression issue, the output of the LSTM model can take any value and thus there is no associated activation function.", "The following are the results of model training:", "3.2.4 Forecasting using the trained LSTM model", "Once the model training is done, the trained LSTM model can then be applied to the testing time series to forecast temperatures:", "The code below plots the predicted temperatures against the actual temperatures in the testing time series:", "The plot of the predicted temperatures against the entire temperature trend time series is done as follows:", "The forecasting results above shows that the forecasted temperatures followed the actual temperatures closely.", "In this article, I used a global warming dataset from Kaggle [2] to demonstrate some of the common time series data preprocessing/analysis practices and two widely adopted time series forecasting models ARIMA and LSTM in Python.", "As can be seen in Section 3, the performance of the ARIMA model relies heavily on data preprocessing and analysis to make a time series stationary, while LSTM can work on a time series with minimum data preprocessing and analysis (e.g., no need to remove trend by differencing in LSTM model).", "All of the source code used in this article is available in Github [7].", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Scientist at Wavicle Data Solutions, He was a Senior Data Scientist at SMS Assist, a Senior Data Engineer at Capital One, and a DMTS at Motorola"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff0565b68a3d8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@zhangyuefeng1?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": "Yuefeng Zhang, PhD"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80e8f2faf4bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=post_page-80e8f2faf4bc----f0565b68a3d8---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff0565b68a3d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff0565b68a3d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://en.wikipedia.org/wiki/Time_series", "anchor_text": "time series"}, {"url": "https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average", "anchor_text": "ARIMA"}, {"url": "https://en.wikipedia.org/wiki/Long_short-term_memory", "anchor_text": "LSTM"}, {"url": "https://en.wikipedia.org/wiki/Autocovariance", "anchor_text": "autocovariance"}, {"url": "https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test", "anchor_text": "Augmented Dickey Fuller test"}, {"url": "https://en.wikipedia.org/wiki/Stationary_process", "anchor_text": "trend stationary"}, {"url": "https://en.wikipedia.org/wiki/Partial_autocorrelation_function", "anchor_text": "Partial Autocorrelation Function"}, {"url": "https://www.kaggle.com/berkeleyearth/climate-change-earth-surface-temperature-data?select=GlobalTemperatures.csv", "anchor_text": "Climate Change: Earth Surface Temperature Data"}, {"url": "https://www.machinelearningplus.com/time-series/time-series-analysis-python/", "anchor_text": "Time Series Analysis in Python \u2014 A Comprehensive Guide with Examples"}, {"url": "https://www.machinelearningplus.com/time-series/arima-model-time-series-forecasting-python/", "anchor_text": "ARIMA Model \u2014 Complete Guide to Time Series Forecasting in Python"}, {"url": "https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/", "anchor_text": "How to Remove Trends and Seasonality with a Difference Transform in Python"}, {"url": "https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/", "anchor_text": "How to Develop LSTM Models for Time Series Forecasting"}, {"url": "https://github.com/yzzhang/machine-learning/tree/master/time_series", "anchor_text": "Github"}, {"url": "https://medium.com/tag/time-series-analysis?source=post_page-----f0565b68a3d8---------------time_series_analysis-----------------", "anchor_text": "Time Series Analysis"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----f0565b68a3d8---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/arima?source=post_page-----f0565b68a3d8---------------arima-----------------", "anchor_text": "Arima"}, {"url": "https://medium.com/tag/lstm?source=post_page-----f0565b68a3d8---------------lstm-----------------", "anchor_text": "Lstm"}, {"url": "https://medium.com/tag/data-science?source=post_page-----f0565b68a3d8---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff0565b68a3d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=-----f0565b68a3d8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff0565b68a3d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=-----f0565b68a3d8---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff0565b68a3d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff0565b68a3d8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f0565b68a3d8---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f0565b68a3d8--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@zhangyuefeng1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Yuefeng Zhang, PhD"}, {"url": "https://medium.com/@zhangyuefeng1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "293 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80e8f2faf4bc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=post_page-80e8f2faf4bc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F84632d34eae6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcommon-time-series-data-analysis-methods-and-forecasting-models-in-python-f0565b68a3d8&newsletterV3=80e8f2faf4bc&newsletterV3Id=84632d34eae6&user=Yuefeng+Zhang%2C+PhD&userId=80e8f2faf4bc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}