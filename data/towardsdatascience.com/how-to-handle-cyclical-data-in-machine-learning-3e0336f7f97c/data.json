{"url": "https://towardsdatascience.com/how-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c", "time": 1683015058.322067, "path": "towardsdatascience.com/how-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c/", "webpage": {"metadata": {"title": "How to Handle Cyclical Data in Machine Learning | by Dario Rade\u010di\u0107 | Towards Data Science", "h1": "How to Handle Cyclical Data in Machine Learning", "description": "Today we\u2019ll look at a common but poorly understood topic in data science \u2014 cyclical data. It\u2019s a part of many datasets and is easily spottable \u2014 date information is the most common form. There are\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/robikscube/hourly-energy-consumption", "anchor_text": "Hourly Energy Consumption", "paragraph_index": 5}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights.", "paragraph_index": 24}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member", "paragraph_index": 25}, {"url": "https://betterdatascience.com/cyclical-data-machine-learning/", "anchor_text": "https://betterdatascience.com", "paragraph_index": 26}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com", "paragraph_index": 28}], "all_paragraphs": ["Today we\u2019ll look at a common but poorly understood topic in data science \u2014 cyclical data. It\u2019s a part of many datasets and is easily spottable \u2014 date information is the most common form. There are plenty of approaches to encode date information to something machine-learning-friendly, but some are better than others.", "Here\u2019s how I was taught about dealing with date values \u2014 treat them as categorical. Different months/days/hours can be treated as individual categories, so to encode them, one can create a bunch of dummy variables. For example, when dealing with monthly data, we can make 11 dummy columns (one-hot) that take the form of Is_January, Is_February, and so on, where only one column can have a non-zero value for a row.", "Sure, you can do that, and a machine learning model wouldn\u2019t complain, but it doesn\u2019t mean it\u2019s the right approach. Time data is cyclical, as one hour has 60 minutes, and one day has 24 hours. When an hour completes, the next one starts counting minutes from zero.", "It makes the 1st and 2nd minute of an hour strongly connected, but it also makes the 59th and 1st minute connected, as there\u2019s only one minute difference, not 59 as a model would assume.", "And that\u2019s the behavior we want. The next section will make the previous points more clear.", "We need a dataset with some date or other cyclical attributes \u2014 that\u2019s obvious. A quick Kaggle search resulted in this Hourly Energy Consumption dataset, of which we\u2019ll use the first AEP_hourly.csv file. It\u2019s a couple of MB in size, so download it to your machine.", "The first couple of rows look like this, once loaded with Pandas:", "Great \u2014 we have some date information, but is it an actual date or a string?", "Just as expected, so let\u2019s make a conversion. We\u2019ll also extract the hour information from the date, as that\u2019s what we\u2019re dealing with.", "Things are much better now. Let\u2019s isolate the last week\u2019s worth of data (the last 168 records) to visualize why one-hot encoding isn\u2019t a good thing to do.", "Expected behavior. It\u2019s a cycle that repeats seven times (7 days), and there\u2019s a rough cut off every day after the 23rd hour. I think you can easily reason why this type of behavior isn\u2019t optimal for cyclical data.", "But what can we do about it? Luckily, a lot.", "One-hot encoding wouldn\u2019t be that wise of thing to do in this case. We\u2019d end up with 23 additional attributes (n \u2014 1), which is terrible for two reasons:", "Use a sine an cosine transformations. Here are the formulas we\u2019ll use:", "Awesome! Here\u2019s how the last week of data now looks:", "These transformations allowed us to represent time data in a more meaningful and compact way. Just take a look at the last two rows. Sine values are almost identical, but still a bit different. The same goes for every following hour, as it now follows a waveform.", "That\u2019s great, but why do we need both functions?", "Let\u2019s explore the functions graphically before I give you the answer.", "Look at one graph at a time. There\u2019s a problem. The values repeat. Just take a look at the sine function, somewhere between 24 and 48, on the x-axis. If you were to draw a straight line, it would intersect with two points for the same day. That\u2019s not the behavior we want.", "To further prove this point, here\u2019s what happens if we draw a scatter plot of both sine and cosine columns:", "That\u2019s right; we get a perfect cycle. It only makes sense to represent cyclical data with a cycle, don\u2019t you agree?", "That\u2019s all you should know. Let\u2019s wrap things up in the next section.", "This was relatively short and to the point article, but I still hope I managed to convince you one-hot encoding isn\u2019t a solution for everything. Sure, it works like a charm when categorical attributes aren\u2019t \u2018connected\u2019 in any way, but this is the go-to approach for any cyclical data.", "One may argue that we introduce two new dimensions, which isn\u2019t ideal. I agree, but two are better than 23, which resulted from a one-hot encoding approach.", "Join my private email list for more helpful insights.", "Loved the article? Become a Medium member to continue learning without limits. I\u2019ll receive a portion of your membership fee if you use the following link, with no extra cost to you.", "Originally published at https://betterdatascience.com on October 12, 2020.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Scientist & Tech Writer | betterdatascience.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3e0336f7f97c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@radecicdario?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be----3e0336f7f97c---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e0336f7f97c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e0336f7f97c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@arstyy?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Austin Neill"}, {"url": "https://unsplash.com/s/photos/circle?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/robikscube/hourly-energy-consumption", "anchor_text": "Hourly Energy Consumption"}, {"url": "https://mailchi.mp/46a3d2989d9b/bdssubscribe", "anchor_text": "Join my private email list for more helpful insights."}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Medium member"}, {"url": "https://medium.com/@radecicdario/membership", "anchor_text": "Join Medium with my referral link - Dario Rade\u010di\u0107As a Medium member, a portion of your membership fee goes to writers you read, and you get full access to every story\u2026medium.com"}, {"url": "https://betterdatascience.com/cyclical-data-machine-learning/", "anchor_text": "https://betterdatascience.com"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----3e0336f7f97c---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/data-science?source=post_page-----3e0336f7f97c---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----3e0336f7f97c---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----3e0336f7f97c---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----3e0336f7f97c---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3e0336f7f97c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----3e0336f7f97c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F3e0336f7f97c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=-----3e0336f7f97c---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3e0336f7f97c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F3e0336f7f97c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----3e0336f7f97c---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----3e0336f7f97c--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@radecicdario?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Dario Rade\u010di\u0107"}, {"url": "https://medium.com/@radecicdario/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "39K Followers"}, {"url": "http://betterdatascience.com", "anchor_text": "betterdatascience.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F689ba04bb8be&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=post_page-689ba04bb8be--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F33e2fb82c727&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-handle-cyclical-data-in-machine-learning-3e0336f7f97c&newsletterV3=689ba04bb8be&newsletterV3Id=33e2fb82c727&user=Dario+Rade%C4%8Di%C4%87&userId=689ba04bb8be&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://amzn.to/400ZUtX", "anchor_text": "Machine Learning Automation with TPOT: Build, validate, and deploy fully automated machine learning models with Python2021"}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}