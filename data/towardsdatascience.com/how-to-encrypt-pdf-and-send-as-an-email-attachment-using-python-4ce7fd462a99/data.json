{"url": "https://towardsdatascience.com/how-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99", "time": 1683018079.775777, "path": "towardsdatascience.com/how-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99/", "webpage": {"metadata": {"title": "How to encrypt PDF and send as an email attachment using Python | by Ji Wei Liew | Towards Data Science", "h1": "How to encrypt PDF and send as an email attachment using Python", "description": "As a big-fan of automation, it pains me to see fellow colleagues doing work which is repetitive and excruciatingly manual. A request came to me from HR asking if I could encrypt a bunch of PDFs, then\u2026"}, "outgoing_paragraph_urls": [{"url": "https://stackoverflow.com/a/52757623/8350440", "anchor_text": "here", "paragraph_index": 12}, {"url": "https://stackoverflow.com/a/65266270/8350440", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://stackoverflow.com/questions/65250207/pandas-cannot-open-an-excel-xlsx-file", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://security.stackexchange.com/questions/94102/is-it-good-practice-to-send-passwords-in-separate-emails-and-why", "anchor_text": "link", "paragraph_index": 17}, {"url": "http://www.linkedin.com/in/ji-wei-liew", "anchor_text": "www.linkedin.com/in/ji-wei-liew", "paragraph_index": 19}], "all_paragraphs": ["As a big-fan of automation, it pains me to see fellow colleagues doing work which is repetitive and excruciatingly manual. A request came to me from HR asking if I could encrypt a bunch of PDFs, then send them via email to individual recipients. I had a pretty good idea of what these letters could be as it was the time of the year and we were looking forward to our bonus and increment letter. :) We used to receive them personally at the office, but given the current circumstances, it might be more practical to send these via email instead.", "I\u2019ve familiarized myself with the pypiwin32 module, and knew how to send emails using python but I had no clue how to encrypt PDFs. Nonetheless, I had some faith that in the countably finite number of python libraries out there, there would be one that can do the job.", "Additional constraint: Since the information is rather sensitive, there is no way HR would send me the unencrypted PDFs to be encrypted on my laptop. As a consequence, one of the key requirement is that the script has to run on her machine.", "The overall approach can be summarized into the following steps.", "A project folder with the following folder structure was set up and a virtual environment named env was initialized. Folder raw stores the unencrypted PDFs, while encrypted stores the encrypted PDFs which are generated at run-time. The excel file is a table with the employee\u2019s name, email and filename of the PDF to be sent. It was decided\u00b9 that a dynamic password was to be used to encrypt the PDF.", "Planning this well is important as it will be replicated on the end-user\u2019s local machine.", "\u201cAnything that can go wrong, will go wrong.\u201d", "I\u2019ve learnt to be extremely prudent (some might say paranoid), when sending letters, especially when they contain sensitive information. Hence, I added a number of checks to ensure that nothing is sent unless the recipients and the PDFs match exactly.", "While these checks may seem overly restrictive, there\u2019s a huge advantage to permit the emails to be sent only when all these checks have passed. It helps to think about what could happen if these checks are not done:", "Any remediation work would require greater effort than the time it takes to write these checks. This is the crux of the issue. Hence, if this is managed well, downstream problems can be avoided.", "This is relatively straightforward, the idea is to launch the Outlook application using win32com.client.Dispatch('Outlook.Application'), create a new mail item outlook.CreateItem(0), add Attachments using mail.Attachments.Add(path_to_file) and finally send using mail.Send().", "The email body is merely a text string added to the mail.HTMLBody attribute.", "The PyPDF2 python library was used to encrypt the PDF file. As always, I found the approach on stackoverflow (here). The hashlib built-in library was used to hash the concatenation of the time string and the filename, then the first 32 characters \u2014i.e. the maximum allowable password length for a PDF file \u2014 of the hash was used as the password. This password was then sent in a separate email to the recipient\u00b2.", "Writing script that works on my own local machine is relatively simple; ensuring that the script works across different machines is a lot tougher, for example, I found that the latest version of the xlrd library supports only .xls files and no longer supports .xlsx files (more info here and here). A quick workaround is to pass the openpyxl argument into the engine parameter, when calling the pd.read_excel method.", "If you enjoy this article, do check out my other articles:", "\u2026and leave a note if this has helped you in one way or another, it\u2019d serve as an encouragement for me to continue writing.", "[1] This is fictitious; the actual nature of password is not disclosed for privacy reasons.", "[2] The best practice is to send the encrypted content and password via different channels, but this way is still acceptable and slightly better than sending the content and password in the same email. See this link for more information.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Business consultant for banks, passionate about scripting and automating work using python. www.linkedin.com/in/ji-wei-liew"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4ce7fd462a99&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://jiweiliew.medium.com/?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": ""}, {"url": "https://jiweiliew.medium.com/?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": "Ji Wei Liew"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf5390a70cc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=post_page-bf5390a70cc8----4ce7fd462a99---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ce7fd462a99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ce7fd462a99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://stackoverflow.com/a/52757623/8350440", "anchor_text": "here"}, {"url": "https://gist.github.com/jiweiliew/27a879962305451e41209d8f2a7e22aa", "anchor_text": "here"}, {"url": "https://stackoverflow.com/a/65266270/8350440", "anchor_text": "here"}, {"url": "https://stackoverflow.com/questions/65250207/pandas-cannot-open-an-excel-xlsx-file", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/i-downloaded-a-game-but-end-up-learning-about-search-algorithms-bc594c382454", "anchor_text": "I downloaded a game but end up learning about search algorithmsPerforming a breadth first search in python and optimizing the solution.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/python-tips-for-someone-transiting-from-excel-ce16c5f9cbac", "anchor_text": "Python tips for someone transiting from ExcelExcel is one of the most frequently used application for data analysis. However, due with its clear limitations (i.e\u2026towardsdatascience.com"}, {"url": "https://security.stackexchange.com/questions/94102/is-it-good-practice-to-send-passwords-in-separate-emails-and-why", "anchor_text": "link"}, {"url": "https://medium.com/tag/python?source=post_page-----4ce7fd462a99---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/pdf?source=post_page-----4ce7fd462a99---------------pdf-----------------", "anchor_text": "Pdf"}, {"url": "https://medium.com/tag/password-protection?source=post_page-----4ce7fd462a99---------------password_protection-----------------", "anchor_text": "Password Protection"}, {"url": "https://medium.com/tag/outlook?source=post_page-----4ce7fd462a99---------------outlook-----------------", "anchor_text": "Outlook"}, {"url": "https://medium.com/tag/hash?source=post_page-----4ce7fd462a99---------------hash-----------------", "anchor_text": "Hash"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ce7fd462a99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=-----4ce7fd462a99---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4ce7fd462a99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=-----4ce7fd462a99---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4ce7fd462a99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4ce7fd462a99&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4ce7fd462a99---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4ce7fd462a99--------------------------------", "anchor_text": ""}, {"url": "https://jiweiliew.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://jiweiliew.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ji Wei Liew"}, {"url": "https://jiweiliew.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "86 Followers"}, {"url": "http://www.linkedin.com/in/ji-wei-liew", "anchor_text": "www.linkedin.com/in/ji-wei-liew"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbf5390a70cc8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=post_page-bf5390a70cc8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fde67d60b7022&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-encrypt-pdf-and-send-as-an-email-attachment-using-python-4ce7fd462a99&newsletterV3=bf5390a70cc8&newsletterV3Id=de67d60b7022&user=Ji+Wei+Liew&userId=bf5390a70cc8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}