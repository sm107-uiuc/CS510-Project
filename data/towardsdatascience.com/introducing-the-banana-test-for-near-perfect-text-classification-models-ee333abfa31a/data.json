{"url": "https://towardsdatascience.com/introducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a", "time": 1682997644.050407, "path": "towardsdatascience.com/introducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a/", "webpage": {"metadata": {"title": "Introducing the \u201cBanana Test\u201d for Text Classification Models | by SJ Porter | Towards Data Science", "h1": "Introducing the \u201cBanana Test\u201d for Text Classification Models", "description": "Combine spelling correction, term filtering, and the \u201cBanana Test\u201d to build a bullet-proof text classification model."}, "outgoing_paragraph_urls": [], "all_paragraphs": ["There are millions of instances in which businesses have collected free-form text in their systems. In order to automate business processes that utilize this data, the free-form text often needs to be bucketed into higher-level categories. Text classification models are capable of classifying such free-form text quickly and effectively\u2026 for the most part.", "Regardless of the reported validation/test accuracy, there are a number of gotchas that can cause even the most well-trained text classification model to fail miserably at making an accurate classification. In particular, text classification models tend to fail when faced with text they have never seen seen before.", "If your goal is maximizing accuracy for a new text classification model, you should consider using the Banana Test. Despite the silly name, it\u2019s a very real technique that you can use to improve the quality of your models.", "The Banana Test is intended to be applied as a deciding factor (usually in combination with the confidence interval) for whether a given classification can be trusted. Since a machine learning model will always classify data by default and the confidence interval it provides is little more than a measure of probability (rather than accuracy), the Banana Test helps ensure that a model only classifies new data when it has adequate training data to make a confident decision. How it works and why it\u2019s important are both very simple concepts.", "To explain the name of the test, the word \u201cbanana\u201d has never been relevant to any company I\u2019ve worked for. Due to my prior experience as a product owner before branching into data science, I came to believe that defining proper acceptance criteria is essential to developing a good product. So, as a form of acceptance criteria for any new text classification model being built, I enforce that my models should never confidently classify a text string that has the word \u201cbanana\u201d in it.", "So, the Banana Test is simply the practice of comparing the list of terms in the input data you want to classify against the list of terms that the model has been trained on and determining whether or not there is full coverage. If there are terms that aren\u2019t contained in the training data, then the input data fails the Banana Test and should probably not be classified by the model. This can be done extremely easily in Python using a set intersection (or a number of other solutions); the specific implementation is up to you.", "This strategy has led to accurate and reliable text classification models at the cost of a slight reduction to the percentage of records that are classified.", "Let\u2019s say you\u2019re training a tensorflow model to distinguish beers from wines, and the input data is provided as free-form text. Let\u2019s also say that your model accepts a maximum of five terms (words) of input as a padded array based on a tokenizer and word index.", "After preprocessing and tokenizing some training data, your word index may look something like this:", "Based on the word index above\u2026", "That all sounds well and good. However, there are many values you could provide to such a model that would result in misclassifications. For instance\u2026", "Based on the examples above, wouldn\u2019t it be best if your model were able to self-report that it saw new terms that it was never trained on and avoid classifying these discrepant records?", "By applying the Banana Test before making a prediction, your model would be able to kick out each of the records above and provide an array of terms that failed the test such as bourbon, banana, definitely, etc. This approach would allow you to create a very meaningful feedback loop. It also means you could put your model into production and know that it will only classify records when it recognizes each of the terms.", "There are a few issues that can occur when applying the Banana Test. Namely, the Banana Test may flag terms that were filtered out during the training process and/or fail to identify misspellings.", "The following steps are what I would consider to be prerequisites for applying the Banana Test so that you can avoid such issues. No matter how you decide to preprocess your data, the exact same steps should be applied during both the training process and the classification process.", "You should almost always normalize text into a single case (typically lowercase) before training a text classification model or feeding it new data to classify. I say \u201calmost always\u201d because I\u2019m sure there\u2019s some exception out there in which casing may be meaningful to the model.", "Term filtering is not always a requirement, but typically recommended. Some terms, even stopwords, may still be important for providing context to something such as a Long Short Term Memory (LSTM) layer. There\u2019s a fine line that you will need to walk between filtering too few or too many terms from the text corpus. Good luck with that.", "Spelling correction helps normalize variations of terms so that the Banana Test (and the model in general) are as effective as possible. One approach I\u2019ve used in the past is to compare the most frequently-spotted terms in the text corpus to every other term in the text corpus using a string distance function. By filtering the results based on the string distance score, many misspellings that are present in the data will come to light. This technique requires manual vetting, but often yields great results if the terms/misspellings in your data are a bit more complex than what a general spelling auto-correction algorithm could reliably handle.", "The Banana Split is an optional enhancement to the Banana Test (as you can tell by now, I enjoy goofy names for serious things). To put it simply, the Banana Split is the practice of splitting off the top N percent of the total terms from the text corpus (based on TF/IDF) before performing the Banana Test.", "The Banana Split is important because the least frequent terms in the text corpus presumably have the least amount of training data associated with them. By applying the Banana Split to your implementation of the Banana Test, you can control how conservative your model behaves when classifying data. Terms that the model has seen (but perhaps very infrequently) can be kicked out as if the model has never seen them before.", "Despite the funny name and simple approach, this technique has been critical for making text classification algorithms that can handle new data effectively with minimal mistakes. It has helped myself and my team substantially improve the accuracy and reliability of dozens of models so far, and has become a standard practice for us. I hope that it benefits you as well, and maybe one day I\u2019ll hear about someone else using the Banana Test!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data engineer, musician, and gamer. Editor for Low Code for Advanced Data Science, writer for TDS and The Startup."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fee333abfa31a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sj-porter.medium.com/?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": ""}, {"url": "https://sj-porter.medium.com/?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": "SJ Porter"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe225f3656e6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&user=SJ+Porter&userId=e225f3656e6c&source=post_page-e225f3656e6c----ee333abfa31a---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee333abfa31a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee333abfa31a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/bananas-fruits-food-grocery-store-698608/", "anchor_text": "https://pixabay.com/photos/bananas-fruits-food-grocery-store-698608/"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----ee333abfa31a---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/text-classification?source=post_page-----ee333abfa31a---------------text_classification-----------------", "anchor_text": "Text Classification"}, {"url": "https://medium.com/tag/testing?source=post_page-----ee333abfa31a---------------testing-----------------", "anchor_text": "Testing"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----ee333abfa31a---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----ee333abfa31a---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://creativecommons.org/licenses/by-nd/4.0/", "anchor_text": "Some rights reserved"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fee333abfa31a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&user=SJ+Porter&userId=e225f3656e6c&source=-----ee333abfa31a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fee333abfa31a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&user=SJ+Porter&userId=e225f3656e6c&source=-----ee333abfa31a---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fee333abfa31a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fee333abfa31a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ee333abfa31a---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ee333abfa31a--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ee333abfa31a--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ee333abfa31a--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ee333abfa31a--------------------------------", "anchor_text": ""}, {"url": "https://sj-porter.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sj-porter.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "SJ Porter"}, {"url": "https://sj-porter.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "277 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe225f3656e6c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&user=SJ+Porter&userId=e225f3656e6c&source=post_page-e225f3656e6c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa33678934cf&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintroducing-the-banana-test-for-near-perfect-text-classification-models-ee333abfa31a&newsletterV3=e225f3656e6c&newsletterV3Id=a33678934cf&user=SJ+Porter&userId=e225f3656e6c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}