{"url": "https://towardsdatascience.com/am-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373", "time": 1683009180.547269, "path": "towardsdatascience.com/am-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373/", "webpage": {"metadata": {"title": "Am I sure or unsure?\u2014 Uncertainty talks with a neural network | by Purvanshi Mehta | Towards Data Science", "h1": "Am I sure or unsure?\u2014 Uncertainty talks with a neural network", "description": "If your cell phone is suggesting whether a mushroom you just picked up from your backyard for your dinner is poisonous, it better be sure about it! Computer vision applications are now dominated by\u2026"}, "outgoing_paragraph_urls": [{"url": "https://qz.com/1146753/ai-is-now-so-complex-its-creators-cant-trust-why-it-makes-decisions/", "anchor_text": "debates", "paragraph_index": 0}], "all_paragraphs": ["If your cell phone is suggesting whether a mushroom you just picked up from your backyard for your dinner is poisonous, it better be sure about it! Computer vision applications are now dominated by the applications of neural networks. They have affected each and every one of our lives, thus, also increasing the suspicion. There have been many debates on the trustworthiness of this black box machine. One way by which a model can make itself more trustworthy is by telling us how sure or unsure is it of its decision rather than just saying \u2018this is my decision\u2019.", "But then the question comes down to how good the current state of the art neural networks are at determining how sure they are of their decision.", "Through this post, we will understand \u2014", "The problem of predicting probability estimates representative of the true likelihood is called confidence calibration. For example, given 100 predictions, each with the confidence of 0.8, we expect that 80 should be correctly classified. The easiest way to measure this is a plot of confidence vs accuracy. This is known as the Reliability Diagram.", "The x-axis here is the Bin Accuracy or number of correct samples/ total number of samples in that bin-", "and the y-axis is the confidence or the average of the probabilities in that bin -", "If the confidence always equals the accuracy i.e the x=y line the model is perfectly calibrated. If a model\u2019s calibration plot lies above the x=y (Perfect Calibration)line this means it gives higher probability estimates for correct classes which makes it overconfident. Lower probability estimates for correct classes means the model is underconfident.", "Can we convert the reliability diagram into a number for comparing the calibrations of different models?", "The difference in expectation between confidence and accuracy", "Intuitively it can be understood as the difference between the model\u2019s calibration plot and the x=y line i.e perfect calibration line.", "We optimize a neural network by maximum likelihood estimation (MLE) given by", "i.e we maximize the probability of data given the weights/ model parameters. If we add a regulariser term we can see MLE converts to a maximum a posteriori (MAP) estimate. P(w) is l2 regularization if we have a Gaussian prior over W and l1 regularization if we have a Laplace prior over W.", "We want the probability output by the model to match the true posterior of the data! We need a loss function which minimizes the distance between the distribution over labels output by the model to the exact posterior distribution of the data (we minimize the distance between two distributions by KL-divergence).", "First, let's see what is usually \u2018taken\u2019 as the \u2018posterior\u2019 in the case of single-class classification looks. If we have two classes \u2014 a cat and dog (please note this nowhere represents the true posterior of the data). The posterior, if a dog is present would look like [0,1] and if a cat is present is would be [1,0]. (Our posterior looks like a delta function in this case)", "The KL-divergence for this binary classification task can be given by -", "Where x is the input picture, P is the actual distribution and P_theta is the computed by our model.", "The average KL divergence can be given by \u2014", "We can already see this taking the form of the most commonly used loss function to optimize neural networks - the cross-entropy.", "Since the first term does not depend on theta term and therefore does not affect the argmin_theta. The resulting equation is the cross-entropy loss \u2014", "Therefore minimizing the cross-entropy is equivalent to minimizing the KL-divergence between model output and posterior from the data. Thus theoretically any neural network should be perfectly calibrated (There are many causes which lead to miscalibration, let's keep it for another post for now!)", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffc0e14d31373&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://purvanshimehta.medium.com/?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": ""}, {"url": "https://purvanshimehta.medium.com/?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": "Purvanshi Mehta"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdd804fb2ae16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&user=Purvanshi+Mehta&userId=dd804fb2ae16&source=post_page-dd804fb2ae16----fc0e14d31373---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc0e14d31373&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc0e14d31373&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://qz.com/1146753/ai-is-now-so-complex-its-creators-cant-trust-why-it-makes-decisions/", "anchor_text": "debates"}, {"url": "https://docs.pymc.io/notebooks/bayesian_neural_network_advi.html", "anchor_text": "https://docs.pymc.io/notebooks/bayesian_neural_network_advi.html"}, {"url": "https://arxiv.org/pdf/1706.04599.pdf", "anchor_text": "https://arxiv.org/pdf/1706.04599.pdf"}, {"url": "https://medium.com/tag/uncertainty?source=post_page-----fc0e14d31373---------------uncertainty-----------------", "anchor_text": "Uncertainty"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----fc0e14d31373---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----fc0e14d31373---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----fc0e14d31373---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fc0e14d31373---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc0e14d31373&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&user=Purvanshi+Mehta&userId=dd804fb2ae16&source=-----fc0e14d31373---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffc0e14d31373&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&user=Purvanshi+Mehta&userId=dd804fb2ae16&source=-----fc0e14d31373---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffc0e14d31373&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffc0e14d31373&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fc0e14d31373---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fc0e14d31373--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fc0e14d31373--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fc0e14d31373--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fc0e14d31373--------------------------------", "anchor_text": ""}, {"url": "https://purvanshimehta.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://purvanshimehta.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Purvanshi Mehta"}, {"url": "https://purvanshimehta.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fdd804fb2ae16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&user=Purvanshi+Mehta&userId=dd804fb2ae16&source=post_page-dd804fb2ae16--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe3091ac16a9a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fam-i-sure-or-unsure-talks-with-a-neural-network-fc0e14d31373&newsletterV3=dd804fb2ae16&newsletterV3Id=e3091ac16a9a&user=Purvanshi+Mehta&userId=dd804fb2ae16&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}