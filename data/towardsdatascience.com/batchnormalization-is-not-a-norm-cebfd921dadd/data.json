{"url": "https://towardsdatascience.com/batchnormalization-is-not-a-norm-cebfd921dadd", "time": 1683000566.4009888, "path": "towardsdatascience.com/batchnormalization-is-not-a-norm-cebfd921dadd/", "webpage": {"metadata": {"title": "BatchNormalization is not a norm! | by Prateek Gulati | Towards Data Science", "h1": "BatchNormalization is not a norm!", "description": "Deep neural networks have extensively improved the state of art in the recent few years in multiple domains, especially in vision and text. With the advancement in infrastructure to support deep\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/is-relu-reluvant-52b03bc48daa", "anchor_text": "Is ReLU ReLUvant", "paragraph_index": 6}, {"url": "https://colab.research.google.com/drive/1j3BuZaMgbx18uJqD1QHNNsnxCwbJqXbr", "anchor_text": "Colab Notebook", "paragraph_index": 16}, {"url": "https://www.linkedin.com/in/prateeksworld/", "anchor_text": "https://www.linkedin.com/in/prateeksworld/", "paragraph_index": 19}], "all_paragraphs": ["Deep neural networks have extensively improved the state of art in the recent few years in multiple domains, especially in vision and text. With the advancement in infrastructure to support deep neural networks, the research is diverted to make the maximum use of the available hardware by making the network wider and deeper and improving the accuracy. A key aspect of Deep Neural Networks that makes it feasible to go deeper without compromising with the training speed is because of Batch Normalization. This makes BatchNorm an essential component of CNNs. In the majority of current State of Art models for object recognition, there is a BatchNorm layer after a convolution layer within the network architecture. But how important is it to have a Batch Normalization? Do we require a batch normalization for every convolution that is performed? In this article, we will try to answer some of these questions.", "Normalization is a data preparation technique to make sure that the data is consistent and has a uniform scale. In Images, commonly used data preparation techniques include pixel normalization and image normalization.", "The above techniques can help in normalizing the image until the training begins. Once we convolve over the image, there is no driving force that restricts the scale change and stays consistent. This formulates a need to include another normalization technique that can be used after each convolution operation. That\u2019s when Batch normalization steps in. It helps in the reduction of the internal covariate shift.", "In layman terms, a covariate shift refers to the distribution of the features which is different in different parts of the dataset. The same difference when observed within the network layers due to the distribution of activations is termed as the internal covariance shift. Using BatchNorm, we add a normalization step that fixes the means and variances of layer inputs which helps in faster convergence and improved gradient flow through the network, by reducing the dependence of gradients on the scale of the parameters or of their initial values.", "After its invention, Batch Normalization has been widely accepted in CNNs. Though, recently, there had been claims of BN not performing well in two scenarios \u2014 When the batch size is very small and recurrent connections in an RNN. Apart from this, BN is still preferred over other techniques because of its ease of regulation and availability across all popular frameworks.", "This majorly justifies the usage of BN within the network architecture, but no research talks about how frequent a BN should be added. If we look at the State of Art Networks, a BN is added post a 3x3 convolution. Let us test this theory through an experiment.", "In my previous article \u2014 Is ReLU ReLUvant, I examined the usage of ReLU by conducting a small experiment of randomly dropping ReLU layers within the network and testing the accuracy. The results were confounding \u2014 the best accuracy was achieved where 10 to 20 percent of total ReLUs were dropped in the network. Though reaching to any conclusion from that experiment was still open to question, but it did motivate me to conduct a similar experiment with Batch Normalization.", "Let us begin with a ResNet1\u2078\u00b9 model with a fully pre-activated ResNet\u00b9 block. In this experiment, we will randomly drop some BN layers starting from 100% and dropping by 10% in each succeeding experiment keeping all other parameters consistent.", "For this experiment, we will be using the CIFAR10\u00b2 dataset", "SGD with a momentum of 0.9 and weight decay of 5e-4 is used. One Cycle Learning Rate Strategy with a gradual drop towards the later epochs which has a MaxLR of 0.4 at 5th epoch.", "The model has 4 ResNet\u00b9 blocks. Unlike traditional ResNet1\u2078\u00b9, at the end of a ResNet\u00b9 block, we concatenate the input and residual path followed by a pointwise convolution to filter the information being taken ahead.The model has 19 BN layers.", "On the CIFAR10\u00b2 dataset, this model gives a validation accuracy of\u224888% in 24 epochs on Google Colab. This model has \u2248 27M parameters.", "Surprisingly, the best validation accuracy is achieved where 50% of BN layers were randomly dropped. Further in this scenario, the training accuracy is slightly less, so, the model is more regularized. The accuracy where we have one BN for one convolution is 1.03% behind the accuracy where we have just half of BN layers. Surprisingly the best accuracy when we use just 20% of total BN is still better than when all BN layers are used.", "With these results, we can partially answer our questions", "Do we need a BN layer at all in a network?Yes. Without BN, the model accuracy drops by a huge margin. So we do need to have some normalization techniques.Does adding a BN blindly after each convolution is the right way to build a CNN architecture?Probably Not!Is there a better way?Definitely Yes!How to decide if there is a need to add BN or not?Grid Search can be one way, but I can\u2019t think of any other optimal way to decide whether to add BN after a convolution or not. Though intuitively, we might need to avoid adding BN layers towards the end of the model so that the prediction layer gets to see a wider range of values.", "Though we still don\u2019t know the appropriate method for a convolution layer to have a BN or not, hopefully, this does help us to understand that there is still a need to question the use of very basic elements when designing a Deep Neural Network.", "The experiment can be found in this Colab Notebook.", "Thank you for reading! Let me know what you think in the comments. Thanks again and keep on learning!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Exploring realms of Deep Learning | Data Scientist | Software Engineer II at Dell | LinkedIn: https://www.linkedin.com/in/prateeksworld/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcebfd921dadd&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@prateeks_world?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prateeks_world?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": "Prateek Gulati"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F67afa97f53d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&user=Prateek+Gulati&userId=67afa97f53d9&source=post_page-67afa97f53d9----cebfd921dadd---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcebfd921dadd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcebfd921dadd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.nzfaruqui.com/", "anchor_text": "Nuruzzaman Faruqui"}, {"url": "https://towardsdatascience.com/is-relu-reluvant-52b03bc48daa", "anchor_text": "Is ReLU ReLUvant"}, {"url": "https://colab.research.google.com/drive/1j3BuZaMgbx18uJqD1QHNNsnxCwbJqXbr", "anchor_text": "Colab Notebook"}, {"url": "https://arxiv.org/pdf/1512.03385.pdf", "anchor_text": "Deep Residual Learning for Image Recognition"}, {"url": "https://www.cs.toronto.edu/~kriz/learning-features-2009-TR.pdf", "anchor_text": "Learning Multiple Layers of Features from Tiny Images"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----cebfd921dadd---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----cebfd921dadd---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/batch-normalization?source=post_page-----cebfd921dadd---------------batch_normalization-----------------", "anchor_text": "Batch Normalization"}, {"url": "https://medium.com/tag/cnn?source=post_page-----cebfd921dadd---------------cnn-----------------", "anchor_text": "Cnn"}, {"url": "https://medium.com/tag/resnet?source=post_page-----cebfd921dadd---------------resnet-----------------", "anchor_text": "Resnet"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcebfd921dadd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&user=Prateek+Gulati&userId=67afa97f53d9&source=-----cebfd921dadd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fcebfd921dadd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&user=Prateek+Gulati&userId=67afa97f53d9&source=-----cebfd921dadd---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcebfd921dadd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fcebfd921dadd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----cebfd921dadd---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----cebfd921dadd--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cebfd921dadd--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----cebfd921dadd--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----cebfd921dadd--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prateeks_world?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@prateeks_world?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Prateek Gulati"}, {"url": "https://medium.com/@prateeks_world/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "24 Followers"}, {"url": "https://www.linkedin.com/in/prateeksworld/", "anchor_text": "https://www.linkedin.com/in/prateeksworld/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F67afa97f53d9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&user=Prateek+Gulati&userId=67afa97f53d9&source=post_page-67afa97f53d9--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F67afa97f53d9%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbatchnormalization-is-not-a-norm-cebfd921dadd&user=Prateek+Gulati&userId=67afa97f53d9&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}