{"url": "https://towardsdatascience.com/build-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b", "time": 1683005419.26073, "path": "towardsdatascience.com/build-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b/", "webpage": {"metadata": {"title": "Build a Custom ResNetV2 with the desired depth from scratch | by Akash Desarda | Towards Data Science", "h1": "Build a Custom ResNetV2 with the desired depth from scratch", "description": "ResNet has been always one of my favourite architecture and I have used its core idea of skip connection many times. It is now fairly old as both ResNetV1(Deep Residual Learning for Image\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ResNetV1", "paragraph_index": 0}, {"url": "https://arxiv.org/abs/1603.05027", "anchor_text": "ResNetV2", "paragraph_index": 0}, {"url": "https://github.com/Akashdesarda/ResNet-builder", "anchor_text": "here", "paragraph_index": 7}, {"url": "https://github.com/Akashdesarda/ResNet-builder", "anchor_text": "ResNet-builder", "paragraph_index": 24}, {"url": "https://www.linkedin.com/in/akashdesarda/", "anchor_text": "Linkedin", "paragraph_index": 26}, {"url": "https://www.linkedin.com/in/akashdesarda/", "anchor_text": "https://www.linkedin.com/in/akashdesarda/", "paragraph_index": 28}], "all_paragraphs": ["ResNet has been always one of my favourite architecture and I have used its core idea of skip connection many times. It is now fairly old as both ResNetV1(Deep Residual Learning for Image Recognition), ResNetV2( Identity Mappings in Deep Residual Networks) came in 2015 & 2016, but still today its core concept is widely used. So you must be thinking\u2026 why this tutorial in 2020.", "There are two primary reasons for this tutorial:", "This tutorial is divided into two-part. Part 1 will briefly discuss ResNet and Part two will focus on the coding part. Keep one thing in mind the primary goal of this tutorial is to showcase the coding part of building the ResNet model with any desired no of depth/layer from scratch.", "One of the biggest problems of any deep learning network is Vanishing, Exploding gradient. This restricts us to go much deeper into the network. Refer to video if you are not aware or want to refresh it.", "I will try to put it in simple words. The core idea of ResNet is based on skip connection i.e. it allows to take activation from one layer and feed it to future layer (can be much deep). Consider the problem of vanishing gradient, when we go deeper some neuron will not contribute anything because their weights have reduced significantly. But now if we bring activation from the earlier layer and add to the current layer before activation, now it will certainly contribute.", "Refer this video to understand it more mathematically", "Now without wasting time let us move towards coding part", "Note: I have published the repo containing all the code and can be found here.", "Inside network sometime convolution layer is not used first so we have to use an if-else loop.", "2. Next is add layers. We will use Keras functional API for the same purpose", "\u2192 On line #7 we take input", "\u2192line #10 is used to create a convolution layer before splitting into two paths. Here we are using the same residual block which we created earlier.", "\u2192from line #13\u201355 are used to create a stack of residual units. Let's discuss this in more details. After line #10 the network is split into two part & later are added. Now in part one three operations are performed,", "batch norm \u2192 activation \u2192 Conv.", "This process is repeated thrice and finally added. To put in ResNet perspective, after splitting, in one sub-network we perform some operation (as mentioned above) and add its activation to the state where we split. So you see we skipped or jumped three layers.", "Why three layers? It depends on your intuition. It can be two or four or anything. I found the best result with three & also the author have suggested with two or three layers.", "Time to go deeper into code\u2026litrely\u2026 :)", "\u2192line #13 starts appending stacks of the residual block in for loop. (A simple trick here to skip over the desired layer is a start for loop in that range)", "\u2192line #30\u201344 is used to append the convolution layer in one of sub-network after performing the split.", "Here you can see that I have used three residual blocks. Why three? Because I am skipping over three activations", "\u2192line #45\u201353: after performing the split, second sub-network must be a convolution layer which can be skipped ahead added later.", "\u2192line #54 is where all the magic takes place :). Here we add our both sub-network.", "3. Last part is to connect a fully connected layer on top of the network.", "You can customize this part at your will.", "I would suggest you go through my GitHub repo \u2018ResNet-builder\u2019 as it includes a lot of more APIs which I thought might my out of scope for this blog. This blog was restricted to building a ResNet network. But to build a complete ResNet system we will need much more functionality like a Data loader, Inference generator, Visualize model performance, etc. I have included all these APIs.", "The repo also supports a variety of configurations to build a model.", "I have tried to keep API as intuitive as possible, though if you have any confusion you can connect me via Linkedin.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Engineer @ Duff and Phelps | I am a person who always tries to find an alternative. LinkedIn: https://www.linkedin.com/in/akashdesarda/"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F92892ec79d4b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@desardaakash?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@desardaakash?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": "Akash Desarda"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd17e5f5c398e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&user=Akash+Desarda&userId=d17e5f5c398e&source=post_page-d17e5f5c398e----92892ec79d4b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92892ec79d4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92892ec79d4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1512.03385", "anchor_text": "ResNetV1"}, {"url": "https://arxiv.org/abs/1603.05027", "anchor_text": "ResNetV2"}, {"url": "https://github.com/Akashdesarda/ResNet-builder", "anchor_text": "here"}, {"url": "https://github.com/Akashdesarda/ResNet-builder", "anchor_text": "ResNet-builder"}, {"url": "https://www.linkedin.com/in/akashdesarda/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----92892ec79d4b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/resnet?source=post_page-----92892ec79d4b---------------resnet-----------------", "anchor_text": "Resnet"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----92892ec79d4b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----92892ec79d4b---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----92892ec79d4b---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F92892ec79d4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&user=Akash+Desarda&userId=d17e5f5c398e&source=-----92892ec79d4b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F92892ec79d4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&user=Akash+Desarda&userId=d17e5f5c398e&source=-----92892ec79d4b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F92892ec79d4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F92892ec79d4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----92892ec79d4b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----92892ec79d4b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----92892ec79d4b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----92892ec79d4b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----92892ec79d4b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@desardaakash?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@desardaakash?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Akash Desarda"}, {"url": "https://medium.com/@desardaakash/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "504 Followers"}, {"url": "https://www.linkedin.com/in/akashdesarda/", "anchor_text": "https://www.linkedin.com/in/akashdesarda/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd17e5f5c398e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&user=Akash+Desarda&userId=d17e5f5c398e&source=post_page-d17e5f5c398e--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe623bbd4584f&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuild-a-custom-resnetv2-with-the-desired-depth-92892ec79d4b&newsletterV3=d17e5f5c398e&newsletterV3Id=e623bbd4584f&user=Akash+Desarda&userId=d17e5f5c398e&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}