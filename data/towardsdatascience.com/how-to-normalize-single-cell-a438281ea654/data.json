{"url": "https://towardsdatascience.com/how-to-normalize-single-cell-a438281ea654", "time": 1682999825.337364, "path": "towardsdatascience.com/how-to-normalize-single-cell-a438281ea654/", "webpage": {"metadata": {"title": "How to Normalize Single Cell. Comparing normalization strategies for\u2026 | by Nikolay Oskolkov | Towards Data Science", "h1": "How to Normalize Single Cell", "description": "This is the ninth article of the column Mathematical Statistics and Machine Learning for Life Sciences where I try to cover analytical techniques common for Bioinformatics, Biomedicine, Genetics\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/tagged/stats-ml-life-sciences?source=post_page---------------------------", "anchor_text": "Mathematical Statistics and Machine Learning for Life Sciences", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Single_cell_sequencing", "anchor_text": "single cell genomics", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/pitfalls-of-data-normalization-bf05d65f1f4c", "anchor_text": "massive cell-to-cell gene expression variation", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Single-cell_transcriptomics", "anchor_text": "single cell RNA sequencing (scRNAseq)", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Polymerase_chain_reaction", "anchor_text": "PCR amplification", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Reverse_transcriptase", "anchor_text": "reverse transcription (RT)", "paragraph_index": 1}, {"url": "https://genomebiology.biomedcentral.com/articles/10.1186/gb-2010-11-3-r25", "anchor_text": "TMM", "paragraph_index": 1}, {"url": "https://genomebiology.biomedcentral.com/articles/10.1186/gb-2010-11-10-r106", "anchor_text": "DESeq", "paragraph_index": 1}, {"url": "https://www.ebi.ac.uk/research/marioni", "anchor_text": "Marioni\u2019s lab", "paragraph_index": 3}, {"url": "https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0947-7", "anchor_text": "deconvolution normalization", "paragraph_index": 3}, {"url": "https://www.nature.com/articles/nmeth.4263", "anchor_text": "SCnorm", "paragraph_index": 4}, {"url": "https://www.biorxiv.org/content/10.1101/576827v2.full", "anchor_text": "Pearson residuals", "paragraph_index": 4}, {"url": "https://www.nature.com/articles/ni.3368", "anchor_text": "\u00c5. Bj\u00f6rklund et al., Nature Immunology 17, p. 451\u2013460 (2016)", "paragraph_index": 5}, {"url": "https://github.com/NikolayOskolkov/NormalizeSingleCell", "anchor_text": "github", "paragraph_index": 6}, {"url": "https://www.ncbi.nlm.nih.gov/pubmed/24385147", "anchor_text": "SmartSeq2", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Coefficient_of_variation", "anchor_text": "Coefficient of Variation", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "tSNE", "paragraph_index": 8}, {"url": "https://github.com/NikolayOskolkov/NormalizeSingleCell", "anchor_text": "github", "paragraph_index": 13}, {"url": "https://medium.com/u/8570b484f56c?source=post_page-----a438281ea654--------------------------------", "anchor_text": "Nikolay Oskolkov", "paragraph_index": 13}, {"url": "http://linkedin.com/in/nikolay-oskolkov-abb321186?source=post_page---------------------------", "anchor_text": "Linkedin", "paragraph_index": 13}], "all_paragraphs": ["This is the ninth article of the column Mathematical Statistics and Machine Learning for Life Sciences where I try to cover analytical techniques common for Bioinformatics, Biomedicine, Genetics, Evolutionary Science etc. Today we are going to talk about the challenges of removing technical variation in the exciting single cell genomics area by comparing most popular normalization algorithms.", "It is widely recognized that the massive cell-to-cell gene expression variation in the single cell RNA sequencing (scRNAseq) experiments can be to a large extent technical and thus confound the biological variation related to cell types. The sources of technical variation vary from PCR amplification bias to reverse transcription (RT) efficiency and stochasticity of molecular sampling during the preparation and sequencing steps. Therefore normalization across cells has to be applied in order to eliminate the technical variation and keep the biological one. However, common bulk RNAseq methods such as TMM and DESeq are based on constructing per cell size factors which represent ratios where each cell is normalized by a reference cell built by some sort of averaging across all other cells.", "A peculiarity of scRNAseq data is that they contain in contrast to bulk RNAseq large amounts of stochastic zeros owing to low amounts of RNA per cell and imperfect RNA capture efficiency (dropout). Therefore the TMM and DESeq size factors may become unreliably inflated or equal to zero. Therefore new single cell specific normalization methods were developed accounting for the large amounts of zeros in the scRNAseq data.", "A very elegant attempt of accounting for stochastic zeros in the normalization procedure was made in Marioni\u2019s lab with the deconvolution normalization method. The idea behind the algorithm is to represent all cells by a number of pools of cells, for each pool expression values from multiple cells are summed, which results in fewer zeros, and scaled by an average expression across all cells. Constructed in this way per pool size factors can be deconvolved in a linear system of equations yielding the per cell size factors.", "A disadvantage of such a \u201cglobal size factor approach\u201d is that different groups of genes should not be normalized with the same constant per cell size factor but it should be adjusted individually for each group of genes such as highly, moderately and lowly expressed. This was taken into account in the SCnorm and more recent Pearson residuals normalization algorithms. Both are based on regressing out the sequencing depth bias for different groups of genes.", "Below we will compare different popular normalization strategies using the Innate lymphoid cells (ILC) scRNAseq data from \u00c5. Bj\u00f6rklund et al., Nature Immunology 17, p. 451\u2013460 (2016)", "The scRNAseq analysis workflow is quite complicated, here I will concentrate on the results but encourage you to check the complete notebook in my github. First of all, the ILC scRNAseq data set was produced with the SmartSeq2 full-length transcript sequencing technology, and includes very handy spike-ins (control transcripts with constant concentration across cells) for assessing the technological background noise. These spike-ins can be used for detecting a set of genes with variation above the noise level via plotting the Coefficient of Variation (CV=sd/mean) as a function of the mean gene expression for each normalization method:", "On these plots: one point is one gene, the red curve represents the variation of the spike-ins, the genes above the spike-in curve demonstrate the variation above the technical variation (Highly Variable Genes). One can observe, the number of variable genes varies depending on the normalization method. The RPKM normalization demonstrates the lowest number of variable genes which is perhaps due to spike-ins short length which is used for normalization in the RPKM. Next, we will examine how the Principal Component Analysis (PCA) plot varies depending on the scRNAseq normalization strategy:", "It is hard to see any difference between the normalization methods, the PCA plots look nearly identical demonstrating the cells from the 4 ILC clusters heavily overlapping. Further, as expected, we can get a much more distinct clustering of the ILC cells using the tSNE plots:", "However, the way of normalization does not seem to change much the 4 ILC clusters, they are quite clearly visible regardless of the normalization method. Finally, we can compute the size factors for different normalization strategies and check their correlations:", "Here for simplicity I averaged the SCnorm size factors across different groups of genes. Surprisingly, the size factors are almost indistinguishable across different normalization methods, even including the bulk RNAseq algorithms TMM and DEseq. However, for other scRNAseq data sets this might not look as good as for ILC.", "Looking at the plots above, it feels like the importance of normalization for scRNAseq is slightly overestimated as at least for the SmartSeq2 data set the difference in performance was negligible. If cell populations are distinct enough, i.e. if there is a signal in the data, it does not play a major role which scRNAseq normalization method to choose. Moreover, with the widespread use of UMI-based sequencing protocols, the need for complex normalization algorithm becomes even less pronounced as those protocols are in principle capable of removing the amplification and sequencing depth bias as multiple reads are collapsed into a single UMI count.", "In this post, we have learnt that due to massive amounts of stochastic zeros in scRNAseq data sets, the ratio based traditional bulk RNAseq normalization algorithms are not applicable. Deconvolution and SCnorm represent elegant scRNAseq specific normalization methods. However, comparison of scRNAseq normalization methodologies does not demonstrate pronounced difference in their performance, this might become even less notable with the advances in UMI-based scRNAseq protocols.", "In the comments below let me know which analyses in Life Sciences seem especially mysterious to you and I will try to address them in this column. Check the codes from the post on my github. Follow me at Medium Nikolay Oskolkov, in Twitter @NikolayOskolkov and connect in Linkedin. Next time we will cover how to batch correct single cell data, stay tuned.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa438281ea654&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a438281ea654--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a438281ea654--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nikolay-oskolkov.medium.com/?source=post_page-----a438281ea654--------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=post_page-----a438281ea654--------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8570b484f56c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&user=Nikolay+Oskolkov&userId=8570b484f56c&source=post_page-8570b484f56c----a438281ea654---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa438281ea654&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa438281ea654&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/stats-ml-life-sciences", "anchor_text": "Mathematical Statistics and Machine Learning for Life Sciences"}, {"url": "https://www.biorxiv.org/content/biorxiv/early/2019/03/18/576827.full.pdf", "anchor_text": "image source"}, {"url": "https://towardsdatascience.com/tagged/stats-ml-life-sciences?source=post_page---------------------------", "anchor_text": "Mathematical Statistics and Machine Learning for Life Sciences"}, {"url": "https://en.wikipedia.org/wiki/Single_cell_sequencing", "anchor_text": "single cell genomics"}, {"url": "https://towardsdatascience.com/pitfalls-of-data-normalization-bf05d65f1f4c", "anchor_text": "massive cell-to-cell gene expression variation"}, {"url": "https://en.wikipedia.org/wiki/Single-cell_transcriptomics", "anchor_text": "single cell RNA sequencing (scRNAseq)"}, {"url": "https://en.wikipedia.org/wiki/Polymerase_chain_reaction", "anchor_text": "PCR amplification"}, {"url": "https://en.wikipedia.org/wiki/Reverse_transcriptase", "anchor_text": "reverse transcription (RT)"}, {"url": "https://genomebiology.biomedcentral.com/articles/10.1186/gb-2010-11-3-r25", "anchor_text": "TMM"}, {"url": "https://genomebiology.biomedcentral.com/articles/10.1186/gb-2010-11-10-r106", "anchor_text": "DESeq"}, {"url": "https://github.com/mgonzalezporta", "anchor_text": "teaching material"}, {"url": "https://www.nature.com/articles/nmeth.2967", "anchor_text": "dropout"}, {"url": "https://www.ebi.ac.uk/research/marioni", "anchor_text": "Marioni\u2019s lab"}, {"url": "https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0947-7", "anchor_text": "deconvolution normalization"}, {"url": "https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0947-7", "anchor_text": "A. Lun et al., Genome Biology 2017"}, {"url": "https://www.nature.com/articles/nmeth.4263", "anchor_text": "SCnorm"}, {"url": "https://www.biorxiv.org/content/10.1101/576827v2.full", "anchor_text": "Pearson residuals"}, {"url": "https://www.nature.com/articles/nmeth.4263", "anchor_text": "Bacher et al., Nature Methods 2017"}, {"url": "https://www.nature.com/articles/ni.3368", "anchor_text": "\u00c5. Bj\u00f6rklund et al., Nature Immunology 17, p. 451\u2013460 (2016)"}, {"url": "https://github.com/NikolayOskolkov/NormalizeSingleCell", "anchor_text": "github"}, {"url": "https://www.ncbi.nlm.nih.gov/pubmed/24385147", "anchor_text": "SmartSeq2"}, {"url": "https://en.wikipedia.org/wiki/Coefficient_of_variation", "anchor_text": "Coefficient of Variation"}, {"url": "https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding", "anchor_text": "tSNE"}, {"url": "https://www.nature.com/articles/nmeth.4292", "anchor_text": "images source"}, {"url": "https://github.com/NikolayOskolkov/NormalizeSingleCell", "anchor_text": "github"}, {"url": "https://medium.com/u/8570b484f56c?source=post_page-----a438281ea654--------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "http://linkedin.com/in/nikolay-oskolkov-abb321186?source=post_page---------------------------", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a438281ea654---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a438281ea654---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a438281ea654---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/tag/stats-ml-life-sciences?source=post_page-----a438281ea654---------------stats_ml_life_sciences-----------------", "anchor_text": "Stats Ml Life Sciences"}, {"url": "https://medium.com/tag/bioinformatics?source=post_page-----a438281ea654---------------bioinformatics-----------------", "anchor_text": "Bioinformatics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa438281ea654&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&user=Nikolay+Oskolkov&userId=8570b484f56c&source=-----a438281ea654---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa438281ea654&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&user=Nikolay+Oskolkov&userId=8570b484f56c&source=-----a438281ea654---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa438281ea654&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a438281ea654--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa438281ea654&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a438281ea654---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a438281ea654--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a438281ea654--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a438281ea654--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a438281ea654--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a438281ea654--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a438281ea654--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a438281ea654--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a438281ea654--------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nikolay-oskolkov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nikolay Oskolkov"}, {"url": "https://nikolay-oskolkov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.1K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8570b484f56c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&user=Nikolay+Oskolkov&userId=8570b484f56c&source=post_page-8570b484f56c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff4a74ad409c6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-normalize-single-cell-a438281ea654&newsletterV3=8570b484f56c&newsletterV3Id=f4a74ad409c6&user=Nikolay+Oskolkov&userId=8570b484f56c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}