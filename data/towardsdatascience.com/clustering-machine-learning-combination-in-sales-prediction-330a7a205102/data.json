{"url": "https://towardsdatascience.com/clustering-machine-learning-combination-in-sales-prediction-330a7a205102", "time": 1683000952.2299352, "path": "towardsdatascience.com/clustering-machine-learning-combination-in-sales-prediction-330a7a205102/", "webpage": {"metadata": {"title": "Efficient Products Clustering Can Drive Retail Sales | by Sarit Maitra | Towards Data Science", "h1": "Efficient Products Clustering Can Drive Retail Sales", "description": "Clustering & future forecast are the essential components in business. Effective implementation of these techniques lead to successful customer relation management (CRM) & inventory management in\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Year", "anchor_text": "Julian calendar", "paragraph_index": 23}], "all_paragraphs": ["Clustering & future forecast are the essential components in business. Effective implementation of these techniques lead to successful customer relation management (CRM) & inventory management in business. Clustering often used as a data mining technique helps in discovering interesting patterns in data.", "Though we are talking about CRM and inventory management, however, clustering has been a major source in advanced planning and optimization process and can benefit business in multiple ways:", "We will explore sales transaction data and will analyze and forecast the transactions based on the historical records. Here, data are on high level and the amount of each transaction and other business factors are not considered.. Data set contains weekly purchased quantities of 800 products over 1 year / 52 weeks.", "We have 800 products in this data set and it is impractical to analyze data of all 800 products. So, let us classify the products into groups based on the similarity of transactions over 52 weeks.", "We will use unsupervised learning for clustering.", "It is an optimization problem. In order to optimize either we need to decide based on minimum distance or determine the number of clusters in terms of constraints. Here, we will work with number of clusters. Because the number of clusters (k) must be set before we start the algorithm, let\u2019s try with several different values of k and examine the differences in the results.", "The standard algorithm which can define the above is \u2014", "where: xi is a data point belonging to the cluster Ck and \u03bck is the mean value of the points assigned to the cluster Ck. Each observation xi is assigned to a given cluster such that the sum of squares distance of the observation to their assigned cluster centers \u03bck is minimized.", "Now, there are quite a few clustering algo available and there is no easy way to find the right algo for our data. We have to experiment and find the best fitted algo for any given dataset.", "Principal component analysis gives us a clear visibility of number of clusters for the products we have. This was important as a first step to our data mining exercise.", "Let\u2019s use factoextra package which can handle the results of PCA, CA, MCA, MFA, FAMD and HMFA from several packages, for extracting and visualizing the most important information contained in our data. More so, it gives a human understandable output.", "This assessment gives us an idea about k=3 or 4 between clusters, however, we are not sure about the optimal clusters. If we know the number of clusters we want, then, probably k-means is a good choice for our use case.", "Besides elbow method, other popular methods for determining the optimal clusters are Silhouette method and Gap statistic", "Here, we have tried to model for every number of clusters from 1 to 10 and collect the WSS values for each model. Look at the plot below. With the increase in clusters, the value of WSS decreases.The elbow point is 3 indicates 3 clusters.", "Here also, the optimal number looks like 3", "Gap statistic standardizes the graph of log(Wk), where Wk is the within-cluster dispersion, by comparing it to its expectation under an appropriate null reference distribution of the data.", "This shows different output as 4 clusters. Let us apply this with 4 clusters as per findings from Gap-Statistic method and plot the pattern of weeks as per clustering from k-means columns.", "What we can interpret here is that, there are 124, 197 and 490 products in each group, respectively. The cluster plot shows that a clearly separated three clusters, and the between_SS / total_SS = 88.6 % suggests this clustering model is a good fit for the data. Specifically, there are 490 products classified into group 1.", "Here, the average weekly transaction is 1.66. There are quite a few products having < 1 weekly transactions (long bar in the histogram). The transactions of other products looks like following a normal distribution. Let\u2019s separate the initial group 1 into two parts:", "The displayed results reveal that, products are clustered into four separately groups.", "We will analyze each group separately which is kind of iterative process.", "According to the histogram, the distribution of the average weekly transactions of Group 0 is right skewed. More over, the box plot shows that the 3rd quartile is around 0.5, which means that the majority products in this group have less than 1 transactions per week. Though there are some products have weekly transactions larger than 1, those are considered as outliers in the box plot considering a very small proportion of all products. Therefore, it can be concluded that, this group have very low demand.", "For further analysis, we would like to select a representative product, whose average weekly transaction is mostly close to a target value (i.e., median or mean). In this case, since the distribution is right skewed, we select the median as our target value. The representative product of this group is the product whose number of transactions is minimally different from the median.", "We have converted the data to timeseries. In the Julian calendar, the average (mean) length of a year is 365.25 days. However, this can be tried with 365 as well. The representative product of Group 0 is P214.", "We can see that, most of time P214 has zero transactions, some 1 transaction, and one 4 transactions per week.", "Here, the distribution is almost centered around 4. The distribution is a little bit right skewed in the Box plot, with one outlier. The Q3 percentile > 4 (4.23), most of the products in Group1 is < 4. Therefore, it can be safely assumed that, the products in this group have low demands too.", "The representative product of Group1 is P318.", "The distribution is a little bit right skewed. The average number of weekly transaction is 3.67.", "According to the time plot, the majority of the number of transactions is between 2 and 5 per week. It is clear that there is no trend or seasonality in this time series. Moreover, the auto correlation plot displays white noise in the data. In this way, there is no need to perform decomposition for this time series prior building a forecasting model.", "We will apply (1) ETS(Exponential Smoothing) and (2) ARIMA (Autoregressive Integrated Moving Average ). Moreover, other forecasting methods e.g. average, drift, and na\u00efve will be applied based on the characteristic of the data. With only 52 weeks of transaction data, it is difficult to make long-term forecasting.", "Prediction produced using exponential smoothing methods are weighted averages of past observations, with the weights decaying exponentially as the observations get older.", "Ljung-Box statistic p\u2010value > the significance level (\\alpha) leads us to not\u2010to\u2010reject the null hypothesis or, in other words, the time series is white test. Below plot shows point forecasts and prediction intervals generated from the model.", "The residual plot displays that the residuals have constant variance and zero mean, and there is no significant autocorrelation with each other. Though this indicates the model is a good fit; moreover, the p-value of Ljung-Box test also indicates independence of residuals. However, the forecasting results displaying the prediction interval is excessively wide, with negative values. So, ETS model is not a good choice for this time series.", "The ETS(A,N,N) is the simple exponential smoothing with additive errors. This is expected, because the original time series is a white noise, without trend and seasonality.", "This time series of P318 is a white noise, which is a stationary data. Here, both ACF and PACF plots have same observation of stationarity.", "In terms of model performance, ARIMA may be better, however, forecasting output are quite similar to ETS Compared to ETS model, with an unacceptably wide prediction interval.", "In general, none of these methods fit the data better than either ARIMA or ETS method. Specifically, the forecast using Average Method has very similar results. However, the prediction intervals of Naive method and drift method are even wider. Therefore, these methods are not good options.", "Since the original data of P318 is a white noise, it is very difficult to make a good prediction for this time series. We notice that the forecasting results of both ARIMA and ETS models are equal to the mean of P318 (3.673/3.68).", "However, because of the wide prediction interval, it will put business into risk if we only use the forecasting results directly. Thus, instead of using the mean value, it will be advisable to use the 3rd quartile value, 5 transactions per week and that way, we may cover 75% of business needs.", "According to the histogram, the distribution of weekly transactions is right skewed. In the box plot, the distribution is right skewed, with some outliers. In addition, the 25th percentile is 32.17, which means most of the products in Group3 have weekly transactions larger than 32. Therefore, we can conclude that the products in Group3 have high demands. Here too, the distribution is centered, so, we select the mean as target value.", "The data distribution is almost centered. The average number of weekly transaction is 9.9, and the third quartile is 12.", "According to the time plot, the majority of the number of transactions is between 6 and 13 per week.", "The original time series consists of a trend component and an irregular component, but no seasonal component. Therefore, it is appropriate to use the simple moving average method for smoothing.", "With an order of 5, the estimated trend is not smoothing as expected. Thus, moving average of the moving average is performed. The \u201c3x5-MA\u201d trend is a better fit. We will repeat the similar process of applying ETS(Exponential Smoothing) and ARIMA(Autoregressive Integrated Moving Average ) and also will investigate other forecasting methods, such as average, drift, and na\u00efve, etc.", "Similar exercise like group0 and group1 can be performed here to find the best fitted model.", "Clustering is important in the retail business decision-making process. It is a part of effective data mining technique and when dealing with big data, there effective data mining is critical. Data mining covers a wide spectrum of data analysis and knowledge discovery tasks, from data characterization and discrimination to association and correlation analysis, classification, regression, clustering, outlier analysis, sequence analysis, and trend and evolution analysis.", "However, we have to remember that, real-life data are messy and likely to contain noise, errors, exceptions, or uncertainty. Errors and noise may confuse the data mining process, leading to the derivation of erroneous patterns. Data cleaning, data preprocessing, outlier detection and removal, and uncertainty reasoning are examples of techniques that need to be integrated with the data mining process to make any efficient segmentation & prediction.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Analytics & Data Science Practice Lead"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F330a7a205102&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----330a7a205102--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----330a7a205102--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----330a7a205102--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=post_page-----330a7a205102--------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8----330a7a205102---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F330a7a205102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F330a7a205102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://sarit-maitra.medium.com/membership", "anchor_text": "https://sarit-maitra.medium.com/membership"}, {"url": "https://en.wikipedia.org/wiki/Year", "anchor_text": "Julian calendar"}, {"url": "https://www.linkedin.com/in/saritmaitra/", "anchor_text": "here"}, {"url": "https://medium.com/tag/clustering?source=post_page-----330a7a205102---------------clustering-----------------", "anchor_text": "Clustering"}, {"url": "https://medium.com/tag/forecasting?source=post_page-----330a7a205102---------------forecasting-----------------", "anchor_text": "Forecasting"}, {"url": "https://medium.com/tag/statistical-analysis?source=post_page-----330a7a205102---------------statistical_analysis-----------------", "anchor_text": "Statistical Analysis"}, {"url": "https://medium.com/tag/advance-planning?source=post_page-----330a7a205102---------------advance_planning-----------------", "anchor_text": "Advance Planning"}, {"url": "https://medium.com/tag/unsupervised-learning?source=post_page-----330a7a205102---------------unsupervised_learning-----------------", "anchor_text": "Unsupervised Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F330a7a205102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&user=Sarit+Maitra&userId=c611876588a8&source=-----330a7a205102---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F330a7a205102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&user=Sarit+Maitra&userId=c611876588a8&source=-----330a7a205102---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F330a7a205102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----330a7a205102--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F330a7a205102&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----330a7a205102---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----330a7a205102--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----330a7a205102--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----330a7a205102--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----330a7a205102--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----330a7a205102--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----330a7a205102--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----330a7a205102--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----330a7a205102--------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sarit-maitra.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sarit Maitra"}, {"url": "https://sarit-maitra.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc611876588a8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&user=Sarit+Maitra&userId=c611876588a8&source=post_page-c611876588a8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fba440ad8d04d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fclustering-machine-learning-combination-in-sales-prediction-330a7a205102&newsletterV3=c611876588a8&newsletterV3Id=ba440ad8d04d&user=Sarit+Maitra&userId=c611876588a8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}