{"url": "https://towardsdatascience.com/split-overlapping-bounding-boxes-in-python-e67dc822a285", "time": 1683009044.508002, "path": "towardsdatascience.com/split-overlapping-bounding-boxes-in-python-e67dc822a285/", "webpage": {"metadata": {"title": "Split overlapping bounding boxes in Python | by Miguel Pinto | Towards Data Science", "h1": "Split overlapping bounding boxes in Python", "description": "In object detection, it is usual to have bounding box targets to identify objects in images. These bounding boxes may sometimes overlap. In some models like Mask RCNN the bounding boxes are predicted\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/global-wheat-detection", "anchor_text": "Global Wheat Detection Kaggle competition", "paragraph_index": 1}, {"url": "https://shapely.readthedocs.io/en/latest/", "anchor_text": "shapely Polygons", "paragraph_index": 9}, {"url": "https://github.com/fastai/nbdev", "anchor_text": "fastai nbdev", "paragraph_index": 12}, {"url": "https://pypi.org/project/splitbbox/", "anchor_text": "t https://pypi.org/project/splitbbox", "paragraph_index": 13}], "all_paragraphs": ["In object detection, it is usual to have bounding box targets to identify objects in images. These bounding boxes may sometimes overlap. In some models like Mask RCNN the bounding boxes are predicted directly and the overlap of the bounding boxes in not a problem. Another possible approach is to convert the bounding boxes to masks and use a semantic segmentation model like U-Net. It that case, overlapping masks may be a problem if at the end you want to separate the individual objects.", "In this story, I cover how to develop an algorithm in Python to separate overlapping bounding boxes and setting a margin between them. I will be using data from the Global Wheat Detection Kaggle competition.", "Note that I\u2019m not arguing that this method is the best for the Wheat Detection competition. In the future, I may write another story covering such topic.", "Let\u2019s start by considering the case for two overlapping bounding boxes. We want to separate the bounding boxes leaving some margin in between them as suggested in the image below.", "To define the margin the procedure will be the following:", "Later in section 4, I will show that the code can be easily applied for the case of multiple intersecting bounding boxes.", "Consider the image and equations bellow where the bold notation denotes vectors. The vector AB is simply the vector that goes from A to B defined in the first equation. Then we can consider a vector perpendicular to AB \u2014 that I call ABp \u2014 using the second equation. Finally, the point M on the margin line for box A can be defined by the third equation.", "The rationale is that: 1) you start in A; 2) you move in the direction of AB but only halfway to reach the median point; 3) you move slightly backwards in the same direction by a factor m multiplied by the unit vector in the direction of AB; 4) the point you reach is what I define as point M.", "Using the point M and the vector ABp it is straight forward to define the margin line as I will show in the next section.", "The function below receives two bounding boxes and returns the sliced region for the box A. The input boxes are shapely Polygons as well as the output returned by the function. Let\u2019s now dive into the code line by line.", "The code defined in section 3 only applies to two bounding boxes. In order to apply it for several bounding boxes, I defined the following code that I will now explain briefly.", "The result of slice_all is a similar GeoDataFrame but with the sliced boxes. The image below shows the original bounding boxes (left) and the result of slice_all (right). As you can see there are several overlapping regions in the original data but none after applying the methodology just developed.", "fastai nbdev is arguably the easiest and most user-friendly way to create a Python package and upload it to PyPI.", "And that\u2019s it! My package is now on PyPI at https://pypi.org/project/splitbbox and can be pip installed.", "Thanks for reading! Have a great day!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "PhD student (Remote sensing, Meteorology), ML/DL enthusiast, fastai student, competition master at Kaggle, pianist/composer"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe67dc822a285&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----e67dc822a285--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e67dc822a285--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@mnpinto?source=post_page-----e67dc822a285--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=post_page-----e67dc822a285--------------------------------", "anchor_text": "Miguel Pinto"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbfc658aeefbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&user=Miguel+Pinto&userId=bfc658aeefbc&source=post_page-bfc658aeefbc----e67dc822a285---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe67dc822a285&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe67dc822a285&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/global-wheat-detection", "anchor_text": "Global Wheat Detection Kaggle competition"}, {"url": "https://www.kaggle.com/c/global-wheat-detection", "anchor_text": "Global Wheat Detection Kaggle competition"}, {"url": "https://github.com/fastai/nbdev", "anchor_text": "fastai nbdev"}, {"url": "https://shapely.readthedocs.io/en/latest/", "anchor_text": "shapely Polygons"}, {"url": "https://shapely.readthedocs.io/en/latest/", "anchor_text": "shapely Polygon"}, {"url": "https://geopandas.org/reference/geopandas.GeoDataFrame.html", "anchor_text": "GeoDataFrame"}, {"url": "https://github.com/fastai/nbdev", "anchor_text": "fastai nbdev"}, {"url": "https://github.com/fastai/nbdev", "anchor_text": "nbdev"}, {"url": "https://nbdev.fast.ai/", "anchor_text": "nbdev in their documentation"}, {"url": "https://pypi.org/", "anchor_text": "PyPI"}, {"url": "https://github.com/fastai/nbdev#adding-your-project-to-pypi", "anchor_text": "nbdev page here"}, {"url": "https://pypi.org/project/splitbbox/", "anchor_text": "t https://pypi.org/project/splitbbox"}, {"url": "https://www.kaggle.com/mnpinto/boudingbox2mask-without-overlap", "anchor_text": "this Kaggle kernel"}, {"url": "https://github.com/mnpinto/splitbbox/blob/master/00_core.ipynb", "anchor_text": "GitHub repository"}, {"url": "https://github.com/fastai/fastai2", "anchor_text": "fastai2"}, {"url": "https://www.kaggle.com/c/global-wheat-detection", "anchor_text": "Global Wheat Detection Kaggle competition"}, {"url": "https://towardsdatascience.com/my-3-year-journey-from-zero-python-to-deep-learning-competition-master-6605c188eec7", "anchor_text": "My 3-year journey: From zero Python to Deep Learning competition masterThe path I followed since starting to learn Python back in 2017 up to became a Kaggle competition master with a solo\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----e67dc822a285---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/software-development?source=post_page-----e67dc822a285---------------software_development-----------------", "anchor_text": "Software Development"}, {"url": "https://medium.com/tag/python?source=post_page-----e67dc822a285---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----e67dc822a285---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/programming?source=post_page-----e67dc822a285---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe67dc822a285&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&user=Miguel+Pinto&userId=bfc658aeefbc&source=-----e67dc822a285---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fe67dc822a285&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&user=Miguel+Pinto&userId=bfc658aeefbc&source=-----e67dc822a285---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fe67dc822a285&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----e67dc822a285--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fe67dc822a285&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----e67dc822a285---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----e67dc822a285--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----e67dc822a285--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----e67dc822a285--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----e67dc822a285--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e67dc822a285--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e67dc822a285--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----e67dc822a285--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----e67dc822a285--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@mnpinto?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Miguel Pinto"}, {"url": "https://medium.com/@mnpinto/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "648 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbfc658aeefbc&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&user=Miguel+Pinto&userId=bfc658aeefbc&source=post_page-bfc658aeefbc--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3388b854b03d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsplit-overlapping-bounding-boxes-in-python-e67dc822a285&newsletterV3=bfc658aeefbc&newsletterV3Id=3388b854b03d&user=Miguel+Pinto&userId=bfc658aeefbc&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}