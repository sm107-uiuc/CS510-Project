{"url": "https://towardsdatascience.com/input-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9", "time": 1683012822.1002398, "path": "towardsdatascience.com/input-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9/", "webpage": {"metadata": {"title": "Input Pipeline for Images using Keras and TensorFlow | by Renu Khandelwal | Towards Data Science", "h1": "Input Pipeline for Images using Keras and TensorFlow", "description": "Second, in the series to learn how to create an input pipeline to load and create image train and test dataset from custom data using Kera Preprocessing, Tensorflow, and tf.data. The dataset used\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/loading-custom-image-dataset-for-deep-learning-models-part-1-d64fa7aaeca6", "anchor_text": "learn how to create an input pipeline to load and create image train and test dataset from custom data", "paragraph_index": 0}, {"url": "https://www.kaggle.com/puneet6060/intel-image-classification/version/2", "anchor_text": "Intel Image Classification", "paragraph_index": 1}], "all_paragraphs": ["Second, in the series to learn how to create an input pipeline to load and create image train and test dataset from custom data using Kera Preprocessing, Tensorflow, and tf.data.", "The dataset used here is Intel Image Classification from Kaggle, and all the code in the article works in Tensorflow 2.0.", "Intel Image classification dataset is split into Train, Test, and Val. We will only use the training dataset to learn how to load the dataset using different libraries.", "The ImageDataGenerator class generates batches of tensors for the image data and scale down the pixel values from 0 to 255 to a value between 0 and 1.", "We can apply different real-time data augmentation to the train image dataset like rotating the image, zooming the image, horizontal flip or vertical flip, etc. Data augmentation is not applied to the validation or test dataset.", "Once the instance of ImageDatagenerator is created, use the flow_from_directory() to read the image files from the directory.", "flow_from_directory() expects the image data in a specific structure as shown below where each class has a folder, and images for that class are contained within the class folder.", "class_indices.keys() will extract the class names from the dataset in a dictionary", "Creating a simple Deep Learning model, compiling it, and training the model using the dataset generated using Keras preprocessing", "Input pipeline using Tensorflow will create tensors as an input to the model.", "Converting text labels to numeric codes", "Create a dictionary for all unique values for the classes", "Convert the class_names to their respective numeric value based on the dictionary", "Creating a simple Deep Learning model, compiling it, and training the model.", "It is the same model that we created earlier when suing Keras.preprocessing(). The only change here is the input image data and class names, which are a list of Tensors values to fit the model.", "tf.data API allows us to build complex input pipelines while reading large amounts of data available in different formats and then apply transformations.", "In tf.data for image processing pipeline, an element is a single training example, having a pair of tensors to represent the image and its corresponding label.", "Importing libraries and setting basic parameters", "tf.data.Dataset.list_files() creates a dataset from a directory list of files using a matching pattern.", "Creating class labels from the directory name", "Splitting the dataset into train, and Val.", "The validation dataset is 20% of the total dataset, and train dataset is 80% of the entire dataset.", "Creating input pipeline components for a single training/validation example representing a pair of tensors to represent the image and its corresponding label.", "Set the AUTOTUNE; this will help to delegate the decision on the level of parallelism to use to the tf.data at runtime to optimize the CPU/GPU utilization.", "To configure the data source for performance, use prefetching.", "Prefetching in tf.data allows the preprocessing of the data and model execution of a training step to overlap.", "While the model is executing a training step 100, the input pipeline is reading the data for step 101.", "Creating a simple Deep Learning model", "The input to the model is tf.data.Dataset", "The best training time I got was using tf.data as there is prefetching, which is using AUTOTUNE to delegate the decision on the level of parallelism.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "A Technology Enthusiast who constantly seeks out new challenges by exploring cutting-edge technologies to make the world a better place!"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc5e107b6d7b9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://arshren.medium.com/?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35----c5e107b6d7b9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc5e107b6d7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc5e107b6d7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/loading-custom-image-dataset-for-deep-learning-models-part-1-d64fa7aaeca6", "anchor_text": "learn how to create an input pipeline to load and create image train and test dataset from custom data"}, {"url": "https://unsplash.com/@mbenna?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Mike Benna"}, {"url": "https://unsplash.com/s/photos/image-pipeline?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.kaggle.com/puneet6060/intel-image-classification/version/2", "anchor_text": "Intel Image Classification"}, {"url": "https://keras.io/api/preprocessing/image/", "anchor_text": "Keras documentation: Image data preprocessingGenerates a tf.data.Dataset from image files in a directory. If your directory structure is: Then calling\u2026keras.io"}, {"url": "https://www.tensorflow.org/tutorials/load_data/images#using_tfdata_for_finer_control", "anchor_text": "https://www.tensorflow.org/tutorials/load_data/images#using_tfdata_for_finer_control"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----c5e107b6d7b9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/tensorflow?source=post_page-----c5e107b6d7b9---------------tensorflow-----------------", "anchor_text": "TensorFlow"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----c5e107b6d7b9---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/keras?source=post_page-----c5e107b6d7b9---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c5e107b6d7b9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc5e107b6d7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&user=Renu+Khandelwal&userId=31b07253bc35&source=-----c5e107b6d7b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc5e107b6d7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&user=Renu+Khandelwal&userId=31b07253bc35&source=-----c5e107b6d7b9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc5e107b6d7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc5e107b6d7b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c5e107b6d7b9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c5e107b6d7b9--------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://arshren.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Renu Khandelwal"}, {"url": "https://arshren.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.9K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F31b07253bc35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&user=Renu+Khandelwal&userId=31b07253bc35&source=post_page-31b07253bc35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb1cb44d62203&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Finput-pipeline-for-images-using-keras-and-tensorflow-c5e107b6d7b9&newsletterV3=31b07253bc35&newsletterV3Id=b1cb44d62203&user=Renu+Khandelwal&userId=31b07253bc35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}