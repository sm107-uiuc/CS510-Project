{"url": "https://towardsdatascience.com/visualizing-the-stock-market-with-tableau-c0a7288e7b4d", "time": 1682997204.020262, "path": "towardsdatascience.com/visualizing-the-stock-market-with-tableau-c0a7288e7b4d/", "webpage": {"metadata": {"title": "Visualizing the Stock Market with Tableau | by Tony Yiu | Towards Data Science", "h1": "Visualizing the Stock Market with Tableau", "description": "Tableau is a critical data visualization tool that belongs in every data analyst\u2019s and data scientist\u2019s toolkit. Today we play around with stock market data in order to explore how Tableau can help\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.quandl.com/", "anchor_text": "Quandl", "paragraph_index": 1}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "Pandas merge method", "paragraph_index": 6}, {"url": "https://public.tableau.com/en-us/s/", "anchor_text": "Tableau Public, which is free", "paragraph_index": 6}, {"url": "https://en.wikipedia.org/wiki/Treemapping", "anchor_text": "treemap", "paragraph_index": 9}, {"url": "https://towardsdatascience.com/turning-lending-clubs-worst-loans-into-investment-gold-475ec97f58ee", "anchor_text": "A Data Science Project I Did on Investing in Lending Club Loans", "paragraph_index": 31}, {"url": "https://tonester524.medium.com/membership", "anchor_text": "https://tonester524.medium.com/membership", "paragraph_index": 34}], "all_paragraphs": ["Tableau is a critical data visualization tool that belongs in every data analyst\u2019s and data scientist\u2019s toolkit. Today we play around with stock market data in order to explore how Tableau can help us dissect and better understand our data.", "We can grab stock market data from Quandl. We\u2019re going to focus on the S&P 500, a market cap weighted index of large cap American stocks (basically, the biggest American companies).", "Here is the Python code for grabbing the data (note that you will need your own Quandl API key and that the Sharadar data requires a paid subscription). I\u2019ve also added comments in the code below, but the following snippet uses Quandl\u2019s API to grab financial data for all publicly listed companies in Sharadar\u2019s database (financial data is stuff like revenues, net income, debt, return on invested capital, and so on). This financial data is stored in the dataframe stock_df.", "However, we don\u2019t need data on every company \u2014 we just want the S&P 500. To get the S&P 500 tickers, we turn to web scraping and Wikipedia. The following lines of code web scrape a Wikipedia table that lists the tickers and industries of every company that is currently in the S&P 500 and stores it in the variable called page_content.", "Next we use some parsing code to grab ticker and industry from page_content, which is a BeautifulSoup data structure. The code can be summarized as doing the following:", "Finally, we need to do a bit of data manipulation to join up our ticker and industry data (from Wikipedia) with our financial data (from Quandl). The first two blocks of code (as detailed in the comments) store the tickers that we want into a dataframe called sp_df.", "The last block of code uses the Pandas merge method to join sp_df, which contains our ticker and industry data, with stock_df, which contains our financial data. We store the resulting dataframe, merged_df, in a .csv file that we can now load into Tableau (I use Tableau Public, which is free). Hurray done!", "Data visualization sounds fun and easy but it\u2019s not. A lot of thought goes into all those cool dashboards and interactive charts that we see. While I am no expert, before I start slapping numbers onto graphs, I first try to answer the following questions:", "Let\u2019s try to answer these questions now:", "Let\u2019s start off by looking at a Tableau treemap of the S&P 500. The S&P 500 is a cap weighted index \u2014 that means each company\u2019s representation in the index is proportional to its market cap (market cap is the sum value of all the company\u2019s shares, in other words what it would cost to buy the entire firm). In the following treemap, the size and color of each rectangle corresponds to that company\u2019s representation in the S&P 500.", "There are some familiar faces at the top \u2014 Apple, Microsoft, Amazon, Google, Berkshire Hathaway make up the top 5. Interestingly, these top 5 companies make up 17% of the S&P 500\u2019s market cap and the top 15 companies make up 30% of the total market cap. Note that market cap alone is not enough to explain what drives the S&P 500\u2019s price changes \u2014 the volatility of a company\u2019s share price matters too. For example, even though Facebook (FB) has a lower market cap than Microsoft (MSFT), Facebook\u2019s share price has been more volatile in the past 12 months as it has attempted to navigate a slew of scandals. Thus, over the last year, Facebook\u2019s stock has most likely been a greater driver of the S&P 500 than Microsoft\u2019s has.", "Owning a share of a company is equivalent to owning a portion (however small) of that same company. For example, if we were fabulously rich and bought shares in Google equivalent to 1% of the firm, then as minority owners, we would be entitled to 1% of the profits. Of course, as minority owners, we are also forced to entrust the management and investment of these profits to Google\u2019s upper management and board (which is why we don\u2019t get a profit sharing check from Google every quarter even if we own the shares).", "So if a firm\u2019s profits (a.k.a. net income) are what we ultimately hope to gain when we buy its shares, perhaps we should redo our treemap in terms of profits. In the following treemap, the size and color of each rectangle corresponds to the magnitude of that company\u2019s profits (a.k.a. net income).", "While Apple and Google are still in the top 5, we now have some new faces \u2014 J.P. Morgan (JPM), Bank of America (BAC), and Wells Fargo (WFC). Despite all the hype over how tech is upending traditional industries, the banking industry (as traditional an industry as there is) continues to earn massive profits. Intel (INTC) the forgotten tech titan, Exxon Mobil (XOM) the oil giant, and AT&T (T) the telecommunications conglomerate also still earn tons of money despite being somewhat forgotten in today\u2019s innovation obsessed market.", "Personally I believe the best long term investment strategy is to \u201cbuy low and sell high\u201d (easier said than done). But how do we do that? At its most basic level, for each dollar that we pay, we should be trying to purchase as many dollars in profits as possible. The previous visualization showed us that unloved industries may sometimes harbor under-appreciated sources of profit. Let\u2019s shift to looking at industries instead of companies to see whether we can find some good profit ponds to fish in.", "The treemap below breaks down each industry in terms of median market cap (the area of each rectangle) and median profits (the color of each rectangle). We use medians because we want to know that if I were to pick a company at random from a particular industry bucket, how much is it likely to cost (market cap) and how profitable is it likely to be (net income).", "Before we discuss results, we should first understand the proper way to think about this treemap. We are using it to eyeball the relationship between median market cap (the price we pay) and median net income (the profits we get). If the price of a sector were perfectly correlated with the profits of the firms inside it, then we would expect the biggest rectangles to be the most green and for the color to transition to red as the rectangles decrease in size. We obviously don\u2019t see that here, so it looks like there are potential opportunities.", "The treemap highlights Financials (banks, insurance companies, etc.) and Communication Services (Google, Facebook, AT&T, Disney, etc.) as potentially attractive sectors in which to search for cheap stocks \u2014 because they are middle of the pack in terms of rectangle size (median market cap) but very green (high median profits).", "Meanwhile, Real Estate, in deep red, seems like a definite no go. Healthcare also seems like a sector to avoid as it owns both the highest median market cap along with near \u201cbottom of the pack\u201d median profits (bad bang for our buck).", "Of course, these are just quick rules of thumb for identifying potential investments \u2014 much more due diligence should be done before an actual investment is made.", "Surprisingly the Information Technology sector, which contains heavy hitters like Apple and Microsoft, does not come off looking great in our previous analysis \u2014 it is expensive in terms of price but \u201cback of the pack\u201d in terms of median profits. What gives?", "There are two factors at play:", "Let\u2019s use a Tableau scatter plot to check out the relationship between P/E ratios and ROIC:", "Check out our scatter plot to the left. It shows that there is a positive correlation between a stock\u2019s P/E ratio (how expensive it is) and its ROIC. This makes sense \u2014 investors like high ROIC companies because they generally require little upfront investment to generate significant profits (companies that require large upfront investments are viewed as risky because we might never get paid back).", "And the Information Technology sector has by far the highest median ROIC. This also makes sense as this sector is filled with software firms, which as we previously observed are very capital light. So it\u2019s not high current profits that attract investors to Information Technology (and drive its high P/E ratio and market capitalizations) but rather the capital light nature of the business and the hope that relatively small investments today will yield high growth and profits tomorrow (everyone loves a business model that is easy and cheap to scale).", "Will that happen? I have no idea but the market is currently making a big bet that it will \u2014 so if you are looking for good odds, you may want to look elsewhere.", "Finally, note that the Financials sector has the lowest ROIC. This plus the perceived riskiness of banks (2008 anyone?) probably drives their low valuation. But banks use capital differently \u2014 instead of borrowing money to build a factory, banks borrow money from folks like you and me in order to lend it back out at higher rates.", "Usually high invested capital implies that high fixed, upfront costs are needed to operate the business. This is not the case for banks \u2014 despite having extremely high levels of invested capital (due to high debt), banks have very little in the ways of fixed costs. This high debt does make them riskier and perhaps deserving of a P/E ratio discount, but we should not rule banks out as investments just because of their low ROICs \u2014 instead, we should seek to understand what drives these low ROICs and whether it is a real concern or not.", "Nice, we made it to the end! Honestly, there is still so much more we can explore. The stock market and corporate strategy are two incredibly deep and rich subjects; and the question of \u201cwhat stocks to buy\u201d is an immensely tricky one. We have only begun to scratch the surface in this post.", "However, I hope that I\u2019ve demonstrated how visualizations can help us digest complex datasets and begin to tackle challenging problems.", "More by me on Finance and Investing:", "A Data Science Project I Did on Investing in Lending Club Loans", "More by me on Data Science:", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist. Founder Alpha Beta Blog. Doing my best to explain the complex in plain English. Support my writing: https://tonester524.medium.com/membership"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc0a7288e7b4d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://tonester524.medium.com/?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": "Tony Yiu"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F840a3210fbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&user=Tony+Yiu&userId=840a3210fbe7&source=post_page-840a3210fbe7----c0a7288e7b4d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0a7288e7b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0a7288e7b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@freegraphictoday?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "AbsolutVision"}, {"url": "https://unsplash.com/search/photos/stock-market?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://www.quandl.com/", "anchor_text": "Quandl"}, {"url": "https://en.wikipedia.org/wiki/List_of_S%26P_500_companies'", "anchor_text": "https://en.wikipedia.org/wiki/List_of_S%26P_500_companies'"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html", "anchor_text": "Pandas merge method"}, {"url": "https://public.tableau.com/en-us/s/", "anchor_text": "Tableau Public, which is free"}, {"url": "https://en.wikipedia.org/wiki/Treemapping", "anchor_text": "treemap"}, {"url": "https://towardsdatascience.com/the-xiv-meltdown-1b0608110b9f", "anchor_text": "The Dangers of Shorting Volatility"}, {"url": "https://towardsdatascience.com/turning-lending-clubs-worst-loans-into-investment-gold-475ec97f58ee", "anchor_text": "A Data Science Project I Did on Investing in Lending Club Loans"}, {"url": "https://towardsdatascience.com/the-anatomy-of-a-stock-market-downturn-6527e31406f0", "anchor_text": "On Stock Market Downturns"}, {"url": "https://towardsdatascience.com/understanding-random-forest-58381e0602d2", "anchor_text": "The Random Forest Classifier"}, {"url": "https://towardsdatascience.com/understanding-neural-networks-19020b758230", "anchor_text": "How Neural Networks Work"}, {"url": "https://towardsdatascience.com/understanding-pca-fae3e243731d", "anchor_text": "Principal Components Analysis"}, {"url": "https://medium.com/tag/investing?source=post_page-----c0a7288e7b4d---------------investing-----------------", "anchor_text": "Investing"}, {"url": "https://medium.com/tag/finance?source=post_page-----c0a7288e7b4d---------------finance-----------------", "anchor_text": "Finance"}, {"url": "https://medium.com/tag/business?source=post_page-----c0a7288e7b4d---------------business-----------------", "anchor_text": "Business"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c0a7288e7b4d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/money?source=post_page-----c0a7288e7b4d---------------money-----------------", "anchor_text": "Money"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc0a7288e7b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&user=Tony+Yiu&userId=840a3210fbe7&source=-----c0a7288e7b4d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc0a7288e7b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&user=Tony+Yiu&userId=840a3210fbe7&source=-----c0a7288e7b4d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc0a7288e7b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc0a7288e7b4d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c0a7288e7b4d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c0a7288e7b4d--------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://tonester524.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tony Yiu"}, {"url": "https://tonester524.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "102K Followers"}, {"url": "https://tonester524.medium.com/membership", "anchor_text": "https://tonester524.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F840a3210fbe7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&user=Tony+Yiu&userId=840a3210fbe7&source=post_page-840a3210fbe7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F78d3e392d884&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fvisualizing-the-stock-market-with-tableau-c0a7288e7b4d&newsletterV3=840a3210fbe7&newsletterV3Id=78d3e392d884&user=Tony+Yiu&userId=840a3210fbe7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}