{"url": "https://towardsdatascience.com/pandas-pivot-the-ultimate-guide-5c693e0771f3", "time": 1683005861.8566458, "path": "towardsdatascience.com/pandas-pivot-the-ultimate-guide-5c693e0771f3/", "webpage": {"metadata": {"title": "Pandas Pivot \u2014 The Ultimate Guide | by Roman Orac | Towards Data Science", "h1": "Pandas Pivot \u2014 The Ultimate Guide", "description": "Pandas pivot is an essential tool of every Data Scientist. Some use it daily and others avoid it because it seems complex. I was in the latter group for quite a while. After I took the time and did\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/pandas-dev/pandas/blob/master/pandas/core/reshape/pivot.py#L427", "anchor_text": "pandas source code for pivot function", "paragraph_index": 10}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter", "paragraph_index": 20}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet", "paragraph_index": 20}], "all_paragraphs": ["Pandas pivot is an essential tool of every Data Scientist. Some use it daily and others avoid it because it seems complex. I was in the latter group for quite a while. After I took the time and did some research, I felt like I wasted a lot of time writing unnecessary code. To my surprise, I already knew the main building blocks of pandas. It is all simpler than it may seem.", "Here are few links that might interest you:", "Would you like to read more such articles? If so, you can support me by clicking on any links above. Some of them are affiliate links, but you don\u2019t need to buy anything.", "A pivot table is a table of statistics that summarizes the data of a more extensive table. In practical terms, a pivot table calculates a statistic on a breakdown of values. For the first column, it displays values as rows and for the second column as columns.", "Let\u2019s look at the example of a pivot table that calculates sum statistic on a breakdown by fruits and customers:", "Pandas has a pivot_table function that applies a pivot on a DataFrame. It also supports aggfunc that defines the statistic to calculate when pivoting (aggfunc is np.mean by default, which calculates the average). I use the sum in the example below.", "Let\u2019s define a DataFrame and apply the pivot_table function.", "I would like to have a breakdown with fruits in rows (specify index) and customers in columns (specify columns). For each entry, I would like to calculate the summation of quantities. The result is the same as in the table above.", "The most likely reason is that you\u2019ve used the pivot function instead of pivot_table. This confused me many times. Pandas pivot function is a less powerful function that does pivot without aggregation that can handle non-numeric data.", "The error \u201cThe ValueError: Index contains duplicate entries, cannot reshape\u201d occurred because there are duplicates entries in your DataFrame. If I would pivot the DataFrame above, I would get the same error as apple and ben are duplicated and pivot function doesn\u2019t aggregate.", "It helped me to understand this problem when I went through pandas source code for pivot function. Basically it does the same as the command below:", "At first, pivoting may seem to you like a hard-to-understand concept. But what if I told you that you were using it all along \u2014 at least the commands that are at the core of pivoting in pandas. Let\u2019s look at the command below:", "Have you ever used groupby function in pandas? What about the sum command? Yes? I thought so. The output of the above command is the same as of pivot_table.", "I haven\u2019t use unstack many times but it basically unpacks multi-index to columns like in the image below", "Say no more! pivot_table has a fill_value argument to replace missing values with. It is None by default. Let\u2019s try it.", "The argument aggfunc of pivot_table function takes a list of functions. Let\u2019s try it with sum and mean.", "You can! Similar to aggfunc argument, values argument takes a list of column names. Let\u2019s add a price column to the DataFrame.", "Now that we have two columns with values, let\u2019s apply pivot_table function:", "The answer is yes yet again. Arguments index and column both take lists. Let\u2019s add column origin of fruit to the DataFrame.", "Now, let\u2019s do a breakdown of fruit and origin by rows and customers by column.", "Follow me on Twitter, where I regularly tweet about Data Science and Machine Learning.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5c693e0771f3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://romanorac.medium.com/?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd----5c693e0771f3---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c693e0771f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c693e0771f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@christianfregnan?utm_source=medium&utm_medium=referral", "anchor_text": "Christian Fregnan"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://trymito.io/", "anchor_text": "Complete your Python analyses 10x faster with Mito"}, {"url": "https://aigents.co/skills", "anchor_text": "Free skill tests for Data Scientists & ML Engineers"}, {"url": "https://imp.i115008.net/c/2402645/1116216/11298", "anchor_text": "All New Self-Driving Car Engineer Nanodegree"}, {"url": "https://giphy.com/gifs/in-name-last-h4Z6RfuQycdiM", "anchor_text": "giphy"}, {"url": "https://github.com/pandas-dev/pandas/blob/master/pandas/core/reshape/pivot.py#L427", "anchor_text": "pandas source code for pivot function"}, {"url": "https://giphy.com/gifs/gets-smart-question-vQqeT3AYg8S5O", "anchor_text": "giphy"}, {"url": "https://giphy.com/gifs/doctor-who-guitar-peter-capaldi-wCiFka9RsSW9W", "anchor_text": "giphy"}, {"url": "https://twitter.com/romanorac", "anchor_text": "Twitter"}, {"url": "https://twitter.com/romanorac/status/1328952374447267843", "anchor_text": "tweet"}, {"url": "https://unsplash.com/@cmhedger?utm_source=medium&utm_medium=referral", "anchor_text": "Courtney Hedger"}, {"url": "https://unsplash.com/?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://medium.com/tag/python?source=post_page-----5c693e0771f3---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----5c693e0771f3---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/analytics?source=post_page-----5c693e0771f3---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/tag/programming?source=post_page-----5c693e0771f3---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/pandas?source=post_page-----5c693e0771f3---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c693e0771f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&user=Roman+Orac&userId=68bf0657a0cd&source=-----5c693e0771f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F5c693e0771f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&user=Roman+Orac&userId=68bf0657a0cd&source=-----5c693e0771f3---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5c693e0771f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F5c693e0771f3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----5c693e0771f3---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----5c693e0771f3--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5c693e0771f3--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----5c693e0771f3--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----5c693e0771f3--------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://romanorac.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roman Orac"}, {"url": "https://romanorac.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "7.7K Followers"}, {"url": "https://romanorac.medium.com/membership", "anchor_text": "https://romanorac.medium.com/membership"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F68bf0657a0cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&user=Roman+Orac&userId=68bf0657a0cd&source=post_page-68bf0657a0cd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa69c18dd3c04&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fpandas-pivot-the-ultimate-guide-5c693e0771f3&newsletterV3=68bf0657a0cd&newsletterV3Id=a69c18dd3c04&user=Roman+Orac&userId=68bf0657a0cd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}