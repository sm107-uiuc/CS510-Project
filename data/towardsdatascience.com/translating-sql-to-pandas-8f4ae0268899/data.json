{"url": "https://towardsdatascience.com/translating-sql-to-pandas-8f4ae0268899", "time": 1682993999.2143948, "path": "towardsdatascience.com/translating-sql-to-pandas-8f4ae0268899/", "webpage": {"metadata": {"title": "Translating SQL to pandas. Both do similar or the same things, but\u2026 | by Sergi Lehkyi | Towards Data Science", "h1": "Translating SQL to pandas", "description": "Like a person with SQL background and a person that works a lot with SQL, first steps with pandas were little bit difficult for me. I would always think in terms of SQL and then wonder why pandas is\u2026"}, "outgoing_paragraph_urls": [{"url": "https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.isin.html", "anchor_text": "IN", "paragraph_index": 12}, {"url": "https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.between.html", "anchor_text": "BETWEEN", "paragraph_index": 12}, {"url": "https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.contains.html", "anchor_text": "LIKE.", "paragraph_index": 12}, {"url": "https://towardsdatascience.com/extracting-and-transforming-data-in-python-63291f63d350", "anchor_text": "\u201cExtracting and Transforming Data in Python\u201d", "paragraph_index": 24}, {"url": "https://towardsdatascience.com/cleaning-and-preparing-data-in-python-494a9d51a878", "anchor_text": "\u201cCleaning and Preparing Data in Python\u201d", "paragraph_index": 24}, {"url": "http://sergilehkyi.com/translating-sql-to-pandas/", "anchor_text": "sergilehkyi.com", "paragraph_index": 26}], "all_paragraphs": ["Like a person with SQL background and a person that works a lot with SQL, first steps with pandas were little bit difficult for me. I would always think in terms of SQL and then wonder why pandas is so not-intuitive. But with the time I got used to a syntax and found my own associations between these two. So I decide to create kind of cheat sheet of basic SQL commands translated into pandas language.", "The most simple SQL statement will look like:", "Although, by default, pandas will show only 5 first rows, what in SQL will be equivalent to LIMIT 5 or TOP (5) (depends on DBMS). Also just putting df in terminal will show you first and last 15 rows of the DataFrame.", "To select specific columns in SQL we will write the next query:", "In pandas that will be written like this:", "Normally we want to select data with a specific criteria and in SQL it will be done using WHERE clause:", "In pandas this same query looks slightly different:", "WHERE clause accepts logical operators \u2014 pandas too. So this SQL query:", "In pandas takes the following form:", "Operator for OR in pandas is \u2018|\u2019, NOT \u2014 \u2018~\u2019. And keep an eye on parenthesis \u2014 it is mandatory.", "SQL WHERE clause also accepts more complex comparisons, for example: LIKE, IN and BETWEEN; pandas is also capable of doing it \u2014 just in a different way. Lets create a query where all these operators are used:", "This same query in pandas (it is all one row):", "More details on these methods can be found in documentation: IN, BETWEEN, LIKE.", "Joining tables is a common practice in data scientist\u2019s routine and in SQL we do that using 4 different types of JOINS: INNER, LEFT, RIGHT and FULL. The query looks like the following:", "For all joins the syntax is the same, so we just change INNER to any of 3 types that left. In pandas this operation is better to do in 2 steps \u2014 first perform join and then select the data we need (although it can be done in one line):", "If parameters on and how are not specified, pandas will perform LEFT join using indexes as key columns.", "Grouping allows us to get some aggregation insights about our data: COUNT, SUM, AVG, MIN, MAX and so on:", "In pandas we also have this flexibility:", "We have to specify column name in square brackets to include into results only that column otherwise we will get counts per each column in given DataFrame.", "If we want to get a sum of all values in column2 grouped by column1 (total sales in every store, for example) and show only those that have reached certain level, lets say more than 1000 units, in SQL we would do the following:", "In pandas we don\u2019t have this privilege of HAVING clause, but still we can do that, in two steps: first to group data and then to filter it:", "To sort results in SQL we have ORDER BY clause, which is always the last in fetching results from the database. To select all values for the table and sort them by column1 in descending order we write the next query:", "In pandas this same query will look like:", "This one for me is the most intuitive and clear. Although, when you practice more all these syntax differences stop bothering you.", "We can write much more complex queries in SQL and pandas, but this basic aligning has helped me a lot and I believe might help other SQLers. Pandas is a very powerful library and lets you extract, transform, clean your data in a very efficient way. More about it can be found in my articles \u201cExtracting and Transforming Data in Python\u201d and \u201cCleaning and Preparing Data in Python\u201d", "Thank you for reading and have a great day!", "Originally published at sergilehkyi.com on November 25, 2018.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data and Cloud Developer, love technology in general, maybe too much humor and never too serious, based in amazing Barcelona"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8f4ae0268899&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sergilehkyi.medium.com/?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": ""}, {"url": "https://sergilehkyi.medium.com/?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": "Sergi Lehkyi"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F82a9856ae35c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&user=Sergi+Lehkyi&userId=82a9856ae35c&source=post_page-82a9856ae35c----8f4ae0268899---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f4ae0268899&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f4ae0268899&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/Qy-CBKUg_X8?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Aaron Burden"}, {"url": "https://unsplash.com/search/photos/autumn-aerial-landscape?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.isin.html", "anchor_text": "IN"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.between.html", "anchor_text": "BETWEEN"}, {"url": "https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.contains.html", "anchor_text": "LIKE."}, {"url": "https://towardsdatascience.com/extracting-and-transforming-data-in-python-63291f63d350", "anchor_text": "\u201cExtracting and Transforming Data in Python\u201d"}, {"url": "https://towardsdatascience.com/cleaning-and-preparing-data-in-python-494a9d51a878", "anchor_text": "\u201cCleaning and Preparing Data in Python\u201d"}, {"url": "http://sergilehkyi.com/translating-sql-to-pandas/", "anchor_text": "sergilehkyi.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----8f4ae0268899---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/sql?source=post_page-----8f4ae0268899---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/pandas?source=post_page-----8f4ae0268899---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/python?source=post_page-----8f4ae0268899---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----8f4ae0268899---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8f4ae0268899&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&user=Sergi+Lehkyi&userId=82a9856ae35c&source=-----8f4ae0268899---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F8f4ae0268899&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&user=Sergi+Lehkyi&userId=82a9856ae35c&source=-----8f4ae0268899---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8f4ae0268899&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F8f4ae0268899&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----8f4ae0268899---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----8f4ae0268899--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8f4ae0268899--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----8f4ae0268899--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----8f4ae0268899--------------------------------", "anchor_text": ""}, {"url": "https://sergilehkyi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sergilehkyi.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sergi Lehkyi"}, {"url": "https://sergilehkyi.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "598 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F82a9856ae35c&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&user=Sergi+Lehkyi&userId=82a9856ae35c&source=post_page-82a9856ae35c--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F65a0e191fdf8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftranslating-sql-to-pandas-8f4ae0268899&newsletterV3=82a9856ae35c&newsletterV3Id=65a0e191fdf8&user=Sergi+Lehkyi&userId=82a9856ae35c&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}