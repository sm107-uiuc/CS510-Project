{"url": "https://towardsdatascience.com/how-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51", "time": 1683015034.665823, "path": "towardsdatascience.com/how-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51/", "webpage": {"metadata": {"title": "Using the Fourier transform in your regressions | Towards Data Science", "h1": "How to add Fourier terms to your regression & seasonality analysis (using Python & SciPy)", "description": "The Fourier transform is a valuable data analysis tool to analyze seasonality and remove noise in time-series data. We can leverage Python and SciPy.FFT."}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/analyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3", "anchor_text": "Part 1", "paragraph_index": 9}], "all_paragraphs": ["In the last article, we looked into how to use Fourier Transforms to analyze seasonality in 911 phone call data for Montgomery County in Pennsylvania. If you haven\u2019t read it yet, check it out below (although you can definitely read it after reading this article too).", "We found some interesting periodicity in the data. Call volume had 3 main seasonal trends: daily, 3x a day, and once a week. But seasonality doesn\u2019t explain everything. History doesn\u2019t exactly repeat itself. For example, tides ebb and flow throughout the day (this is seasonality), changing the water level, but every year, global warming increases the overall sea levels (unless we do something about it). If you were predicted the water level many many years into the future by just looking at the tide, you would underestimate the water level because you\u2019re not accounting for how sea levels have risen over time.", "Similarly, Montgomery County has seen its population increase by ~3.9% from 2010\u201319 so it\u2019d be reasonable to assume that the 911 call volume has increased slightly in our data as well due to the increased population (we\u2019ll find out if this is the case).", "To address this, we\u2019re going to make one big change from how we analyzed seasonality last time. We\u2019ll first run a linear regression and then perform a Fourier transform on the residuals\u2014the errors of the first regression.", "What we\u2019re doing is giving our best shot trying to explain the data without using seasonality, and then we\u2019ll use seasonality to explain whatever we can\u2019t explain. So let\u2019s get started.", "The first step is to do the regression. My preference is using Sckit-Learn\u2019s LinearRegression model you can use whatever you\u2019re comfortable with.", "Looking at the model coefficients and intercept, we find a slope of about \u22123E\u221210 and intercept of 16.40.", "Our initial hypothesis that we\u2019d see an increase in 911 calls proportional to population growth doesn\u2019t seem to ring true. Also, it\u2019s clear that this regression isn\u2019t very helpful. The R\u00b2 is really pitiful.", "But this cloud has a silver lining. The poor fit on time alone suggests that we can improve things significantly by incorporating our Fourier terms.", "Part 1 goes through this process in more detail. In short, we\u2019ll use the Fourier transform to find the most dominant frequencies and then use the inverse Fourier transform to give us the functions that correspond to these frequencies.", "Here are the dominant frequencies we find after the Fourier transform.", "Here are the values these peaks correspond to (not very different from what we saw in Part 1). I labeled them FT_1 ... FT_12 for easy reference.", "If you\u2019re interested in how to get these values, the FFT column is what\u2019s output by running scipy.fft.fft(residuals) . You can get the frequencies by running fft.fftfreq(len(residuals)) . These frequencies will have the unit of 1 / timestep, where the timestep is the spacing between your residuals (in our case, this is an hour) The amplitude is abs(fft) and the phase is cmath.phase(fft) .", "Each of these rows, corresponds to a sinusoid. We can use the inverse Fourier transform to calculate these sinusoid and plot their sum versus the original residuals. They fit pretty well.", "Now lets incorporate our sinusoids into our initial regression. The problem with these sinusoids is that the amplitude is off. You can see in the chart above that it appears too low. This is because we did the Fourier transform on the resiudals and filtered the output down to just 12 terms. So our filtering", "Our initial regression just used time as its only variable, but now we can add our Fourier terms. The phase, amplitude, and frequency let us plot the wave that the FFT term corresponds to, using this formula.", "What we\u2019re trying to do now is figure out what the new regression would be if we added several new variables related to these waves from the FFT.", "So we go back to our original data, that had the time in seconds and the number of calls for that time, and we add several columns corresponding to each of the waves from our Fourier transform. Then we can sum these together into a new column, FT_All. This looks like:", "This gives us a new variable, FT_All , which is the same as the \u201cFiltered Residuals\u201d we charted earlier.", "These Fourier terms may seem daunting, but basically, they are just sinusoids (i.e. waves) that we identified are important in our Fourier transform. They were important because they peaked in the frequency domain. If we plot FT_1 we see it\u2019s a wave with a one-day period and a specific phase shift, which matches the daily seasonality we see in the data.", "Now we can run a regression using our new variable.", "Here\u2019s how the regression results look for the first 5 days. It definitely looks promising.", "Finally, if we check the model score, we can see that we\u2019re doing a lot better than before.", "That\u2019s an R\u00b2 improvement from 0.000001 to 0.41 from just adding one new variable. Not bad at all!", "Fourier transforms aren\u2019t the only way to analyze seasonality in a regression. I would definitely consider exploring other simpler options. like adding a dummy variable for an hour of the day or day of week, especially if you already have a strong intuition for what to expect.", "For example, say you know that 911 call volumes spike between 6 and 9 pm, then you can just create a new variable that\u2019s 1 when the time is between 6 and 9 pm, and 0 otherwise. The coefficient will tell you pretty clearly how much more call volume to expect during evening hours.", "The challenge is knowing how to even start. Is it 6 to 9 pm, or 7 to 10 pm? Or do weekends impact call volume more than evenings do? The Fourier transform is a great way to answer those questions. It gives you a quantifiable way to measure seasonality in your data. Then if you want to leverage it in your regression, you have an easy option to do so by incorporating the sinusoids that the Fourier transform outputs. Or you can take the insights from the Fourier analysis, and test simpler variables in your regression.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software, math & data @ Jump Trading"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F99a94d3ae51&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lakshayakula?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lakshayakula?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": "Lakshay Akula"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc7b8c98889f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&user=Lakshay+Akula&userId=c7b8c98889f8&source=post_page-c7b8c98889f8----99a94d3ae51---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99a94d3ae51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99a94d3ae51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/analyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3", "anchor_text": "Analyzing seasonality with Fourier transforms using Python & SciPyLearn to separate signal from noise by looking for seasonal trends in 911 phone call datatowardsdatascience.com"}, {"url": "https://towardsdatascience.com/analyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3", "anchor_text": "Part 1"}, {"url": "https://github.com/Kommandat/seasonality-fourier-analysis/blob/master/notebooks/Part%202%20-%20Regression%20%20Analysis%20with%20scipy-fft.ipynb", "anchor_text": "Project code on Github"}, {"url": "https://www.kaggle.com/mchirico/montcoalert", "anchor_text": "Dataset on Kaggle"}, {"url": "https://towardsdatascience.com/analyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/analyzing-seasonality-with-fourier-transforms-using-python-scipy-bb46945a23d3", "anchor_text": "Analyzing seasonality with Fourier transforms using Python & SciPyLearn to separate signal from noise by looking for seasonal trends in 911 phone call datatowardsdatascience.com"}, {"url": "https://medium.com/tag/data-science?source=post_page-----99a94d3ae51---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/programming?source=post_page-----99a94d3ae51---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/math?source=post_page-----99a94d3ae51---------------math-----------------", "anchor_text": "Math"}, {"url": "https://medium.com/tag/python?source=post_page-----99a94d3ae51---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----99a94d3ae51---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99a94d3ae51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&user=Lakshay+Akula&userId=c7b8c98889f8&source=-----99a94d3ae51---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F99a94d3ae51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&user=Lakshay+Akula&userId=c7b8c98889f8&source=-----99a94d3ae51---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F99a94d3ae51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F99a94d3ae51&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----99a94d3ae51---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----99a94d3ae51--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----99a94d3ae51--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----99a94d3ae51--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----99a94d3ae51--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lakshayakula?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lakshayakula?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lakshay Akula"}, {"url": "https://medium.com/@lakshayakula/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "339 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc7b8c98889f8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&user=Lakshay+Akula&userId=c7b8c98889f8&source=post_page-c7b8c98889f8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa592a2cd2d01&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-add-fourier-terms-to-your-regression-seasonality-analysis-using-python-scipy-99a94d3ae51&newsletterV3=c7b8c98889f8&newsletterV3Id=a592a2cd2d01&user=Lakshay+Akula&userId=c7b8c98889f8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}