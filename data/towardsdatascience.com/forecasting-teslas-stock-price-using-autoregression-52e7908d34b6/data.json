{"url": "https://towardsdatascience.com/forecasting-teslas-stock-price-using-autoregression-52e7908d34b6", "time": 1683012115.393686, "path": "towardsdatascience.com/forecasting-teslas-stock-price-using-autoregression-52e7908d34b6/", "webpage": {"metadata": {"title": "Forecasting Tesla\u2019s Stock Price Using Autoregression | by Nathan Thomas | Towards Data Science", "h1": "Forecasting Tesla\u2019s Stock Price Using Autoregression", "description": "Tesla has been making waves in financial markets over the last few months. Previously named the most shorted stock in the US [1], Tesla\u2019s stock price has since catapulted the electric carmaker to a\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/nathanwilthomas/tsla_ar_forecasting", "anchor_text": "Github Repository", "paragraph_index": 21}], "all_paragraphs": ["Tesla has been making waves in financial markets over the last few months. Previously named the most shorted stock in the US [1], Tesla\u2019s stock price has since catapulted the electric carmaker to a market capitalization of $278 billion [2]. Its latest quarterly results suggest that it is now available to be added to the S&P 500, which it is currently not a member of, despite being the 12th largest company in the US [3].", "Amid market volatility, various trading strategies and a sense of \u201cFOMO\u201d (fear of missing out), predicting the returns of Tesla\u2019s stock is a difficult task. However, we are going to use Python to forecast Tesla\u2019s stock price returns using autoregression.", "First, we need to import the data. We may use historical stock price data downloaded from Yahoo Finance. We\u2019re going to use the \u201cClose\u201d price for this analysis.", "To determine the order for the ARMA model, we can firstly plot a partial autocorrelation function. This gives a graphical interpretation of the amount of correlation between the dependent variable and the lags of itself, which is not explained by correlations at all lower-order lags.", "From the PACF below, we can see that the significance of the lags cuts off after lag 1, which suggests we should use an autoregressive (AR) model [4].", "When plotting the autocorrelation function, we get a slightly different result. The series is infinite and slowly damps out, which suggests an AR or ARMA model [4]. Taking both the PACF and the ACF into account, we are going to use an AR model.", "Before we run the model we must make sure we are using stationary data. Stationarity refers to a characteristic in which the way the data moves doesn\u2019t change over time. Looking at the raw stock price seen earlier in the article, it is clear that the series is not stationary. We can see this as the stock price increases over time in a seemingly exponential manner.", "Therefore, to make the series stationary we difference the series, which essentially means to subtract today\u2019s value from tomorrow\u2019s value. This results in the series revolving around a constant mean (0), giving us the stock returns instead of the stock price.", "We are also going to lag the differenced series by 1, which brings yesterday\u2019s value forward to today. This is so we can obtain our AR term (Yt-1).", "After putting these values into the same DataFrame, we split the data into training and testing sets. In the code, the data is split roughly into 80:20 respectively.", "Now, how many values should we use to predict the next observation? Using all the past 200 values may not give a good estimate as intuitively, stock price activity from 200 days ago is unlikely to have a significant effect on today\u2019s value as numerous factors may have changed since then. This could include earnings, competition, season and more. Therefore, to find the optimal window of observations to use in the regression, one method we can use is to run a regression with an expanding window. This method, detailed in the code below, runs a regression with one past observation, recording the r-squared value (goodness-of-fit), and then repeats this process, expanding past observations by 1 each time. For economic interpretation, I\u2019ve set the limit on the size of the window at 30 days.", "Looking at the r-squared plot of each iteration, we can see than it is high around 1\u20135 iterations, and also has a peak at 13 past values. It may seem tempting to choose one of the values between 1 and 5, however, the very small sample size will likely mean that out regression is statistically biased, so wouldn\u2019t give us the best result. Therefore let\u2019s choose the second peak at 13 observations as this is a more sufficient sample size, which gives an r-squared of around 0.437 (i.e. model explains 43% of the variation in the data).", "Running the AR model on the training data", "The next step is to use our window of 13 past observations to fit the AR(1) model. We may do this using the OLS function in statsmodels. Code below:", "As we can see in the statistical summary, the p-value of both the constant and the first lag is significant at the 10% significance level. Looking at the sign of the coefficients, the positive sign on the constant suggests that, all else being equal, stock price returns should be positive. Also, the negative sign on the first lag suggests that the past value of the stock return is lower than today\u2019s value, ceteris paribus, which also maintains the narrative that stock returns increase over time.", "Great, now let\u2019s use those coefficients to find the fitted value for Tesla\u2019s stock returns so we can plot the model against the original data. Our model may now be specified as:", "The residuals suggest that the model performs better in 2019, but in 2020 as volatility increased, the model performed considerable worse (residuals are larger). This is intuitive as the volatility experienced in the March 2020 selloff had a large impact on US stocks, while the quick and sizeable rebound was particularly felt by tech stocks. This, along with the increased betting on Tesla stock by retail traders on platforms such as Robinhood has increased price volatility, thus making it harder to predict.", "Given these factors, along with our previous r-squared of around 43%, we would not expect our AR(1) model to predict the exact stock return. Instead, we can test the model\u2019s accuracy by calculating its \u201chit rate\u201d, i.e. when our model predicted a positive value and the actual value was also positive, and vice versa. Summing up instances of true positives and true negatives, the accuracy of our model comes out at around 55%, which is fairly good for this simple model.", "Fit model to the test data", "Now, let\u2019s apply the same methodology to the test data to see how our model performs out-of-sample.", "Our hit rate has improved to 64% when applying the model to the test data, which is a promising improvement! Next steps to improve its accuracy may include running a rolling regression, where coefficients change with each iteration, or perhaps incorporating a moving average (MA) element to the model.", "Thanks for reading! Please feel free to leave any comments for any insights you may have. The full Jupyter Notebook which contains the source code I used to do this project can be found on my Github Repository.", "Disclaimer: All views expressed in this article are my own, and are not in any way associated with any financial entity. I am not a trader and am not making any money from the methods used in this article. This is not financial advice.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F52e7908d34b6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@nathanwthomas?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nathanwthomas?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": "Nathan Thomas"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fecf3c9fa298d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&user=Nathan+Thomas&userId=ecf3c9fa298d&source=post_page-ecf3c9fa298d----52e7908d34b6---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52e7908d34b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52e7908d34b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/nathanwilthomas/tsla_ar_forecasting", "anchor_text": "Github Repository"}, {"url": "https://markets.businessinsider.com/news/stocks/tesla-stock-most-shorted-us-beats-apple-highest-short-interest-2020-1-1028823046", "anchor_text": "https://markets.businessinsider.com/news/stocks/tesla-stock-most-shorted-us-beats-apple-highest-short-interest-2020-1-1028823046"}, {"url": "https://www.cnbc.com/2020/07/21/tesla-isnt-a-gurantee-for-the-sp-500-even-with-year-of-profits.html", "anchor_text": "https://www.cnbc.com/2020/07/21/tesla-isnt-a-gurantee-for-the-sp-500-even-with-year-of-profits.html"}, {"url": "https://medium.com/tag/math?source=post_page-----52e7908d34b6---------------math-----------------", "anchor_text": "Math"}, {"url": "https://medium.com/tag/data-science?source=post_page-----52e7908d34b6---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----52e7908d34b6---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/money?source=post_page-----52e7908d34b6---------------money-----------------", "anchor_text": "Money"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----52e7908d34b6---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52e7908d34b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&user=Nathan+Thomas&userId=ecf3c9fa298d&source=-----52e7908d34b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F52e7908d34b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&user=Nathan+Thomas&userId=ecf3c9fa298d&source=-----52e7908d34b6---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F52e7908d34b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F52e7908d34b6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----52e7908d34b6---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----52e7908d34b6--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----52e7908d34b6--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----52e7908d34b6--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----52e7908d34b6--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nathanwthomas?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@nathanwthomas?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nathan Thomas"}, {"url": "https://medium.com/@nathanwthomas/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "83 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fecf3c9fa298d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&user=Nathan+Thomas&userId=ecf3c9fa298d&source=post_page-ecf3c9fa298d--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F52e24c772819&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fforecasting-teslas-stock-price-using-autoregression-52e7908d34b6&newsletterV3=ecf3c9fa298d&newsletterV3Id=52e24c772819&user=Nathan+Thomas&userId=ecf3c9fa298d&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}