{"url": "https://towardsdatascience.com/robust-covariance-for-anomaly-detection-9c68b1ec4c4b", "time": 1683018127.4071, "path": "towardsdatascience.com/robust-covariance-for-anomaly-detection-9c68b1ec4c4b/", "webpage": {"metadata": {"title": "Robust Covariance for Anomaly Detection | by Georgi Ivanov | Towards Data Science", "h1": "Robust Covariance for Anomaly Detection", "description": "New technologies like the internet of things combined with artificial intelligence are enablers of interesting applications such as predictive maintenance, i.e., autonomously assessing the condition\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.ibm.com/blogs/internet-of-things/what-is-the-iot/", "anchor_text": "internet of things", "paragraph_index": 0}, {"url": "https://www.ibm.com/cloud/learn/what-is-artificial-intelligence", "anchor_text": "artificial intelligence", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Predictive_maintenance", "anchor_text": "predictive maintenance", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Standard_score", "anchor_text": "Z-score", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Robust_statistics", "anchor_text": "robust method", "paragraph_index": 3}, {"url": "https://scikit-learn.org/stable/auto_examples/covariance/plot_mahalanobis_distances.html", "anchor_text": "Robust covariance", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Determinant", "anchor_text": "determinant", "paragraph_index": 4}, {"url": "https://www.tandfonline.com/doi/abs/10.1080/00401706.1999.10485670", "anchor_text": "Rousseeuw and Van Driessen developed a computationally efficient algorithm that can yield robust covariance estimates", "paragraph_index": 4}, {"url": "https://en.wikipedia.org/wiki/Chi-square_distribution", "anchor_text": "Chi-square distribution", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/P-value", "anchor_text": "p-value", "paragraph_index": 5}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.covariance.EllipticEnvelope.html", "anchor_text": "elliptic envelope", "paragraph_index": 6}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "scikit-learn", "paragraph_index": 6}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.OneClassSVM.html", "anchor_text": "one-class support vector machine", "paragraph_index": 8}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html", "anchor_text": "isolation forest", "paragraph_index": 8}], "all_paragraphs": ["New technologies like the internet of things combined with artificial intelligence are enablers of interesting applications such as predictive maintenance, i.e., autonomously assessing the condition of equipment in order to estimate when maintenance should be performed. For this purpose, it is important to have mathematical models that can distinguish between \u201cnormal\u201d and \u201cnon-normal\u201d behavior of the equipment, a task called anomaly detection. Equipped with all kinds of sensors, a machine or device can use this collection of sensor data (e.g., temperature, fan speed, pressure, flow rate, etc.) to assess its state and call for service if necessary; the more its behavior deviates from its reference state just after fabrication, the more it will need maintenance.", "In statistics, deviation can be assessed by the Z-score. The generalization of the Z-score for a point x\u1d62 in the case of a p-dimensional multi-variate probability distribution with some mean \u03bc and covariance matrix \u03a3 is known as Mahalanobis distance d\u1d62, which is given by:", "This metric assesses how many standard deviations \u03c3 away x\u1d62 is from \u03bc, thereby being dimensionless. An extreme observation has a large distance from the center of a distribution. It is useful in predictive maintenance as it enables finding unusual behavior of a system; upcoming down-times and malfunction can be targeted and identified, which is particularly important since finding faults in equipment, machines, and devices early can reduce the extent of the damage.", "Given a data set X with n samples in p variables (i.e, data from p sensors), mean and covariance matrix are easily computed. However, in the presence of outliers, both are distorted and the Mahalanobis distance is rendered useless, hence a robust method, i.e., a method that is little affected by outliers, would be desired. In Figure 1, a Gaussian distribution for some two-dimensional sensor data set X is plotted; just like with the Z-score (e.g., \u00b11.96\u03c3), an envelope around the data set can be constructed by choosing a critical value of the Mahalanobis distance. Points outside this envelope are considered anomalies/outliers.", "Robust covariance methods are based on the fact that outliers lead to an increase of the values (entries) in \u03a3, making the spread of the data apparently larger. Consequently, |\u03a3| (the determinant) will also be larger, which would theoretically decrease by removing extreme events. Rousseeuw and Van Driessen developed a computationally efficient algorithm that can yield robust covariance estimates. Their method is based on the assumption that at least h out of the n samples are \u201cnormal\u201d (h is a hyperparameter). The algorithm starts with k random samples with (p+1) points. For each of the k samples, \u03bc, \u03a3, and |\u03a3| are estimated, the distances are calculated and sorted in increasing order, and the h smallest distances are used to update the estimates. In their original publication, the subroutine of computing distances and updating the estimates of \u03bc, \u03a3, and |\u03a3| is called a \u201cC-step\u201d. They figured out that two such steps are sufficient to find good candidates (for \u03bc and \u03a3) among the k random samples. In a next step, a subset of size m with the lowest |\u03a3| (the best candidates) is considered for computation until convergence, and the one estimate whose |\u03a3| is minimal is returned as output.", "Note that the squared distance d\u1d62\u00b2 follows a Chi-square distribution with p degrees of freedom. To compute a critical distance (threshold) for the envelope, a quantile, i.e., the probability of observing a squared distance as extreme as the threshold \u2014 also known as p-value \u2014 is chosen, and the critical distance is then computed from the inverse cumulative distribution. (For one variable and a probability threshold/p-value of 0.05, the critical Chi-square value is 3.84, which corresponds to the squared distance; the square root of that is 1.96, which is consistent with the intuition for one dimension, e.g., from statistical tests.)", "This algorithm is implemented in the elliptic envelope class of scikit-learn. Its most important hyperparameter is the amount of contamination \u03bd, which is related to the parameter h in the original algorithm, since \u03bd = 1-h/n. This hyperparameter has to be tuned to obtain the desired performance.", "The figure below demonstrates the ability to detect outliers of a p-dimensional sensor data set X in the principal component space of the sensor data, whereas the first two components are visualized.", "The Mahalanobis distance is a simple and intuitive method that can perform well when the data is close to normally distributed. In other cases, the envelope might be not fitting perfectly around the data, but non-parametric methods such as one-class support vector machine or isolation forest have been developed as well. In practice, different algorithms have to be evaluated \u2014 including hyperparameter optimization. Embedding these models in machines and devices can bring a lot of added-value and lead to competitive advantage, now it is up to research and development engineers/managers to spot such opportunities.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9c68b1ec4c4b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://g-ivanov.medium.com/?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": ""}, {"url": "https://g-ivanov.medium.com/?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": "Georgi Ivanov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F54224776d918&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&user=Georgi+Ivanov&userId=54224776d918&source=post_page-54224776d918----9c68b1ec4c4b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c68b1ec4c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c68b1ec4c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@carrier_lost?utm_source=medium&utm_medium=referral", "anchor_text": "Ian Taylor"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.ibm.com/blogs/internet-of-things/what-is-the-iot/", "anchor_text": "internet of things"}, {"url": "https://www.ibm.com/cloud/learn/what-is-artificial-intelligence", "anchor_text": "artificial intelligence"}, {"url": "https://en.wikipedia.org/wiki/Predictive_maintenance", "anchor_text": "predictive maintenance"}, {"url": "https://towardsdatascience.com/strategies-for-predictive-maintenance-within-the-internet-of-things-c66adcba037d", "anchor_text": "Predictive Maintenance within the Internet of ThingsPredicting and preventing down-times of equipment, machines, and devices.towardsdatascience.com"}, {"url": "https://en.wikipedia.org/wiki/Standard_score", "anchor_text": "Z-score"}, {"url": "https://en.wikipedia.org/wiki/Robust_statistics", "anchor_text": "robust method"}, {"url": "https://scikit-learn.org/stable/auto_examples/covariance/plot_mahalanobis_distances.html", "anchor_text": "Robust covariance"}, {"url": "https://en.wikipedia.org/wiki/Determinant", "anchor_text": "determinant"}, {"url": "https://www.tandfonline.com/doi/abs/10.1080/00401706.1999.10485670", "anchor_text": "Rousseeuw and Van Driessen developed a computationally efficient algorithm that can yield robust covariance estimates"}, {"url": "https://en.wikipedia.org/wiki/Chi-square_distribution", "anchor_text": "Chi-square distribution"}, {"url": "https://en.wikipedia.org/wiki/P-value", "anchor_text": "p-value"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.covariance.EllipticEnvelope.html", "anchor_text": "elliptic envelope"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "scikit-learn"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.svm.OneClassSVM.html", "anchor_text": "one-class support vector machine"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html", "anchor_text": "isolation forest"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9c68b1ec4c4b---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9c68b1ec4c4b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/statistics?source=post_page-----9c68b1ec4c4b---------------statistics-----------------", "anchor_text": "Statistics"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----9c68b1ec4c4b---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/algorithms?source=post_page-----9c68b1ec4c4b---------------algorithms-----------------", "anchor_text": "Algorithms"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c68b1ec4c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&user=Georgi+Ivanov&userId=54224776d918&source=-----9c68b1ec4c4b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c68b1ec4c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&user=Georgi+Ivanov&userId=54224776d918&source=-----9c68b1ec4c4b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c68b1ec4c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9c68b1ec4c4b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9c68b1ec4c4b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9c68b1ec4c4b--------------------------------", "anchor_text": ""}, {"url": "https://g-ivanov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://g-ivanov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Georgi Ivanov"}, {"url": "https://g-ivanov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "325 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F54224776d918&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&user=Georgi+Ivanov&userId=54224776d918&source=post_page-54224776d918--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F4e7dcd411990&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Frobust-covariance-for-anomaly-detection-9c68b1ec4c4b&newsletterV3=54224776d918&newsletterV3Id=4e7dcd411990&user=Georgi+Ivanov&userId=54224776d918&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}