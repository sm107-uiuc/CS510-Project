{"url": "https://towardsdatascience.com/time2vec-for-time-series-features-encoding-a03a4f3f937e", "time": 1683000596.354572, "path": "towardsdatascience.com/time2vec-for-time-series-features-encoding-a03a4f3f937e/", "webpage": {"metadata": {"title": "Time2Vec for Time Series features encoding | by Marco Cerliani | Towards Data Science", "h1": "Time2Vec for Time Series features encoding", "description": "Time is golden information in every Machine Learning problem which engages Time Series. As Data Scientists, we must do our best to extract time patterns and make our data speak themself. During\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/abs/1907.05321", "anchor_text": "Time2Vec: Learning a Vector Representation of Time", "paragraph_index": 1}, {"url": "https://www.kaggle.com/lbronchal/venezia#Punta_Salute_1983_2015.zip", "anchor_text": "Kaggle", "paragraph_index": 2}, {"url": "https://github.com/cerlymarco/keras-hypetune", "anchor_text": "keras-hypetune", "paragraph_index": 9}, {"url": "https://arxiv.org/pdf/1907.05321.pdf", "anchor_text": "Time2Vec", "paragraph_index": 12}], "all_paragraphs": ["Time is golden information in every Machine Learning problem which engages Time Series. As Data Scientists, we must do our best to extract time patterns and make our data speak themself. During preprocessing, common procedures are for example standardization (stationarity check, autocorrelation removal\u2026), creating and encoding categorical time features (day, week, month, season\u2026), manual feature engineering (Fourier transformations\u2026). Not always our efforts are repaid because, during modelization, our selected model can fail to treat time itself properly as a feature.", "In this post, I try to reproduce the approach proposed in the paper \u2018Time2Vec: Learning a Vector Representation of Time\u2019, which final scope is to develop a general-purpose model-agnostic representation for time that can be potentially used in any architecture (I adapt this solution developing a Neural Network in Keras). The authors don\u2019t want to propose a new model for time series analysis, but instead, their goal is to provide a representation of time, in form of vector embedding, in order to automatize the feature engineering process and model time in a better way.", "To give evidence and a concrete utility of the whole solution, we need an adequate dataset. In my case, I need data in time series format without any redundant information in form of extra features. This scenario is typical in autoregressive problems, where we have only one time series and we use it as a feature to forecast the future. In real life this is a common task, so is not difficult to find a dataset. I found a nice one on Kaggle. It stores a great number of historical levels of water in Venice. Forecasting these values is a serious task; daily tourists can access a well detailed and accurate report of the level of the sea in various parts of the city.", "I love Venice and my aim is not to compete with them. We also have not enough information to provide truly evident performances (extra regressors such as temperature, moon phases, weather conditions and so on, provide an adequate boost). Here we have to squeeze the only historical data at our disposal to provide the forecasts of the next hour levels of water.", "Mathematically speaking, implement Time2Vec is quite easy:", "Where k is the time2vec dimension, tau is a raw time series, F is a periodic activation function, omega and phi are a set of learnable parameters. In my experiment, I set F to be a sin function in order to able a selected algorithm to capture periodic behaviors in data. At the same time, the linear term represents the progression of time and can be used for capturing non-periodic patterns in the input that depend on time.", "The simplicity makes this vector representation for time easily consumable by different architectures. In my case, I try to transfer this concept in a Neural Network structure modifying a simple Keras dense layer.", "The output dimension of this custom layer is the hidden dimension specified by the user (1 \u2264 i \u2264 k), i.e. the learned sinusoids from the network, plus a linear representation of the input (i = 0). With this instrument in our hands, we just have to stack it with other layers and try its power in our case study.", "Is Time2Vec a good representation of time? In order to answer this question, I compare the performances achieved in our forecasting task, building two different Sequential Neural Network models. The first one has as input our custom Time2Vec layer, stacked on a simple LSTM layer. The second one is composed of only the simple LSTM layer used in the previous structure.", "We carry out the fitting procedures operating hyperparameters optimization. This is done using keras-hypetune. This framework provides hyperparameter optimization of the neural network structures in a very intuitive way. We operate a standard grid search of some parameter combinations. This is done for all two training procedures involved.", "I use the first 70% of the data as train set and the remaining 30% as test set. The train is also split into validation, inside the fitting process, in order to operate hyperparameter tuning. The best and optimized T2V + LSTM achieves around 1.67 MAE on the test, while the simple and optimized LSTM achieves around 2.02.", "Both the networks seem to be able to identify the pattern in the data really well. The usage of T2V encoding can grant a little boost in performance.", "In this post, I presented an approach that automatically learns the features of the time. In particular, I reproduced Time2Vec, a vector representation for time, adapting it to a Neural Network architecture. In the end, I was able to show the effectiveness, in terms of performances, of this representation on a real task. I want to remark, as the authors of the paper suggest, that T2V is not a new model for time series analysis, but it is a simple vector representation that can be easily imported into many existing and future architectures and improve their performances.", "If you are interested in the topic, I suggest:", "Time2Vec: Learning a Vector Representation of Time. Seyed Mehran Kazemi, Rishab Goel, Sepehr Eghbali, Janahan Ramanan, Jaspreet Sahota, Sanjay Thakur, Stella Wu, Cathal Smyth, Pascal Poupart, Marcus Brubaker", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa03a4f3f937e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@cerlymarco?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7----a03a4f3f937e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa03a4f3f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa03a4f3f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@lucamicheli?utm_source=medium&utm_medium=referral", "anchor_text": "Luca Micheli"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://arxiv.org/abs/1907.05321", "anchor_text": "Time2Vec: Learning a Vector Representation of Time"}, {"url": "https://www.kaggle.com/lbronchal/venezia#Punta_Salute_1983_2015.zip", "anchor_text": "Kaggle"}, {"url": "https://arxiv.org/pdf/1907.05321.pdf", "anchor_text": "https://arxiv.org/pdf/1907.05321.pdf"}, {"url": "https://github.com/cerlymarco/keras-hypetune", "anchor_text": "keras-hypetune"}, {"url": "https://arxiv.org/pdf/1907.05321.pdf", "anchor_text": "Time2Vec"}, {"url": "https://towardsdatascience.com/word2vec-with-time-series-a-transfer-learning-approach-58017e7a019d", "anchor_text": "Word2Vec with Time Series: A Transfer Learning Approach"}, {"url": "https://towardsdatascience.com/corr2vec-a-wavenet-architecture-for-feature-engineering-in-financial-market-94b4f8279ba6", "anchor_text": "Corr2Vec: a WaveNet architecture for Feature Engineering in Financial Market"}, {"url": "https://github.com/cerlymarco/MEDIUM_NoteBook", "anchor_text": "CHECK MY GITHUB REPO"}, {"url": "https://www.linkedin.com/in/marco-cerliani-b0bba714b/", "anchor_text": "Linkedin"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a03a4f3f937e---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----a03a4f3f937e---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/time-series-forecasting?source=post_page-----a03a4f3f937e---------------time_series_forecasting-----------------", "anchor_text": "Time Series Forecasting"}, {"url": "https://medium.com/tag/encoding?source=post_page-----a03a4f3f937e---------------encoding-----------------", "anchor_text": "Encoding"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a03a4f3f937e---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa03a4f3f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&user=Marco+Cerliani&userId=c843902314c7&source=-----a03a4f3f937e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa03a4f3f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&user=Marco+Cerliani&userId=c843902314c7&source=-----a03a4f3f937e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa03a4f3f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa03a4f3f937e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a03a4f3f937e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a03a4f3f937e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@cerlymarco?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Marco Cerliani"}, {"url": "https://medium.com/@cerlymarco/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "6K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc843902314c7&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&user=Marco+Cerliani&userId=c843902314c7&source=post_page-c843902314c7--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe2412974851a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ftime2vec-for-time-series-features-encoding-a03a4f3f937e&newsletterV3=c843902314c7&newsletterV3Id=e2412974851a&user=Marco+Cerliani&userId=c843902314c7&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}