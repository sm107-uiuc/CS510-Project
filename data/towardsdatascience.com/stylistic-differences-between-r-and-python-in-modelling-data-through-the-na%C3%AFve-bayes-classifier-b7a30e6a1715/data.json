{"url": "https://towardsdatascience.com/stylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715", "time": 1683005073.7865758, "path": "towardsdatascience.com/stylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715/", "webpage": {"metadata": {"title": "Stylistic differences between R and Python in modelling data through the Na\u00efve Bayes classifier | by Nicola Giordano | Towards Data Science", "h1": "Stylistic differences between R and Python in modelling data through the Na\u00efve Bayes classifier", "description": "How to use R and Python to predict the probability of an event, based on prior knowledge of conditions that relate to it"}, "outgoing_paragraph_urls": [{"url": "https://levelup.gitconnected.com/stylistic-differences-between-r-and-python-in-modelling-data-through-decision-trees-ea6f7c98e6e8", "anchor_text": "decision trees", "paragraph_index": 0}], "all_paragraphs": ["Since the most decisive aspect of a data science methodology is to model data to produce estimations and powerful predictions, there is a wide array of methods and algorithms to explore at that aim. This blog presents another way to model data, beyond what explained in the previous blog on decision trees, namely the Na\u00efve Bayes classification method.", "This classification method is a derivation of the Bayes\u2019s theorem which describes the probability of an event, based on prior knowledge of conditions that might be related to the event. The ideator of this theorem is Thomas Bayes (1701-1761) who was an English statistician, philosopher and Presbyterian minister. This theorem became his most famous accomplishment. One of the applications of the Bayes\u2019 theorem is also based on the interpretations of probability as an amount of epistemic confidence (the strength of beliefs, hypotheses etc.) rather than a frequency. This allows the application of probability to various fields rather than just the ones that come with a reference class.", "In data science, Bayes theorem is applied to update our knowledge about specific data parameters by combining our previous knowledge (called the priori distribution) with new information obtained from observed data. This results in updated parameter knowledge also called the posterior distribution.", "The main formula to explain the theorem considers two events. In data science, the two events can be types of variables (predictors and target). We can consider a dataset made up of two predictors (X*=X1, X2) and the response variable Y can be made up by multiple classes (y1, y2, y3\u2026). Through the Bayes Theorem, we can identify which class is most likely for a specific combination of predictor variables.", "The combination of prior probability given by how likely the class value y* is before the analysis and a representation of how data behave when the response corresponds to a certain class results in a posterior probability. The denominator on the left-hand side of the equation describes how the data behave without reference to the class value of the target variable, also known as the marginal probability of the data. In case there is no prior knowledge about the parameters we can use a noninformative prior which indicates that all class value are equally likely. In this latter scenario, the posterior probability is based solely on the data.", "In the case of 3 different possible class values of y, for a constant X value, we can calculate a Bayes probability for each of the three possible values of Y as illustrated in the formula below. The maximum a posteriori hypothesis tells us to classify the record for a selected predictor X as the value of the target variable Y which has the highest posterior probability.", "Importantly, even if we have more than one predictor variable, the class conditional independence assumption describe the various events or variables as independent. The choice of our predictors should, therefore, take this assumption into account by ensuring no relationships between X1 and X2.", "The starting point in Python to apply the Bayes theorem is to upload the relevant libraries, among which the multinomial Naive Bayes classifier named MultinomialNB which is suitable for classification with discrete features (e.g., word counts for text classification).", "Secondly, uploading or creating a relevant dataframe is the basis to carry out the analysis. In this case, we can randomly generate a dataset for the sake of simulating the theorem. In the dataset, the selection of predictors and target variables can stem out of a specific analytical need. In this example, the prediction of how much assistance is received (Y) is explored as a function of the type of shock and location (X1, X2).", "In order to proceed with the analysis in Python, we would need to consider one test and one training dataframes. It is possible to either split the master dataframe, or select another source of information with the same variables. In this case, a split of the master dataframe can be done by using the train_test_split command. In addition, we can derive the marginal and conditional probability of the predictors through pd.crosstab in case the intention is to perform the Bayes calculation manually.", "In order to apply the Bayes algorithm in Python, we would need to convert each predictor into dummy. This can be done by utilising the stattools.categorical command for each variable (type of shock, location) needed to explain the target variable and concatenate them into a dataframe through the command pd.concat.", "After having turned the predictor variables into a dummy matrix, it is useful to define the Y variable for clarity purposes. After the predictor and target variables are well-defined, it becomes possible to apply the MultinomialNB command, which represents the Na\u00efve Bayes algorithm, to the training dataset.", "The decisive step is to test the Na\u00efve Bayes estimator on the test dataset. In order to do so, we would need to set up the X variables in the test data as dummy variables like before. Once the predictor variables are set up for the test dataset, it becomes possible to generate predictions by using the command predict, which generates an array of prediction value for each record in the test dataset.", "After utilisation of the predict command on the Bayes object (named Bayes_01 in this example) we can finally create a contingency table of the actual and predicted target classes (above and below 500 millions) that can help us understanding the accuracy of our model.", "To test the level of accuracy in Python, we can simply sum how often the actual entries correspond to the predicted ones over the total number of records in the test dataset. Globally, the model is only accurate 51% of the times, which means only 1 out of 2 times the prediction would be correct. The model performs better in predicting the Above_500_Mill class than the baseline model (58.3% vs. 48%) whilst it performs worse than the baseline model to predict the Below_500_Mill class (44.3% vs. 48%).", "Like we have done in the previous example, the initial step to apply the Bayes theorem in R also requires the uploading or generation of a dataset that contains predictors and target variables. In this case, the same structure of the dataset is proposed and the predictors remain the type of shock and location while the target variables is the factorisation of aid given.", "Once the dataframe is selected, we would either split it into two parts or upload a similar dataset with the same variables. The utilisation of two dataframes is necessary to apply the predicted values generated from a training dataset to a test one. The runif command can help us to do that in case we decide to use the same dataframe.", "Once the dataframes are ready for analysis, we can create two tables to allow the calculation of probabilities by hand (if we wish to). The contingency tables also help in understanding the distribution of the categorical attributes of the predictors across the various classes of the target variables. Please note the difference with Python, in R we have to specify the column and row names for each table while there is no specification of the axis.", "Once we created the contingency tables, the next step in R is to apply the Bayes algorithm through library e1071. The command naiveBayes yields a lot more information about the a-priori and conditional probabilities than the equivalent in Python. Another stylistic difference between is the explicit specification of the formula explaining the relationship between predictors and target variables inside the Bayes command.", "The last step in R is the application of the predicted classes of the target variables generated in the object Bayes01 to the test dataset through the command predict, which generates the final contingency table. Like for the previous tables, we need to define rownames, colnames and margins to create a readable table. This is a key stylistic difference from Python.", "Once the contingency table is generated, we can assess the performance of the model vs. the baseline values stated in the a-priori computations. Globally, the model is accurate 50.4% of the times, which means only 1 out of 2 times the prediction would be correct like in our previous example. The model performs better in predicting the Below_500_Mill class compared to the baseline one (51.8% vs. 46.5%) whilst it performs slightly worse than the baseline model to predict the Above_500_Mill class (49.62% vs. 53.4%).", "Since the datasets are randomly generated, the only purpose of these results are illustrative. It remains critical to follow all steps underlined in the previous blogs to ensure relevant thematic expertise combined with a well-prepared dataframe that is set-up to yield a meaningful analysis.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Cultivating an interest in applying data science to international humanitarian work and social sciences."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb7a30e6a1715&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://nicola1giordano.medium.com/?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": ""}, {"url": "https://nicola1giordano.medium.com/?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": "Nicola Giordano"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fadb15a4025fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&user=Nicola+Giordano&userId=adb15a4025fb&source=post_page-adb15a4025fb----b7a30e6a1715---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb7a30e6a1715&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb7a30e6a1715&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/data-science-stylistics", "anchor_text": "Data"}, {"url": "https://analyticsprofile.com/wp-content/uploads/2019/06/naive-bayes-algorithm-1140x660.jpg", "anchor_text": "source 1"}, {"url": "https://upload.wikimedia.org/wikipedia/commons/c/c3/Python-logo-notext.svghttps://upload.wikimedia.org/wikipedia/commons/c/c3/Python-logo-notext.svg", "anchor_text": "source 2"}, {"url": "https://commons.wikimedia.org/wiki/File:R_logo.svg", "anchor_text": "source 3"}, {"url": "https://levelup.gitconnected.com/stylistic-differences-between-r-and-python-in-modelling-data-through-decision-trees-ea6f7c98e6e8", "anchor_text": "decision trees"}, {"url": "https://en.wikipedia.org/wiki/Thomas_Bayes#/media/File:Thomas_Bayes.gif", "anchor_text": "Wikipedia"}, {"url": "https://medium.com/tag/python?source=post_page-----b7a30e6a1715---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/r?source=post_page-----b7a30e6a1715---------------r-----------------", "anchor_text": "R"}, {"url": "https://medium.com/tag/programming?source=post_page-----b7a30e6a1715---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/bayes-theorem?source=post_page-----b7a30e6a1715---------------bayes_theorem-----------------", "anchor_text": "Bayes Theorem"}, {"url": "https://medium.com/tag/data-science-stylistics?source=post_page-----b7a30e6a1715---------------data_science_stylistics-----------------", "anchor_text": "Data Science Stylistics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb7a30e6a1715&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%25C3%25AFve-bayes-classifier-b7a30e6a1715&user=Nicola+Giordano&userId=adb15a4025fb&source=-----b7a30e6a1715---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb7a30e6a1715&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%25C3%25AFve-bayes-classifier-b7a30e6a1715&user=Nicola+Giordano&userId=adb15a4025fb&source=-----b7a30e6a1715---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb7a30e6a1715&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb7a30e6a1715&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b7a30e6a1715---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b7a30e6a1715--------------------------------", "anchor_text": ""}, {"url": "https://nicola1giordano.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://nicola1giordano.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Nicola Giordano"}, {"url": "https://nicola1giordano.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "32 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fadb15a4025fb&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&user=Nicola+Giordano&userId=adb15a4025fb&source=post_page-adb15a4025fb--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe1fd4032bc28&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fstylistic-differences-between-r-and-python-in-modelling-data-through-the-na%C3%AFve-bayes-classifier-b7a30e6a1715&newsletterV3=adb15a4025fb&newsletterV3Id=e1fd4032bc28&user=Nicola+Giordano&userId=adb15a4025fb&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}