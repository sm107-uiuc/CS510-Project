{"url": "https://towardsdatascience.com/query-metabase-data-in-python-ea7f866e6782", "time": 1683015260.964193, "path": "towardsdatascience.com/query-metabase-data-in-python-ea7f866e6782/", "webpage": {"metadata": {"title": "Query Metabase data in Python. Metabase rest API and Python API | by Sophia Yang | Towards Data Science", "h1": "Query Metabase data in Python", "description": "Metabase is an open-source BI tool, where you can store data, connect to outside data sources, query, and visualizing data. This article talks about when we have data stored in Metabase, how do we\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/mertsalik/metabasepy/blob/master/docs/guide.md", "anchor_text": "metabasepy", "paragraph_index": 10}, {"url": "https://github.com/mertsalik/metabasepy/blob/master/docs/guide.md", "anchor_text": "metabasepy", "paragraph_index": 12}, {"url": "http://twitter.com/sophiamyang", "anchor_text": "twitter.com/sophiamyang", "paragraph_index": 16}, {"url": "http://youtube.com/SophiaYangDS", "anchor_text": "youtube.com/SophiaYangDS", "paragraph_index": 16}, {"url": "http://dsbookclub.github.io", "anchor_text": "dsbookclub.github.io", "paragraph_index": 16}], "all_paragraphs": ["Metabase is an open-source BI tool, where you can store data, connect to outside data sources, query, and visualizing data. This article talks about when we have data stored in Metabase, how do we query the data and get results in Python. The first part of this article talks about how to use the Metabase rest API to query data. The second part tries out a Python API. Let\u2019s get started.", "To use the Metabase rest API, we first need to get a session token. In the command line type the following:", "The output will be your token. Then save this token in your Python script or Jupyter Notebooks.", "Alternatively, you can run the following in your Python script to get the token:", "There are two ways to query Metabase data. The first option is to query data from a card, or a question you asked on the UI. In the UI, we can ask a question and query the data directly through the UI:", "Once we have created the question, we can check if this question shows up in the api/card:", "The output shows a list of dictionaries, each of which corresponds to a question user asked through the UI. Then we can find the ID number of the card and get the result of the card with the following code. This basically queries the database with the query you defined in the card (question).", "Instead of defining the card first and querying the card, the second option is to query the database directly.", "Let\u2019s assume we want to query the table users from the database 1 and output all the rows that are created after 2020\u201310\u201315. Here we need to define this query in the SQL native query. And then added the query to the requests.post function. The resulting res.json() is a dictionary. To read in the data and the columns. We can get all the data from res.json()['data']['row'] , and then get the column names from res.json()['data']['results_metadata']['columns'] .", "Now you should be able to see the results of your query in df.", "I also tried out a Python API metabasepy. Similar to the Query card section we mentioned above, here we can query card 1 with the following code:", "I feel like the Python API is less flexible. But you are certainly welcome to try it out.", "Here I showed you three ways to query data from Metabase: query from the card using Metabase rest API, query directly from the database with a user-defined query using Metabase rest API, and query from the card using a Python API metabasepy.", "I prefer querying directly from the database with a user-defined query using Metabase rest API. With this method, we can have all our queries in the Python script and we know exactly what we are querying.", "There are also many other API calls available in Metabase we did not cover. The code in this article should be a good starting point for you to learn and explore other API functions. Hope you enjoy it! Thanks!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Ph.D. | Senior Data Scientist@Anaconda | Twitter: twitter.com/sophiamyang | YouTube: youtube.com/SophiaYangDS | Book Club: dsbookclub.github.io"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fea7f866e6782&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://sophiamyang.medium.com/?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": ""}, {"url": "https://sophiamyang.medium.com/?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": "Sophia Yang"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fae9cae9cbcd2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&user=Sophia+Yang&userId=ae9cae9cbcd2&source=post_page-ae9cae9cbcd2----ea7f866e6782---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea7f866e6782&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea7f866e6782&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/mertsalik/metabasepy/blob/master/docs/guide.md", "anchor_text": "metabasepy"}, {"url": "https://github.com/mertsalik/metabasepy/blob/master/docs/guide.md", "anchor_text": "metabasepy"}, {"url": "https://github.com/metabase/metabase/wiki/Using-the-REST-API", "anchor_text": "metabase/metabaseThis guide should help answer some FAQs about using the Metabase REST API. Feel free to open an issue if you have any\u2026github.com"}, {"url": "https://stackoverflow.com/questions/50620095/is-it-possible-to-get-raw-data-from-a-metabase-mbql-sql-query-via-the-rest-api", "anchor_text": "Is it possible to get raw data from a Metabase MBQL / SQL query via the REST API?Is there a Metabase REST API that takes a MBQL/SQL query and returns the raw data? I can perform a MBQL query via the\u2026stackoverflow.com"}, {"url": "https://medium.com/tag/metabase?source=post_page-----ea7f866e6782---------------metabase-----------------", "anchor_text": "Metabase"}, {"url": "https://medium.com/tag/data-science?source=post_page-----ea7f866e6782---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----ea7f866e6782---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/api?source=post_page-----ea7f866e6782---------------api-----------------", "anchor_text": "API"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea7f866e6782&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&user=Sophia+Yang&userId=ae9cae9cbcd2&source=-----ea7f866e6782---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fea7f866e6782&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&user=Sophia+Yang&userId=ae9cae9cbcd2&source=-----ea7f866e6782---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea7f866e6782&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fea7f866e6782&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----ea7f866e6782---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----ea7f866e6782--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ea7f866e6782--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----ea7f866e6782--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----ea7f866e6782--------------------------------", "anchor_text": ""}, {"url": "https://sophiamyang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://sophiamyang.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Sophia Yang"}, {"url": "https://sophiamyang.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "3.8K Followers"}, {"url": "http://twitter.com/sophiamyang", "anchor_text": "twitter.com/sophiamyang"}, {"url": "http://youtube.com/SophiaYangDS", "anchor_text": "youtube.com/SophiaYangDS"}, {"url": "http://dsbookclub.github.io", "anchor_text": "dsbookclub.github.io"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fae9cae9cbcd2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&user=Sophia+Yang&userId=ae9cae9cbcd2&source=post_page-ae9cae9cbcd2--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F74b7376b1b9e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fquery-metabase-data-in-python-ea7f866e6782&newsletterV3=ae9cae9cbcd2&newsletterV3Id=74b7376b1b9e&user=Sophia+Yang&userId=ae9cae9cbcd2&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}