{"url": "https://towardsdatascience.com/augmenting-training-data-for-image-recognition-c6b1a55f4b39", "time": 1683016647.110757, "path": "towardsdatascience.com/augmenting-training-data-for-image-recognition-c6b1a55f4b39/", "webpage": {"metadata": {"title": "Augmenting Your Training Data for Image Recognition | by Littleton Riggins | Towards Data Science", "h1": "Augmenting Your Training Data for Image Recognition", "description": "Image recognition technology has emerged to be one of the most popular applications for machine learning in recent years. Image recognition (IR) is often used to detect certain people/places/things\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scryfall.com", "anchor_text": "Scryfall", "paragraph_index": 4}, {"url": "https://augmentor.readthedocs.io/en/master/index.html", "anchor_text": "Augmentor", "paragraph_index": 5}, {"url": "https://augmentor.readthedocs.io/en/master/code.html#module-Augmentor.Operations", "anchor_text": "operations", "paragraph_index": 9}, {"url": "https://augmentor.readthedocs.io/en/master/code.html#Augmentor.Pipeline.Pipeline.crop_random", "anchor_text": "crop", "paragraph_index": 11}, {"url": "https://augmentor.readthedocs.io/en/master/index.html", "anchor_text": "Augmentor", "paragraph_index": 14}, {"url": "https://company.wizards.com/fancontentpolicy", "anchor_text": "Wizards\u2019 Fan Content Policy", "paragraph_index": 15}, {"url": "https://twitter.com/Triple_Equals", "anchor_text": "https://twitter.com/Triple_Equals", "paragraph_index": 17}], "all_paragraphs": ["Image recognition technology has emerged to be one of the most popular applications for machine learning in recent years. Image recognition (IR) is often used to detect certain people/places/things inside another, larger image. IR has proven useful for tasks like brand detection, crime prevention, and search result optimization.", "IR works through rigorous training of a machine learning model. Every object that needs to be detected is shown to the model in a series of images that act as the training data. The training data consists of many different pictures of the same object in different angles and surroundings, isolating the object of interest.", "Models get stronger the more varied and numerous the training data. For common objects, such as apples, there are a plethora of training images available so that anyone with a search engine can easily generate the proper amount of training data. Obtaining copious amounts of training data is a necessity because it can take thousands of images to properly train an IR machine learning model. But a problem arises when the objects of interest are more specialized and lacking in reference images - how does one obtain enough training data?", "Suppose we wanted to build an application that could detect a certain Magic: The Gathering card in a user\u2019s photo \u2014", "We can get the original source image from a Magic: The Gathering database such as Scryfall, but this image alone is not enough for training. We will need several variations of this card image, which can be especially difficult to get if we don\u2019t have a physical copy of this card. Instead of trying to buy the card, take several pictures with our camera, and then upload and organize those images, we can take a more programmatic approach.", "Data augmentation is one way to generate a sufficient supply of training images. Starting with a single image, we can apply pre-built image manipulation algorithms to our source and generate new images that can be used in the training process. If you\u2019re familiar with Python, you can use the Augmentor library to generate new images. Augmentor allows you to specify the number and type of manipulations you want for each of your source images and then save them as new local files.", "We can use Augmentor to generate some new Thieving Otters with the following Python snippet \u2014", "With thieving_otter.jpg in the \u201cinput\u201d folder, this script will generate 100 randomized and slightly different images that represent the source at various angles and under various lighting conditions.", "Augmentor works as a pipeline that processes images in the input folder a certain number of times. In our example on line 35, we will generate 100 images. During each processing run, Augmentor examines the operations assigned to it and will have a chance of applying that operation to the source image. A new image may have all or none of the operations executed upon it. Each operation also has a scale for which it will be applied. For example on lines 19 & 20, we define that the \u201crotate_without_crop\u201d operation can turn the source image no more than 10 degrees in either direction.", "The Augmentor library has a plethora of operations that you can apply to your image, but which operations you need will depend upon your use case. The idea is to make manipulations that will look similar to expected images from your users.", "Suppose the images we\u2019re trying to scan are coming from people\u2019s phones, and are coming from a hypothetical card scanning app. Users are told by the app to take their phone, point it at some Magic cards, hold still, and take a picture. If this is the scenario we\u2019ll be operating under, we can be reasonably sure we\u2019ll have relatively clean pictures to scan through. As such, we can use the following operations to mimic these conditions \u2014", "The combination of these operations at relatively low thresholds can be used to reproduce a \u201chome lighting\u201d type scenario. We\u2019ve left out operators that trim or crop the image because nobody will ever have a \u201cpiece of a card\u201d to scan, the whole image will always be present. In the example, we\u2019ve also made the upper and lower bounds of each operation relatively small, since we\u2019re expecting the cards will be scanned in a controlled environment. We don\u2019t expect users to be taking pictures of the cards upside down, with a bright sun-lamp glaring at the cards, or at an extreme angle. If these were possible conditions for our use case, we could change the values on our operations quite easily.", "After running our script, the \u201coutput\u201d folder will have 100 randomized images that we can feed into any machine learning model.", "Once these images are fed to the machine learning tool of your choice, you can run the script again and again comparing the results and tweaking your mutations until you get a high match percentage with your own scans. For example, some of the above images are skewed quite heavily, so we might consider lowering the skew values since we expect our users to be scanning cards that are laying flat on a table. Making this change would likely increase the match rate of our image scanner.", "There are many different ways to gather training data for machine learning, and data augmentation is only one such method. The Augmentor Python library is easy to use and a great tool for generating a large number of augmented images. Experiment with the operations and build whatever fits your needs. Happy coding!", "Magic: The Gathering and any related content or imagery is owned by Wizards of the Coast and was used in accordance with Wizards\u2019 Fan Content Policy.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "UX Engineering @ Google | Web Apps | Prototyping | MTG https://twitter.com/Triple_Equals"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc6b1a55f4b39&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://triple-equals.medium.com/?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": ""}, {"url": "https://triple-equals.medium.com/?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": "Littleton Riggins"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff08997feb6e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&user=Littleton+Riggins&userId=f08997feb6e1&source=post_page-f08997feb6e1----c6b1a55f4b39---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6b1a55f4b39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6b1a55f4b39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://storage.googleapis.com/openimages/web/index.html", "anchor_text": "Open Images"}, {"url": "https://scryfall.com", "anchor_text": "Scryfall"}, {"url": "https://augmentor.readthedocs.io/en/master/index.html", "anchor_text": "Augmentor"}, {"url": "https://augmentor.readthedocs.io/en/master/code.html#module-Augmentor.Operations", "anchor_text": "operations"}, {"url": "https://augmentor.readthedocs.io/en/master/code.html#module-Augmentor.Operations", "anchor_text": "rotate_without_crop"}, {"url": "https://augmentor.readthedocs.io/en/master/code.html#module-Augmentor.Operations", "anchor_text": "zoom"}, {"url": "https://augmentor.readthedocs.io/en/master/code.html#module-Augmentor.Operations", "anchor_text": "skew"}, {"url": "https://augmentor.readthedocs.io/en/master/code.html#module-Augmentor.Operations", "anchor_text": "random_brightness"}, {"url": "https://augmentor.readthedocs.io/en/master/code.html#Augmentor.Pipeline.Pipeline.crop_random", "anchor_text": "crop"}, {"url": "https://augmentor.readthedocs.io/en/master/index.html", "anchor_text": "Augmentor"}, {"url": "https://company.wizards.com/fancontentpolicy", "anchor_text": "Wizards\u2019 Fan Content Policy"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c6b1a55f4b39---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----c6b1a55f4b39---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----c6b1a55f4b39---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/image-recognition?source=post_page-----c6b1a55f4b39---------------image_recognition-----------------", "anchor_text": "Image Recognition"}, {"url": "https://medium.com/tag/magic-the-gathering?source=post_page-----c6b1a55f4b39---------------magic_the_gathering-----------------", "anchor_text": "Magic The Gathering"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6b1a55f4b39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&user=Littleton+Riggins&userId=f08997feb6e1&source=-----c6b1a55f4b39---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc6b1a55f4b39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&user=Littleton+Riggins&userId=f08997feb6e1&source=-----c6b1a55f4b39---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc6b1a55f4b39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc6b1a55f4b39&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c6b1a55f4b39---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c6b1a55f4b39--------------------------------", "anchor_text": ""}, {"url": "https://triple-equals.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://triple-equals.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Littleton Riggins"}, {"url": "https://triple-equals.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "10 Followers"}, {"url": "https://twitter.com/Triple_Equals", "anchor_text": "https://twitter.com/Triple_Equals"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff08997feb6e1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&user=Littleton+Riggins&userId=f08997feb6e1&source=post_page-f08997feb6e1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Ff08997feb6e1%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Faugmenting-training-data-for-image-recognition-c6b1a55f4b39&user=Littleton+Riggins&userId=f08997feb6e1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}