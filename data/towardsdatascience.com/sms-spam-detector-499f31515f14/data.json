{"url": "https://towardsdatascience.com/sms-spam-detector-499f31515f14", "time": 1683002372.483118, "path": "towardsdatascience.com/sms-spam-detector-499f31515f14/", "webpage": {"metadata": {"title": "Building the SMS spam detector. Brace yourselves the spam is coming | by Harsh Darji | Towards Data Science", "h1": "Building the SMS spam detector", "description": "In this blog post, we are going to develop an SMS spam detector using logistic regression and pySpark. We will predict whether an SMS text is spam or not. This was one of the first use cases of data\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/harshdarji23/Sms-spam-detector/blob/master/sms_span_df.csv", "anchor_text": "here", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/hacking-scikit-learns-vectorizers-9ef26a7170af", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://scikit-learn.org/stable/modules/feature_extraction.html#text-feature-extraction", "anchor_text": "here", "paragraph_index": 6}, {"url": "https://medium.com/@shivangisareen/tfidf-7b29017dcdd", "anchor_text": "this", "paragraph_index": 7}, {"url": "https://medium.com/analytics-vidhya/logistic-regression-simplified-a038de4a8143", "anchor_text": "this", "paragraph_index": 8}, {"url": "https://towardsdatascience.com/5-reasons-why-you-should-use-cross-validation-in-your-data-science-project-8163311a1e79", "anchor_text": "cross-validation", "paragraph_index": 9}, {"url": "https://spark.apache.org/docs/2.0.2/ml-features.html#maxabsscaler", "anchor_text": "MaxAbsScaler", "paragraph_index": 15}], "all_paragraphs": ["In this blog post, we are going to develop an SMS spam detector using logistic regression and pySpark. We will predict whether an SMS text is spam or not. This was one of the first use cases of data science and is still widely used to filter emails.", "Dataset: Text file can be downloaded from here. This is what our dataset looks like:", "We are using pySpark for distributed computing and we will create a machine learning pipeline to automate the workflow. We see that the \u201ctype\u201d column contains categorical data, so the first step is to convert the contents of the \u201ctype\u201d column to numeric attributes. We encode because logistic regression cannot operate with categorical data.", "Now, we will create a pipeline that will combine a Tokenizer, CounterVectorizer, and an IDF estimator to compute the TF-IDF vectors of each SMS.", "Tokenizer: It creates words(tokens) from sentences for each SMS", "Countvectorizer: It counts the number of times a token shows up in the document and uses this value as its weight.", "TF-IDF Vectorizer: TF-IDF stands for \u201cterm frequency-inverse document frequency\u201d, meaning the weight assigned to each token not only depends on its frequency in a document but also how recurrent that term is in the entire corpora. You can read more about it here and here.", "To understand why we use TF-IDF, read this post on medium.", "Now that we have our sentences in TF-IDF form, let us create ML pipelines where the first stage is the tfidf_pipeline created above and the second stage is a LogisticRegression model with different regularization parameters (\ud835\udf06) and elastic net mixture (\ud835\udefc). To know more about regularization and the math behind logistic regression, please read this article.", "We use cross-validation because it helps us better use our data, and it gives much more information about our algorithm\u2019s performance.", "We see that model 2 with pipeline lr_pipeline2 containing regParam=0.02, elasticNetParam=0.2 performs best on the validation data so we fit this pipeline to our test data and find out it\u2019s AUC on test data.", "Now we will use the pipeline 2 fitted above (lr_pipeline2) to create Pandas data frames that contain the most negative words and the most positive words.", "We converted our text into tokens and TF-IDF vectors, played around with parameters of logistic regression, and evaluated our model using AUC metric on the validation data. Finally, based on the performance of the model on the validation data, we fitted the model on the test data, and measured the model\u2019s performance. Thus, we developed a spam detector using regularized logistic regression.", "The performance of the model can be improved by feature engineering on the data. Typical spam messages contain words that are upper case. So we create a data frame sms_spam3_df where we add a new column has_uppercase which contains an integer 1 if the first sequence of uppercase letters is longer or equal to 3 and an integer 0 otherwise.", "Let\u2019s see what our data frame looks like:", "Now, that we have two columns of text, and has_uppercase, we have to tokenize and create TF-IDF of the text and then merge with has_uppercaase column using vector assembler. We create a pipeline that will merge the two columns, perform feature scaling using MaxAbsScaler, and run a logistic regression model (lr2 regularization parameter \ud835\udf06=0.2 and elastic net mixture \ud835\udefc=0.1) that performs best on the above data frame.", "We fetch the coefficient of has_uppercase feature from the pipeline and it comes out to be 0.9289. Thus, has_uppercase is positively related to an SMS being spam.", "The max-coefficient of Tfidf comes out to be 2,01, so the ratio of the coefficient of has_uppercase to the biggest positive tfidf coefficient is 0.46", "Thank you for reading! Feedbacks are highly appreciated", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Illustrator & Writer sharing insights on self-discovery and human potential. Currently writing The Daily Visuals \ud83d\udcd5"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F499f31515f14&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----499f31515f14--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----499f31515f14--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://harsh-darji.medium.com/?source=post_page-----499f31515f14--------------------------------", "anchor_text": ""}, {"url": "https://harsh-darji.medium.com/?source=post_page-----499f31515f14--------------------------------", "anchor_text": "Harsh Darji"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F703114a951d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&user=Harsh+Darji&userId=703114a951d3&source=post_page-703114a951d3----499f31515f14---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F499f31515f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F499f31515f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/images/id-4009691/", "anchor_text": "https://pixabay.com/images/id-4009691/"}, {"url": "https://github.com/harshdarji23/Sms-spam-detector/blob/master/sms_span_df.csv", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/hacking-scikit-learns-vectorizers-9ef26a7170af", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/feature_extraction.html#text-feature-extraction", "anchor_text": "here"}, {"url": "https://medium.com/@shivangisareen/tfidf-7b29017dcdd", "anchor_text": "this"}, {"url": "https://medium.com/analytics-vidhya/logistic-regression-simplified-a038de4a8143", "anchor_text": "this"}, {"url": "https://towardsdatascience.com/5-reasons-why-you-should-use-cross-validation-in-your-data-science-project-8163311a1e79", "anchor_text": "cross-validation"}, {"url": "https://spark.apache.org/docs/2.0.2/ml-features.html#maxabsscaler", "anchor_text": "MaxAbsScaler"}, {"url": "https://medium.com/tag/data-science?source=post_page-----499f31515f14---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----499f31515f14---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----499f31515f14---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/nlp?source=post_page-----499f31515f14---------------nlp-----------------", "anchor_text": "NLP"}, {"url": "https://medium.com/tag/big-data?source=post_page-----499f31515f14---------------big_data-----------------", "anchor_text": "Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F499f31515f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&user=Harsh+Darji&userId=703114a951d3&source=-----499f31515f14---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F499f31515f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&user=Harsh+Darji&userId=703114a951d3&source=-----499f31515f14---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F499f31515f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----499f31515f14--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F499f31515f14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----499f31515f14---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----499f31515f14--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----499f31515f14--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----499f31515f14--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----499f31515f14--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----499f31515f14--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----499f31515f14--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----499f31515f14--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----499f31515f14--------------------------------", "anchor_text": ""}, {"url": "https://harsh-darji.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://harsh-darji.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Harsh Darji"}, {"url": "https://harsh-darji.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "2.8K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F703114a951d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&user=Harsh+Darji&userId=703114a951d3&source=post_page-703114a951d3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdeca08ab9ae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fsms-spam-detector-499f31515f14&newsletterV3=703114a951d3&newsletterV3Id=deca08ab9ae1&user=Harsh+Darji&userId=703114a951d3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}