{"url": "https://towardsdatascience.com/longform-audio-classification-in-fastaudio-76d81825d29b", "time": 1683018031.225111, "path": "towardsdatascience.com/longform-audio-classification-in-fastaudio-76d81825d29b/", "webpage": {"metadata": {"title": "Longform Audio Classification in Fastaudio | by Neel Iyer | Towards Data Science", "h1": "Longform Audio Classification in Fastaudio", "description": "Lately I\u2019ve been watching a lot of comedy clips on youtube. They\u2019re usually uncensored- unless it\u2019s on comedy central. The clips on comedy central got me thinking. Presumably someone has to manually\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.reddit.com/r/IASIP/comments/18s4kn/why_the_hell_does_comedy_central_have_to_censor/", "anchor_text": "comedy central", "paragraph_index": 1}, {"url": "https://www.youtube.com/watch?v=fYqzD88x734&ab_channel=LearnHowToEditStuff", "anchor_text": "manually", "paragraph_index": 2}, {"url": "https://www.kaggle.com/c/birdsong-recognition/overview", "anchor_text": "attention", "paragraph_index": 4}, {"url": "https://pytorch.org/tutorials/intermediate/speech_command_recognition_with_torchaudio.html", "anchor_text": "pytorch tutorial", "paragraph_index": 5}, {"url": "https://github.com/fastaudio/fastaudio", "anchor_text": "fastaudio", "paragraph_index": 5}, {"url": "https://github.com/theabuseproject/tapad", "anchor_text": "github", "paragraph_index": 9}, {"url": "https://www.tensorflow.org/datasets/catalog/speech_commands", "anchor_text": "speech commands dataset", "paragraph_index": 10}, {"url": "https://spiyer99.github.io/Auto-Censoring-Swear-Words-using-Fastaudio/", "anchor_text": "same article", "paragraph_index": 18}, {"url": "https://forums.fast.ai/t/fastai-v2-audio/53535/99", "anchor_text": "voice audio", "paragraph_index": 23}, {"url": "https://pytorch.org/tutorials/intermediate/speech_command_recognition_with_torchaudio.html#formatting-the-data", "anchor_text": "good idea", "paragraph_index": 23}, {"url": "https://builtin.com/data-science/transfer-learning#:~:text=Transfer%20learning%20has%20several%20benefits,needing%20a%20lot%20of%20data.", "anchor_text": "useful", "paragraph_index": 27}, {"url": "https://www.youtube.com/watch?v=OJINY9Tz2qA", "anchor_text": "clip", "paragraph_index": 31}, {"url": "https://spiyer99.github.io/Auto-Censoring-Swear-Words-using-Fastaudio/", "anchor_text": "same article", "paragraph_index": 34}, {"url": "https://www.youtube.com/watch?v=RPfCZhvj1Ng", "anchor_text": "this one", "paragraph_index": 35}, {"url": "https://spiyer99.github.io/Auto-Censoring-Swear-Words-using-Fastaudio/", "anchor_text": "same article", "paragraph_index": 38}, {"url": "https://twitter.com/neeliyer11", "anchor_text": "twitter", "paragraph_index": 42}, {"url": "https://github.com/spiyer99/spiyer99.github.io/blob/master/nbs/swear_word_detection.ipynb", "anchor_text": "Github", "paragraph_index": 43}], "all_paragraphs": ["Can you automatically bleep someone on TV when they swear?", "Lately I\u2019ve been watching a lot of comedy clips on youtube. They\u2019re usually uncensored- unless it\u2019s on comedy central.", "The clips on comedy central got me thinking. Presumably someone has to manually go through the video and bleep out the swear words. Why couldn\u2019t we do this using deep learning?", "It\u2019s an interesting idea. And I stupidly thought it would be easy. It did not turn out to be easy at all.", "Audio classification has been getting a lot of attention on kaggle. But so far it\u2019s been focused on short audio samples (less than a 30 seconds or so). I couldn\u2019t find a lot of information out there on longer audio samples.", "So in this article I\u2019ll describe my initial attempt at this idea. I\u2019ll be borrowing ideas and code from a pytorch tutorial and the fastaudio repository.", "First we\u2019ll need to install a few things", "I really like ipython-autotime. It automatically lets me know how long cells take to run. So there's no need to run a %%time in each cell.", "Now we can create the dataset.", "After a lot of searching I managed to find a swear word dataset that was somewhat suitable for my purposes. I\u2019ll be using a dataset from \u2018the abuse project\u2019 which is available on github.", "Next I found a dataset that had \u201cclean\u201d audio. By clean I mean audio without swear words in it. I\u2019ll be using the speech commands dataset from google.", "As you can imagine there\u2019s a lot of data prep involved.", "We\u2019ll combine the audio from swear word dataset with the audio from the speech commands dataset. Then we\u2019ll group them into train and test folders.", "To make things really easy, we\u2019ll also create a train_df dataframe and a test_df dataframe. This will contain the name of each audio file and swear word tracker. A 1 means that this file contains a swear word. A 0 means this file does not have a swear word.", "The following code accomplishes all of that.", "Now we\u2019ll use the helper functions to create the train and test datasets as well as the associated dataframes.", "I\u2019ve used multiprocessing here to really speed things up. The parallel function from is incredibly useful and saves me a lot of time.", "Now we\u2019ll listen the a random sample of audio. Just to check we\u2019re on track.", "Note: to listen to the audio check out the same article on my blog", "Fastaudio is a cool library for fastai. Since I don\u2019t have a lot of domain knowledge in the field of audio I\u2019ll be using this library.", "We\u2019ll need a few helper functions.", "Now we can create the cross validation folds. We\u2019ll be using 5 folds.", "We\u2019ll extract the BasicMelSpectrogram with 512 fourier transforms. This seems to be the default config. We'll go with that for now.", "We\u2019ll resample all our files so that they are all 8kHZ. This should be good for voice audio.We\u2019ll also resize the signal so that all our audio tensors are the same size. In addition, I think that converting sound from stereo to mono may be a good idea.", "In fastaudio it\u2019s important to distinguish between item_tfms and batch_tfms. I made the mistake of confusing the two and got stuck on debugging for hours.", "The BasicMelSpectrogram is part of the batch transform. But ResizeSignal, Resample and DownmixMono are part of the item transforms. You want to resize, resample and downmix each individual item before it is part of the batch. Don't make the mistake I did!", "We can visualise a batch pretty easily in fastaudio.", "We\u2019ll be using transfer learning from a resnet18 model. Transfer learning has proved to be very useful.", "Next we\u2019ll run the training loop with a SaveModelCallback. This will allow us to save the best model automatically. We'll be tracking f1 score since our classes are imbalanced.", "The f1 score looks weirdly good!", "Finally we\u2019ll run our model on a longer form audio sample.", "I\u2019ll be using a clip from Minnie Driver\u2019s appearance on Conan. This contains a few swear words that weren\u2019t bleeped out. Again I\u2019ll be using parallel processing again here to really speed things up.", "First we\u2019ll split the audio files into smaller segments. I\u2019ve split things here into segments of about 0.2 seconds. That should be long enough to catch a swear word but short enough to be suitable for the classifier.", "We can listen to the audio samples to check we\u2019re on track.", "Note: to listen to the audio check out the same article on my blog", "Next we\u2019ll download a censor audio sound. I\u2019m using this one from youtube.", "Now we\u2019ll get the model to run a prediction on each audio file. If the model believes that the audio file contains a swear word then it will automatically censor it using the audio sound we downloaded from youtube.", "Cool let\u2019s listen and hear how it went. I ran into OOM issues when trying to play the entire file on jupyter notebook so I\u2019ll just embed a sample here.", "Note: to listen to the audio check out the same article on my blog", "This is really a just first step. It\u2019s not the finished product.", "I am by no means an expert on this topic. I just thought this would make for an interesting project to build.", "Deep Learning for audio is a fairly new field. And probably as a result I couldn\u2019t really find a lot of help out there on the internet. I hope this article proves useful to someone out there. It certainly would\u2019ve helped me when I initially started this project.", "If I\u2019ve made a mistake or you\u2019d like to reach out to me please contact me on twitter.", "The full jupyter notebook can be found on Github", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F76d81825d29b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----76d81825d29b--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----76d81825d29b--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://neel-iyer.medium.com/?source=post_page-----76d81825d29b--------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=post_page-----76d81825d29b--------------------------------", "anchor_text": "Neel Iyer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe7c5e1c9cae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&user=Neel+Iyer&userId=e7c5e1c9cae1&source=post_page-e7c5e1c9cae1----76d81825d29b---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76d81825d29b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76d81825d29b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-on Tutorials"}, {"url": "https://www.reddit.com/r/IASIP/comments/18s4kn/why_the_hell_does_comedy_central_have_to_censor/", "anchor_text": "comedy central"}, {"url": "http://www.cc.com/", "anchor_text": "Comedy Central"}, {"url": "https://www.youtube.com/watch?app=desktop&v=edwvY6xBo4Y&ab_channel=ComedyCentral", "anchor_text": "Youtube"}, {"url": "https://www.youtube.com/watch?v=fYqzD88x734&ab_channel=LearnHowToEditStuff", "anchor_text": "manually"}, {"url": "https://www.kaggle.com/c/birdsong-recognition/overview", "anchor_text": "attention"}, {"url": "https://pytorch.org/tutorials/intermediate/speech_command_recognition_with_torchaudio.html", "anchor_text": "pytorch tutorial"}, {"url": "https://github.com/fastaudio/fastaudio", "anchor_text": "fastaudio"}, {"url": "https://github.com/theabuseproject/tapad", "anchor_text": "github"}, {"url": "https://www.tensorflow.org/datasets/catalog/speech_commands", "anchor_text": "speech commands dataset"}, {"url": "https://spiyer99.github.io/Auto-Censoring-Swear-Words-using-Fastaudio/", "anchor_text": "same article"}, {"url": "https://forums.fast.ai/t/fastai-v2-audio/53535/99", "anchor_text": "voice audio"}, {"url": "https://pytorch.org/tutorials/intermediate/speech_command_recognition_with_torchaudio.html#formatting-the-data", "anchor_text": "good idea"}, {"url": "https://builtin.com/data-science/transfer-learning#:~:text=Transfer%20learning%20has%20several%20benefits,needing%20a%20lot%20of%20data.", "anchor_text": "useful"}, {"url": "http://twitter.com/skip_if_ci", "anchor_text": "@skip_if_ci"}, {"url": "https://www.youtube.com/watch?v=OJINY9Tz2qA", "anchor_text": "clip"}, {"url": "https://www.youtube.com/watch?v=OJINY9Tz2qA", "anchor_text": "https://www.youtube.com/watch?v=OJINY9Tz2qA"}, {"url": "https://spiyer99.github.io/Auto-Censoring-Swear-Words-using-Fastaudio/", "anchor_text": "same article"}, {"url": "https://www.youtube.com/watch?v=RPfCZhvj1Ng", "anchor_text": "this one"}, {"url": "https://www.youtube.com/watch?v=RPfCZhvj1Ng", "anchor_text": "https://www.youtube.com/watch?v=RPfCZhvj1Ng"}, {"url": "https://superuser.com/questions/587511/concatenate-multiple-wav-files-using-single-command-without-extra-file", "anchor_text": "https://superuser.com/questions/587511/concatenate-multiple-wav-files-using-single-command-without-extra-file"}, {"url": "https://spiyer99.github.io/Auto-Censoring-Swear-Words-using-Fastaudio/", "anchor_text": "same article"}, {"url": "https://twitter.com/neeliyer11", "anchor_text": "twitter"}, {"url": "https://github.com/spiyer99/spiyer99.github.io/blob/master/nbs/swear_word_detection.ipynb", "anchor_text": "Github"}, {"url": "https://spiyer99.github.io/Auto-Censoring-Swear-Words-using-Fastaudio/", "anchor_text": "https://spiyer99.github.io"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----76d81825d29b---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----76d81825d29b---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/audio-classification?source=post_page-----76d81825d29b---------------audio_classification-----------------", "anchor_text": "Audio Classification"}, {"url": "https://medium.com/tag/fastai?source=post_page-----76d81825d29b---------------fastai-----------------", "anchor_text": "Fastai"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----76d81825d29b---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F76d81825d29b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&user=Neel+Iyer&userId=e7c5e1c9cae1&source=-----76d81825d29b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F76d81825d29b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&user=Neel+Iyer&userId=e7c5e1c9cae1&source=-----76d81825d29b---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76d81825d29b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----76d81825d29b--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F76d81825d29b&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----76d81825d29b---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----76d81825d29b--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----76d81825d29b--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----76d81825d29b--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----76d81825d29b--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----76d81825d29b--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----76d81825d29b--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----76d81825d29b--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----76d81825d29b--------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://neel-iyer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Neel Iyer"}, {"url": "https://neel-iyer.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "418 Followers"}, {"url": "https://www.linkedin.com/in/neel-iyer/", "anchor_text": "https://www.linkedin.com/in/neel-iyer/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe7c5e1c9cae1&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&user=Neel+Iyer&userId=e7c5e1c9cae1&source=post_page-e7c5e1c9cae1--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa4687e9ccf6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flongform-audio-classification-in-fastaudio-76d81825d29b&newsletterV3=e7c5e1c9cae1&newsletterV3Id=a4687e9ccf6&user=Neel+Iyer&userId=e7c5e1c9cae1&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}