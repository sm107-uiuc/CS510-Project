{"url": "https://towardsdatascience.com/how-to-create-your-own-deep-learning-project-in-azure-509660d8297", "time": 1682995794.179289, "path": "towardsdatascience.com/how-to-create-your-own-deep-learning-project-in-azure-509660d8297/", "webpage": {"metadata": {"title": "How to create your own Deep Learning Project in Azure | by Ren\u00e9 Bremer | Towards Data Science", "h1": "How to create your own Deep Learning Project in Azure", "description": "Deep learning has a lot of practical applications for companies such as image recognition, video indexing and speech to text transcription. However, it can be daunting for companies to start with\u2026"}, "outgoing_paragraph_urls": [{"url": "https://azure.microsoft.com/en-us/services/cognitive-services/computer-vision/", "anchor_text": "computer vision APIs", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/how-to-bring-your-data-science-project-in-production-b36ae4c02b46", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/how-to-embed-security-in-your-azure-data-science-project-55ef3f2ab47", "anchor_text": "here", "paragraph_index": 4}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR-10", "paragraph_index": 7}, {"url": "https://docs.azuredatabricks.net/user-guide/secrets/secret-scopes.html#create-an-azure-key-vault-backed-secret-scope", "anchor_text": "secret scope", "paragraph_index": 14}, {"url": "https://towardsdatascience.com/how-to-embed-security-in-your-azure-data-science-project-55ef3f2ab47", "anchor_text": "blog", "paragraph_index": 14}, {"url": "https://de.linkedin.com/in/ilona-stuhler", "anchor_text": "Ilona Stuhler", "paragraph_index": 34}], "all_paragraphs": ["Deep learning has a lot of practical applications for companies such as image recognition, video indexing and speech to text transcription. However, it can be daunting for companies to start with deep learning projects. Common issues are sensitivity of data used and the complexity of deep learning, which can be seen as the superlative of machine learning.", "In this tutorial, a sample deep learning project is created that is able to recognize classes of pictures using the CIFAR-10 dataset (plane, frog, ship). In this, the following steps are executed:", "This can be depicted in the following architecture overview:", "Key in this solution is Azure Databricks, which is an Apache Spark-based analytics platform optimized for Azure. It natively integrates with other Azure services such as Azure Active Directory and Azure Storage. In the remainder of this blog, the following steps will be executed:", "It is a standalone tutorial in which the focus is to set up your own deep learning project in Azure, to \u201cget your hands dirty\u201d and so to get more familiar with subject. The focus is less on the internal working of deep learning, latest algorithms or computer vision APIs. In case you more interested in devops for AI, refer to my previous blogs, here and with focus on security, see here.", "The following resources need to be created in the same resource group and in the same location.", "The following steps will be executed in this part.", "In this tutorial the CIFAR-10 data is used to train the deep learning model. In the first model, a subset of 2000 pictures will be used. Subsequently, a second model will be created that uses the full CIFAR-10 dataset of 60000 pictures.", "To illustrate how to use Azure Storage in combination with Azure Databricks, the subset of 2000 pictures will be stored in the storage account. Therefore, go to the following URL to download a subset of 2000 pictures in a zip file.", "Subsequently, go to the Azure portal and select your storage account. Then select blobs and create a new container named \u201c2000picscifar10\u201d. Subsequently, upload in the zip file you downloaded earlier into your container.", "Finally, go to Access Keys and copy the key or your storage account.", "Go to your Azure Databricks workspace and go to Cluster. Since the model will be trained on the driver node without using Spark jobs, it is not needed to create (and pay for) worker nodes. Therefore, create a new GPU cluster with the following settings:", "Go to your Azure Databricks workspace, right-click and then select import. In the radio button, select to import the following notebook using URL:", "Open your nodebook and change the following settings", "Notice that keys shall never be stored in a notebook in a production situation. Instead, secret scope shall be used, see also my blog how to embed security in data science projects. Then attach notebook to cluster you created and then click SHIFT+ENTER to run to it cell by cell.", "In this notebook the following steps will be excuted:", "Go to your Azure Databricks workspace again, right-click and then select import. In the radio button, select to import the following notebook using URL:", "In this notebook the following steps will be excuted:", "When you run the notebook succesfully, you can see an overview of the predictions (red are wrong predictions).", "Running GPU clusters can be costly. Since we do not need the GPU cluster in the remaining of this tutorial, we can stop it. Therefore, go to your cluster and select terminate.", "The following steps will be executed in this part.", "In this step, a new cluster is created that will be used to deploy our model. Since the model is already trained, we don\u2019t need GPUs anymore. Select a cluster with the following settings", "To deploy our model, we need a couple of libraries. Go to your shared folder, right click in the shared and select to \u201ccreate library\u201d.", "Subsequently, select Pypi and add the following libraries to shared folder:", "In this step, the model and its metrics wil be added to your Azure ML service workspace. Import the following notebook in your Azure Databricks workspace.", "Open your nodebook and change the following settings of your Azure ML service workspace (subscription id can be found in the overview tab of you Azure ML service workspace instance).", "Then run the notebook, again using Shift+Enter to go through it cell by cell. In this notebook the following steps will be excuted:", "To view the metrics, go the portal, select Azure Machine Learning Workspace and then Expirement, see below", "Import the following notebook in your workspace", "Again, change the parameters similar as in step 5c. In this notebook, an endpoint is created of the model that was trained on all pictures. When you go to portal, select Azure Container Instance, you will find the IP adress of the endpoint.", "To test the endpoint, the following steps will be done:", "The following picture shows a picture of a ship, converted to base64 and sent with Postman to create prediction using endpoint.", "In this tutorial, a deep learning project was created in which the following services were used:", "Deep learning has a lot of practical applications for enterprises. However, it can be daunting for enterprises to start with deep learning projects. Creating your own sample project and \u201cgetting you hands dirty\u201d is a great way to learn and to get more familiar with the subject.", "Finally, big thanks to my colleague Ilona Stuhler who was so kind to provide me crucial insides in the subject and to donate her project to me.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data Solution Architect @ Microsoft, working with Azure services as ADFv2, ADLSgen2, Azure DevOps, Databricks, Function Apps and SQL. Opinions here are mine."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F509660d8297&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----509660d8297--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----509660d8297--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://rebremer.medium.com/?source=post_page-----509660d8297--------------------------------", "anchor_text": ""}, {"url": "https://rebremer.medium.com/?source=post_page-----509660d8297--------------------------------", "anchor_text": "Ren\u00e9 Bremer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11e5e7fb3771&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&user=Ren%C3%A9+Bremer&userId=11e5e7fb3771&source=post_page-11e5e7fb3771----509660d8297---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F509660d8297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F509660d8297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://azure.microsoft.com/en-us/services/cognitive-services/computer-vision/", "anchor_text": "computer vision APIs"}, {"url": "https://towardsdatascience.com/how-to-bring-your-data-science-project-in-production-b36ae4c02b46", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/how-to-embed-security-in-your-azure-data-science-project-55ef3f2ab47", "anchor_text": "here"}, {"url": "https://docs.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-quickstart-create-account?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json#create-an-account-using-azure-cli", "anchor_text": "Azure Storage Account"}, {"url": "https://docs.azuredatabricks.net/getting-started/try-databricks.html#step-2-create-a-databricks-workspace", "anchor_text": "Azure Databricks Workspace"}, {"url": "https://docs.microsoft.com/en-us/azure/machine-learning/service/quickstart-get-started", "anchor_text": "Azure Machine Learning Service"}, {"url": "https://www.cs.toronto.edu/~kriz/cifar.html", "anchor_text": "CIFAR-10"}, {"url": "https://github.com/rebremer/devopsai_databricks/raw/master/sampledata/2000pics_cifar10.zip", "anchor_text": "https://github.com/rebremer/devopsai_databricks/raw/master/sampledata/2000pics_cifar10.zip"}, {"url": "https://raw.githubusercontent.com/rebremer/devopsai_databricks/master/project/modelling/0_mountStorage.py", "anchor_text": "https://raw.githubusercontent.com/rebremer/devopsai_databricks/master/project/modelling/0_mountStorage.py"}, {"url": "https://docs.azuredatabricks.net/user-guide/secrets/secret-scopes.html#create-an-azure-key-vault-backed-secret-scope", "anchor_text": "secret scope"}, {"url": "https://towardsdatascience.com/how-to-embed-security-in-your-azure-data-science-project-55ef3f2ab47", "anchor_text": "blog"}, {"url": "https://github.com/rebremer/devopsai_databricks/blob/master/project/modelling/1_DeepLearningCifar10NotebookExploration.py", "anchor_text": "https://github.com/rebremer/devopsai_databricks/blob/master/project/modelling/1_DeepLearningCifar10NotebookExploration.py"}, {"url": "https://raw.githubusercontent.com/rebremer/devopsai_databricks/master/project/modelling/2a_Cifar10KerasNotebookLogModel.py", "anchor_text": "https://raw.githubusercontent.com/rebremer/devopsai_databricks/master/project/modelling/2a_Cifar10KerasNotebookLogModel.py"}, {"url": "https://raw.githubusercontent.com/rebremer/devopsai_databricks/master/project/modelling/2b_Cifar10KerasNotebookDeployModel.py", "anchor_text": "https://raw.githubusercontent.com/rebremer/devopsai_databricks/master/project/modelling/2b_Cifar10KerasNotebookDeployModel.py"}, {"url": "https://onlinepngtools.com/convert-png-to-base64", "anchor_text": "website"}, {"url": "https://www.getpostman.com/", "anchor_text": "Postman"}, {"url": "https://onlinepngtools.com/convert-png-to-base64", "anchor_text": "https://onlinepngtools.com/convert-png-to-base64"}, {"url": "https://de.linkedin.com/in/ilona-stuhler", "anchor_text": "Ilona Stuhler"}, {"url": "https://medium.com/tag/azure?source=post_page-----509660d8297---------------azure-----------------", "anchor_text": "Azure"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----509660d8297---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----509660d8297---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/keras?source=post_page-----509660d8297---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/databricks?source=post_page-----509660d8297---------------databricks-----------------", "anchor_text": "Databricks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F509660d8297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&user=Ren%C3%A9+Bremer&userId=11e5e7fb3771&source=-----509660d8297---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F509660d8297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&user=Ren%C3%A9+Bremer&userId=11e5e7fb3771&source=-----509660d8297---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F509660d8297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----509660d8297--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F509660d8297&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----509660d8297---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----509660d8297--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----509660d8297--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----509660d8297--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----509660d8297--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----509660d8297--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----509660d8297--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----509660d8297--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----509660d8297--------------------------------", "anchor_text": ""}, {"url": "https://rebremer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://rebremer.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ren\u00e9 Bremer"}, {"url": "https://rebremer.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "731 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11e5e7fb3771&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&user=Ren%C3%A9+Bremer&userId=11e5e7fb3771&source=post_page-11e5e7fb3771--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fed36bca8eb16&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-create-your-own-deep-learning-project-in-azure-509660d8297&newsletterV3=11e5e7fb3771&newsletterV3Id=ed36bca8eb16&user=Ren%C3%A9+Bremer&userId=11e5e7fb3771&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}