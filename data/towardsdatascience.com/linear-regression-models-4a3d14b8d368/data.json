{"url": "https://towardsdatascience.com/linear-regression-models-4a3d14b8d368", "time": 1683002414.939719, "path": "towardsdatascience.com/linear-regression-models-4a3d14b8d368/", "webpage": {"metadata": {"title": "Linear Regression Models in Python | Towards Data Science", "h1": "Linear Regression Models", "description": "This article discusses the basics of linear regression using Python and SciKit-Learn, including ordinary least squares, ridge, lasso, and elastic-net."}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/modules/linear_model.html", "anchor_text": "linear models in Scikit-Learn", "paragraph_index": 1}, {"url": "https://github.com/terrah27/ml_guides/blob/master/linear_models_regression.ipynb", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://scikit-learn.org/stable/datasets/index.html", "anchor_text": "SciKit-Learn diabetes dataset", "paragraph_index": 3}, {"url": "https://towardsdatascience.com/hyperparameter-tuning-c5619e7e6624", "anchor_text": "grid search", "paragraph_index": 25}, {"url": "https://towardsdatascience.com/hyperparameter-tuning-c5619e7e6624", "anchor_text": "grid search", "paragraph_index": 33}], "all_paragraphs": ["Arguably the best starting point for regression tasks are linear models: they can be trained quickly and are easily interpretable.", "Linear models make a prediction using a linear function of the input features. Here we\u2019ll explore some popular linear models in Scikit-Learn.", "The full Jupyter notebook can be found here.", "Here we\u2019ll use the SciKit-Learn diabetes dataset to review some popular linear regression algorithms.", "The dataset contains 10 features (that have already been mean centered and scaled) and a target value: a measure of disease progression one year after baseline.", "We import the data and prepare for modeling:", "R-Squared, or the coefficient of determination, is how much variance in the target variable that is explained by our model.", "Values can range from 0 to 1. Higher values indicate a model that is highly predictive. For example, a R\u00b2 value of 0.80 means that the model is accounting for 80% of the variability in the data.", "In general, the higher the R\u00b2 value the better. Low values indicate that our model is not very good at predicting the target. One caution, however, is that a very high R\u00b2 could be a sign of overfitting.", "We\u2019ll use the following function to get cross validation scores for our models:", "Linear regression finds the parameters to minimize the mean squared error or residuals between the predictions and the targets.", "Mean squared error is defined as the sum of the squared differences between the predictions and the true values, divided by the total number of samples.", "To generate a linear regression, we use Scikit-Learn\u2019s LinearRegression class:", "We get a R\u00b2 value of 0.48 and standard deviation of 0.14. The low R\u00b2 value indicates that our model is not very accurate. The standard deviation value indicates we may be overfitting the training data.", "Overfitting occurs when the model makes much better predictions on known data than on unknown data. The model begins to memorize the training data and is unable to generalize to unseen test data.", "One option to combat overfitting is to simplify the model. We\u2019ll attempt to simplify our linear regression model by introducing regularization.", "Regularization can be defined as explicitly restricting a model to prevent overfitting.", "As linear regression has no parameters, there is no way to control the complexity of the model. We\u2019ll explore some variations that add regularization below.", "Ridge regression uses L2 regularization to minimize the magnitude of the coefficients. It reduces the size of the coefficients and helps reduce model complexity.", "We control the complexity of our model with the regularization parameter, \u237a.", "Higher values of \u237a force coefficients to move towards zero and increases the restriction on the model. This decreases training performance, but also increases the generalizability of the model. Setting \u237a too high could lead to a model that is too simple and underfits the data.", "With lower values of \u237a the coefficients are less restricted. When \u237a is very small the model becomes more similar to linear regression above and we risk overfitting.", "Let\u2019s see if we can improve performance using Scikit-Learn\u2019s Ridge class:", "A mean R\u00b2 score of 0.38 means we are only able to explain 38% of the variance with our Ridge Regression model \u2014 definitely not an improvement from linear regression above. However, our standard deviation decreased which suggests we are less likely to be overfitting.", "We used the default value for alpha above, which might not give the best performance. The optimum value of alpha will vary with each dataset.", "Let\u2019s see if we can improve the R\u00b2 score by adjusting our alpha value. We\u2019ll use grid search to find an optimal alpha value:", "Our R\u00b2 score increased by optimizing for alpha! However, a R\u00b2 score of 0.48 is still not very good. Let\u2019s see if we can improve this further using other types of regularization.", "Lasso regression uses L1 regularization to force some coefficients to be exactly zero. This means some features are completely ignored by the model. This can be thought of as a type of automatic feature selection!", "Lasso can be a good model choice when we have a large number of features but expect only a few to be important. This can make the model easier to interpret and reveal the most important features!", "Higher values of \u237a force more coefficients to zero and can cause underfitting.", "Lower values of alpha lead to fewer non-zero features and can cause overfitting. Very low values of alpha will cause the model to resemble linear regression.", "Let\u2019s try Lasso Regression on our diabetes dataset:", "We used the default value for alpha above, which might not give the best performance. The optimum value of alpha will vary with each dataset.", "Let\u2019s see can improve the R\u00b2 score by adjusting our alpha value. We\u2019ll use grid search to find an optimal alpha value:", "Our score improved by optimizing alpha!", "We can examine the coefficients to see if any have been set to zero:", "The coefficient for s2 is zero. It is completely ignored by the model!", "We\u2019ll try one last type of regression to see if we can further improve the R\u00b2 score.", "Elastic-net is a linear regression model that combines the penalties of Lasso and Ridge.", "We use the l1_ratio parameter to control the combination of L1 and L2 regularization. When l1_ratio = 0 we have L2 regularization (Ridge) and when l1_ratio = 1 we have L1 regularization (Lasso). Values between zero and one give us a combination of both L1 and L2 regularization.", "We first fit elastic-net with default parameters and then use grid search to find optimal values for alpha and l1_ratio:", "Again, after finding optimal hyperparameter values our R\u00b2 score increased.", "We explored four different linear models for regression:", "We simplified our model with regularization. Unfortunately our R\u00b2 score remains low.", "In future articles, we\u2019ll explore assumptions of linear regression and more ways to improve model performance.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "I\u2019m passionate about all things data! I\u2019m interested in leveraging data to create business solutions."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4a3d14b8d368&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@terrah27?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@terrah27?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": "Tara Boyle"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a7b274f3032&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&user=Tara+Boyle&userId=2a7b274f3032&source=post_page-2a7b274f3032----4a3d14b8d368---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a3d14b8d368&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a3d14b8d368&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ifbdesign?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Benjamin Smith"}, {"url": "https://unsplash.com/s/photos/graph?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://scikit-learn.org/stable/modules/linear_model.html", "anchor_text": "linear models in Scikit-Learn"}, {"url": "https://github.com/terrah27/ml_guides/blob/master/linear_models_regression.ipynb", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/datasets/index.html", "anchor_text": "SciKit-Learn diabetes dataset"}, {"url": "https://towardsdatascience.com/hyperparameter-tuning-c5619e7e6624", "anchor_text": "grid search"}, {"url": "https://towardsdatascience.com/hyperparameter-tuning-c5619e7e6624", "anchor_text": "grid search"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----4a3d14b8d368---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----4a3d14b8d368---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/sklearn?source=post_page-----4a3d14b8d368---------------sklearn-----------------", "anchor_text": "Sklearn"}, {"url": "https://medium.com/tag/data-science?source=post_page-----4a3d14b8d368---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----4a3d14b8d368---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4a3d14b8d368&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&user=Tara+Boyle&userId=2a7b274f3032&source=-----4a3d14b8d368---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F4a3d14b8d368&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&user=Tara+Boyle&userId=2a7b274f3032&source=-----4a3d14b8d368---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4a3d14b8d368&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F4a3d14b8d368&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----4a3d14b8d368---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----4a3d14b8d368--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@terrah27?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@terrah27?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Tara Boyle"}, {"url": "https://medium.com/@terrah27/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a7b274f3032&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&user=Tara+Boyle&userId=2a7b274f3032&source=post_page-2a7b274f3032--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Feca374d3ba4a&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-models-4a3d14b8d368&newsletterV3=2a7b274f3032&newsletterV3Id=eca374d3ba4a&user=Tara+Boyle&userId=2a7b274f3032&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}