{"url": "https://towardsdatascience.com/understanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2", "time": 1683008740.132726, "path": "towardsdatascience.com/understanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2/", "webpage": {"metadata": {"title": "Understanding Crossword Puzzles with OpenCV, OCR, and DNNs | by Art Kulakov | Towards Data Science", "h1": "Understanding Crossword Puzzles with OpenCV, OCR, and DNNs", "description": "Recently I was given the task of creating an algorithm, to extract all possible metadata from the crossword photo. This seemed like an interesting task for me, so I decided to give it a try. These\u2026"}, "outgoing_paragraph_urls": [{"url": "http://artkulakov.com", "anchor_text": "my website", "paragraph_index": 1}, {"url": "https://github.com/artkulak/crossword-data-extraction", "anchor_text": "Github", "paragraph_index": 1}, {"url": "http://artkulakov.com/", "anchor_text": "website", "paragraph_index": 13}], "all_paragraphs": ["Recently I was given the task of creating an algorithm, to extract all possible metadata from the crossword photo. This seemed like an interesting task for me, so I decided to give it a try. These are the topics that will be covered in this blogpost:", "You can find the full code implementation on my website and my Github.", "First things first, to extract the metadata, you have to understand where it is located. For this purpose, I used simple OpenCV heuristics to identify the lines on the crossword puzzle and to form a cell grid out of these lines. The input image needs to be sufficiently large, so all lines could be detected easily.", "Afterward, for cell detection, I found the intersection between lines and formed the cells based on intersection points.", "Finally, at this stage, each cell is cut from the image and saved as a separate file for further manipulations.", "Crossword cell classification with PyTorch CNN", "For cell classification, everything was really straightforward. The problem was modeled as a multiclass classification problem with the following targets:", "For each of the target classes, I labeled manually around 100 cells for each class. Afterward, I fitted a simple PyTorch CNN model with the following architecture:", "The resulting model predictions were almost descent and generalized well even on crossword puzzles of different formats.", "My final step was to extract all metadata from the labeled cells. For this purpose, I firstly created a classified representation of each image cell in the Pandas DataFrame format.", "Finally, based on the cell class, I either extracted text from the image using Pytesseract, or I extracted arrow coordinates and direction if the cell was classified as one of the arrow cells.", "The resulting output of the script looked the following way in JSON format:", "This work was a great experience for me and offered a great opportunity to dive into a task which was a mix of simple OpenCV heuristics along with usage of more cutting edge concepts like OCR and DNNs for image classification. Thank you for your read!", "You may like to check other posts on my website", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff7dd759650b2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://artkulakov.medium.com/?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": ""}, {"url": "https://artkulakov.medium.com/?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": "Art Kulakov"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c4b7f24d954&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&user=Art+Kulakov&userId=8c4b7f24d954&source=post_page-8c4b7f24d954----f7dd759650b2---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7dd759650b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7dd759650b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/zlbB-anyO3I", "anchor_text": "https://unsplash.com/photos/zlbB-anyO3I"}, {"url": "http://artkulakov.com", "anchor_text": "my website"}, {"url": "https://github.com/artkulak/crossword-data-extraction", "anchor_text": "Github"}, {"url": "http://artkulakov.com/", "anchor_text": "website"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----f7dd759650b2---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----f7dd759650b2---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----f7dd759650b2---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/python?source=post_page-----f7dd759650b2---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/crossword-puzzles?source=post_page-----f7dd759650b2---------------crossword_puzzles-----------------", "anchor_text": "Crossword Puzzles"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7dd759650b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&user=Art+Kulakov&userId=8c4b7f24d954&source=-----f7dd759650b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ff7dd759650b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&user=Art+Kulakov&userId=8c4b7f24d954&source=-----f7dd759650b2---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff7dd759650b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ff7dd759650b2&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----f7dd759650b2---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----f7dd759650b2--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f7dd759650b2--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----f7dd759650b2--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----f7dd759650b2--------------------------------", "anchor_text": ""}, {"url": "https://artkulakov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://artkulakov.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Art Kulakov"}, {"url": "https://artkulakov.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "626 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8c4b7f24d954&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&user=Art+Kulakov&userId=8c4b7f24d954&source=post_page-8c4b7f24d954--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffbb3f8dbd5f6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Funderstanding-crossword-puzzles-with-opencv-ocr-and-dnns-f7dd759650b2&newsletterV3=8c4b7f24d954&newsletterV3Id=fbb3f8dbd5f6&user=Art+Kulakov&userId=8c4b7f24d954&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}