{"url": "https://towardsdatascience.com/intuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227", "time": 1683006278.934722, "path": "towardsdatascience.com/intuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227/", "webpage": {"metadata": {"title": "Intuitive CNN Creation for Fashion Image Multi-class Classification | by Luke Sun | Towards Data Science", "h1": "Intuitive CNN Creation for Fashion Image Multi-class Classification", "description": "Step-by-step Walk-through on Convolution Neural Network Creation using Keras for Fashion Image Classification"}, "outgoing_paragraph_urls": [{"url": "https://medium.com/@vistaxjtu/cnn-classification-a-cat-or-a-dog-568e6a135602", "anchor_text": "article", "paragraph_index": 0}, {"url": "https://medium.com/p/568e6a135602/edit", "anchor_text": "here", "paragraph_index": 13}, {"url": "https://setosa.io/ev/image-kernels/", "anchor_text": "website", "paragraph_index": 13}, {"url": "https://www.cs.ryerson.ca/~aharley/vis/conv/flat.html", "anchor_text": "website", "paragraph_index": 13}, {"url": "https://medium.com/@vistaxjtu/intuitively-explain-accuracy-precision-recall-and-f1-777563342aca", "anchor_text": "article", "paragraph_index": 29}, {"url": "http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html", "anchor_text": "link", "paragraph_index": 31}, {"url": "https://vue.ai/", "anchor_text": "page", "paragraph_index": 31}, {"url": "https://github.com/luke4u/CNN-Image-Classification", "anchor_text": "Github", "paragraph_index": 32}], "all_paragraphs": ["In the previous article, I created a Convolution Neural Network (CNN) for binary image classification. In this article, I will create another CNN for the retail marketing industry. What sets this article unique: different format of input data which requires different data processing methods, and different CNN architecture for multi-class classification. It is split into 6 parts.", "We are given a set of images from the retail industry. The task is to create a CNN model to predict the label of a fashion image: 0 as T-shirt; 1 as Trouser; 2 as Pullover; 3 as Dress; 4 as Coat; 5 as Sandal; 6 as Shirt; 7 as Sneaker; 8 as Bag; 9 as Ankle boot.", "The data we used is Fashion MINST dataset with 70, 000 images, of which 60,000 for the training set, and 10,000 for the test set. All images are in grayscale with 28 pixels in height and 28 pixels in width. Each pixel representing the darkness of the pixel ranges from 0 (black) to 255 (white).", "Figure 1 is a snippet of the training data. Note, each row representing an image has an associated label and 784-pixel values.", "First, read in training and test data and convert dataframe type to NumPy array.", "If you want to view the image in color or grayscale mode, try below:", "Next, scale the independent variables, namely the pixels, between 0 and 1.", "Then, split the training data into training and validation sets, with validation taking 20%. With the validation set, the model will be evaluated on its ability to generalize prediction on new data.", "Finally, we need to reshape X_train, X_validate, X_test. This is a critical point. Keras only accepts a special shape of input data for CNN, namely (batch size, pixel width, pixel height, number of color channels). Therefore,", "Note, two methods are used to reshape the data above, achieving the same goal. 1st method sets the 1st dimension for Numpy to infer, while 2nd defines the 1st dimension with *.", "Great, now the data is ready to train the model \ud83d\ude0e.", "In general, building a CNN requires 4 steps: convolution, max pooling, flattening, and full connection. Here we will build a CNN model with 2 convolution layers.", "Fundamentally, CNN is based on convolution. In simple words, convolutions use a kernel matrix to scan a given image and apply a filter to obtain a certain effect, such as blurring and sharpening. In CNN, kernels are used for feature extraction to select the most important pixels of an image and meanwhile preserve the spatial relationship between pixels.", "If you want a detailed explanation of the concept, please check the previous article here. Feel free to explore this fantastic website to visualize how convolution works. Another great website is by Ryerson University. It visually and interactively shows how CNN works.", "Note, the number of feature detectors is set to be 64, and the feature detector is a 3x3 array. input_shape is the shape of input images on which we apply feature detectors through convolution. We set it to be (28, 28, 1). Here, 1 is the number of channels for a grayscale image, 28x28 is the image dimension in each channel. This needs to the same as the shape of X_train, X_test, X_validate.", "The final argument is the activation function. we use ReLU to remove negative pixel values in feature maps. This is because depending on the parameters used in convolution, we may obtain negative pixels in feature maps. Removing negative pixels add non-linearity for a non-linear classification problem.", "Max pooling is to reduce the size of a feature map produced by convolution by sliding a table and taking the maximum value in the table. Ultimately, it aims to reduce the number of nodes in the fully connected layers without losing key features and spatial structure information in the images.", "Specifically, we use MaxPooling2D() function to add the pooling layer. In general, we use a 2x2 table for pooling.", "Dropout is the solution for over-fitting. How does drop out work \ud83e\udd14? During each training iteration, some neurons are randomly disabled to prevent them from depending on each other too much. By overwriting these neurons, neural network retains a different architecture each time, helping the neural network learn independent correlations of the data. This prevents the neurons from over-learn.", "Note, we set 25% of neurons to disabled at each iteration.", "Based on previous experiments, add a 2nd layer for convolution and max-pooling to improve model performance.", "Flattening is to take all reduced feature maps after pooling into a single vector as the input for the fully connected layers.", "With the above, we converted an input image into a one-dimensional vector. Now let\u2019s build a classifier using this vector as the input. Specifically,", "Note, for the 1st hidden layer, output_dim as the number of nodes in the hidden layer, is set to be 32. Please feel free to try more. Use ReLU as an activation function.", "With that done, congratulation on finishing the model building. Figure 2 is what we built \ud83c\udf89\ud83c\udf89.", "With all layers added, let\u2019s configure CNN for training. An important decision to make is the loss function. As for advice, if one sample can have multiple classes or labels, use categorical_crossentropy. If classes are mutually exclusive (e.g. when each sample belongs exactly to one class), use sparse_categorical_crossentropy. Here use the latter.", "We train the model for 50 iterations on the data. The model updates its gradients every 512 samples. Use (X_validate, y_validate) to evaluate the model loss and accuracy.", "In the end, we obtained a training accuracy of 92% and a test accuracy of 90% \u2728\u2728", "Now, let\u2019s evaluate the model on test sets. Specifically,", "We obtained a test accuracy of 90%! If you want to know how to calculate accuracy, please read this article.", "Figure 3 below shows a view of the Predicted and Real labels of the images. It seems the model is not good at distinguishing between pullover (2), shirt (6) and coat (4).", "If you want to train the model with much more data, feel free to explore this link. If you want to check a real case of Data Science Innovation in the Retail industry, check this page.", "Great! If you found this post helpful, feel free to hit those \ud83d\udc4f \u2018s! If you need the source code or more CNN use cases, visit my Github page \ud83e\udd1e\ud83e\udd1e.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "ML Enthusiast, Data Scientist, Python Developer. Love to share articles about technology."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6e31421d5227&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6e31421d5227--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6e31421d5227--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://lukesun.medium.com/?source=post_page-----6e31421d5227--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=post_page-----6e31421d5227--------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508----6e31421d5227---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6e31421d5227&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6e31421d5227&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://pixabay.com/photos/woman-umbrella-floating-jumping-1245817/", "anchor_text": "link"}, {"url": "https://medium.com/@vistaxjtu/cnn-classification-a-cat-or-a-dog-568e6a135602", "anchor_text": "article"}, {"url": "https://medium.com/p/568e6a135602/edit", "anchor_text": "here"}, {"url": "https://setosa.io/ev/image-kernels/", "anchor_text": "website"}, {"url": "https://www.cs.ryerson.ca/~aharley/vis/conv/flat.html", "anchor_text": "website"}, {"url": "https://medium.com/@vistaxjtu/intuitively-explain-accuracy-precision-recall-and-f1-777563342aca", "anchor_text": "article"}, {"url": "http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html", "anchor_text": "link"}, {"url": "https://vue.ai/", "anchor_text": "page"}, {"url": "https://github.com/luke4u/CNN-Image-Classification", "anchor_text": "Github"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----6e31421d5227---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----6e31421d5227---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/keras?source=post_page-----6e31421d5227---------------keras-----------------", "anchor_text": "Keras"}, {"url": "https://medium.com/tag/python?source=post_page-----6e31421d5227---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----6e31421d5227---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6e31421d5227&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&user=Luke+Sun&userId=7b5b79d21508&source=-----6e31421d5227---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6e31421d5227&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&user=Luke+Sun&userId=7b5b79d21508&source=-----6e31421d5227---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6e31421d5227&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6e31421d5227--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6e31421d5227&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6e31421d5227---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6e31421d5227--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6e31421d5227--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6e31421d5227--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6e31421d5227--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6e31421d5227--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6e31421d5227--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6e31421d5227--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6e31421d5227--------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://lukesun.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Luke Sun"}, {"url": "https://lukesun.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "141 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F7b5b79d21508&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&user=Luke+Sun&userId=7b5b79d21508&source=post_page-7b5b79d21508--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F38f46069f6d3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fintuitively-create-cnn-for-fashion-image-multi-class-classification-6e31421d5227&newsletterV3=7b5b79d21508&newsletterV3Id=38f46069f6d3&user=Luke+Sun&userId=7b5b79d21508&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}