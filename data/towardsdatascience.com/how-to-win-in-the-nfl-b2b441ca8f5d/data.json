{"url": "https://towardsdatascience.com/how-to-win-in-the-nfl-b2b441ca8f5d", "time": 1682995571.966581, "path": "towardsdatascience.com/how-to-win-in-the-nfl-b2b441ca8f5d/", "webpage": {"metadata": {"title": "How to Win in the NFL with Machine Learning | by Rich Folsom | Towards Data Science", "h1": "How to Win in the NFL with Machine Learning", "description": "You have been hired as the defensive coordinator for the Dallas Cowboys, and you are coaching against the New England Patriots in the Super Bowl. I realize this is a highly unlikely scenario given\u2026"}, "outgoing_paragraph_urls": [{"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn", "paragraph_index": 1}, {"url": "https://towardsdatascience.com/data-science-with-no-data-b3c21acee17c", "anchor_text": "this article", "paragraph_index": 2}, {"url": "https://www.kaggle.com/maxhorowitz/nflplaybyplay2009to2016", "anchor_text": "Kaggle", "paragraph_index": 2}, {"url": "https://github.com/maksimhorowitz/nflscrapR/blob/master/R/scrape_play_by_play.R", "anchor_text": "this page", "paragraph_index": 6}, {"url": "https://medium.com/@taplapinger/tuning-a-random-forest-classifier-1b252d1dde92", "anchor_text": "RandomForestClassifier", "paragraph_index": 29}, {"url": "http://concretely.ai", "anchor_text": "concretely.ai", "paragraph_index": 37}], "all_paragraphs": ["You have been hired as the defensive coordinator for the Dallas Cowboys, and you are coaching against the New England Patriots in the Super Bowl. I realize this is a highly unlikely scenario given that the Cowboys don\u2019t look anything like a Super Bowl contender. However, we can still use this as an example project for the steps to create an AI/ML model.", "The Patriots have been the best team in the NFL over the last two decades, and Tom Brady, the Patriots\u2019 quarterback has been arguably the best player in the NFL over the same timespan. As a defensive coordinator, it will be a huge task to stop the Patriots. However, we have an advantage on our side: AI/ML. Let\u2019s lay out a process to see if we can predict the plays before they happen, which will enable us to adjust our defensive scheme accordingly. We will be using Python and sklearn for this example. Here is the process we will follow:", "The first thing you\u2019re going to need is a dataset. If you don\u2019t have access to a relevant dataset, you can generate a sample dataset using a process like this article. For our example, we will be using this dataset containing information on every NFL play that has been run since 2009. It\u2019s hosted on Kaggle. If you\u2019re not familiar with Kaggle, it\u2019s a coding competition website with many different datasets; this is usually the first place I check when I want to find some data.", "Once we have downloaded and unzipped the file, we need it in a format that enables us to explore the data. For this, we will be using Pandas, a Python library that contains numerous functions to modify and explore the dataset. Here is the code to load the dataframe from our CSV file:", "EDA is the process of exploring the data for issues (missing values, incorrectly typed data, etc\u2026) and hopefully, we can see some trends in the data.", "First off, let\u2019s see how many rows and columns we\u2019ve loaded:", "As you can see, there is a lot of information in this data set (255 columns). It would be nice to know what each field represents. It took some digging, but I ended up finding this page, which describes all of the columns and what they mean. I am interested in these fields:", "There are other fields that we could use to help predict, but let\u2019s use these for starters. Here\u2019s the code to filter by these rows and columns", "At this point, we have one more step before we can begin EDA. The value we\u2019re trying to predict is represented by four columns which are dependent on the play_type. For example:", "We need to combine all of these values into a single field. Here\u2019s the code to do that (note, we are also filtering out location=\u2019unknown\u2019):", "This code will create a column called full_play_type, which is what we\u2019re trying to predict. Let\u2019s take one last look at our data to make sure everything looks ok:", "First, let\u2019s see what values our full_play_type contains:", "As you can see, if we were to randomly guess the next play, we\u2019d have a one in six chance (16.66%) of being correct. We will use this as our baseline to see if we can improve.", "Sometimes it helps to view this in chart format:", "Next, let\u2019s get an idea of which plays are called by percent of total:", "We\u2019ve already got improvement in our predictions! If we predict pass_left for every play, we\u2019d be correct 23% of the time vs. 16.66% of the time. We can still do better.", "AI/ML models require numeric inputs and outputs. They also work better when the scale of the numbers are similar. In this section, we will utilize some different techniques to achieve this.", "First, we will use sklearn\u2019s preprocessing library to convert our full_play_types to numeric:", "This creates a column called full_play_type_code, which is a numeric representation of full_play_type. Let\u2019s look at the full_play_type_code data and make sure that it still matches full_play_type.", "As you can see, the chart matches the one above, but now the x-axis is a numeric value, instead of text.", "Next, I want to simplify the ydstogo value. Technically speaking this can be a value between 1 and 99. However, I want to put this distance into some buckets (1\u20134yds, 5\u20138yds, 9\u201312yds, 13\u201316yds, \u226517yds) which should enable our model to identify patterns. The ranges I picked are arbitrary and can be easily modified.", "Now, I want to one hot encode the down and ydstogo columns, which means we will \u2018pivot\u2019 the rows to columns and populate the column containing the value we\u2019re encoding with a \u20181\u2019, otherwise zeros. For instance, there are four downs in football. When we one hot encode the down column, we will end up with four columns in which a one will be populated only once. If we were to one hot encode a row that represented third down, we\u2019d end up with these values for our new columns[0, 0, 1, 0]. Notice the 3rd column is the only one to contain a one. The advantage of doing this is that our down and ydstogo data is now represented as zeros and ones, which should also help our model learn. The code for this is very simple in sklearn:", "Here\u2019s what a sample of our data looks like at this point:", "Now, you can see that ydstogo_* and down_* are represented by zeroes and ones. However, the game_seconds_remaining, yardline_100 and score differential columns are still on a different scale than zero and one. For instance, game seconds remaining contains a value between zero and 3600.", "We can fix that by adding some math to the columns. First, let\u2019s see what the ranges of values these columns contain.", "For this exercise, we will be looking at the min and max values and use those to normalize the data to a value between zero and one. The min for game_seconds_remaining is 3, while the max is 3600. We will divide game_seconds_remaining by 3600. Yardline_100 will be divided by 100. For score differential, we\u2019ll apply this formula:", "However, to simplify, we\u2019ll just use -50 for min_diff, and 50 for max_diff. Our logic is that if you\u2019re winning or losing by more than 50 points, you\u2019ve got other things on your mind at this point. Here\u2019s our code to apply these formulas:", "Now, if we look at our dataset, here\u2019s what we get:", "We now have all of our input fields converted to values between zero and one, so we\u2019re ready to try it out on a model.", "For this tutorial, we will be using the RandomForestClassifier to see if we can predict the next play. But first, we need to get rid of all the columns we don\u2019t want for our model. Then, we need to split our data into a train and test set, each containing an X (input data) and y(result data). This can be done quickly with three lines of Python.", "At this point, we can train our model to fit the input data.", "Now that our model has been trained, let\u2019s see how it scores on our test data.", "We are now able to predict the correct play 31% of the time, which may not sound great, but keep in mind that it\u2019s almost double where we started by randomly guessing (16.66%) and 25% better than just guessing the play they like to run the most (pass_left, 23%).", "With just a few lines of Python code, we have almost doubled our coaching skills. You may have noticed, however, that the majority of the code we\u2019ve written is related to organizing and curating our data. Now that we\u2019ve done that, we can use this data to train more complex models.", "In our next article, we will explore four techniques to generate even better predictions utilizing the data we have processed:", "Thanks for reading, the code for this article will be hosted on github.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Former tech exec turned entrepreneur. CTO of concretely.ai."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb2b441ca8f5d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@rich.folsom?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rich.folsom?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": "Rich Folsom"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb48b47890351&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&user=Rich+Folsom&userId=b48b47890351&source=post_page-b48b47890351----b2b441ca8f5d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb2b441ca8f5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb2b441ca8f5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://scikit-learn.org/stable/", "anchor_text": "sklearn"}, {"url": "https://towardsdatascience.com/data-science-with-no-data-b3c21acee17c", "anchor_text": "this article"}, {"url": "https://www.kaggle.com/maxhorowitz/nflplaybyplay2009to2016", "anchor_text": "Kaggle"}, {"url": "https://github.com/maksimhorowitz/nflscrapR/blob/master/R/scrape_play_by_play.R", "anchor_text": "this page"}, {"url": "https://medium.com/@taplapinger/tuning-a-random-forest-classifier-1b252d1dde92", "anchor_text": "RandomForestClassifier"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b2b441ca8f5d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data?source=post_page-----b2b441ca8f5d---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b2b441ca8f5d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/sports?source=post_page-----b2b441ca8f5d---------------sports-----------------", "anchor_text": "Sports"}, {"url": "https://medium.com/tag/analytics?source=post_page-----b2b441ca8f5d---------------analytics-----------------", "anchor_text": "Analytics"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb2b441ca8f5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&user=Rich+Folsom&userId=b48b47890351&source=-----b2b441ca8f5d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb2b441ca8f5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&user=Rich+Folsom&userId=b48b47890351&source=-----b2b441ca8f5d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb2b441ca8f5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb2b441ca8f5d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b2b441ca8f5d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b2b441ca8f5d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rich.folsom?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@rich.folsom?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rich Folsom"}, {"url": "https://medium.com/@rich.folsom/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "167 Followers"}, {"url": "http://concretely.ai", "anchor_text": "concretely.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb48b47890351&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&user=Rich+Folsom&userId=b48b47890351&source=post_page-b48b47890351--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8d2802f79cd4&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-win-in-the-nfl-b2b441ca8f5d&newsletterV3=b48b47890351&newsletterV3Id=8d2802f79cd4&user=Rich+Folsom&userId=b48b47890351&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}