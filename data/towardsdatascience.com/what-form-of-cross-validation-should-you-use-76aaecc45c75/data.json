{"url": "https://towardsdatascience.com/what-form-of-cross-validation-should-you-use-76aaecc45c75", "time": 1683002242.416033, "path": "towardsdatascience.com/what-form-of-cross-validation-should-you-use-76aaecc45c75/", "webpage": {"metadata": {"title": "What Form of Cross-Validation Should You Use? | by Ryan Burn | Towards Data Science", "h1": "What Form of Cross-Validation Should You Use?", "description": "Cross-validation partitions a dataset, trains and validates models on complementary subsets, and averages prediction errors in such a way that each datapoint is validated once as an out-of-sample\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)", "anchor_text": "ross-validation", "paragraph_index": 0}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)#k-fold_cross-validation", "anchor_text": "K-fold cross-validation", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)#Leave-one-out_cross-validation", "anchor_text": "Leave-One-Out Cross-Validation", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Tikhonov_regularization", "anchor_text": "ridge regression", "paragraph_index": 2}, {"url": "https://en.wikipedia.org/wiki/Orthogonal_matrix", "anchor_text": "orthogonal matrix", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Singular_value_decomposition", "anchor_text": "singular value decomposition", "paragraph_index": 10}, {"url": "https://en.wikipedia.org/wiki/Unitary_matrix", "anchor_text": "unitary matrix", "paragraph_index": 11}, {"url": "https://en.wikipedia.org/wiki/Circulant_matrix", "anchor_text": "circulant matrices", "paragraph_index": 13}, {"url": "https://buildingblock.ai", "anchor_text": "buildingblock.ai", "paragraph_index": 31}, {"url": "https://towardsdatascience.com/how-to-do-ridge-regression-better-34ecb6ee3b12", "anchor_text": "How to do Ridge Regression Better", "paragraph_index": 32}, {"url": "http://pages.stat.wisc.edu/~wahba/stat860public/pdf1/golub.heath.wahba.pdf", "anchor_text": "Generalized Cross-Validation as a Method for Choosing a Good Ridge Parameter", "paragraph_index": 34}, {"url": "https://en.wikipedia.org/wiki/Matrix_norm#Frobenius_norm", "anchor_text": "Frobenius norm", "paragraph_index": 36}, {"url": "https://towardsdatascience.com/how-to-do-ridge-regression-better-34ecb6ee3b12", "anchor_text": "How to do Ridge Regression Better", "paragraph_index": 37}], "all_paragraphs": ["Cross-validation partitions a dataset, trains and validates models on complementary subsets, and averages prediction errors in such a way that each datapoint is validated once as an out-of-sample prediction. By averaging errors of out-of-sample predictions across the whole dataset, we hope that the cross-validation error acts as a proxy for how a model will perform on unseen test data. If it acts as an accurate proxy, then we can use cross-validation as a guide to adjust a model so as to achieve better performance in the general context.", "K-fold cross-validation randomly partitions a dataset into k non-overlapping subsets. Models are trained k times with each subset, in turn, left out and used as out-of-sample test data. For smaller values of k, k-fold can be less expensive to compute, but it has the unattractive property that it introduces randomness into the cross-validation result.", "Leave-One-Out Cross-Validation (LOOCV) is a form of k-fold where k is equal to the size of the dataset. In contrast to regular k-fold, there\u2019s no randomness in the LOOCV result since each datapoint is always partitioned into its own subset. While it can be expensive in the general case, requiring a model to be fit for every point in the dataset, for certain models, such as ridge regression, LOOCV can be computed efficiently and optimized to find the best model parameters\u00b9.", "If feasible, LOOCV should be preferred to other forms of k-fold; but it still has some undesirable properties. Let X and y represent the dataset\u2019s n x p feature matrix and target values. If Q is an n x n orthogonal matrix, put", "Suppose we fit a ridge regression model to the dataset. If b represents the model\u2019s regressors, then b has the same error on the rotated regression problem as it does on the original", "And so, there\u2019s an equivalence between the regression problems X\u2032, y\u2032 and X, y, yet the LOOCV is not invariant to rotations\u00b2.", "Furthermore, LOOCV performs especially poorly when variance for a feature is concentrated about only a few data points\u00b3. In the most extreme case, suppose", "when the ith data vectors is excluded (i \u2264 p), there\u2019s no variance in the remaining dataset to fit the ith regressor coefficient so that the LOOCV is", "and independent of the regularization matrix.", "The idea behind Generalized Cross-Validation (GCV) is to modify LOOCV so that it\u2019s computed on a rotation of the original regression problem where the rotation matrix has been chosen in a very particular way so that 1) GCV is invariant to rotations of the original regression problem and 2) variance of feature vectors is \u201cspread out\u201d evenly across the transformed matrix X\u2032\u2074.", "Let U, S, and V represent the singular value decomposition of X", "where S is a rectangular diagonal matrix and U and V are orthogonal matrices. Let W represent a unitary matrix (GCV uses complex rotations). Put", "Let X\u2032, y\u2032 represent the rotated regression problem for this matrix. Then", "The columns of W are the common eigenvectors of n x n circulant matrices so that for any diagonal matrix D", "is a circulant matrix with the form", "is a circulant matrix with constants down the diagonal. Additionally, for any row of X\u2032, the covariance of it with the other rows of X\u2032 is represented by the same shifted vector\u2075.", "Let \u0393 denote the regularization matrix of ridge regression. Then the LOOCV of the regression problem X, y can be efficiently computed with the equation\u2076", "The same equation can be used on the rotated regression problem X\u2032, y\u2032 to compute the GCV, only we need to account for the fact that X\u2032, y\u2032 are complex valued. The GCV equation, then, becomes", "(Note: A and b\u0302 are invariant to rotations so they remain unchanged)", "We can also apply the same modifications to LOOCV\u2019s derivative equations to compute the GCV derivatives, making it possible to apply an optimizer to minimize GCV with respect to \u0393.", "Suppose we parameterize our regularization matrix \u0393 with a single variable", "Then h\u2032 is the diagonal of", "is a diagonal matrix, it follows that", "is a circulant matrix. Therefore, h\u2032 is a vector of constant values equal to", "or, since the trace is invariant to rotations,", "Substituting this back into the LOOCV equation and making use of the property that rotated regression problems have the same sum of squared errors, the GCV for the single-variable regularization is", "This is the most common form that GCV is presented in. But caution: For the general case where \u0393 is parameterized by multiple variables, this simplified equation won\u2019t evaluate to the proper value\u2077.", "We\u2019ll compare the performance of different approaches to setting regularization parameters on an example problem. The data is taken from Motor Trend 1974 US magazine and the task is to predict the fuel efficiency of vehicles from other given attributes. We\u2019ll compare the following models on a Leave-One-Out Cross-Validation of the data:", "Note: There are two levels of cross-validation going on in this experiment. At the highest level we form a pair of training data and test data for each data point to train the models on; and at the lower level, the ridge regression models perform another cross-validation on the training data to set their regularization parameters.", "The table below shows the Root-Mean-Squared-Error (RMSE) of the LOOCV for each model ordered from best to worse\u2078.", "Ridge regression is one of the most commonly used models in machine learning. With the right regularization matrix, it frequently outperforms least squares. Using an optimizer, we can set regularization parameters to maximize performance on certain forms of cross-validation; but to get good out-of-sample performance, we need to use cross-validations that act as accurate proxies for out-of-sample prediction error. We saw how LOOCV can be problematic in certain cases and has the undesirable property that it\u2019s sensitive to rotations. We introduced GCV as an alternative that\u2019s invariant to rotations and deals with the problem cases of LOOCV by spreading out the variance of the feature matrix. We compared the performance of different ridge regression models on an example problem and found that GCV gave us the best results.", "For finding regularization parameters that optimize either the leave-one-out cross-validation or generalized cross-validation, check out buildingblock.ai.", "[1]: See How to do Ridge Regression Better for details on how an optimizer can be used together with LOOCV to find regularization parameters.", "[3]: The problem case and presentation of GCV as LOOCV on a rotated regression problem is taken from", "Golub G., Heath M., and Wahba G., Generalized Cross-Validation as a Method for Choosing a Good Ridge Parameter (1979), TECHNOMETRICS, Vol 21, No 2", "[4]: To make the notion of \u201cspreading out the variance\u201d more precise, let K denote the covariance matrix of the data vectors", "where we assume the columns of X are centered and p is the length of the feature vectors. Observe that the Frobenius norm of K is invariant to rotations of X; and after the GCV rotation, the covariance matrix K\u2032 is circulant so each column contributes equally to the Frobenius norm.", "[6]: See How to do Ridge Regression Better for a derivation of the efficient LOOCV equation", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F76aaecc45c75&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ryan.burn?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.burn?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": "Ryan Burn"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff55ad0a8217&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&user=Ryan+Burn&userId=f55ad0a8217&source=post_page-f55ad0a8217----76aaecc45c75---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76aaecc45c75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76aaecc45c75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/optimization-and-ml", "anchor_text": "Optimization and Machine Learning"}, {"url": "https://unsplash.com/@joshcala?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Josh Calabrese"}, {"url": "https://unsplash.com/s/photos/spin?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)", "anchor_text": "ross-validation"}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)#k-fold_cross-validation", "anchor_text": "K-fold cross-validation"}, {"url": "https://en.wikipedia.org/wiki/Cross-validation_(statistics)#Leave-one-out_cross-validation", "anchor_text": "Leave-One-Out Cross-Validation"}, {"url": "https://en.wikipedia.org/wiki/Tikhonov_regularization", "anchor_text": "ridge regression"}, {"url": "https://en.wikipedia.org/wiki/Orthogonal_matrix", "anchor_text": "orthogonal matrix"}, {"url": "https://en.wikipedia.org/wiki/Singular_value_decomposition", "anchor_text": "singular value decomposition"}, {"url": "https://en.wikipedia.org/wiki/Unitary_matrix", "anchor_text": "unitary matrix"}, {"url": "https://en.wikipedia.org/wiki/Circulant_matrix", "anchor_text": "circulant matrices"}, {"url": "https://en.wikipedia.org/wiki/Principal_component_analysis", "anchor_text": "principal component"}, {"url": "https://buildingblock.ai", "anchor_text": "buildingblock.ai"}, {"url": "https://towardsdatascience.com/how-to-do-ridge-regression-better-34ecb6ee3b12", "anchor_text": "How to do Ridge Regression Better"}, {"url": "https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/loocv-rotations.ipynb", "anchor_text": "https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/loocv-rotations.ipynb"}, {"url": "http://pages.stat.wisc.edu/~wahba/stat860public/pdf1/golub.heath.wahba.pdf", "anchor_text": "Generalized Cross-Validation as a Method for Choosing a Good Ridge Parameter"}, {"url": "https://en.wikipedia.org/wiki/Matrix_norm#Frobenius_norm", "anchor_text": "Frobenius norm"}, {"url": "https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/gcv-rotation.ipynb", "anchor_text": "https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/gcv-rotation.ipynb"}, {"url": "https://towardsdatascience.com/how-to-do-ridge-regression-better-34ecb6ee3b12", "anchor_text": "How to do Ridge Regression Better"}, {"url": "https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/gcv-formulas.ipynb", "anchor_text": "https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/gcv-formulas.ipynb"}, {"url": "https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/motor-trends-regression.ipynb", "anchor_text": "https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/motor-trends-regression.ipynb"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----76aaecc45c75---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ridge-regression?source=post_page-----76aaecc45c75---------------ridge_regression-----------------", "anchor_text": "Ridge Regression"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----76aaecc45c75---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/optimization?source=post_page-----76aaecc45c75---------------optimization-----------------", "anchor_text": "Optimization"}, {"url": "https://medium.com/tag/optimization-and-ml?source=post_page-----76aaecc45c75---------------optimization_and_ml-----------------", "anchor_text": "Optimization And Ml"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F76aaecc45c75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&user=Ryan+Burn&userId=f55ad0a8217&source=-----76aaecc45c75---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F76aaecc45c75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&user=Ryan+Burn&userId=f55ad0a8217&source=-----76aaecc45c75---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F76aaecc45c75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F76aaecc45c75&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----76aaecc45c75---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----76aaecc45c75--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----76aaecc45c75--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----76aaecc45c75--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----76aaecc45c75--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.burn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ryan.burn?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ryan Burn"}, {"url": "https://medium.com/@ryan.burn/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "94 Followers"}, {"url": "http://buildingblock.ai", "anchor_text": "buildingblock.ai"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff55ad0a8217&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&user=Ryan+Burn&userId=f55ad0a8217&source=post_page-f55ad0a8217--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fdc9aa2a87345&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-form-of-cross-validation-should-you-use-76aaecc45c75&newsletterV3=f55ad0a8217&newsletterV3Id=dc9aa2a87345&user=Ryan+Burn&userId=f55ad0a8217&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}