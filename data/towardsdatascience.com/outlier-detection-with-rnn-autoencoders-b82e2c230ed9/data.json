{"url": "https://towardsdatascience.com/outlier-detection-with-rnn-autoencoders-b82e2c230ed9", "time": 1683015349.31808, "path": "towardsdatascience.com/outlier-detection-with-rnn-autoencoders-b82e2c230ed9/", "webpage": {"metadata": {"title": "Outlier Detection with RNN Autoencoders | by David Woroniuk | Towards Data Science", "h1": "Outlier Detection with RNN Autoencoders", "description": "Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should\u2026"}, "outgoing_paragraph_urls": [{"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines", "paragraph_index": 0}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms", "paragraph_index": 0}, {"url": "https://github.com/David-Woroniuk/Historic_Crypto", "anchor_text": "Historic-Crypto", "paragraph_index": 11}, {"url": "https://github.com/David-Woroniuk/Historic_Crypto", "anchor_text": "Historic-Crypto", "paragraph_index": 36}], "all_paragraphs": ["Note from Towards Data Science\u2019s editors: While we allow independent authors to publish articles in accordance with our rules and guidelines, we do not endorse each author\u2019s contribution. You should not rely on an author\u2019s works without seeking professional advice. See our Reader Terms for details.", "Anomalies, often referred to as outliers, are data points, data sequences or patterns in data which do not conform to the overarching behaviour of the data series. As such, anomaly detection is the task of detecting data points or sequences which don\u2019t conform to patterns present in the broader data.", "The effective detection and removal of anomalous data can provide highly useful insights across a number of business functions, such as detecting broken links embedded within a website, spikes in internet traffic, or dramatic changes in stock prices. Flagging these phenomena as outliers, or enacting a pre-planned response can save businesses both time and money.", "Anomalous data can typically be separated into three distinct categories, Additive Outliers, Temporal Changes, or Level Shifts.", "Additive Outliers are characterised by sudden large increases or decreases in value, which can be driven by exogenous or endogenous factors. Examples of additive outliers could be a large increase in website traffic due to an appearance on television (exogenous), or a short-term increase in stock trading volume due to strong quarterly performance (endogenous).", "Temporal Changes are characterised by a short sequence which doesn\u2019t conform to the broader trend in the data. For example, if a website server crashes, the volume of website traffic will drop to zero for a sequence of datapoints, until the server is rebooted, at which point normal traffic will return.", "Level Shifts are a common phenomena in commodity markets, as high demand for electricity is inherently linked to inclement weather conditions. As such, a \u2018level shift\u2019 can be observed between the price of electricity in summer and winter, owing to weather driven changes in demand profiles and renewable energy generation profiles.", "Autoencoders are neural networks designed to learn a low-dimensional representation of a given input. Autoencoders typically consist of two components: an encoder which learns to map input data to a lower dimensional representation and a decoder, which learns to map the representation back to the input data.", "Due to this architecture, the encoder network iteratively learns an efficient data compression function, which maps the data to a lower dimensional representation. Following training, the decoder is able to successfully reconstruct the original input data, as the reconstruction error (difference between input and reconstructed output produced by the decoder) is the objective function throughout the training process.", "Now that we understand the underlying architecture of an Autoencoder model, we can begin to implement the model.", "The first step is to install the libraries, packages and modules which we shall use:", "Secondly, we need to obtain some data to analyse. This article uses the Historic-Crypto package to obtain historical Bitcoin (\u2018BTC\u2019)data from \u20182013\u201306\u201306\u2019 to present day. The code below also generates the daily Bitcoin returns and intraday price volatility, prior to removing any rows of missing data and returning the first 5 rows of the DataFrame.", "Now that we have obtained some data, we should visually scan each series for potential outliers. The plot_dates_values function below enables the iterative plotting of each series contained within the DataFrame.", "We can now iteratively call the above function, generating Plotly charts for the Volume, Close, Open, Volatility and Return profiles of Bitcoin.", "Notably, a number of spikes in trading volume occur in 2020, it may be useful to investigate if these spikes are anomalous or indicative of the broader series.", "A pronounced spike exists within the closing price in 2018, followed by a crash to a technical support level. However, a positive trend broadly exists throughout the data.", "The daily opening price follows a similar pattern to that of the closing price above.", "Price volatility displays a number of pronounced spikes in both 2018 and 2020. As such we could investigate if these volatility spikes are considered anomalous by an Autoencoder model.", "Due to the stochastic nature of the Returns series, we have elected to test for outliers within the daily traded volume of Bitcoin, as characterised by Volume.", "As such, we can begin data preprocessing for the Autoencoder model. The first step in data preprocessing is to determine an appropriate split between the training data and testing data. The generate_train_test_split function outlined below enables the splitting of training and testing data by date. Upon calling the below function, two DataFrames, namely training_data and testing_data are generated as global variables.", "To improve model accuracy, we can \u2018normalise\u2019 or scale the data. This function scales the training_data DataFrame generated above, saving the training_mean and training_std for standardising the testing data later.", "Note: It is important to scale the training and testing data using the same scale, otherwise the difference in scale will generate interpretability issues and model inconsistencies.", "As we have called the normalise_training_values function above, we now have a numpy array containing normalised training data called training_values, and we have stored training_mean and training_std as global variables to be used in standardising the test set.", "We can now begin to generate a series of sequences which can be used to train the Autoencoder model. We define that the model shall be provided with 30 previous observations, providing a 3D training data of the shape (2004,30,1):", "Now that we have completed the training data processing, we can define the Autoencoder model, then fit the model on the training data. The define_model function utilises the training data shape to define an appropriate model, returning both the Autoencoder model, and a summary of the Autoencoder model.", "Subsequently, the model_fit function calls the define_model function internally, then provides epochs , batch_size and validation_loss parameters to the model. This function is then called, beginning the model training process.", "Once the model has been trained, it is important to plot the training and validation loss curves to understand if the model suffers from bias (underfitting) or variance (overfitting). This can be observed through calling the below plot_training_validation_loss function.", "Notably, both training and validation loss curves are converging throughout the chart, with the validation loss remaining slightly larger than the training loss. Given both the shape and relative errors, we can determine that the Autoencoder model does not suffer from underfitting or overfitting.", "Now, we can define the reconstruction error, one of the core principles of the Autoencoder model. The reconstruction error is denoted as train_mae_loss, with the reconstruction error threshold determined as the maximal value of train_mae_loss. Consequently, when the test error is calculated, any value greater than the maximal value of train_mae_loss can be considered as an outlier.", "Above, we saved the training_mean and training_std as global variables in order to use them for scaling test data. We now define the normalise_testing_values function for scaling the testing data.", "Subsequently, this function is called on the Volume column of testing_data. As such, the test_value is materialised as a numpy array.", "Following this, the generate_testing_loss function is defined, calculating the difference between the reconstructed data and the testing data. If any values are greater than the maximal value of train_mae_loss, they are stored within the global anomalies list.", "Additionally, a distribution of the testing MAE loss is presented, for direct comparison with the training MAE loss.", "Finally, the outliers are visually represented below.", "The outlying data, as characterised by the Autoencoder model, are presented in orange, whilst conformant data is presented in blue.", "We can see that a large proportion of Bitcoin Volume data in 2020 was considered to be anomalous \u2014 maybe due to increased retail trading activity driven by Covid-19?", "Experiment with the Autoencoder parameters and dataset \u2014 see if you can find any anomalies within Bitcoin closing price \u2014 or alternatively use the Historic-Crypto library to download different Cryptocurrencies!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Current PhD Student in Economics, interests in Machine Learning, Deep Learning and Systematic Trading."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb82e2c230ed9&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@David.W1?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@David.W1?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": "David Woroniuk"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F47ee809475b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&user=David+Woroniuk&userId=47ee809475b8&source=post_page-47ee809475b8----b82e2c230ed9---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb82e2c230ed9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb82e2c230ed9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/questions-96667b06af5", "anchor_text": "rules and guidelines"}, {"url": "https://towardsdatascience.com/readers-terms-b5d780a700a4", "anchor_text": "Reader Terms"}, {"url": "https://github.com/David-Woroniuk/Historic_Crypto", "anchor_text": "Historic-Crypto Package"}, {"url": "https://github.com/David-Woroniuk/Medium-Articles/blob/master/RNN_Time_Series_Outlier_Detection.ipynb", "anchor_text": "Code"}, {"url": "https://github.com/David-Woroniuk/Historic_Crypto", "anchor_text": "Historic-Crypto"}, {"url": "https://github.com/David-Woroniuk/Historic_Crypto", "anchor_text": "Historic-Crypto"}, {"url": "https://medium.com/tag/cryptocurrency?source=post_page-----b82e2c230ed9---------------cryptocurrency-----------------", "anchor_text": "Cryptocurrency"}, {"url": "https://medium.com/tag/data-science?source=post_page-----b82e2c230ed9---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----b82e2c230ed9---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----b82e2c230ed9---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/classification-models?source=post_page-----b82e2c230ed9---------------classification_models-----------------", "anchor_text": "Classification Models"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb82e2c230ed9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&user=David+Woroniuk&userId=47ee809475b8&source=-----b82e2c230ed9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fb82e2c230ed9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&user=David+Woroniuk&userId=47ee809475b8&source=-----b82e2c230ed9---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb82e2c230ed9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fb82e2c230ed9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----b82e2c230ed9---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----b82e2c230ed9--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@David.W1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@David.W1?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "David Woroniuk"}, {"url": "https://medium.com/@David.W1/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "93 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F47ee809475b8&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&user=David+Woroniuk&userId=47ee809475b8&source=post_page-47ee809475b8--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F47ee809475b8%2Flazily-enable-writer-subscription&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Foutlier-detection-with-rnn-autoencoders-b82e2c230ed9&user=David+Woroniuk&userId=47ee809475b8&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}