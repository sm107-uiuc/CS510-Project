{"url": "https://towardsdatascience.com/from-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540", "time": 1683018034.513598, "path": "towardsdatascience.com/from-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540/", "webpage": {"metadata": {"title": "From LISA To COCO: Annotated Image Dataset Format Conversion | by Rub\u00e9n Romero | Towards Data Science", "h1": "From LISA To COCO: Annotated Image Dataset Format Conversion", "description": "Some time ago I was working with the LISA Traffic Lights Dataset, training a neural network for some (boring) task definitely irrelevant for the purpose of this article. My context was very specific\u2026"}, "outgoing_paragraph_urls": [{"url": "http://cvrr.ucsd.edu/LISA/lisa-traffic-sign-dataset.html", "anchor_text": "LISA Traffic Lights Dataset", "paragraph_index": 0}, {"url": "https://cocodataset.org/#home", "anchor_text": "COCO (Common Objects in Context)", "paragraph_index": 4}, {"url": "https://towardsdatascience.com/master-the-coco-dataset-for-semantic-image-segmentation-part-1-of-2-732712631047", "anchor_text": "this tutorial", "paragraph_index": 4}, {"url": "https://medium.com/u/31356c339457?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "Viraf", "paragraph_index": 4}, {"url": "https://github.com/ruromgar/lisa_coco_converter", "anchor_text": "the code in GitHub", "paragraph_index": 21}, {"url": "http://ieeexplore.ieee.org/document/7398055/", "anchor_text": "Vision for Looking at Traffic Lights: Issues, Survey, and Perspectives", "paragraph_index": 22}, {"url": "http://ieeexplore.ieee.org/document/7313470/", "anchor_text": "Traffic light detection: A learning algorithm and evaluations on challenging dataset", "paragraph_index": 23}], "all_paragraphs": ["Some time ago I was working with the LISA Traffic Lights Dataset, training a neural network for some (boring) task definitely irrelevant for the purpose of this article. My context was very specific: LISA was a mandatory requirement, and I wanted to try as many different network architectures as possible so I was using boilerplates and implementations from GitHub instead of coding them from scratch. But the problem is that no one designs their networks with LISA in mind; COCO is the standard de facto, and if you\u2019ve worked with image detection or classification problems I bet you\u2019re probably nodding right now. So I had a very big problem: I couldn\u2019t switch to COCO, but I didn\u2019t want to spend that much time adapting every one of the boilerplates to work with LISA. There was only one sensible way left: converting LISA annotations to COCO format. The main issue? Such converter did not exist \u2014 I had to do it myself.", "If you\u2019ve read until this point and you\u2019re still interested I\u2019d bet a fairly big amount of money to the fact that you don\u2019t need context at all \u2014 but please allow me to explain a little bit before going down to the code.", "Both LISA and COCO are annotated image datasets. LISA contains just traffic lights images within seven categories: Go, GoLeft, GoForward, Stop, StopLeft, Warning and WarningLeft. Quoting the description provided by the authors:", "The database is collected in San Diego, California, USA. The database provides four day-time and two night-time sequences primarily used for testing, providing 23 minutes and 25 seconds of driving in Pacific Beach and La Jolla, San Diego. The stereo image pairs are acquired using the Point Grey\u2019s Bumblebee XB3 (BBX3\u201313S2C-60) which contains three lenses which capture images with a resolution of 1280 x 960, each with a Field of View(FoV) of 66\u00b0.", "On the other hand, COCO (Common Objects in Context) is a \u201clarge-scale object detection, segmentation, and captioning dataset\u201d, with more than 200K labeled images within 91 categories. Presented by Microsoft in 2014, it has since gaining traction and it is now one of the most popular datasets out there for detection and classification tasks \u2014 a quick search throws lots of really good stuff related to its usage, like this tutorial from Viraf. However, we\u2019re not as interested here in the dataset itself as we are in its annotations.", "COCO has three folders of images: train, val and annotations, whereas LISA has multiple folders for subsets of the images. Both datasets consist of a bunch of pictures and a file (or files, in LISA\u2019s case) with annotations of what is in the picture and where is it located within it. Theoretically, the only thing we\u2019d need to do to go from one to another would be translating that file to the other dataset\u2019s format. Let\u2019s take a deeper look at those formats.", "COCO format is fairly easy: the annotations are in a unique JSON file (one for train and one for val) with five keys:", "The info and licenses keys describe the dataset itself:", "The images key is a list of the attributes of the images: licenses, filenames, sizes and dates:", "The categories key is \u2014 quite obviously \u2014 the list of categories, grouped by parent categories.", "And finally, the annotations key: the most complex and important one. It consists of a list of attributes of the object inside the image:", "Unlike COCO, LISA has a different annotation CSV file for each folder. The files share a common structure; each one of the rows has ten columns:", "So basically what we need is to convert the data we have in the CSVs from LISA to the JSON format COCO expects.", "We can easily list the tasks we need to do for converting from LISA to COCO:", "Bullet points 1, 2 and 5 are easy enough to do with any scripting language like Python or Bash and I\u2019m not going to cover them here. Check out the code in GitHub \u2014 I provide an implementation there. Bullet point 3 is also quite easy with Python; first we need to create an empty Dataframe with the columns we\u2019re expecting:", "And then merge all the existing files into it:", "And finally, the main task: the 4th point, translation from LISA to COCO. I have defined a method to generate the info and licenses keys:", "The images key is also easy \u2014 we just need to iterate through all the folders of the dataset checking the filenames:", "The categories key is also trivial once we have all the annotations merged in a unique file \u2014 all the categories are contained there, so we can take advantage of the unique() and tolist() methods from Pandas:", "The annotations key is the trickiest. I\u2019ve defined a set of auxiliary functions to calculate those parameters from the (X, Y) points provided from LISA:", "And then a main function to wrap everything together. Gets the images and categories list as a parameter, plus a flag to distinguish between train and test. Gets the CSV file, previously merged, with the annotations, and casts it to a list of lists. From that list, the JSON is generated:", "Okay \u2014 solved! We now have a powerful tool to convert the LISA dataset to the COCO format, allowing us to use it with the myriad of implementations that only accept the latter. You can check the code in GitHub.", "[1] M. B. Jensen, M. P. Philipsen, A. M\u00f8gelmose, T. B. Moeslund and M. M. Trivedi, Vision for Looking at Traffic Lights: Issues, Survey, and Perspectives (2016), IEEE Transactions on Intelligent Transportation Systems", "[2] M. P. Philipsen, M. B. Jensen, A. M\u00f8gelmose, T. B. Moeslund and M. M. Trivedi, Traffic light detection: A learning algorithm and evaluations on challenging dataset (2015), Intelligent transportation systems (ITSC)", "[3] T-Y Lin et al, Microsoft coco: Common objects in context (2014), European conference on computer vision", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Mostly tech stuff. Python & ML Engineer. Tryin' to do it right. He/Him."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F69ffa68e540&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----69ffa68e540--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@ruromgar?source=post_page-----69ffa68e540--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruromgar?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "Rub\u00e9n Romero"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff1f5d846c826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&user=Rub%C3%A9n+Romero&userId=f1f5d846c826&source=post_page-f1f5d846c826----69ffa68e540---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69ffa68e540&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69ffa68e540&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://towardsdatascience.com/tagged/making-sense-of-big-data", "anchor_text": "Making Sense of Big Data"}, {"url": "https://towardsdatascience.com/tagged/hands-on-tutorials", "anchor_text": "Hands-On Tutorials"}, {"url": "https://unsplash.com/@lewypee?utm_source=medium&utm_medium=referral", "anchor_text": "Lewis Parsons"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "http://cvrr.ucsd.edu/LISA/lisa-traffic-sign-dataset.html", "anchor_text": "LISA Traffic Lights Dataset"}, {"url": "https://cocodataset.org/#home", "anchor_text": "COCO (Common Objects in Context)"}, {"url": "https://towardsdatascience.com/master-the-coco-dataset-for-semantic-image-segmentation-part-1-of-2-732712631047", "anchor_text": "this tutorial"}, {"url": "https://medium.com/u/31356c339457?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "Viraf"}, {"url": "http://cvrr.ucsd.edu/LISA/lisa-traffic-sign-dataset.html", "anchor_text": "cvrr.ucsd.edu/LISA/lisa-traffic-sign-dataset.html"}, {"url": "https://creativecommons.org/licenses/by-nc-sa/4.0/", "anchor_text": "creativecommons.org/licenses/by-nc-sa/4.0/"}, {"url": "https://github.com/ruromgar/lisa_coco_converter", "anchor_text": "the code in GitHub"}, {"url": "http://ieeexplore.ieee.org/document/7398055/", "anchor_text": "Vision for Looking at Traffic Lights: Issues, Survey, and Perspectives"}, {"url": "http://ieeexplore.ieee.org/document/7313470/", "anchor_text": "Traffic light detection: A learning algorithm and evaluations on challenging dataset"}, {"url": "https://medium.com/tag/object-detection?source=post_page-----69ffa68e540---------------object_detection-----------------", "anchor_text": "Object Detection"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----69ffa68e540---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/hands-on-tutorials?source=post_page-----69ffa68e540---------------hands_on_tutorials-----------------", "anchor_text": "Hands On Tutorials"}, {"url": "https://medium.com/tag/editors-pick?source=post_page-----69ffa68e540---------------editors_pick-----------------", "anchor_text": "Editors Pick"}, {"url": "https://medium.com/tag/making-sense-of-big-data?source=post_page-----69ffa68e540---------------making_sense_of_big_data-----------------", "anchor_text": "Making Sense Of Big Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F69ffa68e540&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&user=Rub%C3%A9n+Romero&userId=f1f5d846c826&source=-----69ffa68e540---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F69ffa68e540&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&user=Rub%C3%A9n+Romero&userId=f1f5d846c826&source=-----69ffa68e540---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F69ffa68e540&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F69ffa68e540&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----69ffa68e540---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----69ffa68e540--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----69ffa68e540--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----69ffa68e540--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----69ffa68e540--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----69ffa68e540--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruromgar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@ruromgar?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Rub\u00e9n Romero"}, {"url": "https://medium.com/@ruromgar/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "461 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff1f5d846c826&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&user=Rub%C3%A9n+Romero&userId=f1f5d846c826&source=post_page-f1f5d846c826--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb5edabd078d5&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Ffrom-lisa-to-coco-annotated-image-dataset-format-conversion-69ffa68e540&newsletterV3=f1f5d846c826&newsletterV3Id=b5edabd078d5&user=Rub%C3%A9n+Romero&userId=f1f5d846c826&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}