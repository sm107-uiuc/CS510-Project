{"url": "https://towardsdatascience.com/linear-regression-by-hand-python-and-r-79994d47f68", "time": 1683014914.324894, "path": "towardsdatascience.com/linear-regression-by-hand-python-and-r-79994d47f68/", "webpage": {"metadata": {"title": "Linear Regression by Hand. Explanation on how to model a linear\u2026 | by Roman Studer | Towards Data Science", "h1": "Linear Regression by Hand", "description": "The basic idea behind linear regression is quite simple. In mathematical terms we want to predict a dependent variable Y using an independent variable X. By assuming that the two variables correlate\u2026"}, "outgoing_paragraph_urls": [{"url": "https://en.wikipedia.org/wiki/Least_squares", "anchor_text": "method of least squares", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent#:~:text=Gradient%20descent%20is%20a%20first,function%20at%20the%20current%20point.", "anchor_text": "gradient descent", "paragraph_index": 8}, {"url": "https://www.google.com/url?sa=i&url=https%3A%2F%2Fstudentportalen.uu.se%2Fportal%2Fauthsec%2Fportal%2Fuusp%2Fstudent%2Ffilearea%2Ffilearea-window%3Bjsessionid%3DB12D1B2482594C80E800CE07AD487EC0%3Fmode%3Dview%26webwork.portlet.portletNamespace%3D%252Ffilearea%252Fview%26webwork.portlet.action%3D%252Ffilearea%252Fview%252Fopen%26action%3Dd%26entityId%3D159813%26toolAttachmentId%3D543079%26windowstate%3Dnormal%26nodeId%3D2279919%26webwork.portlet.mode%3Dview&psig=AOvVaw2LogR2IrcVd6xnuYYDSKms&ust=1601980213820000&source=images&cd=vfe&ved=0CA0QjhxqFwoTCPCGxr-fnewCFQAAAAAdAAAAABAP", "anchor_text": "here", "paragraph_index": 17}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "documentation", "paragraph_index": 23}], "all_paragraphs": ["The basic idea behind linear regression is quite simple. In mathematical terms we want to predict a dependent variable Y using an independent variable X. By assuming that the two variables correlate in a linear fashion we can predict Y with a simple linear formula:", "(The wavy equal sign signifies \u201capproximately\u201d). Simply put, as soon as we know a bit about the relationship between the two coefficients, i.e. we have approximated the two coefficients \u03b1 and \u03b2, we can (with some confidence) predict Y. Alpha \u03b1 represents the intercept (value of y with f(x = 0)) and Beta \u03b2 is the slope.", "With the help of linear regression, we can answer a lot of questions; e.g.", "Let\u2019s take a look at some data! Even though the observations in the plot above deviate quite a bit, a trend is clearly visible. This indicates a positive correlation between X and Y. We can approximate the linear function that models the relationship between the two by utilizing the method of least squares. Let", "be a set of observations, represented as dots in the scatterplot. The method of least squares can now be applied to approximate the coefficients \u03b1 and \u03b2.", "The method minimizes the sum of squared error for the linear regression line (Which is the cost function for linear regression, to put it in machine learning terms). The error is represented as the orange lines in the next plot. By differentiating the equation into beta, we get the following formula:", "x and y with a bar on top represent the sample mean of x and y.", "By plugging the approximated \u03b2 into the linear equation, we get the approximation for \u03b1:", "Alternatively, you could minimize the cost function through gradient descent. Now that we know the approximated coefficients for our linear regression, we can plot the equation and do a first visual inspection.", "The green line in our plot represents the linear equation whose coefficients we just approximated. The orange arrows are the errors (also called the residuals), they tell us how much the observations deviate from our predicted values. The smaller the sum of errors, the better the regression line fits. A sum of 0 would be a perfect fit, meaning all observations are perfectly linear.", "The interpretation of the errors/residues is an important step in building a regression model. By taking a look at the residues we can tell how they are distributed (normal with mean 0 is best)and if they are homoscedastic, i.e. whether the variance of the residues is constant.", "Residual Sum of Squares (RSS) and Residual Standard Error(RSE)", "A residue is a difference between the predicted value y hat (i.e. approximated) and the observed value y, visualized as the orange line in the plot above. The residual sum of squares RSS is defined by the following formula:", "With the help of RSS, we can compute the Residual Standard Error (RSE). The RSE is an estimate for the standard deviation of the true regression line. This means that on average the value of y is one RSE away from the true regression line. The true regression line, also known as the population regression line, describes the real relationship between X and Y. We calculate the RSE as followed:", "A visual representation of the residues can be helpful. The residues of a good fit meet three criteria:", "With the help of a Tukey-Anscombe-Diagram and a simple Histogram, we can check the residues on the criteria. A Tukey-Anscombe-Diagram is a Scatterplot that visualizes the residues. The green line (y=0) represents the regression line. Now we can see how the residues are arranged around the regression line:", "The visual inspection shows that the residues are independent (they don\u2019t follow a pattern, i.e no systematic errors), the mean of the residues is 0 and they follow a normal distribution.", "Click here to view some bad Tukey-Anscome-Diagrams (PDF).", "One other way to assess the regression model is the R-Squared value. It tells us how well the model fits the data by measuring the proportion of the variability in Y that can be explained by X. For that we need the RSS and Total Sum of Squares (TSS).", "where TSS is the total sum of squares calculated by", "R Squared can take on values in the interval 0 to 1. A result close to 1 would mean that a lot of variability can be \u2018explained\u2019 by the regression. A result closer to 0 can indicate that we have a poor model. This might indicate that the linear model is wrong or that the variance of the error is high.", "The easiest way to do a linear regression is by utilizing the sklearn library.", "We start by importing the necessary libraries and then define our data (X and Y). Please note that the data could just as easily be from a DataFrame. The next step is to fit our Model by calling the LinearRegression().fit(x,y) method on our data. This returns an object containing our regression model which now can be used to predict y for x.", "For further information about how sklearns Linear Regression works, visit the documentation.", "R already has a built-in function to do linear regression called lm() (lm stands for linear models). We fit the model by plugging in our data for X and Y. summary() returns a nice overview of our model. Look at that: R-Squared is the same as if we calculate it with Python.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F79994d47f68&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----79994d47f68--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----79994d47f68--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@roman.studer?source=post_page-----79994d47f68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roman.studer?source=post_page-----79994d47f68--------------------------------", "anchor_text": "Roman Studer"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d099f5db816&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&user=Roman+Studer&userId=9d099f5db816&source=post_page-9d099f5db816----79994d47f68---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79994d47f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79994d47f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chuttersnap?utm_source=medium&utm_medium=referral", "anchor_text": "CHUTTERSNAP"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://en.wikipedia.org/wiki/Least_squares", "anchor_text": "method of least squares"}, {"url": "https://en.wikipedia.org/wiki/Gradient_descent#:~:text=Gradient%20descent%20is%20a%20first,function%20at%20the%20current%20point.", "anchor_text": "gradient descent"}, {"url": "https://www.google.com/url?sa=i&url=https%3A%2F%2Fstudentportalen.uu.se%2Fportal%2Fauthsec%2Fportal%2Fuusp%2Fstudent%2Ffilearea%2Ffilearea-window%3Bjsessionid%3DB12D1B2482594C80E800CE07AD487EC0%3Fmode%3Dview%26webwork.portlet.portletNamespace%3D%252Ffilearea%252Fview%26webwork.portlet.action%3D%252Ffilearea%252Fview%252Fopen%26action%3Dd%26entityId%3D159813%26toolAttachmentId%3D543079%26windowstate%3Dnormal%26nodeId%3D2279919%26webwork.portlet.mode%3Dview&psig=AOvVaw2LogR2IrcVd6xnuYYDSKms&ust=1601980213820000&source=images&cd=vfe&ved=0CA0QjhxqFwoTCPCGxr-fnewCFQAAAAAdAAAAABAP", "anchor_text": "here"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "documentation"}, {"url": "http://link.springer.com/10.1007/978-1-4614-7138-7", "anchor_text": "http://link.springer.com/10.1007/978-1-4614-7138-7"}, {"url": "https://en.wikipedia.org/w/index.php?title=Least_squares&oldid=978615667", "anchor_text": "https://en.wikipedia.org/w/index.php?title=Least_squares&oldid=978615667"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html", "anchor_text": "https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"}, {"url": "https://medium.com/tag/data-science?source=post_page-----79994d47f68---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/linear-regression?source=post_page-----79994d47f68---------------linear_regression-----------------", "anchor_text": "Linear Regression"}, {"url": "https://medium.com/tag/mathematics?source=post_page-----79994d47f68---------------mathematics-----------------", "anchor_text": "Mathematics"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----79994d47f68---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/machine-learning-python?source=post_page-----79994d47f68---------------machine_learning_python-----------------", "anchor_text": "Machine Learning Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F79994d47f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&user=Roman+Studer&userId=9d099f5db816&source=-----79994d47f68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F79994d47f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&user=Roman+Studer&userId=9d099f5db816&source=-----79994d47f68---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79994d47f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----79994d47f68--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F79994d47f68&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----79994d47f68---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----79994d47f68--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----79994d47f68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----79994d47f68--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----79994d47f68--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----79994d47f68--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----79994d47f68--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----79994d47f68--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----79994d47f68--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roman.studer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@roman.studer?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Roman Studer"}, {"url": "https://medium.com/@roman.studer/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "25 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d099f5db816&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&user=Roman+Studer&userId=9d099f5db816&source=post_page-9d099f5db816--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F9d12aa61fee6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Flinear-regression-by-hand-python-and-r-79994d47f68&newsletterV3=9d099f5db816&newsletterV3Id=9d12aa61fee6&user=Roman+Studer&userId=9d099f5db816&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}