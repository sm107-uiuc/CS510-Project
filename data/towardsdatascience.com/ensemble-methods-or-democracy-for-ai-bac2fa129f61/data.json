{"url": "https://towardsdatascience.com/ensemble-methods-or-democracy-for-ai-bac2fa129f61", "time": 1683001684.777052, "path": "towardsdatascience.com/ensemble-methods-or-democracy-for-ai-bac2fa129f61/", "webpage": {"metadata": {"title": "Ensemble Methods, from Intuition to Implementation | by Mehdi Amine | Towards Data Science", "h1": "Ensemble Methods, from Intuition to Implementation", "description": "My purpose is to help you build an intuition for what Ensemble Methods are and how they work. This article begins by assuming no previous knowledge about this topic. Specifically, this introduction\u2026"}, "outgoing_paragraph_urls": [{"url": "https://demonstrations.wolfram.com/SimulatedCoinTossingExperimentsAndTheLawOfLargeNumbers/#more", "anchor_text": "Wolfram simulation", "paragraph_index": 7}, {"url": "https://stattrek.com/online-calculator/binomial.aspx", "anchor_text": "binomial probability calculator", "paragraph_index": 15}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_moons.html", "anchor_text": "make_moons", "paragraph_index": 22}, {"url": "https://www.linkedin.com/in/mehdi-amine", "anchor_text": "https://www.linkedin.com/in/mehdi-amine", "paragraph_index": 32}], "all_paragraphs": ["My purpose is to help you build an intuition for what Ensemble Methods are and how they work. This article begins by assuming no previous knowledge about this topic. Specifically, this introduction is about acquiring a mental model. A mental model is meant to help you draw similarities between concepts that you are familiar with and the new concepts you are about to learn.", "It might seem unrelated to talk about democracy, voting, and diversity in an article about Machine Learning. Nonetheless, these same concepts apply in the world of Artificial Intelligence, in much the same way as they do in our world. I have taken the liberty to adopt a rather light tone in my titles and throughout the article. My hope is that you keep learning while feeling entertained.", "Several slightly educated guesses are in many cases better than one very educated guess. This is the wisdom of the crowd prevailing over an individual\u2019s expertise. Such a crowd comprises various perspectives that once aggregated, create a meta-perspective more accurate than the most accurate individual perspective. But for all the good this brings, a few assumptions have to be satisfied:", "Perhaps we created Machine Learning Models in our own image, and made them rule over themselves with democ.. Ensemble Methods.", "I want you to grab a coin, toss it a couple times and keep record of what you get. It is unlikely that out of 10 tosses, 5 were heads and 5 were tails. Unlikely still that out of 100 tosses, 50 were heads and 50 were tails... Even if your coin is perfectly balanced, it will still be unlikely that you get an equal number of heads and tails. Just about the same would apply if you were to toss a coin that was made and measured to give tails 80% of the time; it\u2019s unlikely that you would get 8 Tails in 10 tosses, or 16 Tails in 20 tosses, or 80 Tails in 100 tosses\u2026", "It is not uncommon to toss a fair coin a number of times and get a large majority of heads or tails. For example you could toss a coin 10 times and get 8 heads and 2 tails. The probability of a toss landing head or tail is equal; it is 0.5 for heads and 0.5 for tails. So why is it possible to get a large majority of one outcome. Why not always get 5 heads and 5 tails out of every 10 tosses since they are both equally likely outcomes?", "In trying to explain why this happens, people sometimes fall into the gambler\u2019s bias: since most of the tosses made by a fair coin so far have been yielding heads, it is more likely that the next toss will yield a tail. As if the coin is keeping track of previous outcomes and feels responsible to come back when it errs. But this isn\u2019t the case, because every toss is an independent event. This brings us to the fundamental question: what does probability of outcome mean?", "Have a look and maybe tinker for a while with this Wolfram simulation. Go on unrestrained, you can always go back to the initial settings from the \u2018+\u2019 on the top right corner. I will be here when you come back, and continue from where you left.", "What you see are 6 fair coins (0.5 probability of heads), tossed 1000 times each (according to the demonstration description). The random seed is a value used to generate randomness and if needed, reproduce the same randomness. The grey horizontal line is always set to the value of the probability of heads, here 0.5.", "In every experiment, the proportion of heads approaches the line of the probability of heads as the number of tosses increases. If we went on increasing the number of tosses, eventually the proportion of heads will become equal to the probability of heads. This is true regardless of how many experiments you repeat and regardless of the value you set for the probability you assign to the coin. And this is the law of large numbers.", "To summarize, we saw that using 6 similar coins and tossing each one of them 1000 times made the ratio of heads closer to the probability of heads. We could also have tossed 6000 similar coins and we would have noticed a similar outcome; the proportion of heads will always converge to the probability of heads.", "Sometimes you try your best to train a machine and a model with 51% accuracy is all you have to show for it. If you find yourself in such dreadful times do not despair, use the law of large numbers instead.", "A machine that is correct 51% of the time is only slightly better than random. But if you could duplicate it into 1000 models, then aggregate their individual answers into a vote, the answer with the majority of votes would be correct 73% of the time. With 10000 of these models, the voted answer would be correct 97% of the time. This is because the probability of getting a majority of good answers increases with the number of models.", "This can be visualized again with coin tossing. Coins with 51% probability of giving head will have an increasing probability of giving a majority of heads as the number of tosses increases.", "If you want to verify for yourself that with more models you can increase the probability that they will vote the correct answer, you can compute the cumulative binomial probability:", "To apply this formula to 1000 models with 0.51 accuracy each, you would have to sum the binomial probability of 501 models collectively voting the correct answer, and the binomial probability of 502 models collectively voting the correct answer, \u2026, and the binomial probability of 1000 models collectively voting the correct answer. But life is for living and you can just use this binomial probability calculator instead.", "Certainly, it does not seem computationally efficient to build thousands of models for the same task. But we have started with a rather bad case scenario by setting the accuracy to be slightly better than random guessing. Often times you will resort to using this method after having trained a few models and selecting the best ones. And by grouping a set of decent models, you can get substantial improvement with much fewer models. But for all the good this brings, a few assumptions have to be satisfied.", "Quick terminology: in Machine Learning, a group of models is called an Ensemble.", "Machines, like their creators benefit from the wisdom of the ensemble, provided they satisfy the same major assumptions:", "Quick terminology: the second option above is called Bagging (short for Bootstrap Aggregating) when randomly sampling the subsets allows for instances to be selected more than once (we say sampling with replacement). However, it is called Pasting when sampling is performed without replacement. The third option is called The Random Subspaces Method. The fourth option is called The Random Patches Method.", "The next part will elaborate by providing practical examples.", "Python hisses beckon to the tree from which they will learn", "The dataset we will work with is called make_moons. We will use it to generate 500 instances with 2 features. Each instance will belong to either the \u20180\u2019 class or the \u20181\u2019 class.", "The next step is splitting the dataset for training and testing purposes.", "We will create three models, with three different algorithms: a decision tree classifier, a logistic regression classifier, and a support vector classifier. We will train them to classify instances into one of the two classes. Then we will ask them based on what they learned to guess whether each instance in X_test belongs to class 0 or class 1. Finally, we will evaluate their accuracy by comparing their guesses (predictions) with the actual labels y_test.", "The SVC model is the most accurate with 0.896 accuracy. Let\u2019s combine the three models into one ensemble model.", "The code above creates an ensemble called a VotingClassifier. Every time the ensemble is asked to make a prediction on whether an instance is class 0 or 1, the three models make a prediction each, and the ensemble outputs the majority voted class. This is called hard voting.", "Soft voting on the other hand is a little step ahead and can lead to better accuracy. Instead of simply asking the individual classifiers to make predictions, we can ask them to output a measure of their confidence in their predictions. Thus it will be possible to attribute more or less credibility for predictions depending on the confidence measure.", "We can rely on duplicating the same model to make an ensemble, and teach something different for each individual model. The following code implements the Bagging technique discussed at the end of part 2.", "Random Subspaces is another way to use different data to teach the individual models of the ensemble. Instead of randomly sampling instances from the training set, it randomly samples features. Not practical for our dataset as we only have two features x1 and x2, but definitely worth trying with more complicated datasets. To use it, simply replace \u201cmax_samples\u201d in the code above to \u201cmax_features\u201d.", "Finally, Random Patches combines Bagging and Random Subspaces. To use it, set values for both \u201cmax_samples\u201d and \u201cmax_features\u201d.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Writer. AI Researcher. MSc Advanced Computer Science Intelligent Systems. BSc Computer Science and Mathematics. https://www.linkedin.com/in/mehdi-amine"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbac2fa129f61&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@m.e.mehdi.amine?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.e.mehdi.amine?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": "Mehdi Amine"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff6182caa5a35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&user=Mehdi+Amine&userId=f6182caa5a35&source=post_page-f6182caa5a35----bac2fa129f61---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbac2fa129f61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbac2fa129f61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://demonstrations.wolfram.com/SimulatedCoinTossingExperimentsAndTheLawOfLargeNumbers/#more", "anchor_text": "Wolfram simulation"}, {"url": "https://stattrek.com/online-calculator/binomial.aspx", "anchor_text": "binomial probability calculator"}, {"url": "https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_moons.html", "anchor_text": "make_moons"}, {"url": "https://demonstrations.wolfram.com/SimulatedCoinTossingExperimentsAndTheLawOfLargeNumbers/#more", "anchor_text": "Simulated Coin Tossing Experiments and the Law of Large Numbers - Wolfram Demonstrations ProjectPerhaps the simplest way to illustrate the law of large numbers is with coin flipping experiments. If a fair coin (one\u2026demonstrations.wolfram.com"}, {"url": "https://stattrek.com/online-calculator/binomial.aspx", "anchor_text": "Binomial Probability CalculatorFrequently-Asked Questions A binomial experiment has the following characteristics: The experiment involves repeated\u2026stattrek.com"}, {"url": "https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/", "anchor_text": "Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2nd EditionThrough a series of recent breakthroughs, deep learning has boosted the entire field of machine learning. Now, even\u2026www.oreilly.com"}, {"url": "https://github.com/Mehdi-Amine/models-unified/blob/master/Ensemble_Methods.ipynb", "anchor_text": "Mehdi-Amine/models-unifiedJupyter notebook with code examples github.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----bac2fa129f61---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/python?source=post_page-----bac2fa129f61---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/artificial-intelligence?source=post_page-----bac2fa129f61---------------artificial_intelligence-----------------", "anchor_text": "Artificial Intelligence"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbac2fa129f61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&user=Mehdi+Amine&userId=f6182caa5a35&source=-----bac2fa129f61---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fbac2fa129f61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&user=Mehdi+Amine&userId=f6182caa5a35&source=-----bac2fa129f61---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbac2fa129f61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fbac2fa129f61&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----bac2fa129f61---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----bac2fa129f61--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bac2fa129f61--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----bac2fa129f61--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----bac2fa129f61--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.e.mehdi.amine?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@m.e.mehdi.amine?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Mehdi Amine"}, {"url": "https://medium.com/@m.e.mehdi.amine/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "70 Followers"}, {"url": "https://www.linkedin.com/in/mehdi-amine", "anchor_text": "https://www.linkedin.com/in/mehdi-amine"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff6182caa5a35&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&user=Mehdi+Amine&userId=f6182caa5a35&source=post_page-f6182caa5a35--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F32a2916fde12&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fensemble-methods-or-democracy-for-ai-bac2fa129f61&newsletterV3=f6182caa5a35&newsletterV3Id=32a2916fde12&user=Mehdi+Amine&userId=f6182caa5a35&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}