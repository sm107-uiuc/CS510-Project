{"url": "https://towardsdatascience.com/is-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d", "time": 1683013071.1892328, "path": "towardsdatascience.com/is-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d/", "webpage": {"metadata": {"title": "Is Apache Airflow good enough for current data engineering needs? | by Anna Geller | Towards Data Science", "h1": "Is Apache Airflow good enough for current data engineering needs?", "description": "The pros and cons of Apache Airflow as a workflow management platform for ETL & Data Science and deriving from that the use cases for which Airflow may be a good or a bad choice"}, "outgoing_paragraph_urls": [{"url": "https://github.com/puckel/docker-airflow", "anchor_text": "puckel/docker-airflow", "paragraph_index": 14}, {"url": "https://github.com/astronomer/astro-cli", "anchor_text": "astro CLI", "paragraph_index": 16}, {"url": "https://www.astronomer.io/", "anchor_text": "Astronomer", "paragraph_index": 21}, {"url": "https://www.prefect.io/", "anchor_text": "Prefect", "paragraph_index": 33}, {"url": "http://www.annageller.com", "anchor_text": "www.annageller.com", "paragraph_index": 38}, {"url": "https://annageller.medium.com/subscribe", "anchor_text": "https://annageller.medium.com/subscribe", "paragraph_index": 38}], "all_paragraphs": ["Not so long ago, if you would ask any data engineer or data scientist about what tools do they use for orchestrating and scheduling their data pipelines, the default answer would likely be Apache Airflow. Even though Airflow can solve many current data engineering problems, I would argue that for some ETL & Data Science use cases it may not be the best choice.", "In this article, I will discuss the pros and cons that I experienced while working with Airflow in the last two years and derive from that the use cases for which Airflow is still a great choice. I hope that by the end of this article, you will be able to determine whether it fits your ETL & Data Science needs.", "Undeniably, Apache Airflow has an amazing community. There is a large number of individuals using Airflow and contributing to this open-source project. If you want to solve a particular data engineering problem, the chances are that somebody in the community has already solved that and shared their solution online or even contributed their implementation to the codebase.", "Many companies decided to invest in Apache Airflow and support its growth, among them:", "The support from those companies ensures that there are people working full-time to further improve the software which guarantees long-term stability, support, and training.", "The possibility to define your workflows within Python code is incredibly helpful, as it allows you to incorporate almost any custom workflow logic into your orchestration system.", "Airflow allows you to extend the functionality by:", "If you look at the number of Operators available in the Airflow Github repository, you will find that Airflow supports a wide range of connectors to external systems. This means that in many cases you will find code templates that you can use to interact with a variety of databases, execution engines, and cloud providers without having to implement the code yourself.", "The number of connectors to external systems shows that Airflow can be used as a \u201cglue\u201d that ties together data from many different sources.", "From the list of advantages listed above, you can see that, overall, Airflow is a great product for data engineering from the perspective of tying many external systems together. The community put in an amazing amount of work building a wide range of features and connectors. However, it has several weak spots that prevent me from truly loving working with it. Some of them may be fixed in future releases, so I discuss the issues as they are at the moment of writing.", "These days, when we have version control systems and different versions of our Docker images stored in the Docker registries, we take versioning for granted \u2014 it\u2019s a basic feature that simply should be there, no questions asked. However, Airflow still doesn\u2019t have it. If you delete a task from your DAG code and redeploy it, you will lose the metadata related to that task.", "I used Airflow long enough to understand its internals and to even extend its functionality by writing custom components. However, teaching a team of data engineers who haven\u2019t used Airflow before on how to use it proved time-consuming as one needs to learn an entirely new \u201csyntax\u201d. Some data engineers considered the entire experience not intuitive.", "One prominent example was related to scheduling: many (me including) found it very confusing that Airflow starts scheduling the jobs at the end of the scheduling interval. This means that the schedule interval doesn\u2019t start immediately, but only when the execution_date reaches start_date + schedule_interval. This seems to play well with batch ETL jobs that are running only once per night, but for jobs that are running every 10 minutes, it's rather confusing and may result in unexpected bugs when used by new users inexperienced with the tool, especially if the catchup option is not used properly.", "In order to start using Airflow on a local machine, a data professional new to the tool needs to learn:", "Plus, if you are a Windows user, you really can\u2019t use the tool locally unless you use docker-compose files which are not even part of the official Airflow repository \u2014 many people use puckel/docker-airflow setup. It\u2019s all doable but I wish it would be more intuitive and easier for new users.", "I know that Airflow released an official docker image in the last months, but what is still missing is an officialdocker-compose file where new users (especially Windows users) could get a full basic setup, together with a metadata database container and a bind mount to copy their DAGs into the container. An official docker-compose file would be very helpful to be able to run Airflow locally on Windows.", "If you use the Astronomer paid version of Airflow, you could use astro CLI which mitigates the problem of local testing to some extent.", "In order to obtain a production-ready setup, you really have two choices:", "My experience in setting up Airflow on AWS for the company I worked at was that you can either:", "Overall, Airflow\u2019s architecture includes many components such as:", "Those are MANY components to maintain and to ensure that they all work well together, and it seems that the open-source version of Airflow doesn\u2019t make this setup easy for the users.", "From my experience so far, choosing Astronomer seems to be the easiest choice if you want to use Airflow in production (especially if you use AWS or Azure and not GCP), as you get plenty of features added on top, such as monitoring of your nodes, pulling logs to one central place, Auth layer (and integration with Active Directories), support, SLA and the team from Astronomer will maintain at least some of the components listed above.", "There is currently no natural \u201cPythonic\u201d way of sharing data between tasks in Airflow other than by using XComs which were designed to only share small amounts of metadata (there are plans on the roadmap to introduce functional DAGs so the data sharing might get somehow better in the future).", "A task means a basic atomic unit of work in a data pipeline. Because there is no easy way of sharing data between tasks in Airflow, instead of tasks being atomic, i.e. responsible for only 1 thing (ex. only extracting the data), people often tend to use entire scripts as tasks such as a script doing entire ETL (triggered with BashOprator ex. \u201cpython stage_adwords_etl.py\u201d), which in turn makes the maintenance more difficult as you need to debug an entire script (full ETL) instead of a small atomic task (ex. only the \u201cExtract\u201d part).", "If your tasks are not atomic, you can\u2019t just retry the Load part of ETL when it fails \u2014 you need to retry the entire ETL.", "If you worked with Airflow before, you may have experienced that after hitting the Trigger DAG button in the UI, you need to wait quite a long time before you can see that the task really starts running.", "The scheduler often needs up to several minutes before the task is scheduled and picked up by the worker process to be executed, at least it was the case when I was using Airflow deployed on EC2 earlier this year. Airflow\u2019s community is working on improving the scheduler, so I hope it will get more performant in the next releases but at the time of writing this bottleneck prevents from applying Airflow to use-cases where this latency is not acceptable or desirable.", "In this article, I highlighted several times that Airflow works well when all it needs to do is to schedule jobs that:", "Airflow was not designed to execute any workflows directly inside of Airflow, but just to schedule them and to keep the execution within external systems.", "This implies that Airflow is still a good choice if your task is, for instance, to submit a Spark job and store the data on a Hadoop cluster or to execute some SQL transformation in Snowflake or to trigger a SageMaker training job.", "To give you an example: imagine a company where data engineers are creating ETL jobs in Pentaho Data Integration and they are using CeleryExecutor to orchestrate BashOperator tasks on an AWS EC2 instance. Those jobs are not dockerized and the task is just to schedule a bash command to run on a particular server. Airflow works well in this use case.", "If all you need to do in your workflow system is to submit some bash command to an external system and your actual data flow is defined within Spark, SageMaker, or, as in the example above, in Pentaho Data Integration, Airflow should work quite well for you, because data dependencies are managed by those external systems and Airflow only needs to manage the state dependencies between the tasks. The same is true if you use some in-memory databases such as Snowflake, Exasol, or SAP Hana, where the actual work is executed within those databases and your workflow orchestration system simply submits the query to it.", "If you want that your workflow system works closely together with your execution layer and is able to pass data between the tasks within Python code, then Airflow may not be the best choice in this case.", "Airflow is only able to pass the state dependencies between tasks (plus perhaps some metadata through XComs) and NOT data dependencies. This implies that, if you build your workflows mainly in Python and you have a lot of data science use cases, which by their nature heavily rely on data sharing between tasks, other tools such as Prefect will work much better for you.", "Those are the use cases for which Prefect is a much better choice than Airflow:", "In this article, we discussed the pros and cons of Apache Airflow as a workflow orchestration solution for ETL & Data Science. After analyzing its strengths and weaknesses, we could infer that Airflow is a good choice as long as it is used for the purpose it was designed to, i.e. to only orchestrate work that is executed on external systems such as Apache Spark, Hadoop, Druid, cloud services, or when submitting SQL code to high-performance distributed databases such as Snowflake, Exasol or Redshift.", "However, Airflow is not designed to execute your data pipelines directly, so if your ETL & Data Science code needs to pass data between the tasks, needs to be dynamic and parametrized, needs to run in parallel, or requires a more flexible and low latency scheduler, then you may prefer other tools such as Prefect.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "DevRel, Data Professional, Cloud & .py fan. www.annageller.com. Get my articles via email: https://annageller.medium.com/subscribe"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc7019b96277d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7019b96277d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7019b96277d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://annageller.medium.com/?source=post_page-----c7019b96277d--------------------------------", "anchor_text": ""}, {"url": "https://annageller.medium.com/?source=post_page-----c7019b96277d--------------------------------", "anchor_text": "Anna Geller"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bdf5a3385cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&user=Anna+Geller&userId=5bdf5a3385cd&source=post_page-5bdf5a3385cd----c7019b96277d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7019b96277d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7019b96277d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@chrisliverani?utm_source=medium&utm_medium=referral", "anchor_text": "Chris Liverani"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://airflow.apache.org/docs/stable/plugins.html", "anchor_text": "plugins"}, {"url": "https://github.com/puckel/docker-airflow", "anchor_text": "puckel/docker-airflow"}, {"url": "https://github.com/astronomer/astro-cli", "anchor_text": "astro CLI"}, {"url": "https://www.cloudwalker.io/2019/09/30/airflow-scale-out-with-redis-and-celery/", "anchor_text": "this blog article"}, {"url": "https://www.astronomer.io/", "anchor_text": "Astronomer"}, {"url": "https://www.prefect.io/", "anchor_text": "Prefect"}, {"url": "http://distributed.dask.org/en/latest/", "anchor_text": "Dask Distributed"}, {"url": "https://towardsdatascience.com/distributed-data-pipelines-made-easy-with-aws-eks-and-prefect-106984923b30", "anchor_text": "Distributed data pipelines made easy with AWS EKS and PrefectHow to set up a distributed cloud workflow orchestration system within minutes and focus on providing value rather than\u2026towardsdatascience.com"}, {"url": "https://medium.com/tag/airflow?source=post_page-----c7019b96277d---------------airflow-----------------", "anchor_text": "Airflow"}, {"url": "https://medium.com/tag/data-engineering?source=post_page-----c7019b96277d---------------data_engineering-----------------", "anchor_text": "Data Engineering"}, {"url": "https://medium.com/tag/python?source=post_page-----c7019b96277d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/tag/data-science?source=post_page-----c7019b96277d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/data?source=post_page-----c7019b96277d---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7019b96277d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&user=Anna+Geller&userId=5bdf5a3385cd&source=-----c7019b96277d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fc7019b96277d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&user=Anna+Geller&userId=5bdf5a3385cd&source=-----c7019b96277d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fc7019b96277d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----c7019b96277d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fc7019b96277d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----c7019b96277d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----c7019b96277d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----c7019b96277d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----c7019b96277d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----c7019b96277d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c7019b96277d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c7019b96277d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----c7019b96277d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----c7019b96277d--------------------------------", "anchor_text": ""}, {"url": "https://annageller.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://annageller.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Anna Geller"}, {"url": "https://annageller.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "5.4K Followers"}, {"url": "http://www.annageller.com", "anchor_text": "www.annageller.com"}, {"url": "https://annageller.medium.com/subscribe", "anchor_text": "https://annageller.medium.com/subscribe"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5bdf5a3385cd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&user=Anna+Geller&userId=5bdf5a3385cd&source=post_page-5bdf5a3385cd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F908ff40c4340&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fis-apache-airflow-good-enough-for-current-data-engineering-needs-c7019b96277d&newsletterV3=5bdf5a3385cd&newsletterV3Id=908ff40c4340&user=Anna+Geller&userId=5bdf5a3385cd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}