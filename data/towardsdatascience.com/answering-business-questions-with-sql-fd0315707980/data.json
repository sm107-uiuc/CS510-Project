{"url": "https://towardsdatascience.com/answering-business-questions-with-sql-fd0315707980", "time": 1683004249.6283321, "path": "towardsdatascience.com/answering-business-questions-with-sql-fd0315707980/", "webpage": {"metadata": {"title": "Answering Business Questions with SQL | by Lucas Morato | Towards Data Science", "h1": "Answering Business Questions with SQL", "description": "Most of the data science related jobs require you to have strong SQL skills, and it makes sense as one of the most basic tasks you will have is to accurately manipulate data. We use SQL for many\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/olist/work-at-olist-data/tree/master/datasets", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://github.com/lucasmoratof/sql-projects/blob/master/Queries%20for%20article%20-%20Answering%20Business%20Questions%20with%20SQL.sql", "anchor_text": "here", "paragraph_index": 2}, {"url": "https://www.microsoft.com/en-in/sql-server/sql-server-2019", "anchor_text": "SQL Server", "paragraph_index": 5}, {"url": "https://www.postgresql.org/", "anchor_text": "PostgreSQL", "paragraph_index": 5}, {"url": "https://www.sqlite.org/index.html", "anchor_text": "SQLite", "paragraph_index": 5}, {"url": "https://www.mysql.com/", "anchor_text": "MySQL", "paragraph_index": 5}, {"url": "https://en.wikipedia.org/wiki/SQL_window_function", "anchor_text": "window function", "paragraph_index": 7}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-ver15", "anchor_text": "common table expression", "paragraph_index": 9}], "all_paragraphs": ["Most of the data science related jobs require you to have strong SQL skills, and it makes sense as one of the most basic tasks you will have is to accurately manipulate data. We use SQL for many purposes, including exploratory data analysis, to create a filtered dataset of our data, or even to find insights about the business itself.", "Many of the SQL courses will give you an overview of how to design basic queries but is not that common that you will have the chance to practice writing queries based on real questions, using multiple tables and reproducing what we normally do as data analysts, so my goal on this tutorial is to show you how to do that using popular SQL functions like:", "Before we start, you can find the datasets here, and the SQL file to follow along the tutorial is here.", "The first step is to have a nice understanding of what kind of data we have in our hands. For today, we will use data from transactions of a Brazilian online shop. Let\u2019s have a look at how the database is organized:", "There are 8 tables, all connected by at least one field. The data comprises around 100 thousand transactions, including information about customers, payments, products and orders. There\u2019s room for a lot of possibilities, but we will focus on questions regarding sales amount. Let\u2019s imagine your manager had asked you 3 questions:", "To answer those questions I\u2019m using SQL Server, one of the most popular SQL management systems. There are many other variants available, like PostgreSQL, SQLite and MySQL. The syntax can change a little bit, but the main concepts remain the same across the different languages.", "To use as a reference, below you can find the first row of the four tables we are going to use today. Take a moment to check the field and how the tables are connected.", "For this query, we need to select the customer with the highest total purchases in each state. The data we need are in customers and order items tables, and we need to use orders as a connector. The approach we use in this case is to generate a sub-query within a window function to aggregate the result by State and select just the row with the maximum price.", "The query returns the top buyer from each of the 27 Brazilian States, below you can check the first five rows:", "Sentiment analysis is one of the trendy topics in data science, so you might need to classify it to perform analysis. We have a column with the review score, with a range from 1 to 5. For this example, we will assume that reviews with a score equal to 4 or 5 are positive and that anything else is negative. Next, we will calculate the average by each group, and for that, we need to use three tables: order_reviews, order_items and orders (again as a connector). We will use here a common table expression (CTE), it acts like a temporary table from which we can use the calculated fields to query, as we cannot use the average function directly.", "The result we got shows that the price didn\u2019t differ that much between the two sentiments. Interesting, isn\u2019t it?", "For the last query, we need the table orders and order_items. The challenge is to get the total sales from previous months and then compare the difference with the actual month. The steps we need are:", "And the result looks pretty easy to understand. Here you can visualize how volatile the sales were during 2017:", "And that\u2019s it for today! In this tutorial, you have seen how just 3 simple questions can require a variety of functions that SQL offers to you. Query design is an amazing topic to explore, where many variants can have a strong influence, so it\u2019s always a good subject to study.", "Would you make these queries differently? We are all here to learn, so please feel free to leave your comments or alternative queries on the comments. I hope you have enjoyed this text!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Senior Data Analyst @ JET, transforming data into reports that drive business decisions."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffd0315707980&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----fd0315707980--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fd0315707980--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@lmmfrederico?source=post_page-----fd0315707980--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lmmfrederico?source=post_page-----fd0315707980--------------------------------", "anchor_text": "Lucas Morato"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c3b53b3e7bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&user=Lucas+Morato&userId=2c3b53b3e7bd&source=post_page-2c3b53b3e7bd----fd0315707980---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd0315707980&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd0315707980&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/photos/lRoX0shwjUQ", "anchor_text": "Source"}, {"url": "https://github.com/olist/work-at-olist-data/tree/master/datasets", "anchor_text": "here"}, {"url": "https://github.com/lucasmoratof/sql-projects/blob/master/Queries%20for%20article%20-%20Answering%20Business%20Questions%20with%20SQL.sql", "anchor_text": "here"}, {"url": "https://github.com/olist/work-at-olist-data/blob/master/images/schema.png", "anchor_text": "Source"}, {"url": "https://www.microsoft.com/en-in/sql-server/sql-server-2019", "anchor_text": "SQL Server"}, {"url": "https://www.postgresql.org/", "anchor_text": "PostgreSQL"}, {"url": "https://www.sqlite.org/index.html", "anchor_text": "SQLite"}, {"url": "https://www.mysql.com/", "anchor_text": "MySQL"}, {"url": "https://en.wikipedia.org/wiki/SQL_window_function", "anchor_text": "window function"}, {"url": "https://github.com/lucasmoratof/sql-projects/blob/master/Queries%20for%20article%20-%20Answering%20Business%20Questions%20with%20SQL.sql", "anchor_text": "Source"}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-ver15", "anchor_text": "common table expression"}, {"url": "https://github.com/lucasmoratof/sql-projects/blob/master/Queries%20for%20article%20-%20Answering%20Business%20Questions%20with%20SQL.sql", "anchor_text": "Source"}, {"url": "https://www.techonthenet.com/sql_server/functions/lag.php", "anchor_text": "LAG()"}, {"url": "https://docs.microsoft.com/en-us/sql/t-sql/functions/format-transact-sql?view=sql-server-ver15", "anchor_text": "FORMAT()"}, {"url": "https://github.com/lucasmoratof/sql-projects/blob/master/Queries%20for%20article%20-%20Answering%20Business%20Questions%20with%20SQL.sql", "anchor_text": "Source"}, {"url": "https://medium.com/tag/sql?source=post_page-----fd0315707980---------------sql-----------------", "anchor_text": "Sql"}, {"url": "https://medium.com/tag/sql-server?source=post_page-----fd0315707980---------------sql_server-----------------", "anchor_text": "Sql Server"}, {"url": "https://medium.com/tag/data-analysis?source=post_page-----fd0315707980---------------data_analysis-----------------", "anchor_text": "Data Analysis"}, {"url": "https://medium.com/tag/data-science?source=post_page-----fd0315707980---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/learning?source=post_page-----fd0315707980---------------learning-----------------", "anchor_text": "Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffd0315707980&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&user=Lucas+Morato&userId=2c3b53b3e7bd&source=-----fd0315707980---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Ffd0315707980&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&user=Lucas+Morato&userId=2c3b53b3e7bd&source=-----fd0315707980---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffd0315707980&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----fd0315707980--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Ffd0315707980&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----fd0315707980---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----fd0315707980--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----fd0315707980--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----fd0315707980--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----fd0315707980--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fd0315707980--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fd0315707980--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----fd0315707980--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----fd0315707980--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lmmfrederico?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@lmmfrederico?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Lucas Morato"}, {"url": "https://medium.com/@lmmfrederico/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "866 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2c3b53b3e7bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&user=Lucas+Morato&userId=2c3b53b3e7bd&source=post_page-2c3b53b3e7bd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fceec0b2f7b6e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fanswering-business-questions-with-sql-fd0315707980&newsletterV3=2c3b53b3e7bd&newsletterV3Id=ceec0b2f7b6e&user=Lucas+Morato&userId=2c3b53b3e7bd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}