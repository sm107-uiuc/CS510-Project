{"url": "https://towardsdatascience.com/what-is-gumbel-softmax-7f6d9cdcb90e", "time": 1683007529.33763, "path": "towardsdatascience.com/what-is-gumbel-softmax-7f6d9cdcb90e/", "webpage": {"metadata": {"title": "What is Gumbel-Softmax?. A differentiable approximation to\u2026 | by Wanshun Wong | Towards Data Science", "h1": "What is Gumbel-Softmax?", "description": "However, the sampling process of discrete data from a categorical distribution is not differentiable, meaning that backpropagation will not work. The Gumbel-Softmax distribution is a continuous\u2026"}, "outgoing_paragraph_urls": [], "all_paragraphs": ["Very often in deep learning we want to sample discrete data. For example,", "However, the sampling process of discrete data from a categorical distribution is not differentiable, meaning that backpropagation will not work. The Gumbel-Softmax distribution is a continuous distribution that approximates samples from a categorical distribution and also works with backpropagation.", "Let Z be a categorical variable with categorical distribution Categorical(\ud835\udf0b\u2081, \u2026, \ud835\udf0b\u2093), where \ud835\udf0b\u1d62 are the class probabilities to be learned by our neural network. Assume our discrete data are encoded as one-hot vectors. The most common way of sampling Z is given by", "where i = 1, \u2026, x is the class index, and U ~ Uniform(0, 1). This sampling formula is not differentiable because of the max function. In order to obtain a differentiable approximation, we apply the following:", "The Gumbel-Max trick provides a different formula for sampling Z", "where G\u1d62 ~ Gumbel(0,1) are i.i.d. samples drawn from the standard Gumbel distribution. This is a \u201creparameterization trick\u201d, refactoring the sampling of Z into a deterministic function of the parameters and some independent noise with a fixed distribution.", "The refactoring of the sampling process does not make it differentiable. In our case the non-differentiability comes from the argmax function. However, once we have a differentiable approximation of argmax, we can do backpropagation easily as it will simply be about computing the gradient w.r.t. parameters of a deterministic function. On the other hand, without the reparameterization trick, we would have to compute the gradient w.r.t. parameters of a distribution, which is a harder problem.", "2. Using softmax as a differentiable approximation", "We use softmax as a differentiable approximation to argmax. The sample vectors y are now given by", "for every i = 1, \u2026, x. \ud835\udf0f is the temperature parameter that controls how closely the new samples approximate discrete, one-hot vectors. As \ud835\udf0f \u2192 0, the softmax computation smoothly approaches the argmax, and the sample vectors approach one-hot; as \ud835\udf0f \u2192 \u221e, the sample vectors become uniform.", "The distribution with the above sampling formula is called the Gumbel-Softmax distribution. Note that continuous vectors are used during training, but the sample vectors are discretized to one-hot vectors during evaluation.", "Whenever we have a stochastic neural network with discrete variables, we can use Gumbel-Softmax distributions to approximate the sampling process of discrete data. The network can then be trained using backpropagation, where the performance of the network will depend on the choice of the temperature parameter \ud835\udf0f.", "There are cases in which we will want to sample discrete data during training:", "We can discretize our Gumbel-Softmax sample back with argmax in the forward pass, which becomes the same as a sample from the original categorical distribution. This ensures the training and the evaluation dynamics are the same. However, we still use the Gumbel-Softmax sample in the backward pass to approximate the gradients, so that backpropagation would still work. This technique is known as Straight Through Gumbel-Softmax in literature.", "Q: How do we choose the temperature parameter \ud835\udf0f?", "A: We can have a fixed value for \ud835\udf0f. The optimal value is determined by trial and error and is quite often \u2266 1. We could also use an annealing schedule or make it a learned parameter.", "Q: How come we do not need to use Gumbel-Softmax for classification tasks, which involves discrete class labels?", "A: It is because usually there is no sampling process involved in solving classification problems. Instead, we only require our models to output probabilities of feature vectors belonging to different classes. Simply applying the softmax function is sufficient for this purpose.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7f6d9cdcb90e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@wanshunwong?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": "Wanshun Wong"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb145fb04b8bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&user=Wanshun+Wong&userId=b145fb04b8bd&source=post_page-b145fb04b8bd----7f6d9cdcb90e---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f6d9cdcb90e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f6d9cdcb90e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@pawel_czerwinski?utm_source=medium&utm_medium=referral", "anchor_text": "Pawe\u0142 Czerwi\u0144ski"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/RelaxedOneHotCategorical", "anchor_text": "tfp.distributions.RelaxedOneHotCategorical"}, {"url": "https://pytorch.org/docs/stable/nn.functional.html#gumbel-softmax", "anchor_text": "torch.nn.functional.gumbel_softmax"}, {"url": "https://papers.nips.cc/paper/6810-emergence-of-language-with-multi-agent-games-learning-to-communicate-with-sequences-of-symbols.pdf", "anchor_text": "Emergence of Language with Multi-agent Games: Learning to Communicate with Sequences of Symbols"}, {"url": "https://openreview.net/pdf?id=rkE3y85ee", "anchor_text": "Categorical Reparameterization with Gumbel-Softmax"}, {"url": "http://www.stats.ox.ac.uk/~cmaddis/pubs/concrete.pdf", "anchor_text": "The Concrete Distribution: A Continuous Relaxation of Discrete Random Variables"}, {"url": "https://openreview.net/pdf?id=rJedV3R5tm", "anchor_text": "RelGAN: Relational Generative Adversarial Networks for Text Generation"}, {"url": "https://blog.evjang.com/2016/11/tutorial-categorical-variational.html", "anchor_text": "https://blog.evjang.com/2016/11/tutorial-categorical-variational.html"}, {"url": "https://medium.com/tag/gumbel-softmax?source=post_page-----7f6d9cdcb90e---------------gumbel_softmax-----------------", "anchor_text": "Gumbel Softmax"}, {"url": "https://medium.com/tag/categorical-data?source=post_page-----7f6d9cdcb90e---------------categorical_data-----------------", "anchor_text": "Categorical Data"}, {"url": "https://medium.com/tag/reparameterization-trick?source=post_page-----7f6d9cdcb90e---------------reparameterization_trick-----------------", "anchor_text": "Reparameterization Trick"}, {"url": "https://medium.com/tag/sampling?source=post_page-----7f6d9cdcb90e---------------sampling-----------------", "anchor_text": "Sampling"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7f6d9cdcb90e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&user=Wanshun+Wong&userId=b145fb04b8bd&source=-----7f6d9cdcb90e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7f6d9cdcb90e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&user=Wanshun+Wong&userId=b145fb04b8bd&source=-----7f6d9cdcb90e---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7f6d9cdcb90e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7f6d9cdcb90e&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7f6d9cdcb90e---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7f6d9cdcb90e--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@wanshunwong?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Wanshun Wong"}, {"url": "https://medium.com/@wanshunwong/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "263 Followers"}, {"url": "https://www.linkedin.com/in/wanshunwong/", "anchor_text": "https://www.linkedin.com/in/wanshunwong/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb145fb04b8bd&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&user=Wanshun+Wong&userId=b145fb04b8bd&source=post_page-b145fb04b8bd--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fa149bfd5dd79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fwhat-is-gumbel-softmax-7f6d9cdcb90e&newsletterV3=b145fb04b8bd&newsletterV3Id=a149bfd5dd79&user=Wanshun+Wong&userId=b145fb04b8bd&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}