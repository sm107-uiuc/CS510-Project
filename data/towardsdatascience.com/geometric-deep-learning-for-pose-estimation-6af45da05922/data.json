{"url": "https://towardsdatascience.com/geometric-deep-learning-for-pose-estimation-6af45da05922", "time": 1682996287.9417229, "path": "towardsdatascience.com/geometric-deep-learning-for-pose-estimation-6af45da05922/", "webpage": {"metadata": {"title": "Geometric Deep Learning for Pose Estimation | by Vaishak V.Kumar | Towards Data Science", "h1": "Geometric Deep Learning for Pose Estimation", "description": "One of the central problems in Computer Vision and Robotics is that of understanding how objects are positioned with respect to the robot or the environment. In this post, I will explain the theory\u2026"}, "outgoing_paragraph_urls": [{"url": "https://arxiv.org/pdf/1703.04670.pdf", "anchor_text": "\u201c6-DoF Object Pose from Semantic Keypoints\u201d by Pavlakos et al", "paragraph_index": 0}], "all_paragraphs": ["One of the central problems in Computer Vision and Robotics is that of understanding how objects are positioned with respect to the robot or the environment. In this post, I will explain the theory behind and give a pytorch implementation tutorial of the paper \u201c6-DoF Object Pose from Semantic Keypoints\u201d by Pavlakos et al.", "In this approach, there are two steps. The first step is to predict \u201csemantic keypoints\u201d on the 2D image. In the second step, we estimate the pose of the object by maximizing the geometric consistency between the predicted set of semantic keypoints and a 3D model of the object using a perspective camera model.", "First, we put a bounding box on the object of interest using a standard off-the-shelf object detection algorithm such as Faster-RCNN. Then we consider only the region of the object for keypoint localization. The paper uses the \u201cstacked hourglass\u201d network architecture for this purpose. The network takes in an RGB image and outputs a set of heatmaps \u2014 one heatmap for each keypoint. The heatmaps allow the network to express its confidence over a region rather than regressing a single x,y position for a keypoint.", "As can be seen in the above image, the network has two hourglasses. Further, each hourglass has a downsampling part and an upsampling part. The purpose of the second hourglass is to refine the ouput of the first hourglass. The downsampling parts consist of alternating convolution and max-pooling layers. When the output reaches a resolution of 4 X 4, the upsampling begins. The upsampling parts consist of convolution and upsampling (deconvolution) layers. The network is trained using L2 loss on the outputs of both the first and second hourglasses.", "Now that we have the keypoints, we can use them to find the pose. All we need is a model of the object that we are interested in. The authors of the paper define a deformable model S that is composed of a mean shape B_0 added with a number of variations B_i that are computed using PCA. The shape is defined as 3xP matrix where P is the number of keypoints.", "The main optimization problem is that of reducing the below residual. Here W is the set of normalized 2D keypoints in homogenous coordinates. Z is a diagonal matrix representing the depth of the keypoints. R and T are the rotation matrix and the translation vectors respectively. The unkowns that we optimize over are Z,R,T and c.", "Below is the actual loss that we want to minimize. Here, D is the confidence of the keypoints \u2014 we do this to penalize the error on keypoints that the network is more certain about. The second term of the loss is a regularization term meant to penalize large deviations from the mean shape of the model of interest.", "That\u2019s it! The resulting R and T define the pose of the object. Now let\u2019s look at the pytorch implementation.", "For the implementation, we will closely follow code provided in CIS 580 at the University of Pennsylvania. I have simplified the code by merging some files and removing some data augmentation steps.", "Let\u2019s dive right into the code. First, we need to clone a repository:", "We need to unzip the data.zip so that the top level directory contains three folders: data, output, and utils. Now, let\u2019s run the Jupyter Notebook. The first block of code that we will inspect is the Trainer class. This class loads up the train and test datasets and runs a few transformations on it to get it to be in the format that we want. The data is cropped and padded so that we only look at the bounding box around the object of interest. Then the locations of the ground truth keypoints are expressed as heatmaps. Then the data is converted into appropriately formatted tensors and normalized. Finally, the trainer also loads up the hourglass model. Once we call the train method, we are done with keypoint localization.", "Before we begin pose optimization, we need to define a custom function that we will use a lot. The Rodrigues function will help us convert axis-angle representation vectors into 3x3 rotation matrices. We define it this way so that we can use pytorch\u2019s autograd functionality.", "Finally, we write the pose optimization function where we convert our 2D keypoints into normalized homogenous coordinates using the camera model and then compare them with the rotated and translated ground truth 3D keypoints. We stop the optimization when the loss is lower than our threshold.", "When you run the above function you should get awesome results such as these:", "That\u2019s all for the important implementation details! Make sure you run it and play around with the different hyperparameters and transformations to understand how they affect the results. I hope this has been helpful. Please send me any comments or corrections!", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Trying to build thinking machines that can help solve humanity\u2019s biggest problems"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6af45da05922&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----6af45da05922--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6af45da05922--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@vaishakvk?source=post_page-----6af45da05922--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vaishakvk?source=post_page-----6af45da05922--------------------------------", "anchor_text": "Vaishak V.Kumar"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F61d2676ad14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&user=Vaishak+V.Kumar&userId=61d2676ad14&source=post_page-61d2676ad14----6af45da05922---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6af45da05922&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6af45da05922&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/pdf/1703.04670.pdf", "anchor_text": "\u201c6-DoF Object Pose from Semantic Keypoints\u201d by Pavlakos et al"}, {"url": "https://github.com/vaishak2future/posefromkeypoints.git", "anchor_text": "https://github.com/vaishak2future/posefromkeypoints.git"}, {"url": "https://arxiv.org/pdf/1703.04670.pdf", "anchor_text": "[1] G.Pavlakos et al. 2017. 6-DoF Object Pose from Semantic Keypoints"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----6af45da05922---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/computer-vision?source=post_page-----6af45da05922---------------computer_vision-----------------", "anchor_text": "Computer Vision"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----6af45da05922---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/robotics?source=post_page-----6af45da05922---------------robotics-----------------", "anchor_text": "Robotics"}, {"url": "https://medium.com/tag/pose-estimation?source=post_page-----6af45da05922---------------pose_estimation-----------------", "anchor_text": "Pose Estimation"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6af45da05922&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&user=Vaishak+V.Kumar&userId=61d2676ad14&source=-----6af45da05922---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F6af45da05922&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&user=Vaishak+V.Kumar&userId=61d2676ad14&source=-----6af45da05922---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6af45da05922&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----6af45da05922--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F6af45da05922&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----6af45da05922---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----6af45da05922--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----6af45da05922--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----6af45da05922--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----6af45da05922--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6af45da05922--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6af45da05922--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----6af45da05922--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----6af45da05922--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vaishakvk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@vaishakvk?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Vaishak V.Kumar"}, {"url": "https://medium.com/@vaishakvk/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "199 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F61d2676ad14&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&user=Vaishak+V.Kumar&userId=61d2676ad14&source=post_page-61d2676ad14--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ff850dd15a1b9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fgeometric-deep-learning-for-pose-estimation-6af45da05922&newsletterV3=61d2676ad14&newsletterV3Id=f850dd15a1b9&user=Vaishak+V.Kumar&userId=61d2676ad14&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}