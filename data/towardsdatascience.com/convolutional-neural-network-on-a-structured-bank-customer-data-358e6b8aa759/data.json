{"url": "https://towardsdatascience.com/convolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759", "time": 1682993683.5454211, "path": "towardsdatascience.com/convolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759/", "webpage": {"metadata": {"title": "Convolutional Neural Network on a structured bank customer data | by Carson Yan | Towards Data Science", "h1": "Convolutional Neural Network on a structured bank customer data", "description": "As a quantitative analyst working for a traditional bank, I sit back and watch Deep Learning disrupts and transforms quite a few industries, yet skeptical about how useful it actually is to my\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.kaggle.com/c/santander-product-recommendation", "anchor_text": "Santander product recommendation Kaggle competition", "paragraph_index": 0}, {"url": "https://medium.com/@pds.bangalore/mean-average-precision-abd77d0b9a7e", "anchor_text": "MAP@7", "paragraph_index": 1}, {"url": "https://en.wikipedia.org/wiki/Panel_data", "anchor_text": "panel data", "paragraph_index": 2}, {"url": "https://www.creditcards.com/glossary/term-behavior-score.php", "anchor_text": "behavior scorecard", "paragraph_index": 2}, {"url": "http://blog.kaggle.com/2017/01/12/santander-product-recommendation-competition-2nd-place-winners-solution-write-up-tom-van-de-wiele/", "anchor_text": "2nd", "paragraph_index": 3}, {"url": "http://blog.kaggle.com/2017/02/22/santander-product-recommendation-competition-3rd-place-winners-interview-ryuji-sakata/", "anchor_text": "3rd", "paragraph_index": 3}, {"url": "https://en.wikipedia.org/wiki/Taylor_series", "anchor_text": "Taylor-series", "paragraph_index": 10}], "all_paragraphs": ["As a quantitative analyst working for a traditional bank, I sit back and watch Deep Learning disrupts and transforms quite a few industries, yet skeptical about how useful it actually is to my industry. You know, there may be some applications like capturing check images or chatbot, but when it comes to the core problems of a lending business, problems such as credit risk, fraud risk and marketing, the data we\u2019re dealing with are very structured \u2014 data that you can put into a 2 or 3 dimensional table. Deep Learning seems like overkill here. Or it is? Over the years I have seen a few examples of successfully using Convolutional Neural Network(CNN) on non-imagery data, but all of them seem to have a complex spacial data structure that the algorithm can exploit. What\u2019s more, banks are still struggling to transition from linear models to something a little more sophisticated like GBM. Deep learning just seems so remote. Having a lot of doubts, I started a 3 weeks and half journey building a Convolutional Neural Network using Santander product recommendation Kaggle competition data. Spoiler alert \u2014 CNN worked fantastically well on this structured data as well!", "In 2016, Santander bank (Spanish) hosted their second competition on Kaggle. They challenged the Kaggle community to predict which products their existing customers will use in the next month based on their past behavior and that of similar customers. The dataset captures monthly snapshots of customer information, some are demographic information such as gender, age, income and location information and some are relationship information such as tenure, relationship types, etc. The data also tracks the monthly customers\u2019 product usage. There are 24 products that the bank offers, including checking, savings, mortgage, credit card, etc. If a customer used a product in a certain month, then the usage indicator is set to 1, else 0. The task was to predict all 24 usage indicators in June 2016 (but they only cared about those usages that changed from 0 to 1), based on customers\u2019 product usages from January 2015 to May 2016, and other information from January 2015 to June 2016. The metric selected for model performance is MAP@7, which measures how relevant the recommendations are to the customers\u2019 actual usages, as well as how well the recommendations rank order (think about how you would measure the usefulness of the first page returned from a Google keyword search: the more relevant the results are, the better; the more aligned between the actual order of the results from top to bottom with your expectation, the better). Since a customer can use multiple products in a certain month, this is a multi-class multi-label classification problem.", "This data is typically called \u201cpanel data\u201d in the quants\u2019/economists\u2019 world. There is nothing fancy about this data and if the target is replaced by a default label, it could be a nice dataset for a behavior scorecard model. However, it does contain a time dimension and a sudo spacial dimension(product usage) which CNN maybe able to exploit.", "Typically speaking, you can\u2019t win a Kaggle competition without extensive feature engineering. It\u2019s no exception in this case, see the two winning solutions from this competition: 2nd and 3rd place. Feature engineering played a key part in both of them. They came up with smart transformations of input data and the efforts paid off.", "The image below shows the concept of the CNN algorithm. The convolution/pooling layers before the final densely connected neural network, are there to extract and abstract patterns from the input images. In another word, engineer features that are useful for the prediction task.", "My plan was to hand over the feature engineering task to CNN and not do any engineering by myself. How? By turning customer data in to image-like structure. Every customer in this case, has a time dimension (from when they started the relationship with the bank until May 2016) \u2014 maximum 17 pixels, as well as a product dimension with 24 pixels. Some features like income and relationship with the bank changed overtime so I ended up with some 45 by 17 pixels low resolution \u201cpictures\u201d, which capture all info that I need to know about the customers.", "Some of the features you may want to engineer, such as \u201cThe last month index of the product\u201d, \u201cThe number of transition of index from 0 to 1 until last month\u201d or \u201cThe frequency of product A and B used together\u201d \u2014 if they are useful, they will become patterns in the images for the CNN to detect. The best part about this? I don\u2019t need to come up with hypothesis on what features transformation might be useful, and I can just go get a cup of tea while the algorithm work diligently to discover the useful feature combinations, some of them are potentially beyond my imagination. I did come up with a hypothesis \u2014 If a customer changed his/her sex, the customer\u2019s behavior and product usage will be different because of changes in hormone and social interactions. But no one changed sex. Quite disappointing.", "I used Keras with Tensorflow backend to construct the CNN. The model has two paths \u2014 one does convolution/pooling/dropout operations and then connects to a densely connected Neural Network and the other path just does the plain densely connected Neural Network because some of the features either don\u2019t change overtime or change in a structured way (e.g., tenure) for a particular customer. The model has about 55K parameters \u2014 a small network if you compare it to a typical CNN model for image recognition . I spent most of the time tuning the structure of the model (layers, nodes) and didn\u2019t tune other hyperparameters such as dropout rates, L1 and L2 penalty.", "The CNN model I built would rank 26th on the Private Leaderboard and 22nd on the public Leaderboard, out of 1787 teams. The competition was over so my performance would not be put up there. Nevertheless, this was far better than my expectation.", "I could have done more tuning and model ensemble to push it further but that wasn\u2019t the point of the exercise. The takeaway was, CNN can also be very useful in modeling a structured bank data! I\u2019m afraid, bank quants like me can no longer sit comfortably in our chairs and think Deep Learning is not going to disrupt our industry. It\u2019s probably not gonna be tomorrow because all the regulatory scrutiny, but there is no reason to think that an automated, efficient and effective algorithm is not going to at least coexist with us. After all, quantitative analysts and statisticians replaced underwriters some decades ago, because statistical models for underwriting were more automated, efficient and effective than underwriters back then.", "The tools developed so far for interpreting a CNN tend to be tailored towards imagery problems. But since it\u2019s a neural network, one can always look at the gradients and peek into why the model is making certain predictions. We know the model is differentiable, so by using the First-order Taylor-series approximation , we can approximate the model with a linear function around the inputs (in this case, feature values of a specific customer), then we can use gradients of the predictions with regards to the input to show how changes in inputs affect the prediction. Below is a \u201cpicture\u201d of the gradients in predicting credit card usage with regards to the input values of a customer. Blue blocks indicate negative values and red blocks indicate positive values.", "The bright red block shows that if the customer used Direct Deposit in the last 2 months, he/she will be more likely to use Credit Card in June 2016. The blue block shows that if the customer used Credit Card in May 2016, he/she will be much less likely to use Credit Card in June 2016. Guess what \u2014 this is because I manually changed the target indicator to 0 when the prior month usage is 1 since Santander only wanted to know who changed from not using a product to using it. In hindsight, I should have used the raw indicators, build the model and use a post-processing rule to deal with that because that manual adjustment became one more thing for the model to learn. However, the fact that the model was able to learn that adjustment, shows the model is doing the right thing.", "I presented this to a local data scientists community and they found it very interesting. One question raised was why CNN but not RNN (Recurrent Neural Network). After all, it makes more sense to model time series data with RNN. The 15th place winner in this competition seemed to have used RNN as their algorithm. It\u2019s hard to say RNN is definitely better in this case, since the CNN I built was kind of crude and I didn\u2019t do a lot of tuning and model ensemble. Nevertheless, one should be mindful that time dependency information could be lost within the convolution and pooling filters, so CNN might not always be appropriate for time series problem. The advantage though, is that CNN is relatively easy to train as compared to a RNN model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F358e6b8aa759&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@carsonwolf?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carsonwolf?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": "Carson Yan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F28c4566f1d31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&user=Carson+Yan&userId=28c4566f1d31&source=post_page-28c4566f1d31----358e6b8aa759---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F358e6b8aa759&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F358e6b8aa759&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.kaggle.com/c/santander-product-recommendation", "anchor_text": "Santander product recommendation Kaggle competition"}, {"url": "https://medium.com/@pds.bangalore/mean-average-precision-abd77d0b9a7e", "anchor_text": "MAP@7"}, {"url": "https://en.wikipedia.org/wiki/Panel_data", "anchor_text": "panel data"}, {"url": "https://www.creditcards.com/glossary/term-behavior-score.php", "anchor_text": "behavior scorecard"}, {"url": "http://blog.kaggle.com/2017/01/12/santander-product-recommendation-competition-2nd-place-winners-solution-write-up-tom-van-de-wiele/", "anchor_text": "2nd"}, {"url": "http://blog.kaggle.com/2017/02/22/santander-product-recommendation-competition-3rd-place-winners-interview-ryuji-sakata/", "anchor_text": "3rd"}, {"url": "https://en.wikipedia.org/wiki/Taylor_series", "anchor_text": "Taylor-series"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----358e6b8aa759---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/data-science?source=post_page-----358e6b8aa759---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/convolutional-network?source=post_page-----358e6b8aa759---------------convolutional_network-----------------", "anchor_text": "Convolutional Network"}, {"url": "https://medium.com/tag/neural-networks?source=post_page-----358e6b8aa759---------------neural_networks-----------------", "anchor_text": "Neural Networks"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F358e6b8aa759&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&user=Carson+Yan&userId=28c4566f1d31&source=-----358e6b8aa759---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F358e6b8aa759&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&user=Carson+Yan&userId=28c4566f1d31&source=-----358e6b8aa759---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F358e6b8aa759&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F358e6b8aa759&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----358e6b8aa759---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----358e6b8aa759--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----358e6b8aa759--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----358e6b8aa759--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----358e6b8aa759--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carsonwolf?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@carsonwolf?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Carson Yan"}, {"url": "https://medium.com/@carsonwolf/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "106 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F28c4566f1d31&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&user=Carson+Yan&userId=28c4566f1d31&source=post_page-28c4566f1d31--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7e9612d93fd6&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fconvolutional-neural-network-on-a-structured-bank-customer-data-358e6b8aa759&newsletterV3=28c4566f1d31&newsletterV3Id=7e9612d93fd6&user=Carson+Yan&userId=28c4566f1d31&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}