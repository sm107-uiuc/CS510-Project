{"url": "https://towardsdatascience.com/how-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d", "time": 1683003031.027013, "path": "towardsdatascience.com/how-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d/", "webpage": {"metadata": {"title": "How to build a dataset for an image classifier from scratch (related to cars) | by Jean-Michel D | Towards Data Science", "h1": "How to build a dataset for an image classifier from scratch (related to cars)", "description": "In this article, I am going to present a pipeline that I built a few weeks ago to collect data (text and pictures) from the website Turo and the process to clean the data collected to use it in an\u2026"}, "outgoing_paragraph_urls": [{"url": "https://turo.com/fr-ca", "anchor_text": "Turo", "paragraph_index": 0}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "mnist", "paragraph_index": 3}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "deepfashion", "paragraph_index": 3}, {"url": "https://medium.com/@paul.stancliffe/udacity-dog-breed-classifier-project-walkthrough-e03c1baf5501", "anchor_text": "dog breed classifier", "paragraph_index": 3}, {"url": "https://www.crummy.com/software/BeautifulSoup/", "anchor_text": "Beautiful Soup", "paragraph_index": 9}, {"url": "http://the-odd-dataguy.com/crossfitopen", "anchor_text": "article", "paragraph_index": 9}, {"url": "https://www.crummy.com/software/BeautifulSoup/", "anchor_text": "Beautiful Soup", "paragraph_index": 12}, {"url": "https://michaeljsanders.com/2017/05/12/scrapin-and-scrollin.html", "anchor_text": "Michael J Sanders", "paragraph_index": 23}, {"url": "https://github.com/jeanmidevacc/example_webscraper", "anchor_text": "the configuration that is on this Github repository", "paragraph_index": 30}, {"url": "https://towardsdatascience.com/@chrisfotache", "anchor_text": "Chris Fotache", "paragraph_index": 37}, {"url": "https://towardsdatascience.com/object-detection-and-tracking-in-pytorch-b3cf1a696a98", "anchor_text": "Pytorch", "paragraph_index": 37}], "all_paragraphs": ["In this article, I am going to present a pipeline that I built a few weeks ago to collect data (text and pictures) from the website Turo and the process to clean the data collected to use it in an image classifier project.", "Disclaimer: This data is for my usage (I don\u2019t own it), so I am not sharing it.", "I started a few weeks ago to think to dive more in detail in deep learning, and I wanted to start a project around image classification.", "Most of the articles that I am reading in the subject are using all the same datasets as for the mnist dataset (the handwriting number), deepfashion (collection of clothes labelled), or the dog breed classifier.", "These datasets are suitable, but I wanted to work on something different and at this moment:", "I discovered a few weeks ago two datasets on the same kind of topics", "But I wanted to increase my game in terms of scraping, so I decided to build my scraper of the Turo website.", "In an offer of Turo, I just realized that there are pictures annotated with the kind of car.", "So why not use the website as a source for a dataset for image classification to build a car detection system.", "To execute the extraction of the data from the website, I can not use the same approach with Beautiful Soup from my article on the Crossfit open because:", "I can still use Beautiful Soup to get the data from the source page, but I need to associate this package with another package called Selenium to automate the research on Turo.", "In this part, I am going to give a brief introduction to the libraries that I used to crawl all along Turo.", "Beautiful Soup is a package \u201cfor pulling data out of HTML and XML files. It works with your favourite parser to provide idiomatic ways of navigating, searching, and modifying the parse tree. It commonly saves programmers hours or days of work\u201d.", "With this package after the collection of the source page online, you can segment all the HTML tags and research inside to collect the information that you need. In my opinion, this package is an excellent start to begin web scraping with Python, and there are plenty of useful resources on the subject.", "This package can be seen as a web browser automation package.", "This package allowed a Python script to open a web browser like Firefox, fill fields on a webpage, scroll on the webpage, and click on buttons as a human can do.Let\u2019s dive know on the data pipeline.", "In term of data collection, I decided to focus my data collection on the most significant North American cities, so I took:", "There is a map of the panel of cities that I am scraping data.", "It represents 60 cities (in blue the US and red Canada), like that I have multiple types of environments (mountains, sea) and kind of different weather that can induce various kinds of vehicles.", "The idea is to collect every 6 hours the new offers from 5 cities that are picked randomly on the list of the cities. The storage of the data received is made :", "I ran this pipeline for approximately two weeks, and I downloaded around 164000 images.", "Let\u2019s now have a look more in detail on the script that is doing the data collection with Selenium and Beautiful Soup.", "First of all, to collect this data, I need to have a way to give a city and get the offers that are currently available.There is a code that can collect offers for the city of Montreal.", "For the scrolling on the page, it\u2019s a little bit tricky; I used the method of Michael J Sanders to scroll on an \u201cinfinite page\u201d.", "Between each scroll, I am using Beautiful Soup to collect all the offers that were on the page.", "There is an animation of the script in action.", "After that, I am just applying filtering on the offers that I never saw before (that are not in my dynamodb table) and using a new process to collect the data from a specific offer.", "There is the script to collect the data for an offer.", "The tricky part of this script is to collect the URL of the pictures on the offer. The following screenshot illustrates that the pictures are stored in a carousel.", "I am using the same trick then with the validation button on the front page, and with that, I can easily collect all the URL of the pictures and, with a GET request, download them on my machine. There is an animation of the previous script in action.", "If you want to run the scripts, I am inviting you to set up a python environment with the configuration that is on this Github repository (on a Linux machine).", "Let\u2019s now have a look at the data preparation of the dataset.", "With my scraper, I collected a lot (164000 ish) of pictures on the website Turo associated with their car offers. That\u2019s a good number to start, but all of these pictures are not usable, for example, the interior of the car.", "There is a lot of these pictures, so I need to do some cleaning on this raw dataset.", "The process behind this pipeline is to:", "There is a brief illustration of the process", "The trickiest part of this pipeline was the detection engine; for this part of the pipe, I decided that I can use a pre-made model. There is a significant amount of models that can be found online to execute the task to detect objects on an image.", "The implementation that seems the most efficient to use is the one made by Chris Fotache on Pytorch.", "For the filtering rules, it was simple; a good picture of a car can is defined with:", "After the filtering rules, it happened that only 57000 pictures were usable.", "Let\u2019s see how the labelling of these pictures.", "The final step to complete the dataset is to resize the pictures and have labels for the classification.", "From all of these pictures that have been selected, two things are noticeable", "In the following figure, there is a representation of the height and length of the pictures.", "The pictures have propers resolutions, but I need to uniformize them to make useable by every pipeline for classification. I built the following piece of code to resize the pictures (and this function can make them black and white).", "I tried multiple configurations of size for my dataset in terms of pixels for the height and length.", "Let\u2019s have a look now on the labelling.", "There are two obvious labelling for this dataset :", "In the following figure, there is a visualization of the count of models per manufacturer.", "As we can see, there is a lot of manufacturers and models, and it is a hard start to have so many labels (I think). I decided to build my \u201clabelling mechanism.\u201d", "I build two kinds of labelling:", "For the binary classifier, I pick one specific manufacturer and one specific model. For the manufacturer, I decided to choose Tesla; the first reason it is trendy online and the second reason Tesla has an unordinary ratio between the number of pictures for the number of models available, as we can see in the following figure.", "For the model, I decided to choose the Ford mustang because I like Ford mustang, nothing else. But let\u2019s be honest, it\u2019s one of the models that is the most popular in the dataset, as we can see in the next figure of the top10 most popular models.", "Let\u2019s talk about the multiclass classifier; for this case, I use a straightforward approach for the labelling. The idea is to take the top X most popular manufacturer/model, and if the manufacturer/model of the picture is not in the top X, his label assigned is other. I build the labels for the :", "Now a lot of different labels are available for the pictures. Still, for my first work on the image classifier, I am going to focus my test with the binary labels and the top10 manufacturer/model.", "To complete this article, I just want to talk about something, and it\u2019s about the balancing of the dataset. For the label that I selected, I can tell you that classes to predict are not balanced at all. In the following figures, there is an illustration of the unbalancing of the dataset.", "When I use these labels for image classification, I am going to test the impact to balance the classes for the training.", "Stay tuned and don\u2019t hesitate to give some feedback.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Data scientist at @ubisoftMtl (Worked for @edfenergy, @cea_officiel, @cstb_fr) My opinion are my own (and I have always an opinion because I am French)"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd2506e30468d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----d2506e30468d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d2506e30468d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@boitemailjeanmid?source=post_page-----d2506e30468d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@boitemailjeanmid?source=post_page-----d2506e30468d--------------------------------", "anchor_text": "Jean-Michel D"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc607131f9cd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&user=Jean-Michel+D&userId=c607131f9cd3&source=post_page-c607131f9cd3----d2506e30468d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2506e30468d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2506e30468d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@jonathangallegos?utm_source=medium&utm_medium=referral", "anchor_text": "Jonathan Gallegos"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://turo.com/fr-ca", "anchor_text": "Turo"}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "mnist"}, {"url": "http://yann.lecun.com/exdb/mnist/", "anchor_text": "deepfashion"}, {"url": "https://medium.com/@paul.stancliffe/udacity-dog-breed-classifier-project-walkthrough-e03c1baf5501", "anchor_text": "dog breed classifier"}, {"url": "https://turo.com/", "anchor_text": "Turo platform"}, {"url": "https://www.playground-games.com/", "anchor_text": "Playground games"}, {"url": "https://compass-ssl.xbox.com/assets/2c/d7/2cd7061a-3d3b-4319-9d75-8ac4628cbc77.jpg?n=8888888884_Gallery_1154x649_09.jpg", "anchor_text": "https://compass-ssl.xbox.com/assets/2c/d7/2cd7061a-3d3b-4319-9d75-8ac4628cbc77.jpg?n=8888888884_Gallery_1154x649_09.jpg"}, {"url": "https://ai.stanford.edu/~jkrause/cars/car_dataset.html", "anchor_text": "The one of Stanford"}, {"url": "https://towardsdatascience.com/classifying-car-images-using-features-extracted-from-pre-trained-neural-networks-39692e445a14", "anchor_text": "article"}, {"url": "https://towardsdatascience.com/@bhanuyerra?source=post_page-----39692e445a14----------------------", "anchor_text": "Bhanu Yerra"}, {"url": "https://github.com/nicolas-gervais/predicting-car-price-from-scraped-data", "anchor_text": "GitHub repository"}, {"url": "https://www.crummy.com/software/BeautifulSoup/", "anchor_text": "Beautiful Soup"}, {"url": "http://the-odd-dataguy.com/crossfitopen", "anchor_text": "article"}, {"url": "https://www.crummy.com/software/BeautifulSoup/", "anchor_text": "Beautiful Soup"}, {"url": "https://infopython.files.wordpress.com/2007/03/beautifulsoup.jpg", "anchor_text": "https://infopython.files.wordpress.com/2007/03/beautifulsoup.jpg"}, {"url": "https://huddle.eurostarsoftwaretesting.com/wp-content/uploads/2017/02/Selenium.png", "anchor_text": "https://huddle.eurostarsoftwaretesting.com/wp-content/uploads/2017/02/Selenium.png"}, {"url": "http://the-odd-dataguy.com/p/9d736496-0ed3-4a92-bd04-6e7fa03bcb41/Build%20a%20webscraper%20with%20Selenium%20and%20BeautifulSoup", "anchor_text": "AWS"}, {"url": "https://aws.amazon.com/dynamodb/?sc_channel=PS&sc_campaign=acquisition_CA&sc_publisher=google&sc_medium=dynamodb_hv_b&sc_content=dynamodb_e&sc_detail=dynamodb&sc_category=dynamodb&sc_segment=73324893176&sc_matchtype=e&sc_country=CA&s_kwcid=AL!4422!3!73324893176!e!!g!!dynamodb&ef_id=Cj0KCQjw9fntBRCGARIsAGjFq5GS7soTVsB8NP__REd9JX7GRF7S_zjDYZW-Swn0ik_5shVH39KzOCsaAnOOEALw_wcB:G:s", "anchor_text": "dynamodb"}, {"url": "https://media.giphy.com/media/3NtY188QaxDdC/giphy.gif", "anchor_text": "https://media.giphy.com/media/3NtY188QaxDdC/giphy.gif"}, {"url": "https://michaeljsanders.com/2017/05/12/scrapin-and-scrollin.html", "anchor_text": "Michael J Sanders"}, {"url": "https://github.com/jeanmidevacc/example_webscraper", "anchor_text": "the configuration that is on this Github repository"}, {"url": "https://towardsdatascience.com/@chrisfotache", "anchor_text": "Chris Fotache"}, {"url": "https://towardsdatascience.com/object-detection-and-tracking-in-pytorch-b3cf1a696a98", "anchor_text": "Pytorch"}, {"url": "http://the-odd-dataguy.com/build-a-webscraper-with-beautifsoup-and-selenium/", "anchor_text": "http://the-odd-dataguy.com"}, {"url": "https://medium.com/tag/data?source=post_page-----d2506e30468d---------------data-----------------", "anchor_text": "Data"}, {"url": "https://medium.com/tag/image-classification?source=post_page-----d2506e30468d---------------image_classification-----------------", "anchor_text": "Image Classification"}, {"url": "https://medium.com/tag/image-processing?source=post_page-----d2506e30468d---------------image_processing-----------------", "anchor_text": "Image Processing"}, {"url": "https://medium.com/tag/cars?source=post_page-----d2506e30468d---------------cars-----------------", "anchor_text": "Cars"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----d2506e30468d---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd2506e30468d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&user=Jean-Michel+D&userId=c607131f9cd3&source=-----d2506e30468d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fd2506e30468d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&user=Jean-Michel+D&userId=c607131f9cd3&source=-----d2506e30468d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd2506e30468d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----d2506e30468d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fd2506e30468d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----d2506e30468d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----d2506e30468d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----d2506e30468d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----d2506e30468d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----d2506e30468d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d2506e30468d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d2506e30468d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----d2506e30468d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----d2506e30468d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@boitemailjeanmid?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@boitemailjeanmid?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Jean-Michel D"}, {"url": "https://medium.com/@boitemailjeanmid/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "226 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc607131f9cd3&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&user=Jean-Michel+D&userId=c607131f9cd3&source=post_page-c607131f9cd3--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F5b424bd1598&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhow-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d&newsletterV3=c607131f9cd3&newsletterV3Id=5b424bd1598&user=Jean-Michel+D&userId=c607131f9cd3&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}