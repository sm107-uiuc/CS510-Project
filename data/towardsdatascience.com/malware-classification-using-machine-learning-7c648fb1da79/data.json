{"url": "https://towardsdatascience.com/malware-classification-using-machine-learning-7c648fb1da79", "time": 1683000873.8415518, "path": "towardsdatascience.com/malware-classification-using-machine-learning-7c648fb1da79/", "webpage": {"metadata": {"title": "Malware Classification using Machine Learning | by Arpan Das | Towards Data Science", "h1": "Malware Classification using Machine Learning", "description": "If you love to explore large and challenging data sets, then probably you should give Microsoft Malware Classification a try. Before diving deep in to the problem let\u2019s take few points on what can\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.youtube.com/watch?v=BPUfVq7RaY8&t=222s", "anchor_text": "link", "paragraph_index": 6}], "all_paragraphs": ["If you love to explore large and challenging data sets, then probably you should give Microsoft Malware Classification a try. Before diving deep in to the problem let\u2019s take few points on what can you expect to learn from this:", "In the past few years, the malware industry has grown very rapidly that, the syndicates invest heavily in technologies to evade traditional protection, forcing the anti-malware groups/communities to build more robust software to detect and terminate these attacks. The major part of protecting a computer system from a malware attack is to identify whether a given piece of file/software is a malware.", "Machine Learning Problem, KPI and constraints", "We can map the business problem to a multi-class classification problem, where we need to predict the class for each given byte files among nine categories (Ramnit, Lollipop, Kelihos_ver3, Vundo, Simda,Tracur, Kelihos_ver1, Obfuscator.ACY, Gatak).", "KPI: multi-class log loss, confusion matrix", "Constrains: We need to provide the class probability, wrongly classified class labels should be penalized(that\u2019s why log loss has been chosen as KPI) and there should some latency bound.", "Keeping the scale of data in mind, It is advised to go for cloud platforms like GCP, AWS or IBM Cloud. We have completed this case study in GCP with Linux based 1vCPU box with 30 GB RAM and 500 GB HDD. Follow this link to know how you can download the data directly in GCP from jupyter notebook itself with the help of CurlWidget. After downloading the data the next challenge will be to extract these files using python as the python support for 7z files are limited. Go for a package called \u2018p7zip\u2019 which provides a Linux command line tool to extract 7z files.", "The good thing of this case study is, it demands a lot of patience and experiments to obtain the useful features. We have tried out the following features based on our intuitions and previous works on this field", "2. Size of byte and asm files: Size of bytes and asm files turned out be be good features. Let\u2019s take a look at the box plots of file sizes", "3. Size of byte array: As we mentioned earlier,the byte files are consists of hexadecimal digits. For each files we have taken an array and added each elements in to the array and used the length of these arrays as a feature.", "4. Segment count and n-grams of asm files: asm files consists of various segments like prefixes(ex. HEADER,TEXT), opcodes(ex. jmp, hlt), keywords(ex. .dll, std::), registers(ex. edx,epi) etc. We have taken the count of segments as a feature. We have also considered uni-gram, bi-gram and tri-gram of asm files as feature.", "5. Pixel intensity of byte and asm features: This is probably the most innovative features of the case this case study. We have borrowed the concept from the 1st place winner solution.As we mentioned earlier the value of each elements in byte files is between 0 to 255. We can easily convert these byte files along with the asm files in to gray scale images. It is observed that the first 800 pixel densities of asm files have significant impact over the final result.", "Let\u2019s take a look how a random asm file looks after the conversion", "By now you must have observed the dimension of the features and get a sense of the dimensionality of the final features for training. To cope up with the problem we have used random forest to select the important features. Number of important features is a hyper-parameter. We have tried various numbers based of our experiences and obviously there are scope of improvements. Let\u2019s look at a sample code on this and how we have selected best tri-gram asm features. We have also tried t-SNE for multivariate analysis.", "We have tried various linear machine learning models like KNN, multi-class logistic regression and ensembles like random forest, XGBoost and LightGBM with various combination of features. We have trained the models with single features, and a combination of byte features and asm features. We have also tried out various CNN architectures over the images obtained from byte and asm files but the obtained result was poorer compared to fine tuned machine learning models. As we did not have any domain knowledge on malware industry we have completely relied on cross validation. As the number of features and files were high, we have chosen RandomizedCV for cross validation and there are scope of improvements. Another question may come to your mind that why we have used both XGBoost and LightGBM? Actually we have started with XGBoost but found out that the training latency of LightGBM is much lower than XGBoost along with similar or better performance. We started with a random model then added the complexity of the model gradually after keeping an eye on the performance.", "Finally a use case does not worth anything if it does not provide a satisfactory result. Here let\u2019s list down only the result we obtained after calibrating our final LightGBM model.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7c648fb1da79&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@arpandas65.a3?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arpandas65.a3?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": "Arpan Das"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb3908ae4e107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&user=Arpan+Das&userId=b3908ae4e107&source=post_page-b3908ae4e107----7c648fb1da79---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c648fb1da79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c648fb1da79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://www.youtube.com/watch?v=BPUfVq7RaY8&t=222s", "anchor_text": "link"}, {"url": "http://arxiv.org/abs/1802.10135", "anchor_text": "http://arxiv.org/abs/1802.10135"}, {"url": "https://www.kaggle.com/c/malware-classification/overview", "anchor_text": "https://www.kaggle.com/c/malware-classification/overview"}, {"url": "https://www.kaspersky.co.in/resource-center/threats/malware-classifications", "anchor_text": "https://www.kaspersky.co.in/resource-center/threats/malware-classifications"}, {"url": "https://ieeexplore.ieee.org/document/8553780", "anchor_text": "https://ieeexplore.ieee.org/document/8553780"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----7c648fb1da79---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/ai?source=post_page-----7c648fb1da79---------------ai-----------------", "anchor_text": "AI"}, {"url": "https://medium.com/tag/case-study?source=post_page-----7c648fb1da79---------------case_study-----------------", "anchor_text": "Case Study"}, {"url": "https://medium.com/tag/tutorial?source=post_page-----7c648fb1da79---------------tutorial-----------------", "anchor_text": "Tutorial"}, {"url": "https://medium.com/tag/data-science?source=post_page-----7c648fb1da79---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7c648fb1da79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&user=Arpan+Das&userId=b3908ae4e107&source=-----7c648fb1da79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F7c648fb1da79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&user=Arpan+Das&userId=b3908ae4e107&source=-----7c648fb1da79---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7c648fb1da79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F7c648fb1da79&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----7c648fb1da79---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----7c648fb1da79--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7c648fb1da79--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----7c648fb1da79--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----7c648fb1da79--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arpandas65.a3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@arpandas65.a3?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Arpan Das"}, {"url": "https://medium.com/@arpandas65.a3/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "99 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb3908ae4e107&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&user=Arpan+Das&userId=b3908ae4e107&source=post_page-b3908ae4e107--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F175e2755e763&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fmalware-classification-using-machine-learning-7c648fb1da79&newsletterV3=b3908ae4e107&newsletterV3Id=175e2755e763&user=Arpan+Das&userId=b3908ae4e107&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}