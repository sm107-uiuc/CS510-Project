{"url": "https://towardsdatascience.com/the-best-format-to-save-pandas-data-414dca023e0d", "time": 1682995388.801692, "path": "towardsdatascience.com/the-best-format-to-save-pandas-data-414dca023e0d/", "webpage": {"metadata": {"title": "The Best Format to Save Pandas Data | by Ilia Zaitsev | Towards Data Science", "h1": "The Best Format to Save Pandas Data", "description": "When working on data analytical projects, I usually use Jupyter notebooks and a great pandas library to process and move my data around. It is a very straightforward process for moderate-sized\u2026"}, "outgoing_paragraph_urls": [{"url": "https://github.com/devforfu/pandas-formats-benchmark", "anchor_text": "my little benchmark", "paragraph_index": 2}, {"url": "https://github.com/devforfu/pandas-formats-benchmark", "anchor_text": "this repository", "paragraph_index": 9}, {"url": "https://stackoverflow.com/questions/48083405/what-are-the-differences-between-feather-and-parquet", "anchor_text": "is not expected to be used as a long-term file storage", "paragraph_index": 20}, {"url": "https://iliazaitsev.me/", "anchor_text": "my blog", "paragraph_index": 22}], "all_paragraphs": ["When working on data analytical projects, I usually use Jupyter notebooks and a great pandas library to process and move my data around. It is a very straightforward process for moderate-sized datasets which you can store as plain-text files without too much overhead.", "However, when the number of observations in your dataset is high, the process of saving and loading data back into the memory becomes slower, and now each kernel\u2019s restart steals your time and forces you to wait until the data reloads. So eventually, the CSV files or any other plain-text formats lose their attractiveness.", "We can do better. There are plenty of binary formats to store the data on disk, and many of them pandas supports. How can we know which one is better for our purposes? Well, we can try a few of them and compare! That\u2019s what I decided to do in this post: go through several methods to save pandas.DataFrame onto disk and see which one is better in terms of I/O speed, consumed memory and disk space. In this post, I\u2019m going to show the results of my little benchmark.", "We\u2019re going to consider the following formats to store our data.", "All of them are very widely used and (except MessagePack maybe) very often encountered when you\u2019re doing some data analytical stuff.", "Pursuing the goal of finding the best buffer format to store the data between notebook sessions, I chose the following metrics for comparison.", "Note that the last two metrics become very important when we use the efficiently compressed binary data formats, like Parquet. They could help us to estimate the amount of RAM required to load the serialized data, in addition to the data size itself. We\u2019ll talk about this question in more details in the next sections.", "I decided to use a synthetic dataset for my tests to have better control over the serialized data structure and properties. Also, I use two different approaches in my benchmark: (a) keeping generated categorical variables as strings and (b) converting them into pandas.Categorical data type before performing any I/O.", "The function generate_dataset shows how I was generating the datasets in my benchmark.", "The performance of CSV file saving and loading serves as a baseline. The five randomly generated datasets with million observations were dumped into CSV and read back into memory to get mean metrics. Each binary format was tested against 20 randomly generated datasets with the same number of rows. The datasets consist of 15 numerical and 15 categorical features. You can find the full source code with the benchmarking function and required in this repository.", "The following picture shows averaged I/O times for each data format. An interesting observation here is that hdf shows even slower loading speed that the csv one while other binary formats perform noticeably better. The two most impressive are feather and parquet.", "What about memory overhead while saving the data and reading it from a disk? The next picture shows us that hdf is again performing not that good. And sure enough, the csv doesn\u2019t require too much additional memory to save/load plain text strings while feather and parquet go pretty close to each other.", "Finally, let\u2019s look at the file sizes. This time parquet shows an impressive result which is not surprising taking into account that this format was developed to store large volumes of data efficiently.", "In the previous section, we don\u2019t make any attempt to store our categorical features efficiently instead of using the plain strings. Let\u2019s fix this omission! This time we use a dedicated pandas.Categorical type instead of plain strings.", "See how it looks now compared to the plain text csv! Now all binary formats show their real power. The baseline is far behind so let\u2019s remove it to see the differences between various binary formats more clearly.", "The feather and pickle show the best I/O speed while hdf still shows noticeable overhead.", "Now it is time to compare memory consumption during data process loading. The following bar diagram shows an important fact about parquet format we\u2019ve mentioned before.", "As soon as it takes a little space on the disk, it requires an extra amount of resources to un-compress the data back into a data frame. It is possible that you\u2019ll not be able to load the file into the memory even if it requires a moderate volume on the persistent storage disk.", "The final plot shows file sizes for the formats. All the formats show good results, except hdf that still requires much more space than others.", "As our little test shows, it seems that feather format is an ideal candidate to store the data between Jupyter sessions. It shows high I/O speed, doesn\u2019t take too much memory on the disk and doesn\u2019t need any unpacking when loaded back into RAM.", "Sure enough, this comparison doesn\u2019t imply that you should use this format in each possible case. For example, the feather format is not expected to be used as a long-term file storage. Also, it doesn\u2019t take into account all possible situations when other formats could show their best. However, it seems to be an excellent choice for the purpose stated at the beginning of this post.", "Are you interested in Python language? Can\u2019t live without Machine Learning? Have read everything else on the Internet?", "Then probably you would be interested in my blog where I am talking about various programming topics and provide links to textbooks and guides I\u2019ve found interesting.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Software Developer & AI Enthusiast. Working with Machine Learning, Data Science, and Data Analytics. Writing posts every once in a while."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F414dca023e0d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----414dca023e0d--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----414dca023e0d--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@iliazaitsev?source=post_page-----414dca023e0d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@iliazaitsev?source=post_page-----414dca023e0d--------------------------------", "anchor_text": "Ilia Zaitsev"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F59449609fea0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&user=Ilia+Zaitsev&userId=59449609fea0&source=post_page-59449609fea0----414dca023e0d---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F414dca023e0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F414dca023e0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://github.com/devforfu/pandas-formats-benchmark", "anchor_text": "my little benchmark"}, {"url": "https://unsplash.com/@heapdump?utm_source=medium&utm_medium=referral", "anchor_text": "Patrick Lindenberg"}, {"url": "https://unsplash.com?utm_source=medium&utm_medium=referral", "anchor_text": "Unsplash"}, {"url": "https://msgpack.org", "anchor_text": "MessagePack"}, {"url": "https://en.wikipedia.org/wiki/Hierarchical_Data_Format", "anchor_text": "HDF5"}, {"url": "https://blog.cloudera.com/blog/2016/03/feather-a-fast-on-disk-format-for-data-frames-for-r-and-python-powered-by-apache-arrow/", "anchor_text": "Feather"}, {"url": "https://parquet.apache.org", "anchor_text": "Parquet"}, {"url": "https://github.com/devforfu/pandas-formats-benchmark", "anchor_text": "this repository"}, {"url": "https://stackoverflow.com/questions/48083405/what-are-the-differences-between-feather-and-parquet", "anchor_text": "is not expected to be used as a long-term file storage"}, {"url": "https://iliazaitsev.me/", "anchor_text": "my blog"}, {"url": "https://medium.com/tag/data-science?source=post_page-----414dca023e0d---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/pandas?source=post_page-----414dca023e0d---------------pandas-----------------", "anchor_text": "Pandas"}, {"url": "https://medium.com/tag/jupyter-notebook?source=post_page-----414dca023e0d---------------jupyter_notebook-----------------", "anchor_text": "Jupyter Notebook"}, {"url": "https://medium.com/tag/python?source=post_page-----414dca023e0d---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F414dca023e0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&user=Ilia+Zaitsev&userId=59449609fea0&source=-----414dca023e0d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F414dca023e0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&user=Ilia+Zaitsev&userId=59449609fea0&source=-----414dca023e0d---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F414dca023e0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----414dca023e0d--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F414dca023e0d&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----414dca023e0d---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----414dca023e0d--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----414dca023e0d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----414dca023e0d--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----414dca023e0d--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----414dca023e0d--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----414dca023e0d--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----414dca023e0d--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----414dca023e0d--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@iliazaitsev?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@iliazaitsev?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Ilia Zaitsev"}, {"url": "https://medium.com/@iliazaitsev/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "401 Followers"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F59449609fea0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&user=Ilia+Zaitsev&userId=59449609fea0&source=post_page-59449609fea0--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fb1fca54e4aa9&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fthe-best-format-to-save-pandas-data-414dca023e0d&newsletterV3=59449609fea0&newsletterV3Id=b1fca54e4aa9&user=Ilia+Zaitsev&userId=59449609fea0&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}