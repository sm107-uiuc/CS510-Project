{"url": "https://towardsdatascience.com/customer-segmentation-in-python-9c15acf6f945", "time": 1683008371.255933, "path": "towardsdatascience.com/customer-segmentation-in-python-9c15acf6f945/", "webpage": {"metadata": {"title": "Customer Segmentation in Python. Segmentation Using K-Means clustering\u2026 | by Irfan Alghani Khalid | Towards Data Science", "h1": "Customer Segmentation in Python", "description": "The article will show you how to do customer segmentation using python, and how to interpret the characteristics by each clusters."}, "outgoing_paragraph_urls": [{"url": "https://archive.ics.uci.edu/ml/datasets/online+retail", "anchor_text": "here", "paragraph_index": 10}, {"url": "https://colab.research.google.com/github/khalidmeister/Customer-Segmentation-using-Python/blob/master/Customer%20Segmentation%20in%20Python.ipynb", "anchor_text": "here", "paragraph_index": 55}, {"url": "https://towardsdatascience.com/@radecicdario?source=post_page-----1334e0debf45----------------------", "anchor_text": "Rade\u010di\u0107", "paragraph_index": 56}, {"url": "https://towardsdatascience.com/@radecicdario?source=post_page-----1334e0debf45----------------------", "anchor_text": "D", "paragraph_index": 56}, {"url": "https://towardsdatascience.com/top-3-methods-for-handling-skewed-data-1334e0debf45", "anchor_text": "Top 3 Methods for Handling Skewed Data", "paragraph_index": 56}, {"url": "https://www.geeksforgeeks.org/elbow-method-for-optimal-value-of-k-in-kmeans/", "anchor_text": "Elbow Method for optimal value of k in KMeans", "paragraph_index": 56}], "all_paragraphs": ["Suppose that we have a company that selling some of the product, and you want to know how well does the selling performance of the product.", "You have the data that can we analyze, but what kind of analysis that we can do?", "Well, we can segment customers based on their buying behavior on the market.", "Keep in mind that the data is really huge, and we can not analyze it using our bare eye. We will use machine learning algorithms and the power of computing for it.", "This article will show you how to cluster customers on segments based on their behavior using the K-Means algorithm in Python.", "I hope that this article will help you on how to do customer segmentation step-by-step from preparing the data to cluster it.", "Before we get into the process, I will give you a brief on what kind of steps we will get.", "In this step, we will gather the data first. For this case, we will take the data from UCI Machine Learning called Online Retail dataset.", "The dataset itself is a transactional data that contains transactions from December 1st 2010 until December 9th 2011 for a UK-based online retail.", "Each row represents the transaction that occurs. It includes the product name, quantity, price, and other columns that represents ID.", "You can access to the dataset from here.", "Here is the size of the dataset.", "For this case, we don\u2019t use all of the rows. Instead, we will sample 10000 rows from the dataset, and we assume that as the whole transactions that the customers do.", "The code will look like this,", "Here is the glimpse of the dataset,", "After we sample the data, we will make the data easier to conduct an analysis.", "To segmenting customer, there are some metrics that we can use, such as when the customer buy the product for last time, how frequent the customer buy the product, and how much the customer pays for the product. We will call this segmentation as RFM segmentation.", "To make the RFM table, we can create these columns, such as Recency, Frequency, and MonetaryValue column.", "To get the number of days for recency column, we can subtract the snapshot date with the date where the transaction occurred.", "To create the frequency column, we can count how much transactions by each customer.", "Lastly, to create the monetary value column, we can sum all transactions for each customer.", "Here is the glimpse of the dataset,", "Right now, the dataset consists of recency, frequency, and monetary value column. But we cannot use the dataset yet because we have to preprocess the data more.", "We have to make sure that the data meet these assumptions, they are,", "The data should meet assumptions where the variables are not skewed and have the same mean and variance.", "Because of that, we have to manage the skewness of the variables.", "Here are the visualizations of each variable,", "As we can see from above, we have to transform the data, so it has a more symmetrical form.", "There are some methods that we can use to manage the skewness, they are,", "Note: We can use the transformation if and only if the variable only has positive values.", "Below are the visualization each variable and with and without transformations. From top left clockwise on each variable shows the plot without transformation, log transformation, square root transformation, and box-cox transformation.", "Based on that visualization, it shows that the variables with box-cox transformation shows a more symmetrical form rather than the other transformations.", "To make sure, we calculate each variable using the skew function. The result looks like this,", "Here is how to interpret the skewness value. If the value is close to 0, the variable tend to have symmetrical form. However, if it\u2019s not, the variable has skew on it. Based on that calculation, we use variables that use box-cox transformations.", "Based on that calculation, we will utilize variables that use box-cox transformations. Except for the MonetaryValue variable because the variable includes negative values. To handle this variable, we can use cubic root transformation to the data, so the comparison looks like this,", "By using the transformation, we will have data that less skewed. The skewness value declines from 16.63 to 1.16. Therefore, we can transform the RFM table with this code,", "Can we use data right now? Not yet. If we look at the plot once more, each variable don\u2019t have the same mean and variance. We have to normalize it. To normalize, we can use StandardScaler object from scikit-learn library to do it. The code will look like this,", "The data will look like this,", "Finally, we can do clustering using that data.", "Right after we preprocess the data, now we can focus on modelling. To make segmentation from the data, we can use the K-Means algorithm to do this.", "K-Means algorithm is an unsupervised learning algorithm that uses the geometrical principle to determine which cluster belongs to the data. By determine each centroid, we calculate the distance to each centroid. Each data belongs to a centroid if it has the smallest distance from the other. It repeats until the next total of the distance doesn\u2019t have significant changes than before.", "To implement K-Means in Python is easy. We can use the KMeans function from scikit-learn to do this.", "To make our clustering reach its maximum performance, we have to determine which hyperparameter fits to the data. To determine which hyperparameter is the best for our model and data, we can use the elbow method to decide. The code will look like this,", "How to interpret the plot? The x-axis is the value of the k, and the y-axis is the SSE value of the data. We will take the best parameter by looking at where the k-value will have a linear trend on the next consecutive k.", "Based on our observation, the k-value of 3 is the best hyperparameter for our model because the next k-value tend to have a linear trend. Therefore, our best model for the data is K-Means with the number of clusters is 3.", "Now, We can fit the model with this code,", "By fitting the model, we can have clusters where each data belongs. By that, we can analyze the data.", "We can summarize the RFM table based on clusters and calculate the mean of each variable. The code will look like this,", "The output from the code looks like this,", "Besides that, we can analyze the segments using snake plot. It requires the normalized dataset and also the cluster labels. By using this plot, we can have a good visualization from the data on how the cluster differs from each other. We can make the plot by using this code,", "By using this plot, we know how each segment differs. It describes more than we use the summarized table.", "We infer that cluster 0 is frequent, spend more, and they buy the product recently. Therefore, it could be the cluster of a loyal customer.", "Then, the cluster 1 is less frequent, less to spend, but they buy the product recently. Therefore, it could be the cluster of new customer.", "Finally, the cluster 2 is less frequent, less to spend, and they buy the product at the old time. Therefore, it could be the cluster of churned customers.", "In conclusion, customer segmentation is really necessary for knowing what characteristics that exist on each customer. The article has shown to you how to implement it using Python. I hope that this article will be useful to you, and you can implement on your case.", "If you want to see how the code is, you check on this Google Colab here.", "[1] Daqing C., Sai L.S, and Kun G. Data mining for the online retail industry: A case study of RFM model-based customer segmentation using data mining (2012), Journal of Database Marketing and Customer Strategy Management.[2] Millman K. J, Aivazis M. Python for Scientists and Engineers (2011), Computing in Science & Engineering.[3] Rade\u010di\u0107 D. Top 3 Methods for Handling Skewed Data (2020), Towards Data Science.[4] Elbow Method for optimal value of k in KMeans, Geeks For Geeks.", "Your home for data science. A Medium publication sharing concepts, ideas and codes."], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9c15acf6f945&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/@irfanalghani11?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@irfanalghani11?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": "Irfan Alghani Khalid"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44601cf05927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=post_page-44601cf05927----9c15acf6f945---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c15acf6f945&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c15acf6f945&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://unsplash.com/@ripato?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Ricardo Gomez Angel"}, {"url": "https://unsplash.com/s/photos/difference?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText", "anchor_text": "Unsplash"}, {"url": "https://archive.ics.uci.edu/ml/datasets/online+retail", "anchor_text": "here"}, {"url": "https://colab.research.google.com/github/khalidmeister/Customer-Segmentation-using-Python/blob/master/Customer%20Segmentation%20in%20Python.ipynb", "anchor_text": "here"}, {"url": "https://towardsdatascience.com/@radecicdario?source=post_page-----1334e0debf45----------------------", "anchor_text": "Rade\u010di\u0107"}, {"url": "https://towardsdatascience.com/@radecicdario?source=post_page-----1334e0debf45----------------------", "anchor_text": "D"}, {"url": "https://towardsdatascience.com/top-3-methods-for-handling-skewed-data-1334e0debf45", "anchor_text": "Top 3 Methods for Handling Skewed Data"}, {"url": "https://www.geeksforgeeks.org/elbow-method-for-optimal-value-of-k-in-kmeans/", "anchor_text": "Elbow Method for optimal value of k in KMeans"}, {"url": "https://towardsdatascience.com/introduction-to-time-series-analysis-with-r-a2f97650baa3", "anchor_text": "Introduction to Time Series Analysis with RFrom Exploration, To Forecasting. Using consumer price index (CPI) data in Indonesia from December 2002 to April 2020towardsdatascience.com"}, {"url": "https://towardsdatascience.com/time-series-forecasting-with-arima-model-in-r-77f4e2ae7abb", "anchor_text": "Time Series Forecasting with ARIMA Model in RFrom exploration, to forecasting on CO2 emmision data from 1970 to 2015.towardsdatascience.com"}, {"url": "https://towardsdatascience.com/data-engineering-for-entrepreneurs-fa10f9190831", "anchor_text": "Data Engineering for EntrepreneursConsider this for a more data-driven company.towardsdatascience.com"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----9c15acf6f945---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/marketing?source=post_page-----9c15acf6f945---------------marketing-----------------", "anchor_text": "Marketing"}, {"url": "https://medium.com/tag/programming?source=post_page-----9c15acf6f945---------------programming-----------------", "anchor_text": "Programming"}, {"url": "https://medium.com/tag/data-science?source=post_page-----9c15acf6f945---------------data_science-----------------", "anchor_text": "Data Science"}, {"url": "https://medium.com/tag/python?source=post_page-----9c15acf6f945---------------python-----------------", "anchor_text": "Python"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c15acf6f945&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=-----9c15acf6f945---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2F9c15acf6f945&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=-----9c15acf6f945---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F9c15acf6f945&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2F9c15acf6f945&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----9c15acf6f945---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----9c15acf6f945--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9c15acf6f945--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----9c15acf6f945--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----9c15acf6f945--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@irfanalghani11?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/@irfanalghani11?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Irfan Alghani Khalid"}, {"url": "https://medium.com/@irfanalghani11/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.2K Followers"}, {"url": "https://www.linkedin.com/in/alghaniirfan/", "anchor_text": "https://www.linkedin.com/in/alghaniirfan/"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F44601cf05927&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=post_page-44601cf05927--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F309de219c913&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcustomer-segmentation-in-python-9c15acf6f945&newsletterV3=44601cf05927&newsletterV3Id=309de219c913&user=Irfan+Alghani+Khalid&userId=44601cf05927&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}