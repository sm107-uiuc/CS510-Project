{"url": "https://towardsdatascience.com/extreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098", "time": 1682996036.073718, "path": "towardsdatascience.com/extreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098/", "webpage": {"metadata": {"title": "Extreme Rare Event Classification using Autoencoders in Keras | by Chitta Ranjan | Towards Data Science", "h1": "Extreme Rare Event Classification using Autoencoders in Keras", "description": "In a rare-event problem, we have an unbalanced dataset. Meaning, we have fewer positively labeled samples than negative. In a typical rare-event problem, the positively labeled data are around 5\u201310%\u2026"}, "outgoing_paragraph_urls": [{"url": "https://www.understandingdeeplearning.com/", "anchor_text": "Understanding Deep Learning", "paragraph_index": 0}, {"url": "https://www.datascience.com/blog/fraud-detection-with-tensorflow", "anchor_text": "here", "paragraph_index": 8}, {"url": "https://github.com/cran2367/autoencoder_classifier", "anchor_text": "here", "paragraph_index": 29}, {"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b", "anchor_text": "Build the right Autoencoder \u2014 Tune and Optimize using PCA principles. Part I", "paragraph_index": 30}, {"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II", "paragraph_index": 30}, {"url": "https://medium.com/@cran2367/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "next post", "paragraph_index": 31}, {"url": "https://medium.com/@cran2367/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "LSTM autoencoder", "paragraph_index": 31}, {"url": "https://medium.com/@cran2367/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "LSTM Autoencoder", "paragraph_index": 32}, {"url": "https://medium.com/@cran2367/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "LSTM Autoencoder for rare event classification", "paragraph_index": 33}, {"url": "http://www.understandingdeeplearning.com", "anchor_text": "www.understandingdeeplearning.com", "paragraph_index": 36}], "all_paragraphs": ["<<Download the free book, Understanding Deep Learning, to learn more>>", "In a rare-event problem, we have an unbalanced dataset. Meaning, we have fewer positively labeled samples than negative. In a typical rare-event problem, the positively labeled data are around 5\u201310% of the total. In an extreme rare event problem, we have less than 1% positively labeled data. For example, in the dataset used here it is around 0.6%.", "Such extreme rare event problems are quite common in the real-world, for example, sheet-breaks and machine failure in manufacturing, clicks or purchase in an online industry.", "Classifying these rare events is quite challenging. Recently, Deep Learning has been quite extensively used for classification. However, the small number of positively labeled samples prohibits Deep Learning application. No matter how large the data, the use of Deep Learning gets limited by the amount of positively labeled samples.", "This is a legitimate question. Why should we not think of using some another Machine Learning approach?", "The answer is subjective. We can always go with a Machine Learning approach. To make it work, we can undersample from negatively labeled data to have a close to a balanced dataset. Since we have about 0.6% positively labeled data, the undersampling will result in rougly a dataset that is about 1% of the size of the original data. A Machine Learning approach, e.g. SVM or Random Forest, will still work on a dataset of this size. However, it will have limitations in its accuracy. And we will not utilize the information present in the remaining ~99% of the data.", "If the data is sufficient, Deep Learning methods are potentially more capable. It also allows flexibility for model improvement by using different architectures. We will, therefore, attempt to use Deep Learning methods.", "In this post, we will learn how we can use a simple dense layers autoencoder to build a rare event classifier. The purpose of this post is to demonstrate the implementation of an Autoencoder for extreme rare-event classification. We will leave the exploration of different architecture and configuration of the Autoencoder on the user. Please share in the comments if you find anything interesting.", "The autoencoder approach for classification is similar to anomaly detection. In anomaly detection, we learn the pattern of a normal process. Anything that does not follow this pattern is classified as an anomaly. For a binary classification of rare events, we can use a similar approach using autoencoders (derived from here [2]).", "This is a binary labeled data from a pulp-and-paper mill for sheet breaks. Sheet breaks is severe problem in paper manufacturing. A single sheet break causes loss of several thousand dollars, and the mills see at least one or more break every day. This causes millions of dollors of yearly losses and work hazards.", "Detecting a break event is challenging due to the nature of the process. As mentioned in [1], even a 5% reduction in the breaks will bring significant benefit to the mills.", "The data we have contains about 18k rows collected over 15 days. The column y contains the binary labels, with 1 denoting a sheet break. The rest columns are predictors. There are about 124 positive labeled sample (~0.6%).", "Note that we are setting the random seeds for reproducibility of the result.", "Now, we read and prepare the data.", "The objective of this rare-event problem is to predict a sheet-break before it occurs. We will try to predict the break 4 minutes in advance. To build this model, we will shift the labels 2 rows up (which corresponds to 4 minutes). We can do this as df.y=df.y.shift(-2). However, in this problem we would want to do the shifting as: if row n is positively labeled,", "We will develop the following UDF for this curve shifting.", "Before moving forward, we will drop the time, and also the categorical columns for simplicity.", "Now, we divide the data into train, valid, and test sets. Then we will take the subset of data with only 0s to train the autoencoder.", "It is usually better to use a standardized data (transformed to Gaussian, mean 0 and variance 1) for autoencoders.", "First, we will initialize the Autoencoder architecture. We are building a simple autoencoder. More complex architectures and other configurations should be explored.", "We will train the model and save it in a file. Saving a trained model is a good practice for saving time for future analysis.", "In the following, we show how we can use an Autoencoder reconstruction error for the rare-event classification.", "As mentioned before, if the reconstruction error is high, we will classify it as a sheet-break. We will need to determine the threshold for this.", "We will use the validation set to identify the threshold.", "Now, we will perform classification on the test data.", "We should not estimate the classification threshold from the test data. It will result in overfitting.", "In Figure 4, the orange and blue dot above the threshold line represents the True Positive and False Positive, respectively. As we can see, we have good number of false positives. To have a better look, we can see a confusion matrix.", "We could predict 8 out of 41 breaks instances. Note that these instances include 2 or 4 minute ahead predictions. This is around 20%, which is a good recall rate for the paper industry. The False Positive Rate is around 6%. This is not ideal but not terrible for a mill.", "Still, this model can be further improved to increase the recall rate with smaller False Positive Rate. We will look at the AUC below and then talk about the next approach for improvement.", "The entire code with comments are present here.", "Autoencoders are a nonlinear extension of PCA. However, the conventional Autoencoder developed above does not follow the principles of PCA. In Build the right Autoencoder \u2014 Tune and Optimize using PCA principles. Part I and Part II, the required PCA principles that should be incorporated in an Autoencoder for optimization are explained and implemented.", "The problem discussed here is a (multivariate) time series. However, in the Autoencoder model we are not taking into account the temporal information/patterns. In the next post, we will explore if it is possible with an RNN. We will try a LSTM autoencoder.", "We worked on an extreme rare event binary labeled data from a paper mill to build an Autoencoder Classifier. We achieved reasonable accuracy. The purpose here was to demonstrate the use of a basic Autoencoder for rare event classification. We will further work on developing other methods, including an LSTM Autoencoder that can extract the temporal features for better accuracy.", "The next post on LSTM Autoencoder is here, LSTM Autoencoder for rare event classification.", "Disclaimer: The scope of this post is limited to a tutorial for building a Dense Layer Autoencoder and using it as a rare-event classifier. A practitioner is expected to achieve better results for this data by network tuning. The purpose of the article is helping Data Scientists implement an Autoencoder.", "Your home for data science. A Medium publication sharing concepts, ideas and codes.", "Director of Science at ProcessMiner | Book Author | www.understandingdeeplearning.com"], "all_outgoing_urls": [{"url": "https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa565b386f098&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---two_column_layout_nav----------------------------------", "anchor_text": "Open in app"}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://medium.com/?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---two_column_layout_nav-----------------------new_post_sidenav-----------", "anchor_text": "Write"}, {"url": "https://medium.com/search?source=---two_column_layout_nav----------------------------------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign up"}, {"url": "https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&source=post_page---two_column_layout_nav-----------------------global_nav-----------", "anchor_text": "Sign In"}, {"url": "https://towardsdatascience.com/?source=post_page-----a565b386f098--------------------------------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a565b386f098--------------------------------", "anchor_text": "Towards Data Science"}, {"url": "https://cranjan.medium.com/?source=post_page-----a565b386f098--------------------------------", "anchor_text": ""}, {"url": "https://cranjan.medium.com/?source=post_page-----a565b386f098--------------------------------", "anchor_text": "Chitta Ranjan"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c9fae27a83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&user=Chitta+Ranjan&userId=1c9fae27a83&source=post_page-1c9fae27a83----a565b386f098---------------------follow_byline-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa565b386f098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&source=--------------------------bookmark_header-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa565b386f098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&source=--------------------------bookmark_header-----------", "anchor_text": "Save"}, {"url": "https://arxiv.org/abs/1809.10717", "anchor_text": "here"}, {"url": "https://www.understandingdeeplearning.com/", "anchor_text": "Understanding Deep Learning"}, {"url": "https://www.datascience.com/blog/fraud-detection-with-tensorflow", "anchor_text": "here"}, {"url": "http://i-systems.github.io/HSE545/machine%20learning%20all/Workshop/CAE/06_CAE_Autoencoder.html", "anchor_text": "Source"}, {"url": "https://docs.google.com/forms/d/e/1FAIpQLSdyUk3lfDl7I5KYK_pw285LCApc-_RcoC0Tf9cnDnZ_TWzPAw/viewform", "anchor_text": "here"}, {"url": "https://github.com/cran2367/autoencoder_classifier", "anchor_text": "Github repository"}, {"url": "https://github.com/cran2367/autoencoder_classifier", "anchor_text": "here"}, {"url": "https://github.com/cran2367/autoencoder_classifier/blob/master/autoencoder_classifier.ipynb", "anchor_text": "cran2367/autoencoder_classifierAutoencoder model for rare event classification. Contribute to cran2367/autoencoder_classifier development by creating\u2026github.com"}, {"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b", "anchor_text": "Build the right Autoencoder \u2014 Tune and Optimize using PCA principles. Part I"}, {"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Part II"}, {"url": "https://medium.com/@cran2367/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "next post"}, {"url": "https://medium.com/@cran2367/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "LSTM autoencoder"}, {"url": "https://medium.com/@cran2367/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "LSTM Autoencoder"}, {"url": "https://medium.com/@cran2367/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "LSTM Autoencoder for rare event classification"}, {"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-i-1f01f821999b", "anchor_text": "Build the right Autoencoder \u2014 Tune and Optimize using PCA principles. Part I"}, {"url": "https://towardsdatascience.com/build-the-right-autoencoder-tune-and-optimize-using-pca-principles-part-ii-24b9cca69bd6", "anchor_text": "Build the right Autoencoder \u2014 Tune and Optimize using PCA principles. Part II"}, {"url": "https://towardsdatascience.com/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb", "anchor_text": "LSTM Autoencoder for Extreme Rare Event Classification in Keras"}, {"url": "https://arxiv.org/abs/1809.10717", "anchor_text": "arXiv preprint arXiv:1809.10717"}, {"url": "https://www.datascience.com/blog/fraud-detection-with-tensorflow", "anchor_text": "https://www.datascience.com/blog/fraud-detection-with-tensorflow"}, {"url": "https://github.com/cran2367/autoencoder_classifier", "anchor_text": "https://github.com/cran2367/autoencoder_classifier"}, {"url": "https://medium.com/tag/machine-learning?source=post_page-----a565b386f098---------------machine_learning-----------------", "anchor_text": "Machine Learning"}, {"url": "https://medium.com/tag/deep-learning?source=post_page-----a565b386f098---------------deep_learning-----------------", "anchor_text": "Deep Learning"}, {"url": "https://medium.com/tag/classification?source=post_page-----a565b386f098---------------classification-----------------", "anchor_text": "Classification"}, {"url": "https://medium.com/tag/towards-data-science?source=post_page-----a565b386f098---------------towards_data_science-----------------", "anchor_text": "Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa565b386f098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&user=Chitta+Ranjan&userId=1c9fae27a83&source=-----a565b386f098---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-data-science%2Fa565b386f098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&user=Chitta+Ranjan&userId=1c9fae27a83&source=-----a565b386f098---------------------clap_footer-----------", "anchor_text": ""}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa565b386f098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&source=--------------------------bookmark_footer-----------", "anchor_text": ""}, {"url": "https://towardsdatascience.com/?source=post_page-----a565b386f098--------------------------------", "anchor_text": "More from Towards Data Science"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-data-science%2Fa565b386f098&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&collection=Towards+Data+Science&collectionId=7f60cf5620c9&source=post_page-----a565b386f098---------------------follow_footer-----------", "anchor_text": "Follow"}, {"url": "https://towardsdatascience.com/?source=post_page-----a565b386f098--------------------------------", "anchor_text": "Read more from Towards Data Science"}, {"url": "https://medium.com/?source=post_page-----a565b386f098--------------------------------", "anchor_text": ""}, {"url": "https://medium.com/about?autoplay=1&source=post_page-----a565b386f098--------------------------------", "anchor_text": "About"}, {"url": "https://help.medium.com/hc/en-us?source=post_page-----a565b386f098--------------------------------", "anchor_text": "Help"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a565b386f098--------------------------------", "anchor_text": "Terms"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a565b386f098--------------------------------", "anchor_text": "Privacy"}, {"url": "https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8&ct=post_page&source=post_page-----a565b386f098--------------------------------", "anchor_text": ""}, {"url": "https://play.google.com/store/apps/details?id=com.medium.reader&source=post_page-----a565b386f098--------------------------------", "anchor_text": ""}, {"url": "https://cranjan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": ""}, {"url": "https://cranjan.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Chitta Ranjan"}, {"url": "https://cranjan.medium.com/followers?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "1.5K Followers"}, {"url": "http://www.understandingdeeplearning.com", "anchor_text": "www.understandingdeeplearning.com"}, {"url": "https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1c9fae27a83&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&user=Chitta+Ranjan&userId=1c9fae27a83&source=post_page-1c9fae27a83--two_column_layout_sidebar-----------------------follow_profile-----------", "anchor_text": "Follow"}, {"url": "https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Ffa1c3bb004a0&operation=register&redirect=https%3A%2F%2Ftowardsdatascience.com%2Fextreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098&newsletterV3=1c9fae27a83&newsletterV3Id=fa1c3bb004a0&user=Chitta+Ranjan&userId=1c9fae27a83&source=---two_column_layout_sidebar-----------------------subscribe_user-----------", "anchor_text": ""}, {"url": "https://help.medium.com/hc/en-us?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Help"}, {"url": "https://medium.statuspage.io/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Status"}, {"url": "https://about.medium.com/creators/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Writers"}, {"url": "https://blog.medium.com/?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Blog"}, {"url": "https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Careers"}, {"url": "https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Privacy"}, {"url": "https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Terms"}, {"url": "https://medium.com/about?autoplay=1&source=---two_column_layout_sidebar----------------------------------", "anchor_text": "About"}, {"url": "https://speechify.com/medium?source=---two_column_layout_sidebar----------------------------------", "anchor_text": "Text to speech"}]}, "scrape_status": {"code": "1"}}